(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();var Yh={exports:{}},zo={};var my;function RS(){if(my)return zo;my=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(s,o,c){var u=null;if(c!==void 0&&(u=""+c),o.key!==void 0&&(u=""+o.key),"key"in o){c={};for(var h in o)h!=="key"&&(c[h]=o[h])}else c=o;return o=c.ref,{$$typeof:t,type:s,key:u,ref:o!==void 0?o:null,props:c}}return zo.Fragment=n,zo.jsx=a,zo.jsxs=a,zo}var py;function BS(){return py||(py=1,Yh.exports=RS()),Yh.exports}var e=BS(),Jh={exports:{}},bt={};var gy;function OS(){if(gy)return bt;gy=1;var t=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),y=Symbol.iterator;function S(P){return P===null||typeof P!="object"?null:(P=y&&P[y]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function E(P,T,C){this.props=P,this.context=T,this.refs=_,this.updater=C||w}E.prototype.isReactComponent={},E.prototype.setState=function(P,T){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,T,"setState")},E.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function z(){}z.prototype=E.prototype;function N(P,T,C){this.props=P,this.context=T,this.refs=_,this.updater=C||w}var O=N.prototype=new z;O.constructor=N,b(O,E.prototype),O.isPureReactComponent=!0;var Q=Array.isArray;function U(){}var L={H:null,A:null,T:null,S:null},H=Object.prototype.hasOwnProperty;function A(P,T,C){var k=C.ref;return{$$typeof:t,type:P,key:T,ref:k!==void 0?k:null,props:C}}function R(P,T){return A(P.type,T,P.props)}function G(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function F(P){var T={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(C){return T[C]})}var q=/\/+/g;function ee(P,T){return typeof P=="object"&&P!==null&&P.key!=null?F(""+P.key):T.toString(36)}function me(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(U,U):(P.status="pending",P.then(function(T){P.status==="pending"&&(P.status="fulfilled",P.value=T)},function(T){P.status==="pending"&&(P.status="rejected",P.reason=T)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function W(P,T,C,k,I){var D=typeof P;(D==="undefined"||D==="boolean")&&(P=null);var de=!1;if(P===null)de=!0;else switch(D){case"bigint":case"string":case"number":de=!0;break;case"object":switch(P.$$typeof){case t:case n:de=!0;break;case x:return de=P._init,W(de(P._payload),T,C,k,I)}}if(de)return I=I(P),de=k===""?"."+ee(P,0):k,Q(I)?(C="",de!=null&&(C=de.replace(q,"$&/")+"/"),W(I,T,C,"",function(ve){return ve})):I!=null&&(G(I)&&(I=R(I,C+(I.key==null||P&&P.key===I.key?"":(""+I.key).replace(q,"$&/")+"/")+de)),T.push(I)),1;de=0;var he=k===""?".":k+":";if(Q(P))for(var ie=0;ie<P.length;ie++)k=P[ie],D=he+ee(k,ie),de+=W(k,T,C,D,I);else if(ie=S(P),typeof ie=="function")for(P=ie.call(P),ie=0;!(k=P.next()).done;)k=k.value,D=he+ee(k,ie++),de+=W(k,T,C,D,I);else if(D==="object"){if(typeof P.then=="function")return W(me(P),T,C,k,I);throw T=String(P),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.")}return de}function J(P,T,C){if(P==null)return P;var k=[],I=0;return W(P,k,"","",function(D){return T.call(C,D,I++)}),k}function M(P){if(P._status===-1){var T=P._result;T=T(),T.then(function(C){(P._status===0||P._status===-1)&&(P._status=1,P._result=C)},function(C){(P._status===0||P._status===-1)&&(P._status=2,P._result=C)}),P._status===-1&&(P._status=0,P._result=T)}if(P._status===1)return P._result.default;throw P._result}var V=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var T=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(T))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},ne={map:J,forEach:function(P,T,C){J(P,function(){T.apply(this,arguments)},C)},count:function(P){var T=0;return J(P,function(){T++}),T},toArray:function(P){return J(P,function(T){return T})||[]},only:function(P){if(!G(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return bt.Activity=j,bt.Children=ne,bt.Component=E,bt.Fragment=a,bt.Profiler=o,bt.PureComponent=N,bt.StrictMode=s,bt.Suspense=f,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,bt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return L.H.useMemoCache(P)}},bt.cache=function(P){return function(){return P.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(P,T,C){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var k=b({},P.props),I=P.key;if(T!=null)for(D in T.key!==void 0&&(I=""+T.key),T)!H.call(T,D)||D==="key"||D==="__self"||D==="__source"||D==="ref"&&T.ref===void 0||(k[D]=T[D]);var D=arguments.length-2;if(D===1)k.children=C;else if(1<D){for(var de=Array(D),he=0;he<D;he++)de[he]=arguments[he+2];k.children=de}return A(P.type,I,k)},bt.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:c,_context:P},P},bt.createElement=function(P,T,C){var k,I={},D=null;if(T!=null)for(k in T.key!==void 0&&(D=""+T.key),T)H.call(T,k)&&k!=="key"&&k!=="__self"&&k!=="__source"&&(I[k]=T[k]);var de=arguments.length-2;if(de===1)I.children=C;else if(1<de){for(var he=Array(de),ie=0;ie<de;ie++)he[ie]=arguments[ie+2];I.children=he}if(P&&P.defaultProps)for(k in de=P.defaultProps,de)I[k]===void 0&&(I[k]=de[k]);return A(P,D,I)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(P){return{$$typeof:h,render:P}},bt.isValidElement=G,bt.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:M}},bt.memo=function(P,T){return{$$typeof:p,type:P,compare:T===void 0?null:T}},bt.startTransition=function(P){var T=L.T,C={};L.T=C;try{var k=P(),I=L.S;I!==null&&I(C,k),typeof k=="object"&&k!==null&&typeof k.then=="function"&&k.then(U,V)}catch(D){V(D)}finally{T!==null&&C.types!==null&&(T.types=C.types),L.T=T}},bt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},bt.use=function(P){return L.H.use(P)},bt.useActionState=function(P,T,C){return L.H.useActionState(P,T,C)},bt.useCallback=function(P,T){return L.H.useCallback(P,T)},bt.useContext=function(P){return L.H.useContext(P)},bt.useDebugValue=function(){},bt.useDeferredValue=function(P,T){return L.H.useDeferredValue(P,T)},bt.useEffect=function(P,T){return L.H.useEffect(P,T)},bt.useEffectEvent=function(P){return L.H.useEffectEvent(P)},bt.useId=function(){return L.H.useId()},bt.useImperativeHandle=function(P,T,C){return L.H.useImperativeHandle(P,T,C)},bt.useInsertionEffect=function(P,T){return L.H.useInsertionEffect(P,T)},bt.useLayoutEffect=function(P,T){return L.H.useLayoutEffect(P,T)},bt.useMemo=function(P,T){return L.H.useMemo(P,T)},bt.useOptimistic=function(P,T){return L.H.useOptimistic(P,T)},bt.useReducer=function(P,T,C){return L.H.useReducer(P,T,C)},bt.useRef=function(P){return L.H.useRef(P)},bt.useState=function(P){return L.H.useState(P)},bt.useSyncExternalStore=function(P,T,C){return L.H.useSyncExternalStore(P,T,C)},bt.useTransition=function(){return L.H.useTransition()},bt.version="19.2.4",bt}var xy;function lp(){return xy||(xy=1,Jh.exports=OS()),Jh.exports}var m=lp(),Xh={exports:{}},Co={},Qh={exports:{}},em={};var yy;function DS(){return yy||(yy=1,(function(t){function n(W,J){var M=W.length;W.push(J);e:for(;0<M;){var V=M-1>>>1,ne=W[V];if(0<o(ne,J))W[V]=J,W[M]=ne,M=V;else break e}}function a(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var J=W[0],M=W.pop();if(M!==J){W[0]=M;e:for(var V=0,ne=W.length,P=ne>>>1;V<P;){var T=2*(V+1)-1,C=W[T],k=T+1,I=W[k];if(0>o(C,M))k<ne&&0>o(I,C)?(W[V]=I,W[k]=M,V=k):(W[V]=C,W[T]=M,V=T);else if(k<ne&&0>o(I,M))W[V]=I,W[k]=M,V=k;else break e}}return J}function o(W,J){var M=W.sortIndex-J.sortIndex;return M!==0?M:W.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var u=Date,h=u.now();t.unstable_now=function(){return u.now()-h}}var f=[],p=[],x=1,j=null,y=3,S=!1,w=!1,b=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function O(W){for(var J=a(p);J!==null;){if(J.callback===null)s(p);else if(J.startTime<=W)s(p),J.sortIndex=J.expirationTime,n(f,J);else break;J=a(p)}}function Q(W){if(b=!1,O(W),!w)if(a(f)!==null)w=!0,U||(U=!0,F());else{var J=a(p);J!==null&&me(Q,J.startTime-W)}}var U=!1,L=-1,H=5,A=-1;function R(){return _?!0:!(t.unstable_now()-A<H)}function G(){if(_=!1,U){var W=t.unstable_now();A=W;var J=!0;try{e:{w=!1,b&&(b=!1,z(L),L=-1),S=!0;var M=y;try{t:{for(O(W),j=a(f);j!==null&&!(j.expirationTime>W&&R());){var V=j.callback;if(typeof V=="function"){j.callback=null,y=j.priorityLevel;var ne=V(j.expirationTime<=W);if(W=t.unstable_now(),typeof ne=="function"){j.callback=ne,O(W),J=!0;break t}j===a(f)&&s(f),O(W)}else s(f);j=a(f)}if(j!==null)J=!0;else{var P=a(p);P!==null&&me(Q,P.startTime-W),J=!1}}break e}finally{j=null,y=M,S=!1}J=void 0}}finally{J?F():U=!1}}}var F;if(typeof N=="function")F=function(){N(G)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ee=q.port2;q.port1.onmessage=G,F=function(){ee.postMessage(null)}}else F=function(){E(G,0)};function me(W,J){L=E(function(){W(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(W){switch(y){case 1:case 2:case 3:var J=3;break;default:J=y}var M=y;y=J;try{return W()}finally{y=M}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(W,J){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var M=y;y=W;try{return J()}finally{y=M}},t.unstable_scheduleCallback=function(W,J,M){var V=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?V+M:V):M=V,W){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=M+ne,W={id:x++,callback:J,priorityLevel:W,startTime:M,expirationTime:ne,sortIndex:-1},M>V?(W.sortIndex=M,n(p,W),a(f)===null&&W===a(p)&&(b?(z(L),L=-1):b=!0,me(Q,M-V))):(W.sortIndex=ne,n(f,W),w||S||(w=!0,U||(U=!0,F()))),W},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(W){var J=y;return function(){var M=y;y=J;try{return W.apply(this,arguments)}finally{y=M}}}})(em)),em}var vy;function LS(){return vy||(vy=1,Qh.exports=DS()),Qh.exports}var tm={exports:{}},un={};var jy;function MS(){if(jy)return un;jy=1;var t=lp();function n(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(f,p,x){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:j==null?null:""+j,children:f,containerInfo:p,implementation:x}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,un.createPortal=function(f,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(n(299));return c(f,p,null,x)},un.flushSync=function(f){var p=u.T,x=s.p;try{if(u.T=null,s.p=2,f)return f()}finally{u.T=p,s.p=x,s.d.f()}},un.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(f,p))},un.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},un.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var x=p.as,j=h(x,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?s.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:j,integrity:y,fetchPriority:S}):x==="script"&&s.d.X(f,{crossOrigin:j,integrity:y,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},un.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=h(p.as,p.crossOrigin);s.d.M(f,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(f)},un.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,j=h(x,p.crossOrigin);s.d.L(f,x,{crossOrigin:j,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},un.preloadModule=function(f,p){if(typeof f=="string")if(p){var x=h(p.as,p.crossOrigin);s.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(f)},un.requestFormReset=function(f){s.d.r(f)},un.unstable_batchedUpdates=function(f,p){return f(p)},un.useFormState=function(f,p,x){return u.H.useFormState(f,p,x)},un.useFormStatus=function(){return u.H.useHostTransitionStatus()},un.version="19.2.4",un}var by;function IS(){if(by)return tm.exports;by=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),tm.exports=MS(),tm.exports}var _y;function PS(){if(_y)return Co;_y=1;var t=LS(),n=lp(),a=IS();function s(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function c(r){var i=r,l=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(l=i.return),r=i.return;while(r)}return i.tag===3?l:null}function u(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(r.tag===31){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function f(r){if(c(r)!==r)throw Error(s(188))}function p(r){var i=r.alternate;if(!i){if(i=c(r),i===null)throw Error(s(188));return i!==r?null:r}for(var l=r,d=i;;){var g=l.return;if(g===null)break;var v=g.alternate;if(v===null){if(d=g.return,d!==null){l=d;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===l)return f(g),r;if(v===d)return f(g),i;v=v.sibling}throw Error(s(188))}if(l.return!==d.return)l=g,d=v;else{for(var B=!1,X=g.child;X;){if(X===l){B=!0,l=g,d=v;break}if(X===d){B=!0,d=g,l=v;break}X=X.sibling}if(!B){for(X=v.child;X;){if(X===l){B=!0,l=v,d=g;break}if(X===d){B=!0,d=v,l=g;break}X=X.sibling}if(!B)throw Error(s(189))}}if(l.alternate!==d)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?r:i}function x(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=x(r),i!==null)return i;r=r.sibling}return null}var j=Object.assign,y=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),N=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=G&&r[G]||r["@@iterator"],typeof r=="function"?r:null)}var q=Symbol.for("react.client.reference");function ee(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===q?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case b:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case Q:return"Suspense";case U:return"SuspenseList";case A:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case N:return r.displayName||"Context";case z:return(r._context.displayName||"Context")+".Consumer";case O:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return i=r.displayName||null,i!==null?i:ee(r.type)||"Memo";case H:i=r._payload,r=r._init;try{return ee(r(i))}catch{}}return null}var me=Array.isArray,W=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},V=[],ne=-1;function P(r){return{current:r}}function T(r){0>ne||(r.current=V[ne],V[ne]=null,ne--)}function C(r,i){ne++,V[ne]=r.current,r.current=i}var k=P(null),I=P(null),D=P(null),de=P(null);function he(r,i){switch(C(D,i),C(I,r),C(k,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?Lx(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=Lx(i),r=Mx(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}T(k),C(k,r)}function ie(){T(k),T(I),T(D)}function ve(r){r.memoizedState!==null&&C(de,r);var i=k.current,l=Mx(i,r.type);i!==l&&(C(I,r),C(k,l))}function je(r){I.current===r&&(T(k),T(I)),de.current===r&&(T(de),_o._currentValue=M)}var fe,_e;function Se(r){if(fe===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);fe=i&&i[1]||"",_e=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+r+_e}var Ve=!1;function be(r,i){if(!r||Ve)return"";Ve=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Le){var Re=Le}Reflect.construct(r,[],Ze)}else{try{Ze.call()}catch(Le){Re=Le}r.call(Ze.prototype)}}else{try{throw Error()}catch(Le){Re=Le}(Ze=r())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Le){if(Le&&Re&&typeof Le.stack=="string")return[Le.stack,Re.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=d.DetermineComponentFrameRoot(),B=v[0],X=v[1];if(B&&X){var pe=B.split(`
`),Ee=X.split(`
`);for(g=d=0;d<pe.length&&!pe[d].includes("DetermineComponentFrameRoot");)d++;for(;g<Ee.length&&!Ee[g].includes("DetermineComponentFrameRoot");)g++;if(d===pe.length||g===Ee.length)for(d=pe.length-1,g=Ee.length-1;1<=d&&0<=g&&pe[d]!==Ee[g];)g--;for(;1<=d&&0<=g;d--,g--)if(pe[d]!==Ee[g]){if(d!==1||g!==1)do if(d--,g--,0>g||pe[d]!==Ee[g]){var We=`
`+pe[d].replace(" at new "," at ");return r.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",r.displayName)),We}while(1<=d&&0<=g);break}}}finally{Ve=!1,Error.prepareStackTrace=l}return(l=r?r.displayName||r.name:"")?Se(l):""}function oe(r,i){switch(r.tag){case 26:case 27:case 5:return Se(r.type);case 16:return Se("Lazy");case 13:return r.child!==i&&i!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return be(r.type,!1);case 11:return be(r.type.render,!1);case 1:return be(r.type,!0);case 31:return Se("Activity");default:return""}}function Ue(r){try{var i="",l=null;do i+=oe(r,l),l=r,r=r.return;while(r);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Qe=Object.prototype.hasOwnProperty,lt=t.unstable_scheduleCallback,tt=t.unstable_cancelCallback,ht=t.unstable_shouldYield,xt=t.unstable_requestPaint,qe=t.unstable_now,Nt=t.unstable_getCurrentPriorityLevel,st=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,zt=t.unstable_NormalPriority,It=t.unstable_LowPriority,va=t.unstable_IdlePriority,rt=t.log,oa=t.unstable_setDisableYieldValue,ca=null,ze=null;function et(r){if(typeof rt=="function"&&oa(r),ze&&typeof ze.setStrictMode=="function")try{ze.setStrictMode(ca,r)}catch{}}var it=Math.clz32?Math.clz32:nt,Be=Math.log,at=Math.LN2;function nt(r){return r>>>=0,r===0?32:31-(Be(r)/at|0)|0}var ut=256,ta=262144,Pt=4194304;function Tt(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function xe(r,i,l){var d=r.pendingLanes;if(d===0)return 0;var g=0,v=r.suspendedLanes,B=r.pingedLanes;r=r.warmLanes;var X=d&134217727;return X!==0?(d=X&~v,d!==0?g=Tt(d):(B&=X,B!==0?g=Tt(B):l||(l=X&~r,l!==0&&(g=Tt(l))))):(X=d&~v,X!==0?g=Tt(X):B!==0?g=Tt(B):l||(l=d&~r,l!==0&&(g=Tt(l)))),g===0?0:i!==0&&i!==g&&(i&v)===0&&(v=g&-g,l=i&-i,v>=l||v===32&&(l&4194048)!==0)?i:g}function Ie(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function mt(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oe(){var r=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),r}function ct(r){for(var i=[],l=0;31>l;l++)i.push(r);return i}function At(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function za(r,i,l,d,g,v){var B=r.pendingLanes;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=l,r.entangledLanes&=l,r.errorRecoveryDisabledLanes&=l,r.shellSuspendCounter=0;var X=r.entanglements,pe=r.expirationTimes,Ee=r.hiddenUpdates;for(l=B&~l;0<l;){var We=31-it(l),Ze=1<<We;X[We]=0,pe[We]=-1;var Re=Ee[We];if(Re!==null)for(Ee[We]=null,We=0;We<Re.length;We++){var Le=Re[We];Le!==null&&(Le.lane&=-536870913)}l&=~Ze}d!==0&&ja(r,d,0),v!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=v&~(B&~i))}function ja(r,i,l){r.pendingLanes|=i,r.suspendedLanes&=~i;var d=31-it(i);r.entangledLanes|=i,r.entanglements[d]=r.entanglements[d]|1073741824|l&261930}function Et(r,i){var l=r.entangledLanes|=i;for(r=r.entanglements;l;){var d=31-it(l),g=1<<d;g&i|r[d]&i&&(r[d]|=i),l&=~g}}function ge(r,i){var l=i&-i;return l=(l&42)!==0?1:Ft(l),(l&(r.suspendedLanes|i))!==0?0:l}function Ft(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ga(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Y(){var r=J.p;return r!==0?r:(r=window.event,r===void 0?32:ly(r.type))}function se(r,i){var l=J.p;try{return J.p=r,i()}finally{J.p=l}}var te=Math.random().toString(36).slice(2),ae="__reactFiber$"+te,re="__reactProps$"+te,ce="__reactContainer$"+te,Ce="__reactEvents$"+te,De="__reactListeners$"+te,Ne="__reactHandles$"+te,Fe="__reactResources$"+te,K="__reactMarker$"+te;function ue(r){delete r[ae],delete r[re],delete r[Ce],delete r[De],delete r[Ne]}function ke(r){var i=r[ae];if(i)return i;for(var l=r.parentNode;l;){if(i=l[ce]||l[ae]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(r=Vx(r);r!==null;){if(l=r[ae])return l;r=Vx(r)}return i}r=l,l=r.parentNode}return null}function Te(r){if(r=r[ae]||r[ce]){var i=r.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return r}return null}function Me(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(s(33))}function Ye(r){var i=r[Fe];return i||(i=r[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function $e(r){r[K]=!0}var yt=new Set,jt={};function Kt(r,i){cn(r,i),cn(r+"Capture",i)}function cn(r,i){for(jt[r]=i,r=0;r<i.length;r++)yt.add(i[r])}var sa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pa={},qn={};function ui(r){return Qe.call(qn,r)?!0:Qe.call(Pa,r)?!1:sa.test(r)?qn[r]=!0:(Pa[r]=!0,!1)}function Zt(r,i,l){if(ui(i))if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+l)}}function ur(r,i,l){if(l===null)r.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+l)}}function fr(r,i,l,d){if(d===null)r.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttributeNS(i,l,""+d)}}function bn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function jc(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Gu(r,i,l){var d=Object.getOwnPropertyDescriptor(r.constructor.prototype,i);if(!r.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var g=d.get,v=d.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return g.call(this)},set:function(B){l=""+B,v.call(this,B)}}),Object.defineProperty(r,i,{enumerable:d.enumerable}),{getValue:function(){return l},setValue:function(B){l=""+B},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function Rl(r){if(!r._valueTracker){var i=jc(r)?"checked":"value";r._valueTracker=Gu(r,i,""+r[i])}}function bc(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var l=i.getValue(),d="";return r&&(d=jc(r)?r.checked?"true":"false":r.value),r=d,r!==l?(i.setValue(r),!0):!1}function Ns(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ku=/[\n"\\]/g;function _n(r){return r.replace(Ku,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Bl(r,i,l,d,g,v,B,X){r.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?r.type=B:r.removeAttribute("type"),i!=null?B==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+bn(i)):r.value!==""+bn(i)&&(r.value=""+bn(i)):B!=="submit"&&B!=="reset"||r.removeAttribute("value"),i!=null?Ol(r,B,bn(i)):l!=null?Ol(r,B,bn(l)):d!=null&&r.removeAttribute("value"),g==null&&v!=null&&(r.defaultChecked=!!v),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?r.name=""+bn(X):r.removeAttribute("name")}function _c(r,i,l,d,g,v,B,X){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),i!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){Rl(r);return}l=l!=null?""+bn(l):"",i=i!=null?""+bn(i):l,X||i===r.value||(r.value=i),r.defaultValue=i}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,r.checked=X?r.checked:!!d,r.defaultChecked=!!d,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(r.name=B),Rl(r)}function Ol(r,i,l){i==="number"&&Ns(r.ownerDocument)===r||r.defaultValue===""+l||(r.defaultValue=""+l)}function fi(r,i,l,d){if(r=r.options,i){i={};for(var g=0;g<l.length;g++)i["$"+l[g]]=!0;for(l=0;l<r.length;l++)g=i.hasOwnProperty("$"+r[l].value),r[l].selected!==g&&(r[l].selected=g),g&&d&&(r[l].defaultSelected=!0)}else{for(l=""+bn(l),i=null,g=0;g<r.length;g++){if(r[g].value===l){r[g].selected=!0,d&&(r[g].defaultSelected=!0);return}i!==null||r[g].disabled||(i=r[g])}i!==null&&(i.selected=!0)}}function Sc(r,i,l){if(i!=null&&(i=""+bn(i),i!==r.value&&(r.value=i),l==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=l!=null?""+bn(l):""}function Yi(r,i,l,d){if(i==null){if(d!=null){if(l!=null)throw Error(s(92));if(me(d)){if(1<d.length)throw Error(s(93));d=d[0]}l=d}l==null&&(l=""),i=l}l=bn(i),r.defaultValue=l,d=r.textContent,d===l&&d!==""&&d!==null&&(r.value=d),Rl(r)}function hr(r,i){if(i){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=i;return}}r.textContent=i}var As=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hi(r,i,l){var d=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?d?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":d?r.setProperty(i,l):typeof l!="number"||l===0||As.has(i)?i==="float"?r.cssFloat=l:r[i]=(""+l).trim():r[i]=l+"px"}function wc(r,i,l){if(i!=null&&typeof i!="object")throw Error(s(62));if(r=r.style,l!=null){for(var d in l)!l.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?r.setProperty(d,""):d==="float"?r.cssFloat="":r[d]="");for(var g in i)d=i[g],i.hasOwnProperty(g)&&l[g]!==d&&hi(r,g,d)}else for(var v in i)i.hasOwnProperty(v)&&hi(r,v,i[v])}function Dl(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Es(r){return Yu.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function mr(){}var Ll=null;function Ml(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var mi=null,pi=null;function kc(r){var i=Te(r);if(i&&(r=i.stateNode)){var l=r[re]||null;e:switch(r=i.stateNode,i.type){case"input":if(Bl(r,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+_n(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var d=l[i];if(d!==r&&d.form===r.form){var g=d[re]||null;if(!g)throw Error(s(90));Bl(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<l.length;i++)d=l[i],d.form===r.form&&bc(d)}break e;case"textarea":Sc(r,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&fi(r,!!l.multiple,i,!1)}}}var Il=!1;function zc(r,i,l){if(Il)return r(i,l);Il=!0;try{var d=r(i);return d}finally{if(Il=!1,(mi!==null||pi!==null)&&(fd(),mi&&(i=mi,r=pi,pi=mi=null,kc(i),r)))for(i=0;i<r.length;i++)kc(r[i])}}function Ji(r,i){var l=r.stateNode;if(l===null)return null;var d=l[re]||null;if(d===null)return null;l=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(r=r.type,d=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!d;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(s(231,i,typeof l));return l}var Z=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ge=!1;if(Z)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Ge=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Ge=!1}var ua=null,Ha=null,pr=null;function Cc(){if(pr)return pr;var r,i=Ha,l=i.length,d,g="value"in ua?ua.value:ua.textContent,v=g.length;for(r=0;r<l&&i[r]===g[r];r++);var B=l-r;for(d=1;d<=B&&i[l-d]===g[v-d];d++);return pr=g.slice(r,1<d?1-d:void 0)}function Fs(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Rs(){return!0}function Tc(){return!1}function dn(r){function i(l,d,g,v,B){this._reactName=l,this._targetInst=g,this.type=d,this.nativeEvent=v,this.target=B,this.currentTarget=null;for(var X in r)r.hasOwnProperty(X)&&(l=r[X],this[X]=l?l(v):v[X]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Rs:Tc,this.isPropagationStopped=Tc,this}return j(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Rs)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Rs)},persist:function(){},isPersistent:Rs}),i}var Cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=dn(Cr),Pl=j({},Cr,{view:0,detail:0}),Eb=dn(Pl),Ju,Xu,Wl,Ac=j({},Pl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ef,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Wl&&(Wl&&r.type==="mousemove"?(Ju=r.screenX-Wl.screenX,Xu=r.screenY-Wl.screenY):Xu=Ju=0,Wl=r),Ju)},movementY:function(r){return"movementY"in r?r.movementY:Xu}}),Pp=dn(Ac),Fb=j({},Ac,{dataTransfer:0}),Rb=dn(Fb),Bb=j({},Pl,{relatedTarget:0}),Qu=dn(Bb),Ob=j({},Cr,{animationName:0,elapsedTime:0,pseudoElement:0}),Db=dn(Ob),Lb=j({},Cr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Mb=dn(Lb),Ib=j({},Cr,{data:0}),Wp=dn(Ib),Pb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Wb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ub={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $b(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Ub[r])?!!i[r]:!1}function ef(){return $b}var Hb=j({},Pl,{key:function(r){if(r.key){var i=Pb[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Fs(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Wb[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ef,charCode:function(r){return r.type==="keypress"?Fs(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Fs(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Vb=dn(Hb),Zb=j({},Ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Up=dn(Zb),Gb=j({},Pl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ef}),Kb=dn(Gb),qb=j({},Cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yb=dn(qb),Jb=j({},Ac,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Xb=dn(Jb),Qb=j({},Cr,{newState:0,oldState:0}),e_=dn(Qb),t_=[9,13,27,32],tf=Z&&"CompositionEvent"in window,Ul=null;Z&&"documentMode"in document&&(Ul=document.documentMode);var a_=Z&&"TextEvent"in window&&!Ul,$p=Z&&(!tf||Ul&&8<Ul&&11>=Ul),Hp=" ",Vp=!1;function Zp(r,i){switch(r){case"keyup":return t_.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Bs=!1;function n_(r,i){switch(r){case"compositionend":return Gp(i);case"keypress":return i.which!==32?null:(Vp=!0,Hp);case"textInput":return r=i.data,r===Hp&&Vp?null:r;default:return null}}function r_(r,i){if(Bs)return r==="compositionend"||!tf&&Zp(r,i)?(r=Cc(),pr=Ha=ua=null,Bs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return $p&&i.locale!=="ko"?null:i.data;default:return null}}var i_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!i_[r.type]:i==="textarea"}function qp(r,i,l,d){mi?pi?pi.push(d):pi=[d]:mi=d,i=vd(i,"onChange"),0<i.length&&(l=new Nc("onChange","change",null,l,d),r.push({event:l,listeners:i}))}var $l=null,Hl=null;function s_(r){Ex(r,0)}function Ec(r){var i=Me(r);if(bc(i))return r}function Yp(r,i){if(r==="change")return i}var Jp=!1;if(Z){var af;if(Z){var nf="oninput"in document;if(!nf){var Xp=document.createElement("div");Xp.setAttribute("oninput","return;"),nf=typeof Xp.oninput=="function"}af=nf}else af=!1;Jp=af&&(!document.documentMode||9<document.documentMode)}function Qp(){$l&&($l.detachEvent("onpropertychange",eg),Hl=$l=null)}function eg(r){if(r.propertyName==="value"&&Ec(Hl)){var i=[];qp(i,Hl,r,Ml(r)),zc(s_,i)}}function l_(r,i,l){r==="focusin"?(Qp(),$l=i,Hl=l,$l.attachEvent("onpropertychange",eg)):r==="focusout"&&Qp()}function o_(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ec(Hl)}function c_(r,i){if(r==="click")return Ec(i)}function d_(r,i){if(r==="input"||r==="change")return Ec(i)}function u_(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Fn=typeof Object.is=="function"?Object.is:u_;function Vl(r,i){if(Fn(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var l=Object.keys(r),d=Object.keys(i);if(l.length!==d.length)return!1;for(d=0;d<l.length;d++){var g=l[d];if(!Qe.call(i,g)||!Fn(r[g],i[g]))return!1}return!0}function tg(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ag(r,i){var l=tg(r);r=0;for(var d;l;){if(l.nodeType===3){if(d=r+l.textContent.length,r<=i&&d>=i)return{node:l,offset:i-r};r=d}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=tg(l)}}function ng(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?ng(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function rg(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=Ns(r.document);i instanceof r.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)r=i.contentWindow;else break;i=Ns(r.document)}return i}function rf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var f_=Z&&"documentMode"in document&&11>=document.documentMode,Os=null,sf=null,Zl=null,lf=!1;function ig(r,i,l){var d=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;lf||Os==null||Os!==Ns(d)||(d=Os,"selectionStart"in d&&rf(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Zl&&Vl(Zl,d)||(Zl=d,d=vd(sf,"onSelect"),0<d.length&&(i=new Nc("onSelect","select",null,i,l),r.push({event:i,listeners:d}),i.target=Os)))}function Xi(r,i){var l={};return l[r.toLowerCase()]=i.toLowerCase(),l["Webkit"+r]="webkit"+i,l["Moz"+r]="moz"+i,l}var Ds={animationend:Xi("Animation","AnimationEnd"),animationiteration:Xi("Animation","AnimationIteration"),animationstart:Xi("Animation","AnimationStart"),transitionrun:Xi("Transition","TransitionRun"),transitionstart:Xi("Transition","TransitionStart"),transitioncancel:Xi("Transition","TransitionCancel"),transitionend:Xi("Transition","TransitionEnd")},of={},sg={};Z&&(sg=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function Qi(r){if(of[r])return of[r];if(!Ds[r])return r;var i=Ds[r],l;for(l in i)if(i.hasOwnProperty(l)&&l in sg)return of[r]=i[l];return r}var lg=Qi("animationend"),og=Qi("animationiteration"),cg=Qi("animationstart"),h_=Qi("transitionrun"),m_=Qi("transitionstart"),p_=Qi("transitioncancel"),dg=Qi("transitionend"),ug=new Map,cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cf.push("scrollEnd");function gr(r,i){ug.set(r,i),Kt(i,[r])}var Fc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Yn=[],Ls=0,df=0;function Rc(){for(var r=Ls,i=df=Ls=0;i<r;){var l=Yn[i];Yn[i++]=null;var d=Yn[i];Yn[i++]=null;var g=Yn[i];Yn[i++]=null;var v=Yn[i];if(Yn[i++]=null,d!==null&&g!==null){var B=d.pending;B===null?g.next=g:(g.next=B.next,B.next=g),d.pending=g}v!==0&&fg(l,g,v)}}function Bc(r,i,l,d){Yn[Ls++]=r,Yn[Ls++]=i,Yn[Ls++]=l,Yn[Ls++]=d,df|=d,r.lanes|=d,r=r.alternate,r!==null&&(r.lanes|=d)}function uf(r,i,l,d){return Bc(r,i,l,d),Oc(r)}function es(r,i){return Bc(r,null,null,i),Oc(r)}function fg(r,i,l){r.lanes|=l;var d=r.alternate;d!==null&&(d.lanes|=l);for(var g=!1,v=r.return;v!==null;)v.childLanes|=l,d=v.alternate,d!==null&&(d.childLanes|=l),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(g=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,g&&i!==null&&(g=31-it(l),r=v.hiddenUpdates,d=r[g],d===null?r[g]=[i]:d.push(i),i.lane=l|536870912),v):null}function Oc(r){if(50<po)throw po=0,jh=null,Error(s(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var Ms={};function g_(r,i,l,d){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(r,i,l,d){return new g_(r,i,l,d)}function ff(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ir(r,i){var l=r.alternate;return l===null?(l=Rn(r.tag,i,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=i,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&65011712,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,i=r.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l.refCleanup=r.refCleanup,l}function hg(r,i){r.flags&=65011714;var l=r.alternate;return l===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=l.childLanes,r.lanes=l.lanes,r.child=l.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=l.memoizedProps,r.memoizedState=l.memoizedState,r.updateQueue=l.updateQueue,r.type=l.type,i=l.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Dc(r,i,l,d,g,v){var B=0;if(d=r,typeof r=="function")ff(r)&&(B=1);else if(typeof r=="string")B=bS(r,l,k.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case A:return r=Rn(31,l,i,g),r.elementType=A,r.lanes=v,r;case b:return ts(l.children,g,v,i);case _:B=8,g|=24;break;case E:return r=Rn(12,l,i,g|2),r.elementType=E,r.lanes=v,r;case Q:return r=Rn(13,l,i,g),r.elementType=Q,r.lanes=v,r;case U:return r=Rn(19,l,i,g),r.elementType=U,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case N:B=10;break e;case z:B=9;break e;case O:B=11;break e;case L:B=14;break e;case H:B=16,d=null;break e}B=29,l=Error(s(130,r===null?"null":typeof r,"")),d=null}return i=Rn(B,l,i,g),i.elementType=r,i.type=d,i.lanes=v,i}function ts(r,i,l,d){return r=Rn(7,r,d,i),r.lanes=l,r}function hf(r,i,l){return r=Rn(6,r,null,i),r.lanes=l,r}function mg(r){var i=Rn(18,null,null,0);return i.stateNode=r,i}function mf(r,i,l){return i=Rn(4,r.children!==null?r.children:[],r.key,i),i.lanes=l,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var pg=new WeakMap;function Jn(r,i){if(typeof r=="object"&&r!==null){var l=pg.get(r);return l!==void 0?l:(i={value:r,source:i,stack:Ue(i)},pg.set(r,i),i)}return{value:r,source:i,stack:Ue(i)}}var Is=[],Ps=0,Lc=null,Gl=0,Xn=[],Qn=0,gi=null,Tr=1,Nr="";function Pr(r,i){Is[Ps++]=Gl,Is[Ps++]=Lc,Lc=r,Gl=i}function gg(r,i,l){Xn[Qn++]=Tr,Xn[Qn++]=Nr,Xn[Qn++]=gi,gi=r;var d=Tr;r=Nr;var g=32-it(d)-1;d&=~(1<<g),l+=1;var v=32-it(i)+g;if(30<v){var B=g-g%5;v=(d&(1<<B)-1).toString(32),d>>=B,g-=B,Tr=1<<32-it(i)+g|l<<g|d,Nr=v+r}else Tr=1<<v|l<<g|d,Nr=r}function pf(r){r.return!==null&&(Pr(r,1),gg(r,1,0))}function gf(r){for(;r===Lc;)Lc=Is[--Ps],Is[Ps]=null,Gl=Is[--Ps],Is[Ps]=null;for(;r===gi;)gi=Xn[--Qn],Xn[Qn]=null,Nr=Xn[--Qn],Xn[Qn]=null,Tr=Xn[--Qn],Xn[Qn]=null}function xg(r,i){Xn[Qn++]=Tr,Xn[Qn++]=Nr,Xn[Qn++]=gi,Tr=i.id,Nr=i.overflow,gi=r}var qa=null,fa=null,Mt=!1,xi=null,er=!1,xf=Error(s(519));function yi(r){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Kl(Jn(i,r)),xf}function yg(r){var i=r.stateNode,l=r.type,d=r.memoizedProps;switch(i[ae]=r,i[re]=d,l){case"dialog":Bt("cancel",i),Bt("close",i);break;case"iframe":case"object":case"embed":Bt("load",i);break;case"video":case"audio":for(l=0;l<xo.length;l++)Bt(xo[l],i);break;case"source":Bt("error",i);break;case"img":case"image":case"link":Bt("error",i),Bt("load",i);break;case"details":Bt("toggle",i);break;case"input":Bt("invalid",i),_c(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Bt("invalid",i);break;case"textarea":Bt("invalid",i),Yi(i,d.value,d.defaultValue,d.children)}l=d.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||d.suppressHydrationWarning===!0||Ox(i.textContent,l)?(d.popover!=null&&(Bt("beforetoggle",i),Bt("toggle",i)),d.onScroll!=null&&Bt("scroll",i),d.onScrollEnd!=null&&Bt("scrollend",i),d.onClick!=null&&(i.onclick=mr),i=!0):i=!1,i||yi(r,!0)}function vg(r){for(qa=r.return;qa;)switch(qa.tag){case 5:case 31:case 13:er=!1;return;case 27:case 3:er=!0;return;default:qa=qa.return}}function Ws(r){if(r!==qa)return!1;if(!Mt)return vg(r),Mt=!0,!1;var i=r.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=r.type,l=!(l!=="form"&&l!=="button")||Oh(r.type,r.memoizedProps)),l=!l),l&&fa&&yi(r),vg(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));fa=Hx(r)}else if(i===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(317));fa=Hx(r)}else i===27?(i=fa,Fi(r.type)?(r=Ph,Ph=null,fa=r):fa=i):fa=qa?ar(r.stateNode.nextSibling):null;return!0}function as(){fa=qa=null,Mt=!1}function yf(){var r=xi;return r!==null&&(zn===null?zn=r:zn.push.apply(zn,r),xi=null),r}function Kl(r){xi===null?xi=[r]:xi.push(r)}var vf=P(null),ns=null,Wr=null;function vi(r,i,l){C(vf,i._currentValue),i._currentValue=l}function Ur(r){r._currentValue=vf.current,T(vf)}function jf(r,i,l){for(;r!==null;){var d=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),r===l)break;r=r.return}}function bf(r,i,l,d){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var v=g.dependencies;if(v!==null){var B=g.child;v=v.firstContext;e:for(;v!==null;){var X=v;v=g;for(var pe=0;pe<i.length;pe++)if(X.context===i[pe]){v.lanes|=l,X=v.alternate,X!==null&&(X.lanes|=l),jf(v.return,l,r),d||(B=null);break e}v=X.next}}else if(g.tag===18){if(B=g.return,B===null)throw Error(s(341));B.lanes|=l,v=B.alternate,v!==null&&(v.lanes|=l),jf(B,l,r),B=null}else B=g.child;if(B!==null)B.return=g;else for(B=g;B!==null;){if(B===r){B=null;break}if(g=B.sibling,g!==null){g.return=B.return,B=g;break}B=B.return}g=B}}function Us(r,i,l,d){r=null;for(var g=i,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var B=g.alternate;if(B===null)throw Error(s(387));if(B=B.memoizedProps,B!==null){var X=g.type;Fn(g.pendingProps.value,B.value)||(r!==null?r.push(X):r=[X])}}else if(g===de.current){if(B=g.alternate,B===null)throw Error(s(387));B.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(_o):r=[_o])}g=g.return}r!==null&&bf(i,r,l,d),i.flags|=262144}function Mc(r){for(r=r.firstContext;r!==null;){if(!Fn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function rs(r){ns=r,Wr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Ya(r){return jg(ns,r)}function Ic(r,i){return ns===null&&rs(r),jg(r,i)}function jg(r,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},Wr===null){if(r===null)throw Error(s(308));Wr=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Wr=Wr.next=i;return l}var x_=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(l,d){r.push(d)}};this.abort=function(){i.aborted=!0,r.forEach(function(l){return l()})}},y_=t.unstable_scheduleCallback,v_=t.unstable_NormalPriority,Fa={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _f(){return{controller:new x_,data:new Map,refCount:0}}function ql(r){r.refCount--,r.refCount===0&&y_(v_,function(){r.controller.abort()})}var Yl=null,Sf=0,$s=0,Hs=null;function j_(r,i){if(Yl===null){var l=Yl=[];Sf=0,$s=zh(),Hs={status:"pending",value:void 0,then:function(d){l.push(d)}}}return Sf++,i.then(bg,bg),i}function bg(){if(--Sf===0&&Yl!==null){Hs!==null&&(Hs.status="fulfilled");var r=Yl;Yl=null,$s=0,Hs=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function b_(r,i){var l=[],d={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return r.then(function(){d.status="fulfilled",d.value=i;for(var g=0;g<l.length;g++)(0,l[g])(i)},function(g){for(d.status="rejected",d.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),d}var _g=W.S;W.S=function(r,i){ix=qe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&j_(r,i),_g!==null&&_g(r,i)};var is=P(null);function wf(){var r=is.current;return r!==null?r:la.pooledCache}function Pc(r,i){i===null?C(is,is.current):C(is,i.pool)}function Sg(){var r=wf();return r===null?null:{parent:Fa._currentValue,pool:r}}var Vs=Error(s(460)),kf=Error(s(474)),Wc=Error(s(542)),Uc={then:function(){}};function wg(r){return r=r.status,r==="fulfilled"||r==="rejected"}function kg(r,i,l){switch(l=r[l],l===void 0?r.push(i):l!==i&&(i.then(mr,mr),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,Cg(r),r;default:if(typeof i.status=="string")i.then(mr,mr);else{if(r=la,r!==null&&100<r.shellSuspendCounter)throw Error(s(482));r=i,r.status="pending",r.then(function(d){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=d}},function(d){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,Cg(r),r}throw ls=i,Vs}}function ss(r){try{var i=r._init;return i(r._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ls=l,Vs):l}}var ls=null;function zg(){if(ls===null)throw Error(s(459));var r=ls;return ls=null,r}function Cg(r){if(r===Vs||r===Wc)throw Error(s(483))}var Zs=null,Jl=0;function $c(r){var i=Jl;return Jl+=1,Zs===null&&(Zs=[]),kg(Zs,r,i)}function Xl(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Hc(r,i){throw i.$$typeof===y?Error(s(525)):(r=Object.prototype.toString.call(i),Error(s(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function Tg(r){function i(we,ye){if(r){var Ae=we.deletions;Ae===null?(we.deletions=[ye],we.flags|=16):Ae.push(ye)}}function l(we,ye){if(!r)return null;for(;ye!==null;)i(we,ye),ye=ye.sibling;return null}function d(we){for(var ye=new Map;we!==null;)we.key!==null?ye.set(we.key,we):ye.set(we.index,we),we=we.sibling;return ye}function g(we,ye){return we=Ir(we,ye),we.index=0,we.sibling=null,we}function v(we,ye,Ae){return we.index=Ae,r?(Ae=we.alternate,Ae!==null?(Ae=Ae.index,Ae<ye?(we.flags|=67108866,ye):Ae):(we.flags|=67108866,ye)):(we.flags|=1048576,ye)}function B(we){return r&&we.alternate===null&&(we.flags|=67108866),we}function X(we,ye,Ae,He){return ye===null||ye.tag!==6?(ye=hf(Ae,we.mode,He),ye.return=we,ye):(ye=g(ye,Ae),ye.return=we,ye)}function pe(we,ye,Ae,He){var ft=Ae.type;return ft===b?We(we,ye,Ae.props.children,He,Ae.key):ye!==null&&(ye.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===H&&ss(ft)===ye.type)?(ye=g(ye,Ae.props),Xl(ye,Ae),ye.return=we,ye):(ye=Dc(Ae.type,Ae.key,Ae.props,null,we.mode,He),Xl(ye,Ae),ye.return=we,ye)}function Ee(we,ye,Ae,He){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==Ae.containerInfo||ye.stateNode.implementation!==Ae.implementation?(ye=mf(Ae,we.mode,He),ye.return=we,ye):(ye=g(ye,Ae.children||[]),ye.return=we,ye)}function We(we,ye,Ae,He,ft){return ye===null||ye.tag!==7?(ye=ts(Ae,we.mode,He,ft),ye.return=we,ye):(ye=g(ye,Ae),ye.return=we,ye)}function Ze(we,ye,Ae){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=hf(""+ye,we.mode,Ae),ye.return=we,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case S:return Ae=Dc(ye.type,ye.key,ye.props,null,we.mode,Ae),Xl(Ae,ye),Ae.return=we,Ae;case w:return ye=mf(ye,we.mode,Ae),ye.return=we,ye;case H:return ye=ss(ye),Ze(we,ye,Ae)}if(me(ye)||F(ye))return ye=ts(ye,we.mode,Ae,null),ye.return=we,ye;if(typeof ye.then=="function")return Ze(we,$c(ye),Ae);if(ye.$$typeof===N)return Ze(we,Ic(we,ye),Ae);Hc(we,ye)}return null}function Re(we,ye,Ae,He){var ft=ye!==null?ye.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ft!==null?null:X(we,ye,""+Ae,He);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case S:return Ae.key===ft?pe(we,ye,Ae,He):null;case w:return Ae.key===ft?Ee(we,ye,Ae,He):null;case H:return Ae=ss(Ae),Re(we,ye,Ae,He)}if(me(Ae)||F(Ae))return ft!==null?null:We(we,ye,Ae,He,null);if(typeof Ae.then=="function")return Re(we,ye,$c(Ae),He);if(Ae.$$typeof===N)return Re(we,ye,Ic(we,Ae),He);Hc(we,Ae)}return null}function Le(we,ye,Ae,He,ft){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return we=we.get(Ae)||null,X(ye,we,""+He,ft);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case S:return we=we.get(He.key===null?Ae:He.key)||null,pe(ye,we,He,ft);case w:return we=we.get(He.key===null?Ae:He.key)||null,Ee(ye,we,He,ft);case H:return He=ss(He),Le(we,ye,Ae,He,ft)}if(me(He)||F(He))return we=we.get(Ae)||null,We(ye,we,He,ft,null);if(typeof He.then=="function")return Le(we,ye,Ae,$c(He),ft);if(He.$$typeof===N)return Le(we,ye,Ae,Ic(ye,He),ft);Hc(ye,He)}return null}function ot(we,ye,Ae,He){for(var ft=null,Wt=null,dt=ye,kt=ye=0,Lt=null;dt!==null&&kt<Ae.length;kt++){dt.index>kt?(Lt=dt,dt=null):Lt=dt.sibling;var Ut=Re(we,dt,Ae[kt],He);if(Ut===null){dt===null&&(dt=Lt);break}r&&dt&&Ut.alternate===null&&i(we,dt),ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut,dt=Lt}if(kt===Ae.length)return l(we,dt),Mt&&Pr(we,kt),ft;if(dt===null){for(;kt<Ae.length;kt++)dt=Ze(we,Ae[kt],He),dt!==null&&(ye=v(dt,ye,kt),Wt===null?ft=dt:Wt.sibling=dt,Wt=dt);return Mt&&Pr(we,kt),ft}for(dt=d(dt);kt<Ae.length;kt++)Lt=Le(dt,we,kt,Ae[kt],He),Lt!==null&&(r&&Lt.alternate!==null&&dt.delete(Lt.key===null?kt:Lt.key),ye=v(Lt,ye,kt),Wt===null?ft=Lt:Wt.sibling=Lt,Wt=Lt);return r&&dt.forEach(function(Li){return i(we,Li)}),Mt&&Pr(we,kt),ft}function pt(we,ye,Ae,He){if(Ae==null)throw Error(s(151));for(var ft=null,Wt=null,dt=ye,kt=ye=0,Lt=null,Ut=Ae.next();dt!==null&&!Ut.done;kt++,Ut=Ae.next()){dt.index>kt?(Lt=dt,dt=null):Lt=dt.sibling;var Li=Re(we,dt,Ut.value,He);if(Li===null){dt===null&&(dt=Lt);break}r&&dt&&Li.alternate===null&&i(we,dt),ye=v(Li,ye,kt),Wt===null?ft=Li:Wt.sibling=Li,Wt=Li,dt=Lt}if(Ut.done)return l(we,dt),Mt&&Pr(we,kt),ft;if(dt===null){for(;!Ut.done;kt++,Ut=Ae.next())Ut=Ze(we,Ut.value,He),Ut!==null&&(ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut);return Mt&&Pr(we,kt),ft}for(dt=d(dt);!Ut.done;kt++,Ut=Ae.next())Ut=Le(dt,we,kt,Ut.value,He),Ut!==null&&(r&&Ut.alternate!==null&&dt.delete(Ut.key===null?kt:Ut.key),ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut);return r&&dt.forEach(function(FS){return i(we,FS)}),Mt&&Pr(we,kt),ft}function ra(we,ye,Ae,He){if(typeof Ae=="object"&&Ae!==null&&Ae.type===b&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case S:e:{for(var ft=Ae.key;ye!==null;){if(ye.key===ft){if(ft=Ae.type,ft===b){if(ye.tag===7){l(we,ye.sibling),He=g(ye,Ae.props.children),He.return=we,we=He;break e}}else if(ye.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===H&&ss(ft)===ye.type){l(we,ye.sibling),He=g(ye,Ae.props),Xl(He,Ae),He.return=we,we=He;break e}l(we,ye);break}else i(we,ye);ye=ye.sibling}Ae.type===b?(He=ts(Ae.props.children,we.mode,He,Ae.key),He.return=we,we=He):(He=Dc(Ae.type,Ae.key,Ae.props,null,we.mode,He),Xl(He,Ae),He.return=we,we=He)}return B(we);case w:e:{for(ft=Ae.key;ye!==null;){if(ye.key===ft)if(ye.tag===4&&ye.stateNode.containerInfo===Ae.containerInfo&&ye.stateNode.implementation===Ae.implementation){l(we,ye.sibling),He=g(ye,Ae.children||[]),He.return=we,we=He;break e}else{l(we,ye);break}else i(we,ye);ye=ye.sibling}He=mf(Ae,we.mode,He),He.return=we,we=He}return B(we);case H:return Ae=ss(Ae),ra(we,ye,Ae,He)}if(me(Ae))return ot(we,ye,Ae,He);if(F(Ae)){if(ft=F(Ae),typeof ft!="function")throw Error(s(150));return Ae=ft.call(Ae),pt(we,ye,Ae,He)}if(typeof Ae.then=="function")return ra(we,ye,$c(Ae),He);if(Ae.$$typeof===N)return ra(we,ye,Ic(we,Ae),He);Hc(we,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint"?(Ae=""+Ae,ye!==null&&ye.tag===6?(l(we,ye.sibling),He=g(ye,Ae),He.return=we,we=He):(l(we,ye),He=hf(Ae,we.mode,He),He.return=we,we=He),B(we)):l(we,ye)}return function(we,ye,Ae,He){try{Jl=0;var ft=ra(we,ye,Ae,He);return Zs=null,ft}catch(dt){if(dt===Vs||dt===Wc)throw dt;var Wt=Rn(29,dt,null,we.mode);return Wt.lanes=He,Wt.return=we,Wt}}}var os=Tg(!0),Ng=Tg(!1),ji=!1;function zf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Cf(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function bi(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function _i(r,i,l){var d=r.updateQueue;if(d===null)return null;if(d=d.shared,(Ht&2)!==0){var g=d.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),d.pending=i,i=Oc(r),fg(r,null,l),i}return Bc(r,d,i,l),Oc(r)}function Ql(r,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var d=i.lanes;d&=r.pendingLanes,l|=d,i.lanes=l,Et(r,l)}}function Tf(r,i){var l=r.updateQueue,d=r.alternate;if(d!==null&&(d=d.updateQueue,l===d)){var g=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var B={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?g=v=B:v=v.next=B,l=l.next}while(l!==null);v===null?g=v=i:v=v.next=i}else g=v=i;l={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:d.shared,callbacks:d.callbacks},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=i:r.next=i,l.lastBaseUpdate=i}var Nf=!1;function eo(){if(Nf){var r=Hs;if(r!==null)throw r}}function to(r,i,l,d){Nf=!1;var g=r.updateQueue;ji=!1;var v=g.firstBaseUpdate,B=g.lastBaseUpdate,X=g.shared.pending;if(X!==null){g.shared.pending=null;var pe=X,Ee=pe.next;pe.next=null,B===null?v=Ee:B.next=Ee,B=pe;var We=r.alternate;We!==null&&(We=We.updateQueue,X=We.lastBaseUpdate,X!==B&&(X===null?We.firstBaseUpdate=Ee:X.next=Ee,We.lastBaseUpdate=pe))}if(v!==null){var Ze=g.baseState;B=0,We=Ee=pe=null,X=v;do{var Re=X.lane&-536870913,Le=Re!==X.lane;if(Le?(Dt&Re)===Re:(d&Re)===Re){Re!==0&&Re===$s&&(Nf=!0),We!==null&&(We=We.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var ot=r,pt=X;Re=i;var ra=l;switch(pt.tag){case 1:if(ot=pt.payload,typeof ot=="function"){Ze=ot.call(ra,Ze,Re);break e}Ze=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=pt.payload,Re=typeof ot=="function"?ot.call(ra,Ze,Re):ot,Re==null)break e;Ze=j({},Ze,Re);break e;case 2:ji=!0}}Re=X.callback,Re!==null&&(r.flags|=64,Le&&(r.flags|=8192),Le=g.callbacks,Le===null?g.callbacks=[Re]:Le.push(Re))}else Le={lane:Re,tag:X.tag,payload:X.payload,callback:X.callback,next:null},We===null?(Ee=We=Le,pe=Ze):We=We.next=Le,B|=Re;if(X=X.next,X===null){if(X=g.shared.pending,X===null)break;Le=X,X=Le.next,Le.next=null,g.lastBaseUpdate=Le,g.shared.pending=null}}while(!0);We===null&&(pe=Ze),g.baseState=pe,g.firstBaseUpdate=Ee,g.lastBaseUpdate=We,v===null&&(g.shared.lanes=0),Ci|=B,r.lanes=B,r.memoizedState=Ze}}function Ag(r,i){if(typeof r!="function")throw Error(s(191,r));r.call(i)}function Eg(r,i){var l=r.callbacks;if(l!==null)for(r.callbacks=null,r=0;r<l.length;r++)Ag(l[r],i)}var Gs=P(null),Vc=P(0);function Fg(r,i){r=Jr,C(Vc,r),C(Gs,i),Jr=r|i.baseLanes}function Af(){C(Vc,Jr),C(Gs,Gs.current)}function Ef(){Jr=Vc.current,T(Gs),T(Vc)}var Bn=P(null),tr=null;function Si(r){var i=r.alternate;C(Ta,Ta.current&1),C(Bn,r),tr===null&&(i===null||Gs.current!==null||i.memoizedState!==null)&&(tr=r)}function Ff(r){C(Ta,Ta.current),C(Bn,r),tr===null&&(tr=r)}function Rg(r){r.tag===22?(C(Ta,Ta.current),C(Bn,r),tr===null&&(tr=r)):wi()}function wi(){C(Ta,Ta.current),C(Bn,Bn.current)}function On(r){T(Bn),tr===r&&(tr=null),T(Ta)}var Ta=P(0);function Zc(r){for(var i=r;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Mh(l)||Ih(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var $r=0,wt=null,aa=null,Ra=null,Gc=!1,Ks=!1,cs=!1,Kc=0,ao=0,qs=null,__=0;function ba(){throw Error(s(321))}function Rf(r,i){if(i===null)return!1;for(var l=0;l<i.length&&l<r.length;l++)if(!Fn(r[l],i[l]))return!1;return!0}function Bf(r,i,l,d,g,v){return $r=v,wt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,W.H=r===null||r.memoizedState===null?g0:qf,cs=!1,v=l(d,g),cs=!1,Ks&&(v=Og(i,l,d,g)),Bg(r),v}function Bg(r){W.H=io;var i=aa!==null&&aa.next!==null;if($r=0,Ra=aa=wt=null,Gc=!1,ao=0,qs=null,i)throw Error(s(300));r===null||Ba||(r=r.dependencies,r!==null&&Mc(r)&&(Ba=!0))}function Og(r,i,l,d){wt=r;var g=0;do{if(Ks&&(qs=null),ao=0,Ks=!1,25<=g)throw Error(s(301));if(g+=1,Ra=aa=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}W.H=x0,v=i(l,d)}while(Ks);return v}function S_(){var r=W.H,i=r.useState()[0];return i=typeof i.then=="function"?no(i):i,r=r.useState()[0],(aa!==null?aa.memoizedState:null)!==r&&(wt.flags|=1024),i}function Of(){var r=Kc!==0;return Kc=0,r}function Df(r,i,l){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~l}function Lf(r){if(Gc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Gc=!1}$r=0,Ra=aa=wt=null,Ks=!1,ao=Kc=0,qs=null}function mn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ra===null?wt.memoizedState=Ra=r:Ra=Ra.next=r,Ra}function Na(){if(aa===null){var r=wt.alternate;r=r!==null?r.memoizedState:null}else r=aa.next;var i=Ra===null?wt.memoizedState:Ra.next;if(i!==null)Ra=i,aa=r;else{if(r===null)throw wt.alternate===null?Error(s(467)):Error(s(310));aa=r,r={memoizedState:aa.memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},Ra===null?wt.memoizedState=Ra=r:Ra=Ra.next=r}return Ra}function qc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function no(r){var i=ao;return ao+=1,qs===null&&(qs=[]),r=kg(qs,r,i),i=wt,(Ra===null?i.memoizedState:Ra.next)===null&&(i=i.alternate,W.H=i===null||i.memoizedState===null?g0:qf),r}function Yc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return no(r);if(r.$$typeof===N)return Ya(r)}throw Error(s(438,String(r)))}function Mf(r){var i=null,l=wt.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var d=wt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=qc(),wt.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(r),d=0;d<r;d++)l[d]=R;return i.index++,l}function Hr(r,i){return typeof i=="function"?i(r):i}function Jc(r){var i=Na();return If(i,aa,r)}function If(r,i,l){var d=r.queue;if(d===null)throw Error(s(311));d.lastRenderedReducer=l;var g=r.baseQueue,v=d.pending;if(v!==null){if(g!==null){var B=g.next;g.next=v.next,v.next=B}i.baseQueue=g=v,d.pending=null}if(v=r.baseState,g===null)r.memoizedState=v;else{i=g.next;var X=B=null,pe=null,Ee=i,We=!1;do{var Ze=Ee.lane&-536870913;if(Ze!==Ee.lane?(Dt&Ze)===Ze:($r&Ze)===Ze){var Re=Ee.revertLane;if(Re===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),Ze===$s&&(We=!0);else if(($r&Re)===Re){Ee=Ee.next,Re===$s&&(We=!0);continue}else Ze={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(X=pe=Ze,B=v):pe=pe.next=Ze,wt.lanes|=Re,Ci|=Re;Ze=Ee.action,cs&&l(v,Ze),v=Ee.hasEagerState?Ee.eagerState:l(v,Ze)}else Re={lane:Ze,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(X=pe=Re,B=v):pe=pe.next=Re,wt.lanes|=Ze,Ci|=Ze;Ee=Ee.next}while(Ee!==null&&Ee!==i);if(pe===null?B=v:pe.next=X,!Fn(v,r.memoizedState)&&(Ba=!0,We&&(l=Hs,l!==null)))throw l;r.memoizedState=v,r.baseState=B,r.baseQueue=pe,d.lastRenderedState=v}return g===null&&(d.lanes=0),[r.memoizedState,d.dispatch]}function Pf(r){var i=Na(),l=i.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=r;var d=l.dispatch,g=l.pending,v=i.memoizedState;if(g!==null){l.pending=null;var B=g=g.next;do v=r(v,B.action),B=B.next;while(B!==g);Fn(v,i.memoizedState)||(Ba=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),l.lastRenderedState=v}return[v,d]}function Dg(r,i,l){var d=wt,g=Na(),v=Mt;if(v){if(l===void 0)throw Error(s(407));l=l()}else l=i();var B=!Fn((aa||g).memoizedState,l);if(B&&(g.memoizedState=l,Ba=!0),g=g.queue,$f(Ig.bind(null,d,g,r),[r]),g.getSnapshot!==i||B||Ra!==null&&Ra.memoizedState.tag&1){if(d.flags|=2048,Ys(9,{destroy:void 0},Mg.bind(null,d,g,l,i),null),la===null)throw Error(s(349));v||($r&127)!==0||Lg(d,i,l)}return l}function Lg(r,i,l){r.flags|=16384,r={getSnapshot:i,value:l},i=wt.updateQueue,i===null?(i=qc(),wt.updateQueue=i,i.stores=[r]):(l=i.stores,l===null?i.stores=[r]:l.push(r))}function Mg(r,i,l,d){i.value=l,i.getSnapshot=d,Pg(i)&&Wg(r)}function Ig(r,i,l){return l(function(){Pg(i)&&Wg(r)})}function Pg(r){var i=r.getSnapshot;r=r.value;try{var l=i();return!Fn(r,l)}catch{return!0}}function Wg(r){var i=es(r,2);i!==null&&Cn(i,r,2)}function Wf(r){var i=mn();if(typeof r=="function"){var l=r;if(r=l(),cs){et(!0);try{l()}finally{et(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:r},i}function Ug(r,i,l,d){return r.baseState=l,If(r,aa,typeof d=="function"?d:Hr)}function w_(r,i,l,d,g){if(ed(r))throw Error(s(485));if(r=i.action,r!==null){var v={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){v.listeners.push(B)}};W.T!==null?l(!0):v.isTransition=!1,d(v),l=i.pending,l===null?(v.next=i.pending=v,$g(i,v)):(v.next=l.next,i.pending=l.next=v)}}function $g(r,i){var l=i.action,d=i.payload,g=r.state;if(i.isTransition){var v=W.T,B={};W.T=B;try{var X=l(g,d),pe=W.S;pe!==null&&pe(B,X),Hg(r,i,X)}catch(Ee){Uf(r,i,Ee)}finally{v!==null&&B.types!==null&&(v.types=B.types),W.T=v}}else try{v=l(g,d),Hg(r,i,v)}catch(Ee){Uf(r,i,Ee)}}function Hg(r,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(d){Vg(r,i,d)},function(d){return Uf(r,i,d)}):Vg(r,i,l)}function Vg(r,i,l){i.status="fulfilled",i.value=l,Zg(i),r.state=l,i=r.pending,i!==null&&(l=i.next,l===i?r.pending=null:(l=l.next,i.next=l,$g(r,l)))}function Uf(r,i,l){var d=r.pending;if(r.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=l,Zg(i),i=i.next;while(i!==d)}r.action=null}function Zg(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function Gg(r,i){return i}function Kg(r,i){if(Mt){var l=la.formState;if(l!==null){e:{var d=wt;if(Mt){if(fa){t:{for(var g=fa,v=er;g.nodeType!==8;){if(!v){g=null;break t}if(g=ar(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){fa=ar(g.nextSibling),d=g.data==="F!";break e}}yi(d)}d=!1}d&&(i=l[0])}}return l=mn(),l.memoizedState=l.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gg,lastRenderedState:i},l.queue=d,l=h0.bind(null,wt,d),d.dispatch=l,d=Wf(!1),v=Kf.bind(null,wt,!1,d.queue),d=mn(),g={state:i,dispatch:null,action:r,pending:null},d.queue=g,l=w_.bind(null,wt,g,v,l),g.dispatch=l,d.memoizedState=r,[i,l,!1]}function qg(r){var i=Na();return Yg(i,aa,r)}function Yg(r,i,l){if(i=If(r,i,Gg)[0],r=Jc(Hr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=no(i)}catch(B){throw B===Vs?Wc:B}else d=i;i=Na();var g=i.queue,v=g.dispatch;return l!==i.memoizedState&&(wt.flags|=2048,Ys(9,{destroy:void 0},k_.bind(null,g,l),null)),[d,v,r]}function k_(r,i){r.action=i}function Jg(r){var i=Na(),l=aa;if(l!==null)return Yg(i,l,r);Na(),i=i.memoizedState,l=Na();var d=l.queue.dispatch;return l.memoizedState=r,[i,d,!1]}function Ys(r,i,l,d){return r={tag:r,create:l,deps:d,inst:i,next:null},i=wt.updateQueue,i===null&&(i=qc(),wt.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=r.next=r:(d=l.next,l.next=r,r.next=d,i.lastEffect=r),r}function Xg(){return Na().memoizedState}function Xc(r,i,l,d){var g=mn();wt.flags|=r,g.memoizedState=Ys(1|i,{destroy:void 0},l,d===void 0?null:d)}function Qc(r,i,l,d){var g=Na();d=d===void 0?null:d;var v=g.memoizedState.inst;aa!==null&&d!==null&&Rf(d,aa.memoizedState.deps)?g.memoizedState=Ys(i,v,l,d):(wt.flags|=r,g.memoizedState=Ys(1|i,v,l,d))}function Qg(r,i){Xc(8390656,8,r,i)}function $f(r,i){Qc(2048,8,r,i)}function z_(r){wt.flags|=4;var i=wt.updateQueue;if(i===null)i=qc(),wt.updateQueue=i,i.events=[r];else{var l=i.events;l===null?i.events=[r]:l.push(r)}}function e0(r){var i=Na().memoizedState;return z_({ref:i,nextImpl:r}),function(){if((Ht&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function t0(r,i){return Qc(4,2,r,i)}function a0(r,i){return Qc(4,4,r,i)}function n0(r,i){if(typeof i=="function"){r=r();var l=i(r);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function r0(r,i,l){l=l!=null?l.concat([r]):null,Qc(4,4,n0.bind(null,i,r),l)}function Hf(){}function i0(r,i){var l=Na();i=i===void 0?null:i;var d=l.memoizedState;return i!==null&&Rf(i,d[1])?d[0]:(l.memoizedState=[r,i],r)}function s0(r,i){var l=Na();i=i===void 0?null:i;var d=l.memoizedState;if(i!==null&&Rf(i,d[1]))return d[0];if(d=r(),cs){et(!0);try{r()}finally{et(!1)}}return l.memoizedState=[d,i],d}function Vf(r,i,l){return l===void 0||($r&1073741824)!==0&&(Dt&261930)===0?r.memoizedState=i:(r.memoizedState=l,r=lx(),wt.lanes|=r,Ci|=r,l)}function l0(r,i,l,d){return Fn(l,i)?l:Gs.current!==null?(r=Vf(r,l,d),Fn(r,i)||(Ba=!0),r):($r&42)===0||($r&1073741824)!==0&&(Dt&261930)===0?(Ba=!0,r.memoizedState=l):(r=lx(),wt.lanes|=r,Ci|=r,i)}function o0(r,i,l,d,g){var v=J.p;J.p=v!==0&&8>v?v:8;var B=W.T,X={};W.T=X,Kf(r,!1,i,l);try{var pe=g(),Ee=W.S;if(Ee!==null&&Ee(X,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var We=b_(pe,d);ro(r,i,We,Mn(r))}else ro(r,i,d,Mn(r))}catch(Ze){ro(r,i,{then:function(){},status:"rejected",reason:Ze},Mn())}finally{J.p=v,B!==null&&X.types!==null&&(B.types=X.types),W.T=B}}function C_(){}function Zf(r,i,l,d){if(r.tag!==5)throw Error(s(476));var g=c0(r).queue;o0(r,g,i,M,l===null?C_:function(){return d0(r),l(d)})}function c0(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:M},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:l},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function d0(r){var i=c0(r);i.next===null&&(i=r.alternate.memoizedState),ro(r,i.next.queue,{},Mn())}function Gf(){return Ya(_o)}function u0(){return Na().memoizedState}function f0(){return Na().memoizedState}function T_(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var l=Mn();r=bi(l);var d=_i(i,r,l);d!==null&&(Cn(d,i,l),Ql(d,i,l)),i={cache:_f()},r.payload=i;return}i=i.return}}function N_(r,i,l){var d=Mn();l={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},ed(r)?m0(i,l):(l=uf(r,i,l,d),l!==null&&(Cn(l,r,d),p0(l,i,d)))}function h0(r,i,l){var d=Mn();ro(r,i,l,d)}function ro(r,i,l,d){var g={lane:d,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(ed(r))m0(i,g);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var B=i.lastRenderedState,X=v(B,l);if(g.hasEagerState=!0,g.eagerState=X,Fn(X,B))return Bc(r,i,g,0),la===null&&Rc(),!1}catch{}if(l=uf(r,i,g,d),l!==null)return Cn(l,r,d),p0(l,i,d),!0}return!1}function Kf(r,i,l,d){if(d={lane:2,revertLane:zh(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},ed(r)){if(i)throw Error(s(479))}else i=uf(r,l,d,2),i!==null&&Cn(i,r,2)}function ed(r){var i=r.alternate;return r===wt||i!==null&&i===wt}function m0(r,i){Ks=Gc=!0;var l=r.pending;l===null?i.next=i:(i.next=l.next,l.next=i),r.pending=i}function p0(r,i,l){if((l&4194048)!==0){var d=i.lanes;d&=r.pendingLanes,l|=d,i.lanes=l,Et(r,l)}}var io={readContext:Ya,use:Yc,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useLayoutEffect:ba,useInsertionEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useSyncExternalStore:ba,useId:ba,useHostTransitionStatus:ba,useFormState:ba,useActionState:ba,useOptimistic:ba,useMemoCache:ba,useCacheRefresh:ba};io.useEffectEvent=ba;var g0={readContext:Ya,use:Yc,useCallback:function(r,i){return mn().memoizedState=[r,i===void 0?null:i],r},useContext:Ya,useEffect:Qg,useImperativeHandle:function(r,i,l){l=l!=null?l.concat([r]):null,Xc(4194308,4,n0.bind(null,i,r),l)},useLayoutEffect:function(r,i){return Xc(4194308,4,r,i)},useInsertionEffect:function(r,i){Xc(4,2,r,i)},useMemo:function(r,i){var l=mn();i=i===void 0?null:i;var d=r();if(cs){et(!0);try{r()}finally{et(!1)}}return l.memoizedState=[d,i],d},useReducer:function(r,i,l){var d=mn();if(l!==void 0){var g=l(i);if(cs){et(!0);try{l(i)}finally{et(!1)}}}else g=i;return d.memoizedState=d.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},d.queue=r,r=r.dispatch=N_.bind(null,wt,r),[d.memoizedState,r]},useRef:function(r){var i=mn();return r={current:r},i.memoizedState=r},useState:function(r){r=Wf(r);var i=r.queue,l=h0.bind(null,wt,i);return i.dispatch=l,[r.memoizedState,l]},useDebugValue:Hf,useDeferredValue:function(r,i){var l=mn();return Vf(l,r,i)},useTransition:function(){var r=Wf(!1);return r=o0.bind(null,wt,r.queue,!0,!1),mn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,l){var d=wt,g=mn();if(Mt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=i(),la===null)throw Error(s(349));(Dt&127)!==0||Lg(d,i,l)}g.memoizedState=l;var v={value:l,getSnapshot:i};return g.queue=v,Qg(Ig.bind(null,d,v,r),[r]),d.flags|=2048,Ys(9,{destroy:void 0},Mg.bind(null,d,v,l,i),null),l},useId:function(){var r=mn(),i=la.identifierPrefix;if(Mt){var l=Nr,d=Tr;l=(d&~(1<<32-it(d)-1)).toString(32)+l,i="_"+i+"R_"+l,l=Kc++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=__++,i="_"+i+"r_"+l.toString(32)+"_";return r.memoizedState=i},useHostTransitionStatus:Gf,useFormState:Kg,useActionState:Kg,useOptimistic:function(r){var i=mn();i.memoizedState=i.baseState=r;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=Kf.bind(null,wt,!0,l),l.dispatch=i,[r,i]},useMemoCache:Mf,useCacheRefresh:function(){return mn().memoizedState=T_.bind(null,wt)},useEffectEvent:function(r){var i=mn(),l={impl:r};return i.memoizedState=l,function(){if((Ht&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},qf={readContext:Ya,use:Yc,useCallback:i0,useContext:Ya,useEffect:$f,useImperativeHandle:r0,useInsertionEffect:t0,useLayoutEffect:a0,useMemo:s0,useReducer:Jc,useRef:Xg,useState:function(){return Jc(Hr)},useDebugValue:Hf,useDeferredValue:function(r,i){var l=Na();return l0(l,aa.memoizedState,r,i)},useTransition:function(){var r=Jc(Hr)[0],i=Na().memoizedState;return[typeof r=="boolean"?r:no(r),i]},useSyncExternalStore:Dg,useId:u0,useHostTransitionStatus:Gf,useFormState:qg,useActionState:qg,useOptimistic:function(r,i){var l=Na();return Ug(l,aa,r,i)},useMemoCache:Mf,useCacheRefresh:f0};qf.useEffectEvent=e0;var x0={readContext:Ya,use:Yc,useCallback:i0,useContext:Ya,useEffect:$f,useImperativeHandle:r0,useInsertionEffect:t0,useLayoutEffect:a0,useMemo:s0,useReducer:Pf,useRef:Xg,useState:function(){return Pf(Hr)},useDebugValue:Hf,useDeferredValue:function(r,i){var l=Na();return aa===null?Vf(l,r,i):l0(l,aa.memoizedState,r,i)},useTransition:function(){var r=Pf(Hr)[0],i=Na().memoizedState;return[typeof r=="boolean"?r:no(r),i]},useSyncExternalStore:Dg,useId:u0,useHostTransitionStatus:Gf,useFormState:Jg,useActionState:Jg,useOptimistic:function(r,i){var l=Na();return aa!==null?Ug(l,aa,r,i):(l.baseState=r,[r,l.queue.dispatch])},useMemoCache:Mf,useCacheRefresh:f0};x0.useEffectEvent=e0;function Yf(r,i,l,d){i=r.memoizedState,l=l(d,i),l=l==null?i:j({},i,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Jf={enqueueSetState:function(r,i,l){r=r._reactInternals;var d=Mn(),g=bi(d);g.payload=i,l!=null&&(g.callback=l),i=_i(r,g,d),i!==null&&(Cn(i,r,d),Ql(i,r,d))},enqueueReplaceState:function(r,i,l){r=r._reactInternals;var d=Mn(),g=bi(d);g.tag=1,g.payload=i,l!=null&&(g.callback=l),i=_i(r,g,d),i!==null&&(Cn(i,r,d),Ql(i,r,d))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var l=Mn(),d=bi(l);d.tag=2,i!=null&&(d.callback=i),i=_i(r,d,l),i!==null&&(Cn(i,r,l),Ql(i,r,l))}};function y0(r,i,l,d,g,v,B){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(d,v,B):i.prototype&&i.prototype.isPureReactComponent?!Vl(l,d)||!Vl(g,v):!0}function v0(r,i,l,d){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,d),i.state!==r&&Jf.enqueueReplaceState(i,i.state,null)}function ds(r,i){var l=i;if("ref"in i){l={};for(var d in i)d!=="ref"&&(l[d]=i[d])}if(r=r.defaultProps){l===i&&(l=j({},l));for(var g in r)l[g]===void 0&&(l[g]=r[g])}return l}function j0(r){Fc(r)}function b0(r){console.error(r)}function _0(r){Fc(r)}function td(r,i){try{var l=r.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function S0(r,i,l){try{var d=r.onCaughtError;d(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Xf(r,i,l){return l=bi(l),l.tag=3,l.payload={element:null},l.callback=function(){td(r,i)},l}function w0(r){return r=bi(r),r.tag=3,r}function k0(r,i,l,d){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=d.value;r.payload=function(){return g(v)},r.callback=function(){S0(i,l,d)}}var B=l.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(r.callback=function(){S0(i,l,d),typeof g!="function"&&(Ti===null?Ti=new Set([this]):Ti.add(this));var X=d.stack;this.componentDidCatch(d.value,{componentStack:X!==null?X:""})})}function A_(r,i,l,d,g){if(l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=l.alternate,i!==null&&Us(i,l,g,!0),l=Bn.current,l!==null){switch(l.tag){case 31:case 13:return tr===null?hd():l.alternate===null&&_a===0&&(_a=3),l.flags&=-257,l.flags|=65536,l.lanes=g,d===Uc?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([d]):i.add(d),Sh(r,d,g)),!1;case 22:return l.flags|=65536,d===Uc?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([d]):l.add(d)),Sh(r,d,g)),!1}throw Error(s(435,l.tag))}return Sh(r,d,g),hd(),!1}if(Mt)return i=Bn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,d!==xf&&(r=Error(s(422),{cause:d}),Kl(Jn(r,l)))):(d!==xf&&(i=Error(s(423),{cause:d}),Kl(Jn(i,l))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,d=Jn(d,l),g=Xf(r.stateNode,d,g),Tf(r,g),_a!==4&&(_a=2)),!1;var v=Error(s(520),{cause:d});if(v=Jn(v,l),mo===null?mo=[v]:mo.push(v),_a!==4&&(_a=2),i===null)return!0;d=Jn(d,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,r=g&-g,l.lanes|=r,r=Xf(l.stateNode,d,r),Tf(l,r),!1;case 1:if(i=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ti===null||!Ti.has(v))))return l.flags|=65536,g&=-g,l.lanes|=g,g=w0(g),k0(g,r,l,d),Tf(l,g),!1}l=l.return}while(l!==null);return!1}var Qf=Error(s(461)),Ba=!1;function Ja(r,i,l,d){i.child=r===null?Ng(i,null,l,d):os(i,r.child,l,d)}function z0(r,i,l,d,g){l=l.render;var v=i.ref;if("ref"in d){var B={};for(var X in d)X!=="ref"&&(B[X]=d[X])}else B=d;return rs(i),d=Bf(r,i,l,B,v,g),X=Of(),r!==null&&!Ba?(Df(r,i,g),Vr(r,i,g)):(Mt&&X&&pf(i),i.flags|=1,Ja(r,i,d,g),i.child)}function C0(r,i,l,d,g){if(r===null){var v=l.type;return typeof v=="function"&&!ff(v)&&v.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=v,T0(r,i,v,d,g)):(r=Dc(l.type,null,d,i,i.mode,g),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,!lh(r,g)){var B=v.memoizedProps;if(l=l.compare,l=l!==null?l:Vl,l(B,d)&&r.ref===i.ref)return Vr(r,i,g)}return i.flags|=1,r=Ir(v,d),r.ref=i.ref,r.return=i,i.child=r}function T0(r,i,l,d,g){if(r!==null){var v=r.memoizedProps;if(Vl(v,d)&&r.ref===i.ref)if(Ba=!1,i.pendingProps=d=v,lh(r,g))(r.flags&131072)!==0&&(Ba=!0);else return i.lanes=r.lanes,Vr(r,i,g)}return eh(r,i,l,d,g)}function N0(r,i,l,d){var g=d.children,v=r!==null?r.memoizedState:null;if(r===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|l:l,r!==null){for(d=i.child=r.child,g=0;d!==null;)g=g|d.lanes|d.childLanes,d=d.sibling;d=g&~v}else d=0,i.child=null;return A0(r,i,v,l,d)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Pc(i,v!==null?v.cachePool:null),v!==null?Fg(i,v):Af(),Rg(i);else return d=i.lanes=536870912,A0(r,i,v!==null?v.baseLanes|l:l,l,d)}else v!==null?(Pc(i,v.cachePool),Fg(i,v),wi(),i.memoizedState=null):(r!==null&&Pc(i,null),Af(),wi());return Ja(r,i,g,l),i.child}function so(r,i){return r!==null&&r.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function A0(r,i,l,d,g){var v=wf();return v=v===null?null:{parent:Fa._currentValue,pool:v},i.memoizedState={baseLanes:l,cachePool:v},r!==null&&Pc(i,null),Af(),Rg(i),r!==null&&Us(r,i,d,!0),i.childLanes=g,null}function ad(r,i){return i=rd({mode:i.mode,children:i.children},r.mode),i.ref=r.ref,r.child=i,i.return=r,i}function E0(r,i,l){return os(i,r.child,null,l),r=ad(i,i.pendingProps),r.flags|=2,On(i),i.memoizedState=null,r}function E_(r,i,l){var d=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,r===null){if(Mt){if(d.mode==="hidden")return r=ad(i,d),i.lanes=536870912,so(null,r);if(Ff(i),(r=fa)?(r=$x(r,er),r=r!==null&&r.data==="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:gi!==null?{id:Tr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=mg(r),l.return=i,i.child=l,qa=i,fa=null)):r=null,r===null)throw yi(i);return i.lanes=536870912,null}return ad(i,d)}var v=r.memoizedState;if(v!==null){var B=v.dehydrated;if(Ff(i),g)if(i.flags&256)i.flags&=-257,i=E0(r,i,l);else if(i.memoizedState!==null)i.child=r.child,i.flags|=128,i=null;else throw Error(s(558));else if(Ba||Us(r,i,l,!1),g=(l&r.childLanes)!==0,Ba||g){if(d=la,d!==null&&(B=ge(d,l),B!==0&&B!==v.retryLane))throw v.retryLane=B,es(r,B),Cn(d,r,B),Qf;hd(),i=E0(r,i,l)}else r=v.treeContext,fa=ar(B.nextSibling),qa=i,Mt=!0,xi=null,er=!1,r!==null&&xg(i,r),i=ad(i,d),i.flags|=4096;return i}return r=Ir(r.child,{mode:d.mode,children:d.children}),r.ref=i.ref,i.child=r,r.return=i,r}function nd(r,i){var l=i.ref;if(l===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(r===null||r.ref!==l)&&(i.flags|=4194816)}}function eh(r,i,l,d,g){return rs(i),l=Bf(r,i,l,d,void 0,g),d=Of(),r!==null&&!Ba?(Df(r,i,g),Vr(r,i,g)):(Mt&&d&&pf(i),i.flags|=1,Ja(r,i,l,g),i.child)}function F0(r,i,l,d,g,v){return rs(i),i.updateQueue=null,l=Og(i,d,l,g),Bg(r),d=Of(),r!==null&&!Ba?(Df(r,i,v),Vr(r,i,v)):(Mt&&d&&pf(i),i.flags|=1,Ja(r,i,l,v),i.child)}function R0(r,i,l,d,g){if(rs(i),i.stateNode===null){var v=Ms,B=l.contextType;typeof B=="object"&&B!==null&&(v=Ya(B)),v=new l(d,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Jf,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=d,v.state=i.memoizedState,v.refs={},zf(i),B=l.contextType,v.context=typeof B=="object"&&B!==null?Ya(B):Ms,v.state=i.memoizedState,B=l.getDerivedStateFromProps,typeof B=="function"&&(Yf(i,l,B,d),v.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(B=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),B!==v.state&&Jf.enqueueReplaceState(v,v.state,null),to(i,d,v,g),eo(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(r===null){v=i.stateNode;var X=i.memoizedProps,pe=ds(l,X);v.props=pe;var Ee=v.context,We=l.contextType;B=Ms,typeof We=="object"&&We!==null&&(B=Ya(We));var Ze=l.getDerivedStateFromProps;We=typeof Ze=="function"||typeof v.getSnapshotBeforeUpdate=="function",X=i.pendingProps!==X,We||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(X||Ee!==B)&&v0(i,v,d,B),ji=!1;var Re=i.memoizedState;v.state=Re,to(i,d,v,g),eo(),Ee=i.memoizedState,X||Re!==Ee||ji?(typeof Ze=="function"&&(Yf(i,l,Ze,d),Ee=i.memoizedState),(pe=ji||y0(i,l,pe,d,Re,Ee,B))?(We||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=Ee),v.props=d,v.state=Ee,v.context=B,d=pe):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{v=i.stateNode,Cf(r,i),B=i.memoizedProps,We=ds(l,B),v.props=We,Ze=i.pendingProps,Re=v.context,Ee=l.contextType,pe=Ms,typeof Ee=="object"&&Ee!==null&&(pe=Ya(Ee)),X=l.getDerivedStateFromProps,(Ee=typeof X=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(B!==Ze||Re!==pe)&&v0(i,v,d,pe),ji=!1,Re=i.memoizedState,v.state=Re,to(i,d,v,g),eo();var Le=i.memoizedState;B!==Ze||Re!==Le||ji||r!==null&&r.dependencies!==null&&Mc(r.dependencies)?(typeof X=="function"&&(Yf(i,l,X,d),Le=i.memoizedState),(We=ji||y0(i,l,We,d,Re,Le,pe)||r!==null&&r.dependencies!==null&&Mc(r.dependencies))?(Ee||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(d,Le,pe),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(d,Le,pe)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||B===r.memoizedProps&&Re===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||B===r.memoizedProps&&Re===r.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=Le),v.props=d,v.state=Le,v.context=pe,d=We):(typeof v.componentDidUpdate!="function"||B===r.memoizedProps&&Re===r.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||B===r.memoizedProps&&Re===r.memoizedState||(i.flags|=1024),d=!1)}return v=d,nd(r,i),d=(i.flags&128)!==0,v||d?(v=i.stateNode,l=d&&typeof l.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,r!==null&&d?(i.child=os(i,r.child,null,g),i.child=os(i,null,l,g)):Ja(r,i,l,g),i.memoizedState=v.state,r=i.child):r=Vr(r,i,g),r}function B0(r,i,l,d){return as(),i.flags|=256,Ja(r,i,l,d),i.child}var th={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ah(r){return{baseLanes:r,cachePool:Sg()}}function nh(r,i,l){return r=r!==null?r.childLanes&~l:0,i&&(r|=Ln),r}function O0(r,i,l){var d=i.pendingProps,g=!1,v=(i.flags&128)!==0,B;if((B=v)||(B=r!==null&&r.memoizedState===null?!1:(Ta.current&2)!==0),B&&(g=!0,i.flags&=-129),B=(i.flags&32)!==0,i.flags&=-33,r===null){if(Mt){if(g?Si(i):wi(),(r=fa)?(r=$x(r,er),r=r!==null&&r.data!=="&"?r:null,r!==null&&(i.memoizedState={dehydrated:r,treeContext:gi!==null?{id:Tr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=mg(r),l.return=i,i.child=l,qa=i,fa=null)):r=null,r===null)throw yi(i);return Ih(r)?i.lanes=32:i.lanes=536870912,null}var X=d.children;return d=d.fallback,g?(wi(),g=i.mode,X=rd({mode:"hidden",children:X},g),d=ts(d,g,l,null),X.return=i,d.return=i,X.sibling=d,i.child=X,d=i.child,d.memoizedState=ah(l),d.childLanes=nh(r,B,l),i.memoizedState=th,so(null,d)):(Si(i),rh(i,X))}var pe=r.memoizedState;if(pe!==null&&(X=pe.dehydrated,X!==null)){if(v)i.flags&256?(Si(i),i.flags&=-257,i=ih(r,i,l)):i.memoizedState!==null?(wi(),i.child=r.child,i.flags|=128,i=null):(wi(),X=d.fallback,g=i.mode,d=rd({mode:"visible",children:d.children},g),X=ts(X,g,l,null),X.flags|=2,d.return=i,X.return=i,d.sibling=X,i.child=d,os(i,r.child,null,l),d=i.child,d.memoizedState=ah(l),d.childLanes=nh(r,B,l),i.memoizedState=th,i=so(null,d));else if(Si(i),Ih(X)){if(B=X.nextSibling&&X.nextSibling.dataset,B)var Ee=B.dgst;B=Ee,d=Error(s(419)),d.stack="",d.digest=B,Kl({value:d,source:null,stack:null}),i=ih(r,i,l)}else if(Ba||Us(r,i,l,!1),B=(l&r.childLanes)!==0,Ba||B){if(B=la,B!==null&&(d=ge(B,l),d!==0&&d!==pe.retryLane))throw pe.retryLane=d,es(r,d),Cn(B,r,d),Qf;Mh(X)||hd(),i=ih(r,i,l)}else Mh(X)?(i.flags|=192,i.child=r.child,i=null):(r=pe.treeContext,fa=ar(X.nextSibling),qa=i,Mt=!0,xi=null,er=!1,r!==null&&xg(i,r),i=rh(i,d.children),i.flags|=4096);return i}return g?(wi(),X=d.fallback,g=i.mode,pe=r.child,Ee=pe.sibling,d=Ir(pe,{mode:"hidden",children:d.children}),d.subtreeFlags=pe.subtreeFlags&65011712,Ee!==null?X=Ir(Ee,X):(X=ts(X,g,l,null),X.flags|=2),X.return=i,d.return=i,d.sibling=X,i.child=d,so(null,d),d=i.child,X=r.child.memoizedState,X===null?X=ah(l):(g=X.cachePool,g!==null?(pe=Fa._currentValue,g=g.parent!==pe?{parent:pe,pool:pe}:g):g=Sg(),X={baseLanes:X.baseLanes|l,cachePool:g}),d.memoizedState=X,d.childLanes=nh(r,B,l),i.memoizedState=th,so(r.child,d)):(Si(i),l=r.child,r=l.sibling,l=Ir(l,{mode:"visible",children:d.children}),l.return=i,l.sibling=null,r!==null&&(B=i.deletions,B===null?(i.deletions=[r],i.flags|=16):B.push(r)),i.child=l,i.memoizedState=null,l)}function rh(r,i){return i=rd({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function rd(r,i){return r=Rn(22,r,null,i),r.lanes=0,r}function ih(r,i,l){return os(i,r.child,null,l),r=rh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function D0(r,i,l){r.lanes|=i;var d=r.alternate;d!==null&&(d.lanes|=i),jf(r.return,i,l)}function sh(r,i,l,d,g,v){var B=r.memoizedState;B===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:l,tailMode:g,treeForkCount:v}:(B.isBackwards=i,B.rendering=null,B.renderingStartTime=0,B.last=d,B.tail=l,B.tailMode=g,B.treeForkCount=v)}function L0(r,i,l){var d=i.pendingProps,g=d.revealOrder,v=d.tail;d=d.children;var B=Ta.current,X=(B&2)!==0;if(X?(B=B&1|2,i.flags|=128):B&=1,C(Ta,B),Ja(r,i,d,l),d=Mt?Gl:0,!X&&r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&D0(r,l,i);else if(r.tag===19)D0(r,l,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(g){case"forwards":for(l=i.child,g=null;l!==null;)r=l.alternate,r!==null&&Zc(r)===null&&(g=l),l=l.sibling;l=g,l===null?(g=i.child,i.child=null):(g=l.sibling,l.sibling=null),sh(i,!1,g,l,v,d);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=i.child,i.child=null;g!==null;){if(r=g.alternate,r!==null&&Zc(r)===null){i.child=g;break}r=g.sibling,g.sibling=l,l=g,g=r}sh(i,!0,l,null,v,d);break;case"together":sh(i,!1,null,null,void 0,d);break;default:i.memoizedState=null}return i.child}function Vr(r,i,l){if(r!==null&&(i.dependencies=r.dependencies),Ci|=i.lanes,(l&i.childLanes)===0)if(r!==null){if(Us(r,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(s(153));if(i.child!==null){for(r=i.child,l=Ir(r,r.pendingProps),i.child=l,l.return=i;r.sibling!==null;)r=r.sibling,l=l.sibling=Ir(r,r.pendingProps),l.return=i;l.sibling=null}return i.child}function lh(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Mc(r)))}function F_(r,i,l){switch(i.tag){case 3:he(i,i.stateNode.containerInfo),vi(i,Fa,r.memoizedState.cache),as();break;case 27:case 5:ve(i);break;case 4:he(i,i.stateNode.containerInfo);break;case 10:vi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Ff(i),null;break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(Si(i),i.flags|=128,null):(l&i.child.childLanes)!==0?O0(r,i,l):(Si(i),r=Vr(r,i,l),r!==null?r.sibling:null);Si(i);break;case 19:var g=(r.flags&128)!==0;if(d=(l&i.childLanes)!==0,d||(Us(r,i,l,!1),d=(l&i.childLanes)!==0),g){if(d)return L0(r,i,l);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),C(Ta,Ta.current),d)break;return null;case 22:return i.lanes=0,N0(r,i,l,i.pendingProps);case 24:vi(i,Fa,r.memoizedState.cache)}return Vr(r,i,l)}function M0(r,i,l){if(r!==null)if(r.memoizedProps!==i.pendingProps)Ba=!0;else{if(!lh(r,l)&&(i.flags&128)===0)return Ba=!1,F_(r,i,l);Ba=(r.flags&131072)!==0}else Ba=!1,Mt&&(i.flags&1048576)!==0&&gg(i,Gl,i.index);switch(i.lanes=0,i.tag){case 16:e:{var d=i.pendingProps;if(r=ss(i.elementType),i.type=r,typeof r=="function")ff(r)?(d=ds(r,d),i.tag=1,i=R0(null,i,r,d,l)):(i.tag=0,i=eh(null,i,r,d,l));else{if(r!=null){var g=r.$$typeof;if(g===O){i.tag=11,i=z0(null,i,r,d,l);break e}else if(g===L){i.tag=14,i=C0(null,i,r,d,l);break e}}throw i=ee(r)||r,Error(s(306,i,""))}}return i;case 0:return eh(r,i,i.type,i.pendingProps,l);case 1:return d=i.type,g=ds(d,i.pendingProps),R0(r,i,d,g,l);case 3:e:{if(he(i,i.stateNode.containerInfo),r===null)throw Error(s(387));d=i.pendingProps;var v=i.memoizedState;g=v.element,Cf(r,i),to(i,d,null,l);var B=i.memoizedState;if(d=B.cache,vi(i,Fa,d),d!==v.cache&&bf(i,[Fa],l,!0),eo(),d=B.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:B.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=B0(r,i,d,l);break e}else if(d!==g){g=Jn(Error(s(424)),i),Kl(g),i=B0(r,i,d,l);break e}else for(r=i.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,fa=ar(r.firstChild),qa=i,Mt=!0,xi=null,er=!0,l=Ng(i,null,d,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(as(),d===g){i=Vr(r,i,l);break e}Ja(r,i,d,l)}i=i.child}return i;case 26:return nd(r,i),r===null?(l=qx(i.type,null,i.pendingProps,null))?i.memoizedState=l:Mt||(l=i.type,r=i.pendingProps,d=jd(D.current).createElement(l),d[ae]=i,d[re]=r,Xa(d,l,r),$e(d),i.stateNode=d):i.memoizedState=qx(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return ve(i),r===null&&Mt&&(d=i.stateNode=Zx(i.type,i.pendingProps,D.current),qa=i,er=!0,g=fa,Fi(i.type)?(Ph=g,fa=ar(d.firstChild)):fa=g),Ja(r,i,i.pendingProps.children,l),nd(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&Mt&&((g=d=fa)&&(d=oS(d,i.type,i.pendingProps,er),d!==null?(i.stateNode=d,qa=i,fa=ar(d.firstChild),er=!1,g=!0):g=!1),g||yi(i)),ve(i),g=i.type,v=i.pendingProps,B=r!==null?r.memoizedProps:null,d=v.children,Oh(g,v)?d=null:B!==null&&Oh(g,B)&&(i.flags|=32),i.memoizedState!==null&&(g=Bf(r,i,S_,null,null,l),_o._currentValue=g),nd(r,i),Ja(r,i,d,l),i.child;case 6:return r===null&&Mt&&((r=l=fa)&&(l=cS(l,i.pendingProps,er),l!==null?(i.stateNode=l,qa=i,fa=null,r=!0):r=!1),r||yi(i)),null;case 13:return O0(r,i,l);case 4:return he(i,i.stateNode.containerInfo),d=i.pendingProps,r===null?i.child=os(i,null,d,l):Ja(r,i,d,l),i.child;case 11:return z0(r,i,i.type,i.pendingProps,l);case 7:return Ja(r,i,i.pendingProps,l),i.child;case 8:return Ja(r,i,i.pendingProps.children,l),i.child;case 12:return Ja(r,i,i.pendingProps.children,l),i.child;case 10:return d=i.pendingProps,vi(i,i.type,d.value),Ja(r,i,d.children,l),i.child;case 9:return g=i.type._context,d=i.pendingProps.children,rs(i),g=Ya(g),d=d(g),i.flags|=1,Ja(r,i,d,l),i.child;case 14:return C0(r,i,i.type,i.pendingProps,l);case 15:return T0(r,i,i.type,i.pendingProps,l);case 19:return L0(r,i,l);case 31:return E_(r,i,l);case 22:return N0(r,i,l,i.pendingProps);case 24:return rs(i),d=Ya(Fa),r===null?(g=wf(),g===null&&(g=la,v=_f(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=l),g=v),i.memoizedState={parent:d,cache:g},zf(i),vi(i,Fa,g)):((r.lanes&l)!==0&&(Cf(r,i),to(i,null,null,l),eo()),g=r.memoizedState,v=i.memoizedState,g.parent!==d?(g={parent:d,cache:d},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),vi(i,Fa,d)):(d=v.cache,vi(i,Fa,d),d!==g.cache&&bf(i,[Fa],l,!0))),Ja(r,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Zr(r){r.flags|=4}function oh(r,i,l,d,g){if((i=(r.mode&32)!==0)&&(i=!1),i){if(r.flags|=16777216,(g&335544128)===g)if(r.stateNode.complete)r.flags|=8192;else if(ux())r.flags|=8192;else throw ls=Uc,kf}else r.flags&=-16777217}function I0(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!ey(i))if(ux())r.flags|=8192;else throw ls=Uc,kf}function id(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Oe():536870912,r.lanes|=i,el|=i)}function lo(r,i){if(!Mt)switch(r.tailMode){case"hidden":i=r.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:d.sibling=null}}function ha(r){var i=r.alternate!==null&&r.alternate.child===r.child,l=0,d=0;if(i)for(var g=r.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)l|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=d,r.childLanes=l,i}function R_(r,i,l){var d=i.pendingProps;switch(gf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ha(i),null;case 1:return ha(i),null;case 3:return l=i.stateNode,d=null,r!==null&&(d=r.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),Ur(Fa),ie(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(r===null||r.child===null)&&(Ws(i)?Zr(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,yf())),ha(i),null;case 26:var g=i.type,v=i.memoizedState;return r===null?(Zr(i),v!==null?(ha(i),I0(i,v)):(ha(i),oh(i,g,null,d,l))):v?v!==r.memoizedState?(Zr(i),ha(i),I0(i,v)):(ha(i),i.flags&=-16777217):(r=r.memoizedProps,r!==d&&Zr(i),ha(i),oh(i,g,r,d,l)),null;case 27:if(je(i),l=D.current,g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==d&&Zr(i);else{if(!d){if(i.stateNode===null)throw Error(s(166));return ha(i),null}r=k.current,Ws(i)?yg(i):(r=Zx(g,d,l),i.stateNode=r,Zr(i))}return ha(i),null;case 5:if(je(i),g=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==d&&Zr(i);else{if(!d){if(i.stateNode===null)throw Error(s(166));return ha(i),null}if(v=k.current,Ws(i))yg(i);else{var B=jd(D.current);switch(v){case 1:v=B.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=B.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=B.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=B.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=B.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof d.is=="string"?B.createElement("select",{is:d.is}):B.createElement("select"),d.multiple?v.multiple=!0:d.size&&(v.size=d.size);break;default:v=typeof d.is=="string"?B.createElement(g,{is:d.is}):B.createElement(g)}}v[ae]=i,v[re]=d;e:for(B=i.child;B!==null;){if(B.tag===5||B.tag===6)v.appendChild(B.stateNode);else if(B.tag!==4&&B.tag!==27&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===i)break e;for(;B.sibling===null;){if(B.return===null||B.return===i)break e;B=B.return}B.sibling.return=B.return,B=B.sibling}i.stateNode=v;e:switch(Xa(v,g,d),g){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Zr(i)}}return ha(i),oh(i,i.type,r===null?null:r.memoizedProps,i.pendingProps,l),null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==d&&Zr(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(s(166));if(r=D.current,Ws(i)){if(r=i.stateNode,l=i.memoizedProps,d=null,g=qa,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}r[ae]=i,r=!!(r.nodeValue===l||d!==null&&d.suppressHydrationWarning===!0||Ox(r.nodeValue,l)),r||yi(i,!0)}else r=jd(r).createTextNode(d),r[ae]=i,i.stateNode=r}return ha(i),null;case 31:if(l=i.memoizedState,r===null||r.memoizedState!==null){if(d=Ws(i),l!==null){if(r===null){if(!d)throw Error(s(318));if(r=i.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(s(557));r[ae]=i}else as(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ha(i),r=!1}else l=yf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=l),r=!0;if(!r)return i.flags&256?(On(i),i):(On(i),null);if((i.flags&128)!==0)throw Error(s(558))}return ha(i),null;case 13:if(d=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=Ws(i),d!==null&&d.dehydrated!==null){if(r===null){if(!g)throw Error(s(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[ae]=i}else as(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ha(i),g=!1}else g=yf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(On(i),i):(On(i),null)}return On(i),(i.flags&128)!==0?(i.lanes=l,i):(l=d!==null,r=r!==null&&r.memoizedState!==null,l&&(d=i.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool),v=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(v=d.memoizedState.cachePool.pool),v!==g&&(d.flags|=2048)),l!==r&&l&&(i.child.flags|=8192),id(i,i.updateQueue),ha(i),null);case 4:return ie(),r===null&&Ah(i.stateNode.containerInfo),ha(i),null;case 10:return Ur(i.type),ha(i),null;case 19:if(T(Ta),d=i.memoizedState,d===null)return ha(i),null;if(g=(i.flags&128)!==0,v=d.rendering,v===null)if(g)lo(d,!1);else{if(_a!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(v=Zc(r),v!==null){for(i.flags|=128,lo(d,!1),r=v.updateQueue,i.updateQueue=r,id(i,r),i.subtreeFlags=0,r=l,l=i.child;l!==null;)hg(l,r),l=l.sibling;return C(Ta,Ta.current&1|2),Mt&&Pr(i,d.treeForkCount),i.child}r=r.sibling}d.tail!==null&&qe()>dd&&(i.flags|=128,g=!0,lo(d,!1),i.lanes=4194304)}else{if(!g)if(r=Zc(v),r!==null){if(i.flags|=128,g=!0,r=r.updateQueue,i.updateQueue=r,id(i,r),lo(d,!0),d.tail===null&&d.tailMode==="hidden"&&!v.alternate&&!Mt)return ha(i),null}else 2*qe()-d.renderingStartTime>dd&&l!==536870912&&(i.flags|=128,g=!0,lo(d,!1),i.lanes=4194304);d.isBackwards?(v.sibling=i.child,i.child=v):(r=d.last,r!==null?r.sibling=v:i.child=v,d.last=v)}return d.tail!==null?(r=d.tail,d.rendering=r,d.tail=r.sibling,d.renderingStartTime=qe(),r.sibling=null,l=Ta.current,C(Ta,g?l&1|2:l&1),Mt&&Pr(i,d.treeForkCount),r):(ha(i),null);case 22:case 23:return On(i),Ef(),d=i.memoizedState!==null,r!==null?r.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(l&536870912)!==0&&(i.flags&128)===0&&(ha(i),i.subtreeFlags&6&&(i.flags|=8192)):ha(i),l=i.updateQueue,l!==null&&id(i,l.retryQueue),l=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==l&&(i.flags|=2048),r!==null&&T(is),null;case 24:return l=null,r!==null&&(l=r.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),Ur(Fa),ha(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function B_(r,i){switch(gf(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Ur(Fa),ie(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return je(i),null;case 31:if(i.memoizedState!==null){if(On(i),i.alternate===null)throw Error(s(340));as()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 13:if(On(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(s(340));as()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return T(Ta),null;case 4:return ie(),null;case 10:return Ur(i.type),null;case 22:case 23:return On(i),Ef(),r!==null&&T(is),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Ur(Fa),null;case 25:return null;default:return null}}function P0(r,i){switch(gf(i),i.tag){case 3:Ur(Fa),ie();break;case 26:case 27:case 5:je(i);break;case 4:ie();break;case 31:i.memoizedState!==null&&On(i);break;case 13:On(i);break;case 19:T(Ta);break;case 10:Ur(i.type);break;case 22:case 23:On(i),Ef(),r!==null&&T(is);break;case 24:Ur(Fa)}}function oo(r,i){try{var l=i.updateQueue,d=l!==null?l.lastEffect:null;if(d!==null){var g=d.next;l=g;do{if((l.tag&r)===r){d=void 0;var v=l.create,B=l.inst;d=v(),B.destroy=d}l=l.next}while(l!==g)}}catch(X){Yt(i,i.return,X)}}function ki(r,i,l){try{var d=i.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var v=g.next;d=v;do{if((d.tag&r)===r){var B=d.inst,X=B.destroy;if(X!==void 0){B.destroy=void 0,g=i;var pe=l,Ee=X;try{Ee()}catch(We){Yt(g,pe,We)}}}d=d.next}while(d!==v)}}catch(We){Yt(i,i.return,We)}}function W0(r){var i=r.updateQueue;if(i!==null){var l=r.stateNode;try{Eg(i,l)}catch(d){Yt(r,r.return,d)}}}function U0(r,i,l){l.props=ds(r.type,r.memoizedProps),l.state=r.memoizedState;try{l.componentWillUnmount()}catch(d){Yt(r,i,d)}}function co(r,i){try{var l=r.ref;if(l!==null){switch(r.tag){case 26:case 27:case 5:var d=r.stateNode;break;case 30:d=r.stateNode;break;default:d=r.stateNode}typeof l=="function"?r.refCleanup=l(d):l.current=d}}catch(g){Yt(r,i,g)}}function Ar(r,i){var l=r.ref,d=r.refCleanup;if(l!==null)if(typeof d=="function")try{d()}catch(g){Yt(r,i,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Yt(r,i,g)}else l.current=null}function $0(r){var i=r.type,l=r.memoizedProps,d=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&d.focus();break e;case"img":l.src?d.src=l.src:l.srcSet&&(d.srcset=l.srcSet)}}catch(g){Yt(r,r.return,g)}}function ch(r,i,l){try{var d=r.stateNode;aS(d,r.type,l,i),d[re]=i}catch(g){Yt(r,r.return,g)}}function H0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Fi(r.type)||r.tag===4}function dh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||H0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Fi(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function uh(r,i,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(r,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(r),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=mr));else if(d!==4&&(d===27&&Fi(r.type)&&(l=r.stateNode,i=null),r=r.child,r!==null))for(uh(r,i,l),r=r.sibling;r!==null;)uh(r,i,l),r=r.sibling}function sd(r,i,l){var d=r.tag;if(d===5||d===6)r=r.stateNode,i?l.insertBefore(r,i):l.appendChild(r);else if(d!==4&&(d===27&&Fi(r.type)&&(l=r.stateNode),r=r.child,r!==null))for(sd(r,i,l),r=r.sibling;r!==null;)sd(r,i,l),r=r.sibling}function V0(r){var i=r.stateNode,l=r.memoizedProps;try{for(var d=r.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);Xa(i,d,l),i[ae]=r,i[re]=l}catch(v){Yt(r,r.return,v)}}var Gr=!1,Oa=!1,fh=!1,Z0=typeof WeakSet=="function"?WeakSet:Set,Va=null;function O_(r,i){if(r=r.containerInfo,Rh=Cd,r=rg(r),rf(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var d=l.getSelection&&l.getSelection();if(d&&d.rangeCount!==0){l=d.anchorNode;var g=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var B=0,X=-1,pe=-1,Ee=0,We=0,Ze=r,Re=null;t:for(;;){for(var Le;Ze!==l||g!==0&&Ze.nodeType!==3||(X=B+g),Ze!==v||d!==0&&Ze.nodeType!==3||(pe=B+d),Ze.nodeType===3&&(B+=Ze.nodeValue.length),(Le=Ze.firstChild)!==null;)Re=Ze,Ze=Le;for(;;){if(Ze===r)break t;if(Re===l&&++Ee===g&&(X=B),Re===v&&++We===d&&(pe=B),(Le=Ze.nextSibling)!==null)break;Ze=Re,Re=Ze.parentNode}Ze=Le}l=X===-1||pe===-1?null:{start:X,end:pe}}else l=null}l=l||{start:0,end:0}}else l=null;for(Bh={focusedElem:r,selectionRange:l},Cd=!1,Va=i;Va!==null;)if(i=Va,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Va=r;else for(;Va!==null;){switch(i=Va,v=i.alternate,r=i.flags,i.tag){case 0:if((r&4)!==0&&(r=i.updateQueue,r=r!==null?r.events:null,r!==null))for(l=0;l<r.length;l++)g=r[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,l=i,g=v.memoizedProps,v=v.memoizedState,d=l.stateNode;try{var ot=ds(l.type,g);r=d.getSnapshotBeforeUpdate(ot,v),d.__reactInternalSnapshotBeforeUpdate=r}catch(pt){Yt(l,l.return,pt)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,l=r.nodeType,l===9)Lh(r);else if(l===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Lh(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(s(163))}if(r=i.sibling,r!==null){r.return=i.return,Va=r;break}Va=i.return}}function G0(r,i,l){var d=l.flags;switch(l.tag){case 0:case 11:case 15:qr(r,l),d&4&&oo(5,l);break;case 1:if(qr(r,l),d&4)if(r=l.stateNode,i===null)try{r.componentDidMount()}catch(B){Yt(l,l.return,B)}else{var g=ds(l.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(g,i,r.__reactInternalSnapshotBeforeUpdate)}catch(B){Yt(l,l.return,B)}}d&64&&W0(l),d&512&&co(l,l.return);break;case 3:if(qr(r,l),d&64&&(r=l.updateQueue,r!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{Eg(r,i)}catch(B){Yt(l,l.return,B)}}break;case 27:i===null&&d&4&&V0(l);case 26:case 5:qr(r,l),i===null&&d&4&&$0(l),d&512&&co(l,l.return);break;case 12:qr(r,l);break;case 31:qr(r,l),d&4&&Y0(r,l);break;case 13:qr(r,l),d&4&&J0(r,l),d&64&&(r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(l=H_.bind(null,l),dS(r,l))));break;case 22:if(d=l.memoizedState!==null||Gr,!d){i=i!==null&&i.memoizedState!==null||Oa,g=Gr;var v=Oa;Gr=d,(Oa=i)&&!v?Yr(r,l,(l.subtreeFlags&8772)!==0):qr(r,l),Gr=g,Oa=v}break;case 30:break;default:qr(r,l)}}function K0(r){var i=r.alternate;i!==null&&(r.alternate=null,K0(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&ue(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var xa=null,Sn=!1;function Kr(r,i,l){for(l=l.child;l!==null;)q0(r,i,l),l=l.sibling}function q0(r,i,l){if(ze&&typeof ze.onCommitFiberUnmount=="function")try{ze.onCommitFiberUnmount(ca,l)}catch{}switch(l.tag){case 26:Oa||Ar(l,i),Kr(r,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Oa||Ar(l,i);var d=xa,g=Sn;Fi(l.type)&&(xa=l.stateNode,Sn=!1),Kr(r,i,l),vo(l.stateNode),xa=d,Sn=g;break;case 5:Oa||Ar(l,i);case 6:if(d=xa,g=Sn,xa=null,Kr(r,i,l),xa=d,Sn=g,xa!==null)if(Sn)try{(xa.nodeType===9?xa.body:xa.nodeName==="HTML"?xa.ownerDocument.body:xa).removeChild(l.stateNode)}catch(v){Yt(l,i,v)}else try{xa.removeChild(l.stateNode)}catch(v){Yt(l,i,v)}break;case 18:xa!==null&&(Sn?(r=xa,Wx(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,l.stateNode),ol(r)):Wx(xa,l.stateNode));break;case 4:d=xa,g=Sn,xa=l.stateNode.containerInfo,Sn=!0,Kr(r,i,l),xa=d,Sn=g;break;case 0:case 11:case 14:case 15:ki(2,l,i),Oa||ki(4,l,i),Kr(r,i,l);break;case 1:Oa||(Ar(l,i),d=l.stateNode,typeof d.componentWillUnmount=="function"&&U0(l,i,d)),Kr(r,i,l);break;case 21:Kr(r,i,l);break;case 22:Oa=(d=Oa)||l.memoizedState!==null,Kr(r,i,l),Oa=d;break;default:Kr(r,i,l)}}function Y0(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{ol(r)}catch(l){Yt(i,i.return,l)}}}function J0(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ol(r)}catch(l){Yt(i,i.return,l)}}function D_(r){switch(r.tag){case 31:case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Z0),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Z0),i;default:throw Error(s(435,r.tag))}}function ld(r,i){var l=D_(r);i.forEach(function(d){if(!l.has(d)){l.add(d);var g=V_.bind(null,r,d);d.then(g,g)}})}function wn(r,i){var l=i.deletions;if(l!==null)for(var d=0;d<l.length;d++){var g=l[d],v=r,B=i,X=B;e:for(;X!==null;){switch(X.tag){case 27:if(Fi(X.type)){xa=X.stateNode,Sn=!1;break e}break;case 5:xa=X.stateNode,Sn=!1;break e;case 3:case 4:xa=X.stateNode.containerInfo,Sn=!0;break e}X=X.return}if(xa===null)throw Error(s(160));q0(v,B,g),xa=null,Sn=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)X0(i,r),i=i.sibling}var xr=null;function X0(r,i){var l=r.alternate,d=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:wn(i,r),kn(r),d&4&&(ki(3,r,r.return),oo(3,r),ki(5,r,r.return));break;case 1:wn(i,r),kn(r),d&512&&(Oa||l===null||Ar(l,l.return)),d&64&&Gr&&(r=r.updateQueue,r!==null&&(d=r.callbacks,d!==null&&(l=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=l===null?d:l.concat(d))));break;case 26:var g=xr;if(wn(i,r),kn(r),d&512&&(Oa||l===null||Ar(l,l.return)),d&4){var v=l!==null?l.memoizedState:null;if(d=r.memoizedState,l===null)if(d===null)if(r.stateNode===null){e:{d=r.type,l=r.memoizedProps,g=g.ownerDocument||g;t:switch(d){case"title":v=g.getElementsByTagName("title")[0],(!v||v[K]||v[ae]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(d),g.head.insertBefore(v,g.querySelector("head > title"))),Xa(v,d,l),v[ae]=r,$e(v),d=v;break e;case"link":var B=Xx("link","href",g).get(d+(l.href||""));if(B){for(var X=0;X<B.length;X++)if(v=B[X],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){B.splice(X,1);break t}}v=g.createElement(d),Xa(v,d,l),g.head.appendChild(v);break;case"meta":if(B=Xx("meta","content",g).get(d+(l.content||""))){for(X=0;X<B.length;X++)if(v=B[X],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){B.splice(X,1);break t}}v=g.createElement(d),Xa(v,d,l),g.head.appendChild(v);break;default:throw Error(s(468,d))}v[ae]=r,$e(v),d=v}r.stateNode=d}else Qx(g,r.type,r.stateNode);else r.stateNode=Jx(g,d,r.memoizedProps);else v!==d?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,d===null?Qx(g,r.type,r.stateNode):Jx(g,d,r.memoizedProps)):d===null&&r.stateNode!==null&&ch(r,r.memoizedProps,l.memoizedProps)}break;case 27:wn(i,r),kn(r),d&512&&(Oa||l===null||Ar(l,l.return)),l!==null&&d&4&&ch(r,r.memoizedProps,l.memoizedProps);break;case 5:if(wn(i,r),kn(r),d&512&&(Oa||l===null||Ar(l,l.return)),r.flags&32){g=r.stateNode;try{hr(g,"")}catch(ot){Yt(r,r.return,ot)}}d&4&&r.stateNode!=null&&(g=r.memoizedProps,ch(r,g,l!==null?l.memoizedProps:g)),d&1024&&(fh=!0);break;case 6:if(wn(i,r),kn(r),d&4){if(r.stateNode===null)throw Error(s(162));d=r.memoizedProps,l=r.stateNode;try{l.nodeValue=d}catch(ot){Yt(r,r.return,ot)}}break;case 3:if(Sd=null,g=xr,xr=bd(i.containerInfo),wn(i,r),xr=g,kn(r),d&4&&l!==null&&l.memoizedState.isDehydrated)try{ol(i.containerInfo)}catch(ot){Yt(r,r.return,ot)}fh&&(fh=!1,Q0(r));break;case 4:d=xr,xr=bd(r.stateNode.containerInfo),wn(i,r),kn(r),xr=d;break;case 12:wn(i,r),kn(r);break;case 31:wn(i,r),kn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,ld(r,d)));break;case 13:wn(i,r),kn(r),r.child.flags&8192&&r.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(cd=qe()),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,ld(r,d)));break;case 22:g=r.memoizedState!==null;var pe=l!==null&&l.memoizedState!==null,Ee=Gr,We=Oa;if(Gr=Ee||g,Oa=We||pe,wn(i,r),Oa=We,Gr=Ee,kn(r),d&8192)e:for(i=r.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(l===null||pe||Gr||Oa||us(r)),l=null,i=r;;){if(i.tag===5||i.tag===26){if(l===null){pe=l=i;try{if(v=pe.stateNode,g)B=v.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{X=pe.stateNode;var Ze=pe.memoizedProps.style,Re=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;X.style.display=Re==null||typeof Re=="boolean"?"":(""+Re).trim()}}catch(ot){Yt(pe,pe.return,ot)}}}else if(i.tag===6){if(l===null){pe=i;try{pe.stateNode.nodeValue=g?"":pe.memoizedProps}catch(ot){Yt(pe,pe.return,ot)}}}else if(i.tag===18){if(l===null){pe=i;try{var Le=pe.stateNode;g?Ux(Le,!0):Ux(pe.stateNode,!1)}catch(ot){Yt(pe,pe.return,ot)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=r.updateQueue,d!==null&&(l=d.retryQueue,l!==null&&(d.retryQueue=null,ld(r,l))));break;case 19:wn(i,r),kn(r),d&4&&(d=r.updateQueue,d!==null&&(r.updateQueue=null,ld(r,d)));break;case 30:break;case 21:break;default:wn(i,r),kn(r)}}function kn(r){var i=r.flags;if(i&2){try{for(var l,d=r.return;d!==null;){if(H0(d)){l=d;break}d=d.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var g=l.stateNode,v=dh(r);sd(r,v,g);break;case 5:var B=l.stateNode;l.flags&32&&(hr(B,""),l.flags&=-33);var X=dh(r);sd(r,X,B);break;case 3:case 4:var pe=l.stateNode.containerInfo,Ee=dh(r);uh(r,Ee,pe);break;default:throw Error(s(161))}}catch(We){Yt(r,r.return,We)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Q0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;Q0(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function qr(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)G0(r,i.alternate,i),i=i.sibling}function us(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:ki(4,i,i.return),us(i);break;case 1:Ar(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&U0(i,i.return,l),us(i);break;case 27:vo(i.stateNode);case 26:case 5:Ar(i,i.return),us(i);break;case 22:i.memoizedState===null&&us(i);break;case 30:us(i);break;default:us(i)}r=r.sibling}}function Yr(r,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,g=r,v=i,B=v.flags;switch(v.tag){case 0:case 11:case 15:Yr(g,v,l),oo(4,v);break;case 1:if(Yr(g,v,l),d=v,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Ee){Yt(d,d.return,Ee)}if(d=v,g=d.updateQueue,g!==null){var X=d.stateNode;try{var pe=g.shared.hiddenCallbacks;if(pe!==null)for(g.shared.hiddenCallbacks=null,g=0;g<pe.length;g++)Ag(pe[g],X)}catch(Ee){Yt(d,d.return,Ee)}}l&&B&64&&W0(v),co(v,v.return);break;case 27:V0(v);case 26:case 5:Yr(g,v,l),l&&d===null&&B&4&&$0(v),co(v,v.return);break;case 12:Yr(g,v,l);break;case 31:Yr(g,v,l),l&&B&4&&Y0(g,v);break;case 13:Yr(g,v,l),l&&B&4&&J0(g,v);break;case 22:v.memoizedState===null&&Yr(g,v,l),co(v,v.return);break;case 30:break;default:Yr(g,v,l)}i=i.sibling}}function hh(r,i){var l=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(l=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==l&&(r!=null&&r.refCount++,l!=null&&ql(l))}function mh(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&ql(r))}function yr(r,i,l,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)ex(r,i,l,d),i=i.sibling}function ex(r,i,l,d){var g=i.flags;switch(i.tag){case 0:case 11:case 15:yr(r,i,l,d),g&2048&&oo(9,i);break;case 1:yr(r,i,l,d);break;case 3:yr(r,i,l,d),g&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&ql(r)));break;case 12:if(g&2048){yr(r,i,l,d),r=i.stateNode;try{var v=i.memoizedProps,B=v.id,X=v.onPostCommit;typeof X=="function"&&X(B,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(pe){Yt(i,i.return,pe)}}else yr(r,i,l,d);break;case 31:yr(r,i,l,d);break;case 13:yr(r,i,l,d);break;case 23:break;case 22:v=i.stateNode,B=i.alternate,i.memoizedState!==null?v._visibility&2?yr(r,i,l,d):uo(r,i):v._visibility&2?yr(r,i,l,d):(v._visibility|=2,Js(r,i,l,d,(i.subtreeFlags&10256)!==0||!1)),g&2048&&hh(B,i);break;case 24:yr(r,i,l,d),g&2048&&mh(i.alternate,i);break;default:yr(r,i,l,d)}}function Js(r,i,l,d,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=r,B=i,X=l,pe=d,Ee=B.flags;switch(B.tag){case 0:case 11:case 15:Js(v,B,X,pe,g),oo(8,B);break;case 23:break;case 22:var We=B.stateNode;B.memoizedState!==null?We._visibility&2?Js(v,B,X,pe,g):uo(v,B):(We._visibility|=2,Js(v,B,X,pe,g)),g&&Ee&2048&&hh(B.alternate,B);break;case 24:Js(v,B,X,pe,g),g&&Ee&2048&&mh(B.alternate,B);break;default:Js(v,B,X,pe,g)}i=i.sibling}}function uo(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=r,d=i,g=d.flags;switch(d.tag){case 22:uo(l,d),g&2048&&hh(d.alternate,d);break;case 24:uo(l,d),g&2048&&mh(d.alternate,d);break;default:uo(l,d)}i=i.sibling}}var fo=8192;function Xs(r,i,l){if(r.subtreeFlags&fo)for(r=r.child;r!==null;)tx(r,i,l),r=r.sibling}function tx(r,i,l){switch(r.tag){case 26:Xs(r,i,l),r.flags&fo&&r.memoizedState!==null&&_S(l,xr,r.memoizedState,r.memoizedProps);break;case 5:Xs(r,i,l);break;case 3:case 4:var d=xr;xr=bd(r.stateNode.containerInfo),Xs(r,i,l),xr=d;break;case 22:r.memoizedState===null&&(d=r.alternate,d!==null&&d.memoizedState!==null?(d=fo,fo=16777216,Xs(r,i,l),fo=d):Xs(r,i,l));break;default:Xs(r,i,l)}}function ax(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function ho(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];Va=d,rx(d,r)}ax(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)nx(r),r=r.sibling}function nx(r){switch(r.tag){case 0:case 11:case 15:ho(r),r.flags&2048&&ki(9,r,r.return);break;case 3:ho(r);break;case 12:ho(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,od(r)):ho(r);break;default:ho(r)}}function od(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var d=i[l];Va=d,rx(d,r)}ax(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:ki(8,i,i.return),od(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,od(i));break;default:od(i)}r=r.sibling}}function rx(r,i){for(;Va!==null;){var l=Va;switch(l.tag){case 0:case 11:case 15:ki(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var d=l.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:ql(l.memoizedState.cache)}if(d=l.child,d!==null)d.return=l,Va=d;else e:for(l=r;Va!==null;){d=Va;var g=d.sibling,v=d.return;if(K0(d),d===l){Va=null;break e}if(g!==null){g.return=v,Va=g;break e}Va=v}}}var L_={getCacheForType:function(r){var i=Ya(Fa),l=i.data.get(r);return l===void 0&&(l=r(),i.data.set(r,l)),l},cacheSignal:function(){return Ya(Fa).controller.signal}},M_=typeof WeakMap=="function"?WeakMap:Map,Ht=0,la=null,Rt=null,Dt=0,qt=0,Dn=null,zi=!1,Qs=!1,ph=!1,Jr=0,_a=0,Ci=0,fs=0,gh=0,Ln=0,el=0,mo=null,zn=null,xh=!1,cd=0,ix=0,dd=1/0,ud=null,Ti=null,Wa=0,Ni=null,tl=null,Xr=0,yh=0,vh=null,sx=null,po=0,jh=null;function Mn(){return(Ht&2)!==0&&Dt!==0?Dt&-Dt:W.T!==null?zh():Y()}function lx(){if(Ln===0)if((Dt&536870912)===0||Mt){var r=ta;ta<<=1,(ta&3932160)===0&&(ta=262144),Ln=r}else Ln=536870912;return r=Bn.current,r!==null&&(r.flags|=32),Ln}function Cn(r,i,l){(r===la&&(qt===2||qt===9)||r.cancelPendingCommit!==null)&&(al(r,0),Ai(r,Dt,Ln,!1)),At(r,l),((Ht&2)===0||r!==la)&&(r===la&&((Ht&2)===0&&(fs|=l),_a===4&&Ai(r,Dt,Ln,!1)),Er(r))}function ox(r,i,l){if((Ht&6)!==0)throw Error(s(327));var d=!l&&(i&127)===0&&(i&r.expiredLanes)===0||Ie(r,i),g=d?W_(r,i):_h(r,i,!0),v=d;do{if(g===0){Qs&&!d&&Ai(r,i,0,!1);break}else{if(l=r.current.alternate,v&&!I_(l)){g=_h(r,i,!1),v=!1;continue}if(g===2){if(v=i,r.errorRecoveryDisabledLanes&v)var B=0;else B=r.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){i=B;e:{var X=r;g=mo;var pe=X.current.memoizedState.isDehydrated;if(pe&&(al(X,B).flags|=256),B=_h(X,B,!1),B!==2){if(ph&&!pe){X.errorRecoveryDisabledLanes|=v,fs|=v,g=4;break e}v=zn,zn=g,v!==null&&(zn===null?zn=v:zn.push.apply(zn,v))}g=B}if(v=!1,g!==2)continue}}if(g===1){al(r,0),Ai(r,i,0,!0);break}e:{switch(d=r,v=g,v){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:Ai(d,i,Ln,!zi);break e;case 2:zn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(g=cd+300-qe(),10<g)){if(Ai(d,i,Ln,!zi),xe(d,0,!0)!==0)break e;Xr=i,d.timeoutHandle=Ix(cx.bind(null,d,l,zn,ud,xh,i,Ln,fs,el,zi,v,"Throttled",-0,0),g);break e}cx(d,l,zn,ud,xh,i,Ln,fs,el,zi,v,null,-0,0)}}break}while(!0);Er(r)}function cx(r,i,l,d,g,v,B,X,pe,Ee,We,Ze,Re,Le){if(r.timeoutHandle=-1,Ze=i.subtreeFlags,Ze&8192||(Ze&16785408)===16785408){Ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:mr},tx(i,v,Ze);var ot=(v&62914560)===v?cd-qe():(v&4194048)===v?ix-qe():0;if(ot=SS(Ze,ot),ot!==null){Xr=v,r.cancelPendingCommit=ot(xx.bind(null,r,i,v,l,d,g,B,X,pe,We,Ze,null,Re,Le)),Ai(r,v,B,!Ee);return}}xx(r,i,v,l,d,g,B,X,pe)}function I_(r){for(var i=r;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var d=0;d<l.length;d++){var g=l[d],v=g.getSnapshot;g=g.value;try{if(!Fn(v(),g))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ai(r,i,l,d){i&=~gh,i&=~fs,r.suspendedLanes|=i,r.pingedLanes&=~i,d&&(r.warmLanes|=i),d=r.expirationTimes;for(var g=i;0<g;){var v=31-it(g),B=1<<v;d[v]=-1,g&=~B}l!==0&&ja(r,l,i)}function fd(){return(Ht&6)===0?(go(0),!1):!0}function bh(){if(Rt!==null){if(qt===0)var r=Rt.return;else r=Rt,Wr=ns=null,Lf(r),Zs=null,Jl=0,r=Rt;for(;r!==null;)P0(r.alternate,r),r=r.return;Rt=null}}function al(r,i){var l=r.timeoutHandle;l!==-1&&(r.timeoutHandle=-1,iS(l)),l=r.cancelPendingCommit,l!==null&&(r.cancelPendingCommit=null,l()),Xr=0,bh(),la=r,Rt=l=Ir(r.current,null),Dt=i,qt=0,Dn=null,zi=!1,Qs=Ie(r,i),ph=!1,el=Ln=gh=fs=Ci=_a=0,zn=mo=null,xh=!1,(i&8)!==0&&(i|=i&32);var d=r.entangledLanes;if(d!==0)for(r=r.entanglements,d&=i;0<d;){var g=31-it(d),v=1<<g;i|=r[g],d&=~v}return Jr=i,Rc(),l}function dx(r,i){wt=null,W.H=io,i===Vs||i===Wc?(i=zg(),qt=3):i===kf?(i=zg(),qt=4):qt=i===Qf?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Dn=i,Rt===null&&(_a=1,td(r,Jn(i,r.current)))}function ux(){var r=Bn.current;return r===null?!0:(Dt&4194048)===Dt?tr===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?r===tr:!1}function fx(){var r=W.H;return W.H=io,r===null?io:r}function hx(){var r=W.A;return W.A=L_,r}function hd(){_a=4,zi||(Dt&4194048)!==Dt&&Bn.current!==null||(Qs=!0),(Ci&134217727)===0&&(fs&134217727)===0||la===null||Ai(la,Dt,Ln,!1)}function _h(r,i,l){var d=Ht;Ht|=2;var g=fx(),v=hx();(la!==r||Dt!==i)&&(ud=null,al(r,i)),i=!1;var B=_a;e:do try{if(qt!==0&&Rt!==null){var X=Rt,pe=Dn;switch(qt){case 8:bh(),B=6;break e;case 3:case 2:case 9:case 6:Bn.current===null&&(i=!0);var Ee=qt;if(qt=0,Dn=null,nl(r,X,pe,Ee),l&&Qs){B=0;break e}break;default:Ee=qt,qt=0,Dn=null,nl(r,X,pe,Ee)}}P_(),B=_a;break}catch(We){dx(r,We)}while(!0);return i&&r.shellSuspendCounter++,Wr=ns=null,Ht=d,W.H=g,W.A=v,Rt===null&&(la=null,Dt=0,Rc()),B}function P_(){for(;Rt!==null;)mx(Rt)}function W_(r,i){var l=Ht;Ht|=2;var d=fx(),g=hx();la!==r||Dt!==i?(ud=null,dd=qe()+500,al(r,i)):Qs=Ie(r,i);e:do try{if(qt!==0&&Rt!==null){i=Rt;var v=Dn;t:switch(qt){case 1:qt=0,Dn=null,nl(r,i,v,1);break;case 2:case 9:if(wg(v)){qt=0,Dn=null,px(i);break}i=function(){qt!==2&&qt!==9||la!==r||(qt=7),Er(r)},v.then(i,i);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:wg(v)?(qt=0,Dn=null,px(i)):(qt=0,Dn=null,nl(r,i,v,7));break;case 5:var B=null;switch(Rt.tag){case 26:B=Rt.memoizedState;case 5:case 27:var X=Rt;if(B?ey(B):X.stateNode.complete){qt=0,Dn=null;var pe=X.sibling;if(pe!==null)Rt=pe;else{var Ee=X.return;Ee!==null?(Rt=Ee,md(Ee)):Rt=null}break t}}qt=0,Dn=null,nl(r,i,v,5);break;case 6:qt=0,Dn=null,nl(r,i,v,6);break;case 8:bh(),_a=6;break e;default:throw Error(s(462))}}U_();break}catch(We){dx(r,We)}while(!0);return Wr=ns=null,W.H=d,W.A=g,Ht=l,Rt!==null?0:(la=null,Dt=0,Rc(),_a)}function U_(){for(;Rt!==null&&!ht();)mx(Rt)}function mx(r){var i=M0(r.alternate,r,Jr);r.memoizedProps=r.pendingProps,i===null?md(r):Rt=i}function px(r){var i=r,l=i.alternate;switch(i.tag){case 15:case 0:i=F0(l,i,i.pendingProps,i.type,void 0,Dt);break;case 11:i=F0(l,i,i.pendingProps,i.type.render,i.ref,Dt);break;case 5:Lf(i);default:P0(l,i),i=Rt=hg(i,Jr),i=M0(l,i,Jr)}r.memoizedProps=r.pendingProps,i===null?md(r):Rt=i}function nl(r,i,l,d){Wr=ns=null,Lf(i),Zs=null,Jl=0;var g=i.return;try{if(A_(r,g,i,l,Dt)){_a=1,td(r,Jn(l,r.current)),Rt=null;return}}catch(v){if(g!==null)throw Rt=g,v;_a=1,td(r,Jn(l,r.current)),Rt=null;return}i.flags&32768?(Mt||d===1?r=!0:Qs||(Dt&536870912)!==0?r=!1:(zi=r=!0,(d===2||d===9||d===3||d===6)&&(d=Bn.current,d!==null&&d.tag===13&&(d.flags|=16384))),gx(i,r)):md(i)}function md(r){var i=r;do{if((i.flags&32768)!==0){gx(i,zi);return}r=i.return;var l=R_(i.alternate,i,Jr);if(l!==null){Rt=l;return}if(i=i.sibling,i!==null){Rt=i;return}Rt=i=r}while(i!==null);_a===0&&(_a=5)}function gx(r,i){do{var l=B_(r.alternate,r);if(l!==null){l.flags&=32767,Rt=l;return}if(l=r.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(r=r.sibling,r!==null)){Rt=r;return}Rt=r=l}while(r!==null);_a=6,Rt=null}function xx(r,i,l,d,g,v,B,X,pe){r.cancelPendingCommit=null;do pd();while(Wa!==0);if((Ht&6)!==0)throw Error(s(327));if(i!==null){if(i===r.current)throw Error(s(177));if(v=i.lanes|i.childLanes,v|=df,za(r,l,v,B,X,pe),r===la&&(Rt=la=null,Dt=0),tl=i,Ni=r,Xr=l,yh=v,vh=g,sx=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,Z_(zt,function(){return _x(),null})):(r.callbackNode=null,r.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=W.T,W.T=null,g=J.p,J.p=2,B=Ht,Ht|=4;try{O_(r,i,l)}finally{Ht=B,J.p=g,W.T=d}}Wa=1,yx(),vx(),jx()}}function yx(){if(Wa===1){Wa=0;var r=Ni,i=tl,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var d=J.p;J.p=2;var g=Ht;Ht|=4;try{X0(i,r);var v=Bh,B=rg(r.containerInfo),X=v.focusedElem,pe=v.selectionRange;if(B!==X&&X&&X.ownerDocument&&ng(X.ownerDocument.documentElement,X)){if(pe!==null&&rf(X)){var Ee=pe.start,We=pe.end;if(We===void 0&&(We=Ee),"selectionStart"in X)X.selectionStart=Ee,X.selectionEnd=Math.min(We,X.value.length);else{var Ze=X.ownerDocument||document,Re=Ze&&Ze.defaultView||window;if(Re.getSelection){var Le=Re.getSelection(),ot=X.textContent.length,pt=Math.min(pe.start,ot),ra=pe.end===void 0?pt:Math.min(pe.end,ot);!Le.extend&&pt>ra&&(B=ra,ra=pt,pt=B);var we=ag(X,pt),ye=ag(X,ra);if(we&&ye&&(Le.rangeCount!==1||Le.anchorNode!==we.node||Le.anchorOffset!==we.offset||Le.focusNode!==ye.node||Le.focusOffset!==ye.offset)){var Ae=Ze.createRange();Ae.setStart(we.node,we.offset),Le.removeAllRanges(),pt>ra?(Le.addRange(Ae),Le.extend(ye.node,ye.offset)):(Ae.setEnd(ye.node,ye.offset),Le.addRange(Ae))}}}}for(Ze=[],Le=X;Le=Le.parentNode;)Le.nodeType===1&&Ze.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Ze.length;X++){var He=Ze[X];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}Cd=!!Rh,Bh=Rh=null}finally{Ht=g,J.p=d,W.T=l}}r.current=i,Wa=2}}function vx(){if(Wa===2){Wa=0;var r=Ni,i=tl,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var d=J.p;J.p=2;var g=Ht;Ht|=4;try{G0(r,i.alternate,i)}finally{Ht=g,J.p=d,W.T=l}}Wa=3}}function jx(){if(Wa===4||Wa===3){Wa=0,xt();var r=Ni,i=tl,l=Xr,d=sx;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Wa=5:(Wa=0,tl=Ni=null,bx(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(Ti=null),ga(l),i=i.stateNode,ze&&typeof ze.onCommitFiberRoot=="function")try{ze.onCommitFiberRoot(ca,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=W.T,g=J.p,J.p=2,W.T=null;try{for(var v=r.onRecoverableError,B=0;B<d.length;B++){var X=d[B];v(X.value,{componentStack:X.stack})}}finally{W.T=i,J.p=g}}(Xr&3)!==0&&pd(),Er(r),g=r.pendingLanes,(l&261930)!==0&&(g&42)!==0?r===jh?po++:(po=0,jh=r):po=0,go(0)}}function bx(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,ql(i)))}function pd(){return yx(),vx(),jx(),_x()}function _x(){if(Wa!==5)return!1;var r=Ni,i=yh;yh=0;var l=ga(Xr),d=W.T,g=J.p;try{J.p=32>l?32:l,W.T=null,l=vh,vh=null;var v=Ni,B=Xr;if(Wa=0,tl=Ni=null,Xr=0,(Ht&6)!==0)throw Error(s(331));var X=Ht;if(Ht|=4,nx(v.current),ex(v,v.current,B,l),Ht=X,go(0,!1),ze&&typeof ze.onPostCommitFiberRoot=="function")try{ze.onPostCommitFiberRoot(ca,v)}catch{}return!0}finally{J.p=g,W.T=d,bx(r,i)}}function Sx(r,i,l){i=Jn(l,i),i=Xf(r.stateNode,i,2),r=_i(r,i,2),r!==null&&(At(r,2),Er(r))}function Yt(r,i,l){if(r.tag===3)Sx(r,r,l);else for(;i!==null;){if(i.tag===3){Sx(i,r,l);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Ti===null||!Ti.has(d))){r=Jn(l,r),l=w0(2),d=_i(i,l,2),d!==null&&(k0(l,d,i,r),At(d,2),Er(d));break}}i=i.return}}function Sh(r,i,l){var d=r.pingCache;if(d===null){d=r.pingCache=new M_;var g=new Set;d.set(i,g)}else g=d.get(i),g===void 0&&(g=new Set,d.set(i,g));g.has(l)||(ph=!0,g.add(l),r=$_.bind(null,r,i,l),i.then(r,r))}function $_(r,i,l){var d=r.pingCache;d!==null&&d.delete(i),r.pingedLanes|=r.suspendedLanes&l,r.warmLanes&=~l,la===r&&(Dt&l)===l&&(_a===4||_a===3&&(Dt&62914560)===Dt&&300>qe()-cd?(Ht&2)===0&&al(r,0):gh|=l,el===Dt&&(el=0)),Er(r)}function wx(r,i){i===0&&(i=Oe()),r=es(r,i),r!==null&&(At(r,i),Er(r))}function H_(r){var i=r.memoizedState,l=0;i!==null&&(l=i.retryLane),wx(r,l)}function V_(r,i){var l=0;switch(r.tag){case 31:case 13:var d=r.stateNode,g=r.memoizedState;g!==null&&(l=g.retryLane);break;case 19:d=r.stateNode;break;case 22:d=r.stateNode._retryCache;break;default:throw Error(s(314))}d!==null&&d.delete(i),wx(r,l)}function Z_(r,i){return lt(r,i)}var gd=null,rl=null,wh=!1,xd=!1,kh=!1,Ei=0;function Er(r){r!==rl&&r.next===null&&(rl===null?gd=rl=r:rl=rl.next=r),xd=!0,wh||(wh=!0,K_())}function go(r,i){if(!kh&&xd){kh=!0;do for(var l=!1,d=gd;d!==null;){if(r!==0){var g=d.pendingLanes;if(g===0)var v=0;else{var B=d.suspendedLanes,X=d.pingedLanes;v=(1<<31-it(42|r)+1)-1,v&=g&~(B&~X),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,Tx(d,v))}else v=Dt,v=xe(d,d===la?v:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(v&3)===0||Ie(d,v)||(l=!0,Tx(d,v));d=d.next}while(l);kh=!1}}function G_(){kx()}function kx(){xd=wh=!1;var r=0;Ei!==0&&rS()&&(r=Ei);for(var i=qe(),l=null,d=gd;d!==null;){var g=d.next,v=zx(d,i);v===0?(d.next=null,l===null?gd=g:l.next=g,g===null&&(rl=l)):(l=d,(r!==0||(v&3)!==0)&&(xd=!0)),d=g}Wa!==0&&Wa!==5||go(r),Ei!==0&&(Ei=0)}function zx(r,i){for(var l=r.suspendedLanes,d=r.pingedLanes,g=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var B=31-it(v),X=1<<B,pe=g[B];pe===-1?((X&l)===0||(X&d)!==0)&&(g[B]=mt(X,i)):pe<=i&&(r.expiredLanes|=X),v&=~X}if(i=la,l=Dt,l=xe(r,r===i?l:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d=r.callbackNode,l===0||r===i&&(qt===2||qt===9)||r.cancelPendingCommit!==null)return d!==null&&d!==null&&tt(d),r.callbackNode=null,r.callbackPriority=0;if((l&3)===0||Ie(r,l)){if(i=l&-l,i===r.callbackPriority)return i;switch(d!==null&&tt(d),ga(l)){case 2:case 8:l=_t;break;case 32:l=zt;break;case 268435456:l=va;break;default:l=zt}return d=Cx.bind(null,r),l=lt(l,d),r.callbackPriority=i,r.callbackNode=l,i}return d!==null&&d!==null&&tt(d),r.callbackPriority=2,r.callbackNode=null,2}function Cx(r,i){if(Wa!==0&&Wa!==5)return r.callbackNode=null,r.callbackPriority=0,null;var l=r.callbackNode;if(pd()&&r.callbackNode!==l)return null;var d=Dt;return d=xe(r,r===la?d:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),d===0?null:(ox(r,d,i),zx(r,qe()),r.callbackNode!=null&&r.callbackNode===l?Cx.bind(null,r):null)}function Tx(r,i){if(pd())return null;ox(r,i,!0)}function K_(){sS(function(){(Ht&6)!==0?lt(st,G_):kx()})}function zh(){if(Ei===0){var r=$s;r===0&&(r=ut,ut<<=1,(ut&261888)===0&&(ut=256)),Ei=r}return Ei}function Nx(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Es(""+r)}function Ax(r,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,r.id&&l.setAttribute("form",r.id),i.parentNode.insertBefore(l,i),r=new FormData(r),l.parentNode.removeChild(l),r}function q_(r,i,l,d,g){if(i==="submit"&&l&&l.stateNode===g){var v=Nx((g[re]||null).action),B=d.submitter;B&&(i=(i=B[re]||null)?Nx(i.formAction):B.getAttribute("formAction"),i!==null&&(v=i,B=null));var X=new Nc("action","action",null,d,g);r.push({event:X,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Ei!==0){var pe=B?Ax(g,B):new FormData(g);Zf(l,{pending:!0,data:pe,method:g.method,action:v},null,pe)}}else typeof v=="function"&&(X.preventDefault(),pe=B?Ax(g,B):new FormData(g),Zf(l,{pending:!0,data:pe,method:g.method,action:v},v,pe))},currentTarget:g}]})}}for(var Ch=0;Ch<cf.length;Ch++){var Th=cf[Ch],Y_=Th.toLowerCase(),J_=Th[0].toUpperCase()+Th.slice(1);gr(Y_,"on"+J_)}gr(lg,"onAnimationEnd"),gr(og,"onAnimationIteration"),gr(cg,"onAnimationStart"),gr("dblclick","onDoubleClick"),gr("focusin","onFocus"),gr("focusout","onBlur"),gr(h_,"onTransitionRun"),gr(m_,"onTransitionStart"),gr(p_,"onTransitionCancel"),gr(dg,"onTransitionEnd"),cn("onMouseEnter",["mouseout","mouseover"]),cn("onMouseLeave",["mouseout","mouseover"]),cn("onPointerEnter",["pointerout","pointerover"]),cn("onPointerLeave",["pointerout","pointerover"]),Kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),X_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xo));function Ex(r,i){i=(i&4)!==0;for(var l=0;l<r.length;l++){var d=r[l],g=d.event;d=d.listeners;e:{var v=void 0;if(i)for(var B=d.length-1;0<=B;B--){var X=d[B],pe=X.instance,Ee=X.currentTarget;if(X=X.listener,pe!==v&&g.isPropagationStopped())break e;v=X,g.currentTarget=Ee;try{v(g)}catch(We){Fc(We)}g.currentTarget=null,v=pe}else for(B=0;B<d.length;B++){if(X=d[B],pe=X.instance,Ee=X.currentTarget,X=X.listener,pe!==v&&g.isPropagationStopped())break e;v=X,g.currentTarget=Ee;try{v(g)}catch(We){Fc(We)}g.currentTarget=null,v=pe}}}}function Bt(r,i){var l=i[Ce];l===void 0&&(l=i[Ce]=new Set);var d=r+"__bubble";l.has(d)||(Fx(i,r,2,!1),l.add(d))}function Nh(r,i,l){var d=0;i&&(d|=4),Fx(l,r,d,i)}var yd="_reactListening"+Math.random().toString(36).slice(2);function Ah(r){if(!r[yd]){r[yd]=!0,yt.forEach(function(l){l!=="selectionchange"&&(X_.has(l)||Nh(l,!1,r),Nh(l,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[yd]||(i[yd]=!0,Nh("selectionchange",!1,i))}}function Fx(r,i,l,d){switch(ly(i)){case 2:var g=zS;break;case 8:g=CS;break;default:g=Vh}l=g.bind(null,i,l,r),g=void 0,!Ge||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),d?g!==void 0?r.addEventListener(i,l,{capture:!0,passive:g}):r.addEventListener(i,l,!0):g!==void 0?r.addEventListener(i,l,{passive:g}):r.addEventListener(i,l,!1)}function Eh(r,i,l,d,g){var v=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var B=d.tag;if(B===3||B===4){var X=d.stateNode.containerInfo;if(X===g)break;if(B===4)for(B=d.return;B!==null;){var pe=B.tag;if((pe===3||pe===4)&&B.stateNode.containerInfo===g)return;B=B.return}for(;X!==null;){if(B=ke(X),B===null)return;if(pe=B.tag,pe===5||pe===6||pe===26||pe===27){d=v=B;continue e}X=X.parentNode}}d=d.return}zc(function(){var Ee=v,We=Ml(l),Ze=[];e:{var Re=ug.get(r);if(Re!==void 0){var Le=Nc,ot=r;switch(r){case"keypress":if(Fs(l)===0)break e;case"keydown":case"keyup":Le=Vb;break;case"focusin":ot="focus",Le=Qu;break;case"focusout":ot="blur",Le=Qu;break;case"beforeblur":case"afterblur":Le=Qu;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=Pp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=Rb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=Kb;break;case lg:case og:case cg:Le=Db;break;case dg:Le=Yb;break;case"scroll":case"scrollend":Le=Eb;break;case"wheel":Le=Xb;break;case"copy":case"cut":case"paste":Le=Mb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=Up;break;case"toggle":case"beforetoggle":Le=e_}var pt=(i&4)!==0,ra=!pt&&(r==="scroll"||r==="scrollend"),we=pt?Re!==null?Re+"Capture":null:Re;pt=[];for(var ye=Ee,Ae;ye!==null;){var He=ye;if(Ae=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||Ae===null||we===null||(He=Ji(ye,we),He!=null&&pt.push(yo(ye,He,Ae))),ra)break;ye=ye.return}0<pt.length&&(Re=new Le(Re,ot,null,l,We),Ze.push({event:Re,listeners:pt}))}}if((i&7)===0){e:{if(Re=r==="mouseover"||r==="pointerover",Le=r==="mouseout"||r==="pointerout",Re&&l!==Ll&&(ot=l.relatedTarget||l.fromElement)&&(ke(ot)||ot[ce]))break e;if((Le||Re)&&(Re=We.window===We?We:(Re=We.ownerDocument)?Re.defaultView||Re.parentWindow:window,Le?(ot=l.relatedTarget||l.toElement,Le=Ee,ot=ot?ke(ot):null,ot!==null&&(ra=c(ot),pt=ot.tag,ot!==ra||pt!==5&&pt!==27&&pt!==6)&&(ot=null)):(Le=null,ot=Ee),Le!==ot)){if(pt=Pp,He="onMouseLeave",we="onMouseEnter",ye="mouse",(r==="pointerout"||r==="pointerover")&&(pt=Up,He="onPointerLeave",we="onPointerEnter",ye="pointer"),ra=Le==null?Re:Me(Le),Ae=ot==null?Re:Me(ot),Re=new pt(He,ye+"leave",Le,l,We),Re.target=ra,Re.relatedTarget=Ae,He=null,ke(We)===Ee&&(pt=new pt(we,ye+"enter",ot,l,We),pt.target=Ae,pt.relatedTarget=ra,He=pt),ra=He,Le&&ot)t:{for(pt=Q_,we=Le,ye=ot,Ae=0,He=we;He;He=pt(He))Ae++;He=0;for(var ft=ye;ft;ft=pt(ft))He++;for(;0<Ae-He;)we=pt(we),Ae--;for(;0<He-Ae;)ye=pt(ye),He--;for(;Ae--;){if(we===ye||ye!==null&&we===ye.alternate){pt=we;break t}we=pt(we),ye=pt(ye)}pt=null}else pt=null;Le!==null&&Rx(Ze,Re,Le,pt,!1),ot!==null&&ra!==null&&Rx(Ze,ra,ot,pt,!0)}}e:{if(Re=Ee?Me(Ee):window,Le=Re.nodeName&&Re.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Re.type==="file")var Wt=Yp;else if(Kp(Re))if(Jp)Wt=d_;else{Wt=o_;var dt=l_}else Le=Re.nodeName,!Le||Le.toLowerCase()!=="input"||Re.type!=="checkbox"&&Re.type!=="radio"?Ee&&Dl(Ee.elementType)&&(Wt=Yp):Wt=c_;if(Wt&&(Wt=Wt(r,Ee))){qp(Ze,Wt,l,We);break e}dt&&dt(r,Re,Ee),r==="focusout"&&Ee&&Re.type==="number"&&Ee.memoizedProps.value!=null&&Ol(Re,"number",Re.value)}switch(dt=Ee?Me(Ee):window,r){case"focusin":(Kp(dt)||dt.contentEditable==="true")&&(Os=dt,sf=Ee,Zl=null);break;case"focusout":Zl=sf=Os=null;break;case"mousedown":lf=!0;break;case"contextmenu":case"mouseup":case"dragend":lf=!1,ig(Ze,l,We);break;case"selectionchange":if(f_)break;case"keydown":case"keyup":ig(Ze,l,We)}var kt;if(tf)e:{switch(r){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else Bs?Zp(r,l)&&(Lt="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(Lt="onCompositionStart");Lt&&($p&&l.locale!=="ko"&&(Bs||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&Bs&&(kt=Cc()):(ua=We,Ha="value"in ua?ua.value:ua.textContent,Bs=!0)),dt=vd(Ee,Lt),0<dt.length&&(Lt=new Wp(Lt,r,null,l,We),Ze.push({event:Lt,listeners:dt}),kt?Lt.data=kt:(kt=Gp(l),kt!==null&&(Lt.data=kt)))),(kt=a_?n_(r,l):r_(r,l))&&(Lt=vd(Ee,"onBeforeInput"),0<Lt.length&&(dt=new Wp("onBeforeInput","beforeinput",null,l,We),Ze.push({event:dt,listeners:Lt}),dt.data=kt)),q_(Ze,r,Ee,l,We)}Ex(Ze,i)})}function yo(r,i,l){return{instance:r,listener:i,currentTarget:l}}function vd(r,i){for(var l=i+"Capture",d=[];r!==null;){var g=r,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=Ji(r,l),g!=null&&d.unshift(yo(r,g,v)),g=Ji(r,i),g!=null&&d.push(yo(r,g,v))),r.tag===3)return d;r=r.return}return[]}function Q_(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Rx(r,i,l,d,g){for(var v=i._reactName,B=[];l!==null&&l!==d;){var X=l,pe=X.alternate,Ee=X.stateNode;if(X=X.tag,pe!==null&&pe===d)break;X!==5&&X!==26&&X!==27||Ee===null||(pe=Ee,g?(Ee=Ji(l,v),Ee!=null&&B.unshift(yo(l,Ee,pe))):g||(Ee=Ji(l,v),Ee!=null&&B.push(yo(l,Ee,pe)))),l=l.return}B.length!==0&&r.push({event:i,listeners:B})}var eS=/\r\n?/g,tS=/\u0000|\uFFFD/g;function Bx(r){return(typeof r=="string"?r:""+r).replace(eS,`
`).replace(tS,"")}function Ox(r,i){return i=Bx(i),Bx(r)===i}function na(r,i,l,d,g,v){switch(l){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||hr(r,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&hr(r,""+d);break;case"className":ur(r,"class",d);break;case"tabIndex":ur(r,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(r,l,d);break;case"style":wc(r,d,v);break;case"data":if(i!=="object"){ur(r,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||l!=="href")){r.removeAttribute(l);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Es(""+d),r.setAttribute(l,d);break;case"action":case"formAction":if(typeof d=="function"){r.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(i!=="input"&&na(r,i,"name",g.name,g,null),na(r,i,"formEncType",g.formEncType,g,null),na(r,i,"formMethod",g.formMethod,g,null),na(r,i,"formTarget",g.formTarget,g,null)):(na(r,i,"encType",g.encType,g,null),na(r,i,"method",g.method,g,null),na(r,i,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){r.removeAttribute(l);break}d=Es(""+d),r.setAttribute(l,d);break;case"onClick":d!=null&&(r.onclick=mr);break;case"onScroll":d!=null&&Bt("scroll",r);break;case"onScrollEnd":d!=null&&Bt("scrollend",r);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"multiple":r.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":r.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){r.removeAttribute("xlink:href");break}l=Es(""+d),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""+d):r.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,""):r.removeAttribute(l);break;case"capture":case"download":d===!0?r.setAttribute(l,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?r.setAttribute(l,d):r.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?r.setAttribute(l,d):r.removeAttribute(l);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?r.removeAttribute(l):r.setAttribute(l,d);break;case"popover":Bt("beforetoggle",r),Bt("toggle",r),Zt(r,"popover",d);break;case"xlinkActuate":fr(r,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":fr(r,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":fr(r,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":fr(r,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":fr(r,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":fr(r,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":fr(r,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":fr(r,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":fr(r,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Zt(r,"is",d);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=qu.get(l)||l,Zt(r,l,d))}}function Fh(r,i,l,d,g,v){switch(l){case"style":wc(r,d,v);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(s(61));if(l=d.__html,l!=null){if(g.children!=null)throw Error(s(60));r.innerHTML=l}}break;case"children":typeof d=="string"?hr(r,d):(typeof d=="number"||typeof d=="bigint")&&hr(r,""+d);break;case"onScroll":d!=null&&Bt("scroll",r);break;case"onScrollEnd":d!=null&&Bt("scrollend",r);break;case"onClick":d!=null&&(r.onclick=mr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),i=l.slice(2,g?l.length-7:void 0),v=r[re]||null,v=v!=null?v[l]:null,typeof v=="function"&&r.removeEventListener(i,v,g),typeof d=="function")){typeof v!="function"&&v!==null&&(l in r?r[l]=null:r.hasAttribute(l)&&r.removeAttribute(l)),r.addEventListener(i,d,g);break e}l in r?r[l]=d:d===!0?r.setAttribute(l,""):Zt(r,l,d)}}}function Xa(r,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",r),Bt("load",r);var d=!1,g=!1,v;for(v in l)if(l.hasOwnProperty(v)){var B=l[v];if(B!=null)switch(v){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:na(r,i,v,B,l,null)}}g&&na(r,i,"srcSet",l.srcSet,l,null),d&&na(r,i,"src",l.src,l,null);return;case"input":Bt("invalid",r);var X=v=B=g=null,pe=null,Ee=null;for(d in l)if(l.hasOwnProperty(d)){var We=l[d];if(We!=null)switch(d){case"name":g=We;break;case"type":B=We;break;case"checked":pe=We;break;case"defaultChecked":Ee=We;break;case"value":v=We;break;case"defaultValue":X=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(s(137,i));break;default:na(r,i,d,We,l,null)}}_c(r,v,X,pe,Ee,B,g,!1);return;case"select":Bt("invalid",r),d=B=v=null;for(g in l)if(l.hasOwnProperty(g)&&(X=l[g],X!=null))switch(g){case"value":v=X;break;case"defaultValue":B=X;break;case"multiple":d=X;default:na(r,i,g,X,l,null)}i=v,l=B,r.multiple=!!d,i!=null?fi(r,!!d,i,!1):l!=null&&fi(r,!!d,l,!0);return;case"textarea":Bt("invalid",r),v=g=d=null;for(B in l)if(l.hasOwnProperty(B)&&(X=l[B],X!=null))switch(B){case"value":d=X;break;case"defaultValue":g=X;break;case"children":v=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(s(91));break;default:na(r,i,B,X,l,null)}Yi(r,d,g,v);return;case"option":for(pe in l)l.hasOwnProperty(pe)&&(d=l[pe],d!=null)&&(pe==="selected"?r.selected=d&&typeof d!="function"&&typeof d!="symbol":na(r,i,pe,d,l,null));return;case"dialog":Bt("beforetoggle",r),Bt("toggle",r),Bt("cancel",r),Bt("close",r);break;case"iframe":case"object":Bt("load",r);break;case"video":case"audio":for(d=0;d<xo.length;d++)Bt(xo[d],r);break;case"image":Bt("error",r),Bt("load",r);break;case"details":Bt("toggle",r);break;case"embed":case"source":case"link":Bt("error",r),Bt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in l)if(l.hasOwnProperty(Ee)&&(d=l[Ee],d!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:na(r,i,Ee,d,l,null)}return;default:if(Dl(i)){for(We in l)l.hasOwnProperty(We)&&(d=l[We],d!==void 0&&Fh(r,i,We,d,l,void 0));return}}for(X in l)l.hasOwnProperty(X)&&(d=l[X],d!=null&&na(r,i,X,d,l,null))}function aS(r,i,l,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,B=null,X=null,pe=null,Ee=null,We=null;for(Le in l){var Ze=l[Le];if(l.hasOwnProperty(Le)&&Ze!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":pe=Ze;default:d.hasOwnProperty(Le)||na(r,i,Le,null,d,Ze)}}for(var Re in d){var Le=d[Re];if(Ze=l[Re],d.hasOwnProperty(Re)&&(Le!=null||Ze!=null))switch(Re){case"type":v=Le;break;case"name":g=Le;break;case"checked":Ee=Le;break;case"defaultChecked":We=Le;break;case"value":B=Le;break;case"defaultValue":X=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(s(137,i));break;default:Le!==Ze&&na(r,i,Re,Le,d,Ze)}}Bl(r,B,X,pe,Ee,We,v,g);return;case"select":Le=B=X=Re=null;for(v in l)if(pe=l[v],l.hasOwnProperty(v)&&pe!=null)switch(v){case"value":break;case"multiple":Le=pe;default:d.hasOwnProperty(v)||na(r,i,v,null,d,pe)}for(g in d)if(v=d[g],pe=l[g],d.hasOwnProperty(g)&&(v!=null||pe!=null))switch(g){case"value":Re=v;break;case"defaultValue":X=v;break;case"multiple":B=v;default:v!==pe&&na(r,i,g,v,d,pe)}i=X,l=B,d=Le,Re!=null?fi(r,!!l,Re,!1):!!d!=!!l&&(i!=null?fi(r,!!l,i,!0):fi(r,!!l,l?[]:"",!1));return;case"textarea":Le=Re=null;for(X in l)if(g=l[X],l.hasOwnProperty(X)&&g!=null&&!d.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:na(r,i,X,null,d,g)}for(B in d)if(g=d[B],v=l[B],d.hasOwnProperty(B)&&(g!=null||v!=null))switch(B){case"value":Re=g;break;case"defaultValue":Le=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==v&&na(r,i,B,g,d,v)}Sc(r,Re,Le);return;case"option":for(var ot in l)Re=l[ot],l.hasOwnProperty(ot)&&Re!=null&&!d.hasOwnProperty(ot)&&(ot==="selected"?r.selected=!1:na(r,i,ot,null,d,Re));for(pe in d)Re=d[pe],Le=l[pe],d.hasOwnProperty(pe)&&Re!==Le&&(Re!=null||Le!=null)&&(pe==="selected"?r.selected=Re&&typeof Re!="function"&&typeof Re!="symbol":na(r,i,pe,Re,d,Le));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in l)Re=l[pt],l.hasOwnProperty(pt)&&Re!=null&&!d.hasOwnProperty(pt)&&na(r,i,pt,null,d,Re);for(Ee in d)if(Re=d[Ee],Le=l[Ee],d.hasOwnProperty(Ee)&&Re!==Le&&(Re!=null||Le!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(s(137,i));break;default:na(r,i,Ee,Re,d,Le)}return;default:if(Dl(i)){for(var ra in l)Re=l[ra],l.hasOwnProperty(ra)&&Re!==void 0&&!d.hasOwnProperty(ra)&&Fh(r,i,ra,void 0,d,Re);for(We in d)Re=d[We],Le=l[We],!d.hasOwnProperty(We)||Re===Le||Re===void 0&&Le===void 0||Fh(r,i,We,Re,d,Le);return}}for(var we in l)Re=l[we],l.hasOwnProperty(we)&&Re!=null&&!d.hasOwnProperty(we)&&na(r,i,we,null,d,Re);for(Ze in d)Re=d[Ze],Le=l[Ze],!d.hasOwnProperty(Ze)||Re===Le||Re==null&&Le==null||na(r,i,Ze,Re,d,Le)}function Dx(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nS(){if(typeof performance.getEntriesByType=="function"){for(var r=0,i=0,l=performance.getEntriesByType("resource"),d=0;d<l.length;d++){var g=l[d],v=g.transferSize,B=g.initiatorType,X=g.duration;if(v&&X&&Dx(B)){for(B=0,X=g.responseEnd,d+=1;d<l.length;d++){var pe=l[d],Ee=pe.startTime;if(Ee>X)break;var We=pe.transferSize,Ze=pe.initiatorType;We&&Dx(Ze)&&(pe=pe.responseEnd,B+=We*(pe<X?1:(X-Ee)/(pe-Ee)))}if(--d,i+=8*(v+B)/(g.duration/1e3),r++,10<r)break}}if(0<r)return i/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Rh=null,Bh=null;function jd(r){return r.nodeType===9?r:r.ownerDocument}function Lx(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mx(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Oh(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Dh=null;function rS(){var r=window.event;return r&&r.type==="popstate"?r===Dh?!1:(Dh=r,!0):(Dh=null,!1)}var Ix=typeof setTimeout=="function"?setTimeout:void 0,iS=typeof clearTimeout=="function"?clearTimeout:void 0,Px=typeof Promise=="function"?Promise:void 0,sS=typeof queueMicrotask=="function"?queueMicrotask:typeof Px<"u"?function(r){return Px.resolve(null).then(r).catch(lS)}:Ix;function lS(r){setTimeout(function(){throw r})}function Fi(r){return r==="head"}function Wx(r,i){var l=i,d=0;do{var g=l.nextSibling;if(r.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(d===0){r.removeChild(g),ol(i);return}d--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")d++;else if(l==="html")vo(r.ownerDocument.documentElement);else if(l==="head"){l=r.ownerDocument.head,vo(l);for(var v=l.firstChild;v;){var B=v.nextSibling,X=v.nodeName;v[K]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&v.rel.toLowerCase()==="stylesheet"||l.removeChild(v),v=B}}else l==="body"&&vo(r.ownerDocument.body);l=g}while(l);ol(i)}function Ux(r,i){var l=r;r=0;do{var d=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),d&&d.nodeType===8)if(l=d.data,l==="/$"){if(r===0)break;r--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||r++;l=d}while(l)}function Lh(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Lh(l),ue(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}r.removeChild(l)}}function oS(r,i,l,d){for(;r.nodeType===1;){var g=l;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(d){if(!r[K])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=ar(r.nextSibling),r===null)break}return null}function cS(r,i,l){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=ar(r.nextSibling),r===null))return null;return r}function $x(r,i){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!i||(r=ar(r.nextSibling),r===null))return null;return r}function Mh(r){return r.data==="$?"||r.data==="$~"}function Ih(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function dS(r,i){var l=r.ownerDocument;if(r.data==="$~")r._reactRetry=i;else if(r.data!=="$?"||l.readyState!=="loading")i();else{var d=function(){i(),l.removeEventListener("DOMContentLoaded",d)};l.addEventListener("DOMContentLoaded",d),r._reactRetry=d}}function ar(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return r}var Ph=null;function Hx(r){r=r.nextSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"||l==="/&"){if(i===0)return ar(r.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}r=r.nextSibling}return null}function Vx(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return r;i--}else l!=="/$"&&l!=="/&"||i++}r=r.previousSibling}return null}function Zx(r,i,l){switch(i=jd(l),r){case"html":if(r=i.documentElement,!r)throw Error(s(452));return r;case"head":if(r=i.head,!r)throw Error(s(453));return r;case"body":if(r=i.body,!r)throw Error(s(454));return r;default:throw Error(s(451))}}function vo(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);ue(r)}var nr=new Map,Gx=new Set;function bd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Qr=J.d;J.d={f:uS,r:fS,D:hS,C:mS,L:pS,m:gS,X:yS,S:xS,M:vS};function uS(){var r=Qr.f(),i=fd();return r||i}function fS(r){var i=Te(r);i!==null&&i.tag===5&&i.type==="form"?d0(i):Qr.r(r)}var il=typeof document>"u"?null:document;function Kx(r,i,l){var d=il;if(d&&typeof i=="string"&&i){var g=_n(i);g='link[rel="'+r+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Gx.has(g)||(Gx.add(g),r={rel:r,crossOrigin:l,href:i},d.querySelector(g)===null&&(i=d.createElement("link"),Xa(i,"link",r),$e(i),d.head.appendChild(i)))}}function hS(r){Qr.D(r),Kx("dns-prefetch",r,null)}function mS(r,i){Qr.C(r,i),Kx("preconnect",r,i)}function pS(r,i,l){Qr.L(r,i,l);var d=il;if(d&&r&&i){var g='link[rel="preload"][as="'+_n(i)+'"]';i==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+_n(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+_n(l.imageSizes)+'"]')):g+='[href="'+_n(r)+'"]';var v=g;switch(i){case"style":v=sl(r);break;case"script":v=ll(r)}nr.has(v)||(r=j({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:r,as:i},l),nr.set(v,r),d.querySelector(g)!==null||i==="style"&&d.querySelector(jo(v))||i==="script"&&d.querySelector(bo(v))||(i=d.createElement("link"),Xa(i,"link",r),$e(i),d.head.appendChild(i)))}}function gS(r,i){Qr.m(r,i);var l=il;if(l&&r){var d=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+_n(d)+'"][href="'+_n(r)+'"]',v=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=ll(r)}if(!nr.has(v)&&(r=j({rel:"modulepreload",href:r},i),nr.set(v,r),l.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(bo(v)))return}d=l.createElement("link"),Xa(d,"link",r),$e(d),l.head.appendChild(d)}}}function xS(r,i,l){Qr.S(r,i,l);var d=il;if(d&&r){var g=Ye(d).hoistableStyles,v=sl(r);i=i||"default";var B=g.get(v);if(!B){var X={loading:0,preload:null};if(B=d.querySelector(jo(v)))X.loading=5;else{r=j({rel:"stylesheet",href:r,"data-precedence":i},l),(l=nr.get(v))&&Wh(r,l);var pe=B=d.createElement("link");$e(pe),Xa(pe,"link",r),pe._p=new Promise(function(Ee,We){pe.onload=Ee,pe.onerror=We}),pe.addEventListener("load",function(){X.loading|=1}),pe.addEventListener("error",function(){X.loading|=2}),X.loading|=4,_d(B,i,d)}B={type:"stylesheet",instance:B,count:1,state:X},g.set(v,B)}}}function yS(r,i){Qr.X(r,i);var l=il;if(l&&r){var d=Ye(l).hoistableScripts,g=ll(r),v=d.get(g);v||(v=l.querySelector(bo(g)),v||(r=j({src:r,async:!0},i),(i=nr.get(g))&&Uh(r,i),v=l.createElement("script"),$e(v),Xa(v,"link",r),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function vS(r,i){Qr.M(r,i);var l=il;if(l&&r){var d=Ye(l).hoistableScripts,g=ll(r),v=d.get(g);v||(v=l.querySelector(bo(g)),v||(r=j({src:r,async:!0,type:"module"},i),(i=nr.get(g))&&Uh(r,i),v=l.createElement("script"),$e(v),Xa(v,"link",r),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},d.set(g,v))}}function qx(r,i,l,d){var g=(g=D.current)?bd(g):null;if(!g)throw Error(s(446));switch(r){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=sl(l.href),l=Ye(g).hoistableStyles,d=l.get(i),d||(d={type:"style",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){r=sl(l.href);var v=Ye(g).hoistableStyles,B=v.get(r);if(B||(g=g.ownerDocument||g,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,B),(v=g.querySelector(jo(r)))&&!v._p&&(B.instance=v,B.state.loading=5),nr.has(r)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},nr.set(r,l),v||jS(g,r,l,B.state))),i&&d===null)throw Error(s(528,""));return B}if(i&&d!==null)throw Error(s(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ll(l),l=Ye(g).hoistableScripts,d=l.get(i),d||(d={type:"script",instance:null,count:0,state:null},l.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,r))}}function sl(r){return'href="'+_n(r)+'"'}function jo(r){return'link[rel="stylesheet"]['+r+"]"}function Yx(r){return j({},r,{"data-precedence":r.precedence,precedence:null})}function jS(r,i,l,d){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=r.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),Xa(i,"link",l),$e(i),r.head.appendChild(i))}function ll(r){return'[src="'+_n(r)+'"]'}function bo(r){return"script[async]"+r}function Jx(r,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var d=r.querySelector('style[data-href~="'+_n(l.href)+'"]');if(d)return i.instance=d,$e(d),d;var g=j({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return d=(r.ownerDocument||r).createElement("style"),$e(d),Xa(d,"style",g),_d(d,l.precedence,r),i.instance=d;case"stylesheet":g=sl(l.href);var v=r.querySelector(jo(g));if(v)return i.state.loading|=4,i.instance=v,$e(v),v;d=Yx(l),(g=nr.get(g))&&Wh(d,g),v=(r.ownerDocument||r).createElement("link"),$e(v);var B=v;return B._p=new Promise(function(X,pe){B.onload=X,B.onerror=pe}),Xa(v,"link",d),i.state.loading|=4,_d(v,l.precedence,r),i.instance=v;case"script":return v=ll(l.src),(g=r.querySelector(bo(v)))?(i.instance=g,$e(g),g):(d=l,(g=nr.get(v))&&(d=j({},l),Uh(d,g)),r=r.ownerDocument||r,g=r.createElement("script"),$e(g),Xa(g,"link",d),r.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,_d(d,l.precedence,r));return i.instance}function _d(r,i,l){for(var d=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,v=g,B=0;B<d.length;B++){var X=d[B];if(X.dataset.precedence===i)v=X;else if(v!==g)break}v?v.parentNode.insertBefore(r,v.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(r,i.firstChild))}function Wh(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function Uh(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var Sd=null;function Xx(r,i,l){if(Sd===null){var d=new Map,g=Sd=new Map;g.set(l,d)}else g=Sd,d=g.get(l),d||(d=new Map,g.set(l,d));if(d.has(r))return d;for(d.set(r,null),l=l.getElementsByTagName(r),g=0;g<l.length;g++){var v=l[g];if(!(v[K]||v[ae]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var B=v.getAttribute(i)||"";B=r+B;var X=d.get(B);X?X.push(v):d.set(B,[v])}}return d}function Qx(r,i,l){r=r.ownerDocument||r,r.head.insertBefore(l,i==="title"?r.querySelector("head > title"):null)}function bS(r,i,l){if(l===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(r=i.disabled,typeof i.precedence=="string"&&r==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function ey(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function _S(r,i,l,d){if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=sl(d.href),v=i.querySelector(jo(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(r.count++,r=wd.bind(r),i.then(r,r)),l.state.loading|=4,l.instance=v,$e(v);return}v=i.ownerDocument||i,d=Yx(d),(g=nr.get(g))&&Wh(d,g),v=v.createElement("link"),$e(v);var B=v;B._p=new Promise(function(X,pe){B.onload=X,B.onerror=pe}),Xa(v,"link",d),l.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(r.count++,l=wd.bind(r),i.addEventListener("load",l),i.addEventListener("error",l))}}var $h=0;function SS(r,i){return r.stylesheets&&r.count===0&&zd(r,r.stylesheets),0<r.count||0<r.imgCount?function(l){var d=setTimeout(function(){if(r.stylesheets&&zd(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+i);0<r.imgBytes&&$h===0&&($h=62500*nS());var g=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&zd(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>$h?50:800)+i);return r.unsuspend=l,function(){r.unsuspend=null,clearTimeout(d),clearTimeout(g)}}:null}function wd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)zd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var kd=null;function zd(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,kd=new Map,i.forEach(wS,r),kd=null,wd.call(r))}function wS(r,i){if(!(i.state.loading&4)){var l=kd.get(r);if(l)var d=l.get(null);else{l=new Map,kd.set(r,l);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var B=g[v];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(l.set(B.dataset.precedence,B),d=B)}d&&l.set(null,d)}g=i.instance,B=g.getAttribute("data-precedence"),v=l.get(B)||d,v===d&&l.set(null,g),l.set(B,g),this.count++,d=wd.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),v?v.parentNode.insertBefore(g,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),i.state.loading|=4}}var _o={$$typeof:N,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function kS(r,i,l,d,g,v,B,X,pe){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ct(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ct(0),this.hiddenUpdates=ct(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pe,this.incompleteTransitions=new Map}function ty(r,i,l,d,g,v,B,X,pe,Ee,We,Ze){return r=new kS(r,i,l,B,pe,Ee,We,Ze,X),i=1,v===!0&&(i|=24),v=Rn(3,null,null,i),r.current=v,v.stateNode=r,i=_f(),i.refCount++,r.pooledCache=i,i.refCount++,v.memoizedState={element:d,isDehydrated:l,cache:i},zf(v),r}function ay(r){return r?(r=Ms,r):Ms}function ny(r,i,l,d,g,v){g=ay(g),d.context===null?d.context=g:d.pendingContext=g,d=bi(i),d.payload={element:l},v=v===void 0?null:v,v!==null&&(d.callback=v),l=_i(r,d,i),l!==null&&(Cn(l,r,i),Ql(l,r,i))}function ry(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<i?l:i}}function Hh(r,i){ry(r,i),(r=r.alternate)&&ry(r,i)}function iy(r){if(r.tag===13||r.tag===31){var i=es(r,67108864);i!==null&&Cn(i,r,67108864),Hh(r,67108864)}}function sy(r){if(r.tag===13||r.tag===31){var i=Mn();i=Ft(i);var l=es(r,i);l!==null&&Cn(l,r,i),Hh(r,i)}}var Cd=!0;function zS(r,i,l,d){var g=W.T;W.T=null;var v=J.p;try{J.p=2,Vh(r,i,l,d)}finally{J.p=v,W.T=g}}function CS(r,i,l,d){var g=W.T;W.T=null;var v=J.p;try{J.p=8,Vh(r,i,l,d)}finally{J.p=v,W.T=g}}function Vh(r,i,l,d){if(Cd){var g=Zh(d);if(g===null)Eh(r,i,d,Td,l),oy(r,d);else if(NS(g,r,i,l,d))d.stopPropagation();else if(oy(r,d),i&4&&-1<TS.indexOf(r)){for(;g!==null;){var v=Te(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var B=Tt(v.pendingLanes);if(B!==0){var X=v;for(X.pendingLanes|=2,X.entangledLanes|=2;B;){var pe=1<<31-it(B);X.entanglements[1]|=pe,B&=~pe}Er(v),(Ht&6)===0&&(dd=qe()+500,go(0))}}break;case 31:case 13:X=es(v,2),X!==null&&Cn(X,v,2),fd(),Hh(v,2)}if(v=Zh(d),v===null&&Eh(r,i,d,Td,l),v===g)break;g=v}g!==null&&d.stopPropagation()}else Eh(r,i,d,null,l)}}function Zh(r){return r=Ml(r),Gh(r)}var Td=null;function Gh(r){if(Td=null,r=ke(r),r!==null){var i=c(r);if(i===null)r=null;else{var l=i.tag;if(l===13){if(r=u(i),r!==null)return r;r=null}else if(l===31){if(r=h(i),r!==null)return r;r=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Td=r,null}function ly(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Nt()){case st:return 2;case _t:return 8;case zt:case It:return 32;case va:return 268435456;default:return 32}default:return 32}}var Kh=!1,Ri=null,Bi=null,Oi=null,So=new Map,wo=new Map,Di=[],TS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function oy(r,i){switch(r){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":So.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":wo.delete(i.pointerId)}}function ko(r,i,l,d,g,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:l,eventSystemFlags:d,nativeEvent:v,targetContainers:[g]},i!==null&&(i=Te(i),i!==null&&iy(i)),r):(r.eventSystemFlags|=d,i=r.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),r)}function NS(r,i,l,d,g){switch(i){case"focusin":return Ri=ko(Ri,r,i,l,d,g),!0;case"dragenter":return Bi=ko(Bi,r,i,l,d,g),!0;case"mouseover":return Oi=ko(Oi,r,i,l,d,g),!0;case"pointerover":var v=g.pointerId;return So.set(v,ko(So.get(v)||null,r,i,l,d,g)),!0;case"gotpointercapture":return v=g.pointerId,wo.set(v,ko(wo.get(v)||null,r,i,l,d,g)),!0}return!1}function cy(r){var i=ke(r.target);if(i!==null){var l=c(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){r.blockedOn=i,se(r.priority,function(){sy(l)});return}}else if(i===31){if(i=h(l),i!==null){r.blockedOn=i,se(r.priority,function(){sy(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nd(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var l=Zh(r.nativeEvent);if(l===null){l=r.nativeEvent;var d=new l.constructor(l.type,l);Ll=d,l.target.dispatchEvent(d),Ll=null}else return i=Te(l),i!==null&&iy(i),r.blockedOn=l,!1;i.shift()}return!0}function dy(r,i,l){Nd(r)&&l.delete(i)}function AS(){Kh=!1,Ri!==null&&Nd(Ri)&&(Ri=null),Bi!==null&&Nd(Bi)&&(Bi=null),Oi!==null&&Nd(Oi)&&(Oi=null),So.forEach(dy),wo.forEach(dy)}function Ad(r,i){r.blockedOn===i&&(r.blockedOn=null,Kh||(Kh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,AS)))}var Ed=null;function uy(r){Ed!==r&&(Ed=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ed===r&&(Ed=null);for(var i=0;i<r.length;i+=3){var l=r[i],d=r[i+1],g=r[i+2];if(typeof d!="function"){if(Gh(d||l)===null)continue;break}var v=Te(l);v!==null&&(r.splice(i,3),i-=3,Zf(v,{pending:!0,data:g,method:l.method,action:d},d,g))}}))}function ol(r){function i(pe){return Ad(pe,r)}Ri!==null&&Ad(Ri,r),Bi!==null&&Ad(Bi,r),Oi!==null&&Ad(Oi,r),So.forEach(i),wo.forEach(i);for(var l=0;l<Di.length;l++){var d=Di[l];d.blockedOn===r&&(d.blockedOn=null)}for(;0<Di.length&&(l=Di[0],l.blockedOn===null);)cy(l),l.blockedOn===null&&Di.shift();if(l=(r.ownerDocument||r).$$reactFormReplay,l!=null)for(d=0;d<l.length;d+=3){var g=l[d],v=l[d+1],B=g[re]||null;if(typeof v=="function")B||uy(l);else if(B){var X=null;if(v&&v.hasAttribute("formAction")){if(g=v,B=v[re]||null)X=B.formAction;else if(Gh(g)!==null)continue}else X=B.action;typeof X=="function"?l[d+1]=X:(l.splice(d,3),d-=3),uy(l)}}}function fy(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(B){return g=B})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),d||setTimeout(l,20)}function l(){if(!d&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,g=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){d=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function qh(r){this._internalRoot=r}Fd.prototype.render=qh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(s(409));var l=i.current,d=Mn();ny(l,d,r,i,null,null)},Fd.prototype.unmount=qh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;ny(r.current,2,null,r,null,null),fd(),i[ce]=null}};function Fd(r){this._internalRoot=r}Fd.prototype.unstable_scheduleHydration=function(r){if(r){var i=Y();r={blockedOn:null,target:r,priority:i};for(var l=0;l<Di.length&&i!==0&&i<Di[l].priority;l++);Di.splice(l,0,r),l===0&&cy(r)}};var hy=n.version;if(hy!=="19.2.4")throw Error(s(527,hy,"19.2.4"));J.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(s(188)):(r=Object.keys(r).join(","),Error(s(268,r)));return r=p(i),r=r!==null?x(r):null,r=r===null?null:r.stateNode,r};var ES={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rd.isDisabled&&Rd.supportsFiber)try{ca=Rd.inject(ES),ze=Rd}catch{}}return Co.createRoot=function(r,i){if(!o(r))throw Error(s(299));var l=!1,d="",g=j0,v=b0,B=_0;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(B=i.onRecoverableError)),i=ty(r,1,!1,null,null,l,d,null,g,v,B,fy),r[ce]=i.current,Ah(r),new qh(i)},Co.hydrateRoot=function(r,i,l){if(!o(r))throw Error(s(299));var d=!1,g="",v=j0,B=b0,X=_0,pe=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(B=l.onCaughtError),l.onRecoverableError!==void 0&&(X=l.onRecoverableError),l.formState!==void 0&&(pe=l.formState)),i=ty(r,1,!0,i,l??null,d,g,pe,v,B,X,fy),i.context=ay(null),l=i.current,d=Mn(),d=Ft(d),g=bi(d),g.callback=null,_i(l,g,d),l=d,i.current.lanes=l,At(i,l),Er(i),r[ce]=i.current,Ah(r),new Fd(i)},Co.version="19.2.4",Co}var Sy;function WS(){if(Sy)return Xh.exports;Sy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}return t(),Xh.exports=PS(),Xh.exports}var US=WS();var wy="popstate";function $S(t={}){function n(s,o){let{pathname:c,search:u,hash:h}=s.location;return Km("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(s,o){return typeof o=="string"?o:ec(o)}return VS(n,a,null,t)}function ya(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function or(t,n){if(!t){typeof console<"u"&&console.warn(n);try{throw new Error(n)}catch{}}}function HS(){return Math.random().toString(36).substring(2,10)}function ky(t,n){return{usr:t.state,key:t.key,idx:n}}function Km(t,n,a=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof n=="string"?kl(n):n,state:a,key:n&&n.key||s||HS()}}function ec({pathname:t="/",search:n="",hash:a=""}){return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function kl(t){let n={};if(t){let a=t.indexOf("#");a>=0&&(n.hash=t.substring(a),t=t.substring(0,a));let s=t.indexOf("?");s>=0&&(n.search=t.substring(s),t=t.substring(0,s)),t&&(n.pathname=t)}return n}function VS(t,n,a,s={}){let{window:o=document.defaultView,v5Compat:c=!1}=s,u=o.history,h="POP",f=null,p=x();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function x(){return(u.state||{idx:null}).idx}function j(){h="POP";let _=x(),E=_==null?null:_-p;p=_,f&&f({action:h,location:b.location,delta:E})}function y(_,E){h="PUSH";let z=Km(b.location,_,E);p=x()+1;let N=ky(z,p),O=b.createHref(z);try{u.pushState(N,"",O)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;o.location.assign(O)}c&&f&&f({action:h,location:b.location,delta:1})}function S(_,E){h="REPLACE";let z=Km(b.location,_,E);p=x();let N=ky(z,p),O=b.createHref(z);u.replaceState(N,"",O),c&&f&&f({action:h,location:b.location,delta:0})}function w(_){return ZS(_)}let b={get action(){return h},get location(){return t(o,u)},listen(_){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(wy,j),f=_,()=>{o.removeEventListener(wy,j),f=null}},createHref(_){return n(o,_)},createURL:w,encodeLocation(_){let E=w(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:y,replace:S,go(_){return u.go(_)}};return b}function ZS(t,n=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),ya(a,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:ec(t);return s=s.replace(/ $/,"%20"),!n&&s.startsWith("//")&&(s=a+s),new URL(s,a)}function f1(t,n,a="/"){return GS(t,n,a,!1)}function GS(t,n,a,s){let o=typeof n=="string"?kl(n):n,c=li(o.pathname||"/",a);if(c==null)return null;let u=h1(t);KS(u);let h=null;for(let f=0;h==null&&f<u.length;++f){let p=iw(c);h=nw(u[f],p,s)}return h}function h1(t,n=[],a=[],s="",o=!1){let c=(u,h,f=o,p)=>{let x={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(s)&&f)return;ya(x.relativePath.startsWith(s),`Absolute route path "${x.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(s.length)}let j=ni([s,x.relativePath]),y=a.concat(x);u.children&&u.children.length>0&&(ya(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),h1(u.children,n,y,j,f)),!(u.path==null&&!u.index)&&n.push({path:j,score:tw(j,u.index),routesMeta:y})};return t.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))c(u,h);else for(let f of m1(u.path))c(u,h,!0,f)}),n}function m1(t){let n=t.split("/");if(n.length===0)return[];let[a,...s]=n,o=a.endsWith("?"),c=a.replace(/\?$/,"");if(s.length===0)return o?[c,""]:[c];let u=m1(s.join("/")),h=[];return h.push(...u.map(f=>f===""?c:[c,f].join("/"))),o&&h.push(...u),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function KS(t){t.sort((n,a)=>n.score!==a.score?a.score-n.score:aw(n.routesMeta.map(s=>s.childrenIndex),a.routesMeta.map(s=>s.childrenIndex)))}var qS=/^:[\w-]+$/,YS=3,JS=2,XS=1,QS=10,ew=-2,zy=t=>t==="*";function tw(t,n){let a=t.split("/"),s=a.length;return a.some(zy)&&(s+=ew),n&&(s+=JS),a.filter(o=>!zy(o)).reduce((o,c)=>o+(qS.test(c)?YS:c===""?XS:QS),s)}function aw(t,n){return t.length===n.length&&t.slice(0,-1).every((s,o)=>s===n[o])?t[t.length-1]-n[n.length-1]:0}function nw(t,n,a=!1){let{routesMeta:s}=t,o={},c="/",u=[];for(let h=0;h<s.length;++h){let f=s[h],p=h===s.length-1,x=c==="/"?n:n.slice(c.length)||"/",j=xu({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},x),y=f.route;if(!j&&p&&a&&!s[s.length-1].route.index&&(j=xu({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!j)return null;Object.assign(o,j.params),u.push({params:o,pathname:ni([c,j.pathname]),pathnameBase:cw(ni([c,j.pathnameBase])),route:y}),j.pathnameBase!=="/"&&(c=ni([c,j.pathnameBase]))}return u}function xu(t,n){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,s]=rw(t.path,t.caseSensitive,t.end),o=n.match(a);if(!o)return null;let c=o[0],u=c.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:s.reduce((p,{paramName:x,isOptional:j},y)=>{if(x==="*"){let w=h[y]||"";u=c.slice(0,c.length-w.length).replace(/(.)\/+$/,"$1")}const S=h[y];return j&&!S?p[x]=void 0:p[x]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:c,pathnameBase:u,pattern:t}}function rw(t,n=!1,a=!0){or(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,f)=>(s.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,n?void 0:"i"),s]}function iw(t){try{return t.split("/").map(n=>decodeURIComponent(n).replace(/\//g,"%2F")).join("/")}catch(n){return or(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${n}).`),t}}function li(t,n){if(n==="/")return t;if(!t.toLowerCase().startsWith(n.toLowerCase()))return null;let a=n.endsWith("/")?n.length-1:n.length,s=t.charAt(a);return s&&s!=="/"?null:t.slice(a)||"/"}var sw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function lw(t,n="/"){let{pathname:a,search:s="",hash:o=""}=typeof t=="string"?kl(t):t,c;return a?(a=a.replace(/\/\/+/g,"/"),a.startsWith("/")?c=Cy(a.substring(1),"/"):c=Cy(a,n)):c=n,{pathname:c,search:dw(s),hash:uw(o)}}function Cy(t,n){let a=n.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function am(t,n,a,s){return`Cannot include a '${t}' character in a manually specified \`to.${n}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function ow(t){return t.filter((n,a)=>a===0||n.route.path&&n.route.path.length>0)}function op(t){let n=ow(t);return n.map((a,s)=>s===n.length-1?a.pathname:a.pathnameBase)}function cp(t,n,a,s=!1){let o;typeof t=="string"?o=kl(t):(o={...t},ya(!o.pathname||!o.pathname.includes("?"),am("?","pathname","search",o)),ya(!o.pathname||!o.pathname.includes("#"),am("#","pathname","hash",o)),ya(!o.search||!o.search.includes("#"),am("#","search","hash",o)));let c=t===""||o.pathname==="",u=c?"/":o.pathname,h;if(u==null)h=a;else{let j=n.length-1;if(!s&&u.startsWith("..")){let y=u.split("/");for(;y[0]==="..";)y.shift(),j-=1;o.pathname=y.join("/")}h=j>=0?n[j]:"/"}let f=lw(o,h),p=u&&u!=="/"&&u.endsWith("/"),x=(c||u===".")&&a.endsWith("/");return!f.pathname.endsWith("/")&&(p||x)&&(f.pathname+="/"),f}var ni=t=>t.join("/").replace(/\/\/+/g,"/"),cw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),dw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,uw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,fw=class{constructor(t,n,a,s=!1){this.status=t,this.statusText=n||"",this.internal=s,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function hw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function mw(t){return t.map(n=>n.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var p1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function g1(t,n){let a=t;if(typeof a!="string"||!sw.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let s=a,o=!1;if(p1)try{let c=new URL(window.location.href),u=a.startsWith("//")?new URL(c.protocol+a):new URL(a),h=li(u.pathname,n);u.origin===c.origin&&h!=null?a=h+u.search+u.hash:o=!0}catch{or(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var x1=["POST","PUT","PATCH","DELETE"];new Set(x1);var pw=["GET",...x1];new Set(pw);var zl=m.createContext(null);zl.displayName="DataRouter";var Du=m.createContext(null);Du.displayName="DataRouterState";var gw=m.createContext(!1),y1=m.createContext({isTransitioning:!1});y1.displayName="ViewTransition";var xw=m.createContext(new Map);xw.displayName="Fetchers";var yw=m.createContext(null);yw.displayName="Await";var Kn=m.createContext(null);Kn.displayName="Navigation";var uc=m.createContext(null);uc.displayName="Location";var cr=m.createContext({outlet:null,matches:[],isDataRoute:!1});cr.displayName="Route";var dp=m.createContext(null);dp.displayName="RouteError";var v1="REACT_ROUTER_ERROR",vw="REDIRECT",jw="ROUTE_ERROR_RESPONSE";function bw(t){if(t.startsWith(`${v1}:${vw}:{`))try{let n=JSON.parse(t.slice(28));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.location=="string"&&typeof n.reloadDocument=="boolean"&&typeof n.replace=="boolean")return n}catch{}}function _w(t){if(t.startsWith(`${v1}:${jw}:{`))try{let n=JSON.parse(t.slice(40));if(typeof n=="object"&&n&&typeof n.status=="number"&&typeof n.statusText=="string")return new fw(n.status,n.statusText,n.data)}catch{}}function Sw(t,{relative:n}={}){ya(Cl(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:s}=m.useContext(Kn),{hash:o,pathname:c,search:u}=fc(t,{relative:n}),h=c;return a!=="/"&&(h=c==="/"?a:ni([a,c])),s.createHref({pathname:h,search:u,hash:o})}function Cl(){return m.useContext(uc)!=null}function Mr(){return ya(Cl(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(uc).location}var j1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function b1(t){m.useContext(Kn).static||m.useLayoutEffect(t)}function on(){let{isDataRoute:t}=m.useContext(cr);return t?Mw():ww()}function ww(){ya(Cl(),"useNavigate() may be used only in the context of a <Router> component.");let t=m.useContext(zl),{basename:n,navigator:a}=m.useContext(Kn),{matches:s}=m.useContext(cr),{pathname:o}=Mr(),c=JSON.stringify(op(s)),u=m.useRef(!1);return b1(()=>{u.current=!0}),m.useCallback((f,p={})=>{if(or(u.current,j1),!u.current)return;if(typeof f=="number"){a.go(f);return}let x=cp(f,JSON.parse(c),o,p.relative==="path");t==null&&n!=="/"&&(x.pathname=x.pathname==="/"?n:ni([n,x.pathname])),(p.replace?a.replace:a.push)(x,p.state,p)},[n,a,c,o,t])}var kw=m.createContext(null);function zw(t){let n=m.useContext(cr).outlet;return m.useMemo(()=>n&&m.createElement(kw.Provider,{value:t},n),[n,t])}function Lu(){let{matches:t}=m.useContext(cr),n=t[t.length-1];return n?n.params:{}}function fc(t,{relative:n}={}){let{matches:a}=m.useContext(cr),{pathname:s}=Mr(),o=JSON.stringify(op(a));return m.useMemo(()=>cp(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function Cw(t,n){return _1(t,n)}function _1(t,n,a,s,o){ya(Cl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=m.useContext(Kn),{matches:u}=m.useContext(cr),h=u[u.length-1],f=h?h.params:{},p=h?h.pathname:"/",x=h?h.pathnameBase:"/",j=h&&h.route;{let z=j&&j.path||"";w1(p,!j||z.endsWith("*")||z.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${z}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${z}"> to <Route path="${z==="/"?"*":`${z}/*`}">.`)}let y=Mr(),S;if(n){let z=typeof n=="string"?kl(n):n;ya(x==="/"||z.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${z.pathname}" was given in the \`location\` prop.`),S=z}else S=y;let w=S.pathname||"/",b=w;if(x!=="/"){let z=x.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(z.length).join("/")}let _=f1(t,{pathname:b});or(j||_!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),or(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Fw(_&&_.map(z=>Object.assign({},z,{params:Object.assign({},f,z.params),pathname:ni([x,c.encodeLocation?c.encodeLocation(z.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?x:ni([x,c.encodeLocation?c.encodeLocation(z.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:z.pathnameBase])})),u,a,s,o);return n&&E?m.createElement(uc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},E):E}function Tw(){let t=Lw(),n=hw(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},c={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:c},"ErrorBoundary")," or"," ",m.createElement("code",{style:c},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},n),a?m.createElement("pre",{style:o},a):null,u)}var Nw=m.createElement(Tw,null),S1=class extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){this.props.onError?this.props.onError(t,n):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const a=_w(t.digest);a&&(t=a)}let n=t!==void 0?m.createElement(cr.Provider,{value:this.props.routeContext},m.createElement(dp.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?m.createElement(Aw,{error:t},n):n}};S1.contextType=gw;var nm=new WeakMap;function Aw({children:t,error:n}){let{basename:a}=m.useContext(Kn);if(typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){let s=bw(n.digest);if(s){let o=nm.get(n);if(o)throw o;let c=g1(s.location,a);if(p1&&!nm.get(n))if(c.isExternal||s.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:s.replace}));throw nm.set(n,u),u}return m.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return t}function Ew({routeContext:t,match:n,children:a}){let s=m.useContext(zl);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),m.createElement(cr.Provider,{value:t},a)}function Fw(t,n=[],a=null,s=null,o=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(n.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let c=t,u=a?.errors;if(u!=null){let x=c.findIndex(j=>j.route.id&&u?.[j.route.id]!==void 0);ya(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,x+1))}let h=!1,f=-1;if(a)for(let x=0;x<c.length;x++){let j=c[x];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(f=x),j.route.id){let{loaderData:y,errors:S}=a,w=j.route.loader&&!y.hasOwnProperty(j.route.id)&&(!S||S[j.route.id]===void 0);if(j.route.lazy||w){h=!0,f>=0?c=c.slice(0,f+1):c=[c[0]];break}}}let p=a&&s?(x,j)=>{s(x,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:mw(a.matches),errorInfo:j})}:void 0;return c.reduceRight((x,j,y)=>{let S,w=!1,b=null,_=null;a&&(S=u&&j.route.id?u[j.route.id]:void 0,b=j.route.errorElement||Nw,h&&(f<0&&y===0?(w1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,_=null):f===y&&(w=!0,_=j.route.hydrateFallbackElement||null)));let E=n.concat(c.slice(0,y+1)),z=()=>{let N;return S?N=b:w?N=_:j.route.Component?N=m.createElement(j.route.Component,null):j.route.element?N=j.route.element:N=x,m.createElement(Ew,{match:j,routeContext:{outlet:x,matches:E,isDataRoute:a!=null},children:N})};return a&&(j.route.ErrorBoundary||j.route.errorElement||y===0)?m.createElement(S1,{location:a.location,revalidation:a.revalidation,component:b,error:S,children:z(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:p}):z()},null)}function up(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rw(t){let n=m.useContext(zl);return ya(n,up(t)),n}function Bw(t){let n=m.useContext(Du);return ya(n,up(t)),n}function Ow(t){let n=m.useContext(cr);return ya(n,up(t)),n}function fp(t){let n=Ow(t),a=n.matches[n.matches.length-1];return ya(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function Dw(){return fp("useRouteId")}function Lw(){let t=m.useContext(dp),n=Bw("useRouteError"),a=fp("useRouteError");return t!==void 0?t:n.errors?.[a]}function Mw(){let{router:t}=Rw("useNavigate"),n=fp("useNavigate"),a=m.useRef(!1);return b1(()=>{a.current=!0}),m.useCallback(async(o,c={})=>{or(a.current,j1),a.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:n,...c}))},[t,n])}var Ty={};function w1(t,n,a){!n&&!Ty[t]&&(Ty[t]=!0,or(!1,a))}m.memo(Iw);function Iw({routes:t,future:n,state:a,onError:s}){return _1(t,void 0,a,s,n)}function cl({to:t,replace:n,state:a,relative:s}){ya(Cl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=m.useContext(Kn);or(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=m.useContext(cr),{pathname:u}=Mr(),h=on(),f=cp(t,op(c),u,s==="path"),p=JSON.stringify(f);return m.useEffect(()=>{h(JSON.parse(p),{replace:n,state:a,relative:s})},[h,p,s,n,a]),null}function Pw(t){return zw(t.context)}function vt(t){ya(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ww({basename:t="/",children:n=null,location:a,navigationType:s="POP",navigator:o,static:c=!1,unstable_useTransitions:u}){ya(!Cl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),f=m.useMemo(()=>({basename:h,navigator:o,static:c,unstable_useTransitions:u,future:{}}),[h,o,c,u]);typeof a=="string"&&(a=kl(a));let{pathname:p="/",search:x="",hash:j="",state:y=null,key:S="default"}=a,w=m.useMemo(()=>{let b=li(p,h);return b==null?null:{location:{pathname:b,search:x,hash:j,state:y,key:S},navigationType:s}},[h,p,x,j,y,S,s]);return or(w!=null,`<Router basename="${h}"> is not able to match the URL "${p}${x}${j}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:m.createElement(Kn.Provider,{value:f},m.createElement(uc.Provider,{children:n,value:w}))}function Uw({children:t,location:n}){return Cw(qm(t),n)}function qm(t,n=[]){let a=[];return m.Children.forEach(t,(s,o)=>{if(!m.isValidElement(s))return;let c=[...n,o];if(s.type===m.Fragment){a.push.apply(a,qm(s.props.children,c));return}ya(s.type===vt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ya(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=qm(s.props.children,c)),a.push(u)}),a}var du="get",uu="application/x-www-form-urlencoded";function Mu(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function $w(t){return Mu(t)&&t.tagName.toLowerCase()==="button"}function Hw(t){return Mu(t)&&t.tagName.toLowerCase()==="form"}function Vw(t){return Mu(t)&&t.tagName.toLowerCase()==="input"}function Zw(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Gw(t,n){return t.button===0&&(!n||n==="_self")&&!Zw(t)}function Ym(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((n,a)=>{let s=t[a];return n.concat(Array.isArray(s)?s.map(o=>[a,o]):[[a,s]])},[]))}function Kw(t,n){let a=Ym(t);return n&&n.forEach((s,o)=>{a.has(o)||n.getAll(o).forEach(c=>{a.append(o,c)})}),a}var Bd=null;function qw(){if(Bd===null)try{new FormData(document.createElement("form"),0),Bd=!1}catch{Bd=!0}return Bd}var Yw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rm(t){return t!=null&&!Yw.has(t)?(or(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uu}"`),null):t}function Jw(t,n){let a,s,o,c,u;if(Hw(t)){let h=t.getAttribute("action");s=h?li(h,n):null,a=t.getAttribute("method")||du,o=rm(t.getAttribute("enctype"))||uu,c=new FormData(t)}else if($w(t)||Vw(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||h.getAttribute("action");if(s=f?li(f,n):null,a=t.getAttribute("formmethod")||h.getAttribute("method")||du,o=rm(t.getAttribute("formenctype"))||rm(h.getAttribute("enctype"))||uu,c=new FormData(h,t),!qw()){let{name:p,type:x,value:j}=t;if(x==="image"){let y=p?`${p}.`:"";c.append(`${y}x`,"0"),c.append(`${y}y`,"0")}else p&&c.append(p,j)}}else{if(Mu(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=du,s=null,o=uu,u=t}return c&&o==="text/plain"&&(u=c,c=void 0),{action:s,method:a.toLowerCase(),encType:o,formData:c,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function hp(t,n){if(t===!1||t===null||typeof t>"u")throw new Error(n)}function Xw(t,n,a,s){let o=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:n&&li(o.pathname,n)==="/"?o.pathname=`${n.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function Qw(t,n){if(t.id in n)return n[t.id];try{let a=await import(t.module);return n[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function e2(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function t2(t,n,a){let s=await Promise.all(t.map(async o=>{let c=n.routes[o.route.id];if(c){let u=await Qw(c,a);return u.links?u.links():[]}return[]}));return i2(s.flat(1).filter(e2).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Ny(t,n,a,s,o,c){let u=(f,p)=>a[p]?f.route.id!==a[p].route.id:!0,h=(f,p)=>a[p].pathname!==f.pathname||a[p].route.path?.endsWith("*")&&a[p].params["*"]!==f.params["*"];return c==="assets"?n.filter((f,p)=>u(f,p)||h(f,p)):c==="data"?n.filter((f,p)=>{let x=s.routes[f.route.id];if(!x||!x.hasLoader)return!1;if(u(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let j=f.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function a2(t,n,{includeHydrateFallback:a}={}){return n2(t.map(s=>{let o=n.routes[s.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function n2(t){return[...new Set(t)]}function r2(t){let n={},a=Object.keys(t).sort();for(let s of a)n[s]=t[s];return n}function i2(t,n){let a=new Set;return new Set(n),t.reduce((s,o)=>{let c=JSON.stringify(r2(o));return a.has(c)||(a.add(c),s.push({key:c,link:o})),s},[])}function k1(){let t=m.useContext(zl);return hp(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function s2(){let t=m.useContext(Du);return hp(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var mp=m.createContext(void 0);mp.displayName="FrameworkContext";function z1(){let t=m.useContext(mp);return hp(t,"You must render this element inside a <HydratedRouter> element"),t}function l2(t,n){let a=m.useContext(mp),[s,o]=m.useState(!1),[c,u]=m.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:x,onTouchStart:j}=n,y=m.useRef(null);m.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let b=E=>{E.forEach(z=>{u(z.isIntersecting)})},_=new IntersectionObserver(b,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[t]),m.useEffect(()=>{if(s){let b=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(b)}}},[s]);let S=()=>{o(!0)},w=()=>{o(!1),u(!1)};return a?t!=="intent"?[c,y,{}]:[c,y,{onFocus:To(h,S),onBlur:To(f,w),onMouseEnter:To(p,S),onMouseLeave:To(x,w),onTouchStart:To(j,S)}]:[!1,y,{}]}function To(t,n){return a=>{t&&t(a),a.defaultPrevented||n(a)}}function o2({page:t,...n}){let{router:a}=k1(),s=m.useMemo(()=>f1(a.routes,t,a.basename),[a.routes,t,a.basename]);return s?m.createElement(d2,{page:t,matches:s,...n}):null}function c2(t){let{manifest:n,routeModules:a}=z1(),[s,o]=m.useState([]);return m.useEffect(()=>{let c=!1;return t2(t,n,a).then(u=>{c||o(u)}),()=>{c=!0}},[t,n,a]),s}function d2({page:t,matches:n,...a}){let s=Mr(),{future:o,manifest:c,routeModules:u}=z1(),{basename:h}=k1(),{loaderData:f,matches:p}=s2(),x=m.useMemo(()=>Ny(t,n,p,c,s,"data"),[t,n,p,c,s]),j=m.useMemo(()=>Ny(t,n,p,c,s,"assets"),[t,n,p,c,s]),y=m.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let b=new Set,_=!1;if(n.forEach(z=>{let N=c.routes[z.route.id];!N||!N.hasLoader||(!x.some(O=>O.route.id===z.route.id)&&z.route.id in f&&u[z.route.id]?.shouldRevalidate||N.hasClientLoader?_=!0:b.add(z.route.id))}),b.size===0)return[];let E=Xw(t,h,o.unstable_trailingSlashAwareDataRequests,"data");return _&&b.size>0&&E.searchParams.set("_routes",n.filter(z=>b.has(z.route.id)).map(z=>z.route.id).join(",")),[E.pathname+E.search]},[h,o.unstable_trailingSlashAwareDataRequests,f,s,c,x,n,t,u]),S=m.useMemo(()=>a2(j,c),[j,c]),w=c2(j);return m.createElement(m.Fragment,null,y.map(b=>m.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...a})),S.map(b=>m.createElement("link",{key:b,rel:"modulepreload",href:b,...a})),w.map(({key:b,link:_})=>m.createElement("link",{key:b,nonce:a.nonce,..._,crossOrigin:_.crossOrigin??a.crossOrigin})))}function u2(...t){return n=>{t.forEach(a=>{typeof a=="function"?a(n):a!=null&&(a.current=n)})}}var f2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{f2&&(window.__reactRouterVersion="7.13.0")}catch{}function h2({basename:t,children:n,unstable_useTransitions:a,window:s}){let o=m.useRef();o.current==null&&(o.current=$S({window:s,v5Compat:!0}));let c=o.current,[u,h]=m.useState({action:c.action,location:c.location}),f=m.useCallback(p=>{a===!1?h(p):m.startTransition(()=>h(p))},[a]);return m.useLayoutEffect(()=>c.listen(f),[c,f]),m.createElement(Ww,{basename:t,children:n,location:u.location,navigationType:u.action,navigator:c,unstable_useTransitions:a})}var C1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,T1=m.forwardRef(function({onClick:n,discover:a="render",prefetch:s="none",relative:o,reloadDocument:c,replace:u,state:h,target:f,to:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y,...S},w){let{basename:b,unstable_useTransitions:_}=m.useContext(Kn),E=typeof p=="string"&&C1.test(p),z=g1(p,b);p=z.to;let N=Sw(p,{relative:o}),[O,Q,U]=l2(s,S),L=g2(p,{replace:u,state:h,target:f,preventScrollReset:x,relative:o,viewTransition:j,unstable_defaultShouldRevalidate:y,unstable_useTransitions:_});function H(R){n&&n(R),R.defaultPrevented||L(R)}let A=m.createElement("a",{...S,...U,href:z.absoluteURL||N,onClick:z.isExternal||c?n:H,ref:u2(w,Q),target:f,"data-discover":!E&&a==="render"?"true":void 0});return O&&!E?m.createElement(m.Fragment,null,A,m.createElement(o2,{page:N})):A});T1.displayName="Link";var N1=m.forwardRef(function({"aria-current":n="page",caseSensitive:a=!1,className:s="",end:o=!1,style:c,to:u,viewTransition:h,children:f,...p},x){let j=fc(u,{relative:p.relative}),y=Mr(),S=m.useContext(Du),{navigator:w,basename:b}=m.useContext(Kn),_=S!=null&&b2(j)&&h===!0,E=w.encodeLocation?w.encodeLocation(j).pathname:j.pathname,z=y.pathname,N=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;a||(z=z.toLowerCase(),N=N?N.toLowerCase():null,E=E.toLowerCase()),N&&b&&(N=li(N,b)||N);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let Q=z===E||!o&&z.startsWith(E)&&z.charAt(O)==="/",U=N!=null&&(N===E||!o&&N.startsWith(E)&&N.charAt(E.length)==="/"),L={isActive:Q,isPending:U,isTransitioning:_},H=Q?n:void 0,A;typeof s=="function"?A=s(L):A=[s,Q?"active":null,U?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let R=typeof c=="function"?c(L):c;return m.createElement(T1,{...p,"aria-current":H,className:A,ref:x,style:R,to:u,viewTransition:h},typeof f=="function"?f(L):f)});N1.displayName="NavLink";var m2=m.forwardRef(({discover:t="render",fetcherKey:n,navigate:a,reloadDocument:s,replace:o,state:c,method:u=du,action:h,onSubmit:f,relative:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y,...S},w)=>{let{unstable_useTransitions:b}=m.useContext(Kn),_=v2(),E=j2(h,{relative:p}),z=u.toLowerCase()==="get"?"get":"post",N=typeof h=="string"&&C1.test(h),O=Q=>{if(f&&f(Q),Q.defaultPrevented)return;Q.preventDefault();let U=Q.nativeEvent.submitter,L=U?.getAttribute("formmethod")||u,H=()=>_(U||Q.currentTarget,{fetcherKey:n,method:L,navigate:a,replace:o,state:c,relative:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y});b&&a!==!1?m.startTransition(()=>H()):H()};return m.createElement("form",{ref:w,method:z,action:E,onSubmit:s?f:O,...S,"data-discover":!N&&t==="render"?"true":void 0})});m2.displayName="Form";function p2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A1(t){let n=m.useContext(zl);return ya(n,p2(t)),n}function g2(t,{target:n,replace:a,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:h,unstable_useTransitions:f}={}){let p=on(),x=Mr(),j=fc(t,{relative:c});return m.useCallback(y=>{if(Gw(y,n)){y.preventDefault();let S=a!==void 0?a:ec(x)===ec(j),w=()=>p(t,{replace:S,state:s,preventScrollReset:o,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:h});f?m.startTransition(()=>w()):w()}},[x,p,j,a,s,n,t,o,c,u,h,f])}function hc(t){or(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let n=m.useRef(Ym(t)),a=m.useRef(!1),s=Mr(),o=m.useMemo(()=>Kw(s.search,a.current?null:n.current),[s.search]),c=on(),u=m.useCallback((h,f)=>{const p=Ym(typeof h=="function"?h(new URLSearchParams(o)):h);a.current=!0,c("?"+p,f)},[c,o]);return[o,u]}var x2=0,y2=()=>`__${String(++x2)}__`;function v2(){let{router:t}=A1("useSubmit"),{basename:n}=m.useContext(Kn),a=Dw(),s=t.fetch,o=t.navigate;return m.useCallback(async(c,u={})=>{let{action:h,method:f,encType:p,formData:x,body:j}=Jw(c,n);if(u.navigate===!1){let y=u.fetcherKey||y2();await s(y,a,u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:x,body:j,formMethod:u.method||f,formEncType:u.encType||p,flushSync:u.flushSync})}else await o(u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:x,body:j,formMethod:u.method||f,formEncType:u.encType||p,replace:u.replace,state:u.state,fromRouteId:a,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,o,n,a])}function j2(t,{relative:n}={}){let{basename:a}=m.useContext(Kn),s=m.useContext(cr);ya(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),c={...fc(t||".",{relative:n})},u=Mr();if(t==null){c.search=u.search;let h=new URLSearchParams(c.search),f=h.getAll("index");if(f.some(x=>x==="")){h.delete("index"),f.filter(j=>j).forEach(j=>h.append("index",j));let x=h.toString();c.search=x?`?${x}`:""}}return(!t||t===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(c.pathname=c.pathname==="/"?a:ni([a,c.pathname])),ec(c)}function b2(t,{relative:n}={}){let a=m.useContext(y1);ya(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=A1("useViewTransitionState"),o=fc(t,{relative:n});if(!a.isTransitioning)return!1;let c=li(a.currentLocation.pathname,s)||a.currentLocation.pathname,u=li(a.nextLocation.pathname,s)||a.nextLocation.pathname;return xu(o.pathname,u)!=null||xu(o.pathname,c)!=null}const _2=[{title:"Dashboardy",items:[{to:"/",icon:"",label:"Executive Summary"},{to:"/security-score",icon:"",label:"Security Score"},{to:"/domains",icon:"",label:"Domeny Bezpieczenstwa"}]},{title:"Kontekst Organizacyjny",items:[{to:"/org-context",icon:"",label:"Kontekst Organizacyjny"}]},{title:"Katalogi Bezpieczenstwa",items:[{to:"/smart-catalog",icon:"",label:"Zagrozenia i Zabezpieczenia"},{to:"/control-effectiveness",icon:"",label:"Skuteczno Zabezpiecze"}]},{title:"Zarzdzanie Ryzykiem",items:[{to:"/assets",icon:"",label:"Aktywa (CMDB)"},{to:"/risks",icon:"",label:"Rejestr Ryzyk"},{to:"/reviews",icon:"",label:"Przegldy"},{to:"/actions",icon:"",label:"Dziaania"}]},{title:"Operacje Bezpieczestwa",items:[{to:"/vulnerabilities",icon:"",label:"Podatnoci"},{to:"/incidents",icon:"",label:"Incydenty"}]},{title:"Governance",items:[{to:"/exceptions",icon:"",label:"Wyjtki"},{to:"/audits",icon:"",label:"Audyty"}]},{title:"Dostawcy & Awareness",items:[{to:"/vendors",icon:"",label:"Dostawcy (TPRM)"},{to:"/awareness",icon:"",label:"Awareness"}]},{title:"Compliance & Audit",items:[{to:"/compliance",icon:"",label:"Dashboard Zgodnoci"},{to:"/frameworks",icon:"",label:"Repozytorium Wymaga"},{to:"/compliance/assessments",icon:"",label:"Oceny Zgodnoci"},{to:"/framework-mappings",icon:"",label:"Mapowanie Frameworkw"},{to:"/audit-programs",icon:"",label:"Program Audytw"},{to:"/audit-engagements",icon:"",label:"Zadania Audytowe"},{to:"/test-templates",icon:"",label:"Katalog Testw"},{to:"/audit-findings",icon:"",label:"Ustalenia Audytowe"}]},{title:"Raporty",items:[{to:"/reports",icon:"",label:"Generuj raporty"}]},{title:"Konfiguracja",items:[{to:"/assets/admin",icon:"",label:"CMDB Admin"},{to:"/ai-config",icon:"",label:"Integracja AI"},{to:"/db-admin",icon:"",label:"Baza danych"},{to:"/dictionaries",icon:"",label:"Sowniki"},{to:"/audit",icon:"",label:"Audit Trail"}]}];function S2(){return e.jsxs("nav",{className:"sidebar",children:[e.jsxs("div",{className:"sidebar-brand",children:[e.jsx("div",{className:"shield",children:""}),e.jsxs("div",{className:"brand-text",children:[e.jsx("h1",{children:"SecurePosture"}),e.jsx("span",{children:"CISO Platform"})]})]}),_2.map(t=>e.jsxs("div",{className:"sidebar-section",children:[e.jsx("div",{className:"sidebar-section-label",children:t.title}),t.items.map(n=>e.jsxs(N1,{to:n.to,end:n.to==="/",className:({isActive:a})=>`sidebar-item${a?" active":""}`,children:[e.jsx("span",{className:"icon",children:n.icon}),e.jsx("span",{children:n.label}),n.badge&&e.jsx("span",{className:`badge ${n.badge.cls}`,children:n.badge.count})]},n.to))]},t.title))]})}const E1=m.createContext({theme:"dark",setTheme:()=>{}});function w2(){return m.useContext(E1)}const k2={dark:{"--bg-primary":"#0a0e1a","--bg-secondary":"#111827","--bg-card":"#1a2035","--bg-card-hover":"#1f2847","--bg-sidebar":"#0d1220","--bg-subtle":"rgba(255,255,255,0.04)","--bg-inset":"rgba(255,255,255,0.02)","--border":"#2a3554","--border-light":"#374167","--text-primary":"#e8ecf4","--text-secondary":"#8896b3","--text-muted":"#5a6a8a","--green":"#22c55e","--green-dim":"rgba(34,197,94,0.15)","--yellow":"#eab308","--yellow-dim":"rgba(234,179,8,0.15)","--orange":"#f97316","--orange-dim":"rgba(249,115,22,0.15)","--red":"#ef4444","--red-dim":"rgba(239,68,68,0.15)","--blue":"#3b82f6","--blue-dim":"rgba(59,130,246,0.12)","--purple":"#8b5cf6","--purple-dim":"rgba(139,92,246,0.12)","--cyan":"#06b6d4","--shadow":"0 4px 24px rgba(0,0,0,0.3)"},light:{"--bg-primary":"#f0f2f5","--bg-secondary":"#ffffff","--bg-card":"#ffffff","--bg-card-hover":"#f5f7fa","--bg-sidebar":"#1e293b","--bg-subtle":"rgba(0,0,0,0.04)","--bg-inset":"rgba(0,0,0,0.02)","--border":"#e2e8f0","--border-light":"#cbd5e1","--text-primary":"#1e293b","--text-secondary":"#475569","--text-muted":"#94a3b8","--green":"#16a34a","--green-dim":"rgba(22,163,74,0.10)","--yellow":"#ca8a04","--yellow-dim":"rgba(202,138,4,0.10)","--orange":"#ea580c","--orange-dim":"rgba(234,88,12,0.10)","--red":"#dc2626","--red-dim":"rgba(220,38,38,0.10)","--blue":"#2563eb","--blue-dim":"rgba(37,99,235,0.08)","--purple":"#7c3aed","--purple-dim":"rgba(124,58,237,0.08)","--cyan":"#0891b2","--shadow":"0 4px 24px rgba(0,0,0,0.08)"},material:{"--bg-primary":"#fafafa","--bg-secondary":"#ffffff","--bg-card":"#ffffff","--bg-card-hover":"#f5f5f5","--bg-sidebar":"#1a237e","--bg-subtle":"rgba(0,0,0,0.05)","--bg-inset":"rgba(0,0,0,0.03)","--border":"#e0e0e0","--border-light":"#bdbdbd","--text-primary":"#212121","--text-secondary":"#616161","--text-muted":"#9e9e9e","--green":"#2e7d32","--green-dim":"rgba(46,125,50,0.10)","--yellow":"#f9a825","--yellow-dim":"rgba(249,168,37,0.10)","--orange":"#ef6c00","--orange-dim":"rgba(239,108,0,0.10)","--red":"#c62828","--red-dim":"rgba(198,40,40,0.10)","--blue":"#1565c0","--blue-dim":"rgba(21,101,192,0.08)","--purple":"#6a1b9a","--purple-dim":"rgba(106,27,154,0.08)","--cyan":"#00838f","--shadow":"0 2px 12px rgba(0,0,0,0.12)"}};function z2({children:t}){const[n,a]=m.useState(()=>localStorage.getItem("sp-theme")||"dark"),s=o=>{a(o),localStorage.setItem("sp-theme",o)};return m.useEffect(()=>{const o=k2[n],c=document.documentElement;for(const[u,h]of Object.entries(o))c.style.setProperty(u,h);c.setAttribute("data-theme",n)},[n]),e.jsx(E1.Provider,{value:{theme:n,setTheme:s},children:t})}const C2={"/":"Executive Summary","/assets":"Rejestr Aktywow","/assets/graph":"Graf Relacji Aktywow","/risks":"Rejestr Ryzyk","/reviews":"Przeglady Ryzyk","/cis":"Frameworki (przekierowanie)","/cis/assess":"Oceny (przekierowanie)","/org-structure":"Struktura Organizacyjna","/catalogs":"Katalogi","/smart-catalog":"Katalog Zagrozen, Podatnosci i Zabezpieczen","/dictionaries":"Slowniki","/actions":"Dzialania","/audit":"Audit Trail","/frameworks":"Biblioteka Frameworkow","/framework-mappings":"Mapowanie Frameworkow","/assessments":"Oceny Frameworkow","/vulnerabilities":"Podatnosci","/incidents":"Incydenty","/policies":"Polityki","/exceptions":"Rejestr Wyjatkow","/audits":"Audyty","/vendors":"Dostawcy (TPRM)","/awareness":"Awareness","/security-score":"Security Score","/domains":"Domeny Bezpieczenstwa"},T2=[{value:"dark",label:"Ciemny",icon:""},{value:"light",label:"Jasny",icon:""},{value:"material",label:"Material",icon:""}];function N2(){const{pathname:t}=Mr(),{theme:n,setTheme:a}=w2(),s=C2[t]??"SecurePosture",o=new Date,c=o.toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}),u=o.toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"topbar",children:[e.jsx("h2",{children:s}),e.jsxs("div",{className:"meta",children:[e.jsx("div",{className:"theme-switcher",children:T2.map(h=>e.jsx("button",{className:`theme-btn${n===h.value?" active":""}`,onClick:()=>a(h.value),title:h.label,children:h.icon},h.value))}),e.jsxs("span",{children:[e.jsx("span",{className:"live-dot"}),"Dane aktualne"]}),e.jsxs("span",{children:[c,", ",u]})]})]})}function A2(){return e.jsxs(e.Fragment,{children:[e.jsx(S2,{}),e.jsxs("div",{className:"main-wrapper",children:[e.jsx(N2,{}),e.jsx("div",{className:"content",children:e.jsx("div",{className:"view-enter",children:e.jsx(Pw,{})})})]})]})}class E2 extends m.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,a){console.error("ErrorBoundary caught:",n,a)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"var(--red, #ef4444)",marginBottom:12},children:"Wystapil blad w aplikacji"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #888)",marginBottom:16,maxWidth:500,margin:"0 auto 16px"},children:this.state.error?.message||"Nieznany blad"}),e.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},style:{padding:"8px 20px",fontSize:13,cursor:"pointer",background:"var(--blue, #3b82f6)",color:"#fff",border:"none",borderRadius:6},children:"Odswierz strone"})]}):this.props.children}}const F1="";async function No(t,n){const a=await fetch(`${F1}${t}`,{...n,headers:{"Content-Type":"application/json",...n?.headers}});if(!a.ok){const s=await a.text().catch(()=>"");throw new Error(`API ${a.status}: ${s}`)}return a.json()}const le={get:t=>No(t),post:(t,n)=>No(t,{method:"POST",body:JSON.stringify(n)}),put:(t,n)=>No(t,{method:"PUT",body:JSON.stringify(n)}),patch:(t,n)=>No(t,{method:"PATCH",body:JSON.stringify(n)}),delete:t=>No(t,{method:"DELETE"}),postFormData:async(t,n)=>{const a=await fetch(`${F1}${t}`,{method:"POST",body:n});if(!a.ok){const s=await a.text().catch(()=>"");throw new Error(`API ${a.status}: ${s}`)}return a.json()}};function Ay(t){return t.toLowerCase().replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"e").replace(/[l]/g,"l").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"s").replace(/[]/g,"z").replace(/[^\w\s]/g,"")}function Ey(t){const n=new Set;for(let a=0;a<t.length-1;a++)n.add(t.slice(a,a+2));return n}function Fy(t,n){const a=Ay(t),s=Ay(n);if(s.includes(a))return 1;const o=s.split(/\s+/);for(const f of o)if(f.startsWith(a))return .95;if(a.length<2||s.length<2)return 0;const c=Ey(a),u=Ey(s);let h=0;for(const f of c)u.has(f)&&h++;return 2*h/(c.size+u.size)}function Ry(t,n){if(!t)return!0;const a=Fy(t,n.name),s=Fy(t,n.symbol);return a>.35||s>.35}function R1(t,n){if(!n)return t;const a=[];for(const s of t){const o=R1(s.children,n);(Ry(n,s)||o.length>0)&&a.push({...s,children:o.length>0?o:Ry(n,s)?s.children:[]})}return a}function B1({node:t,depth:n,onSelect:a,expandedIds:s,toggleExpand:o,highlightId:c,query:u}){const h=t.children.length>0,f=s.has(t.id),p=c===t.id,x=["","","",""],j=x[Math.min(n,x.length-1)];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,padding:"5px 8px",paddingLeft:n*18+8,cursor:"pointer",background:p?"var(--blue-dim)":"transparent",fontSize:13,transition:"background 0.1s",borderLeft:p?"2px solid var(--blue)":"2px solid transparent",whiteSpace:"nowrap"},onMouseEnter:y=>{p||(y.currentTarget.style.background="var(--bg-card-hover)")},onMouseLeave:y=>{p||(y.currentTarget.style.background="transparent")},onClick:y=>{y.stopPropagation(),a(t)},children:[h?e.jsx("span",{onClick:y=>{y.stopPropagation(),o(t.id)},style:{cursor:"pointer",fontSize:9,width:14,textAlign:"center",color:"var(--text-muted)",userSelect:"none",flexShrink:0},children:f?"":""}):e.jsx("span",{style:{width:14,flexShrink:0}}),e.jsx("span",{style:{flexShrink:0},children:j}),e.jsx("span",{style:{fontWeight:n===0?600:400,overflow:"hidden",textOverflow:"ellipsis"},children:t.name}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",marginLeft:4,flexShrink:0},children:t.symbol})]}),f&&h&&t.children.map(y=>e.jsx(B1,{node:y,depth:n+1,onSelect:a,expandedIds:s,toggleExpand:o,highlightId:c,query:u},y.id))]})}function Jm(t,n,a=[]){for(const s of t){const o=[...a,s.name];if(s.id===n)return o;const c=Jm(s.children,n,o);if(c)return c}return null}function O1(t){const n=new Set;for(const a of t){n.add(a.id);for(const s of O1(a.children))n.add(s)}return n}function jn({tree:t,value:n,onChange:a,placeholder:s="Wybierz jednostk...",allowClear:o=!0,className:c,style:u,disabled:h}){const[f,p]=m.useState(!1),[x,j]=m.useState(""),[y,S]=m.useState(()=>new Set(t.map(U=>U.id))),w=m.useRef(null),b=m.useRef(null);m.useEffect(()=>{S(new Set(t.map(U=>U.id)))},[t]),m.useEffect(()=>{if(!f)return;const U=L=>{w.current&&!w.current.contains(L.target)&&p(!1)};return document.addEventListener("mousedown",U),()=>document.removeEventListener("mousedown",U)},[f]),m.useEffect(()=>{f&&b.current&&b.current.focus()},[f]);const _=m.useMemo(()=>{if(!n)return null;const U=Jm(t,n);return U?U.join("  "):null},[t,n]),E=m.useMemo(()=>{if(!n)return null;const U=Jm(t,n);return U?U[U.length-1]:null},[t,n]),z=m.useMemo(()=>R1(t,x),[t,x]);m.useEffect(()=>{x&&S(O1(z))},[x,z]);const N=m.useCallback(U=>{S(L=>{const H=new Set(L);return H.has(U)?H.delete(U):H.add(U),H})},[]),O=m.useCallback(U=>{a(U.id),p(!1),j("")},[a]),Q=m.useCallback(U=>{U.stopPropagation(),a(null),j("")},[a]);return e.jsxs("div",{ref:w,className:c,style:{position:"relative",...u},children:[e.jsxs("div",{onClick:()=>{h||p(!f)},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 10px",background:"var(--bg-input, var(--bg-card))",border:"1px solid var(--border)",borderRadius:6,cursor:h?"not-allowed":"pointer",fontSize:13,minHeight:34,opacity:h?.5:1},className:"form-control",children:[E?e.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:_??void 0,children:_}):e.jsx("span",{style:{flex:1,color:"var(--text-muted)"},children:s}),o&&n&&!h&&e.jsx("span",{onClick:Q,style:{cursor:"pointer",fontSize:14,color:"var(--text-muted)",padding:"0 2px",lineHeight:1},title:"Wyczy",children:""}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",flexShrink:0},children:f?"":""})]}),f&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,marginTop:2,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,0.3)",maxHeight:360,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:320},children:[e.jsx("div",{style:{padding:8,borderBottom:"1px solid var(--border)"},children:e.jsx("input",{ref:b,type:"text",value:x,onChange:U=>j(U.target.value),placeholder:"Szukaj jednostki... (fuzzy)",style:{width:"100%",padding:"6px 10px",background:"var(--bg-input, var(--bg-main))",border:"1px solid var(--border)",borderRadius:5,fontSize:13,color:"var(--text-primary, inherit)",outline:"none"},onClick:U=>U.stopPropagation()})}),e.jsxs("div",{style:{overflowY:"auto",flex:1,padding:"4px 0"},children:[o&&e.jsx("div",{onClick:()=>{a(null),p(!1),j("")},style:{padding:"5px 8px",cursor:"pointer",fontSize:13,color:"var(--text-muted)",fontStyle:"italic",borderBottom:"1px solid var(--border)"},onMouseEnter:U=>U.currentTarget.style.background="var(--bg-card-hover)",onMouseLeave:U=>U.currentTarget.style.background="transparent",children:s}),z.length===0?e.jsxs("div",{style:{padding:"16px 8px",textAlign:"center",color:"var(--text-muted)",fontSize:13},children:["Brak wynikw dla ",x,'"']}):z.map(U=>e.jsx(B1,{node:U,depth:0,onSelect:O,expandedIds:y,toggleExpand:N,highlightId:n,query:x},U.id))]})]})]})}function Mi(t){return t?t==="A"?"var(--green)":t==="B"?"var(--cyan)":t==="C"?"var(--yellow)":t==="D"?"var(--orange)":"var(--red)":"var(--text-muted)"}function By(t){return t==="high"?"var(--red)":t==="medium"?"var(--orange)":"var(--green)"}function Oy(t){return t==="high"?"var(--red-dim)":t==="medium"?"var(--orange-dim)":"var(--green-dim)"}function rr(t){return t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function F2(t,n){const a=t*n;return a>=6?"var(--red)":a>=3?"var(--orange)":"var(--green)"}function R2(t,n,a){return t.find(s=>s.impact===n&&s.probability===a)?.count??0}function B2(t){switch(t){case"A":return"DOSKONAY";case"B":return"DOBRY";case"C":return"UMIARKOWANY";case"D":return"SABY";case"F":return"KRYTYCZNY";default:return""}}function Dy(t){switch(t){case"A":return"Doskonaa postawa bezpieczestwa. Wszystkie wymiary powyej progu akceptacji. Utrzymuj obecny standard.";case"B":return"Dobra postawa z obszarami wymagajcymi wzmocnienia. Skoncentruj si na najsabszych wymiarach.";case"C":return"Umiarkowana postawa bezpieczestwa. Wymagane s dziaania korygujce w wielu obszarach.";case"D":return"Saba postawa bezpieczestwa. Konieczne natychmiastowe dziaania naprawcze i eskalacja.";case"F":return"Krytycznie niski poziom bezpieczestwa. Wymaga natychmiastowej interwencji zarzdu.";default:return"Brak wystarczajcych danych do penej oceny."}}function Od(t,n){const a=t.find(s=>s.label===n);return typeof a?.value=="number"?a.value:parseFloat(String(a?.value??"0"))||0}function Ao(t,n,a,s){if(t===1)return n;const o=t%10,c=t%100;return o>=2&&o<=4&&(c<10||c>=20)?a:s}function Eo(t,n){const a=[];for(const[s,o]of Object.entries(n))o!=null&&o!==""&&a.push(`${s}=${encodeURIComponent(o)}`);return a.length?`${t}?${a.join("&")}`:t}function O2(){const[t,n]=m.useState(null),[a,s]=m.useState(null),[o,c]=m.useState(null),[u,h]=m.useState(!0),[f,p]=m.useState([]),[x,j]=m.useState(""),y=on(),S=M=>{h(!0);const V=M?`?org_unit_id=${M}`:"";Promise.all([le.get(`/api/v1/dashboard/executive-summary${V}`).catch(()=>null),le.get(`/api/v1/dashboard/risks${V}`).catch(()=>null),le.get(`/api/v1/dashboard/posture-score${V}`).catch(()=>null)]).then(([ne,P,T])=>{n(ne),s(P),c(T)}).finally(()=>h(!1))};m.useEffect(()=>{le.get("/api/v1/org-units/tree").then(p).catch(()=>{}),S()},[]);const w=M=>{j(M),S(M||void 0)};if(u&&!t)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"adowanie dashboardu..."})});const b=o?.score??t?.posture_score??0,_=o?.grade??t?.posture_grade??null,E=2*Math.PI*54,z=E-b/100*E,N=t?.risk_counts??a?.risk_counts??{high:0,medium:0,low:0,total:0},O=t?.org_unit?.name??null,Q=O??"Caa organizacja",U=Od(t?.kpis??[],"Otwarte podatnoci"),L=Od(t?.kpis??[],"Otwarte incydenty"),H=Od(t?.kpis??[],"Aktywa (CMDB)"),A=Od(t?.kpis??[],"CMDB Coverage"),R=(()=>{if(!a?.trend||a.trend.length<2)return null;const M=a.trend,V=M[M.length-1],ne=M[M.length-2];return{delta:V.high-ne.high,totalDelta:V.total-ne.total}})(),G=[];if(N.high>0&&G.push({text:`${N.high} ${Ao(N.high,"ryzyko krytyczne wymaga","ryzyka krytyczne wymagaj","ryzyk krytycznych wymaga")} natychmiastowej uwagi`,color:"var(--red)",bg:"var(--red-dim)"}),L>0&&G.push({text:`${L} ${Ao(L,"otwarty incydent","otwarte incydenty","otwartych incydentw")} bezpieczestwa`,color:"var(--red)",bg:"var(--red-dim)"}),(t?.overdue_reviews_count??0)>0&&G.push({text:`${t.overdue_reviews_count} ${Ao(t.overdue_reviews_count,"przegld ryzyka przeterminowany","przegldy ryzyk przeterminowane","przegldw ryzyk przeterminowanych")}`,color:"var(--orange)",bg:"var(--orange-dim)"}),U>0&&G.push({text:`${U} ${Ao(U,"otwarta podatno","otwarte podatnoci","otwartych podatnoci")} do remediacji`,color:U>5?"var(--orange)":"var(--yellow)",bg:U>5?"var(--orange-dim)":"var(--yellow-dim)"}),t?.maturity_score!=null){const M=t.maturity_score,V=t.maturity_framework_name??"Control Maturity";M<40?G.push({text:`${V}: ${M.toFixed(1)}/100  znacznie poniej oczekiwa`,color:"var(--red)",bg:"var(--red-dim)"}):M<60?G.push({text:`${V}: ${M.toFixed(1)}/100  wymaga poprawy`,color:"var(--orange)",bg:"var(--orange-dim)"}):M<80?G.push({text:`${V}: ${M.toFixed(1)}/100  dobry poziom, dalszy rozwj`,color:"var(--yellow)",bg:"var(--yellow-dim)"}):G.push({text:`${V}: ${M.toFixed(1)}/100  wysoki poziom dojrzaoci`,color:"var(--green)",bg:"var(--green-dim)"})}else if(t?.cis_maturity_rating!=null){const M=t.cis_maturity_rating;M<2?G.push({text:`CIS Maturity ${M.toFixed(2)}/5.0  znacznie poniej oczekiwa`,color:"var(--red)",bg:"var(--red-dim)"}):M<3?G.push({text:`CIS Maturity ${M.toFixed(2)}/5.0  wymaga poprawy`,color:"var(--orange)",bg:"var(--orange-dim)"}):M<4?G.push({text:`CIS Maturity ${M.toFixed(2)}/5.0  dobry poziom, dalszy rozwj`,color:"var(--yellow)",bg:"var(--yellow-dim)"}):G.push({text:`CIS Maturity ${M.toFixed(2)}/5.0  wysoki poziom dojrzaoci`,color:"var(--green)",bg:"var(--green-dim)"})}G.length===0&&G.push({text:"Brak krytycznych zagroe. Postawa bezpieczestwa stabilna.",color:"var(--green)",bg:"var(--green-dim)"});const F=[];N.high>0&&F.push({text:"Przegld ryzyk krytycznych",link:Eo("/risks",{level:"high",org_unit_id:x||null})}),(t?.overdue_reviews_count??0)>0&&F.push({text:"Uzupenienie zalegych przegldw",link:"/reviews"}),t?.maturity_score!=null&&t.maturity_score<60?F.push({text:"Rozwj dojrzaoci kontroli",link:"/frameworks"}):t?.cis_maturity_rating!=null&&t.cis_maturity_rating<3&&F.push({text:"Rozwj kontroli",link:"/frameworks"}),U>3&&F.push({text:"Plan remediacji podatnoci",link:"/vulnerabilities"});const q=o?.dimensions?.length?[...o.dimensions].sort((M,V)=>M.score-V.score)[0]:null;q&&q.score<70&&F.push({text:`Wzmocnienie: ${q.name}`,link:"#"});const ee=N.high>5||_==="F"?"var(--red)":N.high>0||_==="D"?"var(--orange)":_==="C"?"var(--yellow)":"var(--green)",me=Math.max(N.total,1),W=N.high/me*100,J=N.medium/me*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx(jn,{tree:f,value:x?Number(x):null,onChange:M=>w(M?String(M):""),placeholder:"Caa organizacja",allowClear:!0,style:{width:300}}),u&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odwieanie..."})]}),e.jsxs("div",{className:"toolbar-right",children:[e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:["Zakres: ",e.jsx("strong",{style:{color:"var(--text-secondary)"},children:Q})]}),o?.benchmark_avg!=null&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)",marginLeft:12},children:["Benchmark: ",e.jsxs("strong",{style:{color:rr(o.benchmark_avg)},children:[Math.round(o.benchmark_avg),"%"]})]})]})]}),e.jsx("div",{className:"card",style:{borderLeft:`4px solid ${ee}`,padding:"24px 28px",marginBottom:16,background:"linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%)"},children:e.jsxs("div",{style:{display:"flex",gap:28,alignItems:"flex-start",flexWrap:"wrap"},children:[e.jsxs("div",{style:{textAlign:"center",flexShrink:0},children:[e.jsxs("div",{style:{position:"relative",width:130,height:130},children:[e.jsxs("svg",{width:"130",height:"130",viewBox:"0 0 130 130",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"65",cy:"65",r:"54",fill:"none",stroke:"var(--border)",strokeWidth:"8"}),e.jsx("circle",{cx:"65",cy:"65",r:"54",fill:"none",stroke:Mi(_),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:E,strokeDashoffset:z,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.4,0,0.2,1)"}})]}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:32,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Mi(_),lineHeight:1},children:b?Math.round(b):""}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"/ 100"})]})]}),e.jsxs("div",{style:{display:"inline-block",marginTop:8,padding:"4px 16px",borderRadius:20,background:`${Mi(_)}18`,border:`1px solid ${Mi(_)}40`,fontSize:12,fontWeight:700,letterSpacing:"0.08em",color:Mi(_)},children:[_??"","  ",B2(_)]})]}),e.jsxs("div",{style:{flex:1,minWidth:280},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:6},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.08em",color:"var(--text-muted)"},children:"Executive Briefing"}),O&&e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:4,background:"var(--blue-dim)",color:"var(--blue)"},children:O})]}),e.jsx("div",{style:{fontSize:14,color:"var(--text-primary)",lineHeight:1.5,marginBottom:14},children:Dy(_)}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:G.map((M,V)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12},children:[e.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:M.color,flexShrink:0}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:M.text})]},V))}),R&&e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,fontSize:11},children:[e.jsxs("span",{style:{padding:"3px 10px",borderRadius:4,background:R.delta>0?"var(--red-dim)":R.delta<0?"var(--green-dim)":"var(--blue-dim)",color:R.delta>0?"var(--red)":R.delta<0?"var(--green)":"var(--blue)",fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:[R.delta>0?`+${R.delta}`:R.delta<0?String(R.delta):"0"," ryzyk wysokich m/m",R.delta>0?" ":R.delta<0?" ":" "]}),R.totalDelta!==0&&e.jsxs("span",{style:{padding:"3px 10px",borderRadius:4,background:"var(--bg-subtle)",color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:[R.totalDelta>0?"+":"",R.totalDelta," ogem m/m"]})]})]}),F.length>0&&e.jsxs("div",{style:{flexShrink:0,minWidth:200,maxWidth:260},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Rekomendowane Dziaania"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:F.slice(0,4).map((M,V)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"7px 12px",borderRadius:6,background:"var(--bg-subtle)",border:"1px solid var(--border)",cursor:"pointer",transition:"var(--transition)",fontSize:12,color:"var(--text-secondary)"},onClick:()=>M.link!=="#"&&y(M.link),onMouseEnter:ne=>{ne.currentTarget.style.background="var(--bg-card-hover)",ne.currentTarget.style.borderColor="var(--border-light)"},onMouseLeave:ne=>{ne.currentTarget.style.background="var(--bg-subtle)",ne.currentTarget.style.borderColor="var(--border)"},children:[e.jsx("span",{style:{color:"var(--blue)",fontSize:11,flexShrink:0},children:""}),e.jsx("span",{children:M.text})]},V))})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:14,marginBottom:16},children:[e.jsxs("div",{className:"card clickable",onClick:()=>y(Eo("/risks",{org_unit_id:x||null})),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Ekspozycja na Ryzyko"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-primary)",lineHeight:1},children:N.total}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:[Ao(N.total,"ryzyko","ryzyka","ryzyk")," ogem"]}),e.jsxs("div",{style:{display:"flex",height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:[N.high>0&&e.jsx("div",{style:{width:`${W}%`,background:"var(--red)"}}),N.medium>0&&e.jsx("div",{style:{width:`${J}%`,background:"var(--orange)"}}),N.low>0&&e.jsx("div",{style:{flex:1,background:"var(--green)"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:5,fontSize:10,fontFamily:"'JetBrains Mono',monospace"},children:[e.jsxs("span",{style:{color:"var(--red)"},children:[N.high," wys."]}),e.jsxs("span",{style:{color:"var(--orange)"},children:[N.medium," r."]}),e.jsxs("span",{style:{color:"var(--green)"},children:[N.low," nis."]})]})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/frameworks"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:t?.maturity_framework_name??"Control Maturity"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:rr(t?.maturity_score??0),lineHeight:1},children:t?.maturity_score!=null?t.maturity_score.toFixed(1):t?.cis_maturity_rating!=null?t.cis_maturity_rating.toFixed(1):""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:t?.maturity_score!=null?"maturity / 100":t?.cis_maturity_rating!=null?"maturity / 5.0":"brak oceny"}),t?.maturity_completion_pct!=null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Kompletno oceny"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(t.maturity_completion_pct)},children:[Math.round(t.maturity_completion_pct),"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${t.maturity_completion_pct}%`,height:"100%",borderRadius:3,background:rr(t.maturity_completion_pct),transition:"width 1s ease"}})})]})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/assets"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Aktywa CMDB"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)",lineHeight:1},children:H||""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"zarejestrowanych aktyww"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Pokrycie kategorii"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(A)},children:[A,"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${A}%`,height:"100%",borderRadius:3,background:"var(--purple)",transition:"width 1s ease"}})})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/vulnerabilities"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Incydenty & Podatnoci"}),e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"baseline"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:L>0?"var(--red)":"var(--green)",lineHeight:1},children:L}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"incydentw"})]}),e.jsx("div",{style:{width:1,height:30,background:"var(--border)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:U>5?"var(--orange)":U>0?"var(--yellow)":"var(--green)",lineHeight:1},children:U}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"podatnoci"})]})]}),(L>0||U>0)&&e.jsx("div",{style:{marginTop:8,padding:"3px 8px",borderRadius:4,background:L>0?"var(--red-dim)":"var(--yellow-dim)",color:L>0?"var(--red)":"var(--yellow)",fontSize:10,display:"inline-block"},children:L>0?"Wymaga natychmiastowej reakcji":"Zaplanuj remediacj"})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/reviews"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Dyscyplina Przegldw"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:(t?.overdue_reviews_count??0)>0?"var(--orange)":"var(--green)",lineHeight:1},children:t?.overdue_reviews_count??0}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"przeterminowanych"}),N.total>0&&(()=>{const M=N.total-(t?.overdue_reviews_count??0),V=Math.round(M/N.total*100);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Terminowo"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(V)},children:[V,"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${V}%`,height:"100%",borderRadius:3,background:rr(V),transition:"width 1s ease"}})})]})})()]})]}),e.jsxs("div",{className:"grid-2-1",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Macierz Ryzyka (Wpyw x Prawdopodobiestwo)"}),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(3, 1fr)",gap:6,maxWidth:400},children:[e.jsx("div",{}),["W=1 Niski","W=2 redni","W=3 Wysoki"].map(M=>e.jsx("div",{className:"heatmap-header",children:M},M)),[3,2,1].map(M=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{className:"heatmap-label",style:{lineHeight:"40px"},children:["P=",M]}),[1,2,3].map(V=>{const ne=a?R2(a.matrix,V,M):0;return e.jsx("div",{className:"heatmap-cell",style:{background:ne>0?F2(V,M):"var(--bg-subtle)",color:ne>0?"#fff":"var(--text-muted)",height:40,opacity:ne>0?1:.5,cursor:ne>0?"pointer":"default"},onClick:()=>ne>0&&y(Eo("/risks",{impact:V,prob:M,org_unit_id:x||null})),children:ne>0?ne:""},`${V}-${M}`)})]},`row-${M}`))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:8,textAlign:"center"},children:"R = EXP(W)  P / Z | Wysoki 221  redni 31220  Niski <31"})]}),a&&a.by_area.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{className:"card-title",style:{marginBottom:10},children:"Ryzyka wg Obszarw"}),a.by_area.map(M=>e.jsxs("div",{className:"bar-row",children:[e.jsx("div",{className:"bar-label",children:M.area_name}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill",style:{width:`${Math.min(100,M.total/Math.max(1,N.total)*100)}%`,background:`linear-gradient(90deg, var(--red) ${M.high/Math.max(1,M.total)*100}%, var(--orange) ${M.high/Math.max(1,M.total)*100}%, var(--orange) ${(M.high+M.medium)/Math.max(1,M.total)*100}%, var(--green) ${(M.high+M.medium)/Math.max(1,M.total)*100}%)`},"data-value":String(M.total)})}),e.jsx("div",{className:"bar-score",style:{color:M.high>0?"var(--red)":"var(--text-secondary)"},children:M.total})]},M.area_id))]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{textAlign:"center",paddingBottom:16},children:[e.jsx("div",{className:"card-title",children:"Security Score"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:e.jsxs("div",{className:"score-ring",style:{width:140,height:140},children:[e.jsxs("svg",{width:"140",height:"140",viewBox:"0 0 140 140",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"70",cy:"70",r:"58",fill:"none",stroke:"var(--border)",strokeWidth:"8"}),e.jsx("circle",{cx:"70",cy:"70",r:"58",fill:"none",stroke:Mi(_),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:2*Math.PI*58,strokeDashoffset:2*Math.PI*58-b/100*2*Math.PI*58,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.4,0,0.2,1)"}})]}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:34,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Mi(_),lineHeight:1},children:b?Math.round(b):""}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"/ 100"})]})]})}),_&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:Mi(_)},children:_}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",marginTop:2,lineHeight:1.4,padding:"0 8px"},children:Dy(_)})]}),o?.benchmark_avg!=null&&e.jsxs("div",{style:{marginTop:10,padding:"6px 12px",borderRadius:6,background:"var(--bg-subtle)",display:"inline-flex",alignItems:"center",gap:6,fontSize:11},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"vs. rednia org:"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:b>=o.benchmark_avg?"var(--green)":"var(--orange)"},children:[b>=o.benchmark_avg?"+":"",(b-o.benchmark_avg).toFixed(0)," pkt"]})]})]}),o&&o.dimensions.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Filary Security Score"}),o.dimensions.map(M=>{const V=q?.name===M.name&&M.score<70;return e.jsxs("div",{style:{marginBottom:12,padding:V?"8px 10px":0,borderRadius:6,background:V?"rgba(239,68,68,0.05)":"transparent",border:V?"1px solid rgba(239,68,68,0.15)":"1px solid transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:3},children:[e.jsxs("span",{style:{color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:4},children:[M.name,V&&e.jsx("span",{style:{fontSize:9,color:"var(--red)",fontWeight:600},children:"WYMAGA UWAGI"})]}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(M.score)},children:[Math.round(M.score),"%",e.jsxs("span",{style:{fontSize:9,color:"var(--text-muted)",marginLeft:4},children:["(",Math.round(M.weight*100),"%)"]})]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${M.score}%`,background:M.color??rr(M.score),height:8}})}),e.jsx("div",{style:{position:"absolute",left:"70%",top:-2,width:1,height:12,background:"var(--text-muted)",opacity:.4}})]})]},M.name)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:6,fontSize:10,color:"var(--text-muted)"},children:[e.jsx("div",{style:{width:1,height:10,background:"var(--text-muted)",opacity:.4}}),e.jsx("span",{children:"Prg akceptacji: 70%"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:t?.maturity_framework_name??"Control Maturity"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[e.jsx("div",{style:{fontSize:28,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:rr(t?.maturity_score??t?.cis_maturity_rating?t.cis_maturity_rating/5*100:0)},children:t?.maturity_score!=null?t.maturity_score.toFixed(1):t?.cis_maturity_rating?.toFixed(2)??""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12},children:"Maturity Score"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:t?.maturity_score!=null?"Skala 0100":"Skala 05"})]})]}),t?.maturity_completion_pct!=null&&e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:3},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:"Kompletno oceny"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(t.maturity_completion_pct)},children:[Math.round(t.maturity_completion_pct),"%"]})]}),e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${t.maturity_completion_pct}%`,background:rr(t.maturity_completion_pct),height:8}})})]})]})]})]}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Top 5 Ryzyk Krytycznych"}),t?.top_risks&&t.top_risks.length>0?e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ocena"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.top_risks.slice(0,5).map(M=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>y(Eo("/risks",{highlight:M.id})),children:[e.jsx("td",{style:{fontWeight:500},children:M.asset_name}),e.jsx("td",{style:{fontSize:12},children:M.org_unit}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:Oy(M.risk_level),color:By(M.risk_level)},children:Number(M.risk_score).toFixed(1)})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)"},children:M.status??""})]},M.id))})]}):e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Brak danych o ryzykach."})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Rozkad Ryzyk"}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:16},children:[{label:"Wysokie",count:N.high,color:"var(--red)",bg:"var(--red-dim)",level:"high"},{label:"rednie",count:N.medium,color:"var(--orange)",bg:"var(--orange-dim)",level:"medium"},{label:"Niskie",count:N.low,color:"var(--green)",bg:"var(--green-dim)",level:"low"}].map(M=>e.jsxs("div",{style:{flex:1,textAlign:"center",background:M.bg,borderRadius:8,padding:"12px 8px",cursor:"pointer"},onClick:()=>y(Eo("/risks",{level:M.level,org_unit_id:x||null})),children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:M.color},children:M.count}),e.jsx("div",{style:{fontSize:11,color:M.color},children:M.label})]},M.label))}),a&&a.by_org_unit.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Ryzyka wg Pionw"}),a.by_org_unit.map(M=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:12},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:M.org_unit_name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[M.high>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:M.high}),M.medium>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--orange-dim)",color:"var(--orange)"},children:M.medium}),M.low>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:M.low})]})]},M.org_unit_id))]})]})]}),a&&a.by_status.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Status Ryzyk"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.by_status.map(M=>e.jsxs("div",{style:{background:M.status_color?`${M.status_color}20`:"var(--bg-card)",border:`1px solid ${M.status_color??"var(--border)"}`,borderRadius:8,padding:"10px 16px",textAlign:"center",minWidth:100},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:M.status_color??"var(--text)"},children:M.count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:M.status})]},M.status))})]}),a&&a.trend.length>1&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Trend Ryzyk (12 mies.)"}),e.jsx("div",{style:{display:"flex",gap:2,alignItems:"flex-end",height:120},children:a.trend.map(M=>{const V=Math.max(...a.trend.map(C=>C.total),1),ne=M.total/V*100,P=M.high/Math.max(M.total,1)*100,T=M.medium/Math.max(M.total,1)*100;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("div",{style:{fontSize:9,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-muted)"},children:M.total}),e.jsxs("div",{style:{width:"100%",maxWidth:40,height:`${ne}%`,minHeight:2,borderRadius:"4px 4px 0 0",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:"100%",background:"var(--green)"}}),e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:`${P+T}%`,background:"var(--orange)"}}),e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:`${P}%`,background:"var(--red)"}})]}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",whiteSpace:"nowrap"},children:M.period})]},M.period)})}),e.jsx("div",{style:{display:"flex",gap:16,justifyContent:"center",marginTop:10},children:[{label:"Wysokie",color:"var(--red)"},{label:"rednie",color:"var(--orange)"},{label:"Niskie",color:"var(--green)"}].map(M=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:10,color:"var(--text-muted)"},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:2,background:M.color}})," ",M.label]},M.label))})]}),a&&a.overdue_reviews.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-title",children:["Przeterminowane Przegldy",e.jsxs("span",{style:{fontSize:11,color:"var(--red)",marginLeft:8},children:["(",a.overdue_reviews.length,")"]})]}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ocena"}),e.jsx("th",{children:"Dni od przegldu"}),e.jsx("th",{children:"Waciciel"})]})}),e.jsx("tbody",{children:a.overdue_reviews.slice(0,10).map(M=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:M.asset_name}),e.jsx("td",{style:{fontSize:12},children:M.org_unit}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:Oy(M.risk_level),color:By(M.risk_level)},children:Number(M.risk_score).toFixed(1)})}),e.jsx("td",{children:e.jsxs("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:[M.days_since_review," dni"]})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)"},children:M.owner??""})]},M.id))})]})]})]})}function D1(t,n=0){const a=[];for(const s of t)a.push({id:s.id,name:s.name,depth:n}),a.push(...D1(s.children,n+1));return a}function Tl(t,n=""){const a=new Map;for(const s of t){const o=n?`${n}\\${s.name}`:s.name;a.set(s.id,o),Tl(s.children,o).forEach((u,h)=>a.set(h,u))}return a}function gt({open:t,onClose:n,title:a,children:s,wide:o}){const c=m.useRef(null);return m.useEffect(()=>{const u=h=>{h.key==="Escape"&&n()};return t&&document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[t,n]),t?e.jsx("div",{ref:c,className:"modal-overlay active",onClick:u=>{u.target===c.current&&n()},children:e.jsxs("div",{className:"modal",style:o?{maxWidth:900}:void 0,children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:a}),e.jsx("button",{className:"modal-close",onClick:n,children:""})]}),e.jsx("div",{className:"modal-body",children:s})]})}):null}var yu={};yu.version="0.18.5";var L1=1252,D2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],M1=function(t){D2.indexOf(t)!=-1&&(L1=t)};function L2(){M1(1252)}var tc=function(t){M1(t)};function M2(){tc(1200),L2()}var Dd=function(n){return String.fromCharCode(n)},Ly=function(n){return String.fromCharCode(n)},vu,$i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ac(t){for(var n="",a=0,s=0,o=0,c=0,u=0,h=0,f=0,p=0;p<t.length;)a=t.charCodeAt(p++),c=a>>2,s=t.charCodeAt(p++),u=(a&3)<<4|s>>4,o=t.charCodeAt(p++),h=(s&15)<<2|o>>6,f=o&63,isNaN(s)?h=f=64:isNaN(o)&&(f=64),n+=$i.charAt(c)+$i.charAt(u)+$i.charAt(h)+$i.charAt(f);return n}function oi(t){var n="",a=0,s=0,o=0,c=0,u=0,h=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<t.length;)c=$i.indexOf(t.charAt(p++)),u=$i.indexOf(t.charAt(p++)),a=c<<2|u>>4,n+=String.fromCharCode(a),h=$i.indexOf(t.charAt(p++)),s=(u&15)<<4|h>>2,h!==64&&(n+=String.fromCharCode(s)),f=$i.indexOf(t.charAt(p++)),o=(h&3)<<6|f,f!==64&&(n+=String.fromCharCode(o));return n}var Vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),di=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(n,a){return a?new Buffer(n,a):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}})();function bs(t){return Vt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function My(t){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var wr=function(n){return Vt?di(n,"binary"):n.split("").map(function(a){return a.charCodeAt(0)&255})};function Iu(t){if(typeof ArrayBuffer>"u")return wr(t);for(var n=new ArrayBuffer(t.length),a=new Uint8Array(n),s=0;s!=t.length;++s)a[s]=t.charCodeAt(s)&255;return n}function mc(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var n=[],a=0;a<t.length;++a)n[a]=String.fromCharCode(t[a]);return n.join("")}function I2(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var nn=Vt?function(t){return Buffer.concat(t.map(function(n){return Buffer.isBuffer(n)?n:di(n)}))}:function(t){if(typeof Uint8Array<"u"){var n=0,a=0;for(n=0;n<t.length;++n)a+=t[n].length;var s=new Uint8Array(a),o=0;for(n=0,a=0;n<t.length;a+=o,++n)if(o=t[n].length,t[n]instanceof Uint8Array)s.set(t[n],a);else{if(typeof t[n]=="string")throw"wtf";s.set(new Uint8Array(t[n]),a)}return s}return[].concat.apply([],t.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function P2(t){for(var n=[],a=0,s=t.length+250,o=bs(t.length+255),c=0;c<t.length;++c){var u=t.charCodeAt(c);if(u<128)o[a++]=u;else if(u<2048)o[a++]=192|u>>6&31,o[a++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var h=t.charCodeAt(++c)&1023;o[a++]=240|u>>8&7,o[a++]=128|u>>2&63,o[a++]=128|h>>6&15|(u&3)<<4,o[a++]=128|h&63}else o[a++]=224|u>>12&15,o[a++]=128|u>>6&63,o[a++]=128|u&63;a>s&&(n.push(o.slice(0,a)),a=0,o=bs(65535),s=65530)}return n.push(o.slice(0,a)),nn(n)}var Vo=/\u0000/g,Ld=/[\u0001-\u0006]/g;function vl(t){for(var n="",a=t.length-1;a>=0;)n+=t.charAt(a--);return n}function kr(t,n){var a=""+t;return a.length>=n?a:wa("0",n-a.length)+a}function pp(t,n){var a=""+t;return a.length>=n?a:wa(" ",n-a.length)+a}function ju(t,n){var a=""+t;return a.length>=n?a:a+wa(" ",n-a.length)}function W2(t,n){var a=""+Math.round(t);return a.length>=n?a:wa("0",n-a.length)+a}function U2(t,n){var a=""+t;return a.length>=n?a:wa("0",n-a.length)+a}var Iy=Math.pow(2,32);function dl(t,n){if(t>Iy||t<-Iy)return W2(t,n);var a=Math.round(t);return U2(a,n)}function bu(t,n){return n=n||0,t.length>=7+n&&(t.charCodeAt(n)|32)===103&&(t.charCodeAt(n+1)|32)===101&&(t.charCodeAt(n+2)|32)===110&&(t.charCodeAt(n+3)|32)===101&&(t.charCodeAt(n+4)|32)===114&&(t.charCodeAt(n+5)|32)===97&&(t.charCodeAt(n+6)|32)===108}var Py=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $2(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ka={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Wy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},H2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _u(t,n,a){for(var s=t<0?-1:1,o=t*s,c=0,u=1,h=0,f=1,p=0,x=0,j=Math.floor(o);p<n&&(j=Math.floor(o),h=j*u+c,x=j*p+f,!(o-j<5e-8));)o=1/(o-j),c=u,u=h,f=p,p=x;if(x>n&&(p>n?(x=f,h=c):(x=p,h=u)),!a)return[0,s*h,x];var y=Math.floor(s*h/x);return[y,s*h-y*x,x]}function Md(t,n,a){if(t>2958465||t<0)return null;var s=t|0,o=Math.floor(86400*(t-s)),c=0,u=[],h={D:s,T:o,u:86400*(t-s)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),n&&n.date1904&&(s+=1462),h.u>.9999&&(h.u=0,++o==86400&&(h.T=o=0,++s,++h.D)),s===60)u=a?[1317,10,29]:[1900,2,29],c=3;else if(s===0)u=a?[1317,8,29]:[1900,1,0],c=6;else{s>60&&--s;var f=new Date(1900,0,1);f.setDate(f.getDate()+s-1),u=[f.getFullYear(),f.getMonth()+1,f.getDate()],c=f.getDay(),s<60&&(c=(c+6)%7),a&&(c=J2(f,u))}return h.y=u[0],h.m=u[1],h.d=u[2],h.S=o%60,o=Math.floor(o/60),h.M=o%60,o=Math.floor(o/60),h.H=o,h.q=c,h}var I1=new Date(1899,11,31,0,0,0),V2=I1.getTime(),Z2=new Date(1900,2,1,0,0,0);function P1(t,n){var a=t.getTime();return n?a-=1461*24*60*60*1e3:t>=Z2&&(a+=1440*60*1e3),(a-(V2+(t.getTimezoneOffset()-I1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function gp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function G2(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function K2(t){var n=t<0?12:11,a=gp(t.toFixed(12));return a.length<=n||(a=t.toPrecision(10),a.length<=n)?a:t.toExponential(5)}function q2(t){var n=gp(t.toFixed(11));return n.length>(t<0?12:11)||n==="0"||n==="-0"?t.toPrecision(6):n}function Y2(t){var n=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),a;return n>=-4&&n<=-1?a=t.toPrecision(10+n):Math.abs(n)<=9?a=K2(t):n===10?a=t.toFixed(10).substr(0,12):a=q2(t),gp(G2(a.toUpperCase()))}function Xm(t,n){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Y2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Zi(14,P1(t,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+t)}function J2(t,n){n[0]-=581;var a=t.getDay();return t<60&&(a=(a+6)%7),a}function X2(t,n,a,s){var o="",c=0,u=0,h=a.y,f,p=0;switch(t){case 98:h=a.y+543;case 121:switch(n.length){case 1:case 2:f=h%100,p=2;break;default:f=h%1e4,p=4;break}break;case 109:switch(n.length){case 1:case 2:f=a.m,p=n.length;break;case 3:return im[a.m-1][1];case 5:return im[a.m-1][0];default:return im[a.m-1][2]}break;case 100:switch(n.length){case 1:case 2:f=a.d,p=n.length;break;case 3:return Py[a.q][0];default:return Py[a.q][1]}break;case 104:switch(n.length){case 1:case 2:f=1+(a.H+11)%12,p=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:f=a.H,p=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:f=a.M,p=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return a.u===0&&(n=="s"||n=="ss")?kr(a.S,n.length):(s>=2?u=s===3?1e3:100:u=s===1?10:1,c=Math.round(u*(a.S+a.u)),c>=60*u&&(c=0),n==="s"?c===0?"0":""+c/u:(o=kr(c,2+s),n==="ss"?o.substr(0,2):"."+o.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":f=a.D*24+a.H;break;case"[m]":case"[mm]":f=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":f=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+n}p=n.length===3?1:2;break;case 101:f=h,p=1;break}var x=p>0?kr(f,p):"";return x}function Hi(t){var n=3;if(t.length<=n)return t;for(var a=t.length%n,s=t.substr(0,a);a!=t.length;a+=n)s+=(s.length>0?",":"")+t.substr(a,n);return s}var W1=/%/g;function Q2(t,n,a){var s=n.replace(W1,""),o=n.length-s.length;return ri(t,s,a*Math.pow(10,2*o))+wa("%",o)}function ek(t,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return ri(t,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function U1(t,n){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+U1(t,-n);var o=t.indexOf(".");o===-1&&(o=t.indexOf("E"));var c=Math.floor(Math.log(n)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(n/Math.pow(10,c)).toPrecision(s+1+(o+c)%o),a.indexOf("e")===-1){var u=Math.floor(Math.log(n)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+c):a+="E+"+(u-c);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,p,x){return f+p+x.substr(0,(o+c)%o)+"."+x.substr(c)+"E"})}else a=n.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var $1=/# (\?+)( ?)\/( ?)(\d+)/;function tk(t,n,a){var s=parseInt(t[4],10),o=Math.round(n*s),c=Math.floor(o/s),u=o-c*s,h=s;return a+(c===0?"":""+c)+" "+(u===0?wa(" ",t[1].length+1+t[4].length):pp(u,t[1].length)+t[2]+"/"+t[3]+kr(h,t[4].length))}function ak(t,n,a){return a+(n===0?"":""+n)+wa(" ",t[1].length+2+t[4].length)}var H1=/^#*0*\.([0#]+)/,V1=/\).*[0#]/,Z1=/\(###\) ###\\?-####/;function xn(t){for(var n="",a,s=0;s!=t.length;++s)switch(a=t.charCodeAt(s)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(a)}return n}function Uy(t,n){var a=Math.pow(10,n);return""+Math.round(t*a)/a}function $y(t,n){var a=t-Math.floor(t),s=Math.pow(10,n);return n<(""+Math.round(a*s)).length?0:Math.round(a*s)}function nk(t,n){return n<(""+Math.round((t-Math.floor(t))*Math.pow(10,n))).length?1:0}function rk(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function sr(t,n,a){if(t.charCodeAt(0)===40&&!n.match(V1)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?sr("n",s,a):"("+sr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return ek(t,n,a);if(n.indexOf("%")!==-1)return Q2(t,n,a);if(n.indexOf("E")!==-1)return U1(n,a);if(n.charCodeAt(0)===36)return"$"+sr(t,n.substr(n.charAt(1)==" "?2:1),a);var o,c,u,h,f=Math.abs(a),p=a<0?"-":"";if(n.match(/^00+$/))return p+dl(f,n.length);if(n.match(/^[#?]+$/))return o=dl(a,0),o==="0"&&(o=""),o.length>n.length?o:xn(n.substr(0,n.length-o.length))+o;if(c=n.match($1))return tk(c,f,p);if(n.match(/^#+0+$/))return p+dl(f,n.length-n.indexOf("0"));if(c=n.match(H1))return o=Uy(a,c[1].length).replace(/^([^\.]+)$/,"$1."+xn(c[1])).replace(/\.$/,"."+xn(c[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+wa("0",xn(c[1]).length-b.length)}),n.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),c=n.match(/^(0*)\.(#*)$/))return p+Uy(f,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=n.match(/^#{1,3},##0(\.?)$/))return p+Hi(dl(f,0));if(c=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+sr(t,n,-a):Hi(""+(Math.floor(a)+nk(a,c[1].length)))+"."+kr($y(a,c[1].length),c[1].length);if(c=n.match(/^#,#*,#0/))return sr(t,n.replace(/^#,#*,/,""),a);if(c=n.match(/^([0#]+)(\\?-([0#]+))+$/))return o=vl(sr(t,n.replace(/[\\-]/g,""),a)),u=0,vl(vl(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<o.length?o.charAt(u++):w==="0"?"0":""}));if(n.match(Z1))return o=sr(t,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(c=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(c[4].length,7),h=_u(f,Math.pow(10,u)-1,!1),o=""+p,x=ri("n",c[1],h[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+c[2]+"/"+c[3],x=ju(h[2],u),x.length<c[4].length&&(x=xn(c[4].substr(c[4].length-x.length))+x),o+=x,o;if(c=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(c[1].length,c[4].length),7),h=_u(f,Math.pow(10,u)-1,!0),p+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pp(h[1],u)+c[2]+"/"+c[3]+ju(h[2],u):wa(" ",2*u+1+c[2].length+c[3].length));if(c=n.match(/^[#0?]+$/))return o=dl(a,0),n.length<=o.length?o:xn(n.substr(0,n.length-o.length))+o;if(c=n.match(/^([#0?]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var j=n.indexOf(".")-u,y=n.length-o.length-j;return xn(n.substr(0,j)+o+n.substr(n.length-y))}if(c=n.match(/^00,000\.([#0]*0)$/))return u=$y(a,c[1].length),a<0?"-"+sr(t,n,-a):Hi(rk(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kr(0,3-w.length):"")+w})+"."+kr(u,c[1].length);switch(n){case"###,##0.00":return sr(t,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var S=Hi(dl(f,0));return S!=="0"?p+S:"";case"###,###.00":return sr(t,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return sr(t,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+n+"|")}function ik(t,n,a){for(var s=n.length-1;n.charCodeAt(s-1)===44;)--s;return ri(t,n.substr(0,s),a/Math.pow(10,3*(n.length-s)))}function sk(t,n,a){var s=n.replace(W1,""),o=n.length-s.length;return ri(t,s,a*Math.pow(10,2*o))+wa("%",o)}function G1(t,n){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+G1(t,-n);var o=t.indexOf(".");o===-1&&(o=t.indexOf("E"));var c=Math.floor(Math.log(n)*Math.LOG10E)%o;if(c<0&&(c+=o),a=(n/Math.pow(10,c)).toPrecision(s+1+(o+c)%o),!a.match(/[Ee]/)){var u=Math.floor(Math.log(n)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+c):a+="E+"+(u-c),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,p,x){return f+p+x.substr(0,(o+c)%o)+"."+x.substr(c)+"E"})}else a=n.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Rr(t,n,a){if(t.charCodeAt(0)===40&&!n.match(V1)){var s=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Rr("n",s,a):"("+Rr("n",s,-a)+")"}if(n.charCodeAt(n.length-1)===44)return ik(t,n,a);if(n.indexOf("%")!==-1)return sk(t,n,a);if(n.indexOf("E")!==-1)return G1(n,a);if(n.charCodeAt(0)===36)return"$"+Rr(t,n.substr(n.charAt(1)==" "?2:1),a);var o,c,u,h,f=Math.abs(a),p=a<0?"-":"";if(n.match(/^00+$/))return p+kr(f,n.length);if(n.match(/^[#?]+$/))return o=""+a,a===0&&(o=""),o.length>n.length?o:xn(n.substr(0,n.length-o.length))+o;if(c=n.match($1))return ak(c,f,p);if(n.match(/^#+0+$/))return p+kr(f,n.length-n.indexOf("0"));if(c=n.match(H1))return o=(""+a).replace(/^([^\.]+)$/,"$1."+xn(c[1])).replace(/\.$/,"."+xn(c[1])),o=o.replace(/\.(\d*)$/,function(w,b){return"."+b+wa("0",xn(c[1]).length-b.length)}),n.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),c=n.match(/^(0*)\.(#*)$/))return p+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=n.match(/^#{1,3},##0(\.?)$/))return p+Hi(""+f);if(c=n.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Rr(t,n,-a):Hi(""+a)+"."+wa("0",c[1].length);if(c=n.match(/^#,#*,#0/))return Rr(t,n.replace(/^#,#*,/,""),a);if(c=n.match(/^([0#]+)(\\?-([0#]+))+$/))return o=vl(Rr(t,n.replace(/[\\-]/g,""),a)),u=0,vl(vl(n.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<o.length?o.charAt(u++):w==="0"?"0":""}));if(n.match(Z1))return o=Rr(t,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(c=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(c[4].length,7),h=_u(f,Math.pow(10,u)-1,!1),o=""+p,x=ri("n",c[1],h[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+c[2]+"/"+c[3],x=ju(h[2],u),x.length<c[4].length&&(x=xn(c[4].substr(c[4].length-x.length))+x),o+=x,o;if(c=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(c[1].length,c[4].length),7),h=_u(f,Math.pow(10,u)-1,!0),p+(h[0]||(h[1]?"":"0"))+" "+(h[1]?pp(h[1],u)+c[2]+"/"+c[3]+ju(h[2],u):wa(" ",2*u+1+c[2].length+c[3].length));if(c=n.match(/^[#0?]+$/))return o=""+a,n.length<=o.length?o:xn(n.substr(0,n.length-o.length))+o;if(c=n.match(/^([#0]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var j=n.indexOf(".")-u,y=n.length-o.length-j;return xn(n.substr(0,j)+o+n.substr(n.length-y))}if(c=n.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Rr(t,n,-a):Hi(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kr(0,3-w.length):"")+w})+"."+kr(0,c[1].length);switch(n){case"###,###":case"##,###":case"#,###":var S=Hi(""+f);return S!=="0"?p+S:"";default:if(n.match(/\.[0#?]*$/))return Rr(t,n.slice(0,n.lastIndexOf(".")),a)+xn(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ri(t,n,a){return(a|0)===a?Rr(t,n,a):sr(t,n,a)}function lk(t){for(var n=[],a=!1,s=0,o=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:n[n.length]=t.substr(o,s-o),o=s+1}if(n[n.length]=t.substr(o),a===!0)throw new Error("Format |"+t+"| unterminated string ");return n}var K1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function q1(t){for(var n=0,a="",s="";n<t.length;)switch(a=t.charAt(n)){case"G":bu(t,n)&&(n+=6),n++;break;case'"':for(;t.charCodeAt(++n)!==34&&n<t.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(t.charAt(n+1)==="1"||t.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(n,3).toUpperCase()==="A/P"||t.substr(n,5).toUpperCase()==="AM/PM"||t.substr(n,5).toUpperCase()==="/")return!0;++n;break;case"[":for(s=a;t.charAt(n++)!=="]"&&n<t.length;)s+=t.charAt(n);if(s.match(K1))return!0;break;case".":case"0":case"#":for(;n<t.length&&("0#?.,E+-%".indexOf(a=t.charAt(++n))>-1||a=="\\"&&t.charAt(n+1)=="-"&&"0#".indexOf(t.charAt(n+2))>-1););break;case"?":for(;t.charAt(++n)===a;);break;case"*":++n,(t.charAt(n)==" "||t.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<t.length&&"0123456789".indexOf(t.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function ok(t,n,a,s){for(var o=[],c="",u=0,h="",f="t",p,x,j,y="H";u<t.length;)switch(h=t.charAt(u)){case"G":if(!bu(t,u))throw new Error("unrecognized character "+h+" in "+t);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(c="";(j=t.charCodeAt(++u))!==34&&u<t.length;)c+=String.fromCharCode(j);o[o.length]={t:"t",v:c},++u;break;case"\\":var S=t.charAt(++u),w=S==="("||S===")"?S:"t";o[o.length]={t:w,v:S},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:n},++u;break;case"B":case"b":if(t.charAt(u+1)==="1"||t.charAt(u+1)==="2"){if(p==null&&(p=Md(n,a,t.charAt(u+1)==="2"),p==null))return"";o[o.length]={t:"X",v:t.substr(u,2)},f=h,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||p==null&&(p=Md(n,a),p==null))return"";for(c=h;++u<t.length&&t.charAt(u).toLowerCase()===h;)c+=h;h==="m"&&f.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),o[o.length]={t:h,v:c},f=h;break;case"A":case"a":case"":var b={t:h,v:h};if(p==null&&(p=Md(n,a)),t.substr(u,3).toUpperCase()==="A/P"?(p!=null&&(b.v=p.H>=12?"P":"A"),b.t="T",y="h",u+=3):t.substr(u,5).toUpperCase()==="AM/PM"?(p!=null&&(b.v=p.H>=12?"PM":"AM"),b.t="T",u+=5,y="h"):t.substr(u,5).toUpperCase()==="/"?(p!=null&&(b.v=p.H>=12?"":""),b.t="T",u+=5,y="h"):(b.t="t",++u),p==null&&b.t==="T")return"";o[o.length]=b,f=h;break;case"[":for(c=h;t.charAt(u++)!=="]"&&u<t.length;)c+=t.charAt(u);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(K1)){if(p==null&&(p=Md(n,a),p==null))return"";o[o.length]={t:"Z",v:c.toLowerCase()},f=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",q1(t)||(o[o.length]={t:"t",v:c}));break;case".":if(p!=null){for(c=h;++u<t.length&&(h=t.charAt(u))==="0";)c+=h;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=h;++u<t.length&&"0#?.,E+-%".indexOf(h=t.charAt(u))>-1;)c+=h;o[o.length]={t:"n",v:c};break;case"?":for(c=h;t.charAt(++u)===h;)c+=h;o[o.length]={t:h,v:c},f=h;break;case"*":++u,(t.charAt(u)==" "||t.charAt(u)=="*")&&++u;break;case"(":case")":o[o.length]={t:s===1?"t":h,v:h},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=h;u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1;)c+=t.charAt(u);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:h,v:h},++u;break;case"$":o[o.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+t);o[o.length]={t:"t",v:h},++u;break}var _=0,E=0,z;for(u=o.length-1,f="t";u>=0;--u)switch(o[u].t){case"h":case"H":o[u].t=y,f="h",_<1&&(_=1);break;case"s":(z=o[u].v.match(/\.0+$/))&&(E=Math.max(E,z[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=o[u].t;break;case"m":f==="s"&&(o[u].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&o[u].v.match(/[Hh]/)&&(_=1),_<2&&o[u].v.match(/[Mm]/)&&(_=2),_<3&&o[u].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var N="",O;for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=X2(o[u].t.charCodeAt(0),o[u].v,p,E),o[u].t="t";break;case"n":case"?":for(O=u+1;o[O]!=null&&((h=o[O].t)==="?"||h==="D"||(h===" "||h==="t")&&o[O+1]!=null&&(o[O+1].t==="?"||o[O+1].t==="t"&&o[O+1].v==="/")||o[u].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(o[O].v==="/"||o[O].v===" "&&o[O+1]!=null&&o[O+1].t=="?"));)o[u].v+=o[O].v,o[O]={v:"",t:";"},++O;N+=o[u].v,u=O-1;break;case"G":o[u].t="t",o[u].v=Xm(n,a);break}var Q="",U,L;if(N.length>0){N.charCodeAt(0)==40?(U=n<0&&N.charCodeAt(0)===45?-n:n,L=ri("n",N,U)):(U=n<0&&s>1?-n:n,L=ri("n",N,U),U<0&&o[0]&&o[0].t=="t"&&(L=L.substr(1),o[0].v="-"+o[0].v)),O=L.length-1;var H=o.length;for(u=0;u<o.length;++u)if(o[u]!=null&&o[u].t!="t"&&o[u].v.indexOf(".")>-1){H=u;break}var A=o.length;if(H===o.length&&L.indexOf("E")===-1){for(u=o.length-1;u>=0;--u)o[u]==null||"n?".indexOf(o[u].t)===-1||(O>=o[u].v.length-1?(O-=o[u].v.length,o[u].v=L.substr(O+1,o[u].v.length)):O<0?o[u].v="":(o[u].v=L.substr(0,O+1),O=-1),o[u].t="t",A=u);O>=0&&A<o.length&&(o[A].v=L.substr(0,O+1)+o[A].v)}else if(H!==o.length&&L.indexOf("E")===-1){for(O=L.indexOf(".")-1,u=H;u>=0;--u)if(!(o[u]==null||"n?".indexOf(o[u].t)===-1)){for(x=o[u].v.indexOf(".")>-1&&u===H?o[u].v.indexOf(".")-1:o[u].v.length-1,Q=o[u].v.substr(x+1);x>=0;--x)O>=0&&(o[u].v.charAt(x)==="0"||o[u].v.charAt(x)==="#")&&(Q=L.charAt(O--)+Q);o[u].v=Q,o[u].t="t",A=u}for(O>=0&&A<o.length&&(o[A].v=L.substr(0,O+1)+o[A].v),O=L.indexOf(".")+1,u=H;u<o.length;++u)if(!(o[u]==null||"n?(".indexOf(o[u].t)===-1&&u!==H)){for(x=o[u].v.indexOf(".")>-1&&u===H?o[u].v.indexOf(".")+1:0,Q=o[u].v.substr(0,x);x<o[u].v.length;++x)O<L.length&&(Q+=L.charAt(O++));o[u].v=Q,o[u].t="t",A=u}}}for(u=0;u<o.length;++u)o[u]!=null&&"n?".indexOf(o[u].t)>-1&&(U=s>1&&n<0&&u>0&&o[u-1].v==="-"?-n:n,o[u].v=ri(o[u].t,o[u].v,U),o[u].t="t");var R="";for(u=0;u!==o.length;++u)o[u]!=null&&(R+=o[u].v);return R}var Hy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Vy(t,n){if(n==null)return!1;var a=parseFloat(n[2]);switch(n[1]){case"=":if(t==a)return!0;break;case">":if(t>a)return!0;break;case"<":if(t<a)return!0;break;case"<>":if(t!=a)return!0;break;case">=":if(t>=a)return!0;break;case"<=":if(t<=a)return!0;break}return!1}function ck(t,n){var a=lk(t),s=a.length,o=a[s-1].indexOf("@");if(s<4&&o>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof n!="number")return[4,a.length===4||o>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=o>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=o>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=o>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var c=n>0?a[0]:n<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,c];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var u=a[0].match(Hy),h=a[1].match(Hy);return Vy(n,u)?[s,a[0]]:Vy(n,h)?[s,a[1]]:[s,a[u!=null&&h!=null?2:1]]}return[s,c]}function Zi(t,n,a){a==null&&(a={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&a.dateNF?s=a.dateNF:s=t;break;case"number":t==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:ka)[t],s==null&&(s=a.table&&a.table[Wy[t]]||ka[Wy[t]]),s==null&&(s=H2[t]||"General");break}if(bu(s,0))return Xm(n,a);n instanceof Date&&(n=P1(n,a.date1904));var o=ck(s,n);if(bu(o[1]))return Xm(n,a);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return ok(o[1],n,a,o[0])}function Y1(t,n){if(typeof n!="number"){n=+n||-1;for(var a=0;a<392;++a){if(ka[a]==null){n<0&&(n=a);continue}if(ka[a]==t){n=a;break}}n<0&&(n=391)}return ka[n]=t,n}function Pu(t){for(var n=0;n!=392;++n)t[n]!==void 0&&Y1(t[n],n)}function Wu(){ka=$2()}var J1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dk(t){var n=typeof t=="number"?ka[t]:t;return n=n.replace(J1,"(\\d+)"),new RegExp("^"+n+"$")}function uk(t,n,a){var s=-1,o=-1,c=-1,u=-1,h=-1,f=-1;(n.match(J1)||[]).forEach(function(j,y){var S=parseInt(a[y+1],10);switch(j.toLowerCase().charAt(0)){case"y":s=S;break;case"d":c=S;break;case"h":u=S;break;case"s":f=S;break;case"m":u>=0?h=S:o=S;break}}),f>=0&&h==-1&&o>=0&&(h=o,o=-1);var p=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var x=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return u==-1&&h==-1&&f==-1?p:s==-1&&o==-1&&c==-1?x:p+"T"+x}var fk=(function(){var t={};t.version="1.2.0";function n(){for(var L=0,H=new Array(256),A=0;A!=256;++A)L=A,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,H[A]=L;return typeof Int32Array<"u"?new Int32Array(H):H}var a=n();function s(L){var H=0,A=0,R=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)G[R]=L[R];for(R=0;R!=256;++R)for(A=L[R],H=256+R;H<4096;H+=256)A=G[H]=A>>>8^L[A&255];var F=[];for(R=1;R!=16;++R)F[R-1]=typeof Int32Array<"u"?G.subarray(R*256,R*256+256):G.slice(R*256,R*256+256);return F}var o=s(a),c=o[0],u=o[1],h=o[2],f=o[3],p=o[4],x=o[5],j=o[6],y=o[7],S=o[8],w=o[9],b=o[10],_=o[11],E=o[12],z=o[13],N=o[14];function O(L,H){for(var A=H^-1,R=0,G=L.length;R<G;)A=A>>>8^a[(A^L.charCodeAt(R++))&255];return~A}function Q(L,H){for(var A=H^-1,R=L.length-15,G=0;G<R;)A=N[L[G++]^A&255]^z[L[G++]^A>>8&255]^E[L[G++]^A>>16&255]^_[L[G++]^A>>>24]^b[L[G++]]^w[L[G++]]^S[L[G++]]^y[L[G++]]^j[L[G++]]^x[L[G++]]^p[L[G++]]^f[L[G++]]^h[L[G++]]^u[L[G++]]^c[L[G++]]^a[L[G++]];for(R+=15;G<R;)A=A>>>8^a[(A^L[G++])&255];return~A}function U(L,H){for(var A=H^-1,R=0,G=L.length,F=0,q=0;R<G;)F=L.charCodeAt(R++),F<128?A=A>>>8^a[(A^F)&255]:F<2048?(A=A>>>8^a[(A^(192|F>>6&31))&255],A=A>>>8^a[(A^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,q=L.charCodeAt(R++)&1023,A=A>>>8^a[(A^(240|F>>8&7))&255],A=A>>>8^a[(A^(128|F>>2&63))&255],A=A>>>8^a[(A^(128|q>>6&15|(F&3)<<4))&255],A=A>>>8^a[(A^(128|q&63))&255]):(A=A>>>8^a[(A^(224|F>>12&15))&255],A=A>>>8^a[(A^(128|F>>6&63))&255],A=A>>>8^a[(A^(128|F&63))&255]);return~A}return t.table=a,t.bstr=O,t.buf=Q,t.str=U,t})(),ia=(function(){var n={};n.version="1.2.1";function a(Y,se){for(var te=Y.split("/"),ae=se.split("/"),re=0,ce=0,Ce=Math.min(te.length,ae.length);re<Ce;++re){if(ce=te[re].length-ae[re].length)return ce;if(te[re]!=ae[re])return te[re]<ae[re]?-1:1}return te.length-ae.length}function s(Y){if(Y.charAt(Y.length-1)=="/")return Y.slice(0,-1).indexOf("/")===-1?Y:s(Y.slice(0,-1));var se=Y.lastIndexOf("/");return se===-1?Y:Y.slice(0,se+1)}function o(Y){if(Y.charAt(Y.length-1)=="/")return o(Y.slice(0,-1));var se=Y.lastIndexOf("/");return se===-1?Y:Y.slice(se+1)}function c(Y,se){typeof se=="string"&&(se=new Date(se));var te=se.getHours();te=te<<6|se.getMinutes(),te=te<<5|se.getSeconds()>>>1,Y.write_shift(2,te);var ae=se.getFullYear()-1980;ae=ae<<4|se.getMonth()+1,ae=ae<<5|se.getDate(),Y.write_shift(2,ae)}function u(Y){var se=Y.read_shift(2)&65535,te=Y.read_shift(2)&65535,ae=new Date,re=te&31;te>>>=5;var ce=te&15;te>>>=4,ae.setMilliseconds(0),ae.setFullYear(te+1980),ae.setMonth(ce-1),ae.setDate(re);var Ce=se&31;se>>>=5;var De=se&63;return se>>>=6,ae.setHours(se),ae.setMinutes(De),ae.setSeconds(Ce<<1),ae}function h(Y){Hn(Y,0);for(var se={},te=0;Y.l<=Y.length-4;){var ae=Y.read_shift(2),re=Y.read_shift(2),ce=Y.l+re,Ce={};ae===21589&&(te=Y.read_shift(1),te&1&&(Ce.mtime=Y.read_shift(4)),re>5&&(te&2&&(Ce.atime=Y.read_shift(4)),te&4&&(Ce.ctime=Y.read_shift(4))),Ce.mtime&&(Ce.mt=new Date(Ce.mtime*1e3))),Y.l=ce,se[ae]=Ce}return se}var f;function p(){return f||(f={})}function x(Y,se){if(Y[0]==80&&Y[1]==75)return ut(Y,se);if((Y[0]|32)==109&&(Y[1]|32)==105)return At(Y,se);if(Y.length<512)throw new Error("CFB file size "+Y.length+" < 512");var te=3,ae=512,re=0,ce=0,Ce=0,De=0,Ne=0,Fe=[],K=Y.slice(0,512);Hn(K,0);var ue=j(K);switch(te=ue[0],te){case 3:ae=512;break;case 4:ae=4096;break;case 0:if(ue[1]==0)return ut(Y,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ae!==512&&(K=Y.slice(0,ae),Hn(K,28));var ke=Y.slice(0,ae);y(K,te);var Te=K.read_shift(4,"i");if(te===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);K.l+=4,Ce=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),De=K.read_shift(4,"i"),re=K.read_shift(4,"i"),Ne=K.read_shift(4,"i"),ce=K.read_shift(4,"i");for(var Me=-1,Ye=0;Ye<109&&(Me=K.read_shift(4,"i"),!(Me<0));++Ye)Fe[Ye]=Me;var $e=S(Y,ae);_(Ne,ce,$e,ae,Fe);var yt=z($e,Ce,Fe,ae);yt[Ce].name="!Directory",re>0&&De!==q&&(yt[De].name="!MiniFAT"),yt[Fe[0]].name="!FAT",yt.fat_addrs=Fe,yt.ssz=ae;var jt={},Kt=[],cn=[],sa=[];N(Ce,yt,$e,Kt,re,jt,cn,De),w(cn,sa,Kt),Kt.shift();var Pa={FileIndex:cn,FullPaths:sa};return se&&se.raw&&(Pa.raw={header:ke,sectors:$e}),Pa}function j(Y){if(Y[Y.l]==80&&Y[Y.l+1]==75)return[0,0];Y.chk(ee,"Header Signature: "),Y.l+=16;var se=Y.read_shift(2,"u");return[Y.read_shift(2,"u"),se]}function y(Y,se){var te=9;switch(Y.l+=2,te=Y.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}Y.chk("0600","Mini Sector Shift: "),Y.chk("000000000000","Reserved: ")}function S(Y,se){for(var te=Math.ceil(Y.length/se)-1,ae=[],re=1;re<te;++re)ae[re-1]=Y.slice(re*se,(re+1)*se);return ae[te-1]=Y.slice(te*se),ae}function w(Y,se,te){for(var ae=0,re=0,ce=0,Ce=0,De=0,Ne=te.length,Fe=[],K=[];ae<Ne;++ae)Fe[ae]=K[ae]=ae,se[ae]=te[ae];for(;De<K.length;++De)ae=K[De],re=Y[ae].L,ce=Y[ae].R,Ce=Y[ae].C,Fe[ae]===ae&&(re!==-1&&Fe[re]!==re&&(Fe[ae]=Fe[re]),ce!==-1&&Fe[ce]!==ce&&(Fe[ae]=Fe[ce])),Ce!==-1&&(Fe[Ce]=ae),re!==-1&&ae!=Fe[ae]&&(Fe[re]=Fe[ae],K.lastIndexOf(re)<De&&K.push(re)),ce!==-1&&ae!=Fe[ae]&&(Fe[ce]=Fe[ae],K.lastIndexOf(ce)<De&&K.push(ce));for(ae=1;ae<Ne;++ae)Fe[ae]===ae&&(ce!==-1&&Fe[ce]!==ce?Fe[ae]=Fe[ce]:re!==-1&&Fe[re]!==re&&(Fe[ae]=Fe[re]));for(ae=1;ae<Ne;++ae)if(Y[ae].type!==0){if(De=ae,De!=Fe[De])do De=Fe[De],se[ae]=se[De]+"/"+se[ae];while(De!==0&&Fe[De]!==-1&&De!=Fe[De]);Fe[ae]=-1}for(se[0]+="/",ae=1;ae<Ne;++ae)Y[ae].type!==2&&(se[ae]+="/")}function b(Y,se,te){for(var ae=Y.start,re=Y.size,ce=[],Ce=ae;te&&re>0&&Ce>=0;)ce.push(se.slice(Ce*F,Ce*F+F)),re-=F,Ce=vs(te,Ce*4);return ce.length===0?Pe(0):nn(ce).slice(0,Y.size)}function _(Y,se,te,ae,re){var ce=q;if(Y===q){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(Y!==-1){var Ce=te[Y],De=(ae>>>2)-1;if(!Ce)return;for(var Ne=0;Ne<De&&(ce=vs(Ce,Ne*4))!==q;++Ne)re.push(ce);_(vs(Ce,ae-4),se-1,te,ae,re)}}function E(Y,se,te,ae,re){var ce=[],Ce=[];re||(re=[]);var De=ae-1,Ne=0,Fe=0;for(Ne=se;Ne>=0;){re[Ne]=!0,ce[ce.length]=Ne,Ce.push(Y[Ne]);var K=te[Math.floor(Ne*4/ae)];if(Fe=Ne*4&De,ae<4+Fe)throw new Error("FAT boundary crossed: "+Ne+" 4 "+ae);if(!Y[K])break;Ne=vs(Y[K],Fe)}return{nodes:ce,data:Qy([Ce])}}function z(Y,se,te,ae){var re=Y.length,ce=[],Ce=[],De=[],Ne=[],Fe=ae-1,K=0,ue=0,ke=0,Te=0;for(K=0;K<re;++K)if(De=[],ke=K+se,ke>=re&&(ke-=re),!Ce[ke]){Ne=[];var Me=[];for(ue=ke;ue>=0;){Me[ue]=!0,Ce[ue]=!0,De[De.length]=ue,Ne.push(Y[ue]);var Ye=te[Math.floor(ue*4/ae)];if(Te=ue*4&Fe,ae<4+Te)throw new Error("FAT boundary crossed: "+ue+" 4 "+ae);if(!Y[Ye]||(ue=vs(Y[Ye],Te),Me[ue]))break}ce[ke]={nodes:De,data:Qy([Ne])}}return ce}function N(Y,se,te,ae,re,ce,Ce,De){for(var Ne=0,Fe=ae.length?2:0,K=se[Y].data,ue=0,ke=0,Te;ue<K.length;ue+=128){var Me=K.slice(ue,ue+128);Hn(Me,64),ke=Me.read_shift(2),Te=bp(Me,0,ke-Fe),ae.push(Te);var Ye={name:Te,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},$e=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);$e!==0&&(Ye.ct=O(Me,Me.l-8));var yt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);yt!==0&&(Ye.mt=O(Me,Me.l-8)),Ye.start=Me.read_shift(4,"i"),Ye.size=Me.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=q,Ye.name=""),Ye.type===5?(Ne=Ye.start,re>0&&Ne!==q&&(se[Ne].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",se[Ye.start]===void 0&&(se[Ye.start]=E(te,Ye.start,se.fat_addrs,se.ssz)),se[Ye.start].name=Ye.name,Ye.content=se[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:Ne!==q&&Ye.start!==q&&se[Ne]&&(Ye.content=b(Ye,se[Ne].data,(se[De]||{}).data))),Ye.content&&Hn(Ye.content,0),ce[Te]=Ye,Ce.push(Ye)}}function O(Y,se){return new Date((Zn(Y,se+4)/1e7*Math.pow(2,32)+Zn(Y,se)/1e7-11644473600)*1e3)}function Q(Y,se){return p(),x(f.readFileSync(Y),se)}function U(Y,se){var te=se&&se.type;switch(te||Vt&&Buffer.isBuffer(Y)&&(te="buffer"),te||"base64"){case"file":return Q(Y,se);case"base64":return x(wr(oi(Y)),se);case"binary":return x(wr(Y),se)}return x(Y,se)}function L(Y,se){var te=se||{},ae=te.root||"Root Entry";if(Y.FullPaths||(Y.FullPaths=[]),Y.FileIndex||(Y.FileIndex=[]),Y.FullPaths.length!==Y.FileIndex.length)throw new Error("inconsistent CFB structure");Y.FullPaths.length===0&&(Y.FullPaths[0]=ae+"/",Y.FileIndex[0]={name:ae,type:5}),te.CLSID&&(Y.FileIndex[0].clsid=te.CLSID),H(Y)}function H(Y){var se="Sh33tJ5";if(!ia.find(Y,"/"+se)){var te=Pe(4);te[0]=55,te[1]=te[3]=50,te[2]=54,Y.FileIndex.push({name:se,type:2,content:te,size:4,L:69,R:69,C:69}),Y.FullPaths.push(Y.FullPaths[0]+se),A(Y)}}function A(Y,se){L(Y);for(var te=!1,ae=!1,re=Y.FullPaths.length-1;re>=0;--re){var ce=Y.FileIndex[re];switch(ce.type){case 0:ae?te=!0:(Y.FileIndex.pop(),Y.FullPaths.pop());break;case 1:case 2:case 5:ae=!0,isNaN(ce.R*ce.L*ce.C)&&(te=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!se)){var Ce=new Date(1987,1,19),De=0,Ne=Object.create?Object.create(null):{},Fe=[];for(re=0;re<Y.FullPaths.length;++re)Ne[Y.FullPaths[re]]=!0,Y.FileIndex[re].type!==0&&Fe.push([Y.FullPaths[re],Y.FileIndex[re]]);for(re=0;re<Fe.length;++re){var K=s(Fe[re][0]);ae=Ne[K],ae||(Fe.push([K,{name:o(K).replace("/",""),type:1,clsid:W,ct:Ce,mt:Ce,content:null}]),Ne[K]=!0)}for(Fe.sort(function(Te,Me){return a(Te[0],Me[0])}),Y.FullPaths=[],Y.FileIndex=[],re=0;re<Fe.length;++re)Y.FullPaths[re]=Fe[re][0],Y.FileIndex[re]=Fe[re][1];for(re=0;re<Fe.length;++re){var ue=Y.FileIndex[re],ke=Y.FullPaths[re];if(ue.name=o(ke).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||W,re===0)ue.C=Fe.length>1?1:-1,ue.size=0,ue.type=5;else if(ke.slice(-1)=="/"){for(De=re+1;De<Fe.length&&s(Y.FullPaths[De])!=ke;++De);for(ue.C=De>=Fe.length?-1:De,De=re+1;De<Fe.length&&s(Y.FullPaths[De])!=s(ke);++De);ue.R=De>=Fe.length?-1:De,ue.type=1}else s(Y.FullPaths[re+1]||"")==s(ke)&&(ue.R=re+1),ue.type=2}}}function R(Y,se){var te=se||{};if(te.fileType=="mad")return za(Y,te);if(A(Y),te.fileType==="zip")return Pt(Y,te);var ae=(function(Te){for(var Me=0,Ye=0,$e=0;$e<Te.FileIndex.length;++$e){var yt=Te.FileIndex[$e];if(yt.content){var jt=yt.content.length;jt>0&&(jt<4096?Me+=jt+63>>6:Ye+=jt+511>>9)}}for(var Kt=Te.FullPaths.length+3>>2,cn=Me+7>>3,sa=Me+127>>7,Pa=cn+Ye+Kt+sa,qn=Pa+127>>7,ui=qn<=109?0:Math.ceil((qn-109)/127);Pa+qn+ui+127>>7>qn;)ui=++qn<=109?0:Math.ceil((qn-109)/127);var Zt=[1,ui,qn,sa,Kt,Ye,Me,0];return Te.FileIndex[0].size=Me<<6,Zt[7]=(Te.FileIndex[0].start=Zt[0]+Zt[1]+Zt[2]+Zt[3]+Zt[4]+Zt[5])+(Zt[6]+7>>3),Zt})(Y),re=Pe(ae[7]<<9),ce=0,Ce=0;{for(ce=0;ce<8;++ce)re.write_shift(1,me[ce]);for(ce=0;ce<8;++ce)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ce=0;ce<3;++ce)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ae[2]),re.write_shift(4,ae[0]+ae[1]+ae[2]+ae[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ae[3]?ae[0]+ae[1]+ae[2]-1:q),re.write_shift(4,ae[3]),re.write_shift(-4,ae[1]?ae[0]-1:q),re.write_shift(4,ae[1]),ce=0;ce<109;++ce)re.write_shift(-4,ce<ae[2]?ae[1]+ce:-1)}if(ae[1])for(Ce=0;Ce<ae[1];++Ce){for(;ce<236+Ce*127;++ce)re.write_shift(-4,ce<ae[2]?ae[1]+ce:-1);re.write_shift(-4,Ce===ae[1]-1?q:Ce+1)}var De=function(Te){for(Ce+=Te;ce<Ce-1;++ce)re.write_shift(-4,ce+1);Te&&(++ce,re.write_shift(-4,q))};for(Ce=ce=0,Ce+=ae[1];ce<Ce;++ce)re.write_shift(-4,J.DIFSECT);for(Ce+=ae[2];ce<Ce;++ce)re.write_shift(-4,J.FATSECT);De(ae[3]),De(ae[4]);for(var Ne=0,Fe=0,K=Y.FileIndex[0];Ne<Y.FileIndex.length;++Ne)K=Y.FileIndex[Ne],K.content&&(Fe=K.content.length,!(Fe<4096)&&(K.start=Ce,De(Fe+511>>9)));for(De(ae[6]+7>>3);re.l&511;)re.write_shift(-4,J.ENDOFCHAIN);for(Ce=ce=0,Ne=0;Ne<Y.FileIndex.length;++Ne)K=Y.FileIndex[Ne],K.content&&(Fe=K.content.length,!(!Fe||Fe>=4096)&&(K.start=Ce,De(Fe+63>>6)));for(;re.l&511;)re.write_shift(-4,J.ENDOFCHAIN);for(ce=0;ce<ae[4]<<2;++ce){var ue=Y.FullPaths[ce];if(!ue||ue.length===0){for(Ne=0;Ne<17;++Ne)re.write_shift(4,0);for(Ne=0;Ne<3;++Ne)re.write_shift(4,-1);for(Ne=0;Ne<12;++Ne)re.write_shift(4,0);continue}K=Y.FileIndex[ce],ce===0&&(K.start=K.size?K.start-1:q);var ke=ce===0&&te.root||K.name;if(Fe=2*(ke.length+1),re.write_shift(64,ke,"utf16le"),re.write_shift(2,Fe),re.write_shift(1,K.type),re.write_shift(1,K.color),re.write_shift(-4,K.L),re.write_shift(-4,K.R),re.write_shift(-4,K.C),K.clsid)re.write_shift(16,K.clsid,"hex");else for(Ne=0;Ne<4;++Ne)re.write_shift(4,0);re.write_shift(4,K.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,K.start),re.write_shift(4,K.size),re.write_shift(4,0)}for(ce=1;ce<Y.FileIndex.length;++ce)if(K=Y.FileIndex[ce],K.size>=4096)if(re.l=K.start+1<<9,Vt&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+511&-512;else{for(Ne=0;Ne<K.size;++Ne)re.write_shift(1,K.content[Ne]);for(;Ne&511;++Ne)re.write_shift(1,0)}for(ce=1;ce<Y.FileIndex.length;++ce)if(K=Y.FileIndex[ce],K.size>0&&K.size<4096)if(Vt&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+63&-64;else{for(Ne=0;Ne<K.size;++Ne)re.write_shift(1,K.content[Ne]);for(;Ne&63;++Ne)re.write_shift(1,0)}if(Vt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function G(Y,se){var te=Y.FullPaths.map(function(Ne){return Ne.toUpperCase()}),ae=te.map(function(Ne){var Fe=Ne.split("/");return Fe[Fe.length-(Ne.slice(-1)=="/"?2:1)]}),re=!1;se.charCodeAt(0)===47?(re=!0,se=te[0].slice(0,-1)+se):re=se.indexOf("/")!==-1;var ce=se.toUpperCase(),Ce=re===!0?te.indexOf(ce):ae.indexOf(ce);if(Ce!==-1)return Y.FileIndex[Ce];var De=!ce.match(Ld);for(ce=ce.replace(Vo,""),De&&(ce=ce.replace(Ld,"!")),Ce=0;Ce<te.length;++Ce)if((De?te[Ce].replace(Ld,"!"):te[Ce]).replace(Vo,"")==ce||(De?ae[Ce].replace(Ld,"!"):ae[Ce]).replace(Vo,"")==ce)return Y.FileIndex[Ce];return null}var F=64,q=-2,ee="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(Y,se,te){p();var ae=R(Y,te);f.writeFileSync(se,ae)}function V(Y){for(var se=new Array(Y.length),te=0;te<Y.length;++te)se[te]=String.fromCharCode(Y[te]);return se.join("")}function ne(Y,se){var te=R(Y,se);switch(se&&se.type||"buffer"){case"file":return p(),f.writeFileSync(se.filename,te),te;case"binary":return typeof te=="string"?te:V(te);case"base64":return ac(typeof te=="string"?te:V(te));case"buffer":if(Vt)return Buffer.isBuffer(te)?te:di(te);case"array":return typeof te=="string"?wr(te):te}return te}var P;function T(Y){try{var se=Y.InflateRaw,te=new se;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)P=Y;else throw new Error("zlib does not expose bytesRead")}catch(ae){console.error("cannot use native zlib: "+(ae.message||ae))}}function C(Y,se){if(!P)return at(Y,se);var te=P.InflateRaw,ae=new te,re=ae._processChunk(Y.slice(Y.l),ae._finishFlushFlag);return Y.l+=ae.bytesRead,re}function k(Y){return P?P.deflateRawSync(Y):va(Y)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(Y){var se=(Y<<1|Y<<11)&139536|(Y<<5|Y<<15)&558144;return(se>>16|se>>8|se)&255}for(var ie=typeof Uint8Array<"u",ve=ie?new Uint8Array(256):[],je=0;je<256;++je)ve[je]=he(je);function fe(Y,se){var te=ve[Y&255];return se<=8?te>>>8-se:(te=te<<8|ve[Y>>8&255],se<=16?te>>>16-se:(te=te<<8|ve[Y>>16&255],te>>>24-se))}function _e(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=6?0:Y[ae+1]<<8))>>>te&3}function Se(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=5?0:Y[ae+1]<<8))>>>te&7}function Ve(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=4?0:Y[ae+1]<<8))>>>te&15}function be(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=3?0:Y[ae+1]<<8))>>>te&31}function oe(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=1?0:Y[ae+1]<<8))>>>te&127}function Ue(Y,se,te){var ae=se&7,re=se>>>3,ce=(1<<te)-1,Ce=Y[re]>>>ae;return te<8-ae||(Ce|=Y[re+1]<<8-ae,te<16-ae)||(Ce|=Y[re+2]<<16-ae,te<24-ae)||(Ce|=Y[re+3]<<24-ae),Ce&ce}function Qe(Y,se,te){var ae=se&7,re=se>>>3;return ae<=5?Y[re]|=(te&7)<<ae:(Y[re]|=te<<ae&255,Y[re+1]=(te&7)>>8-ae),se+3}function lt(Y,se,te){var ae=se&7,re=se>>>3;return te=(te&1)<<ae,Y[re]|=te,se+1}function tt(Y,se,te){var ae=se&7,re=se>>>3;return te<<=ae,Y[re]|=te&255,te>>>=8,Y[re+1]=te,se+8}function ht(Y,se,te){var ae=se&7,re=se>>>3;return te<<=ae,Y[re]|=te&255,te>>>=8,Y[re+1]=te&255,Y[re+2]=te>>>8,se+16}function xt(Y,se){var te=Y.length,ae=2*te>se?2*te:se+5,re=0;if(te>=se)return Y;if(Vt){var ce=My(ae);if(Y.copy)Y.copy(ce);else for(;re<Y.length;++re)ce[re]=Y[re];return ce}else if(ie){var Ce=new Uint8Array(ae);if(Ce.set)Ce.set(Y);else for(;re<te;++re)Ce[re]=Y[re];return Ce}return Y.length=ae,Y}function qe(Y){for(var se=new Array(Y),te=0;te<Y;++te)se[te]=0;return se}function Nt(Y,se,te){var ae=1,re=0,ce=0,Ce=0,De=0,Ne=Y.length,Fe=ie?new Uint16Array(32):qe(32);for(ce=0;ce<32;++ce)Fe[ce]=0;for(ce=Ne;ce<te;++ce)Y[ce]=0;Ne=Y.length;var K=ie?new Uint16Array(Ne):qe(Ne);for(ce=0;ce<Ne;++ce)Fe[re=Y[ce]]++,ae<re&&(ae=re),K[ce]=0;for(Fe[0]=0,ce=1;ce<=ae;++ce)Fe[ce+16]=De=De+Fe[ce-1]<<1;for(ce=0;ce<Ne;++ce)De=Y[ce],De!=0&&(K[ce]=Fe[De+16]++);var ue=0;for(ce=0;ce<Ne;++ce)if(ue=Y[ce],ue!=0)for(De=fe(K[ce],ae)>>ae-ue,Ce=(1<<ae+4-ue)-1;Ce>=0;--Ce)se[De|Ce<<ue]=ue&15|ce<<4;return ae}var st=ie?new Uint16Array(512):qe(512),_t=ie?new Uint16Array(32):qe(32);if(!ie){for(var zt=0;zt<512;++zt)st[zt]=0;for(zt=0;zt<32;++zt)_t[zt]=0}(function(){for(var Y=[],se=0;se<32;se++)Y.push(5);Nt(Y,_t,32);var te=[];for(se=0;se<=143;se++)te.push(8);for(;se<=255;se++)te.push(9);for(;se<=279;se++)te.push(7);for(;se<=287;se++)te.push(8);Nt(te,st,288)})();var It=(function(){for(var se=ie?new Uint8Array(32768):[],te=0,ae=0;te<de.length-1;++te)for(;ae<de[te+1];++ae)se[ae]=te;for(;ae<32768;++ae)se[ae]=29;var re=ie?new Uint8Array(259):[];for(te=0,ae=0;te<D.length-1;++te)for(;ae<D[te+1];++ae)re[ae]=te;function ce(De,Ne){for(var Fe=0;Fe<De.length;){var K=Math.min(65535,De.length-Fe),ue=Fe+K==De.length;for(Ne.write_shift(1,+ue),Ne.write_shift(2,K),Ne.write_shift(2,~K&65535);K-- >0;)Ne[Ne.l++]=De[Fe++]}return Ne.l}function Ce(De,Ne){for(var Fe=0,K=0,ue=ie?new Uint16Array(32768):[];K<De.length;){var ke=Math.min(65535,De.length-K);if(ke<10){for(Fe=Qe(Ne,Fe,+(K+ke==De.length)),Fe&7&&(Fe+=8-(Fe&7)),Ne.l=Fe/8|0,Ne.write_shift(2,ke),Ne.write_shift(2,~ke&65535);ke-- >0;)Ne[Ne.l++]=De[K++];Fe=Ne.l*8;continue}Fe=Qe(Ne,Fe,+(K+ke==De.length)+2);for(var Te=0;ke-- >0;){var Me=De[K];Te=(Te<<5^Me)&32767;var Ye=-1,$e=0;if((Ye=ue[Te])&&(Ye|=K&-32768,Ye>K&&(Ye-=32768),Ye<K))for(;De[Ye+$e]==De[K+$e]&&$e<250;)++$e;if($e>2){Me=re[$e],Me<=22?Fe=tt(Ne,Fe,ve[Me+1]>>1)-1:(tt(Ne,Fe,3),Fe+=5,tt(Ne,Fe,ve[Me-23]>>5),Fe+=3);var yt=Me<8?0:Me-4>>2;yt>0&&(ht(Ne,Fe,$e-D[Me]),Fe+=yt),Me=se[K-Ye],Fe=tt(Ne,Fe,ve[Me]>>3),Fe-=3;var jt=Me<4?0:Me-2>>1;jt>0&&(ht(Ne,Fe,K-Ye-de[Me]),Fe+=jt);for(var Kt=0;Kt<$e;++Kt)ue[Te]=K&32767,Te=(Te<<5^De[K])&32767,++K;ke-=$e-1}else Me<=143?Me=Me+48:Fe=lt(Ne,Fe,1),Fe=tt(Ne,Fe,ve[Me]),ue[Te]=K&32767,++K}Fe=tt(Ne,Fe,0)-1}return Ne.l=(Fe+7)/8|0,Ne.l}return function(Ne,Fe){return Ne.length<8?ce(Ne,Fe):Ce(Ne,Fe)}})();function va(Y){var se=Pe(50+Math.floor(Y.length*1.1)),te=It(Y,se);return se.slice(0,te)}var rt=ie?new Uint16Array(32768):qe(32768),oa=ie?new Uint16Array(32768):qe(32768),ca=ie?new Uint16Array(128):qe(128),ze=1,et=1;function it(Y,se){var te=be(Y,se)+257;se+=5;var ae=be(Y,se)+1;se+=5;var re=Ve(Y,se)+4;se+=4;for(var ce=0,Ce=ie?new Uint8Array(19):qe(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ne=1,Fe=ie?new Uint8Array(8):qe(8),K=ie?new Uint8Array(8):qe(8),ue=Ce.length,ke=0;ke<re;++ke)Ce[I[ke]]=ce=Se(Y,se),Ne<ce&&(Ne=ce),Fe[ce]++,se+=3;var Te=0;for(Fe[0]=0,ke=1;ke<=Ne;++ke)K[ke]=Te=Te+Fe[ke-1]<<1;for(ke=0;ke<ue;++ke)(Te=Ce[ke])!=0&&(De[ke]=K[Te]++);var Me=0;for(ke=0;ke<ue;++ke)if(Me=Ce[ke],Me!=0){Te=ve[De[ke]]>>8-Me;for(var Ye=(1<<7-Me)-1;Ye>=0;--Ye)ca[Te|Ye<<Me]=Me&7|ke<<3}var $e=[];for(Ne=1;$e.length<te+ae;)switch(Te=ca[oe(Y,se)],se+=Te&7,Te>>>=3){case 16:for(ce=3+_e(Y,se),se+=2,Te=$e[$e.length-1];ce-- >0;)$e.push(Te);break;case 17:for(ce=3+Se(Y,se),se+=3;ce-- >0;)$e.push(0);break;case 18:for(ce=11+oe(Y,se),se+=7;ce-- >0;)$e.push(0);break;default:$e.push(Te),Ne<Te&&(Ne=Te);break}var yt=$e.slice(0,te),jt=$e.slice(te);for(ke=te;ke<286;++ke)yt[ke]=0;for(ke=ae;ke<30;++ke)jt[ke]=0;return ze=Nt(yt,rt,286),et=Nt(jt,oa,30),se}function Be(Y,se){if(Y[0]==3&&!(Y[1]&3))return[bs(se),2];for(var te=0,ae=0,re=My(se||1<<18),ce=0,Ce=re.length>>>0,De=0,Ne=0;(ae&1)==0;){if(ae=Se(Y,te),te+=3,ae>>>1)ae>>1==1?(De=9,Ne=5):(te=it(Y,te),De=ze,Ne=et);else{te&7&&(te+=8-(te&7));var Fe=Y[te>>>3]|Y[(te>>>3)+1]<<8;if(te+=32,Fe>0)for(!se&&Ce<ce+Fe&&(re=xt(re,ce+Fe),Ce=re.length);Fe-- >0;)re[ce++]=Y[te>>>3],te+=8;continue}for(;;){!se&&Ce<ce+32767&&(re=xt(re,ce+32767),Ce=re.length);var K=Ue(Y,te,De),ue=ae>>>1==1?st[K]:rt[K];if(te+=ue&15,ue>>>=4,(ue>>>8&255)===0)re[ce++]=ue;else{if(ue==256)break;ue-=257;var ke=ue<8?0:ue-4>>2;ke>5&&(ke=0);var Te=ce+D[ue];ke>0&&(Te+=Ue(Y,te,ke),te+=ke),K=Ue(Y,te,Ne),ue=ae>>>1==1?_t[K]:oa[K],te+=ue&15,ue>>>=4;var Me=ue<4?0:ue-2>>1,Ye=de[ue];for(Me>0&&(Ye+=Ue(Y,te,Me),te+=Me),!se&&Ce<Te&&(re=xt(re,Te+100),Ce=re.length);ce<Te;)re[ce]=re[ce-Ye],++ce}}}return se?[re,te+7>>>3]:[re.slice(0,ce),te+7>>>3]}function at(Y,se){var te=Y.slice(Y.l||0),ae=Be(te,se);return Y.l+=ae[1],ae[0]}function nt(Y,se){if(Y)typeof console<"u"&&console.error(se);else throw new Error(se)}function ut(Y,se){var te=Y;Hn(te,0);var ae=[],re=[],ce={FileIndex:ae,FullPaths:re};L(ce,{root:se.root});for(var Ce=te.length-4;(te[Ce]!=80||te[Ce+1]!=75||te[Ce+2]!=5||te[Ce+3]!=6)&&Ce>=0;)--Ce;te.l=Ce+4,te.l+=4;var De=te.read_shift(2);te.l+=6;var Ne=te.read_shift(4);for(te.l=Ne,Ce=0;Ce<De;++Ce){te.l+=20;var Fe=te.read_shift(4),K=te.read_shift(4),ue=te.read_shift(2),ke=te.read_shift(2),Te=te.read_shift(2);te.l+=8;var Me=te.read_shift(4),Ye=h(te.slice(te.l+ue,te.l+ue+ke));te.l+=ue+ke+Te;var $e=te.l;te.l=Me+4,ta(te,Fe,K,ce,Ye),te.l=$e}return ce}function ta(Y,se,te,ae,re){Y.l+=2;var ce=Y.read_shift(2),Ce=Y.read_shift(2),De=u(Y);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ne=Y.read_shift(4),Fe=Y.read_shift(4),K=Y.read_shift(4),ue=Y.read_shift(2),ke=Y.read_shift(2),Te="",Me=0;Me<ue;++Me)Te+=String.fromCharCode(Y[Y.l++]);if(ke){var Ye=h(Y.slice(Y.l,Y.l+ke));(Ye[21589]||{}).mt&&(De=Ye[21589].mt),((re||{})[21589]||{}).mt&&(De=re[21589].mt)}Y.l+=ke;var $e=Y.slice(Y.l,Y.l+Fe);switch(Ce){case 8:$e=C(Y,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ce)}var yt=!1;ce&8&&(Ne=Y.read_shift(4),Ne==134695760&&(Ne=Y.read_shift(4),yt=!0),Fe=Y.read_shift(4),K=Y.read_shift(4)),Fe!=se&&nt(yt,"Bad compressed size: "+se+" != "+Fe),K!=te&&nt(yt,"Bad uncompressed size: "+te+" != "+K),Et(ae,Te,$e,{unsafe:!0,mt:De})}function Pt(Y,se){var te=se||{},ae=[],re=[],ce=Pe(1),Ce=te.compression?8:0,De=0,Ne=0,Fe=0,K=0,ue=0,ke=Y.FullPaths[0],Te=ke,Me=Y.FileIndex[0],Ye=[],$e=0;for(Ne=1;Ne<Y.FullPaths.length;++Ne)if(Te=Y.FullPaths[Ne].slice(ke.length),Me=Y.FileIndex[Ne],!(!Me.size||!Me.content||Te=="Sh33tJ5")){var yt=K,jt=Pe(Te.length);for(Fe=0;Fe<Te.length;++Fe)jt.write_shift(1,Te.charCodeAt(Fe)&127);jt=jt.slice(0,jt.l),Ye[ue]=fk.buf(Me.content,0);var Kt=Me.content;Ce==8&&(Kt=k(Kt)),ce=Pe(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,De),ce.write_shift(2,Ce),Me.mt?c(ce,Me.mt):ce.write_shift(4,0),ce.write_shift(-4,Ye[ue]),ce.write_shift(4,Kt.length),ce.write_shift(4,Me.content.length),ce.write_shift(2,jt.length),ce.write_shift(2,0),K+=ce.length,ae.push(ce),K+=jt.length,ae.push(jt),K+=Kt.length,ae.push(Kt),ce=Pe(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,De),ce.write_shift(2,Ce),ce.write_shift(4,0),ce.write_shift(-4,Ye[ue]),ce.write_shift(4,Kt.length),ce.write_shift(4,Me.content.length),ce.write_shift(2,jt.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,yt),$e+=ce.l,re.push(ce),$e+=jt.length,re.push(jt),++ue}return ce=Pe(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,ue),ce.write_shift(2,ue),ce.write_shift(4,$e),ce.write_shift(4,K),ce.write_shift(2,0),nn([nn(ae),nn(re),ce])}var Tt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xe(Y,se){if(Y.ctype)return Y.ctype;var te=Y.name||"",ae=te.match(/\.([^\.]+)$/);return ae&&Tt[ae[1]]||se&&(ae=(te=se).match(/[\.\\]([^\.\\])+$/),ae&&Tt[ae[1]])?Tt[ae[1]]:"application/octet-stream"}function Ie(Y){for(var se=ac(Y),te=[],ae=0;ae<se.length;ae+=76)te.push(se.slice(ae,ae+76));return te.join(`\r
`)+`\r
`}function mt(Y){var se=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Fe){var K=Fe.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ae=se.split(`\r
`),re=0;re<ae.length;++re){var ce=ae[re];if(ce.length==0){te.push("");continue}for(var Ce=0;Ce<ce.length;){var De=76,Ne=ce.slice(Ce,Ce+De);Ne.charAt(De-1)=="="?De--:Ne.charAt(De-2)=="="?De-=2:Ne.charAt(De-3)=="="&&(De-=3),Ne=ce.slice(Ce,Ce+De),Ce+=De,Ce<ce.length&&(Ne+="="),te.push(Ne)}}return te.join(`\r
`)}function Oe(Y){for(var se=[],te=0;te<Y.length;++te){for(var ae=Y[te];te<=Y.length&&ae.charAt(ae.length-1)=="=";)ae=ae.slice(0,ae.length-1)+Y[++te];se.push(ae)}for(var re=0;re<se.length;++re)se[re]=se[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return wr(se.join(`\r
`))}function ct(Y,se,te){for(var ae="",re="",ce="",Ce,De=0;De<10;++De){var Ne=se[De];if(!Ne||Ne.match(/^\s*$/))break;var Fe=Ne.match(/^(.*?):\s*([^\s].*)$/);if(Fe)switch(Fe[1].toLowerCase()){case"content-location":ae=Fe[2].trim();break;case"content-type":ce=Fe[2].trim();break;case"content-transfer-encoding":re=Fe[2].trim();break}}switch(++De,re.toLowerCase()){case"base64":Ce=wr(oi(se.slice(De).join("")));break;case"quoted-printable":Ce=Oe(se.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var K=Et(Y,ae.slice(te.length),Ce,{unsafe:!0});ce&&(K.ctype=ce)}function At(Y,se){if(V(Y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=se&&se.root||"",ae=(Vt&&Buffer.isBuffer(Y)?Y.toString("binary"):V(Y)).split(`\r
`),re=0,ce="";for(re=0;re<ae.length;++re)if(ce=ae[re],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),te||(te=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),ce.slice(0,te.length)!=te););var Ce=(ae[1]||"").match(/boundary="(.*?)"/);if(!Ce)throw new Error("MAD cannot find boundary");var De="--"+(Ce[1]||""),Ne=[],Fe=[],K={FileIndex:Ne,FullPaths:Fe};L(K);var ue,ke=0;for(re=0;re<ae.length;++re){var Te=ae[re];Te!==De&&Te!==De+"--"||(ke++&&ct(K,ae.slice(ue,re),te),ue=re)}return K}function za(Y,se){var te=se||{},ae=te.boundary||"SheetJS";ae="------="+ae;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ae.slice(2)+'"',"","",""],ce=Y.FullPaths[0],Ce=ce,De=Y.FileIndex[0],Ne=1;Ne<Y.FullPaths.length;++Ne)if(Ce=Y.FullPaths[Ne].slice(ce.length),De=Y.FileIndex[Ne],!(!De.size||!De.content||Ce=="Sh33tJ5")){Ce=Ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var Fe=De.content,K=Vt&&Buffer.isBuffer(Fe)?Fe.toString("binary"):V(Fe),ue=0,ke=Math.min(1024,K.length),Te=0,Me=0;Me<=ke;++Me)(Te=K.charCodeAt(Me))>=32&&Te<128&&++ue;var Ye=ue>=ke*4/5;re.push(ae),re.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+Ce),re.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),re.push("Content-Type: "+xe(De,Ce)),re.push(""),re.push(Ye?mt(K):Ie(K))}return re.push(ae+`--\r
`),re.join(`\r
`)}function ja(Y){var se={};return L(se,Y),se}function Et(Y,se,te,ae){var re=ae&&ae.unsafe;re||L(Y);var ce=!re&&ia.find(Y,se);if(!ce){var Ce=Y.FullPaths[0];se.slice(0,Ce.length)==Ce?Ce=se:(Ce.slice(-1)!="/"&&(Ce+="/"),Ce=(Ce+se).replace("//","/")),ce={name:o(se),type:2},Y.FileIndex.push(ce),Y.FullPaths.push(Ce),re||ia.utils.cfb_gc(Y)}return ce.content=te,ce.size=te?te.length:0,ae&&(ae.CLSID&&(ce.clsid=ae.CLSID),ae.mt&&(ce.mt=ae.mt),ae.ct&&(ce.ct=ae.ct)),ce}function ge(Y,se){L(Y);var te=ia.find(Y,se);if(te){for(var ae=0;ae<Y.FileIndex.length;++ae)if(Y.FileIndex[ae]==te)return Y.FileIndex.splice(ae,1),Y.FullPaths.splice(ae,1),!0}return!1}function Ft(Y,se,te){L(Y);var ae=ia.find(Y,se);if(ae){for(var re=0;re<Y.FileIndex.length;++re)if(Y.FileIndex[re]==ae)return Y.FileIndex[re].name=o(te),Y.FullPaths[re]=te,!0}return!1}function ga(Y){A(Y,!0)}return n.find=G,n.read=U,n.parse=x,n.write=ne,n.writeFile=M,n.utils={cfb_new:ja,cfb_add:Et,cfb_del:ge,cfb_mov:Ft,cfb_gc:ga,ReadShift:Go,CheckField:pj,prep_blob:Hn,bconcat:nn,use_zlib:T,_deflateRaw:va,_inflateRaw:at,consts:J},n})();function hk(t){return typeof t=="string"?Iu(t):Array.isArray(t)?I2(t):t}function pc(t,n,a){if(typeof Deno<"u"){if(a&&typeof n=="string")switch(a){case"utf8":n=new TextEncoder(a).encode(n);break;case"binary":n=Iu(n);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(t,n)}var s=a=="utf8"?rc(n):n;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var o=new Blob([hk(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,t);if(typeof saveAs<"u")return saveAs(o,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:t,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=t,u.href=c,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(t);return h.open("w"),h.encoding="binary",Array.isArray(n)&&(n=mc(n)),h.write(n),h.close(),n}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function ln(t){for(var n=Object.keys(t),a=[],s=0;s<n.length;++s)Object.prototype.hasOwnProperty.call(t,n[s])&&a.push(n[s]);return a}function Zy(t,n){for(var a=[],s=ln(t),o=0;o!==s.length;++o)a[t[s[o]][n]]==null&&(a[t[s[o]][n]]=s[o]);return a}function xp(t){for(var n=[],a=ln(t),s=0;s!==a.length;++s)n[t[a[s]]]=a[s];return n}function Uu(t){for(var n=[],a=ln(t),s=0;s!==a.length;++s)n[t[a[s]]]=parseInt(a[s],10);return n}function mk(t){for(var n=[],a=ln(t),s=0;s!==a.length;++s)n[t[a[s]]]==null&&(n[t[a[s]]]=[]),n[t[a[s]]].push(a[s]);return n}var Su=new Date(1899,11,30,0,0,0);function An(t,n){var a=t.getTime(),s=Su.getTime()+(t.getTimezoneOffset()-Su.getTimezoneOffset())*6e4;return(a-s)/(1440*60*1e3)}var X1=new Date,pk=Su.getTime()+(X1.getTimezoneOffset()-Su.getTimezoneOffset())*6e4,Gy=X1.getTimezoneOffset();function Q1(t){var n=new Date;return n.setTime(t*24*60*60*1e3+pk),n.getTimezoneOffset()!==Gy&&n.setTime(n.getTime()+(n.getTimezoneOffset()-Gy)*6e4),n}var Ky=new Date("2017-02-19T19:06:09.000Z"),ej=isNaN(Ky.getFullYear())?new Date("2/19/17"):Ky,gk=ej.getFullYear()==2017;function vn(t,n){var a=new Date(t);if(gk)return n>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):n<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(t instanceof Date)return t;if(ej.getFullYear()==1917&&!isNaN(a.getFullYear())){var s=a.getFullYear();return t.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var o=t.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return t.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function $u(t,n){if(Vt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(c){return a[c]||c})}catch{}for(var s=[],o=0;o!=t.length;++o)s.push(String.fromCharCode(t[o]));return s.join("")}function En(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var n={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=En(t[a]));return n}function wa(t,n){for(var a="";a.length<n;)a+=t;return a}function ii(t){var n=Number(t);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(t))return n;var a=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(n=Number(s))||(s=s.replace(/[(](.*)[)]/,function(o,c){return a=-a,c}),!isNaN(n=Number(s)))?n/a:n}var xk=["january","february","march","april","may","june","july","august","september","october","november","december"];function nc(t){var n=new Date(t),a=new Date(NaN),s=n.getYear(),o=n.getMonth(),c=n.getDate();if(isNaN(c))return a;var u=t.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&xk.indexOf(u)==-1)return a}else if(u.match(/[a-z]/))return a;return s<0||s>8099?a:(o>0||c>1)&&s!=101?n:t.match(/[^-0-9:,\/\\]/)?a:n}function Ct(t,n,a){if(t.FullPaths){if(typeof a=="string"){var s;return Vt?s=di(a):s=P2(a),ia.utils.cfb_add(t,n,s)}ia.utils.cfb_add(t,n,a)}else t.file(n,a)}function yp(){return ia.utils.cfb_new()}var Ma=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vp=xp(yk),jp=/[&<>'"]/g,vk=/[\u0000-\u0008\u000b-\u001f]/g;function Qt(t){var n=t+"";return n.replace(jp,function(a){return vp[a]}).replace(vk,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qy(t){return Qt(t).replace(/ /g,"_x0020_")}var tj=/[\u0000-\u001f]/g;function jk(t){var n=t+"";return n.replace(jp,function(a){return vp[a]}).replace(/\n/g,"<br/>").replace(tj,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function bk(t){var n=t+"";return n.replace(jp,function(a){return vp[a]}).replace(tj,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}function _k(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Sk(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sm(t){for(var n="",a=0,s=0,o=0,c=0,u=0,h=0;a<t.length;){if(s=t.charCodeAt(a++),s<128){n+=String.fromCharCode(s);continue}if(o=t.charCodeAt(a++),s>191&&s<224){u=(s&31)<<6,u|=o&63,n+=String.fromCharCode(u);continue}if(c=t.charCodeAt(a++),s<240){n+=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63);continue}u=t.charCodeAt(a++),h=((s&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536,n+=String.fromCharCode(55296+(h>>>10&1023)),n+=String.fromCharCode(56320+(h&1023))}return n}function Yy(t){var n=bs(2*t.length),a,s,o=1,c=0,u=0,h;for(s=0;s<t.length;s+=o)o=1,(h=t.charCodeAt(s))<128?a=h:h<224?(a=(h&31)*64+(t.charCodeAt(s+1)&63),o=2):h<240?(a=(h&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),o=3):(o=4,a=(h&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),a-=65536,u=55296+(a>>>10&1023),a=56320+(a&1023)),u!==0&&(n[c++]=u&255,n[c++]=u>>>8,u=0),n[c++]=a%256,n[c++]=a>>>8;return n.slice(0,c).toString("ucs2")}function Jy(t){return di(t,"binary").toString("utf8")}var Id="foo bar baz",Zo=Vt&&(Jy(Id)==sm(Id)&&Jy||Yy(Id)==sm(Id)&&Yy)||sm,rc=Vt?function(t){return di(t,"utf8").toString("binary")}:function(t){for(var n=[],a=0,s=0,o=0;a<t.length;)switch(s=t.charCodeAt(a++),!0){case s<128:n.push(String.fromCharCode(s));break;case s<2048:n.push(String.fromCharCode(192+(s>>6))),n.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,o=t.charCodeAt(a++)-56320+(s<<10),n.push(String.fromCharCode(240+(o>>18&7))),n.push(String.fromCharCode(144+(o>>12&63))),n.push(String.fromCharCode(128+(o>>6&63))),n.push(String.fromCharCode(128+(o&63)));break;default:n.push(String.fromCharCode(224+(s>>12))),n.push(String.fromCharCode(128+(s>>6&63))),n.push(String.fromCharCode(128+(s&63)))}return n.join("")},wk=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<t.length;++o)s=s.replace(t[o][0],t[o][1]);return s}})(),aj=/(^\s|\s$|\n)/;function rn(t,n){return"<"+t+(n.match(aj)?' xml:space="preserve"':"")+">"+n+"</"+t+">"}function ic(t){return ln(t).map(function(n){return" "+n+'="'+t[n]+'"'}).join("")}function Je(t,n,a){return"<"+t+(a!=null?ic(a):"")+(n!=null?(n.match(aj)?' xml:space="preserve"':"")+">"+n+"</"+t:"/")+">"}function Qm(t,n){try{return t.toISOString().replace(/\.\d*/,"")}catch(a){if(n)throw a}return""}function kk(t,n){switch(typeof t){case"string":var a=Je("vt:lpwstr",Qt(t));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Je((t|0)==t?"vt:i4":"vt:r8",Qt(String(t)));case"boolean":return Je("vt:bool",t?"true":"false")}if(t instanceof Date)return Je("vt:filetime",Qm(t));throw new Error("Unable to serialize "+t)}var Za={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Nl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function zk(t,n){for(var a=1-2*(t[n+7]>>>7),s=((t[n+7]&127)<<4)+(t[n+6]>>>4&15),o=t[n+6]&15,c=5;c>=0;--c)o=o*256+t[n+c];return s==2047?o==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,o+=Math.pow(2,52)),a*Math.pow(2,s-52)*o)}function Ck(t,n,a){var s=(n<0||1/n==-1/0?1:0)<<7,o=0,c=0,u=s?-n:n;isFinite(u)?u==0?o=c=0:(o=Math.floor(Math.log(u)/Math.LN2),c=u*Math.pow(2,52-o),o<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?o=-1022:(c-=Math.pow(2,52),o+=1023)):(o=2047,c=isNaN(n)?26985:0);for(var h=0;h<=5;++h,c/=256)t[a+h]=c&255;t[a+6]=(o&15)<<4|c&15,t[a+7]=o>>4|s}var Xy=function(t){for(var n=[],a=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var o=0,c=t[0][s].length;o<c;o+=a)n.push.apply(n,t[0][s].slice(o,o+a));return n},Qy=Vt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(n){return Buffer.isBuffer(n)?n:di(n)})):Xy(t)}:Xy,ev=function(t,n,a){for(var s=[],o=n;o<a;o+=2)s.push(String.fromCharCode(Uo(t,o)));return s.join("").replace(Vo,"")},bp=Vt?function(t,n,a){return Buffer.isBuffer(t)?t.toString("utf16le",n,a).replace(Vo,""):ev(t,n,a)}:ev,tv=function(t,n,a){for(var s=[],o=n;o<n+a;++o)s.push(("0"+t[o].toString(16)).slice(-2));return s.join("")},nj=Vt?function(t,n,a){return Buffer.isBuffer(t)?t.toString("hex",n,n+a):tv(t,n,a)}:tv,av=function(t,n,a){for(var s=[],o=n;o<a;o++)s.push(String.fromCharCode(xl(t,o)));return s.join("")},gc=Vt?function(n,a,s){return Buffer.isBuffer(n)?n.toString("utf8",a,s):av(n,a,s)}:av,rj=function(t,n){var a=Zn(t,n);return a>0?gc(t,n+4,n+4+a-1):""},ij=rj,sj=function(t,n){var a=Zn(t,n);return a>0?gc(t,n+4,n+4+a-1):""},lj=sj,oj=function(t,n){var a=2*Zn(t,n);return a>0?gc(t,n+4,n+4+a-1):""},cj=oj,dj=function(n,a){var s=Zn(n,a);return s>0?bp(n,a+4,a+4+s):""},uj=dj,fj=function(t,n){var a=Zn(t,n);return a>0?gc(t,n+4,n+4+a):""},hj=fj,mj=function(t,n){return zk(t,n)},wu=mj,_p=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};Vt&&(ij=function(n,a){if(!Buffer.isBuffer(n))return rj(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},lj=function(n,a){if(!Buffer.isBuffer(n))return sj(n,a);var s=n.readUInt32LE(a);return s>0?n.toString("utf8",a+4,a+4+s-1):""},cj=function(n,a){if(!Buffer.isBuffer(n))return oj(n,a);var s=2*n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s-1)},uj=function(n,a){if(!Buffer.isBuffer(n))return dj(n,a);var s=n.readUInt32LE(a);return n.toString("utf16le",a+4,a+4+s)},hj=function(n,a){if(!Buffer.isBuffer(n))return fj(n,a);var s=n.readUInt32LE(a);return n.toString("utf8",a+4,a+4+s)},wu=function(n,a){return Buffer.isBuffer(n)?n.readDoubleLE(a):mj(n,a)},_p=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});var xl=function(t,n){return t[n]},Uo=function(t,n){return t[n+1]*256+t[n]},Tk=function(t,n){var a=t[n+1]*256+t[n];return a<32768?a:(65535-a+1)*-1},Zn=function(t,n){return t[n+3]*(1<<24)+(t[n+2]<<16)+(t[n+1]<<8)+t[n]},vs=function(t,n){return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]},Nk=function(t,n){return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]};function Go(t,n){var a="",s,o,c=[],u,h,f,p;switch(n){case"dbcs":if(p=this.l,Vt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)a+=String.fromCharCode(Uo(this,p)),p+=2;t*=2;break;case"utf8":a=gc(this,this.l,this.l+t);break;case"utf16le":t*=2,a=bp(this,this.l,this.l+t);break;case"wstr":return Go.call(this,t,"dbcs");case"lpstr-ansi":a=ij(this,this.l),t=4+Zn(this,this.l);break;case"lpstr-cp":a=lj(this,this.l),t=4+Zn(this,this.l);break;case"lpwstr":a=cj(this,this.l),t=4+2*Zn(this,this.l);break;case"lpp4":t=4+Zn(this,this.l),a=uj(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Zn(this,this.l),a=hj(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,a="";(u=xl(this,this.l+t++))!==0;)c.push(Dd(u));a=c.join("");break;case"_wstr":for(t=0,a="";(u=Uo(this,this.l+t))!==0;)c.push(Dd(u)),t+=2;t+=2,a=c.join("");break;case"dbcs-cont":for(a="",p=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return u=xl(this,p),this.l=p+1,h=Go.call(this,t-f,u?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(Dd(Uo(this,p))),p+=2}a=c.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(a="",p=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return u=xl(this,p),this.l=p+1,h=Go.call(this,t-f,u?"dbcs-cont":"sbcs-cont"),c.join("")+h;c.push(Dd(xl(this,p))),p+=1}a=c.join("");break;default:switch(t){case 1:return s=xl(this,this.l),this.l++,s;case 2:return s=(n==="i"?Tk:Uo)(this,this.l),this.l+=2,s;case 4:case-4:return n==="i"||(this[this.l+3]&128)===0?(s=(t>0?vs:Nk)(this,this.l),this.l+=4,s):(o=Zn(this,this.l),this.l+=4,o);case 8:case-8:if(n==="f")return t==8?o=wu(this,this.l):o=wu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;t=8;case 16:a=nj(this,this.l,t);break}}return this.l+=t,a}var Ak=function(t,n,a){t[a]=n&255,t[a+1]=n>>>8&255,t[a+2]=n>>>16&255,t[a+3]=n>>>24&255},Ek=function(t,n,a){t[a]=n&255,t[a+1]=n>>8&255,t[a+2]=n>>16&255,t[a+3]=n>>24&255},Fk=function(t,n,a){t[a]=n&255,t[a+1]=n>>>8&255};function Rk(t,n,a){var s=0,o=0;if(a==="dbcs"){for(o=0;o!=n.length;++o)Fk(this,n.charCodeAt(o),this.l+2*o);s=2*n.length}else if(a==="sbcs"){for(n=n.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=n.length;++o)this[this.l+o]=n.charCodeAt(o)&255;s=n.length}else if(a==="hex"){for(;o<t;++o)this[this.l++]=parseInt(n.slice(2*o,2*o+2),16)||0;return this}else if(a==="utf16le"){var c=Math.min(this.l+t,this.length);for(o=0;o<Math.min(n.length,t);++o){var u=n.charCodeAt(o);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=n&255;break;case 2:s=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:s=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:s=4,Ak(this,n,this.l);break;case 8:if(s=8,a==="f"){Ck(this,n,this.l);break}case 16:break;case-4:s=4,Ek(this,n,this.l);break}return this.l+=s,this}function pj(t,n){var a=nj(this,this.l,t.length>>1);if(a!==t)throw new Error(n+"Expected "+t+" saw "+a);this.l+=t.length>>1}function Hn(t,n){t.l=n,t.read_shift=Go,t.chk=pj,t.write_shift=Rk}function Lr(t,n){t.l+=n}function Pe(t){var n=bs(t);return Hn(n,0),n}function Nn(){var t=[],n=Vt?256:2048,a=function(p){var x=Pe(p);return Hn(x,0),x},s=a(n),o=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},c=function(p){return s&&p<s.length-s.l?s:(o(),s=a(Math.max(p+1,n)))},u=function(){return o(),nn(t)},h=function(p){o(),s=p,s.l==null&&(s.l=s.length),c(n)};return{next:c,push:h,end:u,_bufs:t}}function Ke(t,n,a,s){var o=+n,c;if(!isNaN(o)){s||(s=z6[o].p||(a||[]).length||0),c=1+(o>=128?1:0)+1,s>=128&&++c,s>=16384&&++c,s>=2097152&&++c;var u=t.next(c);o<=127?u.write_shift(1,o):(u.write_shift(1,(o&127)+128),u.write_shift(1,o>>7));for(var h=0;h!=4;++h)if(s>=128)u.write_shift(1,(s&127)+128),s>>=7;else{u.write_shift(1,s);break}s>0&&_p(a)&&t.push(a)}}function Ko(t,n,a){var s=En(t);if(n.s?(s.cRel&&(s.c+=n.s.c),s.rRel&&(s.r+=n.s.r)):(s.cRel&&(s.c+=n.c),s.rRel&&(s.r+=n.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function nv(t,n,a){var s=En(t);return s.s=Ko(s.s,n.s,a),s.e=Ko(s.e,n.s,a),s}function qo(t,n){if(t.cRel&&t.c<0)for(t=En(t);t.c<0;)t.c+=n>8?16384:256;if(t.rRel&&t.r<0)for(t=En(t);t.r<0;)t.r+=n>8?1048576:n>5?65536:16384;var a=ea(t);return!t.cRel&&t.cRel!=null&&(a=Dk(a)),!t.rRel&&t.rRel!=null&&(a=Bk(a)),a}function lm(t,n){return t.s.r==0&&!t.s.rRel&&t.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+fn(t.s.c)+":"+(t.e.cRel?"":"$")+fn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(n.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):qo(t.s,n.biff)+":"+qo(t.e,n.biff)}function Sp(t){return parseInt(Ok(t),10)-1}function sn(t){return""+(t+1)}function Bk(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ok(t){return t.replace(/\$(\d+)$/,"$1")}function wp(t){for(var n=Lk(t),a=0,s=0;s!==n.length;++s)a=26*a+n.charCodeAt(s)-64;return a-1}function fn(t){if(t<0)throw new Error("invalid column "+t);var n="";for(++t;t;t=Math.floor((t-1)/26))n=String.fromCharCode((t-1)%26+65)+n;return n}function Dk(t){return t.replace(/^([A-Z])/,"$$$1")}function Lk(t){return t.replace(/^\$([A-Z])/,"$1")}function Mk(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ga(t){for(var n=0,a=0,s=0;s<t.length;++s){var o=t.charCodeAt(s);o>=48&&o<=57?n=10*n+(o-48):o>=65&&o<=90&&(a=26*a+(o-64))}return{c:a-1,r:n-1}}function ea(t){for(var n=t.c+1,a="";n;n=(n-1)/26|0)a=String.fromCharCode((n-1)%26+65)+a;return a+(t.r+1)}function Gn(t){var n=t.indexOf(":");return n==-1?{s:Ga(t),e:Ga(t)}:{s:Ga(t.slice(0,n)),e:Ga(t.slice(n+1))}}function La(t,n){return typeof n>"u"||typeof n=="number"?La(t.s,t.e):(typeof t!="string"&&(t=ea(t)),typeof n!="string"&&(n=ea(n)),t==n?t:t+":"+n)}function pa(t){var n={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,o=0,c=t.length;for(a=0;s<c&&!((o=t.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(n.s.c=--a,a=0;s<c&&!((o=t.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;if(n.s.r=--a,s===c||o!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++s,a=0;s!=c&&!((o=t.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(n.e.c=--a,a=0;s!=c&&!((o=t.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;return n.e.r=--a,n}function rv(t,n){var a=t.t=="d"&&n instanceof Date;if(t.z!=null)try{return t.w=Zi(t.z,a?An(n):n)}catch{}try{return t.w=Zi((t.XF||{}).numFmtId||(a?14:0),a?An(n):n)}catch{return""+n}}function ci(t,n,a){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&a&&a.dateNF&&(t.z=a.dateNF),t.t=="e"?xc[t.v]||t.v:n==null?rv(t,t.v):rv(t,n))}function ws(t,n){var a=n&&n.sheet?n.sheet:"Sheet1",s={};return s[a]=t,{SheetNames:[a],Sheets:s}}function gj(t,n,a){var s=a||{},o=t?Array.isArray(t):s.dense,c=t||(o?[]:{}),u=0,h=0;if(c&&s.origin!=null){if(typeof s.origin=="number")u=s.origin;else{var f=typeof s.origin=="string"?Ga(s.origin):s.origin;u=f.r,h=f.c}c["!ref"]||(c["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var x=pa(c["!ref"]);p.s.c=x.s.c,p.s.r=x.s.r,p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),u==-1&&(p.e.r=u=x.e.r+1)}for(var j=0;j!=n.length;++j)if(n[j]){if(!Array.isArray(n[j]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=n[j].length;++y)if(!(typeof n[j][y]>"u")){var S={v:n[j][y]},w=u+j,b=h+y;if(p.s.r>w&&(p.s.r=w),p.s.c>b&&(p.s.c=b),p.e.r<w&&(p.e.r=w),p.e.c<b&&(p.e.c=b),n[j][y]&&typeof n[j][y]=="object"&&!Array.isArray(n[j][y])&&!(n[j][y]instanceof Date))S=n[j][y];else if(Array.isArray(S.v)&&(S.f=n[j][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(s.nullError)S.t="e",S.v=0;else if(s.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=s.dateNF||ka[14],s.cellDates?(S.t="d",S.w=Zi(S.z,An(S.v))):(S.t="n",S.v=An(S.v),S.w=Zi(S.z,S.v))):S.t="s";if(o)c[w]||(c[w]=[]),c[w][b]&&c[w][b].z&&(S.z=c[w][b].z),c[w][b]=S;else{var _=ea({c:b,r:w});c[_]&&c[_].z&&(S.z=c[_].z),c[_]=S}}}return p.s.c<1e7&&(c["!ref"]=La(p)),c}function Al(t,n){return gj(null,t,n)}function Ik(t){return t.read_shift(4,"i")}function zr(t,n){return n||(n=Pe(4)),n.write_shift(4,t),n}function hn(t){var n=t.read_shift(4);return n===0?"":t.read_shift(n,"dbcs")}function Ka(t,n){var a=!1;return n==null&&(a=!0,n=Pe(4+2*t.length)),n.write_shift(4,t.length),t.length>0&&n.write_shift(0,t,"dbcs"),a?n.slice(0,n.l):n}function Pk(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Wk(t,n){return n||(n=Pe(4)),n.write_shift(2,0),n.write_shift(2,0),n}function kp(t,n){var a=t.l,s=t.read_shift(1),o=hn(t),c=[],u={t:o,h:o};if((s&1)!==0){for(var h=t.read_shift(4),f=0;f!=h;++f)c.push(Pk(t));u.r=c}else u.r=[{ich:0,ifnt:0}];return t.l=a+n,u}function Uk(t,n){var a=!1;return n==null&&(a=!0,n=Pe(15+4*t.t.length)),n.write_shift(1,0),Ka(t.t,n),a?n.slice(0,n.l):n}var $k=kp;function Hk(t,n){var a=!1;return n==null&&(a=!0,n=Pe(23+4*t.t.length)),n.write_shift(1,1),Ka(t.t,n),n.write_shift(4,1),Wk({},n),a?n.slice(0,n.l):n}function dr(t){var n=t.read_shift(4),a=t.read_shift(2);return a+=t.read_shift(1)<<16,t.l++,{c:n,iStyleRef:a}}function ks(t,n){return n==null&&(n=Pe(8)),n.write_shift(-4,t.c),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}function zs(t){var n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:n}}function Cs(t,n){return n==null&&(n=Pe(4)),n.write_shift(3,t.iStyleRef||t.s),n.write_shift(1,0),n}var Vk=hn,xj=Ka;function zp(t){var n=t.read_shift(4);return n===0||n===4294967295?"":t.read_shift(n,"dbcs")}function ku(t,n){var a=!1;return n==null&&(a=!0,n=Pe(127)),n.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&n.write_shift(0,t,"dbcs"),a?n.slice(0,n.l):n}var Zk=hn,ep=zp,Cp=ku;function yj(t){var n=t.slice(t.l,t.l+4),a=n[0]&1,s=n[0]&2;t.l+=4;var o=s===0?wu([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):vs(n,0)>>2;return a?o/100:o}function vj(t,n){n==null&&(n=Pe(4));var a=0,s=0,o=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:o==(o|0)&&o>=-536870912&&o<1<<29&&(s=1,a=1),s)n.write_shift(-4,((a?o:t)<<2)+(a+2));else throw new Error("unsupported RkNumber "+t)}function jj(t){var n={s:{},e:{}};return n.s.r=t.read_shift(4),n.e.r=t.read_shift(4),n.s.c=t.read_shift(4),n.e.c=t.read_shift(4),n}function Gk(t,n){return n||(n=Pe(16)),n.write_shift(4,t.s.r),n.write_shift(4,t.e.r),n.write_shift(4,t.s.c),n.write_shift(4,t.e.c),n}var Ts=jj,El=Gk;function Fl(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function _s(t,n){return(n||Pe(8)).write_shift(8,t,"f")}function Kk(t){var n={},a=t.read_shift(1),s=a>>>1,o=t.read_shift(1),c=t.read_shift(2,"i"),u=t.read_shift(1),h=t.read_shift(1),f=t.read_shift(1);switch(t.l++,s){case 0:n.auto=1;break;case 1:n.index=o;var p=nz[o];p&&(n.rgb=pv(p));break;case 2:n.rgb=pv([u,h,f]);break;case 3:n.theme=o;break}return c!=0&&(n.tint=c>0?c/32767:c/32768),n}function zu(t,n){if(n||(n=Pe(8)),!t||t.auto)return n.write_shift(4,0),n.write_shift(4,0),n;t.index!=null?(n.write_shift(1,2),n.write_shift(1,t.index)):t.theme!=null?(n.write_shift(1,6),n.write_shift(1,t.theme)):(n.write_shift(1,5),n.write_shift(1,0));var a=t.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),n.write_shift(2,a),!t.rgb||t.theme!=null)n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),n.write_shift(1,parseInt(s.slice(0,2),16)),n.write_shift(1,parseInt(s.slice(2,4),16)),n.write_shift(1,parseInt(s.slice(4,6),16)),n.write_shift(1,255)}return n}function qk(t){var n=t.read_shift(1);t.l++;var a={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return a}function Yk(t,n){n||(n=Pe(2));var a=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return n.write_shift(1,a),n.write_shift(1,0),n}var bj=2,$n=3,Pd=11,Cu=19,Wd=64,Jk=65,Xk=71,Qk=4108,ez=4126,an=80,iv={1:{n:"CodePage",t:bj},2:{n:"Category",t:an},3:{n:"PresentationFormat",t:an},4:{n:"ByteCount",t:$n},5:{n:"LineCount",t:$n},6:{n:"ParagraphCount",t:$n},7:{n:"SlideCount",t:$n},8:{n:"NoteCount",t:$n},9:{n:"HiddenCount",t:$n},10:{n:"MultimediaClipCount",t:$n},11:{n:"ScaleCrop",t:Pd},12:{n:"HeadingPairs",t:Qk},13:{n:"TitlesOfParts",t:ez},14:{n:"Manager",t:an},15:{n:"Company",t:an},16:{n:"LinksUpToDate",t:Pd},17:{n:"CharacterCount",t:$n},19:{n:"SharedDoc",t:Pd},22:{n:"HyperlinksChanged",t:Pd},23:{n:"AppVersion",t:$n,p:"version"},24:{n:"DigSig",t:Jk},26:{n:"ContentType",t:an},27:{n:"ContentStatus",t:an},28:{n:"Language",t:an},29:{n:"Version",t:an},255:{},2147483648:{n:"Locale",t:Cu},2147483651:{n:"Behavior",t:Cu},1919054434:{}},sv={1:{n:"CodePage",t:bj},2:{n:"Title",t:an},3:{n:"Subject",t:an},4:{n:"Author",t:an},5:{n:"Keywords",t:an},6:{n:"Comments",t:an},7:{n:"Template",t:an},8:{n:"LastAuthor",t:an},9:{n:"RevNumber",t:an},10:{n:"EditTime",t:Wd},11:{n:"LastPrinted",t:Wd},12:{n:"CreatedDate",t:Wd},13:{n:"ModifiedDate",t:Wd},14:{n:"PageCount",t:$n},15:{n:"WordCount",t:$n},16:{n:"CharCount",t:$n},17:{n:"Thumbnail",t:Xk},18:{n:"Application",t:an},19:{n:"DocSecurity",t:$n},255:{},2147483648:{n:"Locale",t:Cu},2147483651:{n:"Behavior",t:Cu},1919054434:{}};function tz(t){return t.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var az=tz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),nz=En(az),xc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},rz={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ud={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _j(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Sj(t,n){var a=mk(rz),s=[],o;s[s.length]=Ma,s[s.length]=Je("Types",null,{xmlns:Za.CT,"xmlns:xsd":Za.xsd,"xmlns:xsi":Za.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Je("Default",null,{Extension:f[0],ContentType:f[1]})}));var c=function(f){t[f]&&t[f].length>0&&(o=t[f][0],s[s.length]=Je("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:Ud[f][n.bookType]||Ud[f].xlsx}))},u=function(f){(t[f]||[]).forEach(function(p){s[s.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:Ud[f][n.bookType]||Ud[f].xlsx})})},h=function(f){(t[f]||[]).forEach(function(p){s[s.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:a[f][0]})})};return c("workbooks"),u("sheets"),u("charts"),h("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),u("metadata"),h("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var $t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wj(t){var n=t.lastIndexOf("/");return t.slice(0,n+1)+"_rels/"+t.slice(n+1)+".rels"}function jl(t){var n=[Ma,Je("Relationships",null,{xmlns:Za.RELS})];return ln(t["!id"]).forEach(function(a){n[n.length]=Je("Relationship",null,t["!id"][a])}),n.length>2&&(n[n.length]="</Relationships>",n[1]=n[1].replace("/>",">")),n.join("")}function Xt(t,n,a,s,o,c){if(o||(o={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),n<0)for(n=t["!idx"];t["!id"]["rId"+n];++n);if(t["!idx"]=n+1,o.Id="rId"+n,o.Type=s,o.Target=a,[$t.HLINK,$t.XPATH,$t.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),t["!id"][o.Id])throw new Error("Cannot rewrite rId "+n);return t["!id"][o.Id]=o,t[("/"+o.Target).replace("//","/")]=o,n}function iz(t){var n=[Ma];n.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),n.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<t.length;++a)n.push('  <manifest:file-entry manifest:full-path="'+t[a][0]+'" manifest:media-type="'+t[a][1]+`"/>
`);return n.push("</manifest:manifest>"),n.join("")}function lv(t,n,a){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+n+`"/>
`,`  </rdf:Description>
`].join("")}function sz(t,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+n+`"/>
`,`  </rdf:Description>
`].join("")}function lz(t){var n=[Ma];n.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=t.length;++a)n.push(lv(t[a][0],t[a][1])),n.push(sz("",t[a][0]));return n.push(lv("","Document","pkg")),n.push("</rdf:RDF>"),n.join("")}function kj(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yu.version+"</meta:generator></office:meta></office:document-meta>"}var js=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function om(t,n,a,s,o){o[t]!=null||n==null||n===""||(o[t]=n,n=Qt(n),s[s.length]=a?Je(t,n,a):rn(t,n))}function zj(t,n){var a=n||{},s=[Ma,Je("cp:coreProperties",null,{"xmlns:cp":Za.CORE_PROPS,"xmlns:dc":Za.dc,"xmlns:dcterms":Za.dcterms,"xmlns:dcmitype":Za.dcmitype,"xmlns:xsi":Za.xsi})],o={};if(!t&&!a.Props)return s.join("");t&&(t.CreatedDate!=null&&om("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Qm(t.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o),t.ModifiedDate!=null&&om("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Qm(t.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o));for(var c=0;c!=js.length;++c){var u=js[c],h=a.Props&&a.Props[u[1]]!=null?a.Props[u[1]]:t?t[u[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&om(u[0],h,null,s,o)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var bl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Cj=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Tj(t){var n=[],a=Je;return t||(t={}),t.Application="SheetJS",n[n.length]=Ma,n[n.length]=Je("Properties",null,{xmlns:Za.EXT_PROPS,"xmlns:vt":Za.vt}),bl.forEach(function(s){if(t[s[1]]!==void 0){var o;switch(s[2]){case"string":o=Qt(String(t[s[1]]));break;case"bool":o=t[s[1]]?"true":"false";break}o!==void 0&&(n[n.length]=a(s[0],o))}}),n[n.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),n[n.length]=a("TitlesOfParts",a("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Qt(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}function Nj(t){var n=[Ma,Je("Properties",null,{xmlns:Za.CUST_PROPS,"xmlns:vt":Za.vt})];if(!t)return n.join("");var a=1;return ln(t).forEach(function(o){++a,n[n.length]=Je("property",kk(t[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:Qt(o)})}),n.length>2&&(n[n.length]="</Properties>",n[1]=n[1].replace("/>",">")),n.join("")}var ov={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function oz(t,n){var a=[];return ln(ov).map(function(s){for(var o=0;o<js.length;++o)if(js[o][1]==s)return js[o];for(o=0;o<bl.length;++o)if(bl[o][1]==s)return bl[o];throw s}).forEach(function(s){if(t[s[1]]!=null){var o=n&&n.Props&&n.Props[s[1]]!=null?n.Props[s[1]]:t[s[1]];s[2]==="date"&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),a.push(rn(ov[s[1]]||s[1],o))}}),Je("DocumentProperties",a.join(""),{xmlns:Vn.o})}function cz(t,n){var a=["Worksheets","SheetNames"],s="CustomDocumentProperties",o=[];return t&&ln(t).forEach(function(c){if(Object.prototype.hasOwnProperty.call(t,c)){for(var u=0;u<js.length;++u)if(c==js[u][1])return;for(u=0;u<bl.length;++u)if(c==bl[u][1])return;for(u=0;u<a.length;++u)if(c==a[u])return;var h=t[c],f="string";typeof h=="number"?(f="float",h=String(h)):h===!0||h===!1?(f="boolean",h=h?"1":"0"):h=String(h),o.push(Je(qy(c),h,{"dt:dt":f}))}}),n&&ln(n).forEach(function(c){if(Object.prototype.hasOwnProperty.call(n,c)&&!(t&&Object.prototype.hasOwnProperty.call(t,c))){var u=n[c],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u instanceof Date?(h="dateTime.tz",u=u.toISOString()):u=String(u),o.push(Je(qy(c),u,{"dt:dt":h}))}}),"<"+s+' xmlns="'+Vn.o+'">'+o.join("")+"</"+s+">"}function dz(t){var n=typeof t=="string"?new Date(Date.parse(t)):t,a=n.getTime()/1e3+11644473600,s=a%Math.pow(2,32),o=(a-s)/Math.pow(2,32);s*=1e7,o*=1e7;var c=s/Math.pow(2,32)|0;c>0&&(s=s%Math.pow(2,32),o+=c);var u=Pe(8);return u.write_shift(4,s),u.write_shift(4,o),u}function cv(t,n){var a=Pe(4),s=Pe(4);switch(a.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,n);break;case 5:s=Pe(8),s.write_shift(8,n,"f");break;case 11:s.write_shift(4,n?1:0);break;case 64:s=dz(n);break;case 31:case 80:for(s=Pe(4+2*(n.length+1)+(n.length%2?0:2)),s.write_shift(4,n.length+1),s.write_shift(0,n,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}return nn([a,s])}var Aj=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uz(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function dv(t,n,a){var s=Pe(8),o=[],c=[],u=8,h=0,f=Pe(8),p=Pe(8);if(f.write_shift(4,2),f.write_shift(4,1200),p.write_shift(4,1),c.push(f),o.push(p),u+=8+f.length,!n){p=Pe(8),p.write_shift(4,0),o.unshift(p);var x=[Pe(4)];for(x[0].write_shift(4,t.length),h=0;h<t.length;++h){var j=t[h][0];for(f=Pe(8+2*(j.length+1)+(j.length%2?0:2)),f.write_shift(4,h+2),f.write_shift(4,j.length+1),f.write_shift(0,j,"dbcs");f.l!=f.length;)f.write_shift(1,0);x.push(f)}f=nn(x),c.unshift(f),u+=8+f.length}for(h=0;h<t.length;++h)if(!(n&&!n[t[h][0]])&&!(Aj.indexOf(t[h][0])>-1||Cj.indexOf(t[h][0])>-1)&&t[h][1]!=null){var y=t[h][1],S=0;if(n){S=+n[t[h][0]];var w=a[S];if(w.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=cv(w.t,y)}else{var _=uz(y);_==-1&&(_=31,y=String(y)),f=cv(_,y)}c.push(f),p=Pe(8),p.write_shift(4,n?S:2+h),o.push(p),u+=8+f.length}var E=8*(c.length+1);for(h=0;h<c.length;++h)o[h].write_shift(4,E),E+=c[h].length;return s.write_shift(4,u),s.write_shift(4,c.length),nn([s].concat(o).concat(c))}function uv(t,n,a,s,o,c){var u=Pe(o?68:48),h=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,ia.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,o?2:1),u.write_shift(16,n,"hex"),u.write_shift(4,o?68:48);var f=dv(t,a,s);if(h.push(f),o){var p=dv(o,null,null);u.write_shift(16,c,"hex"),u.write_shift(4,68+f.length),h.push(p)}return nn(h)}function fz(t,n){n||(n=Pe(t));for(var a=0;a<t;++a)n.write_shift(1,0);return n}function hz(t,n){return t.read_shift(n)===1}function yn(t,n){return n||(n=Pe(2)),n.write_shift(2,+!!t),n}function Ej(t){return t.read_shift(2,"u")}function lr(t,n){return n||(n=Pe(2)),n.write_shift(2,t),n}function Fj(t,n,a){return a||(a=Pe(2)),a.write_shift(1,n=="e"?+t:+!!t),a.write_shift(1,n=="e"?1:0),a}function Rj(t,n,a){var s=t.read_shift(a&&a.biff>=12?2:1),o="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var c=t.read_shift(1);c&&(o="dbcs-cont")}else a.biff==12&&(o="wstr");a.biff>=2&&a.biff<=5&&(o="cpstr");var u=s?t.read_shift(s,o):"";return u}function mz(t){var n=t.t||"",a=Pe(3);a.write_shift(2,n.length),a.write_shift(1,1);var s=Pe(2*n.length);s.write_shift(2*n.length,n,"utf16le");var o=[a,s];return nn(o)}function pz(t,n,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return t.read_shift(n,"cpstr");if(a.biff>=12)return t.read_shift(n,"dbcs-cont")}var o=t.read_shift(1);return o===0?s=t.read_shift(n,"sbcs-cont"):s=t.read_shift(n,"dbcs-cont"),s}function gz(t,n,a){var s=t.read_shift(a&&a.biff==2?1:2);return s===0?(t.l++,""):pz(t,s,a)}function xz(t,n,a){if(a.biff>5)return gz(t,n,a);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,a.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Bj(t,n,a){return a||(a=Pe(3+2*t.length)),a.write_shift(2,t.length),a.write_shift(1,1),a.write_shift(31,t,"utf16le"),a}function fv(t,n){n||(n=Pe(6+t.length*2)),n.write_shift(4,1+t.length);for(var a=0;a<t.length;++a)n.write_shift(2,t.charCodeAt(a));return n.write_shift(2,0),n}function yz(t){var n=Pe(512),a=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var o=s.indexOf("#"),c=o>-1?31:23;switch(s.charAt(0)){case"#":c=28;break;case".":c&=-3;break}n.write_shift(4,2),n.write_shift(4,c);var u=[8,6815827,6619237,4849780,83];for(a=0;a<u.length;++a)n.write_shift(4,u[a]);if(c==28)s=s.slice(1),fv(s,n);else if(c&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<u.length;++a)n.write_shift(1,parseInt(u[a],16));var h=o>-1?s.slice(0,o):s;for(n.write_shift(4,2*(h.length+1)),a=0;a<h.length;++a)n.write_shift(2,h.charCodeAt(a));n.write_shift(2,0),c&8&&fv(o>-1?s.slice(o+1):"",n)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<u.length;++a)n.write_shift(1,parseInt(u[a],16));for(var f=0;s.slice(f*3,f*3+3)=="../"||s.slice(f*3,f*3+3)=="..\\";)++f;for(n.write_shift(2,f),n.write_shift(4,s.length-3*f+1),a=0;a<s.length-3*f;++a)n.write_shift(1,s.charCodeAt(a+3*f)&255);for(n.write_shift(1,0),n.write_shift(2,65535),n.write_shift(2,57005),a=0;a<6;++a)n.write_shift(4,0)}return n.slice(0,n.l)}function Ss(t,n,a,s){return s||(s=Pe(6)),s.write_shift(2,t),s.write_shift(2,n),s.write_shift(2,a||0),s}function vz(t,n,a){var s=a.biff>8?4:2,o=t.read_shift(s),c=t.read_shift(s,"i"),u=t.read_shift(s,"i");return[o,c,u]}function jz(t){var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2);return{s:{c:s,r:n},e:{c:o,r:a}}}function Oj(t,n){return n||(n=Pe(8)),n.write_shift(2,t.s.r),n.write_shift(2,t.e.r),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c),n}function Tp(t,n,a){var s=1536,o=16;switch(a.bookType){case"biff8":break;case"biff5":s=1280,o=8;break;case"biff4":s=4,o=6;break;case"biff3":s=3,o=6;break;case"biff2":s=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Pe(o);return c.write_shift(2,s),c.write_shift(2,n),o>4&&c.write_shift(2,29282),o>6&&c.write_shift(2,1997),o>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function bz(t,n){var a=!n||n.biff==8,s=Pe(a?112:54);for(s.write_shift(n.biff==8?2:1,7),a&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(a?0:536870912));s.l<s.length;)s.write_shift(1,a?0:32);return s}function _z(t,n){var a=!n||n.biff>=8?2:1,s=Pe(8+a*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),n.biff>=8&&s.write_shift(1,1),s.write_shift(a*t.name.length,t.name,n.biff<8?"sbcs":"utf16le");var o=s.slice(0,s.l);return o.l=s.l,o}function Sz(t,n){var a=Pe(8);a.write_shift(4,t.Count),a.write_shift(4,t.Unique);for(var s=[],o=0;o<t.length;++o)s[o]=mz(t[o]);var c=nn([a].concat(s));return c.parts=[a.length].concat(s.map(function(u){return u.length})),c}function wz(){var t=Pe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function kz(t){var n=Pe(18),a=1718;return t&&t.RTL&&(a|=64),n.write_shift(2,a),n.write_shift(4,0),n.write_shift(4,64),n.write_shift(4,0),n.write_shift(4,0),n}function zz(t,n){var a=t.name||"Arial",s=n&&n.biff==5,o=s?15+a.length:16+2*a.length,c=Pe(o);return c.write_shift(2,t.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,a.length),s||c.write_shift(1,1),c.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le"),c}function Cz(t,n,a,s){var o=Pe(10);return Ss(t,n,s,o),o.write_shift(4,a),o}function Tz(t,n,a,s,o){var c=!o||o.biff==8,u=Pe(8+ +c+(1+c)*a.length);return Ss(t,n,s,u),u.write_shift(2,a.length),c&&u.write_shift(1,1),u.write_shift((1+c)*a.length,a,c?"utf16le":"sbcs"),u}function Nz(t,n,a,s){var o=a&&a.biff==5;s||(s=Pe(o?3+n.length:5+2*n.length)),s.write_shift(2,t),s.write_shift(o?1:2,n.length),o||s.write_shift(1,1),s.write_shift((o?1:2)*n.length,n,o?"sbcs":"utf16le");var c=s.length>s.l?s.slice(0,s.l):s;return c.l==null&&(c.l=c.length),c}function Az(t,n){var a=n.biff==8||!n.biff?4:2,s=Pe(2*a+6);return s.write_shift(a,t.s.r),s.write_shift(a,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function hv(t,n,a,s){var o=a&&a.biff==5;s||(s=Pe(o?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,n<<4));var c=0;return t.numFmtId>0&&o&&(c|=1024),s.write_shift(4,c),s.write_shift(4,0),o||s.write_shift(4,0),s.write_shift(2,0),s}function Ez(t){var n=Pe(8);return n.write_shift(4,0),n.write_shift(2,0),n.write_shift(2,0),n}function Fz(t,n,a,s,o,c){var u=Pe(8);return Ss(t,n,s,u),Fj(a,c,u),u}function Rz(t,n,a,s){var o=Pe(14);return Ss(t,n,s,o),_s(a,o),o}function Bz(t,n,a){if(a.biff<8)return Oz(t,n,a);for(var s=[],o=t.l+n,c=t.read_shift(a.biff>8?4:2);c--!==0;)s.push(vz(t,a.biff>8?12:6,a));if(t.l!=o)throw new Error("Bad ExternSheet: "+t.l+" != "+o);return s}function Oz(t,n,a){t[t.l+1]==3&&t[t.l]++;var s=Rj(t,n,a);return s.charCodeAt(0)==3?s.slice(1):s}function Dz(t){var n=Pe(2+t.length*8);n.write_shift(2,t.length);for(var a=0;a<t.length;++a)Oj(t[a],n);return n}function Lz(t){var n=Pe(24),a=Ga(t[0]);n.write_shift(2,a.r),n.write_shift(2,a.r),n.write_shift(2,a.c),n.write_shift(2,a.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)n.write_shift(1,parseInt(s[o],16));return nn([n,yz(t[1])])}function Mz(t){var n=t[1].Tooltip,a=Pe(10+2*(n.length+1));a.write_shift(2,2048);var s=Ga(t[0]);a.write_shift(2,s.r),a.write_shift(2,s.r),a.write_shift(2,s.c),a.write_shift(2,s.c);for(var o=0;o<n.length;++o)a.write_shift(2,n.charCodeAt(o));return a.write_shift(2,0),a}function Iz(t){return t||(t=Pe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Pz(t,n,a){if(!a.cellStyles)return Lr(t,n);var s=a&&a.biff>=12?4:2,o=t.read_shift(s),c=t.read_shift(s),u=t.read_shift(s),h=t.read_shift(s),f=t.read_shift(2);s==2&&(t.l+=2);var p={s:o,e:c,w:u,ixfe:h,flags:f};return(a.biff>=5||!a.biff)&&(p.level=f>>8&7),p}function Wz(t,n){var a=Pe(12);a.write_shift(2,n),a.write_shift(2,n),a.write_shift(2,t.width*256),a.write_shift(2,0);var s=0;return t.hidden&&(s|=1),a.write_shift(1,s),s=t.level||0,a.write_shift(1,s),a.write_shift(2,0),a}function Uz(t){for(var n=Pe(2*t),a=0;a<t;++a)n.write_shift(2,a+1);return n}function $z(t,n,a){var s=Pe(15);return vc(s,t,n),s.write_shift(8,a,"f"),s}function Hz(t,n,a){var s=Pe(9);return vc(s,t,n),s.write_shift(2,a),s}var Vz=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=xp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(h,f){var p=[],x=bs(1);switch(f.type){case"base64":x=wr(oi(h));break;case"binary":x=wr(h);break;case"buffer":case"array":x=h;break}Hn(x,0);var j=x.read_shift(1),y=!!(j&136),S=!1,w=!1;switch(j){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+j.toString(16))}var b=0,_=521;j==2&&(b=x.read_shift(2)),x.l+=3,j!=2&&(b=x.read_shift(4)),b>1048576&&(b=1e6),j!=2&&(_=x.read_shift(2));var E=x.read_shift(2),z=f.codepage||1252;j!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(z=t[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var N=[],O={},Q=Math.min(x.length,j==2?521:_-10-(S?264:0)),U=w?32:11;x.l<Q&&x[x.l]!=13;)switch(O={},O.name=vu.utils.decode(z,x.slice(x.l,x.l+U)).replace(/[\u0000\r\n].*$/g,""),x.l+=U,O.type=String.fromCharCode(x.read_shift(1)),j!=2&&!w&&(O.offset=x.read_shift(4)),O.len=x.read_shift(1),j==2&&(O.offset=x.read_shift(2)),O.dec=x.read_shift(1),O.name.length&&N.push(O),j!=2&&(x.l+=w?13:14),O.type){case"B":(!S||O.len!=8)&&f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(x[x.l]!==13&&(x.l=_-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=_;var L=0,H=0;for(p[0]=[],H=0;H!=N.length;++H)p[0][H]=N[H].name;for(;b-- >0;){if(x[x.l]===42){x.l+=E;continue}for(++x.l,p[++L]=[],H=0,H=0;H!=N.length;++H){var A=x.slice(x.l,x.l+N[H].len);x.l+=N[H].len,Hn(A,0);var R=vu.utils.decode(z,A);switch(N[H].type){case"C":R.trim().length&&(p[L][H]=R.replace(/\s+$/,""));break;case"D":R.length===8?p[L][H]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):p[L][H]=R;break;case"F":p[L][H]=parseFloat(R.trim());break;case"+":case"I":p[L][H]=w?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":p[L][H]=!0;break;case"N":case"F":p[L][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+j.toString(16));p[L][H]="##MEMO##"+(w?parseInt(R.trim(),10):A.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(p[L][H]=+R||0);break;case"@":p[L][H]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":p[L][H]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":p[L][H]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[L][H]=-A.read_shift(-8,"f");break;case"B":if(S&&N[H].len==8){p[L][H]=A.read_shift(8,"f");break}case"G":case"P":A.l+=N[H].len;break;case"0":if(N[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[H].type)}}}if(j!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),f.DBF=N,p}function s(h,f){var p=f||{};p.dateNF||(p.dateNF="yyyymmdd");var x=Al(a(h,p),p);return x["!cols"]=p.DBF.map(function(j){return{wch:j.len,DBF:j}}),delete p.DBF,x}function o(h,f){try{return ws(s(h,f),f)}catch(p){if(f&&f.WTF)throw p}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function u(h,f){var p=f||{};if(+p.codepage>=0&&tc(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var x=Nn(),j=Fu(h,{header:1,raw:!0,cellDates:!0}),y=j[0],S=j.slice(1),w=h["!cols"]||[],b=0,_=0,E=0,z=1;for(b=0;b<y.length;++b){if(((w[b]||{}).DBF||{}).name){y[b]=w[b].DBF.name,++E;continue}if(y[b]!=null){if(++E,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(_=0;_<1024;++_)if(y.indexOf(y[b]+"_"+_)==-1){y[b]+="_"+_;break}}}}var N=pa(h["!ref"]),O=[],Q=[],U=[];for(b=0;b<=N.e.c-N.s.c;++b){var L="",H="",A=0,R=[];for(_=0;_<S.length;++_)S[_][b]!=null&&R.push(S[_][b]);if(R.length==0||y[b]==null){O[b]="?";continue}for(_=0;_<R.length;++_){switch(typeof R[_]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=R[_]instanceof Date?"D":"C";break;default:H="C"}A=Math.max(A,String(R[_]).length),L=L&&L!=H?"C":H}A>250&&(A=250),H=((w[b]||{}).DBF||{}).type,H=="C"&&w[b].DBF.len>A&&(A=w[b].DBF.len),L=="B"&&H=="N"&&(L="N",U[b]=w[b].DBF.dec,A=w[b].DBF.len),Q[b]=L=="C"||H=="N"?A:c[L]||0,z+=Q[b],O[b]=L}var G=x.next(32);for(G.write_shift(4,318902576),G.write_shift(4,S.length),G.write_shift(2,296+32*E),G.write_shift(2,z),b=0;b<4;++b)G.write_shift(4,0);for(G.write_shift(4,0|(+n[L1]||3)<<8),b=0,_=0;b<y.length;++b)if(y[b]!=null){var F=x.next(32),q=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,q,"sbcs"),F.write_shift(1,O[b]=="?"?"C":O[b],"sbcs"),F.write_shift(4,_),F.write_shift(1,Q[b]||c[O[b]]||0),F.write_shift(1,U[b]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),_+=Q[b]||c[O[b]]||0}var ee=x.next(264);for(ee.write_shift(4,13),b=0;b<65;++b)ee.write_shift(4,0);for(b=0;b<S.length;++b){var me=x.next(z);for(me.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(O[_]){case"L":me.write_shift(1,S[b][_]==null?63:S[b][_]?84:70);break;case"B":me.write_shift(8,S[b][_]||0,"f");break;case"N":var W="0";for(typeof S[b][_]=="number"&&(W=S[b][_].toFixed(U[_]||0)),E=0;E<Q[_]-W.length;++E)me.write_shift(1,32);me.write_shift(1,W,"sbcs");break;case"D":S[b][_]?(me.write_shift(4,("0000"+S[b][_].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(S[b][_].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+S[b][_].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var J=String(S[b][_]!=null?S[b][_]:"").slice(0,Q[_]);for(me.write_shift(1,J,"sbcs"),E=0;E<Q[_]-J.length;++E)me.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:o,to_sheet:s,from_sheet:u}})(),Zz=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+ln(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(y,S){var w=t[S];return typeof w=="number"?Ly(w):w},s=function(y,S,w){var b=S.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?y:Ly(b)};t["|"]=254;function o(y,S){switch(S.type){case"base64":return c(oi(y),S);case"binary":return c(y,S);case"buffer":return c(Vt&&Buffer.isBuffer(y)?y.toString("binary"):mc(y),S);case"array":return c($u(y),S)}throw new Error("Unrecognized type "+S.type)}function c(y,S){var w=y.split(/[\n\r]+/),b=-1,_=-1,E=0,z=0,N=[],O=[],Q=null,U={},L=[],H=[],A=[],R=0,G;for(+S.codepage>=0&&tc(+S.codepage);E!==w.length;++E){R=0;var F=w[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(n,a),q=F.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),ee=q[0],me;if(F.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&O.push(F.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,J=!1,M=!1,V=!1,ne=-1,P=-1;for(z=1;z<q.length;++z)switch(q[z].charAt(0)){case"A":break;case"X":_=parseInt(q[z].slice(1))-1,J=!0;break;case"Y":for(b=parseInt(q[z].slice(1))-1,J||(_=0),G=N.length;G<=b;++G)N[G]=[];break;case"K":me=q[z].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(ii(me))?isNaN(nc(me).getDate())||(me=vn(me)):(me=ii(me),Q!==null&&q1(Q)&&(me=Q1(me))),W=!0;break;case"E":V=!0;var T=HC(q[z].slice(1),{r:b,c:_});N[b][_]=[N[b][_],T];break;case"S":M=!0,N[b][_]=[N[b][_],"S5S"];break;case"G":break;case"R":ne=parseInt(q[z].slice(1))-1;break;case"C":P=parseInt(q[z].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}if(W&&(N[b][_]&&N[b][_].length==2?N[b][_][0]=me:N[b][_]=me,Q=null),M){if(V)throw new Error("SYLK shared formula cannot have own formula");var C=ne>-1&&N[ne][P];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");N[b][_][1]=VC(C[1],{r:b-ne,c:_-P})}break;case"F":var k=0;for(z=1;z<q.length;++z)switch(q[z].charAt(0)){case"X":_=parseInt(q[z].slice(1))-1,++k;break;case"Y":for(b=parseInt(q[z].slice(1))-1,G=N.length;G<=b;++G)N[G]=[];break;case"M":R=parseInt(q[z].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=O[parseInt(q[z].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=q[z].slice(1).split(" "),G=parseInt(A[0],10);G<=parseInt(A[1],10);++G)R=parseInt(A[2],10),H[G-1]=R===0?{hidden:!0}:{wch:R},Np(H[G-1]);break;case"C":_=parseInt(q[z].slice(1))-1,H[_]||(H[_]={});break;case"R":b=parseInt(q[z].slice(1))-1,L[b]||(L[b]={}),R>0?(L[b].hpt=R,L[b].hpx=Pj(R)):R===0&&(L[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}k<1&&(Q=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}}return L.length>0&&(U["!rows"]=L),H.length>0&&(U["!cols"]=H),S&&S.sheetRows&&(N=N.slice(0,S.sheetRows)),[N,U]}function u(y,S){var w=o(y,S),b=w[0],_=w[1],E=Al(b,S);return ln(_).forEach(function(z){E[z]=_[z]}),E}function h(y,S){return ws(u(y,S),S)}function f(y,S,w,b){var _="C;Y"+(w+1)+";X"+(b+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+Ep(y.f,{r:w,c:b}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function p(y,S){S.forEach(function(w,b){var _="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Tu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Nu(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function x(y,S){S.forEach(function(w,b){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*Au(w.hpx)+";"),_.length>2&&y.push(_+"R"+(b+1))})}function j(y,S){var w=["ID;PWXL;N;E"],b=[],_=pa(y["!ref"]),E,z=Array.isArray(y),N=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&p(w,y["!cols"]),y["!rows"]&&x(w,y["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var O=_.s.r;O<=_.e.r;++O)for(var Q=_.s.c;Q<=_.e.c;++Q){var U=ea({r:O,c:Q});E=z?(y[O]||[])[Q]:y[U],!(!E||E.v==null&&(!E.f||E.F))&&b.push(f(E,y,O,Q))}return w.join(N)+N+b.join(N)+N+"E"+N}return{to_workbook:h,to_sheet:u,from_sheet:j}})(),Gz=(function(){function t(c,u){switch(u.type){case"base64":return n(oi(c),u);case"binary":return n(c,u);case"buffer":return n(Vt&&Buffer.isBuffer(c)?c.toString("binary"):mc(c),u);case"array":return n($u(c),u)}throw new Error("Unrecognized type "+u.type)}function n(c,u){for(var h=c.split(`
`),f=-1,p=-1,x=0,j=[];x!==h.length;++x){if(h[x].trim()==="BOT"){j[++f]=[],p=0;continue}if(!(f<0)){var y=h[x].trim().split(","),S=y[0],w=y[1];++x;for(var b=h[x]||"";(b.match(/["]/g)||[]).length&1&&x<h.length-1;)b+=`
`+h[++x];switch(b=b.trim(),+S){case-1:if(b==="BOT"){j[++f]=[],p=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?j[f][p]=!0:b==="FALSE"?j[f][p]=!1:isNaN(ii(w))?isNaN(nc(w).getDate())?j[f][p]=w:j[f][p]=vn(w):j[f][p]=ii(w),++p;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),j[f][p++]=b!==""?b:null;break}if(b==="EOD")break}}return u&&u.sheetRows&&(j=j.slice(0,u.sheetRows)),j}function a(c,u){return Al(t(c,u),u)}function s(c,u){return ws(a(c,u),u)}var o=(function(){var c=function(f,p,x,j,y){f.push(p),f.push(x+","+j),f.push('"'+y.replace(/"/g,'""')+'"')},u=function(f,p,x,j){f.push(p+","+x),f.push(p==1?'"'+j.replace(/"/g,'""')+'"':j)};return function(f){var p=[],x=pa(f["!ref"]),j,y=Array.isArray(f);c(p,"TABLE",0,1,"sheetjs"),c(p,"VECTORS",0,x.e.r-x.s.r+1,""),c(p,"TUPLES",0,x.e.c-x.s.c+1,""),c(p,"DATA",0,0,"");for(var S=x.s.r;S<=x.e.r;++S){u(p,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var b=ea({r:S,c:w});if(j=y?(f[S]||[])[w]:f[b],!j){u(p,1,0,"");continue}switch(j.t){case"n":var _=j.w;!_&&j.v!=null&&(_=j.v),_==null?j.f&&!j.F?u(p,1,0,"="+j.f):u(p,1,0,""):u(p,0,_,"V");break;case"b":u(p,0,j.v?1:0,j.v?"TRUE":"FALSE");break;case"s":u(p,1,0,isNaN(j.v)?j.v:'="'+j.v+'"');break;case"d":j.w||(j.w=Zi(j.z||ka[14],An(vn(j.v)))),u(p,0,j.w,"V");break;default:u(p,1,0,"")}}}u(p,-1,0,"EOD");var E=`\r
`,z=p.join(E);return z}})();return{to_workbook:s,to_sheet:a,from_sheet:o}})(),Dj=(function(){function t(j){return j.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(j){return j.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(j,y){for(var S=j.split(`
`),w=-1,b=-1,_=0,E=[];_!==S.length;++_){var z=S[_].trim().split(":");if(z[0]==="cell"){var N=Ga(z[1]);if(E.length<=N.r)for(w=E.length;w<=N.r;++w)E[w]||(E[w]=[]);switch(w=N.r,b=N.c,z[2]){case"t":E[w][b]=t(z[3]);break;case"v":E[w][b]=+z[3];break;case"vtf":var O=z[z.length-1];case"vtc":z[3]==="nl"?E[w][b]=!!+z[4]:E[w][b]=+z[4],z[2]=="vtf"&&(E[w][b]=[E[w][b],O])}}}return y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}function s(j,y){return Al(a(j,y),y)}function o(j,y){return ws(s(j,y),y)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function p(j){if(!j||!j["!ref"])return"";for(var y=[],S=[],w,b="",_=Gn(j["!ref"]),E=Array.isArray(j),z=_.s.r;z<=_.e.r;++z)for(var N=_.s.c;N<=_.e.c;++N)if(b=ea({r:z,c:N}),w=E?(j[z]||[])[N]:j[b],!(!w||w.v==null||w.t==="z")){switch(S=["cell",b,"t"],w.t){case"s":case"str":S.push(n(w.v));break;case"n":w.f?(S[2]="vtf",S[3]="n",S[4]=w.v,S[5]=n(w.f)):(S[2]="v",S[3]=w.v);break;case"b":S[2]="vt"+(w.f?"f":"c"),S[3]="nl",S[4]=w.v?"1":"0",S[5]=n(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var O=An(vn(w.v));S[2]="vtc",S[3]="nd",S[4]=""+O,S[5]=w.w||Zi(w.z||ka[14],O);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function x(j){return[c,u,h,u,p(j),f].join(`
`)}return{to_workbook:o,to_sheet:s,from_sheet:x}})(),Kz=(function(){function t(x,j,y,S,w){w.raw?j[y][S]=x:x===""||(x==="TRUE"?j[y][S]=!0:x==="FALSE"?j[y][S]=!1:isNaN(ii(x))?isNaN(nc(x).getDate())?j[y][S]=x:j[y][S]=vn(x):j[y][S]=ii(x))}function n(x,j){var y=j||{},S=[];if(!x||x.length===0)return S;for(var w=x.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var _=10,E=0,z=0;z<=b;++z)E=w[z].indexOf(" "),E==-1?E=w[z].length:E++,_=Math.max(_,E);for(z=0;z<=b;++z){S[z]=[];var N=0;for(t(w[z].slice(0,_).trim(),S,z,N,y),N=1;N<=(w[z].length-_)/10+1;++N)t(w[z].slice(_+(N-1)*10,_+N*10).trim(),S,z,N,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function o(x){for(var j={},y=!1,S=0,w=0;S<x.length;++S)(w=x.charCodeAt(S))==34?y=!y:!y&&w in a&&(j[w]=(j[w]||0)+1);w=[];for(S in j)Object.prototype.hasOwnProperty.call(j,S)&&w.push([j[S],S]);if(!w.length){j=s;for(S in j)Object.prototype.hasOwnProperty.call(j,S)&&w.push([j[S],S])}return w.sort(function(b,_){return b[0]-_[0]||s[b[1]]-s[_[1]]}),a[w.pop()[1]]||44}function c(x,j){var y=j||{},S="",w=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(S=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(S=x.charAt(4),x=x.slice(6)):S=o(x.slice(0,1024)):y&&y.FS?S=y.FS:S=o(x.slice(0,1024));var _=0,E=0,z=0,N=0,O=0,Q=S.charCodeAt(0),U=!1,L=0,H=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var A=y.dateNF!=null?dk(y.dateNF):null;function R(){var G=x.slice(N,O),F={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)F.t="z";else if(y.raw)F.t="s",F.v=G;else if(G.trim().length===0)F.t="s",F.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(F.t="s",F.v=G.slice(2,-1).replace(/""/g,'"')):ZC(G)?(F.t="n",F.f=G.slice(1)):(F.t="s",F.v=G);else if(G=="TRUE")F.t="b",F.v=!0;else if(G=="FALSE")F.t="b",F.v=!1;else if(!isNaN(z=ii(G)))F.t="n",y.cellText!==!1&&(F.w=G),F.v=z;else if(!isNaN(nc(G).getDate())||A&&G.match(A)){F.z=y.dateNF||ka[14];var q=0;A&&G.match(A)&&(G=uk(G,y.dateNF,G.match(A)||[]),q=1),y.cellDates?(F.t="d",F.v=vn(G,q)):(F.t="n",F.v=An(vn(G,q))),y.cellText!==!1&&(F.w=Zi(F.z,F.v instanceof Date?An(F.v):F.v)),y.cellNF||delete F.z}else F.t="s",F.v=G;if(F.t=="z"||(y.dense?(w[_]||(w[_]=[]),w[_][E]=F):w[ea({c:E,r:_})]=F),N=O+1,H=x.charCodeAt(N),b.e.c<E&&(b.e.c=E),b.e.r<_&&(b.e.r=_),L==Q)++E;else if(E=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;O<x.length;++O)switch(L=x.charCodeAt(O)){case 34:H===34&&(U=!U);break;case Q:case 10:case 13:if(!U&&R())break e;break}return O-N>0&&R(),w["!ref"]=La(b),w}function u(x,j){return!(j&&j.PRN)||j.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?c(x,j):Al(n(x,j),j)}function h(x,j){var y="",S=j.type=="string"?[0,0,0,0]:sA(x,j);switch(j.type){case"base64":y=oi(x);break;case"binary":y=x;break;case"buffer":j.codepage==65001?y=x.toString("utf8"):j.codepage&&typeof vu<"u"||(y=Vt&&Buffer.isBuffer(x)?x.toString("binary"):mc(x));break;case"array":y=$u(x);break;case"string":y=x;break;default:throw new Error("Unrecognized type "+j.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Zo(y.slice(3)):j.type!="string"&&j.type!="buffer"&&j.codepage==65001?y=Zo(y):j.type=="binary"&&typeof vu<"u",y.slice(0,19)=="socialcalc:version:"?Dj.to_sheet(j.type=="string"?y:Zo(y),j):u(y,j)}function f(x,j){return ws(h(x,j),j)}function p(x){for(var j=[],y=pa(x["!ref"]),S,w=Array.isArray(x),b=y.s.r;b<=y.e.r;++b){for(var _=[],E=y.s.c;E<=y.e.c;++E){var z=ea({r:b,c:E});if(S=w?(x[b]||[])[E]:x[z],!S||S.v==null){_.push("          ");continue}for(var N=(S.w||(ci(S),S.w)||"").slice(0,10);N.length<10;)N+=" ";_.push(N+(E===0?" ":""))}j.push(_.join(""))}return j.join(`
`)}return{to_workbook:f,to_sheet:h,from_sheet:p}})(),mv=(function(){function t(T,C,k){if(T){Hn(T,T.l||0);for(var I=k.Enum||ne;T.l<T.length;){var D=T.read_shift(2),de=I[D]||I[65535],he=T.read_shift(2),ie=T.l+he,ve=de.f&&de.f(T,he,k);if(T.l=ie,C(ve,de,D))return}}}function n(T,C){switch(C.type){case"base64":return a(wr(oi(T)),C);case"binary":return a(wr(T),C);case"buffer":case"array":return a(T,C)}throw"Unsupported type "+C.type}function a(T,C){if(!T)return T;var k=C||{},I=k.dense?[]:{},D="Sheet1",de="",he=0,ie={},ve=[],je=[],fe={s:{r:0,c:0},e:{r:0,c:0}},_e=k.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)k.Enum=ne,t(T,function(oe,Ue,Qe){switch(Qe){case 0:k.vers=oe,oe>=4096&&(k.qpro=!0);break;case 6:fe=oe;break;case 204:oe&&(de=oe);break;case 222:de=oe;break;case 15:case 51:k.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=k.dateNF||ka[14],k.cellDates&&(oe[1].t="d",oe[1].v=Q1(oe[1].v))),k.qpro&&oe[3]>he&&(I["!ref"]=La(fe),ie[D]=I,ve.push(D),I=k.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},he=oe[3],D=de||"Sheet"+(he+1),de="");var lt=k.dense?(I[oe[0].r]||[])[oe[0].c]:I[ea(oe[0])];if(lt){lt.t=oe[1].t,lt.v=oe[1].v,oe[1].z!=null&&(lt.z=oe[1].z),oe[1].f!=null&&(lt.f=oe[1].f);break}k.dense?(I[oe[0].r]||(I[oe[0].r]=[]),I[oe[0].r][oe[0].c]=oe[1]):I[ea(oe[0])]=oe[1];break}},k);else if(T[2]==26||T[2]==14)k.Enum=P,T[2]==14&&(k.qpro=!0,T.l=0),t(T,function(oe,Ue,Qe){switch(Qe){case 204:D=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>he&&(I["!ref"]=La(fe),ie[D]=I,ve.push(D),I=k.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},he=oe[3],D="Sheet"+(he+1)),_e>0&&oe[0].r>=_e)break;k.dense?(I[oe[0].r]||(I[oe[0].r]=[]),I[oe[0].r][oe[0].c]=oe[1]):I[ea(oe[0])]=oe[1],fe.e.c<oe[0].c&&(fe.e.c=oe[0].c),fe.e.r<oe[0].r&&(fe.e.r=oe[0].r);break;case 27:oe[14e3]&&(je[oe[14e3][0]]=oe[14e3][1]);break;case 1537:je[oe[0]]=oe[1],oe[0]==he&&(D=oe[1]);break}},k);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(I["!ref"]=La(fe),ie[de||D]=I,ve.push(de||D),!je.length)return{SheetNames:ve,Sheets:ie};for(var Se={},Ve=[],be=0;be<je.length;++be)ie[ve[be]]?(Ve.push(je[be]||ve[be]),Se[je[be]]=ie[je[be]]||ie[ve[be]]):(Ve.push(je[be]),Se[je[be]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Se}}function s(T,C){var k=C||{};if(+k.codepage>=0&&tc(+k.codepage),k.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Nn(),D=pa(T["!ref"]),de=Array.isArray(T),he=[];Xe(I,0,c(1030)),Xe(I,6,f(D));for(var ie=Math.min(D.e.r,8191),ve=D.s.r;ve<=ie;++ve)for(var je=sn(ve),fe=D.s.c;fe<=D.e.c;++fe){ve===D.s.r&&(he[fe]=fn(fe));var _e=he[fe]+je,Se=de?(T[ve]||[])[fe]:T[_e];if(!(!Se||Se.t=="z"))if(Se.t=="n")(Se.v|0)==Se.v&&Se.v>=-32768&&Se.v<=32767?Xe(I,13,S(ve,fe,Se.v)):Xe(I,14,b(ve,fe,Se.v));else{var Ve=ci(Se);Xe(I,15,j(ve,fe,Ve.slice(0,239)))}}return Xe(I,1),I.end()}function o(T,C){var k=C||{};if(+k.codepage>=0&&tc(+k.codepage),k.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Nn();Xe(I,0,u(T));for(var D=0,de=0;D<T.SheetNames.length;++D)(T.Sheets[T.SheetNames[D]]||{})["!ref"]&&Xe(I,27,V(T.SheetNames[D],de++));var he=0;for(D=0;D<T.SheetNames.length;++D){var ie=T.Sheets[T.SheetNames[D]];if(!(!ie||!ie["!ref"])){for(var ve=pa(ie["!ref"]),je=Array.isArray(ie),fe=[],_e=Math.min(ve.e.r,8191),Se=ve.s.r;Se<=_e;++Se)for(var Ve=sn(Se),be=ve.s.c;be<=ve.e.c;++be){Se===ve.s.r&&(fe[be]=fn(be));var oe=fe[be]+Ve,Ue=je?(ie[Se]||[])[be]:ie[oe];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Xe(I,23,R(Se,be,he,Ue.v));else{var Qe=ci(Ue);Xe(I,22,L(Se,be,he,Qe.slice(0,239)))}}++he}}return Xe(I,1),I.end()}function c(T){var C=Pe(2);return C.write_shift(2,T),C}function u(T){var C=Pe(26);C.write_shift(2,4096),C.write_shift(2,4),C.write_shift(4,0);for(var k=0,I=0,D=0,de=0;de<T.SheetNames.length;++de){var he=T.SheetNames[de],ie=T.Sheets[he];if(!(!ie||!ie["!ref"])){++D;var ve=Gn(ie["!ref"]);k<ve.e.r&&(k=ve.e.r),I<ve.e.c&&(I=ve.e.c)}}return k>8191&&(k=8191),C.write_shift(2,k),C.write_shift(1,D),C.write_shift(1,I),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(1,1),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(4,0),C}function h(T,C,k){var I={s:{c:0,r:0},e:{c:0,r:0}};return C==8&&k.qpro?(I.s.c=T.read_shift(1),T.l++,I.s.r=T.read_shift(2),I.e.c=T.read_shift(1),T.l++,I.e.r=T.read_shift(2),I):(I.s.c=T.read_shift(2),I.s.r=T.read_shift(2),C==12&&k.qpro&&(T.l+=2),I.e.c=T.read_shift(2),I.e.r=T.read_shift(2),C==12&&k.qpro&&(T.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function f(T){var C=Pe(8);return C.write_shift(2,T.s.c),C.write_shift(2,T.s.r),C.write_shift(2,T.e.c),C.write_shift(2,T.e.r),C}function p(T,C,k){var I=[{c:0,r:0},{t:"n",v:0},0,0];return k.qpro&&k.vers!=20768?(I[0].c=T.read_shift(1),I[3]=T.read_shift(1),I[0].r=T.read_shift(2),T.l+=2):(I[2]=T.read_shift(1),I[0].c=T.read_shift(2),I[0].r=T.read_shift(2)),I}function x(T,C,k){var I=T.l+C,D=p(T,C,k);if(D[1].t="s",k.vers==20768){T.l++;var de=T.read_shift(1);return D[1].v=T.read_shift(de,"utf8"),D}return k.qpro&&T.l++,D[1].v=T.read_shift(I-T.l,"cstr"),D}function j(T,C,k){var I=Pe(7+k.length);I.write_shift(1,255),I.write_shift(2,C),I.write_shift(2,T),I.write_shift(1,39);for(var D=0;D<I.length;++D){var de=k.charCodeAt(D);I.write_shift(1,de>=128?95:de)}return I.write_shift(1,0),I}function y(T,C,k){var I=p(T,C,k);return I[1].v=T.read_shift(2,"i"),I}function S(T,C,k){var I=Pe(7);return I.write_shift(1,255),I.write_shift(2,C),I.write_shift(2,T),I.write_shift(2,k,"i"),I}function w(T,C,k){var I=p(T,C,k);return I[1].v=T.read_shift(8,"f"),I}function b(T,C,k){var I=Pe(13);return I.write_shift(1,255),I.write_shift(2,C),I.write_shift(2,T),I.write_shift(8,k,"f"),I}function _(T,C,k){var I=T.l+C,D=p(T,C,k);if(D[1].v=T.read_shift(8,"f"),k.qpro)T.l=I;else{var de=T.read_shift(2);O(T.slice(T.l,T.l+de),D),T.l+=de}return D}function E(T,C,k){var I=C&32768;return C&=-32769,C=(I?T:0)+(C>=8192?C-16384:C),(I?"":"$")+(k?fn(C):sn(C))}var z={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(T,C){Hn(T,0);for(var k=[],I=0,D="",de="",he="",ie="";T.l<T.length;){var ve=T[T.l++];switch(ve){case 0:k.push(T.read_shift(8,"f"));break;case 1:de=E(C[0].c,T.read_shift(2),!0),D=E(C[0].r,T.read_shift(2),!1),k.push(de+D);break;case 2:{var je=E(C[0].c,T.read_shift(2),!0),fe=E(C[0].r,T.read_shift(2),!1);de=E(C[0].c,T.read_shift(2),!0),D=E(C[0].r,T.read_shift(2),!1),k.push(je+fe+":"+de+D)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:k.push("("+k.pop()+")");break;case 5:k.push(T.read_shift(2));break;case 6:{for(var _e="";ve=T[T.l++];)_e+=String.fromCharCode(ve);k.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:k.push("-"+k.pop());break;case 23:k.push("+"+k.pop());break;case 22:k.push("NOT("+k.pop()+")");break;case 20:case 21:ie=k.pop(),he=k.pop(),k.push(["AND","OR"][ve-20]+"("+he+","+ie+")");break;default:if(ve<32&&N[ve])ie=k.pop(),he=k.pop(),k.push(he+N[ve]+ie);else if(z[ve]){if(I=z[ve][1],I==69&&(I=T[T.l++]),I>k.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+k.join("|")+"|");return}var Se=k.slice(-I);k.length-=I,k.push(z[ve][0]+"("+Se.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}k.length==1?C[1].f=""+k[0]:console.error("WK1 bad formula parse |"+k.join("|")+"|")}function Q(T){var C=[{c:0,r:0},{t:"n",v:0},0];return C[0].r=T.read_shift(2),C[3]=T[T.l++],C[0].c=T[T.l++],C}function U(T,C){var k=Q(T);return k[1].t="s",k[1].v=T.read_shift(C-4,"cstr"),k}function L(T,C,k,I){var D=Pe(6+I.length);D.write_shift(2,T),D.write_shift(1,k),D.write_shift(1,C),D.write_shift(1,39);for(var de=0;de<I.length;++de){var he=I.charCodeAt(de);D.write_shift(1,he>=128?95:he)}return D.write_shift(1,0),D}function H(T,C){var k=Q(T);k[1].v=T.read_shift(2);var I=k[1].v>>1;if(k[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return k[1].v=I,k}function A(T,C){var k=Q(T),I=T.read_shift(4),D=T.read_shift(4),de=T.read_shift(2);if(de==65535)return I===0&&D===3221225472?(k[1].t="e",k[1].v=15):I===0&&D===3489660928?(k[1].t="e",k[1].v=42):k[1].v=0,k;var he=de&32768;return de=(de&32767)-16446,k[1].v=(1-he*2)*(D*Math.pow(2,de+32)+I*Math.pow(2,de)),k}function R(T,C,k,I){var D=Pe(14);if(D.write_shift(2,T),D.write_shift(1,k),D.write_shift(1,C),I==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var de=0,he=0,ie=0,ve=0;return I<0&&(de=1,I=-I),he=Math.log2(I)|0,I/=Math.pow(2,he-31),ve=I>>>0,(ve&2147483648)==0&&(I/=2,++he,ve=I>>>0),I-=ve,ve|=2147483648,ve>>>=0,I*=Math.pow(2,32),ie=I>>>0,D.write_shift(4,ie),D.write_shift(4,ve),he+=16383+(de?32768:0),D.write_shift(2,he),D}function G(T,C){var k=A(T);return T.l+=C-14,k}function F(T,C){var k=Q(T),I=T.read_shift(4);return k[1].v=I>>6,k}function q(T,C){var k=Q(T),I=T.read_shift(8,"f");return k[1].v=I,k}function ee(T,C){var k=q(T);return T.l+=C-10,k}function me(T,C){return T[T.l+C-1]==0?T.read_shift(C,"cstr"):""}function W(T,C){var k=T[T.l++];k>C-1&&(k=C-1);for(var I="";I.length<k;)I+=String.fromCharCode(T[T.l++]);return I}function J(T,C,k){if(!(!k.qpro||C<21)){var I=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var D=T.read_shift(C-21,"cstr");return[I,D]}}function M(T,C){for(var k={},I=T.l+C;T.l<I;){var D=T.read_shift(2);if(D==14e3){for(k[D]=[0,""],k[D][0]=T.read_shift(2);T[T.l];)k[D][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return k}function V(T,C){var k=Pe(5+T.length);k.write_shift(2,14e3),k.write_shift(2,C);for(var I=0;I<T.length;++I){var D=T.charCodeAt(I);k[k.l++]=D>127?95:D}return k[k.l++]=0,k}var ne={0:{n:"BOF",f:Ej},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},P={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:U},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:o,to_workbook:n}})(),qz=/^\s|\s$|[\t\n\r]/;function Lj(t,n){if(!n.bookSST)return"";var a=[Ma];a[a.length]=Je("sst",null,{xmlns:Nl[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var o=t[s],c="<si>";o.r?c+=o.r:(c+="<t",o.t||(o.t=""),o.t.match(qz)&&(c+=' xml:space="preserve"'),c+=">"+Qt(o.t)+"</t>"),c+="</si>",a[a.length]=c}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function Yz(t){return[t.read_shift(4),t.read_shift(4)]}function Jz(t,n){return n||(n=Pe(8)),n.write_shift(4,t.Count),n.write_shift(4,t.Unique),n}var Xz=Uk;function Qz(t){var n=Nn();Ke(n,159,Jz(t));for(var a=0;a<t.length;++a)Ke(n,19,Xz(t[a]));return Ke(n,160),n.end()}function eC(t){for(var n=[],a=t.split(""),s=0;s<a.length;++s)n[s]=a[s].charCodeAt(0);return n}function Mj(t){var n=0,a,s=eC(t),o=s.length+1,c,u,h,f,p;for(a=bs(o),a[0]=s.length,c=1;c!=o;++c)a[c]=s[c-1];for(c=o-1;c>=0;--c)u=a[c],h=(n&16384)===0?0:1,f=n<<1&32767,p=h|f,n=p^u;return n^52811}var tC=(function(){function t(o,c){switch(c.type){case"base64":return n(oi(o),c);case"binary":return n(o,c);case"buffer":return n(Vt&&Buffer.isBuffer(o)?o.toString("binary"):mc(o),c);case"array":return n($u(o),c)}throw new Error("Unrecognized type "+c.type)}function n(o,c){var u=c||{},h=u.dense?[]:{},f=o.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(x,j){Array.isArray(h)&&(h[j]=[]);for(var y=/\\\w+\b/g,S=0,w,b=-1;w=y.exec(x);){switch(w[0]){case"\\cell":var _=x.slice(S,y.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++b,_.length){var E={v:_,t:"s"};Array.isArray(h)?h[j][b]=E:h[ea({r:j,c:b})]=E}break}S=y.lastIndex}b>p.e.c&&(p.e.c=b)}),h["!ref"]=La(p),h}function a(o,c){return ws(t(o,c),c)}function s(o){for(var c=["{\\rtf1\\ansi"],u=pa(o["!ref"]),h,f=Array.isArray(o),p=u.s.r;p<=u.e.r;++p){c.push("\\trowd\\trautofit1");for(var x=u.s.c;x<=u.e.c;++x)c.push("\\cellx"+(x+1));for(c.push("\\pard\\intbl"),x=u.s.c;x<=u.e.c;++x){var j=ea({r:p,c:x});h=f?(o[p]||[])[x]:o[j],!(!h||h.v==null&&(!h.f||h.F))&&(c.push(" "+(h.w||(ci(h),h.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:a,to_sheet:t,from_sheet:s}})();function pv(t){for(var n=0,a=1;n!=3;++n)a=a*256+(t[n]>255?255:t[n]<0?0:t[n]);return a.toString(16).toUpperCase().slice(1)}var aC=6,si=aC;function Tu(t){return Math.floor((t+Math.round(128/si)/256)*si)}function Nu(t){return Math.floor((t-5)/si*100+.5)/100}function tp(t){return Math.round((t*si+5)/si*256)/256}function Np(t){t.width?(t.wpx=Tu(t.width),t.wch=Nu(t.wpx),t.MDW=si):t.wpx?(t.wch=Nu(t.wpx),t.width=tp(t.wch),t.MDW=si):typeof t.wch=="number"&&(t.width=tp(t.wch),t.wpx=Tu(t.width),t.MDW=si),t.customWidth&&delete t.customWidth}var nC=96,Ij=nC;function Au(t){return t*96/Ij}function Pj(t){return t*Ij/96}function rC(t){var n=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&(n[n.length]=Je("numFmt",null,{numFmtId:s,formatCode:Qt(t[s])}))}),n.length===1?"":(n[n.length]="</numFmts>",n[0]=Je("numFmts",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function iC(t){var n=[];return n[n.length]=Je("cellXfs",null),t.forEach(function(a){n[n.length]=Je("xf",null,a)}),n[n.length]="</cellXfs>",n.length===2?"":(n[0]=Je("cellXfs",null,{count:n.length-2}).replace("/>",">"),n.join(""))}function Wj(t,n){var a=[Ma,Je("styleSheet",null,{xmlns:Nl[0],"xmlns:vt":Za.vt})],s;return t.SSF&&(s=rC(t.SSF))!=null&&(a[a.length]=s),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=iC(n.cellXfs))&&(a[a.length]=s),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function sC(t,n){var a=t.read_shift(2),s=hn(t);return[a,s]}function lC(t,n,a){a||(a=Pe(6+4*n.length)),a.write_shift(2,t),Ka(n,a);var s=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),s}function oC(t,n,a){var s={};s.sz=t.read_shift(2)/20;var o=qk(t);o.fItalic&&(s.italic=1),o.fCondense&&(s.condense=1),o.fExtend&&(s.extend=1),o.fShadow&&(s.shadow=1),o.fOutline&&(s.outline=1),o.fStrikeout&&(s.strike=1);var c=t.read_shift(2);switch(c===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var u=t.read_shift(1);u!=0&&(s.underline=u);var h=t.read_shift(1);h>0&&(s.family=h);var f=t.read_shift(1);switch(f>0&&(s.charset=f),t.l++,s.color=Kk(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=hn(t),s}function cC(t,n){n||(n=Pe(153)),n.write_shift(2,t.sz*20),Yk(t,n),n.write_shift(2,t.bold?700:400);var a=0;t.vertAlign=="superscript"?a=1:t.vertAlign=="subscript"&&(a=2),n.write_shift(2,a),n.write_shift(1,t.underline||0),n.write_shift(1,t.family||0),n.write_shift(1,t.charset||0),n.write_shift(1,0),zu(t.color,n);var s=0;return s=2,n.write_shift(1,s),Ka(t.name,n),n.length>n.l?n.slice(0,n.l):n}var dC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cm,uC=Lr;function gv(t,n){n||(n=Pe(84)),cm||(cm=xp(dC));var a=cm[t.patternType];a==null&&(a=40),n.write_shift(4,a);var s=0;if(a!=40)for(zu({auto:1},n),zu({auto:1},n);s<12;++s)n.write_shift(4,0);else{for(;s<4;++s)n.write_shift(4,0);for(;s<12;++s)n.write_shift(4,0)}return n.length>n.l?n.slice(0,n.l):n}function fC(t,n){var a=t.l+n,s=t.read_shift(2),o=t.read_shift(2);return t.l=a,{ixfe:s,numFmtId:o}}function Uj(t,n,a){a||(a=Pe(16)),a.write_shift(2,n||0),a.write_shift(2,t.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var s=0;return a.write_shift(1,s),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Fo(t,n){return n||(n=Pe(10)),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(4,0),n}var hC=Lr;function mC(t,n){return n||(n=Pe(51)),n.write_shift(1,0),Fo(null,n),Fo(null,n),Fo(null,n),Fo(null,n),Fo(null,n),n.length>n.l?n.slice(0,n.l):n}function pC(t,n){return n||(n=Pe(52)),n.write_shift(4,t.xfId),n.write_shift(2,1),n.write_shift(1,0),n.write_shift(1,0),ku(t.name||"",n),n.length>n.l?n.slice(0,n.l):n}function gC(t,n,a){var s=Pe(2052);return s.write_shift(4,t),ku(n,s),ku(a,s),s.length>s.l?s.slice(0,s.l):s}function xC(t,n){if(n){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)n[o]!=null&&++a}),a!=0&&(Ke(t,615,zr(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)n[o]!=null&&Ke(t,44,lC(o,n[o]))}),Ke(t,616))}}function yC(t){var n=1;Ke(t,611,zr(n)),Ke(t,43,cC({sz:12,color:{theme:1},name:"Calibri",family:2})),Ke(t,612)}function vC(t){var n=2;Ke(t,603,zr(n)),Ke(t,45,gv({patternType:"none"})),Ke(t,45,gv({patternType:"gray125"})),Ke(t,604)}function jC(t){var n=1;Ke(t,613,zr(n)),Ke(t,46,mC()),Ke(t,614)}function bC(t){var n=1;Ke(t,626,zr(n)),Ke(t,47,Uj({numFmtId:0},65535)),Ke(t,627)}function _C(t,n){Ke(t,617,zr(n.length)),n.forEach(function(a){Ke(t,47,Uj(a,0))}),Ke(t,618)}function SC(t){var n=1;Ke(t,619,zr(n)),Ke(t,48,pC({xfId:0,name:"Normal"})),Ke(t,620)}function wC(t){var n=0;Ke(t,505,zr(n)),Ke(t,506)}function kC(t){var n=0;Ke(t,508,gC(n,"TableStyleMedium9","PivotStyleMedium4")),Ke(t,509)}function zC(t,n){var a=Nn();return Ke(a,278),xC(a,t.SSF),yC(a),vC(a),jC(a),bC(a),_C(a,n.cellXfs),SC(a),wC(a),kC(a),Ke(a,279),a.end()}function $j(t,n){if(n&&n.themeXLSX)return n.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var a=[Ma];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function CC(t,n){return{flags:t.read_shift(4),version:t.read_shift(4),name:hn(t)}}function TC(t){var n=Pe(12+2*t.name.length);return n.write_shift(4,t.flags),n.write_shift(4,t.version),Ka(t.name,n),n.slice(0,n.l)}function NC(t){for(var n=[],a=t.read_shift(4);a-- >0;)n.push([t.read_shift(4),t.read_shift(4)]);return n}function AC(t){var n=Pe(4+8*t.length);n.write_shift(4,t.length);for(var a=0;a<t.length;++a)n.write_shift(4,t[a][0]),n.write_shift(4,t[a][1]);return n}function EC(t,n){var a=Pe(8+2*n.length);return a.write_shift(4,t),Ka(n,a),a.slice(0,a.l)}function FC(t){return t.l+=4,t.read_shift(4)!=0}function RC(t,n){var a=Pe(8);return a.write_shift(4,t),a.write_shift(4,1),a}function BC(){var t=Nn();return Ke(t,332),Ke(t,334,zr(1)),Ke(t,335,TC({name:"XLDAPR",version:12e4,flags:3496657072})),Ke(t,336),Ke(t,339,EC(1,"XLDAPR")),Ke(t,52),Ke(t,35,zr(514)),Ke(t,4096,zr(0)),Ke(t,4097,lr(1)),Ke(t,36),Ke(t,53),Ke(t,340),Ke(t,337,RC(1)),Ke(t,51,AC([[1,0]])),Ke(t,338),Ke(t,333),t.end()}function Hj(){var t=[Ma];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function OC(t){var n={};n.i=t.read_shift(4);var a={};a.r=t.read_shift(4),a.c=t.read_shift(4),n.r=ea(a);var s=t.read_shift(1);return s&2&&(n.l="1"),s&8&&(n.a="1"),n}var yl=1024;function Vj(t,n){for(var a=[21600,21600],s=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),o=[Je("xml",null,{"xmlns:v":Vn.v,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:mv":Vn.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:s})];yl<t*1e3;)yl+=1e3;return n.forEach(function(c){var u=Ga(c[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var f=h.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=Je("v:fill",f,h),x={on:"t",obscured:"t"};++yl,o=o.concat(["<v:shape"+ic({id:"_x0000_s"+yl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,Je("v:shadow",null,x),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rn("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),rn("x:AutoFill","False"),rn("x:Row",String(u.r)),rn("x:Column",String(u.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function Zj(t){var n=[Ma,Je("comments",null,{xmlns:Nl[0]})],a=[];return n.push("<authors>"),t.forEach(function(s){s[1].forEach(function(o){var c=Qt(o.a);a.indexOf(c)==-1&&(a.push(c),n.push("<author>"+c+"</author>")),o.T&&o.ID&&a.indexOf("tc="+o.ID)==-1&&(a.push("tc="+o.ID),n.push("<author>tc="+o.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),n.push("<author>SheetJ5</author>")),n.push("</authors>"),n.push("<commentList>"),t.forEach(function(s){var o=0,c=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?o=a.indexOf("tc="+s[1][0].ID):s[1].forEach(function(f){f.a&&(o=a.indexOf(Qt(f.a))),c.push(f.t||"")}),n.push('<comment ref="'+s[0]+'" authorId="'+o+'"><text>'),c.length<=1)n.push(rn("t",Qt(c[0]||"")));else{for(var u=`Comment:
    `+c[0]+`
`,h=1;h<c.length;++h)u+=`Reply:
    `+c[h]+`
`;n.push(rn("t",Qt(u)))}n.push("</text></comment>")}),n.push("</commentList>"),n.length>2&&(n[n.length]="</comments>",n[1]=n[1].replace("/>",">")),n.join("")}function DC(t,n,a){var s=[Ma,Je("ThreadedComments",null,{xmlns:Za.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(o){var c="";(o[1]||[]).forEach(function(u,h){if(!u.T){delete u.ID;return}u.a&&n.indexOf(u.a)==-1&&n.push(u.a);var f={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};h==0?c=f.id:f.parentId=c,u.ID=f.id,u.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+n.indexOf(u.a)).slice(-12)+"}"),s.push(Je("threadedComment",rn("text",u.t||""),f))})}),s.push("</ThreadedComments>"),s.join("")}function LC(t){var n=[Ma,Je("personList",null,{xmlns:Za.TCMNT,"xmlns:x":Nl[0]}).replace(/[\/]>/,">")];return t.forEach(function(a,s){n.push(Je("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:a,providerId:"None"}))}),n.push("</personList>"),n.join("")}function MC(t){var n={};n.iauthor=t.read_shift(4);var a=Ts(t);return n.rfx=a.s,n.ref=ea(a.s),t.l+=16,n}function IC(t,n){return n==null&&(n=Pe(36)),n.write_shift(4,t[1].iauthor),El(t[0],n),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n}var PC=hn;function WC(t){return Ka(t.slice(0,54))}function UC(t){var n=Nn(),a=[];return Ke(n,628),Ke(n,630),t.forEach(function(s){s[1].forEach(function(o){a.indexOf(o.a)>-1||(a.push(o.a.slice(0,54)),Ke(n,632,WC(o.a)))})}),Ke(n,631),Ke(n,633),t.forEach(function(s){s[1].forEach(function(o){o.iauthor=a.indexOf(o.a);var c={s:Ga(s[0]),e:Ga(s[0])};Ke(n,635,IC([c,o])),o.t&&o.t.length>0&&Ke(n,637,Hk(o)),Ke(n,636),delete o.iauthor})}),Ke(n,634),Ke(n,629),n.end()}function $C(t,n){n.FullPaths.forEach(function(a,s){if(s!=0){var o=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&ia.utils.cfb_add(t,o,n.FileIndex[s].content)}})}var Gj=["xlsb","xlsm","xlam","biff8","xla"],HC=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function a(s,o,c,u){var h=!1,f=!1;c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1)),u.length==0?h=!0:u.charAt(0)=="["&&(h=!0,u=u.slice(1,-1));var p=c.length>0?parseInt(c,10)|0:0,x=u.length>0?parseInt(u,10)|0:0;return h?x+=n.c:--x,f?p+=n.r:--p,o+(h?"":"$")+fn(x)+(f?"":"$")+sn(p)}return function(o,c){return n=c,o.replace(t,a)}})(),Ap=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ep=(function(){return function(n,a){return n.replace(Ap,function(s,o,c,u,h,f){var p=wp(u)-(c?0:a.c),x=Sp(f)-(h?0:a.r),j=x==0?"":h?x+1:"["+x+"]",y=p==0?"":c?p+1:"["+p+"]";return o+"R"+j+"C"+y})}})();function VC(t,n){return t.replace(Ap,function(a,s,o,c,u,h){return s+(o=="$"?o+c:fn(wp(c)+n.c))+(u=="$"?u+h:sn(Sp(h)+n.r))})}function ZC(t){return t.length!=1}function Da(t){t.l+=1}function Gi(t,n){var a=t.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function Kj(t,n,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return qj(t);a.biff==12&&(s=4)}var o=t.read_shift(s),c=t.read_shift(s),u=Gi(t),h=Gi(t);return{s:{r:o,c:u[0],cRel:u[1],rRel:u[2]},e:{r:c,c:h[0],cRel:h[1],rRel:h[2]}}}function qj(t){var n=Gi(t),a=Gi(t),s=t.read_shift(1),o=t.read_shift(1);return{s:{r:n[0],c:s,cRel:n[1],rRel:n[2]},e:{r:a[0],c:o,cRel:a[1],rRel:a[2]}}}function GC(t,n,a){if(a.biff<8)return qj(t);var s=t.read_shift(a.biff==12?4:2),o=t.read_shift(a.biff==12?4:2),c=Gi(t),u=Gi(t);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Yj(t,n,a){if(a&&a.biff>=2&&a.biff<=5)return KC(t);var s=t.read_shift(a&&a.biff==12?4:2),o=Gi(t);return{r:s,c:o[0],cRel:o[1],rRel:o[2]}}function KC(t){var n=Gi(t),a=t.read_shift(1);return{r:n[0],c:a,cRel:n[1],rRel:n[2]}}function qC(t){var n=t.read_shift(2),a=t.read_shift(2);return{r:n,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function YC(t,n,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return JC(t);var o=t.read_shift(s>=12?4:2),c=t.read_shift(2),u=(c&16384)>>14,h=(c&32768)>>15;if(c&=16383,h==1)for(;o>524287;)o-=1048576;if(u==1)for(;c>8191;)c=c-16384;return{r:o,c,cRel:u,rRel:h}}function JC(t){var n=t.read_shift(2),a=t.read_shift(1),s=(n&32768)>>15,o=(n&16384)>>14;return n&=16383,s==1&&n>=8192&&(n=n-16384),o==1&&a>=128&&(a=a-256),{r:n,c:a,cRel:o,rRel:s}}function XC(t,n,a){var s=(t[t.l++]&96)>>5,o=Kj(t,a.biff>=2&&a.biff<=5?6:8,a);return[s,o]}function QC(t,n,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2,"i"),c=8;if(a)switch(a.biff){case 5:t.l+=12,c=6;break;case 12:c=12;break}var u=Kj(t,c,a);return[s,o,u]}function eT(t,n,a){var s=(t[t.l++]&96)>>5;return t.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function tT(t,n,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2),c=8;if(a)switch(a.biff){case 5:t.l+=12,c=6;break;case 12:c=12;break}return t.l+=c,[s,o]}function aT(t,n,a){var s=(t[t.l++]&96)>>5,o=GC(t,n-1,a);return[s,o]}function nT(t,n,a){var s=(t[t.l++]&96)>>5;return t.l+=a.biff==2?6:a.biff==12?14:7,[s]}function xv(t){var n=t[t.l+1]&1,a=1;return t.l+=4,[n,a]}function rT(t,n,a){t.l+=2;for(var s=t.read_shift(a&&a.biff==2?1:2),o=[],c=0;c<=s;++c)o.push(t.read_shift(a&&a.biff==2?1:2));return o}function iT(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function sT(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function lT(t){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(2)]}function oT(t,n,a){var s=t[t.l+1]&255?1:0;return t.l+=a&&a.biff==2?3:4,[s]}function Jj(t){var n=t.read_shift(1),a=t.read_shift(1);return[n,a]}function cT(t){return t.read_shift(2),Jj(t)}function dT(t){return t.read_shift(2),Jj(t)}function uT(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=Yj(t,0,a);return[s,o]}function fT(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=YC(t,0,a);return[s,o]}function hT(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=t.read_shift(2);a&&a.biff==5&&(t.l+=12);var c=Yj(t,0,a);return[s,o,c]}function mT(t,n,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=t.read_shift(a&&a.biff<=3?1:2);return[m4[o],eb[o],s]}function pT(t,n,a){var s=t[t.l++],o=t.read_shift(1),c=a&&a.biff<=3?[s==88?-1:0,t.read_shift(1)]:gT(t);return[o,(c[0]===0?eb:h4)[c[1]]]}function gT(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function xT(t,n,a){t.l+=a&&a.biff==2?3:4}function yT(t,n,a){if(t.l++,a&&a.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function vT(t){return t.l++,xc[t.read_shift(1)]}function jT(t){return t.l++,t.read_shift(2)}function bT(t){return t.l++,t.read_shift(1)!==0}function _T(t){return t.l++,Fl(t)}function ST(t,n,a){return t.l++,Rj(t,n-1,a)}function wT(t,n){var a=[t.read_shift(1)];if(n==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=hz(t,1)?"TRUE":"FALSE",n!=12&&(t.l+=7);break;case 37:case 16:a[1]=xc[t[t.l]],t.l+=n==12?4:8;break;case 0:t.l+=8;break;case 1:a[1]=Fl(t);break;case 2:a[1]=xz(t,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function kT(t,n,a){for(var s=t.read_shift(a.biff==12?4:2),o=[],c=0;c!=s;++c)o.push((a.biff==12?Ts:jz)(t));return o}function zT(t,n,a){var s=0,o=0;a.biff==12?(s=t.read_shift(4),o=t.read_shift(4)):(o=1+t.read_shift(1),s=1+t.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--o==0&&(o=256));for(var c=0,u=[];c!=s&&(u[c]=[]);++c)for(var h=0;h!=o;++h)u[c][h]=wT(t,a.biff);return u}function CT(t,n,a){var s=t.read_shift(1)>>>5&3,o=!a||a.biff>=8?4:2,c=t.read_shift(o);switch(a.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,c]}function TT(t,n,a){if(a.biff==5)return NT(t);var s=t.read_shift(1)>>>5&3,o=t.read_shift(2),c=t.read_shift(4);return[s,o,c]}function NT(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[n,a,s]}function AT(t,n,a){var s=t.read_shift(1)>>>5&3;t.l+=a&&a.biff==2?3:4;var o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function ET(t,n,a){var s=t.read_shift(1)>>>5&3,o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function FT(t,n,a){var s=t.read_shift(1)>>>5&3;return t.l+=4,a.biff<8&&t.l--,a.biff==12&&(t.l+=2),[s]}function RT(t,n,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2),c=4;if(a)switch(a.biff){case 5:c=15;break;case 12:c=6;break}return t.l+=c,[s,o]}var BT=Lr,OT=Lr,DT=Lr;function yc(t,n,a){return t.l+=2,[qC(t)]}function Fp(t){return t.l+=6,[]}var LT=yc,MT=Fp,IT=Fp,PT=yc;function Xj(t){return t.l+=2,[Ej(t),t.read_shift(2)&1]}var WT=yc,UT=Xj,$T=Fp,HT=yc,VT=yc,ZT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function GT(t){t.l+=2;var n=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(4),o=t.read_shift(2),c=t.read_shift(2),u=ZT[a>>2&31];return{ixti:n,coltype:a&3,rt:u,idx:s,c:o,C:c}}function KT(t){return t.l+=2,[t.read_shift(4)]}function qT(t,n,a){return t.l+=5,t.l+=2,t.l+=a.biff==2?1:4,["PTGSHEET"]}function YT(t,n,a){return t.l+=a.biff==2?4:5,["PTGENDSHEET"]}function JT(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[n,a]}function XT(t){var n=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[n,a]}function QT(t){return t.l+=4,[0,0]}var yv={1:{n:"PtgExp",f:yT},2:{n:"PtgTbl",f:DT},3:{n:"PtgAdd",f:Da},4:{n:"PtgSub",f:Da},5:{n:"PtgMul",f:Da},6:{n:"PtgDiv",f:Da},7:{n:"PtgPower",f:Da},8:{n:"PtgConcat",f:Da},9:{n:"PtgLt",f:Da},10:{n:"PtgLe",f:Da},11:{n:"PtgEq",f:Da},12:{n:"PtgGe",f:Da},13:{n:"PtgGt",f:Da},14:{n:"PtgNe",f:Da},15:{n:"PtgIsect",f:Da},16:{n:"PtgUnion",f:Da},17:{n:"PtgRange",f:Da},18:{n:"PtgUplus",f:Da},19:{n:"PtgUminus",f:Da},20:{n:"PtgPercent",f:Da},21:{n:"PtgParen",f:Da},22:{n:"PtgMissArg",f:Da},23:{n:"PtgStr",f:ST},26:{n:"PtgSheet",f:qT},27:{n:"PtgEndSheet",f:YT},28:{n:"PtgErr",f:vT},29:{n:"PtgBool",f:bT},30:{n:"PtgInt",f:jT},31:{n:"PtgNum",f:_T},32:{n:"PtgArray",f:nT},33:{n:"PtgFunc",f:mT},34:{n:"PtgFuncVar",f:pT},35:{n:"PtgName",f:CT},36:{n:"PtgRef",f:uT},37:{n:"PtgArea",f:XC},38:{n:"PtgMemArea",f:AT},39:{n:"PtgMemErr",f:BT},40:{n:"PtgMemNoMem",f:OT},41:{n:"PtgMemFunc",f:ET},42:{n:"PtgRefErr",f:FT},43:{n:"PtgAreaErr",f:eT},44:{n:"PtgRefN",f:fT},45:{n:"PtgAreaN",f:aT},46:{n:"PtgMemAreaN",f:JT},47:{n:"PtgMemNoMemN",f:XT},57:{n:"PtgNameX",f:TT},58:{n:"PtgRef3d",f:hT},59:{n:"PtgArea3d",f:QC},60:{n:"PtgRefErr3d",f:RT},61:{n:"PtgAreaErr3d",f:tT},255:{}},e4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},t4={1:{n:"PtgElfLel",f:Xj},2:{n:"PtgElfRw",f:HT},3:{n:"PtgElfCol",f:LT},6:{n:"PtgElfRwV",f:VT},7:{n:"PtgElfColV",f:PT},10:{n:"PtgElfRadical",f:WT},11:{n:"PtgElfRadicalS",f:$T},13:{n:"PtgElfColS",f:MT},15:{n:"PtgElfColSV",f:IT},16:{n:"PtgElfRadicalLel",f:UT},25:{n:"PtgList",f:GT},29:{n:"PtgSxName",f:KT},255:{}},a4={0:{n:"PtgAttrNoop",f:QT},1:{n:"PtgAttrSemi",f:oT},2:{n:"PtgAttrIf",f:sT},4:{n:"PtgAttrChoose",f:rT},8:{n:"PtgAttrGoto",f:iT},16:{n:"PtgAttrSum",f:xT},32:{n:"PtgAttrBaxcel",f:xv},33:{n:"PtgAttrBaxcel",f:xv},64:{n:"PtgAttrSpace",f:cT},65:{n:"PtgAttrSpaceSemi",f:dT},128:{n:"PtgAttrIfError",f:lT},255:{}};function n4(t,n,a,s){if(s.biff<8)return Lr(t,n);for(var o=t.l+n,c=[],u=0;u!==a.length;++u)switch(a[u][0]){case"PtgArray":a[u][1]=zT(t,0,s),c.push(a[u][1]);break;case"PtgMemArea":a[u][2]=kT(t,a[u][1],s),c.push(a[u][2]);break;case"PtgExp":s&&s.biff==12&&(a[u][1][1]=t.read_shift(4),c.push(a[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[u][0]}return n=o-t.l,n!==0&&c.push(Lr(t,n)),c}function r4(t,n,a){for(var s=t.l+n,o,c,u=[];s!=t.l;)n=s-t.l,c=t[t.l],o=yv[c]||yv[e4[c]],(c===24||c===25)&&(o=(c===24?t4:a4)[t[t.l+1]]),!o||!o.f?Lr(t,n):u.push([o.n,o.f(t,n,a)]);return u}function i4(t){for(var n=[],a=0;a<t.length;++a){for(var s=t[a],o=[],c=0;c<s.length;++c){var u=s[c];u?u[0]===2?o.push('"'+u[1].replace(/"/g,'""')+'"'):o.push(u[1]):o.push("")}n.push(o.join(","))}return n.join(";")}var s4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function l4(t,n){if(!t&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Qj(t,n,a){if(!t)return"SH33TJSERR0";if(a.biff>8&&(!t.XTI||!t.XTI[n]))return t.SheetNames[n];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[n];if(a.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":t.XTI[n-1];if(!s)return"SH33TJSERR1";var o="";if(a.biff>8)switch(t[s[0]][0]){case 357:return o=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?o:o+":"+t.SheetNames[s[2]];case 358:return a.SID!=null?t.SheetNames[a.SID]:"SH33TJSSAME"+t[s[0]][0];default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return o=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?o:o+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return t[s[0]][0][3]?(o=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?o:o+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function vv(t,n,a){var s=Qj(t,n,a);return s=="#REF"?s:l4(s,a)}function wl(t,n,a,s,o){var c=o&&o.biff||8,u={s:{c:0,r:0}},h=[],f,p,x,j=0,y=0,S,w="";if(!t[0]||!t[0][0])return"";for(var b=-1,_="",E=0,z=t[0].length;E<z;++E){var N=t[0][E];switch(N[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=h.pop(),p=h.pop(),b>=0){switch(t[0][b][1][0]){case 0:_=wa(" ",t[0][b][1][1]);break;case 1:_=wa("\r",t[0][b][1][1]);break;default:if(_="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}p=p+_,b=-1}h.push(p+s4[N[0]]+f);break;case"PtgIsect":f=h.pop(),p=h.pop(),h.push(p+" "+f);break;case"PtgUnion":f=h.pop(),p=h.pop(),h.push(p+","+f);break;case"PtgRange":f=h.pop(),p=h.pop(),h.push(p+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Ko(N[1][1],u,o),h.push(qo(x,c));break;case"PtgRefN":x=a?Ko(N[1][1],a,o):N[1][1],h.push(qo(x,c));break;case"PtgRef3d":j=N[1][1],x=Ko(N[1][2],u,o),w=vv(s,j,o),h.push(w+"!"+qo(x,c));break;case"PtgFunc":case"PtgFuncVar":var O=N[1][0],Q=N[1][1];O||(O=0),O&=127;var U=O==0?[]:h.slice(-O);h.length-=O,Q==="User"&&(Q=U.shift()),h.push(Q+"("+U.join(",")+")");break;case"PtgBool":h.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(N[1]);break;case"PtgNum":h.push(String(N[1]));break;case"PtgStr":h.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(N[1]);break;case"PtgAreaN":S=nv(N[1][1],a?{s:a}:u,o),h.push(lm(S,o));break;case"PtgArea":S=nv(N[1][1],u,o),h.push(lm(S,o));break;case"PtgArea3d":j=N[1][1],S=N[1][2],w=vv(s,j,o),h.push(w+"!"+lm(S,o));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var L=(s.names||[])[y-1]||(s[0]||[])[y],H=L?L.Name:"SH33TJSNAME"+String(y);H&&H.slice(0,6)=="_xlfn."&&!o.xlfn&&(H=H.slice(6)),h.push(H);break;case"PtgNameX":var A=N[1][1];y=N[1][2];var R;if(o.biff<=5)A<0&&(A=-A),s[A]&&(R=s[A][y]);else{var G="";if(((s[A]||[])[0]||[])[0]==14849||(((s[A]||[])[0]||[])[0]==1025?s[A][y]&&s[A][y].itab>0&&(G=s.SheetNames[s[A][y].itab-1]+"!"):G=s.SheetNames[y-1]+"!"),s[A]&&s[A][y])G+=s[A][y].Name;else if(s[0]&&s[0][y])G+=s[0][y].Name;else{var F=(Qj(s,A,o)||"").split(";;");F[y-1]?G=F[y-1]:G+="SH33TJSERRX"}h.push(G);break}R||(R={Name:"SH33TJSERRY"}),h.push(R.Name);break;case"PtgParen":var q="(",ee=")";if(b>=0){switch(_="",t[0][b][1][0]){case 2:q=wa(" ",t[0][b][1][1])+q;break;case 3:q=wa("\r",t[0][b][1][1])+q;break;case 4:ee=wa(" ",t[0][b][1][1])+ee;break;case 5:ee=wa("\r",t[0][b][1][1])+ee;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}h.push(q+h.pop()+ee);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":x={c:N[1][1],r:N[1][0]};var me={c:a.c,r:a.r};if(s.sharedf[ea(x)]){var W=s.sharedf[ea(x)];h.push(wl(W,u,me,s,o))}else{var J=!1;for(f=0;f!=s.arrayf.length;++f)if(p=s.arrayf[f],!(x.c<p[0].s.c||x.c>p[0].e.c)&&!(x.r<p[0].s.r||x.r>p[0].e.r)){h.push(wl(p[1],u,me,s,o)),J=!0;break}J||h.push(N[1])}break;case"PtgArray":h.push("{"+i4(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&b>=0&&M.indexOf(t[0][E][0])==-1){N=t[0][b];var V=!0;switch(N[1][0]){case 4:V=!1;case 0:_=wa(" ",N[1][1]);break;case 5:V=!1;case 1:_=wa("\r",N[1][1]);break;default:if(_="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}h.push((V?_:"")+h.pop()+(V?"":_)),b=-1}}if(h.length>1&&o.WTF)throw new Error("bad formula stack");return h[0]}function o4(t){if(t==null){var n=Pe(8);return n.write_shift(1,3),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,65535),n}else if(typeof t=="number")return _s(t);return _s(0)}function c4(t,n,a,s,o){var c=Ss(n,a,o),u=o4(t.v),h=Pe(6),f=33;h.write_shift(2,f),h.write_shift(4,0);for(var p=Pe(t.bf.length),x=0;x<t.bf.length;++x)p[x]=t.bf[x];var j=nn([c,u,h,p]);return j}function Hu(t,n,a){var s=t.read_shift(4),o=r4(t,s,a),c=t.read_shift(4),u=c>0?n4(t,c,o,a):null;return[o,u]}var d4=Hu,Vu=Hu,u4=Hu,f4=Hu,h4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},eb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},m4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function p4(t){var n="of:="+t.replace(Ap,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return n.replace(/;/g,"|").replace(/,/g,";")}function g4(t){return t.replace(/\./,"!")}var Yo=typeof Map<"u";function Rp(t,n,a){var s=0,o=t.length;if(a){if(Yo?a.has(n):Object.prototype.hasOwnProperty.call(a,n)){for(var c=Yo?a.get(n):a[n];s<c.length;++s)if(t[c[s]].t===n)return t.Count++,c[s]}}else for(;s<o;++s)if(t[s].t===n)return t.Count++,s;return t[o]={t:n},t.Count++,t.Unique++,a&&(Yo?(a.has(n)||a.set(n,[]),a.get(n).push(o)):(Object.prototype.hasOwnProperty.call(a,n)||(a[n]=[]),a[n].push(o))),o}function Zu(t,n){var a={min:t+1,max:t+1},s=-1;return n.MDW&&(si=n.MDW),n.width!=null?a.customWidth=1:n.wpx!=null?s=Nu(n.wpx):n.wch!=null&&(s=n.wch),s>-1?(a.width=tp(s),a.customWidth=1):n.width!=null&&(a.width=n.width),n.hidden&&(a.hidden=!0),n.level!=null&&(a.outlineLevel=a.level=n.level),a}function tb(t,n){if(t){var a=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=a[0]),t.right==null&&(t.right=a[1]),t.top==null&&(t.top=a[2]),t.bottom==null&&(t.bottom=a[3]),t.header==null&&(t.header=a[4]),t.footer==null&&(t.footer=a[5])}}function qi(t,n,a){var s=a.revssf[n.z!=null?n.z:"General"],o=60,c=t.length;if(s==null&&a.ssf){for(;o<392;++o)if(a.ssf[o]==null){Y1(n.z,o),a.ssf[o]=n.z,a.revssf[n.z]=s=o;break}}for(o=0;o!=c;++o)if(t[o].numFmtId===s)return o;return t[c]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function x4(t,n,a){if(t&&t["!ref"]){var s=pa(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+a+"): "+t["!ref"])}}function y4(t){if(t.length===0)return"";for(var n='<mergeCells count="'+t.length+'">',a=0;a!=t.length;++a)n+='<mergeCell ref="'+La(t[a])+'"/>';return n+"</mergeCells>"}function v4(t,n,a,s,o){var c=!1,u={},h=null;if(s.bookType!=="xlsx"&&n.vbaraw){var f=n.SheetNames[a];try{n.Workbook&&(f=n.Workbook.Sheets[a].CodeName||f)}catch{}c=!0,u.codeName=rc(Qt(f))}if(t&&t["!outline"]){var p={summaryBelow:1,summaryRight:1};t["!outline"].above&&(p.summaryBelow=0),t["!outline"].left&&(p.summaryRight=0),h=(h||"")+Je("outlinePr",null,p)}!c&&!h||(o[o.length]=Je("sheetPr",h,u))}var j4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],b4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _4(t){var n={sheet:1};return j4.forEach(function(a){t[a]!=null&&t[a]&&(n[a]="1")}),b4.forEach(function(a){t[a]!=null&&!t[a]&&(n[a]="0")}),t.password&&(n.password=Mj(t.password).toString(16).toUpperCase()),Je("sheetProtection",null,n)}function S4(t){return tb(t),Je("pageMargins",null,t)}function w4(t,n){for(var a=["<cols>"],s,o=0;o!=n.length;++o)(s=n[o])&&(a[a.length]=Je("col",null,Zu(o,s)));return a[a.length]="</cols>",a.join("")}function k4(t,n,a,s){var o=typeof t.ref=="string"?t.ref:La(t.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var c=a.Workbook.Names,u=Gn(o);u.s.r==u.e.r&&(u.e.r=Gn(n["!ref"]).e.r,o=La(u));for(var h=0;h<c.length;++h){var f=c[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==s){f.Ref="'"+a.SheetNames[s]+"'!"+o;break}}return h==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+o}),Je("autoFilter",null,{ref:o})}function z4(t,n,a,s){var o={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,o),{})}function C4(t,n,a,s){if(t.c&&a["!comments"].push([n,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var o="",c=t.t,u=t.v;if(t.t!=="z")switch(t.t){case"b":o=t.v?"1":"0";break;case"n":o=""+t.v;break;case"e":o=xc[t.v];break;case"d":s&&s.cellDates?o=vn(t.v,-1).toISOString():(t=En(t),t.t="n",o=""+(t.v=An(vn(t.v)))),typeof t.z>"u"&&(t.z=ka[14]);break;default:o=t.v;break}var h=rn("v",Qt(o)),f={r:n},p=qi(s.cellXfs,t,s);switch(p!==0&&(f.s=p),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){h=rn("v",""+Rp(s.Strings,t.v,s.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=c&&(t.t=c,t.v=u),typeof t.f=="string"&&t.f){var x=t.F&&t.F.slice(0,n.length)==n?{t:"array",ref:t.F}:null;h=Je("f",Qt(t.f),x)+(t.v!=null?h:"")}return t.l&&a["!links"].push([n,t.l]),t.D&&(f.cm=1),Je("c",h,f)}function T4(t,n,a,s){var o=[],c=[],u=pa(t["!ref"]),h="",f,p="",x=[],j=0,y=0,S=t["!rows"],w=Array.isArray(t),b={r:p},_,E=-1;for(y=u.s.c;y<=u.e.c;++y)x[y]=fn(y);for(j=u.s.r;j<=u.e.r;++j){for(c=[],p=sn(j),y=u.s.c;y<=u.e.c;++y){f=x[y]+p;var z=w?(t[j]||[])[y]:t[f];z!==void 0&&(h=C4(z,f,t,n))!=null&&c.push(h)}(c.length>0||S&&S[j])&&(b={r:p},S&&S[j]&&(_=S[j],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=Au(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level)),o[o.length]=Je("row",c.join(""),b))}if(S)for(;j<S.length;++j)S&&S[j]&&(b={r:j+1},_=S[j],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=Au(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level),o[o.length]=Je("row","",b));return o.join("")}function ab(t,n,a,s){var o=[Ma,Je("worksheet",null,{xmlns:Nl[0],"xmlns:r":Za.r})],c=a.SheetNames[t],u=0,h="",f=a.Sheets[c];f==null&&(f={});var p=f["!ref"]||"A1",x=pa(p);if(x.e.c>16383||x.e.r>1048575){if(n.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),p=La(x)}s||(s={}),f["!comments"]=[];var j=[];v4(f,a,t,n,o),o[o.length]=Je("dimension",null,{ref:p}),o[o.length]=z4(f,n,t,a),n.sheetFormat&&(o[o.length]=Je("sheetFormatPr",null,{defaultRowHeight:n.sheetFormat.defaultRowHeight||"16",baseColWidth:n.sheetFormat.baseColWidth||"10",outlineLevelRow:n.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(o[o.length]=w4(f,f["!cols"])),o[u=o.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(h=T4(f,n),h.length>0&&(o[o.length]=h)),o.length>u+1&&(o[o.length]="</sheetData>",o[u]=o[u].replace("/>",">")),f["!protect"]&&(o[o.length]=_4(f["!protect"])),f["!autofilter"]!=null&&(o[o.length]=k4(f["!autofilter"],f,a,t)),f["!merges"]!=null&&f["!merges"].length>0&&(o[o.length]=y4(f["!merges"]));var y=-1,S,w=-1;return f["!links"].length>0&&(o[o.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(S={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=Xt(s,-1,Qt(b[1].Target).replace(/#.*$/,""),$t.HLINK),S["r:id"]="rId"+w),(y=b[1].Target.indexOf("#"))>-1&&(S.location=Qt(b[1].Target.slice(y+1))),b[1].Tooltip&&(S.tooltip=Qt(b[1].Tooltip)),o[o.length]=Je("hyperlink",null,S))}),o[o.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(o[o.length]=S4(f["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&(o[o.length]=rn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:p}))),j.length>0&&(w=Xt(s,-1,"../drawings/drawing"+(t+1)+".xml",$t.DRAW),o[o.length]=Je("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=j),f["!comments"].length>0&&(w=Xt(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$t.VML),o[o.length]=Je("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function N4(t,n){var a={},s=t.l+n;a.r=t.read_shift(4),t.l+=4;var o=t.read_shift(2);t.l+=1;var c=t.read_shift(1);return t.l=s,c&7&&(a.level=c&7),c&16&&(a.hidden=!0),c&32&&(a.hpt=o/20),a}function A4(t,n,a){var s=Pe(145),o=(a["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var c=320;o.hpx?c=Au(o.hpx)*20:o.hpt&&(c=o.hpt*20),s.write_shift(2,c),s.write_shift(1,0);var u=0;o.level&&(u|=o.level),o.hidden&&(u|=16),(o.hpx||o.hpt)&&(u|=32),s.write_shift(1,u),s.write_shift(1,0);var h=0,f=s.l;s.l+=4;for(var p={r:t,c:0},x=0;x<16;++x)if(!(n.s.c>x+1<<10||n.e.c<x<<10)){for(var j=-1,y=-1,S=x<<10;S<x+1<<10;++S){p.c=S;var w=Array.isArray(a)?(a[p.r]||[])[p.c]:a[ea(p)];w&&(j<0&&(j=S),y=S)}j<0||(++h,s.write_shift(4,j),s.write_shift(4,y))}var b=s.l;return s.l=f,s.write_shift(4,h),s.l=b,s.length>s.l?s.slice(0,s.l):s}function E4(t,n,a,s){var o=A4(s,a,n);(o.length>17||(n["!rows"]||[])[s])&&Ke(t,0,o)}var F4=Ts,R4=El;function B4(){}function O4(t,n){var a={},s=t[t.l];return++t.l,a.above=!(s&64),a.left=!(s&128),t.l+=18,a.name=Vk(t),a}function D4(t,n,a){a==null&&(a=Pe(84+4*t.length));var s=192;n&&(n.above&&(s&=-65),n.left&&(s&=-129)),a.write_shift(1,s);for(var o=1;o<3;++o)a.write_shift(1,0);return zu({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),xj(t,a),a.slice(0,a.l)}function L4(t){var n=dr(t);return[n]}function M4(t,n,a){return a==null&&(a=Pe(8)),ks(n,a)}function I4(t){var n=zs(t);return[n]}function P4(t,n,a){return a==null&&(a=Pe(4)),Cs(n,a)}function W4(t){var n=dr(t),a=t.read_shift(1);return[n,a,"b"]}function U4(t,n,a){return a==null&&(a=Pe(9)),ks(n,a),a.write_shift(1,t.v?1:0),a}function $4(t){var n=zs(t),a=t.read_shift(1);return[n,a,"b"]}function H4(t,n,a){return a==null&&(a=Pe(5)),Cs(n,a),a.write_shift(1,t.v?1:0),a}function V4(t){var n=dr(t),a=t.read_shift(1);return[n,a,"e"]}function Z4(t,n,a){return a==null&&(a=Pe(9)),ks(n,a),a.write_shift(1,t.v),a}function G4(t){var n=zs(t),a=t.read_shift(1);return[n,a,"e"]}function K4(t,n,a){return a==null&&(a=Pe(8)),Cs(n,a),a.write_shift(1,t.v),a.write_shift(2,0),a.write_shift(1,0),a}function q4(t){var n=dr(t),a=t.read_shift(4);return[n,a,"s"]}function Y4(t,n,a){return a==null&&(a=Pe(12)),ks(n,a),a.write_shift(4,n.v),a}function J4(t){var n=zs(t),a=t.read_shift(4);return[n,a,"s"]}function X4(t,n,a){return a==null&&(a=Pe(8)),Cs(n,a),a.write_shift(4,n.v),a}function Q4(t){var n=dr(t),a=Fl(t);return[n,a,"n"]}function eN(t,n,a){return a==null&&(a=Pe(16)),ks(n,a),_s(t.v,a),a}function tN(t){var n=zs(t),a=Fl(t);return[n,a,"n"]}function aN(t,n,a){return a==null&&(a=Pe(12)),Cs(n,a),_s(t.v,a),a}function nN(t){var n=dr(t),a=yj(t);return[n,a,"n"]}function rN(t,n,a){return a==null&&(a=Pe(12)),ks(n,a),vj(t.v,a),a}function iN(t){var n=zs(t),a=yj(t);return[n,a,"n"]}function sN(t,n,a){return a==null&&(a=Pe(8)),Cs(n,a),vj(t.v,a),a}function lN(t){var n=dr(t),a=kp(t);return[n,a,"is"]}function oN(t){var n=dr(t),a=hn(t);return[n,a,"str"]}function cN(t,n,a){return a==null&&(a=Pe(12+4*t.v.length)),ks(n,a),Ka(t.v,a),a.length>a.l?a.slice(0,a.l):a}function dN(t){var n=zs(t),a=hn(t);return[n,a,"str"]}function uN(t,n,a){return a==null&&(a=Pe(8+4*t.v.length)),Cs(n,a),Ka(t.v,a),a.length>a.l?a.slice(0,a.l):a}function fN(t,n,a){var s=t.l+n,o=dr(t);o.r=a["!row"];var c=t.read_shift(1),u=[o,c,"b"];if(a.cellFormula){t.l+=2;var h=Vu(t,s-t.l,a);u[3]=wl(h,null,o,a.supbooks,a)}else t.l=s;return u}function hN(t,n,a){var s=t.l+n,o=dr(t);o.r=a["!row"];var c=t.read_shift(1),u=[o,c,"e"];if(a.cellFormula){t.l+=2;var h=Vu(t,s-t.l,a);u[3]=wl(h,null,o,a.supbooks,a)}else t.l=s;return u}function mN(t,n,a){var s=t.l+n,o=dr(t);o.r=a["!row"];var c=Fl(t),u=[o,c,"n"];if(a.cellFormula){t.l+=2;var h=Vu(t,s-t.l,a);u[3]=wl(h,null,o,a.supbooks,a)}else t.l=s;return u}function pN(t,n,a){var s=t.l+n,o=dr(t);o.r=a["!row"];var c=hn(t),u=[o,c,"str"];if(a.cellFormula){t.l+=2;var h=Vu(t,s-t.l,a);u[3]=wl(h,null,o,a.supbooks,a)}else t.l=s;return u}var gN=Ts,xN=El;function yN(t,n){return n==null&&(n=Pe(4)),n.write_shift(4,t),n}function vN(t,n){var a=t.l+n,s=Ts(t),o=zp(t),c=hn(t),u=hn(t),h=hn(t);t.l=a;var f={rfx:s,relId:o,loc:c,display:h};return u&&(f.Tooltip=u),f}function jN(t,n){var a=Pe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));El({s:Ga(t[0]),e:Ga(t[0])},a),Cp("rId"+n,a);var s=t[1].Target.indexOf("#"),o=s==-1?"":t[1].Target.slice(s+1);return Ka(o||"",a),Ka(t[1].Tooltip||"",a),Ka("",a),a.slice(0,a.l)}function bN(){}function _N(t,n,a){var s=t.l+n,o=jj(t),c=t.read_shift(1),u=[o];if(u[2]=c,a.cellFormula){var h=d4(t,s-t.l,a);u[1]=h}else t.l=s;return u}function SN(t,n,a){var s=t.l+n,o=Ts(t),c=[o];if(a.cellFormula){var u=f4(t,s-t.l,a);c[1]=u,t.l=s}else t.l=s;return c}function wN(t,n,a){a==null&&(a=Pe(18));var s=Zu(t,n);a.write_shift(-4,t),a.write_shift(-4,t),a.write_shift(4,(s.width||10)*256),a.write_shift(4,0);var o=0;return n.hidden&&(o|=1),typeof s.width=="number"&&(o|=2),n.level&&(o|=n.level<<8),a.write_shift(2,o),a}var nb=["left","right","top","bottom","header","footer"];function kN(t){var n={};return nb.forEach(function(a){n[a]=Fl(t)}),n}function zN(t,n){return n==null&&(n=Pe(48)),tb(t),nb.forEach(function(a){_s(t[a],n)}),n}function CN(t){var n=t.read_shift(2);return t.l+=28,{RTL:n&32}}function TN(t,n,a){a==null&&(a=Pe(30));var s=924;return(((n||{}).Views||[])[0]||{}).RTL&&(s|=32),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function NN(t){var n=Pe(24);return n.write_shift(4,4),n.write_shift(4,1),El(t,n),n}function AN(t,n){return n==null&&(n=Pe(66)),n.write_shift(2,t.password?Mj(t.password):0),n.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?n.write_shift(4,t[a[0]]!=null&&!t[a[0]]?1:0):n.write_shift(4,t[a[0]]!=null&&t[a[0]]?0:1)}),n}function EN(){}function FN(){}function RN(t,n,a,s,o,c,u){if(n.v===void 0)return!1;var h="";switch(n.t){case"b":h=n.v?"1":"0";break;case"d":n=En(n),n.z=n.z||ka[14],n.v=An(vn(n.v)),n.t="n";break;case"n":case"e":h=""+n.v;break;default:h=n.v;break}var f={r:a,c:s};switch(f.s=qi(o.cellXfs,n,o),n.l&&c["!links"].push([ea(f),n.l]),n.c&&c["!comments"].push([ea(f),n.c]),n.t){case"s":case"str":return o.bookSST?(h=Rp(o.Strings,n.v,o.revStrings),f.t="s",f.v=h,u?Ke(t,18,X4(n,f)):Ke(t,7,Y4(n,f))):(f.t="str",u?Ke(t,17,uN(n,f)):Ke(t,6,cN(n,f))),!0;case"n":return n.v==(n.v|0)&&n.v>-1e3&&n.v<1e3?u?Ke(t,13,sN(n,f)):Ke(t,2,rN(n,f)):u?Ke(t,16,aN(n,f)):Ke(t,5,eN(n,f)),!0;case"b":return f.t="b",u?Ke(t,15,H4(n,f)):Ke(t,4,U4(n,f)),!0;case"e":return f.t="e",u?Ke(t,14,K4(n,f)):Ke(t,3,Z4(n,f)),!0}return u?Ke(t,12,P4(n,f)):Ke(t,1,M4(n,f)),!0}function BN(t,n,a,s){var o=pa(n["!ref"]||"A1"),c,u="",h=[];Ke(t,145);var f=Array.isArray(n),p=o.e.r;n["!rows"]&&(p=Math.max(o.e.r,n["!rows"].length-1));for(var x=o.s.r;x<=p;++x){u=sn(x),E4(t,n,o,x);var j=!1;if(x<=o.e.r)for(var y=o.s.c;y<=o.e.c;++y){x===o.s.r&&(h[y]=fn(y)),c=h[y]+u;var S=f?(n[x]||[])[y]:n[c];if(!S){j=!1;continue}j=RN(t,S,x,y,s,n,j)}}Ke(t,146)}function ON(t,n){!n||!n["!merges"]||(Ke(t,177,yN(n["!merges"].length)),n["!merges"].forEach(function(a){Ke(t,176,xN(a))}),Ke(t,178))}function DN(t,n){!n||!n["!cols"]||(Ke(t,390),n["!cols"].forEach(function(a,s){a&&Ke(t,60,wN(s,a))}),Ke(t,391))}function LN(t,n){!n||!n["!ref"]||(Ke(t,648),Ke(t,649,NN(pa(n["!ref"]))),Ke(t,650))}function MN(t,n,a){n["!links"].forEach(function(s){if(s[1].Target){var o=Xt(a,-1,s[1].Target.replace(/#.*$/,""),$t.HLINK);Ke(t,494,jN(s,o))}}),delete n["!links"]}function IN(t,n,a,s){if(n["!comments"].length>0){var o=Xt(s,-1,"../drawings/vmlDrawing"+(a+1)+".vml",$t.VML);Ke(t,551,Cp("rId"+o)),n["!legacy"]=o}}function PN(t,n,a,s){if(n["!autofilter"]){var o=n["!autofilter"],c=typeof o.ref=="string"?o.ref:La(o.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var u=a.Workbook.Names,h=Gn(c);h.s.r==h.e.r&&(h.e.r=Gn(n["!ref"]).e.r,c=La(h));for(var f=0;f<u.length;++f){var p=u[f];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==s){p.Ref="'"+a.SheetNames[s]+"'!"+c;break}}f==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+c}),Ke(t,161,El(pa(c))),Ke(t,162)}}function WN(t,n,a){Ke(t,133),Ke(t,137,TN(n,a)),Ke(t,138),Ke(t,134)}function UN(t,n){n["!protect"]&&Ke(t,535,AN(n["!protect"]))}function $N(t,n,a,s){var o=Nn(),c=a.SheetNames[t],u=a.Sheets[c]||{},h=c;try{a&&a.Workbook&&(h=a.Workbook.Sheets[t].CodeName||h)}catch{}var f=pa(u["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(n.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Ke(o,129),(a.vbaraw||u["!outline"])&&Ke(o,147,D4(h,u["!outline"])),Ke(o,148,R4(f)),WN(o,u,a.Workbook),DN(o,u),BN(o,u,t,n),UN(o,u),PN(o,u,a,t),ON(o,u),MN(o,u,s),u["!margins"]&&Ke(o,476,zN(u["!margins"])),(!n||n.ignoreEC||n.ignoreEC==null)&&LN(o,u),IN(o,u,t,s),Ke(o,130),o.end()}function HN(t,n){t.l+=10;var a=hn(t);return{name:a}}var VN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ZN(t){return!t.Workbook||!t.Workbook.WBProps?"false":Sk(t.Workbook.WBProps.date1904)?"true":"false"}var GN="][*?/\\".split("");function rb(t,n){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return GN.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function KN(t,n,a){t.forEach(function(s,o){rb(s);for(var c=0;c<o;++c)if(s==t[c])throw new Error("Duplicate Sheet Name: "+s);if(a){var u=n&&n[o]&&n[o].CodeName||s;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function qN(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var n=t.Workbook&&t.Workbook.Sheets||[];KN(t.SheetNames,n,!!t.vbaraw);for(var a=0;a<t.SheetNames.length;++a)x4(t.Sheets[t.SheetNames[a]],t.SheetNames[a],a)}function ib(t){var n=[Ma];n[n.length]=Je("workbook",null,{xmlns:Nl[0],"xmlns:r":Za.r});var a=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(VN.forEach(function(h){t.Workbook.WBProps[h[0]]!=null&&t.Workbook.WBProps[h[0]]!=h[1]&&(s[h[0]]=t.Workbook.WBProps[h[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),n[n.length]=Je("workbookPr",null,s);var o=t.Workbook&&t.Workbook.Sheets||[],c=0;if(o&&o[0]&&o[0].Hidden){for(n[n.length]="<bookViews>",c=0;c!=t.SheetNames.length&&!(!o[c]||!o[c].Hidden);++c);c==t.SheetNames.length&&(c=0),n[n.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',n[n.length]="</bookViews>"}for(n[n.length]="<sheets>",c=0;c!=t.SheetNames.length;++c){var u={name:Qt(t.SheetNames[c].slice(0,31))};if(u.sheetId=""+(c+1),u["r:id"]="rId"+(c+1),o[c])switch(o[c].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}n[n.length]=Je("sheet",null,u)}return n[n.length]="</sheets>",a&&(n[n.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(h){var f={name:h.Name};h.Comment&&(f.comment=h.Comment),h.Sheet!=null&&(f.localSheetId=""+h.Sheet),h.Hidden&&(f.hidden="1"),h.Ref&&(n[n.length]=Je("definedName",Qt(h.Ref),f))}),n[n.length]="</definedNames>"),n.length>2&&(n[n.length]="</workbook>",n[1]=n[1].replace("/>",">")),n.join("")}function YN(t,n){var a={};return a.Hidden=t.read_shift(4),a.iTabID=t.read_shift(4),a.strRelID=ep(t),a.name=hn(t),a}function JN(t,n){return n||(n=Pe(127)),n.write_shift(4,t.Hidden),n.write_shift(4,t.iTabID),Cp(t.strRelID,n),Ka(t.name.slice(0,31),n),n.length>n.l?n.slice(0,n.l):n}function XN(t,n){var a={},s=t.read_shift(4);a.defaultThemeVersion=t.read_shift(4);var o=n>8?hn(t):"";return o.length>0&&(a.CodeName=o),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function QN(t,n){n||(n=Pe(72));var a=0;return t&&t.filterPrivacy&&(a|=8),n.write_shift(4,a),n.write_shift(4,0),xj(t&&t.CodeName||"ThisWorkbook",n),n.slice(0,n.l)}function e6(t,n,a){var s=t.l+n;t.l+=4,t.l+=1;var o=t.read_shift(4),c=Zk(t),u=u4(t,0,a),h=zp(t);t.l=s;var f={Name:c,Ptg:u};return o<268435455&&(f.Sheet=o),h&&(f.Comment=h),f}function t6(t,n){Ke(t,143);for(var a=0;a!=n.SheetNames.length;++a){var s=n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[a]&&n.Workbook.Sheets[a].Hidden||0,o={Hidden:s,iTabID:a+1,strRelID:"rId"+(a+1),name:n.SheetNames[a]};Ke(t,156,JN(o))}Ke(t,144)}function a6(t,n){n||(n=Pe(127));for(var a=0;a!=4;++a)n.write_shift(4,0);return Ka("SheetJS",n),Ka(yu.version,n),Ka(yu.version,n),Ka("7262",n),n.length>n.l?n.slice(0,n.l):n}function n6(t,n){n||(n=Pe(29)),n.write_shift(-4,0),n.write_shift(-4,460),n.write_shift(4,28800),n.write_shift(4,17600),n.write_shift(4,500),n.write_shift(4,t),n.write_shift(4,t);var a=120;return n.write_shift(1,a),n.length>n.l?n.slice(0,n.l):n}function r6(t,n){if(!(!n.Workbook||!n.Workbook.Sheets)){for(var a=n.Workbook.Sheets,s=0,o=-1,c=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&o==-1?o=s:a[s].Hidden==1&&c==-1&&(c=s);c>o||(Ke(t,135),Ke(t,158,n6(o)),Ke(t,136))}}function i6(t,n){var a=Nn();return Ke(a,131),Ke(a,128,a6()),Ke(a,153,QN(t.Workbook&&t.Workbook.WBProps||null)),r6(a,t),t6(a,t),Ke(a,132),a.end()}function s6(t,n,a){return(n.slice(-4)===".bin"?i6:ib)(t)}function l6(t,n,a,s,o){return(n.slice(-4)===".bin"?$N:ab)(t,a,s,o)}function o6(t,n,a){return(n.slice(-4)===".bin"?zC:Wj)(t,a)}function c6(t,n,a){return(n.slice(-4)===".bin"?Qz:Lj)(t,a)}function d6(t,n,a){return(n.slice(-4)===".bin"?UC:Zj)(t)}function u6(t){return(t.slice(-4)===".bin"?BC:Hj)()}function f6(t,n){var a=[];return t.Props&&a.push(oz(t.Props,n)),t.Custprops&&a.push(cz(t.Props,t.Custprops)),a.join("")}function h6(){return""}function m6(t,n){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return n.cellXfs.forEach(function(s,o){var c=[];c.push(Je("NumberFormat",null,{"ss:Format":Qt(ka[s.numFmtId])}));var u={"ss:ID":"s"+(21+o)};a.push(Je("Style",c.join(""),u))}),Je("Styles",a.join(""))}function sb(t){return Je("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Ep(t.Ref,{r:0,c:0})})}function p6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var n=t.Workbook.Names,a=[],s=0;s<n.length;++s){var o=n[s];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||a.push(sb(o)))}return Je("Names",a.join(""))}function g6(t,n,a,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var o=s.Workbook.Names,c=[],u=0;u<o.length;++u){var h=o[u];h.Sheet==a&&(h.Name.match(/^_xlfn\./)||c.push(sb(h)))}return c.join("")}function x6(t,n,a,s){if(!t)return"";var o=[];if(t["!margins"]&&(o.push("<PageSetup>"),t["!margins"].header&&o.push(Je("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&o.push(Je("Footer",null,{"x:Margin":t["!margins"].footer})),o.push(Je("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),o.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[a])if(s.Workbook.Sheets[a].Hidden)o.push(Je("Visible",s.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<a&&!(s.Workbook.Sheets[c]&&!s.Workbook.Sheets[c].Hidden);++c);c==a&&o.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),t["!protect"]&&(o.push(rn("ProtectContents","True")),t["!protect"].objects&&o.push(rn("ProtectObjects","True")),t["!protect"].scenarios&&o.push(rn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?o.push(rn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&o.push(rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){t["!protect"][u[0]]&&o.push("<"+u[1]+"/>")})),o.length==0?"":Je("WorksheetOptions",o.join(""),{xmlns:Vn.x})}function y6(t){return t.map(function(n){var a=_k(n.t||""),s=Je("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",s,{"ss:Author":n.a})}).join("")}function v6(t,n,a,s,o,c,u){if(!t||t.v==null&&t.f==null)return"";var h={};if(t.f&&(h["ss:Formula"]="="+Qt(Ep(t.f,u))),t.F&&t.F.slice(0,n.length)==n){var f=Ga(t.F.slice(n.length+1));h["ss:ArrayRange"]="RC:R"+(f.r==u.r?"":"["+(f.r-u.r)+"]")+"C"+(f.c==u.c?"":"["+(f.c-u.c)+"]")}if(t.l&&t.l.Target&&(h["ss:HRef"]=Qt(t.l.Target),t.l.Tooltip&&(h["x:HRefScreenTip"]=Qt(t.l.Tooltip))),a["!merges"])for(var p=a["!merges"],x=0;x!=p.length;++x)p[x].s.c!=u.c||p[x].s.r!=u.r||(p[x].e.c>p[x].s.c&&(h["ss:MergeAcross"]=p[x].e.c-p[x].s.c),p[x].e.r>p[x].s.r&&(h["ss:MergeDown"]=p[x].e.r-p[x].s.r));var j="",y="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":j="Number",y=String(t.v);break;case"b":j="Boolean",y=t.v?"1":"0";break;case"e":j="Error",y=xc[t.v];break;case"d":j="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ka[14]);break;case"s":j="String",y=bk(t.v||"");break}var S=qi(s.cellXfs,t,s);h["ss:StyleID"]="s"+(21+S),h["ss:Index"]=u.c+1;var w=t.v!=null?y:"",b=t.t=="z"?"":'<Data ss:Type="'+j+'">'+w+"</Data>";return(t.c||[]).length>0&&(b+=y6(t.c)),Je("Cell",b,h)}function j6(t,n){var a='<Row ss:Index="'+(t+1)+'"';return n&&(n.hpt&&!n.hpx&&(n.hpx=Pj(n.hpt)),n.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+n.hpx+'"'),n.hidden&&(a+=' ss:Hidden="1"')),a+">"}function b6(t,n,a,s){if(!t["!ref"])return"";var o=pa(t["!ref"]),c=t["!merges"]||[],u=0,h=[];t["!cols"]&&t["!cols"].forEach(function(_,E){Np(_);var z=!!_.width,N=Zu(E,_),O={"ss:Index":E+1};z&&(O["ss:Width"]=Tu(N.width)),_.hidden&&(O["ss:Hidden"]="1"),h.push(Je("Column",null,O))});for(var f=Array.isArray(t),p=o.s.r;p<=o.e.r;++p){for(var x=[j6(p,(t["!rows"]||[])[p])],j=o.s.c;j<=o.e.c;++j){var y=!1;for(u=0;u!=c.length;++u)if(!(c[u].s.c>j)&&!(c[u].s.r>p)&&!(c[u].e.c<j)&&!(c[u].e.r<p)){(c[u].s.c!=j||c[u].s.r!=p)&&(y=!0);break}if(!y){var S={r:p,c:j},w=ea(S),b=f?(t[p]||[])[j]:t[w];x.push(v6(b,w,t,n,a,s,S))}}x.push("</Row>"),x.length>2&&h.push(x.join(""))}return h.join("")}function _6(t,n,a){var s=[],o=a.SheetNames[t],c=a.Sheets[o],u=c?g6(c,n,t,a):"";return u.length>0&&s.push("<Names>"+u+"</Names>"),u=c?b6(c,n,t,a):"",u.length>0&&s.push("<Table>"+u+"</Table>"),s.push(x6(c,n,t,a)),s.join("")}function S6(t,n){n||(n={}),t.SSF||(t.SSF=En(ka)),t.SSF&&(Wu(),Pu(t.SSF),n.revssf=Uu(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF,n.cellXfs=[],qi(n.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(f6(t,n)),a.push(h6()),a.push(""),a.push("");for(var s=0;s<t.SheetNames.length;++s)a.push(Je("Worksheet",_6(s,n,t),{"ss:Name":Qt(t.SheetNames[s])}));return a[2]=m6(t,n),a[3]=p6(t),Ma+Je("Workbook",a.join(""),{xmlns:Vn.ss,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:ss":Vn.ss,"xmlns:dt":Vn.dt,"xmlns:html":Vn.html})}var dm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function w6(t,n){var a=[],s=[],o=[],c=0,u,h=Zy(iv,"n"),f=Zy(sv,"n");if(t.Props)for(u=ln(t.Props),c=0;c<u.length;++c)(Object.prototype.hasOwnProperty.call(h,u[c])?a:Object.prototype.hasOwnProperty.call(f,u[c])?s:o).push([u[c],t.Props[u[c]]]);if(t.Custprops)for(u=ln(t.Custprops),c=0;c<u.length;++c)Object.prototype.hasOwnProperty.call(t.Props||{},u[c])||(Object.prototype.hasOwnProperty.call(h,u[c])?a:Object.prototype.hasOwnProperty.call(f,u[c])?s:o).push([u[c],t.Custprops[u[c]]]);var p=[];for(c=0;c<o.length;++c)Aj.indexOf(o[c][0])>-1||Cj.indexOf(o[c][0])>-1||o[c][1]!=null&&p.push(o[c]);s.length&&ia.utils.cfb_add(n,"/SummaryInformation",uv(s,dm.SI,f,sv)),(a.length||p.length)&&ia.utils.cfb_add(n,"/DocumentSummaryInformation",uv(a,dm.DSI,h,iv,p.length?p:null,dm.UDI))}function k6(t,n){var a=n||{},s=ia.utils.cfb_new({root:"R"}),o="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":o="/Workbook",a.biff=8;break;case"biff5":o="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return ia.utils.cfb_add(s,o,lb(t,a)),a.biff==8&&(t.Props||t.Custprops)&&w6(t,s),a.biff==8&&t.vbaraw&&$C(s,ia.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var z6={0:{f:N4},1:{f:L4},2:{f:nN},3:{f:V4},4:{f:W4},5:{f:Q4},6:{f:oN},7:{f:q4},8:{f:pN},9:{f:mN},10:{f:fN},11:{f:hN},12:{f:I4},13:{f:iN},14:{f:G4},15:{f:$4},16:{f:tN},17:{f:dN},18:{f:J4},19:{f:kp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:e6},40:{},42:{},43:{f:oC},44:{f:sC},45:{f:uC},46:{f:hC},47:{f:fC},48:{},49:{f:Ik},50:{},51:{f:NC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Pz},62:{f:lN},63:{f:OC},64:{f:EN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:O4},148:{f:F4,p:16},151:{f:bN},152:{},153:{f:XN},154:{},155:{},156:{f:YN},157:{},158:{},159:{T:1,f:Yz},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CC},336:{T:-1},337:{f:FC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ep},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Bz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_N},427:{f:SN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:kN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:B4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ep},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:PC},633:{T:1},634:{T:-1},635:{T:1,f:MC},636:{T:-1},637:{f:$k},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:HN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:FN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Xe(t,n,a,s){var o=n;if(!isNaN(o)){var c=s||(a||[]).length||0,u=t.next(4);u.write_shift(2,o),u.write_shift(2,c),c>0&&_p(a)&&t.push(a)}}function C6(t,n,a,s){var o=(a||[]).length||0;if(o<=8224)return Xe(t,n,a,o);var c=n;if(!isNaN(c)){for(var u=a.parts||[],h=0,f=0,p=0;p+(u[h]||8224)<=8224;)p+=u[h]||8224,h++;var x=t.next(4);for(x.write_shift(2,c),x.write_shift(2,p),t.push(a.slice(f,f+p)),f+=p;f<o;){for(x=t.next(4),x.write_shift(2,60),p=0;p+(u[h]||8224)<=8224;)p+=u[h]||8224,h++;x.write_shift(2,p),t.push(a.slice(f,f+p)),f+=p}}}function vc(t,n,a){return t||(t=Pe(7)),t.write_shift(2,n),t.write_shift(2,a),t.write_shift(2,0),t.write_shift(1,0),t}function T6(t,n,a,s){var o=Pe(9);return vc(o,t,n),Fj(a,s||"b",o),o}function N6(t,n,a){var s=Pe(8+2*a.length);return vc(s,t,n),s.write_shift(1,a.length),s.write_shift(a.length,a,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function A6(t,n,a,s){if(n.v!=null)switch(n.t){case"d":case"n":var o=n.t=="d"?An(vn(n.v)):n.v;o==(o|0)&&o>=0&&o<65536?Xe(t,2,Hz(a,s,o)):Xe(t,3,$z(a,s,o));return;case"b":case"e":Xe(t,5,T6(a,s,n.v,n.t));return;case"s":case"str":Xe(t,4,N6(a,s,(n.v||"").slice(0,255)));return}Xe(t,1,vc(null,a,s))}function E6(t,n,a,s){var o=Array.isArray(n),c=pa(n["!ref"]||"A1"),u,h="",f=[];if(c.e.c>255||c.e.r>16383){if(s.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),u=La(c)}for(var p=c.s.r;p<=c.e.r;++p){h=sn(p);for(var x=c.s.c;x<=c.e.c;++x){p===c.s.r&&(f[x]=fn(x)),u=f[x]+h;var j=o?(n[p]||[])[x]:n[u];j&&A6(t,j,p,x)}}}function F6(t,n){for(var a=n||{},s=Nn(),o=0,c=0;c<t.SheetNames.length;++c)t.SheetNames[c]==a.sheet&&(o=c);if(o==0&&a.sheet&&t.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Xe(s,a.biff==4?1033:a.biff==3?521:9,Tp(t,16,a)),E6(s,t.Sheets[t.SheetNames[o]],o,a),Xe(s,10),s.end()}function R6(t,n,a){Xe(t,49,zz({sz:12,name:"Arial"},a))}function B6(t,n,a){n&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)n[o]!=null&&Xe(t,1054,Nz(o,n[o],a))})}function O6(t,n){var a=Pe(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Xe(t,2151,a),a=Pe(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Oj(pa(n["!ref"]||"A1"),a),a.write_shift(4,4),Xe(t,2152,a)}function D6(t,n){for(var a=0;a<16;++a)Xe(t,224,hv({numFmtId:0,style:!0},0,n));n.cellXfs.forEach(function(s){Xe(t,224,hv(s,0,n))})}function L6(t,n){for(var a=0;a<n["!links"].length;++a){var s=n["!links"][a];Xe(t,440,Lz(s)),s[1].Tooltip&&Xe(t,2048,Mz(s))}delete n["!links"]}function M6(t,n){if(n){var a=0;n.forEach(function(s,o){++a<=256&&s&&Xe(t,125,Wz(Zu(o,s),o))})}}function I6(t,n,a,s,o){var c=16+qi(o.cellXfs,n,o);if(n.v==null&&!n.bf){Xe(t,513,Ss(a,s,c));return}if(n.bf)Xe(t,6,c4(n,a,s,o,c));else switch(n.t){case"d":case"n":var u=n.t=="d"?An(vn(n.v)):n.v;Xe(t,515,Rz(a,s,u,c));break;case"b":case"e":Xe(t,517,Fz(a,s,n.v,c,o,n.t));break;case"s":case"str":if(o.bookSST){var h=Rp(o.Strings,n.v,o.revStrings);Xe(t,253,Cz(a,s,h,c))}else Xe(t,516,Tz(a,s,(n.v||"").slice(0,255),c,o));break;default:Xe(t,513,Ss(a,s,c))}}function P6(t,n,a){var s=Nn(),o=a.SheetNames[t],c=a.Sheets[o]||{},u=(a||{}).Workbook||{},h=(u.Sheets||[])[t]||{},f=Array.isArray(c),p=n.biff==8,x,j="",y=[],S=pa(c["!ref"]||"A1"),w=p?65536:16384;if(S.e.c>255||S.e.r>=w){if(n.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,w-1)}Xe(s,2057,Tp(a,16,n)),Xe(s,13,lr(1)),Xe(s,12,lr(100)),Xe(s,15,yn(!0)),Xe(s,17,yn(!1)),Xe(s,16,_s(.001)),Xe(s,95,yn(!0)),Xe(s,42,yn(!1)),Xe(s,43,yn(!1)),Xe(s,130,lr(1)),Xe(s,128,Ez()),Xe(s,131,yn(!1)),Xe(s,132,yn(!1)),p&&M6(s,c["!cols"]),Xe(s,512,Az(S,n)),p&&(c["!links"]=[]);for(var b=S.s.r;b<=S.e.r;++b){j=sn(b);for(var _=S.s.c;_<=S.e.c;++_){b===S.s.r&&(y[_]=fn(_)),x=y[_]+j;var E=f?(c[b]||[])[_]:c[x];E&&(I6(s,E,b,_,n),p&&E.l&&c["!links"].push([x,E.l]))}}var z=h.CodeName||h.name||o;return p&&Xe(s,574,kz((u.Views||[])[0])),p&&(c["!merges"]||[]).length&&Xe(s,229,Dz(c["!merges"])),p&&L6(s,c),Xe(s,442,Bj(z)),p&&O6(s,c),Xe(s,10),s.end()}function W6(t,n,a){var s=Nn(),o=(t||{}).Workbook||{},c=o.Sheets||[],u=o.WBProps||{},h=a.biff==8,f=a.biff==5;if(Xe(s,2057,Tp(t,5,a)),a.bookType=="xla"&&Xe(s,135),Xe(s,225,h?lr(1200):null),Xe(s,193,fz(2)),f&&Xe(s,191),f&&Xe(s,192),Xe(s,226),Xe(s,92,bz("SheetJS",a)),Xe(s,66,lr(h?1200:1252)),h&&Xe(s,353,lr(0)),h&&Xe(s,448),Xe(s,317,Uz(t.SheetNames.length)),h&&t.vbaraw&&Xe(s,211),h&&t.vbaraw){var p=u.CodeName||"ThisWorkbook";Xe(s,442,Bj(p))}Xe(s,156,lr(17)),Xe(s,25,yn(!1)),Xe(s,18,yn(!1)),Xe(s,19,lr(0)),h&&Xe(s,431,yn(!1)),h&&Xe(s,444,lr(0)),Xe(s,61,wz()),Xe(s,64,yn(!1)),Xe(s,141,lr(0)),Xe(s,34,yn(ZN(t)=="true")),Xe(s,14,yn(!0)),h&&Xe(s,439,yn(!1)),Xe(s,218,lr(0)),R6(s,t,a),B6(s,t.SSF,a),D6(s,a),h&&Xe(s,352,yn(!1));var x=s.end(),j=Nn();h&&Xe(j,140,Iz()),h&&a.Strings&&C6(j,252,Sz(a.Strings)),Xe(j,10);var y=j.end(),S=Nn(),w=0,b=0;for(b=0;b<t.SheetNames.length;++b)w+=(h?12:11)+(h?2:1)*t.SheetNames[b].length;var _=x.length+w+y.length;for(b=0;b<t.SheetNames.length;++b){var E=c[b]||{};Xe(S,133,_z({pos:_,hs:E.Hidden||0,dt:0,name:t.SheetNames[b]},a)),_+=n[b].length}var z=S.end();if(w!=z.length)throw new Error("BS8 "+w+" != "+z.length);var N=[];return x.length&&N.push(x),z.length&&N.push(z),y.length&&N.push(y),nn(N)}function U6(t,n){var a=n||{},s=[];t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Wu(),Pu(t.SSF),a.revssf=Uu(t.SSF),a.revssf[t.SSF[65535]]=0,a.ssf=t.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Bp(a),a.cellXfs=[],qi(a.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var o=0;o<t.SheetNames.length;++o)s[s.length]=P6(o,a,t);return s.unshift(W6(t,s,a)),nn(s)}function lb(t,n){for(var a=0;a<=t.SheetNames.length;++a){var s=t.Sheets[t.SheetNames[a]];if(!(!s||!s["!ref"])){var o=Gn(s["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var c=n||{};switch(c.biff||2){case 8:case 5:return U6(t,n);case 4:case 3:case 2:return F6(t,n)}throw new Error("invalid type "+c.bookType+" for BIFF")}function $6(t,n,a,s){for(var o=t["!merges"]||[],c=[],u=n.s.c;u<=n.e.c;++u){for(var h=0,f=0,p=0;p<o.length;++p)if(!(o[p].s.r>a||o[p].s.c>u)&&!(o[p].e.r<a||o[p].e.c<u)){if(o[p].s.r<a||o[p].s.c<u){h=-1;break}h=o[p].e.r-o[p].s.r+1,f=o[p].e.c-o[p].s.c+1;break}if(!(h<0)){var x=ea({r:a,c:u}),j=s.dense?(t[a]||[])[u]:t[x],y=j&&j.v!=null&&(j.h||jk(j.w||(ci(j),j.w)||""))||"",S={};h>1&&(S.rowspan=h),f>1&&(S.colspan=f),s.editable?y='<span contenteditable="true">'+y+"</span>":j&&(S["data-t"]=j&&j.t||"z",j.v!=null&&(S["data-v"]=j.v),j.z!=null&&(S["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+j.l.Target+'">'+y+"</a>")),S.id=(s.id||"sjs")+"-"+x,c.push(Je("td",y,S))}}var w="<tr>";return w+c.join("")+"</tr>"}var H6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',V6="</body></html>";function Z6(t,n,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function ob(t,n){var a=n||{},s=a.header!=null?a.header:H6,o=a.footer!=null?a.footer:V6,c=[s],u=Gn(t["!ref"]);a.dense=Array.isArray(t),c.push(Z6(t,u,a));for(var h=u.s.r;h<=u.e.r;++h)c.push($6(t,u,h,a));return c.push("</table>"+o),c.join("")}function cb(t,n,a){var s=a||{},o=0,c=0;if(s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var u=typeof s.origin=="string"?Ga(s.origin):s.origin;o=u.r,c=u.c}var h=n.getElementsByTagName("tr"),f=Math.min(s.sheetRows||1e7,h.length),p={s:{r:0,c:0},e:{r:o,c}};if(t["!ref"]){var x=Gn(t["!ref"]);p.s.r=Math.min(p.s.r,x.s.r),p.s.c=Math.min(p.s.c,x.s.c),p.e.r=Math.max(p.e.r,x.e.r),p.e.c=Math.max(p.e.c,x.e.c),o==-1&&(p.e.r=o=x.e.r+1)}var j=[],y=0,S=t["!rows"]||(t["!rows"]=[]),w=0,b=0,_=0,E=0,z=0,N=0;for(t["!cols"]||(t["!cols"]=[]);w<h.length&&b<f;++w){var O=h[w];if(jv(O)){if(s.display)continue;S[b]={hidden:!0}}var Q=O.children;for(_=E=0;_<Q.length;++_){var U=Q[_];if(!(s.display&&jv(U))){var L=U.hasAttribute("data-v")?U.getAttribute("data-v"):U.hasAttribute("v")?U.getAttribute("v"):wk(U.innerHTML),H=U.getAttribute("data-z")||U.getAttribute("z");for(y=0;y<j.length;++y){var A=j[y];A.s.c==E+c&&A.s.r<b+o&&b+o<=A.e.r&&(E=A.e.c+1-c,y=-1)}N=+U.getAttribute("colspan")||1,((z=+U.getAttribute("rowspan")||1)>1||N>1)&&j.push({s:{r:b+o,c:E+c},e:{r:b+o+(z||1)-1,c:E+c+(N||1)-1}});var R={t:"s",v:L},G=U.getAttribute("data-t")||U.getAttribute("t")||"";L!=null&&(L.length==0?R.t=G||"z":s.raw||L.trim().length==0||G=="s"||(L==="TRUE"?R={t:"b",v:!0}:L==="FALSE"?R={t:"b",v:!1}:isNaN(ii(L))?isNaN(nc(L).getDate())||(R={t:"d",v:vn(L)},s.cellDates||(R={t:"n",v:An(R.v)}),R.z=s.dateNF||ka[14]):R={t:"n",v:ii(L)})),R.z===void 0&&H!=null&&(R.z=H);var F="",q=U.getElementsByTagName("A");if(q&&q.length)for(var ee=0;ee<q.length&&!(q[ee].hasAttribute("href")&&(F=q[ee].getAttribute("href"),F.charAt(0)!="#"));++ee);F&&F.charAt(0)!="#"&&(R.l={Target:F}),s.dense?(t[b+o]||(t[b+o]=[]),t[b+o][E+c]=R):t[ea({c:E+c,r:b+o})]=R,p.e.c<E+c&&(p.e.c=E+c),E+=N}}++b}return j.length&&(t["!merges"]=(t["!merges"]||[]).concat(j)),p.e.r=Math.max(p.e.r,b-1+o),t["!ref"]=La(p),b>=f&&(t["!fullref"]=La((p.e.r=h.length-w+b-1+o,p))),t}function db(t,n){var a=n||{},s=a.dense?[]:{};return cb(s,t,n)}function G6(t,n){return ws(db(t,n),n)}function jv(t){var n="",a=K6(t);return a&&(n=a(t).getPropertyValue("display")),n||(n=t.style&&t.style.display),n==="none"}function K6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var q6=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),n="<office:document-styles "+ic({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ma+n}})(),bv=(function(){var t=function(c){return Qt(c).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},n=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,s=function(c,u,h){var f=[];f.push('      <table:table table:name="'+Qt(u.SheetNames[h])+`" table:style-name="ta1">
`);var p=0,x=0,j=Gn(c["!ref"]||"A1"),y=c["!merges"]||[],S=0,w=Array.isArray(c);if(c["!cols"])for(x=0;x<=j.e.c;++x)f.push("        <table:table-column"+(c["!cols"][x]?' table:style-name="co'+c["!cols"][x].ods+'"':"")+`></table:table-column>
`);var b="",_=c["!rows"]||[];for(p=0;p<j.s.r;++p)b=_[p]?' table:style-name="ro'+_[p].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;p<=j.e.r;++p){for(b=_[p]?' table:style-name="ro'+_[p].ods+'"':"",f.push("        <table:table-row"+b+`>
`),x=0;x<j.s.c;++x)f.push(n);for(;x<=j.e.c;++x){var E=!1,z={},N="";for(S=0;S!=y.length;++S)if(!(y[S].s.c>x)&&!(y[S].s.r>p)&&!(y[S].e.c<x)&&!(y[S].e.r<p)){(y[S].s.c!=x||y[S].s.r!=p)&&(E=!0),z["table:number-columns-spanned"]=y[S].e.c-y[S].s.c+1,z["table:number-rows-spanned"]=y[S].e.r-y[S].s.r+1;break}if(E){f.push(a);continue}var O=ea({r:p,c:x}),Q=w?(c[p]||[])[x]:c[O];if(Q&&Q.f&&(z["table:formula"]=Qt(p4(Q.f)),Q.F&&Q.F.slice(0,O.length)==O)){var U=Gn(Q.F);z["table:number-matrix-columns-spanned"]=U.e.c-U.s.c+1,z["table:number-matrix-rows-spanned"]=U.e.r-U.s.r+1}if(!Q){f.push(n);continue}switch(Q.t){case"b":N=Q.v?"TRUE":"FALSE",z["office:value-type"]="boolean",z["office:boolean-value"]=Q.v?"true":"false";break;case"n":N=Q.w||String(Q.v||0),z["office:value-type"]="float",z["office:value"]=Q.v||0;break;case"s":case"str":N=Q.v==null?"":Q.v,z["office:value-type"]="string";break;case"d":N=Q.w||vn(Q.v).toISOString(),z["office:value-type"]="date",z["office:date-value"]=vn(Q.v).toISOString(),z["table:style-name"]="ce1";break;default:f.push(n);continue}var L=t(N);if(Q.l&&Q.l.Target){var H=Q.l.Target;H=H.charAt(0)=="#"?"#"+g4(H.slice(1)):H,H.charAt(0)!="#"&&!H.match(/^\w+:/)&&(H="../"+H),L=Je("text:a",L,{"xlink:href":H.replace(/&/g,"&amp;")})}f.push("          "+Je("table:table-cell",Je("text:p",L,{}),z)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},o=function(c,u){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var h=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var x=0;x<p["!cols"].length;++x)if(p["!cols"][x]){var j=p["!cols"][x];if(j.width==null&&j.wpx==null&&j.wch==null)continue;Np(j),j.ods=h;var y=p["!cols"][x].wpx+"px";c.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),c.push(`  </style:style>
`),++h}}});var f=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var x=0;x<p["!rows"].length;++x)if(p["!rows"][x]){p["!rows"][x].ods=f;var j=p["!rows"][x].hpx+"px";c.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+j+`"/>
`),c.push(`  </style:style>
`),++f}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(u,h){var f=[Ma],p=ic({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=ic({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(f.push("<office:document"+p+x+`>
`),f.push(kj().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+p+`>
`),o(f,u),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var j=0;j!=u.SheetNames.length;++j)f.push(s(u.Sheets[u.SheetNames[j]],u,j));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),h.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function ub(t,n){if(n.bookType=="fods")return bv(t,n);var a=yp(),s="",o=[],c=[];return s="mimetype",Ct(a,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ct(a,s,bv(t,n)),o.push([s,"text/xml"]),c.push([s,"ContentFile"]),s="styles.xml",Ct(a,s,q6(t,n)),o.push([s,"text/xml"]),c.push([s,"StylesFile"]),s="meta.xml",Ct(a,s,Ma+kj()),o.push([s,"text/xml"]),c.push([s,"MetadataFile"]),s="manifest.rdf",Ct(a,s,lz(c)),o.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ct(a,s,iz(o)),a}function Eu(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Y6(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):wr(rc(t))}function J6(t,n){e:for(var a=0;a<=t.length-n.length;++a){for(var s=0;s<n.length;++s)if(t[a+s]!=n[s])continue e;return!0}return!1}function Ki(t){var n=t.reduce(function(o,c){return o+c.length},0),a=new Uint8Array(n),s=0;return t.forEach(function(o){a.set(o,s),s+=o.length}),a}function X6(t,n,a){var s=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,o=a/Math.pow(10,s-6176);t[n+15]|=s>>7,t[n+14]|=(s&127)<<1;for(var c=0;o>=1;++c,o/=256)t[n+c]=o&255;t[n+15]|=a>=0?0:128}function sc(t,n){var a=n?n[0]:0,s=t[a]&127;e:if(t[a++]>=128&&(s|=(t[a]&127)<<7,t[a++]<128||(s|=(t[a]&127)<<14,t[a++]<128)||(s|=(t[a]&127)<<21,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,28),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,35),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,42),++a,t[a++]<128)))break e;return n&&(n[0]=a),s}function Jt(t){var n=new Uint8Array(7);n[0]=t&127;var a=1;e:if(t>127){if(n[a-1]|=128,n[a]=t>>7&127,++a,t<=16383||(n[a-1]|=128,n[a]=t>>14&127,++a,t<=2097151)||(n[a-1]|=128,n[a]=t>>21&127,++a,t<=268435455)||(n[a-1]|=128,n[a]=t/256>>>21&127,++a,t<=34359738367)||(n[a-1]|=128,n[a]=t/65536>>>21&127,++a,t<=4398046511103))break e;n[a-1]|=128,n[a]=t/16777216>>>21&127,++a}return n.slice(0,a)}function _l(t){var n=0,a=t[n]&127;e:if(t[n++]>=128){if(a|=(t[n]&127)<<7,t[n++]<128||(a|=(t[n]&127)<<14,t[n++]<128)||(a|=(t[n]&127)<<21,t[n++]<128))break e;a|=(t[n]&127)<<28}return a}function $a(t){for(var n=[],a=[0];a[0]<t.length;){var s=a[0],o=sc(t,a),c=o&7;o=Math.floor(o/8);var u=0,h;if(o==0)break;switch(c){case 0:{for(var f=a[0];t[a[0]++]>=128;);h=t.slice(f,a[0])}break;case 5:u=4,h=t.slice(a[0],a[0]+u),a[0]+=u;break;case 1:u=8,h=t.slice(a[0],a[0]+u),a[0]+=u;break;case 2:u=sc(t,a),h=t.slice(a[0],a[0]+u),a[0]+=u;break;default:throw new Error("PB Type ".concat(c," for Field ").concat(o," at offset ").concat(s))}var p={data:h,type:c};n[o]==null?n[o]=[p]:n[o].push(p)}return n}function en(t){var n=[];return t.forEach(function(a,s){a.forEach(function(o){o.data&&(n.push(Jt(s*8+o.type)),o.type==2&&n.push(Jt(o.data.length)),n.push(o.data))})}),Ki(n)}function vr(t){for(var n,a=[],s=[0];s[0]<t.length;){var o=sc(t,s),c=$a(t.slice(s[0],s[0]+o));s[0]+=o;var u={id:_l(c[1][0].data),messages:[]};c[2].forEach(function(h){var f=$a(h.data),p=_l(f[3][0].data);u.messages.push({meta:f,data:t.slice(s[0],s[0]+p)}),s[0]+=p}),(n=c[3])!=null&&n[0]&&(u.merge=_l(c[3][0].data)>>>0>0),a.push(u)}return a}function ul(t){var n=[];return t.forEach(function(a){var s=[];s[1]=[{data:Jt(a.id),type:0}],s[2]=[],a.merge!=null&&(s[3]=[{data:Jt(+!!a.merge),type:0}]);var o=[];a.messages.forEach(function(u){o.push(u.data),u.meta[3]=[{type:0,data:Jt(u.data.length)}],s[2].push({data:en(u.meta),type:2})});var c=en(s);n.push(Jt(c.length)),n.push(c),o.forEach(function(u){return n.push(u)})}),Ki(n)}function Q6(t,n){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var a=[0],s=sc(n,a),o=[];a[0]<n.length;){var c=n[a[0]]&3;if(c==0){var u=n[a[0]++]>>2;if(u<60)++u;else{var h=u-59;u=n[a[0]],h>1&&(u|=n[a[0]+1]<<8),h>2&&(u|=n[a[0]+2]<<16),h>3&&(u|=n[a[0]+3]<<24),u>>>=0,u++,a[0]+=h}o.push(n.slice(a[0],a[0]+u)),a[0]+=u;continue}else{var f=0,p=0;if(c==1?(p=(n[a[0]]>>2&7)+4,f=(n[a[0]++]&224)<<3,f|=n[a[0]++]):(p=(n[a[0]++]>>2)+1,c==2?(f=n[a[0]]|n[a[0]+1]<<8,a[0]+=2):(f=(n[a[0]]|n[a[0]+1]<<8|n[a[0]+2]<<16|n[a[0]+3]<<24)>>>0,a[0]+=4)),o=[Ki(o)],f==0)throw new Error("Invalid offset 0");if(f>o[0].length)throw new Error("Invalid offset beyond length");if(p>=f)for(o.push(o[0].slice(-f)),p-=f;p>=o[o.length-1].length;)o.push(o[o.length-1]),p-=o[o.length-1].length;o.push(o[0].slice(-f,-f+p))}}var x=Ki(o);if(x.length!=s)throw new Error("Unexpected length: ".concat(x.length," != ").concat(s));return x}function jr(t){for(var n=[],a=0;a<t.length;){var s=t[a++],o=t[a]|t[a+1]<<8|t[a+2]<<16;a+=3,n.push(Q6(s,t.slice(a,a+o))),a+=o}if(a!==t.length)throw new Error("data is not a valid framed stream!");return Ki(n)}function fl(t){for(var n=[],a=0;a<t.length;){var s=Math.min(t.length-a,268435455),o=new Uint8Array(4);n.push(o);var c=Jt(s),u=c.length;n.push(c),s<=60?(u++,n.push(new Uint8Array([s-1<<2]))):s<=256?(u+=2,n.push(new Uint8Array([240,s-1&255]))):s<=65536?(u+=3,n.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(u+=4,n.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(u+=5,n.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),n.push(t.slice(a,a+s)),u+=s,o[0]=0,o[1]=u&255,o[2]=u>>8&255,o[3]=u>>16&255,a+=s}return Ki(n)}function um(t,n){var a=new Uint8Array(32),s=Eu(a),o=12,c=0;switch(a[0]=5,t.t){case"n":a[1]=2,X6(a,o,t.v),c|=1,o+=16;break;case"b":a[1]=6,s.setFloat64(o,t.v?1:0,!0),c|=2,o+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));a[1]=3,s.setUint32(o,n.indexOf(t.v),!0),c|=8,o+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,c,!0),a.slice(0,o)}function fm(t,n){var a=new Uint8Array(32),s=Eu(a),o=12,c=0;switch(a[0]=3,t.t){case"n":a[2]=2,s.setFloat64(o,t.v,!0),c|=32,o+=8;break;case"b":a[2]=6,s.setFloat64(o,t.v?1:0,!0),c|=32,o+=8;break;case"s":if(n.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));a[2]=3,s.setUint32(o,n.indexOf(t.v),!0),c|=16,o+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,c,!0),a.slice(0,o)}function Ii(t){var n=$a(t);return sc(n[1][0].data)}function eA(t,n,a){var s,o,c,u;if(!((s=t[6])!=null&&s[0])||!((o=t[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var h=((u=(c=t[8])==null?void 0:c[0])==null?void 0:u.data)&&_l(t[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var f=0,p=Eu(t[7][0].data),x=0,j=[],y=Eu(t[4][0].data),S=0,w=[],b=0;b<n.length;++b){if(n[b]==null){p.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}p.setUint16(b*2,x,!0),y.setUint16(b*2,S,!0);var _,E;switch(typeof n[b]){case"string":_=um({t:"s",v:n[b]},a),E=fm({t:"s",v:n[b]},a);break;case"number":_=um({t:"n",v:n[b]},a),E=fm({t:"n",v:n[b]},a);break;case"boolean":_=um({t:"b",v:n[b]},a),E=fm({t:"b",v:n[b]},a);break;default:throw new Error("Unsupported value "+n[b])}j.push(_),x+=_.length,w.push(E),S+=E.length,++f}for(t[2][0].data=Jt(f);b<t[7][0].data.length/2;++b)p.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return t[6][0].data=Ki(j),t[3][0].data=Ki(w),f}function tA(t,n){if(!n||!n.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Gn(a["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>9&&(o=!0,s.e.c=9),s.e.r>49&&(o=!0,s.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(La(s)));var c=Fu(a,{range:s,header:1}),u=["~Sh33tJ5~"];c.forEach(function(C){return C.forEach(function(k){typeof k=="string"&&u.push(k)})});var h={},f=[],p=ia.read(n.numbers,{type:"base64"});p.FileIndex.map(function(C,k){return[C,p.FullPaths[k]]}).forEach(function(C){var k=C[0],I=C[1];if(k.type==2&&k.name.match(/\.iwa/)){var D=k.content,de=jr(D),he=vr(de);he.forEach(function(ie){f.push(ie.id),h[ie.id]={deps:[],location:I,type:_l(ie.messages[0].meta[1][0].data)}})}}),f.sort(function(C,k){return C-k});var x=f.filter(function(C){return C>1}).map(function(C){return[C,Jt(C)]});p.FileIndex.map(function(C,k){return[C,p.FullPaths[k]]}).forEach(function(C){var k=C[0];if(C[1],!!k.name.match(/\.iwa/)){var I=vr(jr(k.content));I.forEach(function(D){D.messages.forEach(function(de){x.forEach(function(he){D.messages.some(function(ie){return _l(ie.meta[1][0].data)!=11006&&J6(ie.data,he[1])})&&h[he[0]].deps.push(D.id)})})})}});for(var j=ia.find(p,h[1].location),y=vr(jr(j.content)),S,w=0;w<y.length;++w){var b=y[w];b.id==1&&(S=b)}var _=Ii($a(S.messages[0].data)[1][0].data);for(j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Ii($a(S.messages[0].data)[2][0].data),j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Ii($a(S.messages[0].data)[2][0].data),j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);var E=$a(S.messages[0].data);{E[6][0].data=Jt(s.e.r+1),E[7][0].data=Jt(s.e.c+1);var z=Ii(E[46][0].data),N=ia.find(p,h[z].location),O=vr(jr(N.content));{for(var Q=0;Q<O.length&&O[Q].id!=z;++Q);if(O[Q].id!=z)throw"Bad ColumnRowUIDMapArchive";var U=$a(O[Q].messages[0].data);U[1]=[],U[2]=[],U[3]=[];for(var L=0;L<=s.e.c;++L){var H=[];H[1]=H[2]=[{type:0,data:Jt(L+420690)}],U[1].push({type:2,data:en(H)}),U[2].push({type:0,data:Jt(L)}),U[3].push({type:0,data:Jt(L)})}U[4]=[],U[5]=[],U[6]=[];for(var A=0;A<=s.e.r;++A)H=[],H[1]=H[2]=[{type:0,data:Jt(A+726270)}],U[4].push({type:2,data:en(H)}),U[5].push({type:0,data:Jt(A)}),U[6].push({type:0,data:Jt(A)});O[Q].messages[0].data=en(U)}N.content=fl(ul(O)),N.size=N.content.length,delete E[46];var R=$a(E[4][0].data);{R[7][0].data=Jt(s.e.r+1);var G=$a(R[1][0].data),F=Ii(G[2][0].data);N=ia.find(p,h[F].location),O=vr(jr(N.content));{if(O[0].id!=F)throw"Bad HeaderStorageBucket";var q=$a(O[0].messages[0].data);for(A=0;A<c.length;++A){var ee=$a(q[2][0].data);ee[1][0].data=Jt(A),ee[4][0].data=Jt(c[A].length),q[2][A]={type:q[2][0].type,data:en(ee)}}O[0].messages[0].data=en(q)}N.content=fl(ul(O)),N.size=N.content.length;var me=Ii(R[2][0].data);N=ia.find(p,h[me].location),O=vr(jr(N.content));{if(O[0].id!=me)throw"Bad HeaderStorageBucket";for(q=$a(O[0].messages[0].data),L=0;L<=s.e.c;++L)ee=$a(q[2][0].data),ee[1][0].data=Jt(L),ee[4][0].data=Jt(s.e.r+1),q[2][L]={type:q[2][0].type,data:en(ee)};O[0].messages[0].data=en(q)}N.content=fl(ul(O)),N.size=N.content.length;var W=Ii(R[4][0].data);(function(){for(var C=ia.find(p,h[W].location),k=vr(jr(C.content)),I,D=0;D<k.length;++D){var de=k[D];de.id==W&&(I=de)}var he=$a(I.messages[0].data);{he[3]=[];var ie=[];u.forEach(function(fe,_e){ie[1]=[{type:0,data:Jt(_e)}],ie[2]=[{type:0,data:Jt(1)}],ie[3]=[{type:2,data:Y6(fe)}],he[3].push({type:2,data:en(ie)})})}I.messages[0].data=en(he);var ve=ul(k),je=fl(ve);C.content=je,C.size=C.content.length})();var J=$a(R[3][0].data);{var M=J[1][0];delete J[2];var V=$a(M.data);{var ne=Ii(V[2][0].data);(function(){for(var C=ia.find(p,h[ne].location),k=vr(jr(C.content)),I,D=0;D<k.length;++D){var de=k[D];de.id==ne&&(I=de)}var he=$a(I.messages[0].data);{delete he[6],delete J[7];var ie=new Uint8Array(he[5][0].data);he[5]=[];for(var ve=0,je=0;je<=s.e.r;++je){var fe=$a(ie);ve+=eA(fe,c[je],u),fe[1][0].data=Jt(je),he[5].push({data:en(fe),type:2})}he[1]=[{type:0,data:Jt(s.e.c+1)}],he[2]=[{type:0,data:Jt(s.e.r+1)}],he[3]=[{type:0,data:Jt(ve)}],he[4]=[{type:0,data:Jt(s.e.r+1)}]}I.messages[0].data=en(he);var _e=ul(k),Se=fl(_e);C.content=Se,C.size=C.content.length})()}M.data=en(V)}R[3][0].data=en(J)}E[4][0].data=en(R)}S.messages[0].data=en(E);var P=ul(y),T=fl(P);return j.content=T,j.size=j.content.length,p}function aA(t){return function(a){for(var s=0;s!=t.length;++s){var o=t[s];a[o[0]]===void 0&&(a[o[0]]=o[1]),o[2]==="n"&&(a[o[0]]=Number(a[o[0]]))}}}function Bp(t){aA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function nA(t,n){return n.bookType=="ods"?ub(t,n):n.bookType=="numbers"?tA(t,n):n.bookType=="xlsb"?rA(t,n):iA(t,n)}function rA(t,n){yl=1024,t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Wu(),Pu(t.SSF),n.revssf=Uu(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Yo?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a=n.bookType=="xlsb"?"bin":"xml",s=Gj.indexOf(n.bookType)>-1,o=_j();Bp(n=n||{});var c=yp(),u="",h=0;if(n.cellXfs=[],qi(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",Ct(c,u,zj(t.Props,n)),o.coreprops.push(u),Xt(n.rels,2,u,$t.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],p=0;p<t.SheetNames.length;++p)(t.Workbook.Sheets[p]||{}).Hidden!=2&&f.push(t.SheetNames[p]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Ct(c,u,Tj(t.Props)),o.extprops.push(u),Xt(n.rels,3,u,$t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(u="docProps/custom.xml",Ct(c,u,Nj(t.Custprops)),o.custprops.push(u),Xt(n.rels,4,u,$t.CUST_PROPS)),h=1;h<=t.SheetNames.length;++h){var x={"!id":{}},j=t.Sheets[t.SheetNames[h-1]],y=(j||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+h+"."+a,Ct(c,u,l6(h-1,u,n,t,x)),o.sheets.push(u),Xt(n.wbrels,-1,"worksheets/sheet"+h+"."+a,$t.WS[0]),j){var S=j["!comments"],w=!1,b="";S&&S.length>0&&(b="xl/comments"+h+"."+a,Ct(c,b,d6(S,b)),o.comments.push(b),Xt(x,-1,"../comments"+h+"."+a,$t.CMNT),w=!0),j["!legacy"]&&w&&Ct(c,"xl/drawings/vmlDrawing"+h+".vml",Vj(h,j["!comments"])),delete j["!comments"],delete j["!legacy"]}x["!id"].rId1&&Ct(c,wj(u),jl(x))}return n.Strings!=null&&n.Strings.length>0&&(u="xl/sharedStrings."+a,Ct(c,u,c6(n.Strings,u,n)),o.strs.push(u),Xt(n.wbrels,-1,"sharedStrings."+a,$t.SST)),u="xl/workbook."+a,Ct(c,u,s6(t,u)),o.workbooks.push(u),Xt(n.rels,1,u,$t.WB),u="xl/theme/theme1.xml",Ct(c,u,$j(t.Themes,n)),o.themes.push(u),Xt(n.wbrels,-1,"theme/theme1.xml",$t.THEME),u="xl/styles."+a,Ct(c,u,o6(t,u,n)),o.styles.push(u),Xt(n.wbrels,-1,"styles."+a,$t.STY),t.vbaraw&&s&&(u="xl/vbaProject.bin",Ct(c,u,t.vbaraw),o.vba.push(u),Xt(n.wbrels,-1,"vbaProject.bin",$t.VBA)),u="xl/metadata."+a,Ct(c,u,u6(u)),o.metadata.push(u),Xt(n.wbrels,-1,"metadata."+a,$t.XLMETA),Ct(c,"[Content_Types].xml",Sj(o,n)),Ct(c,"_rels/.rels",jl(n.rels)),Ct(c,"xl/_rels/workbook."+a+".rels",jl(n.wbrels)),delete n.revssf,delete n.ssf,c}function iA(t,n){yl=1024,t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Wu(),Pu(t.SSF),n.revssf=Uu(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.rels={},n.wbrels={},n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Yo?n.revStrings=new Map:(n.revStrings={},n.revStrings.foo=[],delete n.revStrings.foo);var a="xml",s=Gj.indexOf(n.bookType)>-1,o=_j();Bp(n=n||{});var c=yp(),u="",h=0;if(n.cellXfs=[],qi(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",Ct(c,u,zj(t.Props,n)),o.coreprops.push(u),Xt(n.rels,2,u,$t.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],p=0;p<t.SheetNames.length;++p)(t.Workbook.Sheets[p]||{}).Hidden!=2&&f.push(t.SheetNames[p]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Ct(c,u,Tj(t.Props)),o.extprops.push(u),Xt(n.rels,3,u,$t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(u="docProps/custom.xml",Ct(c,u,Nj(t.Custprops)),o.custprops.push(u),Xt(n.rels,4,u,$t.CUST_PROPS));var x=["SheetJ5"];for(n.tcid=0,h=1;h<=t.SheetNames.length;++h){var j={"!id":{}},y=t.Sheets[t.SheetNames[h-1]],S=(y||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+h+"."+a,Ct(c,u,ab(h-1,n,t,j)),o.sheets.push(u),Xt(n.wbrels,-1,"worksheets/sheet"+h+"."+a,$t.WS[0]),y){var w=y["!comments"],b=!1,_="";if(w&&w.length>0){var E=!1;w.forEach(function(z){z[1].forEach(function(N){N.T==!0&&(E=!0)})}),E&&(_="xl/threadedComments/threadedComment"+h+"."+a,Ct(c,_,DC(w,x,n)),o.threadedcomments.push(_),Xt(j,-1,"../threadedComments/threadedComment"+h+"."+a,$t.TCMNT)),_="xl/comments"+h+"."+a,Ct(c,_,Zj(w)),o.comments.push(_),Xt(j,-1,"../comments"+h+"."+a,$t.CMNT),b=!0}y["!legacy"]&&b&&Ct(c,"xl/drawings/vmlDrawing"+h+".vml",Vj(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}j["!id"].rId1&&Ct(c,wj(u),jl(j))}return n.Strings!=null&&n.Strings.length>0&&(u="xl/sharedStrings."+a,Ct(c,u,Lj(n.Strings,n)),o.strs.push(u),Xt(n.wbrels,-1,"sharedStrings."+a,$t.SST)),u="xl/workbook."+a,Ct(c,u,ib(t)),o.workbooks.push(u),Xt(n.rels,1,u,$t.WB),u="xl/theme/theme1.xml",Ct(c,u,$j(t.Themes,n)),o.themes.push(u),Xt(n.wbrels,-1,"theme/theme1.xml",$t.THEME),u="xl/styles."+a,Ct(c,u,Wj(t,n)),o.styles.push(u),Xt(n.wbrels,-1,"styles."+a,$t.STY),t.vbaraw&&s&&(u="xl/vbaProject.bin",Ct(c,u,t.vbaraw),o.vba.push(u),Xt(n.wbrels,-1,"vbaProject.bin",$t.VBA)),u="xl/metadata."+a,Ct(c,u,Hj()),o.metadata.push(u),Xt(n.wbrels,-1,"metadata."+a,$t.XLMETA),x.length>1&&(u="xl/persons/person.xml",Ct(c,u,LC(x)),o.people.push(u),Xt(n.wbrels,-1,"persons/person.xml",$t.PEOPLE)),Ct(c,"[Content_Types].xml",Sj(o,n)),Ct(c,"_rels/.rels",jl(n.rels)),Ct(c,"xl/_rels/workbook."+a+".rels",jl(n.wbrels)),delete n.revssf,delete n.ssf,c}function sA(t,n){var a="";switch((n||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":a=oi(t.slice(0,12));break;case"binary":a=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function fb(t,n){switch(n.type){case"base64":case"binary":break;case"buffer":case"array":n.type="";break;case"file":return pc(n.file,ia.write(t,{type:Vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");default:throw new Error("Unrecognized type "+n.type)}return ia.write(t,n)}function lA(t,n){var a=En(n||{}),s=nA(t,a);return oA(s,a)}function oA(t,n){var a={},s=Vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(n.compression&&(a.compression="DEFLATE"),n.password)a.type=s;else switch(n.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+n.bookType+"' files");case"buffer":case"file":a.type=s;break;default:throw new Error("Unrecognized type "+n.type)}var o=t.FullPaths?ia.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!n.compression}):t.generate(a);if(typeof Deno<"u"&&typeof o=="string"){if(n.type=="binary"||n.type=="base64")return o;o=new Uint8Array(Iu(o))}return n.password&&typeof encrypt_agile<"u"?fb(encrypt_agile(o,n.password),n):n.type==="file"?pc(n.file,o):n.type=="string"?Zo(o):o}function cA(t,n){var a=n||{},s=k6(t,a);return fb(s,a)}function Br(t,n,a){a||(a="");var s=a+t;switch(n.type){case"base64":return ac(rc(s));case"binary":return rc(s);case"string":return t;case"file":return pc(n.file,s,"utf8");case"buffer":return Vt?di(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Br(s,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function dA(t,n){switch(n.type){case"base64":return ac(t);case"binary":return t;case"string":return t;case"file":return pc(n.file,t,"binary");case"buffer":return Vt?di(t,"binary"):t.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+n.type)}function $d(t,n){switch(n.type){case"string":case"base64":case"binary":for(var a="",s=0;s<t.length;++s)a+=String.fromCharCode(t[s]);return n.type=="base64"?ac(a):n.type=="string"?Zo(a):a;case"file":return pc(n.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+n.type)}}function hb(t,n){M2(),qN(t);var a=En(n||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var s=hb(t,a);return a.type="array",Iu(s)}var o=0;if(a.sheet&&(typeof a.sheet=="number"?o=a.sheet:o=t.SheetNames.indexOf(a.sheet),!t.SheetNames[o]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return Br(S6(t,a),a);case"slk":case"sylk":return Br(Zz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"htm":case"html":return Br(ob(t.Sheets[t.SheetNames[o]],a),a);case"txt":return dA(mb(t.Sheets[t.SheetNames[o]],a),a);case"csv":return Br(Op(t.Sheets[t.SheetNames[o]],a),a,"\uFEFF");case"dif":return Br(Gz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"dbf":return $d(Vz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"prn":return Br(Kz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"rtf":return Br(tC.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"eth":return Br(Dj.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"fods":return Br(ub(t,a),a);case"wk1":return $d(mv.sheet_to_wk1(t.Sheets[t.SheetNames[o]],a),a);case"wk3":return $d(mv.book_to_wk3(t,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),$d(lb(t,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),cA(t,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lA(t,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function uA(t){if(!t.bookType){var n={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(t.bookType=a.slice(1)),t.bookType=n[t.bookType]||t.bookType}}function fA(t,n,a){var s={};return s.type="file",s.file=n,uA(s),hb(t,s)}function hA(t,n,a,s,o,c,u,h){var f=sn(a),p=h.defval,x=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),j=!0,y=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:a,enumerable:!1})}catch{y.__rowNum__=a}else y.__rowNum__=a;if(!u||t[a])for(var S=n.s.c;S<=n.e.c;++S){var w=u?t[a][S]:t[s[S]+f];if(w===void 0||w.t===void 0){if(p===void 0)continue;c[S]!=null&&(y[c[S]]=p);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(c[S]!=null){if(b==null)if(w.t=="e"&&b===null)y[c[S]]=null;else if(p!==void 0)y[c[S]]=p;else if(x&&b===null)y[c[S]]=null;else continue;else y[c[S]]=x&&(w.t!=="n"||w.t==="n"&&h.rawNumbers!==!1)?b:ci(w,b,h);b!=null&&(j=!1)}}return{row:y,isempty:j}}function Fu(t,n){if(t==null||t["!ref"]==null)return[];var a={t:"n",v:0},s=0,o=1,c=[],u=0,h="",f={s:{r:0,c:0},e:{r:0,c:0}},p=n||{},x=p.range!=null?p.range:t["!ref"];switch(p.header===1?s=1:p.header==="A"?s=2:Array.isArray(p.header)?s=3:p.header==null&&(s=0),typeof x){case"string":f=pa(x);break;case"number":f=pa(t["!ref"]),f.s.r=x;break;default:f=x}s>0&&(o=0);var j=sn(f.s.r),y=[],S=[],w=0,b=0,_=Array.isArray(t),E=f.s.r,z=0,N={};_&&!t[E]&&(t[E]=[]);var O=p.skipHidden&&t["!cols"]||[],Q=p.skipHidden&&t["!rows"]||[];for(z=f.s.c;z<=f.e.c;++z)if(!(O[z]||{}).hidden)switch(y[z]=fn(z),a=_?t[E][z]:t[y[z]+j],s){case 1:c[z]=z-f.s.c;break;case 2:c[z]=y[z];break;case 3:c[z]=p.header[z-f.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),h=u=ci(a,null,p),b=N[u]||0,!b)N[u]=1;else{do h=u+"_"+b++;while(N[h]);N[u]=b,N[h]=1}c[z]=h}for(E=f.s.r+o;E<=f.e.r;++E)if(!(Q[E]||{}).hidden){var U=hA(t,f,E,y,s,c,_,p);(U.isempty===!1||(s===1?p.blankrows!==!1:p.blankrows))&&(S[w++]=U.row)}return S.length=w,S}var _v=/"/g;function mA(t,n,a,s,o,c,u,h){for(var f=!0,p=[],x="",j=sn(a),y=n.s.c;y<=n.e.c;++y)if(s[y]){var S=h.dense?(t[a]||[])[y]:t[s[y]+j];if(S==null)x="";else if(S.v!=null){f=!1,x=""+(h.rawNumbers&&S.t=="n"?S.v:ci(S,null,h));for(var w=0,b=0;w!==x.length;++w)if((b=x.charCodeAt(w))===o||b===c||b===34||h.forceQuotes){x='"'+x.replace(_v,'""')+'"';break}x=="ID"&&(x='"ID"')}else S.f!=null&&!S.F?(f=!1,x="="+S.f,x.indexOf(",")>=0&&(x='"'+x.replace(_v,'""')+'"')):x="";p.push(x)}return h.blankrows===!1&&f?null:p.join(u)}function Op(t,n){var a=[],s=n??{};if(t==null||t["!ref"]==null)return"";var o=pa(t["!ref"]),c=s.FS!==void 0?s.FS:",",u=c.charCodeAt(0),h=s.RS!==void 0?s.RS:`
`,f=h.charCodeAt(0),p=new RegExp((c=="|"?"\\|":c)+"+$"),x="",j=[];s.dense=Array.isArray(t);for(var y=s.skipHidden&&t["!cols"]||[],S=s.skipHidden&&t["!rows"]||[],w=o.s.c;w<=o.e.c;++w)(y[w]||{}).hidden||(j[w]=fn(w));for(var b=0,_=o.s.r;_<=o.e.r;++_)(S[_]||{}).hidden||(x=mA(t,o,_,j,u,f,c,s),x!=null&&(s.strip&&(x=x.replace(p,"")),(x||s.blankrows!==!1)&&a.push((b++?h:"")+x)));return delete s.dense,a.join("")}function mb(t,n){n||(n={}),n.FS="	",n.RS=`
`;var a=Op(t,n);return a}function pA(t){var n="",a,s="";if(t==null||t["!ref"]==null)return[];var o=pa(t["!ref"]),c="",u=[],h,f=[],p=Array.isArray(t);for(h=o.s.c;h<=o.e.c;++h)u[h]=fn(h);for(var x=o.s.r;x<=o.e.r;++x)for(c=sn(x),h=o.s.c;h<=o.e.c;++h)if(n=u[h]+c,a=p?(t[x]||[])[h]:t[n],s="",a!==void 0){if(a.F!=null){if(n=a.F,!a.f)continue;s=a.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}f[f.length]=n+"="+s}return f}function pb(t,n,a){var s=a||{},o=+!s.skipHeader,c=t||{},u=0,h=0;if(c&&s.origin!=null)if(typeof s.origin=="number")u=s.origin;else{var f=typeof s.origin=="string"?Ga(s.origin):s.origin;u=f.r,h=f.c}var p,x={s:{c:0,r:0},e:{c:h,r:u+n.length-1+o}};if(c["!ref"]){var j=pa(c["!ref"]);x.e.c=Math.max(x.e.c,j.e.c),x.e.r=Math.max(x.e.r,j.e.r),u==-1&&(u=j.e.r+1,x.e.r=u+n.length-1+o)}else u==-1&&(u=0,x.e.r=n.length-1+o);var y=s.header||[],S=0;n.forEach(function(b,_){ln(b).forEach(function(E){(S=y.indexOf(E))==-1&&(y[S=y.length]=E);var z=b[E],N="z",O="",Q=ea({c:h+S,r:u+_+o});p=lc(c,Q),z&&typeof z=="object"&&!(z instanceof Date)?c[Q]=z:(typeof z=="number"?N="n":typeof z=="boolean"?N="b":typeof z=="string"?N="s":z instanceof Date?(N="d",s.cellDates||(N="n",z=An(z)),O=s.dateNF||ka[14]):z===null&&s.nullError&&(N="e",z=0),p?(p.t=N,p.v=z,delete p.w,delete p.R,O&&(p.z=O)):c[Q]=p={t:N,v:z},O&&(p.z=O))})}),x.e.c=Math.max(x.e.c,h+y.length-1);var w=sn(u);if(o)for(S=0;S<y.length;++S)c[fn(S+h)+w]={t:"s",v:y[S]};return c["!ref"]=La(x),c}function gA(t,n){return pb(null,t,n)}function lc(t,n,a){if(typeof n=="string"){if(Array.isArray(t)){var s=Ga(n);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[n]||(t[n]={t:"z"})}return typeof n!="number"?lc(t,ea(n)):lc(t,ea({r:n,c:a||0}))}function xA(t,n){if(typeof n=="number"){if(n>=0&&t.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var a=t.SheetNames.indexOf(n);if(a>-1)return a;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function yA(){return{SheetNames:[],Sheets:{}}}function vA(t,n,a,s){var o=1;if(!a)for(;o<=65535&&t.SheetNames.indexOf(a="Sheet"+o)!=-1;++o,a=void 0);if(!a||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(a)>=0){var c=a.match(/(^.*?)(\d+)$/);o=c&&+c[2]||0;var u=c&&c[1]||a;for(++o;o<=65535&&t.SheetNames.indexOf(a=u+o)!=-1;++o);}if(rb(a),t.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return t.SheetNames.push(a),t.Sheets[a]=n,a}function jA(t,n,a){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=xA(t,n);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}t.Workbook.Sheets[s].Hidden=a}function bA(t,n){return t.z=n,t}function gb(t,n,a){return n?(t.l={Target:n},a&&(t.l.Tooltip=a)):delete t.l,t}function _A(t,n,a){return gb(t,"#"+n,a)}function SA(t,n,a){t.c||(t.c=[]),t.c.push({t:n,a:a||"SheetJS"})}function wA(t,n,a,s){for(var o=typeof n!="string"?n:pa(n),c=typeof n=="string"?n:La(n),u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=lc(t,u,h);f.t="n",f.F=c,delete f.v,u==o.s.r&&h==o.s.c&&(f.f=a,s&&(f.D=!0))}return t}var hm={encode_col:fn,encode_row:sn,encode_cell:ea,encode_range:La,decode_col:wp,decode_row:Sp,split_cell:Mk,decode_cell:Ga,decode_range:Gn,format_cell:ci,sheet_add_aoa:gj,sheet_add_json:pb,sheet_add_dom:cb,aoa_to_sheet:Al,json_to_sheet:gA,table_to_sheet:db,table_to_book:G6,sheet_to_csv:Op,sheet_to_txt:mb,sheet_to_json:Fu,sheet_to_html:ob,sheet_to_formulae:pA,sheet_to_row_object_array:Fu,sheet_get_cell:lc,book_new:yA,book_append_sheet:vA,book_set_sheet_visibility:jA,cell_set_number_format:bA,cell_set_hyperlink:gb,cell_set_internal_link:_A,cell_add_comment:SA,sheet_set_array_formula:wA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function xb(t,n){if(n.format)return n.format(t);const a=t[n.key];return a==null?"":a instanceof Date?a.toISOString().slice(0,10):String(a)}function kA(t,n,a){const s=h=>{const f=String(h);return f.includes(",")||f.includes('"')||f.includes(`
`)?`"${f.replace(/"/g,'""')}"`:f},o=n.map(h=>s(h.header)).join(","),c=t.map(h=>n.map(f=>s(xb(h,f))).join(",")).join(`
`),u=new Blob(["\uFEFF"+o+`
`+c],{type:"text/csv;charset=utf-8;"});CA(u,`${a}.csv`)}function zA(t,n,a){const s=[n.map(u=>u.header),...t.map(u=>n.map(h=>xb(u,h)))],o=hm.aoa_to_sheet(s),c=hm.book_new();hm.book_append_sheet(c,o,"Dane"),fA(c,`${a}.xlsx`)}function CA(t,n){const a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=n,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}function ma(t){const{filteredCount:n,totalCount:a,unitLabel:s="rekordow",search:o,onSearchChange:c,searchPlaceholder:u="Szukaj...",showFilters:h,onToggleFilters:f,hasActiveFilters:p,onClearFilters:x,columns:j,visibleColumns:y,onToggleColumn:S,data:w,exportFilename:b="export",primaryLabel:_,onPrimaryAction:E,secondaryActions:z}=t,[N,O]=m.useState(!1),[Q,U]=m.useState(!1),L=m.useRef(null),H=m.useRef(null);m.useEffect(()=>{const R=G=>{L.current&&!L.current.contains(G.target)&&O(!1),H.current&&!H.current.contains(G.target)&&U(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const A=j.filter(R=>y.has(R.key)).map(R=>({key:R.key,header:R.header,format:R.format}));return e.jsxs("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8},children:[e.jsxs("div",{className:"toolbar-left",style:{alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",whiteSpace:"nowrap"},children:[n!==a?`${n} / ${a}`:a," ",s]}),e.jsx("input",{className:"form-control",style:{width:200,padding:"5px 10px",fontSize:12},placeholder:u,value:o,onChange:R=>c(R.target.value)}),f&&e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:h||p?"var(--blue)":void 0,fontWeight:p?600:void 0},onClick:f,children:["Filtry kolumn ",h?"":"",p&&e.jsx("span",{style:{display:"inline-block",width:6,height:6,borderRadius:"50%",background:"var(--blue)",marginLeft:4,verticalAlign:"middle"}})]}),p&&x&&e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:"var(--red)"},onClick:x,children:"Wyczysc filtry"})]}),e.jsxs("div",{className:"toolbar-right",style:{alignItems:"center"},children:[e.jsxs("div",{ref:L,style:{position:"relative"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>O(R=>!R),title:"Kolumny",children:"Kolumny"}),N&&e.jsx("div",{style:{position:"absolute",right:0,top:"100%",marginTop:4,zIndex:100,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:8,minWidth:220,maxHeight:400,overflowY:"auto",boxShadow:"var(--shadow)"},children:j.map(R=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",fontSize:12,cursor:"pointer",borderRadius:4},children:[e.jsx("input",{type:"checkbox",checked:y.has(R.key),onChange:()=>S(R.key)}),R.header]},R.key))})]}),e.jsxs("div",{ref:H,style:{position:"relative"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>U(R=>!R),title:"Eksport",children:"Eksport"}),Q&&e.jsxs("div",{style:{position:"absolute",right:0,top:"100%",marginTop:4,zIndex:100,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:4,minWidth:130,boxShadow:"var(--shadow)"},children:[e.jsx("button",{className:"btn btn-sm",style:{width:"100%",justifyContent:"flex-start",border:"none"},onClick:()=>{kA(w,A,b),U(!1)},children:"CSV"}),e.jsx("button",{className:"btn btn-sm",style:{width:"100%",justifyContent:"flex-start",border:"none"},onClick:()=>{zA(w,A,b),U(!1)},children:"Excel (XLSX)"})]})]}),z?.map(R=>e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:R.onClick,children:R.label},R.label)),_&&E&&e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:E,children:["+ ",_]})]})]})}function da(t,n){const[a,s]=m.useState(()=>{try{const c=localStorage.getItem(`cols:${n}`);if(c)return new Set(JSON.parse(c))}catch{}return new Set(t.filter(c=>c.defaultVisible!==!1).map(c=>c.key))}),o=m.useCallback(c=>{s(u=>{const h=new Set(u);return h.has(c)?h.delete(c):h.add(c),localStorage.setItem(`cols:${n}`,JSON.stringify([...h])),h})},[n]);return{visible:a,toggle:o}}function Aa(t){const{data:n,storageKey:a,defaultSort:s,defaultSortDir:o="asc",defaultPageSize:c=100,getValue:u}=t,[h,f]=m.useState({}),p=m.useCallback((ee,me)=>{f(W=>{const J={...W};return me?J[ee]=me:delete J[ee],J})},[]),x=m.useCallback(()=>{f({}),S("")},[]),j=Object.keys(h).length>0,[y,S]=m.useState(""),[w,b]=m.useState(s),[_,E]=m.useState(o),z=m.useCallback(ee=>{b(me=>me===ee?(E(W=>W==="asc"?"desc":"asc"),me):(E("asc"),ee))},[]),[N,O]=m.useState(1),[Q,U]=m.useState(()=>{try{const ee=localStorage.getItem(`pageSize:${a}`);if(ee)return Number(ee)}catch{}return c}),L=m.useCallback(ee=>{U(ee),O(1);try{localStorage.setItem(`pageSize:${a}`,String(ee))}catch{}},[a]),H=m.useCallback(ee=>O(ee),[]),A=m.useCallback((ee,me)=>u?u(ee,me):ee[me],[u]),R=m.useMemo(()=>{let ee=[...n];const me=Object.entries(h);if(me.length>0&&(ee=ee.filter(W=>me.every(([J,M])=>{const V=A(W,J);return V==null?!1:String(V).toLowerCase().includes(M.toLowerCase())}))),y){const W=y.toLowerCase();ee=ee.filter(J=>Object.values(J).some(V=>V!=null&&String(V).toLowerCase().includes(W)))}return ee.sort((W,J)=>{const M=A(W,w),V=A(J,w);let ne=0;return M==null&&V==null?ne=0:M==null?ne=1:V==null?ne=-1:typeof M=="number"&&typeof V=="number"?ne=M-V:typeof M=="boolean"&&typeof V=="boolean"?ne=M===V?0:M?-1:1:ne=String(M).localeCompare(String(V),"pl",{sensitivity:"base"}),_==="asc"?ne:-ne}),ee},[n,h,y,w,_,A]),G=Math.max(1,Math.ceil(R.length/Q)),F=Math.min(N,G);m.useEffect(()=>{F!==N&&O(F)},[F,N]);const q=m.useMemo(()=>R.slice((F-1)*Q,F*Q),[R,F,Q]);return{columnFilters:h,setColumnFilter:p,clearAllFilters:x,hasActiveFilters:j,search:y,setSearch:S,sortField:w,sortDir:_,toggleSort:z,page:F,pageSize:Q,setPage:H,setPageSize:L,totalPages:G,filtered:R,pageData:q,filteredCount:R.length,totalCount:n.length}}const TA=[25,50,100,200,500];function NA({page:t,totalPages:n,pageSize:a,totalItems:s,filteredItems:o,onPageChange:c,onPageSizeChange:u}){const h=o===0?0:(t-1)*a+1,f=Math.min(t*a,o),p=[];if(n<=7)for(let x=1;x<=n;x++)p.push(x);else{p.push(1),t>3&&p.push("...");for(let x=Math.max(2,t-1);x<=Math.min(n-1,t+1);x++)p.push(x);t<n-2&&p.push("..."),p.push(n)}return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 14px",fontSize:12,color:"var(--text-muted)",borderTop:"1px solid var(--border)",flexWrap:"wrap",gap:8},children:[e.jsx("span",{children:o===0?"Brak wynikw":e.jsxs(e.Fragment,{children:[h,"",f," z ",o,o!==s&&e.jsxs("span",{style:{opacity:.6},children:[" (filtr. z ",s,")"]})]})}),e.jsxs("div",{style:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 6px",fontSize:11,minWidth:28},disabled:t<=1,onClick:()=>c(t-1),title:"Poprzednia strona",children:""}),p.map((x,j)=>x==="..."?e.jsx("span",{style:{padding:"0 4px"},children:""},`e${j}`):e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 8px",fontSize:11,minWidth:28,background:x===t?"var(--blue)":void 0,color:x===t?"#fff":void 0,fontWeight:x===t?600:void 0},onClick:()=>c(x),children:x},x)),e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 6px",fontSize:11,minWidth:28},disabled:t>=n,onClick:()=>c(t+1),title:"Nastpna strona",children:""})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{children:"Poka"}),e.jsx("select",{className:"form-control",style:{width:64,padding:"2px 4px",fontSize:11},value:a,onChange:x=>u(Number(x.target.value)),children:TA.map(x=>e.jsx("option",{value:x,children:x},x))}),e.jsx("span",{children:"na str."})]})]})}function Ea(t){const{columns:n,visibleColumns:a,data:s,renderCell:o,renderHeaderExtra:c,onRowClick:u,rowKey:h,selectedKey:f,rowBorderColor:p,sortField:x,sortDir:j,onSort:y,columnFilters:S,onColumnFilter:w,showFilters:b,page:_,totalPages:E,pageSize:z,totalItems:N,filteredItems:O,onPageChange:Q,onPageSizeChange:U,loading:L,emptyMessage:H="Brak danych.",emptyFilteredMessage:A="Brak wynikw dla wybranych filtrw."}=t,R=n.filter(ee=>a.has(ee.key)),[G,F]=m.useState(null),q=m.useRef(null);return m.useEffect(()=>{if(!G)return;const ee=me=>{q.current&&!q.current.contains(me.target)&&F(null)};return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[G]),L?e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie danych..."})}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:s.length===0&&!L?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:O===0&&N>0?A:H}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsxs("thead",{children:[e.jsx("tr",{children:R.map(ee=>{const me=x===ee.key,W=!!S[ee.key];return e.jsxs("th",{style:{position:"relative",userSelect:"none",whiteSpace:"nowrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[c?.(ee.key),e.jsx("span",{style:{cursor:"pointer",flex:1,color:W?"var(--blue)":void 0,textDecoration:W?"underline":void 0,textDecorationStyle:W?"dotted":void 0},onClick:J=>{J.stopPropagation(),F(M=>M===ee.key?null:ee.key)},title:`Filtruj: ${ee.header}`,children:ee.header}),e.jsxs("span",{style:{display:"inline-flex",flexDirection:"column",cursor:"pointer",lineHeight:0,marginLeft:2},onClick:J=>{J.stopPropagation(),y(ee.key)},title:"Sortuj",children:[e.jsx("span",{style:{fontSize:8,lineHeight:"9px",color:me&&j==="asc"?"var(--blue)":"var(--text-muted)",opacity:me&&j==="asc"?1:.4},children:""}),e.jsx("span",{style:{fontSize:8,lineHeight:"9px",color:me&&j==="desc"?"var(--blue)":"var(--text-muted)",opacity:me&&j==="desc"?1:.4},children:""})]})]}),G===ee.key&&e.jsxs("div",{ref:q,style:{position:"absolute",left:0,top:"100%",zIndex:120,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:6,minWidth:160,boxShadow:"var(--shadow)"},onClick:J=>J.stopPropagation(),children:[e.jsx("input",{className:"form-control",style:{width:"100%",padding:"4px 8px",fontSize:11},placeholder:`Filtruj ${ee.header}...`,value:S[ee.key]??"",onChange:J=>w(ee.key,J.target.value),autoFocus:!0,onKeyDown:J=>{J.key==="Escape"&&F(null),J.key==="Enter"&&F(null)}}),S[ee.key]&&e.jsx("button",{className:"btn btn-sm",style:{marginTop:4,fontSize:10,width:"100%",color:"var(--red)"},onClick:()=>{w(ee.key,""),F(null)},children:"Wyczy"})]})]},ee.key)})}),b&&e.jsx("tr",{children:R.map(ee=>e.jsx("th",{style:{padding:"4px 6px",background:"var(--bg-tertiary, var(--bg-secondary))"},children:e.jsx("input",{className:"form-control",style:{width:"100%",padding:"3px 6px",fontSize:10,minWidth:60},placeholder:"...",value:S[ee.key]??"",onChange:me=>w(ee.key,me.target.value)})},`f-${ee.key}`))})]}),e.jsx("tbody",{children:s.map(ee=>{const me=h(ee),W=p?.(ee);return e.jsx("tr",{style:{cursor:u?"pointer":void 0,background:f===me?"var(--bg-card-hover)":void 0,borderLeft:W?`3px solid ${W}`:void 0},onClick:()=>u?.(ee),children:R.map(J=>{const M=o?.(ee,J.key);if(M!==void 0)return e.jsx("td",{children:M},J.key);const V=J.format?J.format(ee):ee[J.key];return e.jsx("td",{children:V??""},J.key)})},me)})})]})}),e.jsx(NA,{page:_,totalPages:E,pageSize:z,totalItems:N,filteredItems:O,onPageChange:Q,onPageSizeChange:U})]})})}const AA={fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace"};function Ia({cards:t,isFiltered:n}){return e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:t.map((a,s)=>{const o=a.formatValue?a.formatValue(a.value):a.value,c=a.total!=null&&a.formatValue?a.formatValue(a.total):a.total,u=n&&a.total!=null&&String(a.value)!==String(a.total);return e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{...AA,color:a.color},children:u?e.jsxs(e.Fragment,{children:[o,e.jsxs("span",{style:{fontSize:16,opacity:.5,fontWeight:400},children:[" / ",c]})]}):o}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:a.label})]},s)})})}function Or(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function Sl(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function Ru(t){return t>=221?"Wysokie":t>=31?"Srednie":"Niskie"}const EA={"":1,"":2,"":3,"":4,"":5};function Sr({number:t,label:n}){const a=EA[t]??t;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:a}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:n})]})}function Gt({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function FA(){const[t]=hc(),[n,a]=m.useState([]),[s,o]=m.useState(!0),[c,u]=m.useState(null),[h,f]=m.useState(!1),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(null),[b,_]=m.useState(null),[E,z]=m.useState(!1),[N,O]=m.useState([]),[Q,U]=m.useState(!1),L=()=>{u(null),le.get("/api/v1/risks").then(D=>{a(D);const de=t.get("highlight");if(de){const he=D.find(ie=>ie.id===Number(de));he&&_(he)}}).catch(D=>{u(String(D)),console.error("loadRisks failed:",D)}).finally(()=>o(!1))};m.useEffect(()=>{L(),le.get("/api/v1/org-units/tree").then(O).catch(()=>{})},[]);const H=m.useMemo(()=>Tl(N),[N]),A=[{key:"id",header:"ID",format:D=>`R-${D.id}`},{key:"code",header:"Kod",format:D=>D.code??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo"},{key:"org_unit_name",header:"Pion",format:D=>D.org_unit_name??""},{key:"risk_category_name",header:"Kategoria",format:D=>D.risk_category_name??""},{key:"security_area_name",header:"Domena",format:D=>D.security_area_name??""},{key:"risk_score",header:"Ocena (R)",format:D=>(D.risk_score??0).toFixed(1)},{key:"risk_level",header:"Poziom",format:D=>D.risk_level??"",defaultVisible:!1},{key:"status_name",header:"Status",format:D=>D.status_name??""},{key:"strategy_name",header:"Strategia",format:D=>D.strategy_name??"",defaultVisible:!1},{key:"owner",header:"Wlasciciel",format:D=>D.owner??""},{key:"identification_source_name",header:"rdo ident.",format:D=>D.identification_source_name??"",defaultVisible:!1},{key:"asset_category_name",header:"Kat. aktywa",format:D=>D.asset_category_name??"",defaultVisible:!1},{key:"sensitivity_name",header:"Wraliwo",format:D=>D.sensitivity_name??"",defaultVisible:!1},{key:"criticality_name",header:"Krytyczno",format:D=>D.criticality_name??"",defaultVisible:!1},{key:"impact_level",header:"Wpyw (W)",format:D=>String(D.impact_level),defaultVisible:!1},{key:"probability_level",header:"Prawd. (P)",format:D=>String(D.probability_level),defaultVisible:!1},{key:"safeguard_rating",header:"Zabezp. (Z)",format:D=>String(D.safeguard_rating),defaultVisible:!1},{key:"residual_risk",header:"Ryzyko rezyd.",format:D=>D.residual_risk!=null?D.residual_risk.toFixed(1):"",defaultVisible:!1},{key:"treatment_deadline",header:"Termin real.",format:D=>D.treatment_deadline?.slice(0,10)??"",defaultVisible:!1},{key:"accepted_by",header:"Akceptowa",format:D=>D.accepted_by??"",defaultVisible:!1},{key:"next_review_date",header:"Nastpny przegld",format:D=>D.next_review_date?.slice(0,10)??"",defaultVisible:!1},{key:"identified_at",header:"Zidentyfikowano",format:D=>D.identified_at?.slice(0,10)??"",defaultVisible:!1},{key:"last_review_at",header:"Ostatni przegld",format:D=>D.last_review_at?.slice(0,10)??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:D=>D.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:R,toggle:G}=da(A,"risks"),F=t.get("org_unit_id"),q=m.useMemo(()=>F?n.filter(D=>D.org_unit_id===Number(F)):n,[n,F]),ee=Aa({data:q,storageKey:"risks",defaultSort:"risk_score",defaultSortDir:"desc"}),[me,W]=m.useState(!1);m.useEffect(()=>{if(me||n.length===0)return;const D=t.get("level"),de=t.get("impact"),he=t.get("prob");D&&ee.setColumnFilter("risk_level",D),de&&ee.setColumnFilter("impact_level",de),he&&ee.setColumnFilter("probability_level",he),(D||de||he)&&U(!0),W(!0)},[n,me]);const J=async()=>{if(S)return S;const[D,de,he,ie,ve,je]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/domains").catch(()=>[]),le.get("/api/v1/threat-catalog").catch(()=>[]),le.get("/api/v1/weakness-catalog").catch(()=>[]),le.get("/api/v1/control-catalog").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),fe=async ht=>{try{return(await le.get(`/api/v1/dictionaries/${ht}/entries`)).entries.filter(qe=>qe.is_active).map(qe=>({id:qe.id,label:qe.label}))}catch{return[]}},[_e,Se,Ve,be,oe,Ue,Qe,lt]=await Promise.all([fe("asset_category"),fe("sensitivity"),fe("criticality"),fe("risk_status"),fe("risk_strategy"),fe("risk_category"),fe("risk_identification_source"),fe("asset_type")]),tt={orgUnits:D,areas:de,threats:he,vulns:ie,safeguards:ve,assets:je,categories:_e,sensitivities:Se,criticalities:Ve,statuses:be,strategies:oe,risk_categories:Ue,identification_sources:Qe,asset_types:lt};return w(tt),tt},M=async()=>{await J(),x(null),f(!0)},V=async D=>{await J(),x(D),f(!0)},ne=async D=>{y(!0);try{if(p){const de=await le.put(`/api/v1/risks/${p.id}`,D);_(de)}else await le.post("/api/v1/risks",D);f(!1),x(null),o(!0),L()}catch(de){alert("Blad zapisu: "+de)}finally{y(!1)}},P=async D=>{if(confirm(`Zamknac ryzyko R-${D.id}? Status zostanie zmieniony na "Zamkniete".`))try{await le.delete(`/api/v1/risks/${D.id}`),_(null),o(!0),L()}catch(de){alert("Blad: "+de)}},T=async D=>{const de=prompt("Kto akceptuje ryzyko? (imie i nazwisko)");if(de){z(!0);try{const he=await le.post(`/api/v1/risks/${D.id}/accept`,{accepted_by:de});_(he),o(!0),L()}catch(he){alert("Blad akceptacji: "+he)}finally{z(!1)}}},C=ee.filteredCount!==ee.totalCount,k=m.useMemo(()=>{const D=ee.filtered,de=D.filter(_e=>(_e.risk_score??0)>=221).length,he=D.filter(_e=>{const Se=_e.risk_score??0;return Se>=31&&Se<221}).length,ie=D.length>0?D.reduce((_e,Se)=>_e+(Se.risk_score??0),0)/D.length:0,ve=n.filter(_e=>(_e.risk_score??0)>=221).length,je=n.filter(_e=>{const Se=_e.risk_score??0;return Se>=31&&Se<221}).length,fe=n.length>0?n.reduce((_e,Se)=>_e+(Se.risk_score??0),0)/n.length:0;return[{label:"Wszystkich ryzyk",value:D.length,total:n.length,color:"var(--blue)"},{label:"Wysokich",value:de,total:ve,color:"var(--red)"},{label:"rednich",value:he,total:je,color:"var(--orange)"},{label:"rednia ocena",value:ie.toFixed(1),total:fe.toFixed(1),color:"var(--purple)"}]},[ee.filtered,n]),I=D=>D?new Date(D)<new Date:!1;return e.jsxs("div",{children:[c&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad ladowania ryzyk:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:c})]}),(t.get("level")||t.get("impact")||t.get("prob")||F)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 14px",marginBottom:12,borderRadius:8,background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.25)",fontSize:12,color:"var(--blue)"},children:[e.jsx("span",{style:{fontWeight:600},children:"Widok filtrowany z dashboardu:"}),t.get("level")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Poziom: ",t.get("level")]}),t.get("impact")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Wpyw: ",t.get("impact")]}),t.get("prob")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Prawd.: ",t.get("prob")]}),F&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Pion ID: ",F]}),e.jsx("button",{className:"btn btn-sm",style:{marginLeft:"auto",padding:"3px 10px"},onClick:()=>{window.location.href="/risks"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:k,isFiltered:C}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"ryzyk",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj ryzyk...",showFilters:Q,onToggleFilters:()=>U(D=>!D),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:A,visibleColumns:R,onToggleColumn:G,data:ee.filtered,exportFilename:"ryzyka",primaryLabel:"Dodaj ryzyko",onPrimaryAction:M}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:b?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:A,visibleColumns:R,data:ee.pageData,rowKey:D=>D.id,selectedKey:b?.id??null,onRowClick:D=>_(b?.id===D.id?null:D),rowBorderColor:D=>Or(D.risk_score??0),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,showFilters:Q,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,loading:s,emptyMessage:"Brak ryzyk w systemie.",emptyFilteredMessage:"Brak ryzyk pasujcych do filtrw.",renderCell:(D,de)=>{if(de==="id")return e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["R-",D.id]});if(de==="asset_name")return e.jsx("span",{style:{fontWeight:500},children:D.asset_name});if(de==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:H.get(D.org_unit_id)??D.org_unit_name});if(de==="risk_score")return e.jsxs("span",{className:"score-badge",style:{background:Sl(D.risk_score??0),color:Or(D.risk_score??0)},children:[(D.risk_score??0).toFixed(1)," ",Ru(D.risk_score??0)]});if(de==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:D.status_name??""})}}),b&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Ryzyka"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>V(b),title:"Edytuj",children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>_(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Or(b.risk_score??0)},children:(b.risk_score??0).toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:Sl(b.risk_score??0),color:Or(b.risk_score??0),fontSize:13,padding:"4px 12px"},children:Ru(b.risk_score??0)}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:["R = EXP(",b.impact_level,")  ",b.probability_level," / ",b.safeguard_rating]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Sr,{number:"\\u2460",label:"Kontekst"}),e.jsx(Gt,{label:"ID",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["R-",b.id]})}),e.jsx(Gt,{label:"Pion",value:e.jsx("span",{style:{fontSize:11},children:H.get(b.org_unit_id)??b.org_unit_name})}),e.jsx(Gt,{label:"Kategoria ryzyka",value:b.risk_category_name}),e.jsx(Gt,{label:"Zrodlo identyfikacji",value:b.identification_source_name}),b.risk_source&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Zrodlo ryzyka"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.risk_source})]}),e.jsx(Sr,{number:"\\u2461",label:"Identyfikacja aktywa"}),e.jsx(Gt,{label:"Aktywo",value:e.jsx("span",{style:{fontWeight:500},children:b.asset_name})}),b.asset_id_name&&e.jsx(Gt,{label:"Z rejestru",value:e.jsx("span",{style:{color:"var(--cyan)"},children:b.asset_id_name})}),e.jsx(Gt,{label:"Kategoria aktywa",value:b.asset_category_name}),e.jsx(Gt,{label:"Wrazliwosc",value:b.sensitivity_name}),e.jsx(Gt,{label:"Krytycznosc",value:b.criticality_name}),e.jsx(Sr,{number:"\\u2462",label:"Scenariusz ryzyka"}),e.jsx(Gt,{label:"Domena",value:b.security_area_name}),b.threats&&b.threats.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Zagrozenia"}),e.jsx("div",{className:"tag-list",children:b.threats.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--red-dim)",color:"var(--red)"},children:D.threat_name},D.threat_id))})]}),b.vulnerabilities&&b.vulnerabilities.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Podatnosci"}),e.jsx("div",{className:"tag-list",children:b.vulnerabilities.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--orange-dim)",color:"var(--orange)"},children:D.vulnerability_name},D.vulnerability_id))})]}),b.safeguards&&b.safeguards.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Zabezpieczenia"}),e.jsx("div",{className:"tag-list",children:b.safeguards.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--green-dim)",color:"var(--green)"},children:D.safeguard_name},D.safeguard_id))})]}),b.existing_controls&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Istniejace kontrole"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.existing_controls})]}),b.consequence_description&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Opis konsekwencji"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.consequence_description})]}),e.jsx(Sr,{number:"\\u2463",label:"Analiza ryzyka"}),e.jsx(Gt,{label:"Wplyw (W)",value:b.impact_level}),e.jsx(Gt,{label:"Prawdopodobienstwo (P)",value:b.probability_level}),e.jsx(Gt,{label:"Zabezpieczenia (Z)",value:b.safeguard_rating}),e.jsx(Gt,{label:"Ocena (R)",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Or(b.risk_score??0)},children:(b.risk_score??0).toFixed(1)})}),e.jsx(Sr,{number:"\\u2464",label:"Postepowanie z ryzykiem"}),e.jsx(Gt,{label:"Strategia",value:b.strategy_name}),b.treatment_plan&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Plan postepowania"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.treatment_plan})]}),b.planned_safeguard_name&&e.jsx(Gt,{label:"Planowane zabezpieczenie",value:e.jsx("span",{style:{color:"var(--green)",fontWeight:500},children:b.planned_safeguard_name})}),e.jsx(Gt,{label:"Termin realizacji",value:b.treatment_deadline?e.jsxs("span",{style:{color:I(b.treatment_deadline)?"var(--red)":void 0},children:[b.treatment_deadline.slice(0,10),I(b.treatment_deadline)&&" (po terminie!)"]}):""}),b.treatment_resources&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Zasoby"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.treatment_resources})]}),b.residual_risk!=null&&e.jsxs("div",{style:{marginTop:8,padding:8,background:Sl(b.residual_risk),borderRadius:6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:11},children:"Ryzyko rezydualne"}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Or(b.residual_risk)},children:b.residual_risk.toFixed(1)})]}),b.target_impact!=null&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Docelowe: W=",b.target_impact," P=",b.target_probability," Z=",b.target_safeguard,b.risk_score>0&&e.jsxs("span",{style:{marginLeft:6,color:"var(--green)"},children:["(-",((1-Number(b.residual_risk)/Number(b.risk_score))*100).toFixed(0),"%)"]})]})]}),e.jsx(Sr,{number:"\\u2465",label:"Akceptacja i monitorowanie"}),e.jsx(Gt,{label:"Status",value:b.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:b.status_name}):""}),e.jsx(Gt,{label:"Wlasciciel",value:b.owner}),b.accepted_by?e.jsxs("div",{style:{marginTop:4,padding:8,background:"rgba(34,197,94,0.08)",border:"1px solid rgba(34,197,94,0.25)",borderRadius:6},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:e.jsx("span",{className:"score-badge",style:{background:"rgba(34,197,94,0.15)",color:"var(--green)",fontSize:11},children:"Zaakceptowane"})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:["Przez: ",e.jsx("strong",{children:b.accepted_by}),b.accepted_at&&e.jsxs("span",{children:[" (",b.accepted_at.slice(0,10),")"]})]}),b.acceptance_justification&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Uzasadnienie: ",b.acceptance_justification]})]}):e.jsx(Gt,{label:"Akceptacja",value:e.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"Nie zaakceptowano"})}),e.jsx(Gt,{label:"Nastepny przeglad",value:b.next_review_date?e.jsxs("span",{style:{color:I(b.next_review_date)?"var(--red)":void 0,fontWeight:I(b.next_review_date)?600:void 0},children:[b.next_review_date.slice(0,10),I(b.next_review_date)&&" (zalegly!)"]}):""}),e.jsx(Gt,{label:"Zidentyfikowano",value:b.identified_at?.slice(0,10)}),e.jsx(Gt,{label:"Ostatni przeglad",value:b.last_review_at?.slice(0,10)??"Nigdy"}),b.planned_actions&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Planowane dzialania"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.planned_actions})]}),b.linked_actions&&b.linked_actions.length>0&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx(Sr,{number:"",label:"Powiazane dzialania"}),b.linked_actions.map(D=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",borderRadius:6,marginBottom:4,background:D.is_overdue?"rgba(239,68,68,0.06)":"var(--bg-inset)",border:D.is_overdue?"1px solid rgba(239,68,68,0.2)":"1px solid var(--border)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:500},children:D.title}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[D.owner&&e.jsx("span",{children:D.owner}),D.due_date&&e.jsxs("span",{children:[" | ",D.due_date.slice(0,10),D.is_overdue&&" (po terminie!)"]})]})]}),D.status_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:D.status_name})]},D.action_id))]})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>V(b),children:"Edytuj"}),!b.accepted_by&&e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--green)",borderColor:"rgba(34,197,94,0.3)"},onClick:()=>T(b),disabled:E,children:E?"Akceptowanie...":"Akceptuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>P(b),children:"Zamknij"})]})]})]}),e.jsx(gt,{open:h,onClose:()=>{f(!1),x(null)},title:p?`Edytuj ryzyko: R-${p.id}`:"Dodaj ryzyko",wide:!0,children:S?e.jsx(IA,{editRisk:p,lookups:S,setLookups:w,orgTree:S.orgUnits,saving:j,onSubmit:ne,onCancel:()=>{f(!1),x(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})})]})}function RA({lookups:t,setLookups:n,assetId:a,plannedSafeguardId:s,setPlannedSafeguardId:o}){const[c,u]=m.useState(""),[h,f]=m.useState(!1),x=(a?t.assets.find(b=>b.id===a):null)?.category_id??null,j=x?t.safeguards.filter(b=>b.asset_category_ids?.includes(x)||b.asset_category_ids?.length===0):t.safeguards,y=c.length>=1?j.filter(b=>b.name.toLowerCase().includes(c.toLowerCase())).slice(0,8):[],S=s?t.safeguards.find(b=>b.id===s):null,w=async()=>{if(c.trim()){f(!0);try{const b=await le.post("/api/v1/control-catalog",{name:c.trim()});n(_=>_&&{..._,safeguards:[..._.safeguards,b]}),o(b.id),u("")}catch(b){alert("Blad: "+b)}finally{f(!1)}}};return e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsxs("label",{children:["Planowane zabezpieczenie ",e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:"(wdrazane w ramach planu postepowania)"})]}),S?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 12px",background:"rgba(34,197,94,0.06)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:6},children:[e.jsx("span",{style:{flex:1,fontSize:13,fontWeight:500,color:"var(--green)"},children:S.name}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10,color:"var(--red)",padding:"0 6px"},onClick:()=>o(null),children:""})]}):e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj zabezpieczenia lub wpisz nowe...",value:c,onChange:b=>u(b.target.value)}),c.length>=1&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:[y.map(b=>e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)"},onClick:()=>{o(b.id),u("")},onMouseEnter:_=>_.currentTarget.style.background="rgba(34,197,94,0.08)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:b.name},b.id)),e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,color:"var(--green)",fontWeight:500},onClick:w,onMouseEnter:b=>b.currentTarget.style.background="rgba(34,197,94,0.08)",onMouseLeave:b=>b.currentTarget.style.background="transparent",children:h?"Dodawanie...":`+ Dodaj "${c}" do katalogu zabezpieczen`})]})]})]})}function BA({riskId:t,existingLinks:n,lookups:a,orgTree:s,strategyId:o}){const[c,u]=m.useState(""),[h,f]=m.useState([]),[p,x]=m.useState(!1),[j,y]=m.useState(n),[S,w]=m.useState(!1),[b,_]=m.useState(!1),[E,z]=m.useState(""),[N,O]=m.useState(""),[Q,U]=m.useState(""),[L,H]=m.useState(""),[A,R]=m.useState(""),[G,F]=m.useState(null),q=o?a.strategies.find(M=>M.id===o)?.label:null,ee=q&&(q.toLowerCase().includes("modyfikacja")||q.toLowerCase().includes("transfer")||q.toLowerCase().includes("unikanie"));m.useEffect(()=>{if(c.length<2){f([]);return}const M=setTimeout(()=>{x(!0),le.get("/api/v1/actions").then(V=>{const ne=c.toLowerCase();f(V.filter(P=>P.title.toLowerCase().includes(ne)||(P.owner??"").toLowerCase().includes(ne)||(P.description??"").toLowerCase().includes(ne)).slice(0,10))}).catch(()=>{}).finally(()=>x(!1))},300);return()=>clearTimeout(M)},[c]);const me=async M=>{if(t&&!j.some(V=>V.action_id===M.id))try{const ne=((await le.get(`/api/v1/actions/${M.id}`)).links??[]).map(P=>({entity_type:P.entity_type,entity_id:P.entity_id}));ne.push({entity_type:"risk",entity_id:t}),await le.put(`/api/v1/actions/${M.id}`,{links:ne}),y([...j,{action_id:M.id,title:M.title}]),u(""),f([])}catch(V){alert("Blad wiazania: "+V)}},W=async M=>{if(t)try{const ne=((await le.get(`/api/v1/actions/${M}`)).links??[]).filter(P=>!(P.entity_type==="risk"&&P.entity_id===t)).map(P=>({entity_type:P.entity_type,entity_id:P.entity_id}));await le.put(`/api/v1/actions/${M}`,{links:ne}),y(j.filter(P=>P.action_id!==M))}catch(V){alert("Blad odlaczania: "+V)}},J=async()=>{if(!(!E||!t)){_(!0);try{const M=[{entity_type:"risk",entity_id:t}],V=await le.post("/api/v1/actions",{title:E,description:N||null,owner:Q||null,responsible:L||null,due_date:A||null,org_unit_id:G,links:M});y([...j,{action_id:V.id,title:V.title}]),w(!1),z(""),O(""),U(""),H(""),R(""),F(null)}catch(M){alert("Blad tworzenia: "+M)}finally{_(!1)}}};return e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:e.jsxs("label",{style:{fontSize:12,color:"var(--text-muted)"},children:["Powiazane dzialania (",j.length,")",ee&&j.length===0&&e.jsxs("span",{style:{color:"var(--orange)",marginLeft:8,fontWeight:600},children:['Strategia "',q,'" wymaga zaplanowania dzialania']})]})}),j.map(M=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:4,fontSize:12},children:[e.jsx("span",{children:M.title}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"0 6px",fontSize:10,color:"var(--red)"},onClick:()=>W(M.action_id),children:""})]},M.action_id)),t&&!S&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj istniejacego dzialania po tytule, wlascicielu...",value:c,onChange:M=>u(M.target.value)}),p&&e.jsx("span",{style:{position:"absolute",right:8,top:8,fontSize:10,color:"var(--text-muted)"},children:"..."}),h.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:h.map(M=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",opacity:j.some(V=>V.action_id===M.id)?.4:1},onClick:()=>me(M),onMouseEnter:V=>V.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:V=>V.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500},children:M.title}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[M.owner&&e.jsx("span",{children:M.owner}),M.status_name&&e.jsxs("span",{children:[" | ",M.status_name]}),M.due_date&&e.jsxs("span",{children:[" | ",M.due_date.slice(0,10)]})]})]},M.id))})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{w(!0),u(""),f([])},children:"+ Nowe dzialanie"})]}),!t&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:"Zapisz ryzyko najpierw, aby moc wiazac dzialania"}),S&&t&&e.jsxs("div",{style:{background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:14,marginTop:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13,color:"var(--blue)"},children:"Nowe dzialanie"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:11},onClick:()=>w(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul dzialania *"}),e.jsx("input",{className:"form-control",value:E,onChange:M=>z(M.target.value),placeholder:"np. Wdrozenie MFA dla kont administracyjnych"}),!E&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:Q,onChange:M=>U(M.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny"}),e.jsx("input",{className:"form-control",value:L,onChange:M=>H(M.target.value),placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:s,value:G,onChange:F,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:A,onChange:M=>R(M.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:N,onChange:M=>O(M.target.value),placeholder:"Opisz dzialanie, cele, kroki..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>w(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:b||!E,onClick:J,children:b?"Tworzenie...":"Utworz i powiaz dzialanie"})]})]})]})}function mm({label:t,items:n,selectedIds:a,onChange:s,onAdd:o,color:c,icon:u,compact:h,allItems:f}){const[p,x]=m.useState(""),[j,y]=m.useState(!1),S=n.filter(_=>!a.includes(_.id)),w=p.length>=1?S.filter(_=>_.name.toLowerCase().includes(p.toLowerCase())).slice(0,8):[],b=async()=>{if(p.trim()){y(!0);try{const _=await o(p.trim());s([...a,_.id]),x("")}catch(_){alert("Blad: "+_)}finally{y(!1)}}};return e.jsxs("div",{style:{borderRadius:8,padding:h?"10px 12px":"12px 14px",background:`${c}06`,border:`1px solid ${c}20`,borderLeft:`3px solid ${c}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[u&&e.jsx("span",{style:{fontSize:14},children:u}),e.jsx("span",{style:{fontSize:12,fontWeight:600,color:c},children:t}),e.jsx("span",{style:{fontSize:10,background:`${c}20`,color:c,borderRadius:10,padding:"1px 7px",fontWeight:600,marginLeft:4},children:a.length})]}),a.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:5,marginBottom:8},children:a.map(_=>{const E=(f??n).find(z=>z.id===_);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:c+"18",color:c,border:`1px solid ${c}35`,borderRadius:12,padding:"2px 8px 2px 8px",fontSize:11,fontWeight:500},children:[E?.name??`#${_}`,e.jsx("span",{style:{cursor:"pointer",marginLeft:2,opacity:.7,fontWeight:700,fontSize:13,lineHeight:1},onClick:()=>s(a.filter(z=>z!==_)),children:""})]},_)})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12,background:"var(--bg-card)",borderColor:`${c}30`},placeholder:"Szukaj lub wpisz nowe...",value:p,onChange:_=>x(_.target.value)}),p.length>=1&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:[w.map(_=>e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)"},onClick:()=>{s([...a,_.id]),x("")},onMouseEnter:E=>E.currentTarget.style.background=c+"12",onMouseLeave:E=>E.currentTarget.style.background="transparent",children:_.name},_.id)),e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,color:c,fontWeight:500,borderTop:w.length>0?`1px solid ${c}30`:"none"},onClick:b,onMouseEnter:_=>_.currentTarget.style.background=c+"12",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:j?"Dodawanie...":`+ Dodaj "${p}" do slownika`})]})]})]})}function OA({lookups:t,setLookups:n,assetId:a,securityAreaId:s,setSecurityAreaId:o,threatIds:c,setThreatIds:u,vulnerabilityIds:h,setVulnerabilityIds:f,safeguardIds:p,setSafeguardIds:x,existingControls:j,setExistingControls:y,consequenceDescription:S,setConsequenceDescription:w}){const b=a?t.assets.find(G=>G.id===a):null,_=b?.category_id??null,[E,z]=m.useState(!1),[N,O]=m.useState(!1),[Q,U]=m.useState(!1),L=_&&!E?t.threats.filter(G=>G.asset_category_ids?.includes(_)||G.asset_category_ids?.length===0):t.threats,H=_&&!N?t.vulns.filter(G=>G.asset_category_ids?.includes(_)||G.asset_category_ids?.length===0):t.vulns,A=_&&!Q?t.safeguards.filter(G=>G.asset_category_ids?.includes(_)||G.asset_category_ids?.length===0):t.safeguards,R=!!_;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff"},children:"3"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:"Scenariusz ryzyka"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zdefiniuj zagrozenia, podatnosci i zabezpieczenia"})]}),b?.category_name&&e.jsxs("div",{style:{marginLeft:"auto",fontSize:11,color:"var(--blue)",padding:"3px 10px",background:"rgba(59,130,246,0.08)",borderRadius:12,fontWeight:500},children:["Kategoria: ",e.jsx("strong",{children:b.category_name}),e.jsx("span",{style:{color:"var(--text-muted)",marginLeft:6},children:"(filtr aktywny  sugestie dopasowane do kategorii)"})]})]}),e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",marginBottom:14,background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.15)",display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",margin:0,whiteSpace:"nowrap"},children:"Domena bezpieczenstwa"}),e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:12,maxWidth:320},value:s??"",onChange:G=>o(G.target.value?Number(G.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz domene..."}),t.areas.map(G=>e.jsx("option",{value:G.id,children:G.name},G.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:14},children:[e.jsxs("div",{children:[e.jsx(mm,{label:"Zagrozenia",icon:"",compact:!0,items:L,allItems:t.threats,selectedIds:c,onChange:u,color:"var(--red)",onAdd:async G=>{const F=await le.post("/api/v1/threat-catalog",{name:G});return n(q=>q&&{...q,threats:[...q.threats,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:G=>z(G.target.checked)}),"Pokaz wszystkie (",t.threats.length,") zamiast filtrowanych (",L.length,")"]})]}),e.jsxs("div",{children:[e.jsx(mm,{label:"Podatnosci",icon:"",compact:!0,items:H,allItems:t.vulns,selectedIds:h,onChange:f,color:"var(--orange)",onAdd:async G=>{const F=await le.post("/api/v1/weakness-catalog",{name:G});return n(q=>q&&{...q,vulns:[...q.vulns,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N,onChange:G=>O(G.target.checked)}),"Pokaz wszystkie (",t.vulns.length,") zamiast filtrowanych (",H.length,")"]})]}),e.jsxs("div",{children:[e.jsx(mm,{label:"Zabezpieczenia",icon:"",compact:!0,items:A,allItems:t.safeguards,selectedIds:p,onChange:x,color:"var(--green)",onAdd:async G=>{const F=await le.post("/api/v1/control-catalog",{name:G});return n(q=>q&&{...q,safeguards:[...q.safeguards,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:G=>U(G.target.checked)}),"Pokaz wszystkie (",t.safeguards.length,") zamiast filtrowanych (",A.length,")"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:14},children:[e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",background:"rgba(107,114,128,0.04)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",margin:0},children:"Istniejace kontrole"})]}),e.jsx("textarea",{className:"form-control",rows:2,style:{fontSize:12},value:j,onChange:G=>y(G.target.value),placeholder:"Opisz istniejace kontrole i zabezpieczenia..."})]}),e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",background:"rgba(107,114,128,0.04)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",margin:0},children:"Opis konsekwencji"})]}),e.jsx("textarea",{className:"form-control",rows:2,style:{fontSize:12},value:S,onChange:G=>w(G.target.value),placeholder:"Opisz potencjalne konsekwencje materializacji ryzyka..."})]})]}),e.jsx(DA,{assetId:a,lookups:t,setLookups:n,threatIds:c,setThreatIds:u,vulnerabilityIds:h,setVulnerabilityIds:f,safeguardIds:p,setSafeguardIds:x})]})}function DA({assetId:t,lookups:n,setLookups:a,threatIds:s,setThreatIds:o,vulnerabilityIds:c,setVulnerabilityIds:u,safeguardIds:h,setSafeguardIds:f}){const[p,x]=m.useState(!1),[j,y]=m.useState([]),[S,w]=m.useState(!1),[b,_]=m.useState(""),[E,z]=m.useState(null),[N,O]=m.useState([]),[Q,U]=m.useState([]),[L,H]=m.useState(!1),R=(t?n.assets.find(C=>C.id===t):null)?.asset_category_id??null,G=async()=>{w(!0);try{const C=R?`/api/v1/threat-catalog?asset_category_id=${R}`:"/api/v1/threat-catalog",k=await le.get(C);y(k)}catch{y([])}finally{w(!1)}},F=async C=>{H(!0);const[k,I]=await Promise.all([le.get(`/api/v1/suggestions/weaknesses?threat_id=${C}`).catch(D=>(console.warn("Suggestions/weaknesses error:",D),[])),le.get(`/api/v1/suggestions/controls?threat_id=${C}`).catch(D=>(console.warn("Suggestions/controls error:",D),[]))]);O(k),U(I),H(!1)},q=async C=>{const k=n.threats.find(I=>I.name.toLowerCase()===C.name.toLowerCase());if(k){s.includes(k.id)||o([...s,k.id]);return}try{const I=await le.post("/api/v1/threat-catalog",{name:C.name});a(D=>D&&{...D,threats:[...D.threats,I]}),o([...s,I.id])}catch{}},ee=async C=>{const k=n.vulns.find(I=>I.name.toLowerCase()===C.name.toLowerCase());if(k){c.includes(k.id)||u([...c,k.id]);return}try{const I=await le.post("/api/v1/weakness-catalog",{name:C.name});a(D=>D&&{...D,vulns:[...D.vulns,I]}),u([...c,I.id])}catch{}},me=async C=>{const k=n.safeguards.find(I=>I.name.toLowerCase()===C.name.toLowerCase());if(k){h.includes(k.id)||f([...h,k.id]);return}try{const I=await le.post("/api/v1/control-catalog",{name:C.name});a(D=>D&&{...D,safeguards:[...D.safeguards,I]}),f([...h,I.id])}catch{}},W=async()=>{await Promise.all(V.map(C=>ee(C))),await Promise.all(ne.map(C=>me(C)))},J=new Set(c.map(C=>n.vulns.find(k=>k.id===C)?.name?.toLowerCase()).filter(Boolean)),M=new Set(h.map(C=>n.safeguards.find(k=>k.id===C)?.name?.toLowerCase()).filter(Boolean)),V=N.filter(C=>!J.has(C.name.toLowerCase())),ne=Q.filter(C=>!M.has(C.name.toLowerCase())),P=b.length>=2?j.filter(C=>C.ref_id.toLowerCase().includes(b.toLowerCase())||C.name.toLowerCase().includes(b.toLowerCase())).slice(0,10):j.slice(0,10),T={HIGH:"#dc2626",MEDIUM:"#f59e0b",LOW:"#16a34a"};return e.jsxs("div",{style:{marginTop:2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer",padding:"10px 14px",borderRadius:p?"8px 8px 0 0":8,background:p?"rgba(139,92,246,0.08)":"rgba(139,92,246,0.03)",border:`1px solid ${p?"rgba(139,92,246,0.3)":"rgba(139,92,246,0.12)"}`,borderBottom:p?"1px solid rgba(139,92,246,0.15)":void 0,transition:"all 0.2s"},onClick:()=>{x(!p),!p&&j.length===0&&G()},children:[e.jsx("div",{style:{width:24,height:24,borderRadius:6,background:"rgba(139,92,246,0.15)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:13},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#8b5cf6"},children:"Katalog Zagrozen"}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Sugestie zagrozen i zabezpieczen z katalogu ISO"})]}),e.jsx("span",{style:{marginLeft:"auto",fontSize:18,color:"var(--text-muted)",lineHeight:1,transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""})]}),p&&e.jsx("div",{style:{border:"1px solid rgba(139,92,246,0.2)",borderTop:"none",borderRadius:"0 0 8px 8px",padding:16},children:S?e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie Katalog Zagrozen..."}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#8b5cf6",marginBottom:8},children:["Wybierz zagrozenie z katalogu",R&&e.jsx("span",{style:{fontWeight:400,color:"var(--text-muted)"},children:" (filtr wg aktywa)"})]}),e.jsx("input",{className:"form-control",style:{fontSize:12,marginBottom:8},placeholder:"Szukaj w Katalog Zagrozen (ref_id lub nazwa)...",value:b,onChange:C=>_(C.target.value)}),e.jsxs("div",{style:{maxHeight:240,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:[P.map(C=>e.jsxs("div",{style:{padding:"7px 10px",fontSize:12,cursor:"pointer",borderBottom:"1px solid var(--border)",background:E?.id===C.id?"rgba(139,92,246,0.1)":"transparent"},onClick:()=>{z(C),F(C.id)},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#8b5cf6",marginRight:6},children:C.ref_id}),C.name]},C.id)),P.length===0&&e.jsx("div",{style:{padding:12,textAlign:"center",fontSize:12,color:"var(--text-muted)"},children:"Brak wynikow"})]}),E&&e.jsxs("button",{type:"button",className:"btn btn-sm",style:{marginTop:8,background:"#dc262620",color:"#dc2626",border:"1px solid #dc262640",fontSize:11},onClick:()=>q(E),children:["+ Zastosuj zagrozenie: ",E.ref_id]})]}),e.jsxs("div",{children:[!E&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",fontSize:12,padding:32},children:"Wybierz zagrozenie z katalogu aby zobaczyc sugestie slabosci i zabezpieczen"}),E&&L&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie sugestii..."}),E&&!L&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"#8b5cf6"},children:["Sugestie dla: ",E.ref_id]}),(V.length>0||ne.length>0)&&e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10,background:"#16a34a20",color:"#16a34a",border:"1px solid #16a34a40"},onClick:W,children:"Zastosuj wszystkie"})]}),e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"#f59e0b",marginBottom:4,marginTop:8},children:["Slabosci (",V.length,")"]}),V.length===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Brak sugestii"}),V.map(C=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:11},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:C.ref_id})," ",C.name]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:10,padding:"1px 5px",borderRadius:3,background:(T[C.relevance??""]??"#666")+"22",color:T[C.relevance??""]??"#666"},children:C.relevance}),e.jsx("button",{type:"button",style:{fontSize:10,cursor:"pointer",color:"#16a34a",background:"none",border:"none",fontWeight:600},onClick:()=>ee(C),children:"+Dodaj"})]})]},C.weakness_id)),e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"#16a34a",marginBottom:4,marginTop:12},children:["Zabezpieczenia (",ne.length,")"]}),ne.length===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Brak sugestii"}),ne.map(C=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:11},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:C.ref_id})," ",C.name]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:10,padding:"1px 5px",borderRadius:3,background:(T[C.effectiveness??""]??"#666")+"22",color:T[C.effectiveness??""]??"#666"},children:C.effectiveness}),e.jsx("button",{type:"button",style:{fontSize:10,cursor:"pointer",color:"#16a34a",background:"none",border:"none",fontWeight:600},onClick:()=>me(C),children:"+Dodaj"})]})]},C.control_id))]})]})]})})]})}function LA({assetId:t,assetName:n,lookups:a,orgTree:s,onSelectAsset:o,onClearAsset:c,onAssetCreated:u}){const[h,f]=m.useState(""),[p,x]=m.useState(""),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b,_]=m.useState(""),[E,z]=m.useState(null),[N,O]=m.useState(null),[Q,U]=m.useState(null),[L,H]=m.useState(""),[A,R]=m.useState(""),[G,F]=m.useState(null),[q,ee]=m.useState(null),[me,W]=m.useState(""),J=t?a.assets.find(P=>P.id===t):null,M=m.useMemo(()=>{const P=new Map;for(const T of a.assets){const C=T.asset_category_name||T.category_name;C&&P.set(C,(P.get(C)||0)+1)}return[...P.entries()].sort((T,C)=>C[1]-T[1])},[a.assets]),V=h.length>=1||p?a.assets.filter(P=>{if(p&&(P.asset_category_name||P.category_name)!==p)return!1;if(h.length>=1){const T=h.toLowerCase();return P.name.toLowerCase().includes(T)||(P.org_unit_name??"").toLowerCase().includes(T)||(P.owner??"").toLowerCase().includes(T)||(P.category_name??"").toLowerCase().includes(T)||(P.asset_category_name??"").toLowerCase().includes(T)}return!0}).slice(0,20):[],ne=async()=>{if(b){w(!0);try{const P=await le.post("/api/v1/assets",{name:b,asset_type_id:E,category_id:N,org_unit_id:Q,owner:L||null,location:A||null,sensitivity_id:G,criticality_id:q,description:me||null});u(P),y(!1),f(""),_(""),z(null),O(null),U(null),H(""),R(""),F(null),ee(null),W("")}catch(P){alert("Blad tworzenia aktywa: "+P)}finally{w(!1)}}};return e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2461",label:"Identyfikacja aktywa (ISO 27005 \\u00A78.2)"}),J?e.jsxs("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:14,marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:11},children:"Powiazane aktywo"}),e.jsx("span",{style:{fontWeight:600,fontSize:14},children:J.name})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{color:"var(--red)",fontSize:11},onClick:c,children:"Odlacz"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px 20px",fontSize:12},children:[e.jsx(Gt,{label:"Typ",value:J.asset_type_name}),e.jsx(Gt,{label:"Kategoria",value:J.category_name}),e.jsx(Gt,{label:"Jednostka org.",value:J.org_unit_name}),e.jsx(Gt,{label:"Wlasciciel",value:J.owner}),e.jsx(Gt,{label:"Wrazliwosc",value:J.sensitivity_name}),e.jsx(Gt,{label:"Krytycznosc",value:J.criticality_name}),J.location&&e.jsx(Gt,{label:"Lokalizacja",value:J.location}),J.description&&e.jsxs("div",{style:{gridColumn:"span 2",marginTop:4},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Opis: "}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:J.description})]})]})]}):e.jsxs("div",{children:[!j&&e.jsxs("div",{style:{position:"relative",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[M.length>0&&e.jsxs("select",{className:"form-control",style:{fontSize:11,width:180,padding:"5px 8px"},value:p,onChange:P=>x(P.target.value),children:[e.jsx("option",{value:"",children:"Kategoria CMDB..."}),M.map(([P,T])=>e.jsxs("option",{value:P,children:[P," (",T,")"]},P))]}),e.jsx("div",{style:{flex:1,position:"relative"},children:e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj aktywa po nazwie, jednostce, wlascicielu...",value:h,onChange:P=>f(P.target.value)})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{y(!0),f("")},children:"+ Dodaj nowe"})]}),V.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:260,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:V.map(P=>e.jsxs("div",{style:{padding:"8px 14px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",transition:"background 0.1s"},onClick:()=>{o(P),f("")},onMouseEnter:T=>T.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:T=>T.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500,marginBottom:2},children:P.name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:10},children:[P.asset_category_name&&e.jsx("span",{className:"score-badge",style:{background:(P.asset_category_color||"var(--purple)")+"20",color:P.asset_category_color||"var(--purple)",fontSize:9,padding:"1px 5px"},children:P.asset_category_name}),!P.asset_category_name&&P.category_name&&e.jsx("span",{children:P.category_name}),P.org_unit_name&&e.jsx("span",{children:P.org_unit_name}),P.owner&&e.jsx("span",{children:P.owner}),P.sensitivity_name&&e.jsxs("span",{children:["W: ",P.sensitivity_name]}),P.criticality_name&&e.jsxs("span",{children:["K: ",P.criticality_name]})]})]},P.id))}),h.length>=1&&V.length===0&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,padding:"12px 14px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2,fontSize:12,color:"var(--text-muted)",textAlign:"center"},children:["Brak wynikow. ",e.jsx("span",{style:{color:"var(--blue)",cursor:"pointer",textDecoration:"underline"},onClick:()=>{y(!0),_(h),f("")},children:"Dodaj nowe aktywo"})]})]}),!j&&!n&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Wyszukaj i wybierz aktywo z rejestru lub dodaj nowe"})]}),j&&!J&&e.jsxs("div",{style:{background:"rgba(34,197,94,0.04)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:8,padding:16,marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13,color:"var(--green)"},children:"Nowe aktywo"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:11},onClick:()=>y(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{className:"form-control",value:b,onChange:P=>_(P.target.value),placeholder:"np. Serwer bazodanowy DB-01"}),!b&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ aktywa"}),e.jsxs("select",{className:"form-control",value:E??"",onChange:P=>z(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.asset_types.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:N??"",onChange:P=>O(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.categories.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:s,value:Q,onChange:U,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:L,onChange:P=>H(P.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{className:"form-control",value:A,onChange:P=>R(P.target.value),placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wrazliwosc"}),e.jsxs("select",{className:"form-control",value:G??"",onChange:P=>F(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.sensitivities.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{className:"form-control",value:q??"",onChange:P=>ee(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.criticalities.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:me,onChange:P=>W(P.target.value),placeholder:"Opcjonalny opis aktywa..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:S||!b,onClick:ne,children:S?"Tworzenie...":"Utworz i powiaz aktywo"})]})]})]})}const MA=[{key:"context",label:"Kontekst",num:""},{key:"asset",label:"Aktywo",num:""},{key:"scenario",label:"Scenariusz",num:""},{key:"treatment",label:"Postepowanie",num:""},{key:"acceptance",label:"Akceptacja",num:""}];function IA({editRisk:t,lookups:n,setLookups:a,orgTree:s,saving:o,onSubmit:c,onCancel:u}){const[h,f]=m.useState("context"),[p,x]=m.useState(t?.org_unit_id??null),[j,y]=m.useState(t?.risk_category_id??null),[S,w]=m.useState(t?.risk_source??""),[b,_]=m.useState(t?.identification_source_id??null),[E,z]=m.useState(t?.asset_id??null),[N,O]=m.useState(t?.asset_category_id??null),[Q,U]=m.useState(t?.asset_name??""),[L,H]=m.useState(t?.sensitivity_id??null),[A,R]=m.useState(t?.criticality_id??null),[G,F]=m.useState(t?.security_area_id??null),[q,ee]=m.useState(t?.threats?.map(Oe=>Oe.threat_id)??[]),[me,W]=m.useState(t?.vulnerabilities?.map(Oe=>Oe.vulnerability_id)??[]),[J,M]=m.useState(t?.existing_controls??""),[V,ne]=m.useState(t?.consequence_description??""),[P,T]=m.useState(t?.impact_level??2),[C,k]=m.useState(t?.probability_level??2),[I,D]=m.useState(t?.safeguard_rating??.25),[de,he]=m.useState(t?.strategy_id??null),[ie,ve]=m.useState(t?.treatment_plan??""),[je,fe]=m.useState(t?.planned_safeguard_id??null),[_e,Se]=m.useState(t?.treatment_deadline?.slice(0,10)??""),[Ve,be]=m.useState(t?.treatment_resources??""),[oe,Ue]=m.useState(t?.safeguards?.map(Oe=>Oe.safeguard_id)??[]),[Qe]=m.useState(t?.planned_actions??""),[lt,tt]=m.useState(t?.target_impact??t?.impact_level??1),[ht,xt]=m.useState(t?.target_probability??t?.probability_level??1),[qe,Nt]=m.useState(t?.target_safeguard??.95),[st,_t]=m.useState(t?.status_id??null),[zt,It]=m.useState(t?.owner??""),[va,rt]=m.useState(t?.accepted_by??""),[oa,ca]=m.useState(t?.acceptance_justification??""),[ze,et]=m.useState(t?.next_review_date?.slice(0,10)??""),it=Math.exp(P)*C/I,Be=Or(it),at=Sl(it),nt=Ru(it),ut=Math.exp(lt)*ht/qe,ta=Or(ut),Pt=Sl(ut),Tt=Ru(ut),xe=it>0?(1-ut/it)*100:0,Ie=p&&Q,mt=()=>{Ie&&c({org_unit_id:p,risk_category_id:j,risk_source:S||null,identification_source_id:b,asset_id:E,asset_category_id:N,asset_name:Q,sensitivity_id:L,criticality_id:A,security_area_id:G,existing_controls:J||null,consequence_description:V||null,impact_level:P,probability_level:C,safeguard_rating:I,strategy_id:de,treatment_plan:ie||null,planned_safeguard_id:je,treatment_deadline:_e||null,treatment_resources:Ve||null,threat_ids:q,vulnerability_ids:me,safeguard_ids:oe,planned_actions:Qe||null,target_impact:lt,target_probability:ht,target_safeguard:qe,residual_risk:Math.round(ut*100)/100,status_id:st,owner:zt||null,accepted_by:va||null,acceptance_justification:oa||null,next_review_date:ze||null})};return e.jsxs("div",{children:[e.jsxs("div",{style:{background:at,border:`1px solid ${Be}`,borderRadius:10,padding:"10px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Be,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Kalkulacja na biezaco"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",P,")  ",C," / ",I," = ",e.jsx("strong",{style:{color:Be},children:it.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Be},children:it.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Be}30`,color:Be,fontSize:12},children:nt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(Oe=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:Oe},Oe)),[3,2,1].map(Oe=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",Oe]}),[1,2,3].map(ct=>{const At=Math.exp(Oe)*ct/I,za=Oe===P&&ct===C;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:za?700:400,background:Sl(At),color:Or(At),border:za?`2px solid ${Or(At)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{T(Oe),k(ct)},children:At.toFixed(0)},`${Oe}-${ct}`)})]},`row-${Oe}`))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginTop:4},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}].map(Oe=>{const ct=Math.abs(I-Oe.value)<.01;return e.jsxs("div",{style:{padding:"6px 10px",borderRadius:6,fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",gap:8,background:ct?`${Oe.color}18`:"transparent",border:ct?`2px solid ${Oe.color}`:"2px solid var(--border)",color:ct?Oe.color:"var(--text-muted)",fontWeight:ct?600:400,transition:"all 0.15s"},onClick:()=>D(Oe.value),children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:ct?Oe.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:30},children:Oe.value.toFixed(2)}),e.jsx("span",{children:Oe.label})]},Oe.value)})]})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20,overflowX:"auto"},children:MA.map(Oe=>e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"8px 6px",minWidth:100,background:h===Oe.key?"var(--blue-dim)":"transparent",borderBottom:h===Oe.key?"2px solid var(--blue)":"2px solid var(--border)",color:h===Oe.key?"var(--blue)":"var(--text-muted)",fontWeight:h===Oe.key?600:400,fontSize:12,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onClick:()=>f(Oe.key),children:[e.jsx("span",{style:{marginRight:4},children:Oe.num}),Oe.label]},Oe.key))}),h==="context"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2460",label:"Kontekst (ISO 31000 \\u00A75.3)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:s,value:p,onChange:x,placeholder:"Wybierz...",allowClear:!1}),!p&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria ryzyka"}),e.jsxs("select",{className:"form-control",value:j??"",onChange:Oe=>y(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.risk_categories.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zrodlo identyfikacji"}),e.jsxs("select",{className:"form-control",value:b??"",onChange:Oe=>_(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.identification_sources.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Zrodlo ryzyka"}),e.jsx("textarea",{className:"form-control",rows:2,value:S,onChange:Oe=>w(Oe.target.value),placeholder:"Opisz zrodlo lub kontekst ryzyka..."})]})]})]}),h==="asset"&&e.jsx(LA,{assetId:E,assetName:Q,lookups:n,orgTree:s,onSelectAsset:Oe=>{z(Oe.id),U(Oe.name),O(Oe.category_id),H(Oe.sensitivity_id),R(Oe.criticality_id)},onClearAsset:()=>{z(null),U(""),O(null),H(null),R(null)},onAssetCreated:Oe=>{z(Oe.id),U(Oe.name),O(Oe.category_id),H(Oe.sensitivity_id),R(Oe.criticality_id),le.get("/api/v1/assets").then(ct=>{a(At=>At&&{...At,assets:ct})}).catch(ct=>console.error("Asset refresh failed:",ct))}}),h==="scenario"&&e.jsx(OA,{lookups:n,setLookups:a,assetId:E,securityAreaId:G,setSecurityAreaId:F,threatIds:q,setThreatIds:ee,vulnerabilityIds:me,setVulnerabilityIds:W,safeguardIds:oe,setSafeguardIds:Ue,existingControls:J,setExistingControls:M,consequenceDescription:V,setConsequenceDescription:ne}),h==="treatment"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2463",label:"Postepowanie z ryzykiem (ISO 27005 \\u00A78.5)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Strategia"}),e.jsxs("select",{className:"form-control",value:de??"",onChange:Oe=>he(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.strategies.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:_e,onChange:Oe=>Se(Oe.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Plan postepowania z ryzykiem"}),e.jsx("textarea",{className:"form-control",rows:3,value:ie,onChange:Oe=>ve(Oe.target.value),placeholder:"Opisz plan postepowania z ryzykiem..."})]}),e.jsx(RA,{lookups:n,setLookups:a,assetId:E,plannedSafeguardId:je,setPlannedSafeguardId:fe}),oe.length>0&&e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{color:"var(--text-muted)"},children:"Zabezpieczenia przypisane do ryzyka (z sekcji Scenariusz)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,padding:"8px 0"},children:oe.map(Oe=>{const ct=n.safeguards.find(At=>At.id===Oe);return e.jsx("span",{style:{background:"var(--green-dim)",color:"var(--green)",borderRadius:14,padding:"3px 10px",fontSize:12,fontWeight:500,border:"1px solid rgba(34,197,94,0.3)"},children:ct?.name??`#${Oe}`},Oe)})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Zasoby wymagane"}),e.jsx("textarea",{className:"form-control",rows:2,value:Ve,onChange:Oe=>be(Oe.target.value),placeholder:"Opisz wymagane zasoby (budzet, ludzie, narzedzia)..."})]})]}),e.jsx(BA,{riskId:t?.id??null,existingLinks:(t?.linked_actions??[]).map(Oe=>({action_id:Oe.action_id,title:Oe.title})),lookups:n,orgTree:s,strategyId:de}),e.jsxs("div",{style:{background:Pt,border:`1px solid ${ta}`,borderRadius:10,padding:"12px 20px",marginTop:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:ta,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ryzyko rezydualne (docelowe)"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R",e.jsx("sub",{children:"res"})," = EXP(",lt,")  ",ht," / ",qe," = ",e.jsx("strong",{style:{color:ta},children:ut.toFixed(1)}),xe>0&&e.jsxs("span",{style:{marginLeft:8,color:"var(--green)"},children:["(-",xe.toFixed(0),"%)"]})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:ta},children:ut.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${ta}30`,color:ta,fontSize:11},children:Tt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowy W"}),e.jsxs("select",{className:"form-control",value:lt,onChange:Oe=>tt(Number(Oe.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niski"}),e.jsx("option",{value:"2",children:"2 -- Sredni"}),e.jsx("option",{value:"3",children:"3 -- Wysoki"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowe P"}),e.jsxs("select",{className:"form-control",value:ht,onChange:Oe=>xt(Number(Oe.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niskie"}),e.jsx("option",{value:"2",children:"2 -- Srednie"}),e.jsx("option",{value:"3",children:"3 -- Wysokie"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowe Z"}),e.jsxs("select",{className:"form-control",value:qe,onChange:Oe=>Nt(Number(Oe.target.value)),children:[e.jsx("option",{value:"0.10",children:"0,10 -- Brak"}),e.jsx("option",{value:"0.25",children:"0,25 -- Czesciowe"}),e.jsx("option",{value:"0.70",children:"0,70 -- Dobre"}),e.jsx("option",{value:"0.95",children:"0,95 -- Skuteczne"})]})]})]})]})]}),h==="acceptance"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2464",label:"Akceptacja i monitorowanie (ISO 27005 \\u00A78.6/\\u00A79)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:st??"",onChange:Oe=>_t(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.statuses.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel ryzyka"}),e.jsx("input",{className:"form-control",value:zt,onChange:Oe=>It(Oe.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zaakceptowane przez"}),e.jsx("input",{className:"form-control",value:va,onChange:Oe=>rt(Oe.target.value),placeholder:"Imie i nazwisko akceptujacego"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data nastepnego przegladu"}),e.jsx("input",{type:"date",className:"form-control",value:ze,onChange:Oe=>et(Oe.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Uzasadnienie akceptacji"}),e.jsx("textarea",{className:"form-control",rows:2,value:oa,onChange:Oe=>ca(Oe.target.value),placeholder:"Uzasadnienie akceptacji poziomu ryzyka..."})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:o||!Ie,onClick:mt,children:o?"Zapisywanie...":t?"Zapisz zmiany":"Zapisz ryzyko"})]})]})}function PA(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(!1),[u,h]=m.useState(null),[f,p]=m.useState(!1),x=()=>{le.get("/api/v1/risk-reviews/overdue").then(n).catch(()=>{}).finally(()=>s(!1))};m.useEffect(()=>{x()},[]);const j=S=>{h(S),c(!0)},y=async S=>{if(S.preventDefault(),!u)return;p(!0);const w=new FormData(S.currentTarget),b={risk_id:u.risk_id,notes:w.get("notes")||null};try{await le.post("/api/v1/risk-reviews",b),c(!1),s(!0),x()}catch(_){alert("Bd zapisu: "+_)}finally{p(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-3",children:[e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--red)"},children:t.length||""}),e.jsx("div",{className:"label",children:"Przeterminowane przegldy"})]}),e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--yellow)"},children:""}),e.jsx("div",{className:"label",children:"Do przegldu w tym miesicu"})]}),e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--green)"},children:""}),e.jsx("div",{className:"label",children:"Aktualne"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-title",children:["Ryzyka Wymagajce Przegldu ",e.jsx("span",{style:{color:"var(--red)"},children:"(przeterminowane >90 dni)"})]}),a?e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"adowanie..."}):t.length===0?e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Brak przeterminowanych przegldw lub brak poczenia z API."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ostatni przegld"}),e.jsx("th",{children:"Dni od przegldu"}),e.jsx("th",{children:"Akcja"})]})}),e.jsx("tbody",{children:t.map(S=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:S.code}),e.jsx("td",{children:S.asset_name}),e.jsx("td",{children:S.org_unit_name}),e.jsx("td",{children:S.last_review_at??"Nigdy"}),e.jsx("td",{children:e.jsxs("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:[S.days_since_review," dni"]})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",onClick:()=>j(S),children:" Przejrzyj"})})]},S.risk_id))})]})]}),e.jsx(gt,{open:o,onClose:()=>c(!1),title:`Przegld: ${u?.asset_name??""}`,children:u&&e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{style:{marginBottom:16,fontSize:13,color:"var(--text-secondary)"},children:[e.jsxs("p",{children:["Ryzyko: ",e.jsx("strong",{children:u.code}),"  ",u.asset_name]}),e.jsxs("p",{children:["Pion: ",u.org_unit_name]}),e.jsxs("p",{children:["Ostatni przegld: ",u.last_review_at??"Nigdy"," (",u.days_since_review," dni temu)"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki z przegldu"}),e.jsx("textarea",{name:"notes",className:"form-control",rows:4,placeholder:"Opisz wynik przegldu ryzyka..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>c(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?"Zapisywanie...":"Zarejestruj przegld"})]})]})})]})}function WA(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(null),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(!1),[_,E]=m.useState(null),[z,N]=m.useState(null),[O,Q]=m.useState(!1),[U,L]=m.useState(null),[H,A]=m.useState(!1),R=async()=>{try{const T=await le.get("/api/v1/dictionaries");n(T),c(null)}catch(T){c(String(T))}finally{s(!1)}};m.useEffect(()=>{R()},[]);const G=async T=>{p(!0),j(!1),S(null);try{const C=await le.get(`/api/v1/dictionaries/${T.code}/entries?include_archived=true`);h(C)}catch{h({id:T.id,code:T.code,name:T.name,description:T.description,is_system:T.is_system,entries:[]})}finally{p(!1)}},F=async T=>{try{const C=await le.get(`/api/v1/dictionaries/${T}/entries?include_archived=true`);h(C),R()}catch{}},q=async T=>{if(T.preventDefault(),!u)return;b(!0);const C=new FormData(T.currentTarget),k={label:C.get("label"),code:C.get("code")||void 0,description:C.get("description")||void 0,numeric_value:C.get("numeric_value")?Number(C.get("numeric_value")):void 0,color:C.get("color")||void 0,sort_order:C.get("sort_order")?Number(C.get("sort_order")):0};try{await le.post(`/api/v1/dictionaries/${u.code}/entries`,k),j(!1),await F(u.code)}catch(I){alert("Blad zapisu: "+I)}finally{b(!1)}},ee=async T=>{if(T.preventDefault(),!u||!y)return;b(!0);const C=new FormData(T.currentTarget),k={label:C.get("label"),code:C.get("code")||null,description:C.get("description")||null,numeric_value:C.get("numeric_value")?Number(C.get("numeric_value")):null,color:C.get("color")||null,sort_order:C.get("sort_order")?Number(C.get("sort_order")):0};try{await le.put(`/api/v1/dictionaries/entries/${y.id}`,k),S(null),await F(u.code)}catch(I){alert("Blad zapisu: "+I)}finally{b(!1)}},me=async T=>{E(T),L(null),Q(!0);try{const C=await le.get(`/api/v1/dictionaries/entries/${T.id}/usage`);N(C)}catch{N({entry_id:T.id,entry_label:T.label,total_references:0,details:[]})}finally{Q(!1)}},W=async()=>{if(!(!u||!_)){A(!0);try{z&&z.total_references>0&&U?await le.post(`/api/v1/dictionaries/entries/${_.id}/reassign`,{target_id:U}):await le.patch(`/api/v1/dictionaries/entries/${_.id}/archive`,{}),E(null),N(null),await F(u.code)}catch(T){alert("Blad: "+T)}finally{A(!1)}}},J=async T=>{if(u)try{await le.put(`/api/v1/dictionaries/entries/${T.id}`,{is_active:!0}),await F(u.code)}catch(C){alert("Blad: "+C)}},M=async(T,C)=>{if(!u)return;const k=u.entries.filter(he=>he.is_active).sort((he,ie)=>he.sort_order-ie.sort_order),I=k.findIndex(he=>he.id===T.id);if(I<0)return;const D=C==="up"?I-1:I+1;if(D<0||D>=k.length)return;const de=k.map((he,ie)=>ie===I?{id:he.id,sort_order:k[D].sort_order}:ie===D?{id:he.id,sort_order:k[I].sort_order}:{id:he.id,sort_order:he.sort_order});try{await le.put("/api/v1/dictionaries/entries/reorder",{items:de}),await F(u.code)}catch(he){alert("Blad: "+he)}};if(a)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:256},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Ladowanie slownikow..."})});if(o)return e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{color:"var(--red)",fontSize:13,marginBottom:8},children:"Nie udalo sie zaladowac slownikow"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace",wordBreak:"break-all"},children:o})]});const V=u?.entries.filter(T=>T.is_active).sort((T,C)=>T.sort_order-C.sort_order)??[],ne=u?.entries.filter(T=>!T.is_active)??[],P=V.filter(T=>T.id!==_?.id);return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-3",children:[t.map(T=>e.jsxs("div",{className:"card clickable",onClick:()=>G(T),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:T.name}),e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:T.entry_count})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Kod: ",e.jsx("code",{style:{color:"var(--text-muted)"},children:T.code})]}),T.is_system&&e.jsx("div",{style:{marginTop:8,fontSize:10,color:"var(--text-muted)"},children:"Slownik systemowy"})]},T.id)),t.length===0&&e.jsx("div",{style:{gridColumn:"span 3",textAlign:"center",color:"var(--text-muted)",fontSize:13,padding:"48px 0"},children:"Brak slownikow w systemie."})]}),e.jsx(gt,{open:!!u,onClose:()=>{h(null),S(null)},title:u?.name??"Slownik",wide:!0,children:f?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie pozycji..."}):u&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["Kod: ",e.jsx("code",{style:{color:"var(--blue)"},children:u.code}),"  ",V.length," aktywnych",ne.length>0&&e.jsxs("span",{children:["  ",ne.length," archiwalnych"]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{j(!x),S(null)},children:x?"Anuluj":"+ Dodaj pozycje"})]}),x&&e.jsx(Sv,{onSubmit:q,saving:w,onCancel:()=>j(!1)}),y&&e.jsx(Sv,{entry:y,onSubmit:ee,saving:w,onCancel:()=>S(null)}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:60},children:"Kol."}),e.jsx("th",{children:"Etykieta"}),e.jsx("th",{children:"Kod"}),e.jsx("th",{children:"Wartosc"}),e.jsx("th",{children:"Kolor"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:200},children:"Akcje"})]})}),e.jsx("tbody",{children:V.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",fontSize:13,padding:24},children:"Brak pozycji w slowniku"})}):V.map((T,C)=>e.jsxs("tr",{style:{background:y?.id===T.id?"rgba(59,130,246,0.08)":void 0},children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:2},children:[e.jsx("button",{className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},disabled:C===0,onClick:()=>M(T,"up"),title:"W gore",children:""}),e.jsx("button",{className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},disabled:C===V.length-1,onClick:()=>M(T,"down"),title:"W dol",children:""}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)",marginLeft:4},children:T.sort_order})]})}),e.jsx("td",{style:{fontWeight:500},children:T.label}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.code??""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:T.numeric_value??""}),e.jsx("td",{children:T.color?e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:14,height:14,borderRadius:3,background:T.color,display:"inline-block",border:"1px solid rgba(255,255,255,0.1)"}}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace"},children:T.color})]}):""}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:"Aktywny"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{S(T),j(!1)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>me(T),children:"Archiwizuj"})]})})]},T.id))})]}),ne.length>0&&e.jsxs("div",{style:{marginTop:20},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:"Archiwalne pozycje"}),e.jsx("table",{className:"data-table",children:e.jsx("tbody",{children:ne.map(T=>e.jsxs("tr",{style:{opacity:.5},children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.id}),e.jsx("td",{children:T.label}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.code??""}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:"Archiwalny"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",onClick:()=>J(T),children:"Przywroc"})})]},T.id))})})]})]})}),e.jsx(gt,{open:!!_,onClose:()=>{E(null),N(null)},title:`Archiwizacja: ${_?.label??""}`,children:O?e.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:"Sprawdzanie powiazanych rekordow..."}):z&&z.total_references===0?e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:13,marginBottom:16},children:["Pozycja ",e.jsxs("strong",{children:['"',_?.label,'"']})," nie jest uzywana w zadnych rekordach. Mozna ja bezpiecznie zarchiwizowac."]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>{E(null),N(null)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:H,children:H?"Archiwizowanie...":"Archiwizuj"})]})]}):z?e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(245,158,11,0.08)",border:"1px solid rgba(245,158,11,0.3)",borderRadius:8,padding:14,marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--orange)",marginBottom:6},children:["Pozycja jest uzywana w ",z.total_references," rekordach"]}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Przed archiwizacja musisz przepiac referencje na inna pozycje tego samego slownika. Wszystkie powiazane rekordy zostana automatycznie zaktualizowane."})]}),e.jsxs("table",{className:"data-table",style:{marginBottom:16},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Modul"}),e.jsx("th",{children:"Pole"}),e.jsx("th",{style:{textAlign:"right"},children:"Liczba rekordow"})]})}),e.jsx("tbody",{children:z.details.map((T,C)=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:13},children:T.table}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.column}),e.jsx("td",{style:{textAlign:"right",fontWeight:600},children:T.count})]},C))})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:4,display:"block"},children:"Przepnij wszystkie referencje na:"}),e.jsxs("select",{className:"form-control",value:U??"",onChange:T=>L(T.target.value?Number(T.target.value):null),children:[e.jsx("option",{value:"",children:" wybierz docelowa pozycje "}),P.map(T=>e.jsxs("option",{value:T.id,children:[T.label,T.code?` (${T.code})`:""]},T.id))]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>{E(null),N(null)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:H||!U,title:U?void 0:"Wybierz docelowa pozycje",children:H?"Przenoszenie...":`Przepnij (${z.total_references}) i archiwizuj`})]})]}):null})]})}function Sv({entry:t,onSubmit:n,saving:a,onCancel:s}){return e.jsxs("form",{onSubmit:n,style:{background:"var(--bg-inset)",borderRadius:8,padding:16,marginBottom:16,border:"1px solid var(--border)"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",marginBottom:10},children:t?`Edycja: ${t.label}`:"Nowa pozycja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta *"}),e.jsx("input",{name:"label",className:"form-control",required:!0,defaultValue:t?.label??"",placeholder:"np. Wysoki"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod"}),e.jsx("input",{name:"code",className:"form-control",defaultValue:t?.code??"",placeholder:"np. high"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wartosc numeryczna"}),e.jsx("input",{name:"numeric_value",type:"number",step:"any",className:"form-control",defaultValue:t?.numeric_value??"",placeholder:"np. 3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("input",{name:"color",className:"form-control",defaultValue:t?.color??"",placeholder:"np. #ff0000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc sortowania"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:t?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("input",{name:"description",className:"form-control",defaultValue:t?.description??"",placeholder:"Opcjonalny opis"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:s,children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:a,children:a?"Zapisywanie...":t?"Zapisz zmiany":"Dodaj"})]})]})}function wv(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function UA(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function Hd(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("wysok")||n.includes("high")||n.includes("krytycz")?"var(--red)":n.includes("redni")||n.includes("medium")?"var(--orange)":"var(--green)"}function $A(){const t=on(),[n,a]=m.useState([]),[s,o]=m.useState(!0),[c,u]=m.useState(!1),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(null),[b,_]=m.useState("info"),[E,z]=m.useState([]),[N,O]=m.useState(!1),[Q,U]=m.useState(!1),L=[{key:"id",header:"ID"},{key:"name",header:"Nazwa"},{key:"asset_type_name",header:"Typ",format:C=>C.asset_type_name??""},{key:"category_name",header:"Kategoria",format:C=>C.category_name??""},{key:"org_unit_name",header:"Jednostka org.",format:C=>C.org_unit_name??""},{key:"owner",header:"Waciciel",format:C=>C.owner??""},{key:"criticality_name",header:"Krytyczno",format:C=>C.criticality_name??""},{key:"risk_count",header:"Ryzyka",format:C=>String(C.risk_count)},{key:"sensitivity_name",header:"Wraliwo",format:C=>C.sensitivity_name??"",defaultVisible:!1},{key:"parent_name",header:"Nadrzdne aktywo",format:C=>C.parent_name??"",defaultVisible:!1},{key:"location",header:"Lokalizacja",format:C=>C.location??"",defaultVisible:!1},{key:"description",header:"Opis",format:C=>C.description??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:C=>C.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:C=>C.updated_at?.slice(0,10)??"",defaultVisible:!1}],{visible:H,toggle:A}=da(L,"assets"),R=Aa({data:n,storageKey:"assets",defaultSort:"name"}),[G,F]=m.useState([]),q=()=>{le.get("/api/v1/assets").then(C=>{a(C)}).catch(()=>{}).finally(()=>o(!1))};m.useEffect(()=>{q(),le.get("/api/v1/org-units/tree").then(F).catch(()=>{})},[]);const ee=m.useMemo(()=>Tl(G),[G]),me=m.useCallback(C=>{O(!0),le.get(`/api/v1/exceptions?asset_id=${C}`).then(z).catch(()=>z([])).finally(()=>O(!1))},[]);m.useEffect(()=>{S?(me(S.id),_("info")):z([])},[S?.id]);const W=async()=>{if(j)return j;const[C,k]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),I=async je=>{try{return(await le.get(`/api/v1/dictionaries/${je}/entries`)).entries.filter(_e=>_e.is_active).map(_e=>({id:_e.id,label:_e.label}))}catch{return[]}},[D,de,he,ie]=await Promise.all([I("asset_type"),I("asset_category"),I("sensitivity"),I("criticality")]),ve={orgUnits:C,assets:k,assetTypes:D,categories:de,sensitivities:he,criticalities:ie};return y(ve),ve},J=async()=>{await W(),f(null),u(!0)},M=async C=>{await W(),f(C),u(!0)},V=async C=>{C.preventDefault(),x(!0);const k=new FormData(C.currentTarget),I={name:k.get("name"),asset_type_id:k.get("asset_type_id")?Number(k.get("asset_type_id")):null,category_id:k.get("category_id")?Number(k.get("category_id")):null,org_unit_id:k.get("org_unit_id")?Number(k.get("org_unit_id")):null,parent_id:k.get("parent_id")?Number(k.get("parent_id")):null,owner:k.get("owner")||null,description:k.get("description")||null,location:k.get("location")||null,sensitivity_id:k.get("sensitivity_id")?Number(k.get("sensitivity_id")):null,criticality_id:k.get("criticality_id")?Number(k.get("criticality_id")):null};try{if(h){const D=await le.put(`/api/v1/assets/${h.id}`,I);w(D)}else await le.post("/api/v1/assets",I);u(!1),f(null),y(null),o(!0),q()}catch(D){alert("Bd zapisu: "+D)}finally{x(!1)}},ne=async C=>{if(confirm(`Archiwizowa aktyw "${C.name}"?`))try{await le.delete(`/api/v1/assets/${C.id}`),w(null),o(!0),q()}catch(k){alert("Bd: "+k)}},P=[...new Map(n.filter(C=>C.asset_type_id).map(C=>[C.asset_type_id,{id:C.asset_type_id,name:C.asset_type_name}])).values()],T=[...new Map(n.filter(C=>C.org_unit_id).map(C=>[C.org_unit_id,{id:C.org_unit_id,name:C.org_unit_name}])).values()];return e.jsxs("div",{children:[e.jsx(Ia,{cards:[{label:"Aktywnych aktyww",value:R.filtered.filter(C=>C.is_active).length,total:n.filter(C=>C.is_active).length,color:"var(--blue)"},{label:"Z przypisanymi ryzykami",value:R.filtered.filter(C=>C.risk_count>0).length,total:n.filter(C=>C.risk_count>0).length,color:"var(--orange)"},{label:"Typw aktyww",value:new Set(R.filtered.filter(C=>C.asset_type_id).map(C=>C.asset_type_id)).size,total:P.length,color:"var(--purple)"},{label:"Jednostek organizacyjnych",value:new Set(R.filtered.filter(C=>C.org_unit_id).map(C=>C.org_unit_id)).size,total:T.length,color:"var(--cyan)"}],isFiltered:R.filteredCount!==R.totalCount}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"aktyww",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj aktyww...",showFilters:Q,onToggleFilters:()=>U(C=>!C),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:L,visibleColumns:H,onToggleColumn:A,data:R.filtered,exportFilename:"aktywa",primaryLabel:"Dodaj aktyw",onPrimaryAction:J}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:S?"1fr 380px":"1fr",gap:14},children:[e.jsx(Ea,{columns:L,visibleColumns:H,data:R.pageData,rowKey:C=>C.id,selectedKey:S?.id??null,onRowClick:C=>w(S?.id===C.id?null:C),sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:Q,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:s,emptyMessage:"Brak aktyww w systemie.",emptyFilteredMessage:"Brak aktyww pasujcych do filtrw.",renderCell:(C,k)=>{if(k==="id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:C.id});if(k==="name")return e.jsx("span",{style:{fontWeight:500},children:C.name});if(k==="asset_type_name")return C.asset_type_name?e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)"},children:C.asset_type_name}):"";if(k==="category_name")return C.category_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:C.category_name}):"";if(k==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:(C.org_unit_id?ee.get(C.org_unit_id):null)??C.org_unit_name??""});if(k==="criticality_name")return C.criticality_name?e.jsx("span",{className:"score-badge",style:{background:Hd(C.criticality_name)==="var(--red)"?"var(--red-dim)":Hd(C.criticality_name)==="var(--orange)"?"var(--orange-dim)":"var(--green-dim)",color:Hd(C.criticality_name)},children:C.criticality_name}):""}}),S&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy aktywa"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>w(null),children:""})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--text-primary)"},children:S.name}),S.asset_type_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)",fontSize:12,marginTop:6},children:S.asset_type_name})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"info",label:"Informacje"},{key:"exceptions",label:`Wyjatki (${E.length})`}].map(C=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"6px 10px",background:b===C.key?"var(--blue-dim)":"transparent",borderBottom:b===C.key?"2px solid var(--blue)":"2px solid var(--border)",color:b===C.key?"var(--blue)":"var(--text-muted)",fontWeight:b===C.key?600:400,fontSize:12,cursor:"pointer",transition:"all 0.2s"},onClick:()=>_(C.key),children:C.label},C.key))}),b==="info"&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"ID"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["A-",S.id]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Kategoria"}),e.jsx("span",{children:S.category_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Jednostka org."}),e.jsx("span",{style:{fontSize:11},children:(S.org_unit_id?ee.get(S.org_unit_id):null)??S.org_unit_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Wlasciciel"}),e.jsx("span",{children:S.owner??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Lokalizacja"}),e.jsx("span",{children:S.location??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Wrazliwosc"}),e.jsx("span",{children:S.sensitivity_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Krytycznosc"}),e.jsx("span",{style:{fontWeight:500,color:Hd(S.criticality_name)},children:S.criticality_name??""})]}),S.parent_name&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Nadrzedny aktyw"}),e.jsx("span",{children:S.parent_name})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Powiazane ryzyka"}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:S.risk_count>0?"var(--red)":"var(--text-muted)",cursor:S.risk_count>0?"pointer":"default"},onClick:()=>{S.risk_count>0&&t(`/risks?asset=${S.id}`)},children:S.risk_count})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Utworzono"}),e.jsx("span",{children:S.created_at?.slice(0,10)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Zaktualizowano"}),e.jsx("span",{children:S.updated_at?.slice(0,10)})]}),S.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:S.description})]})]})}),b==="exceptions"&&e.jsx("div",{children:N?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie wyjatkow..."}):E.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zarejestrowanych wyjatkow dla tego aktywa."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:E.map(C=>{const k=C.risk_score??0,I=C.expiry_date?new Date(C.expiry_date)<new Date:!1;return e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,background:"var(--bg-inset)",border:"1px solid var(--border)",borderLeft:C.risk_score!=null?`3px solid ${wv(k)}`:"3px solid var(--border)",cursor:"pointer"},onClick:()=>t(`/exceptions?highlight=${C.id}`),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:C.ref_id}),C.status_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:C.status_name})]}),e.jsx("div",{style:{fontSize:12,fontWeight:500,marginBottom:4},children:C.title}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[C.risk_score!=null?e.jsxs("span",{className:"score-badge",style:{background:UA(k),color:wv(k),fontSize:10},children:["R: ",k.toFixed(1)]}):e.jsx("span",{}),e.jsx("span",{style:{color:I?"var(--red)":"var(--text-muted)",fontWeight:I?600:400},children:I?"WYGASLY":`do ${C.expiry_date}`})]})]},C.id)})})}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>M(S),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>ne(S),children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:c,onClose:()=>{u(!1),f(null)},title:h?`Edytuj aktyw: ${h.name}`:"Dodaj aktyw",wide:!0,children:j?e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:h?.name??"",placeholder:"np. Serwer bazodanowy DB-01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ aktywa"}),e.jsxs("select",{name:"asset_type_id",className:"form-control",defaultValue:h?.asset_type_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.assetTypes.map(C=>e.jsx("option",{value:C.id,children:C.label},C.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{name:"category_id",className:"form-control",defaultValue:h?.category_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.categories.map(C=>e.jsx("option",{value:C.id,children:C.label},C.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:j.orgUnits,value:h?.org_unit_id??null,onChange:C=>{const k=document.querySelector('input[name="org_unit_id"]');k&&(k.value=C?String(C):"")},placeholder:"Wybierz...",allowClear:!0}),e.jsx("input",{type:"hidden",name:"org_unit_id",defaultValue:h?.org_unit_id??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nadrzdny aktyw"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:h?.parent_id??"",children:[e.jsx("option",{value:"",children:"Brak (gwny)"}),j.assets.filter(C=>!h||C.id!==h.id).map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:h?.owner??"",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{name:"location",className:"form-control",defaultValue:h?.location??"",placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wraliwo"}),e.jsxs("select",{name:"sensitivity_id",className:"form-control",defaultValue:h?.sensitivity_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.sensitivities.map(C=>e.jsx("option",{value:C.id,children:C.label},C.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytyczno"}),e.jsxs("select",{name:"criticality_id",className:"form-control",defaultValue:h?.criticality_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.criticalities.map(C=>e.jsx("option",{value:C.id,children:C.label},C.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:3,defaultValue:h?.description??"",placeholder:"Opcjonalny opis aktywa..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{u(!1),f(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Zapisywanie...":h?"Zapisz zmiany":"Dodaj aktyw"})]})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie danych formularza..."})})]})}const HA={HardDrive:"",Server:"",Monitor:"",Laptop:"",Smartphone:"",Printer:"",Database:"",Network:"",Globe:"",Router:"",Shield:"",Code:"",Layers:"",AppWindow:"",Cloud:"",Settings:"",Users:"",User:"",UsersGroup:"",Briefcase:"",FileText:"",File:"",Table:"",Key:"",Building:"",MapPin:"",Door:"",Workflow:"",GitBranch:"",Headphones:""};function VA(t){return t?HA[t]??"":""}function yb({node:t,depth:n,selectedId:a,onSelect:s,expandedIds:o,toggleExpand:c}){const u=t.children.length>0,h=o.has(t.id),f=a===t.id,p=t.is_abstract;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>{u&&c(t.id),s(t)},style:{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",paddingLeft:n*16+8,cursor:"pointer",background:f?"var(--blue-dim)":"transparent",borderLeft:f?"3px solid var(--blue)":"3px solid transparent",fontSize:12,transition:"all 0.15s",color:f?"var(--blue)":"var(--text-primary)",fontWeight:f||p?600:400,whiteSpace:"nowrap",overflow:"hidden"},onMouseEnter:x=>{f||(x.currentTarget.style.background="rgba(255,255,255,0.03)")},onMouseLeave:x=>{f||(x.currentTarget.style.background="transparent")},children:[u?e.jsx("span",{style:{fontSize:8,width:12,textAlign:"center",color:"var(--text-muted)",userSelect:"none",flexShrink:0,transition:"transform 0.15s",transform:h?"rotate(90deg)":"rotate(0deg)"},children:""}):e.jsx("span",{style:{width:12,flexShrink:0}}),e.jsx("span",{style:{flexShrink:0,fontSize:13},children:VA(t.icon)}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",flex:1},children:t.name}),t.asset_count>0&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",background:"rgba(255,255,255,0.05)",borderRadius:8,padding:"1px 6px",flexShrink:0,fontFamily:"'JetBrains Mono',monospace"},children:t.asset_count})]}),h&&u&&t.children.map(x=>e.jsx(yb,{node:x,depth:n+1,selectedId:a,onSelect:s,expandedIds:o,toggleExpand:c},x.id))]})}function vb({tree:t,selectedId:n,onSelect:a,loading:s}){const[o,c]=m.useState(()=>new Set(t.map(j=>j.id))),[u,h]=m.useState("");m.useEffect(()=>{c(new Set(t.map(j=>j.id)))},[t]);const f=j=>{c(y=>{const S=new Set(y);return S.has(j)?S.delete(j):S.add(j),S})},p=u?jb(t,u.toLowerCase()):t,x=bb(t);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",borderRight:"1px solid var(--border)",background:"var(--bg-card)",minWidth:220,maxWidth:280,width:250},children:[e.jsxs("div",{style:{padding:"12px 12px 8px",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)",marginBottom:8},children:"Kategorie Aktywow"}),e.jsx("input",{type:"text",value:u,onChange:j=>h(j.target.value),placeholder:"Szukaj kategorii...",style:{width:"100%",padding:"5px 8px",fontSize:11,background:"var(--bg-input, var(--bg-main))",border:"1px solid var(--border)",borderRadius:5,color:"var(--text-primary)",outline:"none"}})]}),e.jsxs("div",{onClick:()=>a(null),style:{display:"flex",alignItems:"center",gap:6,padding:"7px 12px",cursor:"pointer",fontSize:12,background:n===null?"var(--blue-dim)":"transparent",borderLeft:n===null?"3px solid var(--blue)":"3px solid transparent",color:n===null?"var(--blue)":"var(--text-primary)",fontWeight:n===null?600:500,borderBottom:"1px solid var(--border)"},onMouseEnter:j=>{n!==null&&(j.currentTarget.style.background="rgba(255,255,255,0.03)")},onMouseLeave:j=>{n!==null&&(j.currentTarget.style.background="transparent")},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("span",{style:{flex:1},children:"Wszystkie aktywa"}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:x})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"4px 0"},children:s?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie kategorii..."}):p.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:u?`Brak wynikow dla "${u}"`:"Brak kategorii"}):p.map(j=>e.jsx(yb,{node:j,depth:0,selectedId:n,onSelect:y=>a(y),expandedIds:o,toggleExpand:f},j.id))})]})}function jb(t,n){const a=[];for(const s of t){const o=jb(s.children,n);(s.name.toLowerCase().includes(n)||o.length>0)&&a.push({...s,children:o.length>0?o:s.children})}return a}function bb(t){let n=0;for(const a of t)n+=a.asset_count,n+=bb(a.children);return n}function _b({fields:t,values:n,onChange:a,readOnly:s=!1}){const o=m.useMemo(()=>{const x=new Map;for(const j of t){const y=j.tab_name||"Informacje";x.has(y)||x.set(y,[]),x.get(y).push(j)}for(const[,j]of x)j.sort((y,S)=>y.sort_order-S.sort_order);return x},[t]),c=m.useMemo(()=>[...o.keys()],[o]),[u,h]=m.useState(c[0]||"Informacje"),f=c.includes(u)?u:c[0]||"Informacje",p=o.get(f)||[];return t.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych pol dla tej kategorii."}):e.jsxs("div",{children:[c.length>1&&e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14,borderBottom:"1px solid var(--border)"},children:c.map(x=>e.jsx("div",{onClick:()=>h(x),style:{padding:"6px 14px",fontSize:12,cursor:"pointer",borderBottom:f===x?"2px solid var(--blue)":"2px solid transparent",color:f===x?"var(--blue)":"var(--text-muted)",fontWeight:f===x?600:400,transition:"all 0.15s"},children:x},x))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:p.map(x=>e.jsx(ZA,{field:x,value:n[x.field_key]??x.default_value??"",onChange:j=>a(x.field_key,j),readOnly:s},x.field_key))})]})}function ZA({field:t,value:n,onChange:a,readOnly:s}){const c=t.field_type==="textarea"?{gridColumn:"span 2"}:{},u=e.jsxs("label",{style:{display:"block",marginBottom:4,fontSize:12,color:"var(--text-muted)"},children:[t.label,t.is_required&&e.jsx("span",{style:{color:"var(--red)",marginLeft:2},children:"*"}),t.inherited_from_id&&e.jsx("span",{style:{fontSize:9,color:"var(--purple)",marginLeft:4},title:"Odziedziczone z kategorii nadrzednej",children:"(dziedz.)"})]}),h={width:"100%",padding:"6px 10px",fontSize:13,background:s?"transparent":"var(--bg-input, var(--bg-card))",border:s?"none":"1px solid var(--border)",borderRadius:6,color:"var(--text-primary)",outline:"none"};switch(t.field_type){case"text":case"email":case"url":return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(n||"")||""}):e.jsx("input",{type:t.field_type==="email"?"email":t.field_type==="url"?"url":"text",value:String(n||""),onChange:f=>a(f.target.value||null),placeholder:t.placeholder||void 0,required:t.is_required,maxLength:t.max_length||void 0,className:"form-control",style:h})]});case"number":return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0",fontFamily:"'JetBrains Mono',monospace"},children:n!=null&&n!==""?String(n):""}):e.jsx("input",{type:"number",value:n!=null&&n!==""?String(n):"",onChange:f=>a(f.target.value?Number(f.target.value):null),placeholder:t.placeholder||void 0,required:t.is_required,min:t.min_value??void 0,max:t.max_value??void 0,className:"form-control",style:h})]});case"date":return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(n||"")||""}):e.jsx("input",{type:"date",value:String(n||""),onChange:f=>a(f.target.value||null),required:t.is_required,className:"form-control",style:h})]});case"boolean":return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:n===!0?"Tak":n===!1?"Nie":""}):e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:!!n,onChange:f=>a(f.target.checked),style:{width:16,height:16}}),e.jsx("span",{children:n?"Tak":"Nie"})]})]});case"select":{const f=kv(t.options_json);return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(n||"")||""}):e.jsxs("select",{value:String(n||""),onChange:p=>a(p.target.value||null),required:t.is_required,className:"form-control",style:h,children:[e.jsx("option",{value:"",children:"Wybierz..."}),f.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))]})]})}case"multiselect":{const f=kv(t.options_json),p=Array.isArray(n)?n:[];return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:p.join(", ")||""}):e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:f.map(x=>{const j=p.includes(x.value);return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,padding:"3px 8px",borderRadius:12,cursor:"pointer",background:j?"var(--blue-dim)":"rgba(255,255,255,0.03)",border:j?"1px solid var(--blue)":"1px solid var(--border)",color:j?"var(--blue)":"var(--text-secondary)"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:()=>{const y=j?p.filter(S=>S!==x.value):[...p,x.value];a(y.length>0?y:null)},style:{display:"none"}}),x.label]},x.value)})})]})}case"reference":return e.jsxs("div",{className:"form-group",style:c,children:[u,e.jsx(GA,{field:t,value:n,onChange:a,readOnly:s,inputStyle:h})]});case"textarea":return e.jsxs("div",{className:"form-group",style:c,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0",whiteSpace:"pre-wrap"},children:String(n||"")||""}):e.jsx("textarea",{value:String(n||""),onChange:f=>a(f.target.value||null),placeholder:t.placeholder||void 0,required:t.is_required,rows:3,className:"form-control",style:{...h,resize:"vertical"}})]});default:return e.jsxs("div",{className:"form-group",style:c,children:[u,e.jsx("input",{type:"text",value:String(n||""),onChange:f=>a(f.target.value||null),className:"form-control",style:h})]})}}function GA({field:t,value:n,onChange:a,readOnly:s,inputStyle:o}){const[c,u]=m.useState([]),[h,f]=m.useState(!1);m.useEffect(()=>{t.reference_category_id&&(f(!0),le.get(`/api/v1/assets?asset_category_id=${t.reference_category_id}`).then(u).catch(()=>u([])).finally(()=>f(!1)))},[t.reference_category_id]);const p=m.useMemo(()=>n?c.find(j=>j.id===Number(n))?.name||`Asset #${n}`:null,[n,c]);return s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:p||""}):e.jsxs("select",{value:n!=null?String(n):"",onChange:x=>a(x.target.value?Number(x.target.value):null),required:t.is_required,className:"form-control",style:o,disabled:h,children:[e.jsx("option",{value:"",children:h?"Ladowanie...":"Wybierz aktyw..."}),c.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})}function kv(t){if(!t)return[];let n=t;if(typeof t=="string")try{n=JSON.parse(t)}catch{return[]}return Array.isArray(n)?n.map(a=>typeof a=="string"?{value:a,label:a}:typeof a=="object"&&a!==null&&"value"in a&&"label"in a?{value:String(a.value),label:String(a.label)}:{value:String(a),label:String(a)}):[]}const KA={HardDrive:"",Server:"",Monitor:"",Laptop:"",Smartphone:"",Printer:"",Database:"",Network:"",Globe:"",Router:"",Shield:"",Code:"",Layers:"",AppWindow:"",Cloud:"",Settings:"",Users:"",User:"",UsersGroup:"",Briefcase:"",FileText:"",File:"",Table:"",Key:"",Building:"",MapPin:"",Door:"",Workflow:"",GitBranch:"",Headphones:""};function qA(t){return t?KA[t]??"":""}function Vd(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("wysok")||n.includes("high")||n.includes("krytycz")?"var(--red)":n.includes("redni")||n.includes("medium")?"var(--orange)":"var(--green)"}function YA(){const[t,n]=m.useState([]),[a,s]=m.useState(null),[o,c]=m.useState(!0),[u,h]=m.useState([]),[f,p]=m.useState(!0),[x,j]=m.useState(null),[y,S]=m.useState("info"),[w,b]=m.useState([]),[_,E]=m.useState([]),[z,N]=m.useState([]),[O,Q]=m.useState([]),[U,L]=m.useState(!1),[H,A]=m.useState(!1),[R,G]=m.useState(!1),[F,q]=m.useState(null),[ee,me]=m.useState(!1),[W,J]=m.useState(null),[M,V]=m.useState({}),[ne,P]=m.useState([]),[T,C]=m.useState(null),[k,I]=m.useState("data"),[D,de]=m.useState(!1),[he,ie]=m.useState(null),[ve,je]=m.useState(!1),[fe,_e]=m.useState(!1),[Se,Ve]=m.useState(null),[be,oe]=m.useState(new Set),[Ue,Qe]=m.useState(!1),[lt,tt]=m.useState([]),ht=m.useMemo(()=>Tl(lt),[lt]),xt=m.useMemo(()=>{const xe=[{key:"id",header:"ID"},{key:"name",header:"Nazwa"},{key:"asset_category_name",header:"Kategoria",format:Ie=>Ie.asset_category_name??Ie.asset_type_name??""},{key:"org_unit_name",header:"Jednostka org.",format:Ie=>Ie.org_unit_name??""},{key:"owner",header:"Wlasciciel",format:Ie=>Ie.owner??""},{key:"criticality_name",header:"Krytycznosc",format:Ie=>Ie.criticality_name??""},{key:"risk_count",header:"Ryzyka",format:Ie=>String(Ie.risk_count)},{key:"sensitivity_name",header:"Wrazliwosc",format:Ie=>Ie.sensitivity_name??"",defaultVisible:!1},{key:"location",header:"Lokalizacja",format:Ie=>Ie.location??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:Ie=>Ie.created_at?.slice(0,10)??"",defaultVisible:!1}];for(const Ie of w.filter(mt=>mt.show_in_list))xe.push({key:`ca_${Ie.field_key}`,header:Ie.label,format:mt=>{const Oe=mt.custom_attributes?.[Ie.field_key];return Oe==null?"":Array.isArray(Oe)?Oe.join(", "):String(Oe)}});return xe},[w]),{visible:qe,toggle:Nt}=da(xt,"assets-cmdb"),st=Aa({data:u,storageKey:"assets-cmdb",defaultSort:"name"});m.useEffect(()=>{c(!0),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{}).finally(()=>c(!1)),le.get("/api/v1/org-units/tree").then(tt).catch(()=>{}),le.get("/api/v1/asset-categories/relationship-types/all").then(Q).catch(()=>{})},[]);const _t=m.useCallback(()=>{p(!0);const xe=a?`?asset_category_id=${a.id}`:"";le.get(`/api/v1/assets${xe}`).then(Ie=>{h(Ie),x&&!Ie.find(mt=>mt.id===x.id)&&j(null)}).catch(()=>{}).finally(()=>p(!1))},[a?.id]);m.useEffect(()=>{_t()},[_t]),m.useEffect(()=>{a&&!a.is_abstract?le.get(`/api/v1/asset-categories/${a.id}/fields`).then(b).catch(()=>b([])):b([])},[a?.id]),m.useEffect(()=>{x?(S("info"),le.get(`/api/v1/assets/${x.id}/relationships`).then(E).catch(()=>E([])),le.get(`/api/v1/audit?entity_type=Asset&entity_id=${x.id}&per_page=50`).then(xe=>N(xe.items)).catch(()=>N([]))):(E([]),N([]))},[x?.id]);const zt=xe=>{s(xe),j(null)},It=async()=>{if(W)return W;const[xe,Ie]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),mt=async za=>{try{return(await le.get(`/api/v1/dictionaries/${za}/entries`)).entries.filter(Et=>Et.is_active).map(Et=>({id:Et.id,label:Et.label}))}catch{return[]}},[Oe,ct]=await Promise.all([mt("sensitivity"),mt("criticality")]),At={orgUnits:xe,assets:Ie,sensitivities:Oe,criticalities:ct};return J(At),At},va=async()=>{await It(),q(null);const xe=a&&!a.is_abstract?a.id:null;if(C(xe),V({}),xe){const Ie=await le.get(`/api/v1/asset-categories/${xe}/fields`).catch(()=>[]);P(Ie)}else P([]);G(!0)},rt=async xe=>{if(await It(),q(xe),I("data"),C(xe.asset_category_id),V(xe.custom_attributes||{}),xe.asset_category_id){const Ie=await le.get(`/api/v1/asset-categories/${xe.asset_category_id}/fields`).catch(()=>[]);P(Ie)}else P([]);G(!0)},oa=async xe=>{if(C(xe),xe){const Ie=await le.get(`/api/v1/asset-categories/${xe}/fields`).catch(()=>[]);P(Ie)}else P([])},ca=async xe=>{xe.preventDefault(),me(!0);const Ie=new FormData(xe.currentTarget),mt={name:Ie.get("name"),org_unit_id:Ie.get("org_unit_id")?Number(Ie.get("org_unit_id")):null,parent_id:Ie.get("parent_id")?Number(Ie.get("parent_id")):null,owner:Ie.get("owner")||null,description:Ie.get("description")||null,location:Ie.get("location")||null,sensitivity_id:Ie.get("sensitivity_id")?Number(Ie.get("sensitivity_id")):null,criticality_id:Ie.get("criticality_id")?Number(Ie.get("criticality_id")):null,asset_category_id:T,custom_attributes:Object.keys(M).length>0?M:null};try{if(F){const Oe=await le.put(`/api/v1/assets/${F.id}`,mt);j(Oe)}else await le.post("/api/v1/assets",mt);G(!1),q(null),J(null),_t(),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{})}catch(Oe){alert("Blad zapisu: "+Oe)}finally{me(!1)}},ze=async xe=>{if(confirm(`Archiwizowac aktyw "${xe.name}"?`))try{await le.delete(`/api/v1/assets/${xe.id}`),j(null),_t(),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{})}catch(Ie){alert("Blad: "+Ie)}},et=xe=>{ie(xe),de(!0)},it=async xe=>{if(xe.preventDefault(),!x)return;A(!0);const Ie=new FormData(xe.currentTarget),mt={source_asset_id:x.id,target_asset_id:Number(Ie.get("target_asset_id")),relationship_type:Ie.get("relationship_type"),description:Ie.get("rel_description")||null};try{await le.post("/api/v1/assets/relationships",mt),L(!1);const Oe=await le.get(`/api/v1/assets/${x.id}/relationships`);E(Oe)}catch(Oe){alert("Blad dodawania relacji: "+Oe)}finally{A(!1)}},Be=async xe=>{if(!(!x||!confirm("Usunac te relacje?")))try{await le.delete(`/api/v1/assets/relationships/${xe}`),E(Ie=>Ie.filter(mt=>mt.id!==xe))}catch(Ie){alert("Blad usuwania relacji: "+Ie)}},at=async xe=>{xe.preventDefault();const mt=new FormData(xe.currentTarget).get("csv_file");if(!mt||mt.size===0)return;_e(!0),Ve(null);const Oe=new FormData;Oe.append("file",mt);const ct=a&&!a.is_abstract?a.id:null,At=`/api/v1/assets/import/csv${ct?`?asset_category_id=${ct}`:""}`;try{const za=await le.postFormData(At,Oe);Ve(za),_t(),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{})}catch(za){alert("Blad importu: "+za)}finally{_e(!1)}},nt=xe=>{oe(Ie=>{const mt=new Set(Ie);return mt.has(xe)?mt.delete(xe):mt.add(xe),mt})},ut=async()=>{if(!(be.size===0||!confirm(`Archiwizowac ${be.size} aktywow?`)))try{await le.post("/api/v1/assets/bulk/archive",{asset_ids:[...be]}),oe(new Set),j(null),_t(),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{})}catch(xe){alert("Blad: "+xe)}},ta=async xe=>{if(be.size!==0)try{await le.post("/api/v1/assets/bulk/assign-category",{asset_ids:[...be],asset_category_id:xe}),oe(new Set),_t(),le.get("/api/v1/asset-categories/tree").then(n).catch(()=>{})}catch(Ie){alert("Blad: "+Ie)}},Pt=m.useMemo(()=>{const xe=[],Ie=(mt,Oe)=>{for(const ct of mt)xe.push({cat:ct,depth:Oe}),Ie(ct.children,Oe+1)};return Ie(t,0),xe},[t]),Tt=m.useMemo(()=>Pt.filter(xe=>!xe.cat.is_abstract),[Pt]);return e.jsxs("div",{style:{display:"flex",height:"calc(100vh - 56px)",overflow:"hidden"},children:[e.jsx(vb,{tree:t,selectedId:a?.id??null,onSelect:zt,loading:o}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"0 16px 16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 0 8px"},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a?a.name_plural||a.name:"Wszystkie Aktywa"}),a&&e.jsx("span",{className:"score-badge",style:{background:(a.color||"var(--blue)")+"20",color:a.color||"var(--blue)",fontSize:11},children:a.is_abstract?"Grupa":"Kategoria"})]}),e.jsx(Ia,{cards:[{label:"Aktywow",value:st.filtered.filter(xe=>xe.is_active).length,total:u.filter(xe=>xe.is_active).length,color:"var(--blue)"},{label:"Z ryzykami",value:st.filtered.filter(xe=>xe.risk_count>0).length,total:u.filter(xe=>xe.risk_count>0).length,color:"var(--orange)"},{label:"Krytycznych",value:st.filtered.filter(xe=>xe.criticality_name?.toLowerCase().includes("wysok")||xe.criticality_name?.toLowerCase().includes("krytycz")).length,color:"var(--red)"},{label:"Jednostek org.",value:new Set(st.filtered.filter(xe=>xe.org_unit_id).map(xe=>xe.org_unit_id)).size,color:"var(--cyan)"}],isFiltered:st.filteredCount!==st.totalCount}),e.jsx(ma,{filteredCount:st.filteredCount,totalCount:st.totalCount,unitLabel:"aktywow",search:st.search,onSearchChange:st.setSearch,searchPlaceholder:"Szukaj aktywow...",showFilters:Ue,onToggleFilters:()=>Qe(xe=>!xe),hasActiveFilters:st.hasActiveFilters,onClearFilters:st.clearAllFilters,columns:xt,visibleColumns:qe,onToggleColumn:Nt,data:st.filtered,exportFilename:"aktywa-cmdb",primaryLabel:"Dodaj aktyw",onPrimaryAction:va,secondaryActions:[{label:"Import CSV",onClick:()=>{je(!0),Ve(null)}}]}),be.size>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",marginBottom:8,background:"var(--blue-dim)",borderRadius:8,fontSize:12},children:[e.jsxs("span",{style:{fontWeight:600,color:"var(--blue)"},children:["Zaznaczono: ",be.size]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:()=>oe(new Set),children:"Odznacz"}),e.jsx("div",{style:{flex:1}}),e.jsxs("select",{className:"form-control",style:{width:"auto",fontSize:11,padding:"3px 8px"},value:"",onChange:xe=>{xe.target.value&&ta(Number(xe.target.value))},children:[e.jsx("option",{value:"",children:"Przypisz kategorie..."}),Tt.map(({cat:xe,depth:Ie})=>e.jsxs("option",{value:xe.id,children:["".repeat(Ie),xe.name]},xe.id))]}),e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:"var(--red)"},onClick:ut,children:["Archiwizuj (",be.size,")"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:x?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:xt,visibleColumns:qe,data:st.pageData,rowKey:xe=>xe.id,selectedKey:x?.id??null,onRowClick:xe=>j(x?.id===xe.id?null:xe),sortField:st.sortField,sortDir:st.sortDir,onSort:st.toggleSort,columnFilters:st.columnFilters,onColumnFilter:st.setColumnFilter,showFilters:Ue,page:st.page,totalPages:st.totalPages,pageSize:st.pageSize,totalItems:st.totalCount,filteredItems:st.filteredCount,onPageChange:st.setPage,onPageSizeChange:st.setPageSize,loading:f,emptyMessage:"Brak aktywow w tej kategorii.",emptyFilteredMessage:"Brak aktywow pasujacych do filtrow.",renderCell:(xe,Ie)=>{if(Ie==="id")return e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("input",{type:"checkbox",checked:be.has(xe.id),onChange:mt=>{mt.stopPropagation(),nt(xe.id)},onClick:mt=>mt.stopPropagation(),style:{width:14,height:14,cursor:"pointer"}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:xe.ref_id||xe.id})]});if(Ie==="name")return e.jsx("span",{style:{fontWeight:500},children:xe.name});if(Ie==="asset_category_name"){const mt=xe.asset_category_name||xe.asset_type_name,Oe=xe.asset_category_color||"var(--purple)";return mt?e.jsx("span",{className:"score-badge",style:{background:Oe+"20",color:Oe},children:mt}):""}if(Ie==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:(xe.org_unit_id?ht.get(xe.org_unit_id):null)??xe.org_unit_name??""});if(Ie==="criticality_name")return xe.criticality_name?e.jsx("span",{className:"score-badge",style:{background:Vd(xe.criticality_name)==="var(--red)"?"var(--red-dim)":Vd(xe.criticality_name)==="var(--orange)"?"var(--orange-dim)":"var(--green-dim)",color:Vd(xe.criticality_name)},children:xe.criticality_name}):"";if(typeof Ie=="string"&&Ie.startsWith("ca_")){const mt=Ie.slice(3),Oe=xe.custom_attributes?.[mt];return Oe==null?"":Array.isArray(Oe)?e.jsx("span",{children:Oe.join(", ")}):e.jsx("span",{children:String(Oe)})}}}),x&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly aktywa"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",title:"Graf relacji",onClick:()=>et(x),style:{fontSize:14,padding:"4px 8px"},children:""}),e.jsx("button",{className:"btn btn-sm",onClick:()=>j(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--text-primary)"},children:x.name}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:6,marginTop:6},children:[x.asset_category_name&&e.jsx("span",{className:"score-badge",style:{background:(x.asset_category_color||"var(--purple)")+"20",color:x.asset_category_color||"var(--purple)",fontSize:11},children:x.asset_category_name}),x.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:x.ref_id})]})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"info",label:"Informacje"},{key:"custom",label:"Atrybuty"},{key:"relations",label:`Relacje (${_.length})`},{key:"risks",label:`Ryzyka (${x.risk_count})`},{key:"history",label:"Historia"}].map(xe=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"5px 4px",background:y===xe.key?"var(--blue-dim)":"transparent",borderBottom:y===xe.key?"2px solid var(--blue)":"2px solid var(--border)",color:y===xe.key?"var(--blue)":"var(--text-muted)",fontWeight:y===xe.key?600:400,fontSize:11,cursor:"pointer",transition:"all 0.2s"},onClick:()=>S(xe.key),children:xe.label},xe.key))}),y==="info"&&e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[[["Kategoria",x.asset_category_name??x.category_name??""],["Jednostka org.",(x.org_unit_id?ht.get(x.org_unit_id):null)??x.org_unit_name??""],["Wlasciciel",x.owner??""],["Lokalizacja",x.location??""],["Wrazliwosc",x.sensitivity_name??""],["Krytycznosc",x.criticality_name??""],["Nadrzedny aktyw",x.parent_name??""],["Utworzono",x.created_at?.slice(0,10)],["Zaktualizowano",x.updated_at?.slice(0,10)]].map(([xe,Ie])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:xe}),e.jsx("span",{style:xe==="Krytycznosc"?{fontWeight:500,color:Vd(x.criticality_name)}:{},children:Ie})]},xe)),x.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:x.description})]})]}),y==="custom"&&e.jsx(JA,{assetCategoryId:x.asset_category_id,customAttributes:x.custom_attributes||{}}),y==="relations"&&e.jsxs("div",{children:[_.length===0&&!U?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych relacji."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:_.map(xe=>{const Ie=xe.source_asset_id===x.id,mt=O.find(ct=>ct.code===xe.relationship_type),Oe=mt?.color||"var(--text-muted)";return e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[e.jsx("span",{className:"score-badge",style:{background:Oe+"20",color:Oe,fontSize:10},children:Ie?mt?.name||xe.relationship_type:mt?.name_reverse||xe.relationship_type}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:Ie?"":""}),e.jsx("button",{onClick:()=>Be(xe.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--red)",fontSize:12,padding:"0 2px",opacity:.5},title:"Usun relacje",children:""})]})]}),e.jsx("div",{style:{fontWeight:500},children:Ie?xe.target_asset_name:xe.source_asset_name}),xe.description&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:xe.description})]},xe.id)})}),U?e.jsxs("form",{onSubmit:it,style:{marginTop:10,padding:10,borderRadius:6,border:"1px solid var(--border)",background:"var(--bg-inset)"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:8,color:"var(--text-primary)"},children:"Nowa relacja"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("select",{name:"relationship_type",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Typ relacji..."}),O.map(xe=>e.jsx("option",{value:xe.code,children:xe.name},xe.code))]}),e.jsxs("select",{name:"target_asset_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Docelowy aktyw..."}),u.filter(xe=>xe.id!==x.id).map(xe=>e.jsxs("option",{value:xe.id,children:[xe.name,xe.asset_category_name?` (${xe.asset_category_name})`:""]},xe.id))]}),e.jsx("input",{name:"rel_description",className:"form-control",placeholder:"Opis (opcjonalnie)",style:{fontSize:12}}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:H,style:{flex:1},children:H?"Dodawanie...":"Dodaj"}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>L(!1),children:"Anuluj"})]})]})]}):e.jsx("button",{className:"btn btn-sm btn-primary",style:{marginTop:10,width:"100%"},onClick:()=>L(!0),children:"+ Dodaj relacje"}),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,width:"100%"},onClick:()=>et(x),children:"Pokaz graf relacji"})]}),y==="risks"&&e.jsx(zv,{asset:x,orgTree:lt,onRiskCountChange:xe=>{j(Ie=>Ie&&{...Ie,risk_count:xe})}}),y==="history"&&e.jsx("div",{children:z.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak historii zmian."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:z.map(xe=>e.jsxs("div",{style:{padding:"6px 8px",borderRadius:4,fontSize:11,background:"var(--bg-inset)",borderLeft:"2px solid var(--blue)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontWeight:500},children:xe.action}),e.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:xe.created_at?.slice(0,16).replace("T"," ")})]}),xe.field_name&&e.jsxs("div",{style:{color:"var(--text-muted)"},children:[xe.field_name,": ",xe.old_value??"","  ",xe.new_value??""]})]},xe.id))})}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>rt(x),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},title:"Graf relacji",onClick:()=>et(x),children:"Graf"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ze(x),children:"Archiwizuj"})]})]})]})]}),e.jsx(gt,{open:R,onClose:()=>{G(!1),q(null)},title:F?`Edytuj aktyw: ${F.name}`:"Dodaj aktyw",wide:!0,children:W?e.jsxs("div",{children:[F&&e.jsx("div",{style:{display:"flex",gap:0,marginBottom:16,borderBottom:"2px solid var(--border)"},children:[{key:"data",label:"Dane aktywa"},{key:"risks",label:"Ryzyka"}].map(xe=>e.jsx("div",{style:{padding:"8px 20px",cursor:"pointer",fontSize:13,fontWeight:k===xe.key?600:400,color:k===xe.key?"var(--blue)":"var(--text-muted)",borderBottom:k===xe.key?"2px solid var(--blue)":"2px solid transparent",marginBottom:-2,transition:"all 0.2s"},onClick:()=>I(xe.key),children:xe.label},xe.key))}),(k==="data"||!F)&&e.jsxs("form",{onSubmit:ca,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:F?.name??"",placeholder:"np. Serwer bazodanowy DB-01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria CMDB"}),e.jsxs("select",{className:"form-control",value:T??"",onChange:xe=>oa(xe.target.value?Number(xe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz kategorie..."}),Pt.map(({cat:xe,depth:Ie})=>e.jsxs("option",{value:xe.id,disabled:xe.is_abstract,children:[Ie>0?"".repeat(Ie):"",xe.is_abstract?` ${xe.name}`:`${qA(xe.icon)} ${xe.name}`]},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:W.orgUnits,value:F?.org_unit_id??null,onChange:xe=>{const Ie=document.querySelector('input[name="org_unit_id"]');Ie&&(Ie.value=xe?String(xe):"")},placeholder:"Wybierz...",allowClear:!0}),e.jsx("input",{type:"hidden",name:"org_unit_id",defaultValue:F?.org_unit_id??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nadrzedny aktyw"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:F?.parent_id??"",children:[e.jsx("option",{value:"",children:"Brak (glowny)"}),W.assets.filter(xe=>!F||xe.id!==F.id).map(xe=>e.jsx("option",{value:xe.id,children:xe.name},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:F?.owner??"",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{name:"location",className:"form-control",defaultValue:F?.location??"",placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wrazliwosc"}),e.jsxs("select",{name:"sensitivity_id",className:"form-control",defaultValue:F?.sensitivity_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),W.sensitivities.map(xe=>e.jsx("option",{value:xe.id,children:xe.label},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{name:"criticality_id",className:"form-control",defaultValue:F?.criticality_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),W.criticalities.map(xe=>e.jsx("option",{value:xe.id,children:xe.label},xe.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:F?.description??""})]})]}),ne.length>0&&e.jsxs("div",{style:{marginTop:16,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"var(--text-primary)"},children:"Atrybuty kategorii"}),e.jsx(_b,{fields:ne,values:M,onChange:(xe,Ie)=>V(mt=>({...mt,[xe]:Ie}))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{G(!1),q(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:ee,children:ee?"Zapisywanie...":F?"Zapisz zmiany":"Dodaj aktyw"})]})]}),F&&k==="risks"&&e.jsx(zv,{asset:F,orgTree:lt,onRiskCountChange:xe=>{j(Ie=>Ie&&Ie.id===F.id?{...Ie,risk_count:xe}:Ie)}})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})}),e.jsx(gt,{open:D,onClose:()=>{de(!1),ie(null)},title:he?`Graf relacji: ${he.name}`:"Graf relacji",wide:!0,children:he&&e.jsx(XA,{assetId:he.id,assetName:he.name})}),e.jsx(gt,{open:ve,onClose:()=>{je(!1),Ve(null)},title:"Import aktywow z CSV",children:Se?e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",padding:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,color:"var(--green)",marginBottom:8},children:Se.created}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:12},children:"aktywow zaimportowano pomyslnie"})]}),Se.total_errors>0&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--red)",marginBottom:6},children:["Bledy (",Se.total_errors,"):"]}),e.jsxs("div",{style:{maxHeight:150,overflowY:"auto",fontSize:11,color:"var(--text-muted)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:[Se.errors.map((xe,Ie)=>e.jsx("div",{children:xe},Ie)),Se.total_errors>Se.errors.length&&e.jsxs("div",{style:{fontStyle:"italic"},children:["...i ",Se.total_errors-Se.errors.length," wiecej"]})]})]}),e.jsx("button",{className:"btn btn-primary",style:{width:"100%"},onClick:()=>{je(!1),Ve(null)},children:"Zamknij"})]}):e.jsxs("form",{onSubmit:at,children:[e.jsxs("div",{style:{fontSize:13,color:"var(--text-muted)",marginBottom:16},children:["Zaladuj plik CSV z aktywami. Wymagana kolumna: ",e.jsx("code",{children:"name"}),". Opcjonalne: ",e.jsx("code",{children:"owner"}),", ",e.jsx("code",{children:"description"}),", ",e.jsx("code",{children:"location"}),". Pozostale kolumny beda zapisane jako atrybuty niestandardowe.",e.jsx("br",{}),e.jsx("br",{}),"Separator: ",e.jsx("code",{children:";"})," (srednik) lub ",e.jsx("code",{children:","})," (przecinek).",a&&!a.is_abstract&&e.jsxs("div",{style:{marginTop:8,padding:"6px 10px",background:"var(--blue-dim)",borderRadius:6,color:"var(--blue)",fontSize:12},children:["Importowane aktywa zostana przypisane do kategorii: ",e.jsx("strong",{children:a.name})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Plik CSV"}),e.jsx("input",{name:"csv_file",type:"file",accept:".csv",required:!0,className:"form-control",style:{padding:8}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>je(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:fe,children:fe?"Importowanie...":"Importuj"})]})]})})]})}function JA({assetCategoryId:t,customAttributes:n}){const[a,s]=m.useState([]);return m.useEffect(()=>{t?le.get(`/api/v1/asset-categories/${t}/fields`).then(s).catch(()=>s([])):s([])},[t]),t?a.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych atrybutow."}):e.jsx(_b,{fields:a,values:n,onChange:()=>{},readOnly:!0}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Aktyw nie ma przypisanej kategorii CMDB."})}function zv({asset:t,orgTree:n,onRiskCountChange:a}){const[s,o]=m.useState([]),[c,u]=m.useState(!0),[h,f]=m.useState("list"),[p,x]=m.useState(null),[j,y]=m.useState([]),[S,w]=m.useState(""),[b,_]=m.useState(""),[E,z]=m.useState(!1),[N,O]=m.useState(!1),[Q,U]=m.useState([]),[L,H]=m.useState([]),[A,R]=m.useState([]),[G,F]=m.useState([]),[q,ee]=m.useState(2),[me,W]=m.useState(2),[J,M]=m.useState(.25),[V,ne]=m.useState([]),[P,T]=m.useState([]),[C,k]=m.useState([]),[I,D]=m.useState(null),[de,he]=m.useState(""),[ie,ve]=m.useState([]),[je,fe]=m.useState(!1),[_e,Se]=m.useState([]),[Ve,be]=m.useState(!1),[oe,Ue]=m.useState(!1),Qe=m.useRef(a);Qe.current=a;const lt=m.useCallback(()=>{u(!0),le.get("/api/v1/risks?include_archived=false").then(ze=>{const et=ze.filter(it=>it.asset_id===t.id);o(et),Qe.current(et.length)}).catch(()=>o([])).finally(()=>u(!1))},[t.id]);m.useEffect(()=>{lt()},[lt]);const tt=m.useCallback(()=>{j.length>0||(z(!0),le.get("/api/v1/risks?include_archived=false").then(y).catch(()=>{}).finally(()=>z(!1)))},[j.length]),ht=m.useMemo(()=>{const ze=new Set(s.map(it=>it.id));let et=j.filter(it=>!ze.has(it.id));if(S){const it=S.toLowerCase();et=et.filter(Be=>Be.asset_name.toLowerCase().includes(it)||Be.code?.toLowerCase().includes(it)||Be.owner?.toLowerCase().includes(it)||Be.security_area_name?.toLowerCase().includes(it))}return b&&(et=et.filter(it=>it.risk_level===b)),et.slice(0,20)},[j,s,S,b]),xt=async ze=>{try{await le.put(`/api/v1/risks/${ze.id}`,{asset_id:t.id,asset_name:t.name}),f("list"),w(""),_(""),lt(),y([])}catch(et){alert("Blad linkowania: "+et)}},qe=async ze=>{if(confirm(`Odlacz ryzyko R-${ze.id} od tego aktywa?`))try{await le.put(`/api/v1/risks/${ze.id}`,{asset_id:null}),lt(),y([])}catch(et){alert("Blad: "+et)}},Nt=async ze=>{ze.preventDefault(),O(!0);const et=new FormData(ze.currentTarget),it={org_unit_id:t.org_unit_id||Number(et.get("org_unit_id"))||null,asset_id:t.id,asset_name:t.name,security_area_id:Number(et.get("security_area_id")),impact_level:q,probability_level:me,safeguard_rating:J,consequence_description:et.get("consequence_description")||null,existing_controls:et.get("existing_controls")||null,owner:et.get("owner")||t.owner||null,threat_ids:V,vulnerability_ids:P,safeguard_ids:C};try{const Be=await le.post("/api/v1/risks",it);D(Be.id),f("link_action"),lt(),y([])}catch(Be){alert("Blad tworzenia ryzyka: "+Be)}finally{O(!1)}};m.useEffect(()=>{if(h!=="link_action"||de.length<2){ve([]);return}const ze=setTimeout(()=>{fe(!0),le.get("/api/v1/actions").then(et=>{const it=de.toLowerCase();ve((et??[]).filter(Be=>Be.title.toLowerCase().includes(it)||(Be.owner??"").toLowerCase().includes(it)).slice(0,8))}).catch(()=>{}).finally(()=>fe(!1))},300);return()=>clearTimeout(ze)},[de,h]);const st=async ze=>{if(I)try{const it=((await le.get(`/api/v1/actions/${ze.id}`)).links??[]).map(Be=>({entity_type:Be.entity_type,entity_id:Be.entity_id}));it.push({entity_type:"risk",entity_id:I}),await le.put(`/api/v1/actions/${ze.id}`,{links:it}),Se(Be=>[...Be,ze.id]),he(""),ve([])}catch(et){alert("Blad: "+et)}},_t=async ze=>{if(ze.preventDefault(),!I)return;Ue(!0);const et=new FormData(ze.currentTarget);try{const it=await le.post("/api/v1/actions",{title:et.get("title"),description:et.get("description")||null,owner:et.get("action_owner")||null,due_date:et.get("due_date")||null,org_unit_id:t.org_unit_id||null,links:[{entity_type:"risk",entity_id:I}]});Se(Be=>[...Be,it.id]),be(!1)}catch(it){alert("Blad: "+it)}finally{Ue(!1)}},zt=ze=>ze==="high"?"var(--red)":ze==="medium"?"var(--orange)":"var(--green)",It=ze=>ze==="high"?"var(--red-dim, rgba(239,68,68,0.15))":ze==="medium"?"var(--orange-dim, rgba(249,115,22,0.15))":"var(--green-dim, rgba(34,197,94,0.15))",va=async()=>{if(f("create"),ee(2),W(2),M(.25),ne([]),T([]),k([]),D(null),Se([]),be(!1),Q.length===0)try{const ze=await le.get("/api/v1/security-areas");U(ze)}catch{}L.length===0&&le.get("/api/v1/threat-catalog").then(H).catch(()=>{}),A.length===0&&le.get("/api/v1/weakness-catalog").then(R).catch(()=>{}),G.length===0&&le.get("/api/v1/control-catalog").then(F).catch(()=>{})},rt=(ze,et,it)=>Math.exp(ze)*et/it,oa=ze=>ze>=221?"var(--red)":ze>=31?"var(--orange)":"var(--green)",ca=ze=>ze>=221?"var(--red-dim, rgba(239,68,68,0.15))":ze>=31?"var(--orange-dim, rgba(249,115,22,0.15))":"var(--green-dim, rgba(34,197,94,0.15))";if(c)return e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie ryzyk..."});if(p){const ze=p,et=ze.risk_level==="high"?"WYSOKI":ze.risk_level==="medium"?"SREDNI":"NISKI",it=[["Kod",ze.code],["Domena bezp.",ze.security_area_name],["Kategoria ryzyka",ze.risk_category_name],["Jednostka org.",ze.org_unit_name],["Wlasciciel",ze.owner],["Status",ze.status_name],["Strategia",ze.strategy_name],["Wplyw (W)",String(ze.impact_level)],["Prawdopodobienstwo (P)",String(ze.probability_level)],["Zabezpieczenia (Z)",String(ze.safeguard_rating)],["Wynik ryzyka",ze.risk_score?.toFixed(1)],["Poziom ryzyka",et],["Wrazliwosc aktywa",ze.sensitivity_name],["Krytycznosc aktywa",ze.criticality_name],["Termin postepowania",ze.treatment_deadline?.slice(0,10)],["Ryzyko rezydualne",ze.residual_risk!=null?String(ze.residual_risk):null],["Zaakceptowane przez",ze.accepted_by],["Data akceptacji",ze.accepted_at?.slice(0,10)],["Zidentyfikowano",ze.identified_at?.slice(0,10)],["Nastepny przeglad",ze.next_review_date?.slice(0,10)]];return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>x(null),children:" Wstecz do listy"})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsxs("span",{className:"score-badge",style:{marginLeft:8,background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:11},children:[et," ",ze.risk_score?.toFixed(0)]})]}),e.jsx("div",{style:{fontSize:12,lineHeight:2},children:it.map(([Be,at])=>at?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(42,53,84,0.08)"},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:11},children:Be}),e.jsx("span",{style:{fontWeight:500,fontSize:11,textAlign:"right",maxWidth:"60%"},children:at})]},Be):null)}),ze.consequence_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Opis konsekwencji"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.consequence_description})]}),ze.existing_controls&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Istniejace zabezpieczenia"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.existing_controls})]}),ze.planned_actions&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Planowane dzialania"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.planned_actions})]}),ze.acceptance_justification&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Uzasadnienie akceptacji"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.acceptance_justification})]}),ze.threats.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Zagrozenia (",ze.threats.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.threats.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--red-dim, rgba(239,68,68,0.1))",color:"var(--red)"},children:Be.threat_name},Be.threat_id))})]}),ze.vulnerabilities.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Podatnosci (",ze.vulnerabilities.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.vulnerabilities.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--orange-dim, rgba(249,115,22,0.1))",color:"var(--orange)"},children:Be.vulnerability_name},Be.vulnerability_id))})]}),ze.safeguards.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Zabezpieczenia (",ze.safeguards.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.safeguards.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--green-dim, rgba(34,197,94,0.1))",color:"var(--green)"},children:Be.safeguard_name},Be.safeguard_id))})]}),e.jsx("div",{style:{display:"flex",gap:6,marginTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{x(null),qe(ze)},children:"Odlacz ryzyko"})})]})}return e.jsxs("div",{children:[h==="list"&&e.jsxs(e.Fragment,{children:[s.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak powiazanych ryzyk dla tego aktywa."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginBottom:10},children:s.map(ze=>e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,cursor:"pointer",background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12,transition:"border-color 0.2s"},onClick:()=>x(ze),onMouseEnter:et=>et.currentTarget.style.borderColor="var(--blue)",onMouseLeave:et=>et.currentTarget.style.borderColor="var(--border)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsx("span",{className:"score-badge",style:{background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:10},children:ze.risk_level==="high"?"WYSOKI":ze.risk_level==="medium"?"SREDNI":"NISKI"}),e.jsx("span",{style:{fontWeight:600,fontSize:11,color:zt(ze.risk_level)},children:ze.risk_score?.toFixed(0)})]}),e.jsx("button",{onClick:et=>{et.stopPropagation(),qe(ze)},style:{background:"none",border:"none",cursor:"pointer",color:"var(--red)",fontSize:12,padding:"0 2px",opacity:.5},title:"Odlacz ryzyko",children:""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:ze.security_area_name}),ze.status_name&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)"},children:["Status: ",ze.status_name]})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:10,color:"var(--text-muted)"},children:[ze.owner&&e.jsx("div",{children:ze.owner}),e.jsxs("div",{children:["W=",ze.impact_level," P=",ze.probability_level]})]})]}),ze.consequence_description&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4,fontStyle:"italic"},children:ze.consequence_description.length>80?ze.consequence_description.slice(0,80)+"...":ze.consequence_description})]},ze.id))}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>{f("search"),tt()},children:"Polacz istniejace ryzyko"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:va,children:"+ Nowe ryzyko"})]})]}),h==="search"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600},children:"Wyszukaj ryzyko do polaczenia"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>{f("list"),w(""),_("")},children:"Wstecz"})]}),e.jsxs("div",{style:{display:"flex",gap:6,marginBottom:10},children:[e.jsx("input",{className:"form-control",placeholder:"Szukaj po nazwie, kodzie, wlascicielu...",value:S,onChange:ze=>w(ze.target.value),style:{fontSize:12,flex:1},autoFocus:!0}),e.jsxs("select",{className:"form-control",value:b,onChange:ze=>_(ze.target.value),style:{fontSize:12,width:100},children:[e.jsx("option",{value:"",children:"Poziom"}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"medium",children:"Sredni"}),e.jsx("option",{value:"low",children:"Niski"})]})]}),E?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie ryzyk..."}):ht.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:S||b?"Brak ryzyk pasujacych do filtrow.":"Wpisz fraze aby wyszukac..."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,maxHeight:300,overflowY:"auto"},children:ht.map(ze=>e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,cursor:"pointer",background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12,transition:"border-color 0.2s"},onClick:()=>xt(ze),onMouseEnter:et=>et.currentTarget.style.borderColor="var(--blue)",onMouseLeave:et=>et.currentTarget.style.borderColor="var(--border)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsxs("span",{className:"score-badge",style:{background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:9},children:[ze.risk_level==="high"?"WYS":ze.risk_level==="medium"?"SRE":"NIS"," ",ze.risk_score?.toFixed(0)]})]}),e.jsx("span",{style:{fontSize:10,color:"var(--blue)"},children:"+ Polacz"})]}),e.jsx("div",{style:{fontWeight:500,fontSize:11,marginTop:2},children:ze.asset_name}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginTop:2},children:[e.jsx("span",{children:ze.security_area_name}),e.jsx("span",{children:ze.owner||"brak wlasciciela"})]}),ze.asset_id_name&&ze.asset_id!==t.id&&e.jsxs("div",{style:{fontSize:10,color:"var(--orange)",marginTop:2},children:["Aktualnie powiazane z: ",ze.asset_id_name]})]},ze.id))})]}),h==="create"&&(()=>{const ze=rt(q,me,J),et=oa(ze),it=ze>=221?"WYSOKI":ze>=31?"SREDNI":"NISKI";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600},children:["Nowe ryzyko dla: ",t.name]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>f("list"),children:"Wstecz"})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:22,fontWeight:700,color:et},children:ze.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${et}30`,color:et,fontSize:11,marginLeft:8},children:it})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:16,marginBottom:14},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:220},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(Be=>e.jsx("div",{style:{textAlign:"center",fontSize:9,color:"var(--text-muted)",padding:3},children:Be},Be)),[3,2,1].map(Be=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{style:{fontSize:9,color:"var(--text-muted)",padding:3,display:"flex",alignItems:"center"},children:["W=",Be]}),[1,2,3].map(at=>{const nt=rt(Be,at,J),ut=Be===q&&at===me;return e.jsx("div",{style:{textAlign:"center",padding:5,borderRadius:4,fontSize:9,fontFamily:"'JetBrains Mono',monospace",fontWeight:ut?700:400,background:ca(nt),color:oa(nt),border:ut?`2px solid ${oa(nt)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{ee(Be),W(at)},children:nt.toFixed(0)},`${Be}-${at}`)})]},`row-${Be}`))]}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",textAlign:"center",marginTop:3},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}].map(Be=>{const at=Math.abs(J-Be.value)<.01;return e.jsxs("div",{style:{padding:"4px 8px",borderRadius:5,fontSize:10,cursor:"pointer",display:"flex",alignItems:"center",gap:6,background:at?`${Be.color}18`:"transparent",border:at?`2px solid ${Be.color}`:"2px solid var(--border)",color:at?Be.color:"var(--text-muted)",fontWeight:at?600:400,transition:"all 0.15s"},onClick:()=>M(Be.value),children:[e.jsx("span",{style:{width:7,height:7,borderRadius:"50%",background:at?Be.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:28,fontSize:10},children:Be.value.toFixed(2)}),e.jsx("span",{style:{fontSize:10},children:Be.label})]},Be.value)})]})]}),e.jsx("form",{onSubmit:Nt,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Domena bezpieczenstwa *"}),e.jsxs("select",{name:"security_area_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Wybierz..."}),Q.map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),!t.org_unit_id&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Jednostka organizacyjna *"}),e.jsxs("select",{name:"org_unit_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Wybierz..."}),(()=>{const Be=[],at=(nt,ut)=>{for(const ta of nt)Be.push({id:ta.id,name:ta.name,depth:ut}),at(ta.children,ut+1)};return at(n,0),Be.map(nt=>e.jsxs("option",{value:nt.id,children:["".repeat(nt.depth),nt.name]},nt.id))})()]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Wlasciciel ryzyka"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:t.owner||"",style:{fontSize:12},placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Zagrozenia"}),V.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:V.map(Be=>{const at=L.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--red-dim, rgba(239,68,68,0.1))",color:"var(--red)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>ne(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!V.includes(at)&&ne(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj zagrozenie..."}),L.filter(Be=>!V.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Podatnosci"}),P.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:P.map(Be=>{const at=A.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--orange-dim, rgba(249,115,22,0.1))",color:"var(--orange)",border:"1px solid rgba(249,115,22,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>T(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!P.includes(at)&&T(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj podatnosc..."}),A.filter(Be=>!P.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Zabezpieczenia (katalog)"}),C.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:C.map(Be=>{const at=G.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--green-dim, rgba(34,197,94,0.1))",color:"var(--green)",border:"1px solid rgba(34,197,94,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>k(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!C.includes(at)&&k(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj zabezpieczenie..."}),G.filter(Be=>!C.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Opis konsekwencji"}),e.jsx("textarea",{name:"consequence_description",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Co moze sie stac w przypadku materializacji ryzyka?"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Istniejace zabezpieczenia (opis)"}),e.jsx("textarea",{name:"existing_controls",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Jakie zabezpieczenia juz istnieja?"})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",style:{flex:1},disabled:N,children:N?"Tworzenie...":"Utworz ryzyko i polacz"}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f("list"),children:"Anuluj"})]})]})})]})})(),h==="link_action"&&I&&e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:14},children:[e.jsx("div",{style:{fontSize:28,marginBottom:4},children:""}),e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--green)"},children:["Ryzyko R-",I," utworzone!"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:"Dodaj dzialanie mitygujace lub wroc do listy ryzyk."})]}),_e.length>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Powiazane dzialania (",_e.length,")"]}),_e.map(ze=>e.jsxs("div",{style:{padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:3,fontSize:11,display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{color:"var(--blue)"},children:["A-",ze]}),e.jsx("span",{style:{color:"var(--green)",fontSize:10},children:" powiazane"})]},ze))]}),!Ve&&e.jsx("div",{style:{marginBottom:10},children:e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj istniejacego dzialania po tytule...",value:de,onChange:ze=>he(ze.target.value)}),je&&e.jsx("span",{style:{position:"absolute",right:8,top:8,fontSize:10,color:"var(--text-muted)"},children:"..."}),ie.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:180,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:ie.map(ze=>e.jsxs("div",{style:{padding:"7px 10px",cursor:"pointer",fontSize:11,borderBottom:"1px solid var(--border)",opacity:_e.includes(ze.id)?.4:1},onClick:()=>!_e.includes(ze.id)&&st(ze),onMouseEnter:et=>et.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:et=>et.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500},children:ze.title}),e.jsxs("div",{style:{fontSize:9,color:"var(--text-muted)"},children:[ze.owner&&e.jsx("span",{children:ze.owner}),ze.status_name&&e.jsxs("span",{children:[" | ",ze.status_name]})]})]},ze.id))})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",style:{fontSize:11,whiteSpace:"nowrap"},onClick:()=>{be(!0),he(""),ve([])},children:"+ Nowe"})]})}),Ve&&e.jsxs("form",{onSubmit:_t,style:{background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:12,marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600,fontSize:12,color:"var(--blue)"},children:"Nowe dzialanie"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10},onClick:()=>be(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Tytul dzialania *"}),e.jsx("input",{name:"title",className:"form-control",required:!0,style:{fontSize:12},placeholder:"np. Wdrozenie MFA"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Wlasciciel"}),e.jsx("input",{name:"action_owner",className:"form-control",style:{fontSize:12},placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Termin"}),e.jsx("input",{type:"date",name:"due_date",className:"form-control",style:{fontSize:12}})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Opis dzialania..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:6,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>be(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:oe,children:oe?"Tworzenie...":"Utworz i powiaz"})]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{width:"100%",marginTop:6},onClick:()=>{f("list"),D(null)},children:"Zakoncz  wroc do listy ryzyk"})]})]})}function XA({assetId:t,assetName:n}){const[a,s]=m.useState([]),[o,c]=m.useState(!0);if(m.useEffect(()=>{c(!0),le.get(`/api/v1/assets/${t}/relationships`).then(s).catch(()=>s([])).finally(()=>c(!1))},[t]),o)return e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie grafu..."});if(a.length===0)return e.jsxs("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{children:"Ten aktyw nie ma zdefiniowanych relacji."})]});const u=new Map;for(const y of a){const S=y.source_asset_id===t,w=S?y.target_asset_id:y.source_asset_id,b=S?y.target_asset_name||`Asset #${w}`:y.source_asset_name||`Asset #${w}`;u.has(w)||u.set(w,{name:b,relations:[]}),u.get(w).relations.push({type:y.relationship_type,direction:S?"out":"in",description:y.description})}const h={depends_on:"#F59E0B",supports:"#3B82F6",connects_to:"#8B5CF6",contains:"#10B981",backup_of:"#06B6D4",replaces:"#EF4444",runs_on:"#F97316",managed_by:"#6366F1",used_by:"#EC4899",hosted_on:"#14B8A6"},f=[...u.entries()],p=300,x=200,j=150;return e.jsxs("div",{children:[e.jsxs("svg",{width:"100%",viewBox:"0 0 600 400",style:{background:"rgba(0,0,0,0.1)",borderRadius:8},children:[e.jsx("circle",{cx:p,cy:x,r:32,fill:"var(--blue)",opacity:.9}),e.jsx("text",{x:p,y:x+4,textAnchor:"middle",fill:"white",fontSize:11,fontWeight:600,children:n.length>12?n.slice(0,12)+"...":n}),f.map(([y,S],w)=>{const b=2*Math.PI*w/f.length-Math.PI/2,_=p+j*Math.cos(b),E=x+j*Math.sin(b),z=h[S.relations[0]?.type]||"#666";return e.jsxs("g",{children:[e.jsx("line",{x1:p,y1:x,x2:_,y2:E,stroke:z,strokeWidth:2,opacity:.6}),e.jsx("text",{x:(p+_)/2,y:(x+E)/2-6,textAnchor:"middle",fill:z,fontSize:9,fontWeight:500,children:S.relations[0]?.type}),S.relations[0]?.direction==="out"&&e.jsx("circle",{cx:_-(_-p)*.15,cy:E-(E-x)*.15,r:3,fill:z}),e.jsx("circle",{cx:_,cy:E,r:26,fill:"var(--bg-card)",stroke:z,strokeWidth:2}),e.jsx("text",{x:_,y:E+4,textAnchor:"middle",fill:"var(--text-primary)",fontSize:10,children:S.name.length>14?S.name.slice(0,14)+"...":S.name})]},y)})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:12,justifyContent:"center"},children:[...new Set(a.map(y=>y.relationship_type))].map(y=>e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:8,background:(h[y]||"#666")+"20",color:h[y]||"#666"},children:y},y))}),e.jsx("div",{style:{marginTop:16,maxHeight:200,overflowY:"auto"},children:a.map(y=>{const S=y.source_asset_id===t;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 10px",fontSize:12,borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",flexShrink:0,background:h[y.relationship_type]||"#666"}}),e.jsx("span",{style:{color:"var(--text-muted)",minWidth:80},children:y.relationship_type}),e.jsx("span",{children:S?"":""}),e.jsx("span",{style:{fontWeight:500},children:S?y.target_asset_name:y.source_asset_name})]},y.id)})})]})}const Dp={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function ap(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("krytycz")||n.includes("critical")?"var(--red)":n.includes("wysok")||n.includes("high")?"var(--orange)":n.includes("redni")||n.includes("medium")?"var(--blue)":"var(--green)"}function $o(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("zamkn")||n.includes("complet")||n.includes("wykonan")?"var(--green)":n.includes("w trakcie")||n.includes("progress")||n.includes("realizac")?"var(--blue)":n.includes("anulowa")||n.includes("cancel")?"var(--text-muted)":n.includes("przetermin")||n.includes("overdue")?"var(--red)":"var(--orange)"}function QA(t){return t?Math.ceil((new Date(t).getTime()-Date.now())/864e5):null}function fu(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function eE(t){return t<1024?`${t} B`:t<1048576?`${(t/1024).toFixed(1)} KB`:`${(t/1048576).toFixed(1)} MB`}const Sb={title:"Tytu",description:"Opis",org_unit_id:"Jednostka org.",owner:"Waciciel",responsible:"Odpowiedzialny",priority_id:"Priorytet",status_id:"Status",source_id:"rdo",due_date:"Termin realizacji",completed_at:"Zamknito",effectiveness_rating:"Ocena skutecznoci",effectiveness_notes:"Notatki skutecznoci",implementation_notes:"Notatki wdroenia"},pm=[{key:"id",header:"ID",format:t=>`D-${t.id}`},{key:"title",header:"Tytu"},{key:"org_unit_name",header:"Pion",format:t=>t.org_unit_name??""},{key:"priority_name",header:"Priorytet",format:t=>t.priority_name??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"due_date",header:"Termin",format:t=>t.due_date?.slice(0,10)??""},{key:"responsible",header:"Odpowiedzialny",format:t=>t.responsible??t.owner??""},{key:"links",header:"Powizania",format:t=>String(t.links?.length??0)},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1},{key:"owner",header:"Waciciel",format:t=>t.owner??"",defaultVisible:!1},{key:"source_name",header:"rdo",format:t=>t.source_name??"",defaultVisible:!1},{key:"completed_at",header:"Ukoczono",format:t=>t.completed_at?.slice(0,10)??"",defaultVisible:!1},{key:"effectiveness_rating",header:"Ocena skut.",format:t=>t.effectiveness_rating!=null?`${t.effectiveness_rating}/5`:"",defaultVisible:!1},{key:"is_overdue",header:"Przeterminowane",format:t=>t.is_overdue?"TAK":"NIE",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:t=>t.updated_at?.slice(0,10)??"",defaultVisible:!1}];function tE({data:t,color1:n,color2:a,label1:s,label2:o}){const c=Math.max(...t.map(u=>Math.max(u.v1,u.v2)),1);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:12,fontSize:10,color:"var(--text-muted)",marginBottom:6},children:[e.jsxs("span",{children:[e.jsx("span",{style:{display:"inline-block",width:8,height:8,borderRadius:2,background:n,marginRight:4}}),s]}),e.jsxs("span",{children:[e.jsx("span",{style:{display:"inline-block",width:8,height:8,borderRadius:2,background:a,marginRight:4}}),o]})]}),e.jsx("div",{style:{display:"flex",gap:2,alignItems:"flex-end",height:60},children:t.map((u,h)=>e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsxs("div",{style:{display:"flex",gap:1,alignItems:"flex-end",height:50},children:[e.jsx("div",{style:{width:6,height:Math.max(2,u.v1/c*50),background:n,borderRadius:1},title:`${s}: ${u.v1}`}),e.jsx("div",{style:{width:6,height:Math.max(2,u.v2/c*50),background:a,borderRadius:1},title:`${o}: ${u.v2}`})]}),e.jsx("div",{style:{fontSize:8,color:"var(--text-muted)",whiteSpace:"nowrap"},children:u.label.slice(5)})]},h))})]})}function aE({stats:t}){return t?e.jsxs("div",{className:"card",style:{marginBottom:16,padding:16},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:e.jsx("div",{className:"card-title",style:{margin:0,fontSize:13},children:"Dashboard KPI"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Podzia wg statusu"}),t.by_status.map((n,a)=>{const s=t.total>0?n.count/t.total*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx("span",{style:{fontSize:11,width:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.status_name}),e.jsx("div",{style:{flex:1,height:6,borderRadius:3,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s}%`,height:"100%",borderRadius:3,background:$o(n.status_name)}})}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace",width:24,textAlign:"right"},children:n.count})]},a)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Podzia wg priorytetu"}),t.by_priority.map((n,a)=>{const s=t.total>0?n.count/t.total*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx("span",{style:{fontSize:11,width:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n.priority_name}),e.jsx("div",{style:{flex:1,height:6,borderRadius:3,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s}%`,height:"100%",borderRadius:3,background:ap(n.priority_name)}})}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace",width:24,textAlign:"right"},children:n.count})]},a)}),t.avg_completion_days!=null&&e.jsxs("div",{style:{marginTop:8,fontSize:11,color:"var(--text-muted)"},children:["r. czas realizacji: ",e.jsxs("span",{style:{fontWeight:600,color:"var(--blue)",fontFamily:"'JetBrains Mono',monospace"},children:[t.avg_completion_days," dni"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Trend miesiczny (12 mies.)"}),e.jsx(tE,{data:t.monthly_trend.map(n=>({label:n.month,v1:n.created,v2:n.completed})),color1:"var(--blue)",color2:"var(--green)",label1:"Utworzone",label2:"Ukoczone"})]})]})]}):null}function nE({selectedIds:t,lookups:n,onBulkDone:a}){const[s,o]=m.useState("status"),[c,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(!1),j=async()=>{if(!c){alert("Wybierz warto");return}x(!0);const y={action_ids:t};s==="status"?y.status_id=Number(c):s==="priority"?y.priority_id=Number(c):y.responsible=c,h&&(y.change_reason=h);try{await le.post("/api/v1/actions/bulk",y),a()}catch(S){alert("Bd: "+S)}x(!1)};return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 14px",marginBottom:8,background:"rgba(59,130,246,0.08)",borderRadius:8,border:"1px solid rgba(59,130,246,0.2)"},children:[e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"var(--blue)"},children:["Zaznaczono: ",t.length]}),e.jsxs("select",{className:"form-control",style:{width:130,fontSize:11,padding:"4px 8px"},value:s,onChange:y=>{o(y.target.value),u("")},children:[e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"priority",children:"Priorytet"}),e.jsx("option",{value:"responsible",children:"Odpowiedzialny"})]}),s==="responsible"?e.jsx("input",{className:"form-control",style:{width:160,fontSize:11,padding:"4px 8px"},placeholder:"Nowy odpowiedzialny...",value:c,onChange:y=>u(y.target.value)}):e.jsxs("select",{className:"form-control",style:{width:160,fontSize:11,padding:"4px 8px"},value:c,onChange:y=>u(y.target.value),children:[e.jsx("option",{value:"",children:"Wybierz..."}),(s==="status"?n?.statuses:n?.priorities)?.map(y=>e.jsx("option",{value:y.id,children:y.label},y.id))]}),e.jsx("input",{className:"form-control",style:{width:200,fontSize:11,padding:"4px 8px"},placeholder:"Powd zmiany (opcjonalnie)...",value:h,onChange:y=>f(y.target.value)}),e.jsx("button",{className:"btn btn-sm btn-primary",disabled:p||!c,onClick:j,style:{fontSize:11},children:p?"...":"Zastosuj"})]})}function rE(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(null),[_,E]=m.useState(!1),[z,N]=m.useState(null),[O,Q]=m.useState(!1),[U,L]=m.useState(new Set),{visible:H,toggle:A}=da(pm,"actions"),R=Aa({data:t,storageKey:"actions",defaultSort:"due_date",defaultSortDir:"asc"}),[G,F]=m.useState([]),q=m.useCallback(()=>{s(!0),c(null),le.get("/api/v1/actions").then(je=>{const fe=(je??[]).map(_e=>({..._e,links:_e.links??[],history:_e.history??[],attachments:_e.attachments??[]}));n(fe),c(null)}).catch(je=>{console.error("Failed to load actions:",je),c(String(je))}).finally(()=>s(!1))},[]),ee=m.useCallback(()=>{le.get("/api/v1/actions/stats").then(N).catch(()=>{})},[]);m.useEffect(()=>{le.post("/api/v1/actions/auto-overdue",{}).catch(()=>{}).finally(()=>{q(),ee()}),le.get("/api/v1/org-units/tree").then(F).catch(()=>{})},[q,ee]);const me=m.useMemo(()=>Tl(G),[G]),W=async()=>{if(y)return y;const je=await le.get("/api/v1/org-units/tree").catch(()=>[]),fe=async Ue=>{try{return(await le.get(`/api/v1/dictionaries/${Ue}/entries`)).entries.filter(lt=>lt.is_active).map(lt=>({id:lt.id,label:lt.label}))}catch{return[]}},[_e,Se,Ve]=await Promise.all([fe("action_priority"),fe("action_status"),fe("action_source")]),be=await le.get("/api/v1/risks").catch(()=>[]),oe={orgUnits:je,priorities:_e,statuses:Se,sources:Ve,allRisks:be};return S(oe),oe},J=async()=>{await W(),p(null),h(!0)},M=async je=>{await W(),p(je),h(!0)},V=async je=>{if(confirm(`Archiwizowac dzialanie "${je.title}"?`))try{await le.delete(`/api/v1/actions/${je.id}`),b(null),s(!0),q(),ee()}catch(fe){alert("Blad: "+fe)}},ne=()=>{const je=Dp?.VITE_API_BASE??"";window.open(`${je}/api/v1/actions/export`,"_blank")},P=je=>{L(fe=>{const _e=new Set(fe);return _e.has(je)?_e.delete(je):_e.add(je),_e})},T=()=>{U.size===R.pageData.length?L(new Set):L(new Set(R.pageData.map(je=>je.id)))},C=R.filtered.filter(je=>je.is_overdue).length,k=t.filter(je=>je.is_overdue).length,I=R.filtered.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("trakcie")||fe.includes("progress")}).length,D=t.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("trakcie")||fe.includes("progress")}).length,de=R.filtered.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("zamkn")||fe.includes("complet")||fe.includes("wykonan")}).length,he=t.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("zamkn")||fe.includes("complet")||fe.includes("wykonan")}).length,ie=[{label:"Wszystkich dziaa",value:R.filteredCount,total:R.totalCount,color:"var(--blue)"},{label:"Przeterminowanych",value:C,total:k,color:"var(--red)"},{label:"W trakcie",value:I,total:D,color:"var(--orange)"},{label:"Ukoczonych",value:de,total:he,color:"var(--green)"}],ve=R.hasActiveFilters||!!R.search;return e.jsxs("div",{children:[o&&e.jsx("div",{className:"card",style:{marginBottom:12,padding:16,border:"1px solid var(--red)",background:"rgba(239,68,68,0.06)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{color:"var(--red)",fontSize:13},children:["Blad ladowania dzialan: ",o]}),e.jsx("button",{className:"btn btn-sm",onClick:q,children:"Ponow"})]})}),e.jsx(Ia,{cards:ie,isFiltered:ve}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:O?"var(--blue)":void 0},onClick:()=>Q(je=>!je),children:[O?"Ukryj":"Poka"," Dashboard KPI"]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:ne,title:"Eksport do Excel z ryzykami i histori",children:"Eksport szczegowy (XLSX)"})]}),O&&e.jsx(aE,{stats:z}),U.size>0&&e.jsx(nE,{selectedIds:Array.from(U),lookups:y,onBulkDone:()=>{L(new Set),s(!0),q(),ee(),S(null)}}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"dziaa",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj dziaa...",showFilters:_,onToggleFilters:()=>E(je=>!je),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:pm,visibleColumns:H,onToggleColumn:A,data:R.filtered,exportFilename:"dzialania",primaryLabel:"Dodaj dziaanie",onPrimaryAction:J}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:w?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:pm,visibleColumns:H,data:R.pageData,rowKey:je=>je.id,selectedKey:w?.id??null,onRowClick:je=>b(w?.id===je.id?null:je),rowBorderColor:je=>je.is_overdue?"var(--red)":je.completed_at?"var(--green)":void 0,sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:_,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:a,emptyMessage:"Brak dziaa w systemie.",emptyFilteredMessage:"Brak dziaa pasujcych do filtrw.",renderCell:(je,fe)=>{if(fe==="id")return e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:U.has(je.id),onChange:()=>P(je.id),onClick:_e=>_e.stopPropagation(),style:{cursor:"pointer"}}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["D-",je.id]})]});if(fe==="title")return e.jsx("span",{style:{fontWeight:500,maxWidth:260,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:je.title});if(fe==="priority_name")return je.priority_name?e.jsx("span",{style:{fontSize:12,fontWeight:500,color:ap(je.priority_name)},children:je.priority_name}):e.jsx("span",{children:""});if(fe==="status_name")return je.status_name?e.jsx("span",{className:"score-badge",style:{background:`${$o(je.status_name)}20`,color:$o(je.status_name)},children:je.status_name}):e.jsx("span",{children:""});if(fe==="due_date"){if(!je.due_date)return e.jsx("span",{children:""});const _e=QA(je.due_date);return e.jsxs("span",{style:{fontSize:11,fontFamily:"'JetBrains Mono',monospace",color:je.is_overdue?"var(--red)":_e!=null&&_e<=7?"var(--orange)":"var(--text-secondary)"},children:[je.due_date.slice(0,10),je.is_overdue&&e.jsx("span",{style:{marginLeft:4,fontSize:10,color:"var(--red)"},children:"!"})]})}if(fe==="links")return(je.links?.length??0)>0?e.jsx("span",{className:"score-badge",style:{background:"var(--cyan-dim)",color:"var(--cyan)"},children:je.links.length}):e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"0"})},renderHeaderExtra:je=>{if(je==="id")return e.jsx("input",{type:"checkbox",checked:U.size>0&&U.size===R.pageData.length,onChange:T,onClick:fe=>fe.stopPropagation(),style:{cursor:"pointer",marginRight:4}})}}),w&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 80px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy dziaania"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>b(null),children:""})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"var(--text-primary)",lineHeight:1.3},children:w.title}),e.jsxs("div",{style:{display:"flex",gap:6,justifyContent:"center",marginTop:6},children:[w.is_overdue&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)",fontSize:11},children:"Przeterminowane"}),w.completed_at&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)",fontSize:11},children:"Zamknite"}),w.status_name&&e.jsx("span",{className:"score-badge",style:{background:`${$o(w.status_name)}20`,color:$o(w.status_name),fontSize:11},children:w.status_name})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Fr,{label:"ID",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["D-",w.id]})}),e.jsx(Fr,{label:"Jednostka org.",value:e.jsx("span",{style:{fontSize:11},children:(w.org_unit_id?me.get(w.org_unit_id):null)??w.org_unit_name??""})}),e.jsx(Fr,{label:"Waciciel",value:w.owner}),e.jsx(Fr,{label:"Odpowiedzialny",value:w.responsible}),e.jsx(Fr,{label:"Priorytet",value:w.priority_name?e.jsx("span",{style:{fontWeight:500,color:ap(w.priority_name)},children:w.priority_name}):""}),e.jsx(Fr,{label:"rdo",value:w.source_name}),e.jsx(Fr,{label:"Termin",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:w.is_overdue?"var(--red)":"var(--text-secondary)"},children:w.due_date?.slice(0,10)??""})}),w.completed_at&&e.jsx(Fr,{label:"Zamknite",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--green)"},children:w.completed_at.slice(0,10)})}),w.effectiveness_rating!=null&&e.jsx(Fr,{label:"Skuteczno",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)"},children:[w.effectiveness_rating,"/5 ",["","Minimalna","Niska","rednia","Wysoka","Pena"][w.effectiveness_rating]]})}),e.jsx(Fr,{label:"Utworzono",value:w.created_at?.slice(0,10)}),w.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:w.description})]}),(w.links?.length??0)>0&&e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{color:"var(--text-muted)",marginBottom:4},children:["Powizane obiekty (",w.links.length,")"]}),(w.links??[]).map(je=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 8px",borderRadius:6,marginBottom:3,background:je.entity_type==="risk"?"rgba(239,68,68,0.06)":"rgba(59,130,246,0.06)",border:`1px solid ${je.entity_type==="risk"?"rgba(239,68,68,0.15)":"rgba(59,130,246,0.15)"}`},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)",textTransform:"uppercase",marginRight:4},children:je.entity_type==="risk"?"Ryzyko":je.entity_type==="asset"?"Aktyw":je.entity_type}),e.jsx("span",{style:{fontSize:12,fontWeight:500},children:je.entity_name??`#${je.entity_id}`})]}),je.entity_extra?.risk_score!=null&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600,color:fu(Number(je.entity_extra.risk_score))},children:Number(je.entity_extra.risk_score).toFixed(1)})]},je.id))]}),(w.history?.length??0)>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Ostatnie zmiany"}),e.jsxs("div",{style:{maxHeight:160,overflowY:"auto"},children:[(w.history??[]).slice(0,5).map(je=>e.jsxs("div",{style:{fontSize:11,padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:je.created_at?.slice(0,16).replace("T"," ")})," ",e.jsx("span",{style:{color:"var(--blue)"},children:Sb[je.field_name]??je.field_name}),je.old_value&&e.jsx("span",{style:{color:"var(--red)",textDecoration:"line-through",marginLeft:4,fontSize:10},children:je.old_value.length>40?je.old_value.slice(0,40)+"...":je.old_value}),e.jsx("span",{style:{color:"var(--green)",marginLeft:4,fontSize:10},children:je.new_value&&(je.new_value.length>40?je.new_value.slice(0,40)+"...":je.new_value)}),je.change_reason&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",fontStyle:"italic",marginLeft:8},children:["Powd: ",je.change_reason]})]},je.id)),(w.history?.length??0)>5&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:"4px 0",textAlign:"center"},children:["...i ",w.history.length-5," wicej"]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>M(w),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>V(w),children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:u,onClose:()=>{h(!1),p(null)},title:f?`Edytuj: D-${f.id} ${f.title}`:"Nowe dziaanie",wide:!0,children:y?e.jsx(iE,{editAction:f,lookups:y,orgTree:y.orgUnits,saving:x,setSaving:j,onSaved:je=>{je&&b(je),h(!1),p(null),S(null),s(!0),q(),ee()},onCancel:()=>{h(!1),p(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie danych formularza..."})})]})}function Fr({label:t,value:n}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:t}),e.jsx("span",{children:n??""})]})}function iE({editAction:t,lookups:n,orgTree:a,saving:s,setSaving:o,onSaved:c,onCancel:u}){const[h,f]=m.useState("description"),p=!!t,[x,j]=m.useState(t?.title??""),[y,S]=m.useState(t?.description??""),[w,b]=m.useState(t?.org_unit_id??null),[_,E]=m.useState(t?.priority_id??null),[z,N]=m.useState(t?.status_id??null),[O,Q]=m.useState(t?.source_id??null),[U,L]=m.useState(t?.owner??""),[H,A]=m.useState(t?.responsible??""),[R,G]=m.useState(t?.due_date?.slice(0,10)??""),[F,q]=m.useState(()=>(t?.links??[]).filter(Ve=>Ve.entity_type==="risk").map(Ve=>Ve.entity_id)),[ee,me]=m.useState(t?.implementation_notes??""),[W,J]=m.useState(t?.effectiveness_rating??null),[M,V]=m.useState(t?.effectiveness_notes??""),[ne,P]=m.useState(()=>t?.attachments??[]),[T,C]=m.useState(!1),[k,I]=m.useState(""),D=m.useRef(null),de=m.useMemo(()=>(t?.links??[]).filter(Ve=>Ve.entity_type!=="risk"),[t]),he=m.useCallback(()=>t?x!==t.title||y!==(t.description??"")||U!==(t.owner??"")||H!==(t.responsible??"")||R!==(t.due_date?.slice(0,10)??"")||z!==t.status_id||_!==t.priority_id:!1,[t,x,y,U,H,R,z,_]),ie=async Ve=>{if(!x.trim()){alert("Tytu jest wymagany");return}o(!0);const be=[...F.map(Ue=>({entity_type:"risk",entity_id:Ue})),...de.map(Ue=>({entity_type:Ue.entity_type,entity_id:Ue.entity_id}))],oe={title:x.trim(),description:y||null,org_unit_id:w,owner:U||null,responsible:H||null,priority_id:_,status_id:z,source_id:O,due_date:R||null,links:be};p&&(oe.implementation_notes=ee||null,oe.effectiveness_rating=W,oe.effectiveness_notes=M||null,Ve&&(oe.change_reason=Ve));try{if(p){const Ue=await le.put(`/api/v1/actions/${t.id}`,oe);c(Ue)}else await le.post("/api/v1/actions",oe),c()}catch(Ue){alert("Bd zapisu: "+Ue)}finally{o(!1)}},ve=()=>{p&&he()?(D.current=()=>ie(k),I(""),C(!0)):ie()},je=()=>{C(!1),ie(k||void 0)},fe=Ve=>({padding:"8px 16px",fontSize:12,fontWeight:h===Ve?600:400,cursor:"pointer",borderBottom:h===Ve?"2px solid var(--blue)":"2px solid transparent",color:h===Ve?"var(--blue)":"var(--text-muted)"}),_e=async Ve=>{if(!t||!Ve.target.files?.length)return;const be=Ve.target.files[0],oe=new FormData;oe.append("file",be);try{const Ue=await fetch(`${Dp?.VITE_API_URL??""}/api/v1/actions/${t.id}/attachments`,{method:"POST",body:oe});if(!Ue.ok)throw new Error(await Ue.text());const Qe=await Ue.json();P(lt=>[Qe,...lt])}catch(Ue){alert("Bd uploadu: "+Ue)}Ve.target.value=""},Se=async Ve=>{if(t&&confirm("Usun zacznik?"))try{await le.delete(`/api/v1/actions/${t.id}/attachments/${Ve}`),P(be=>be.filter(oe=>oe.id!==Ve))}catch(be){alert("Bd: "+be)}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:0,borderBottom:"1px solid var(--border)",marginBottom:16},children:[e.jsx("span",{style:fe("description"),onClick:()=>f("description"),children:"Opis dziaania"}),e.jsxs("span",{style:fe("links"),onClick:()=>f("links"),children:["Powizania",F.length>0&&e.jsxs("span",{style:{marginLeft:4,fontSize:10,color:"var(--cyan)",fontWeight:700},children:["(",F.length,")"]})]}),p&&e.jsx("span",{style:fe("effectiveness"),onClick:()=>f("effectiveness"),children:"Skuteczno"}),p&&e.jsx("span",{style:fe("comments"),onClick:()=>f("comments"),children:"Komentarze"}),p&&e.jsxs("span",{style:fe("history"),onClick:()=>f("history"),children:["Historia",t?.history?.length?e.jsxs("span",{style:{marginLeft:4,fontSize:10,color:"var(--text-muted)"},children:["(",t.history.length,")"]}):null]})]}),h==="description"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytu dziaania *"}),e.jsx("input",{className:"form-control",value:x,onChange:Ve=>j(Ve.target.value),placeholder:"np. Wdroenie MFA dla kont administracyjnych"}),!x.trim()&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:y,onChange:Ve=>S(Ve.target.value),placeholder:"Opisz dziaanie, cele, kroki..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:a,value:w,onChange:b,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priorytet"}),e.jsxs("select",{className:"form-control",value:_??"",onChange:Ve=>E(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.priorities.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:z??"",onChange:Ve=>N(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.statuses.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"rdo"}),e.jsxs("select",{className:"form-control",value:O??"",onChange:Ve=>Q(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),n.sources.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel"}),e.jsx("input",{className:"form-control",value:U,onChange:Ve=>L(Ve.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny za realizacj"}),e.jsx("input",{className:"form-control",value:H,onChange:Ve=>A(Ve.target.value),placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:R,onChange:Ve=>G(Ve.target.value)})]})]}),h==="links"&&e.jsx(sE,{allRisks:n.allRisks,linkedRiskIds:F,setLinkedRiskIds:q,otherLinks:de}),h==="effectiveness"&&t&&e.jsx(lE,{editAction:t,implementationNotes:ee,setImplementationNotes:me,effectivenessRating:W,setEffectivenessRating:J,effectivenessNotes:M,setEffectivenessNotes:V,attachments:ne,onFileUpload:_e,onDeleteAttachment:Se}),h==="comments"&&t&&e.jsx(oE,{actionId:t.id}),h==="history"&&t&&e.jsx(cE,{history:t.history??[]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:14},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!x.trim(),onClick:ve,children:s?"Zapisywanie...":p?"Zapisz zmiany":"Dodaj dziaanie"})]}),T&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)"},onClick:()=>C(!1),children:e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:12,padding:24,maxWidth:480,width:"90%",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},onClick:Ve=>Ve.stopPropagation(),children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"var(--blue)"},children:"Powd zmiany"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:12},children:"Wykryto zmiany w ledzonych polach (tytu, opis, termin, waciciel, status, priorytet, odpowiedzialny). Podaj uzasadnienie zmian  zostanie zapisane w historii."}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:Ve=>I(Ve.target.value),placeholder:"np. Przesunicie terminu ze wzgldu na brak zasobw...",autoFocus:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>C(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{color:"var(--text-muted)"},onClick:()=>{C(!1),ie()},children:"Zapisz bez powodu"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:je,disabled:!k.trim(),children:"Zapisz ze zmianami"})]})]})})]})}function sE({allRisks:t,linkedRiskIds:n,setLinkedRiskIds:a,otherLinks:s}){const[o,c]=m.useState(""),u=t.filter(j=>n.includes(j.id)),h=t.filter(j=>!n.includes(j.id)),f=o.length>=1?h.filter(j=>{const y=o.toLowerCase();return j.asset_name.toLowerCase().includes(y)||(j.code??`R-${j.id}`).toLowerCase().includes(y)||(j.org_unit_name??"").toLowerCase().includes(y)||(j.owner??"").toLowerCase().includes(y)||(j.risk_category_name??"").toLowerCase().includes(y)}).slice(0,10):[],p=j=>{a([...n,j]),c("")},x=j=>a(n.filter(y=>y!==j));return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:14},children:[e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:["Powizane ryzyka (",u.length,")"]}),u.length===0&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak powizanych ryzyk. Wyszukaj i dodaj ryzyko poniej."}),u.map(j=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:8,marginBottom:6,background:"rgba(239,68,68,0.05)",border:"1px solid rgba(239,68,68,0.15)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:j.code||`R-${j.id}`}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:j.asset_name}),j.risk_score!=null&&e.jsx("span",{className:"score-badge",style:{background:`${fu(Number(j.risk_score))}20`,color:fu(Number(j.risk_score)),fontSize:10,padding:"1px 6px"},children:Number(j.risk_score).toFixed(1)})]}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:10,flexWrap:"wrap"},children:[j.org_unit_name&&e.jsx("span",{children:j.org_unit_name}),j.risk_category_name&&e.jsx("span",{children:j.risk_category_name}),j.security_area_name&&e.jsx("span",{children:j.security_area_name}),j.status_name&&e.jsxs("span",{children:["Status: ",j.status_name]}),j.owner&&e.jsxs("span",{children:["Wac.: ",j.owner]})]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"2px 8px",fontSize:11,color:"var(--red)"},onClick:()=>x(j.id),children:""})]},j.id))]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj ryzyka po aktywie, kodzie, jednostce, wacicielu, kategorii...",value:o,onChange:j=>c(j.target.value)}),f.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:300,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:f.map(j=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid var(--border)"},onClick:()=>p(j.id),onMouseEnter:y=>y.currentTarget.style.background="rgba(239,68,68,0.06)",onMouseLeave:y=>y.currentTarget.style.background="transparent",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:j.code||`R-${j.id}`}),e.jsx("span",{style:{fontWeight:500,fontSize:12},children:j.asset_name}),j.risk_score!=null&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600,color:fu(Number(j.risk_score))},children:Number(j.risk_score).toFixed(1)})]}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:8,marginTop:2},children:[j.org_unit_name&&e.jsx("span",{children:j.org_unit_name}),j.risk_category_name&&e.jsx("span",{children:j.risk_category_name}),j.status_name&&e.jsx("span",{children:j.status_name}),j.owner&&e.jsx("span",{children:j.owner})]})]},j.id))}),o.length>=1&&f.length===0&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,padding:"12px 14px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2,fontSize:12,color:"var(--text-muted)",textAlign:"center"},children:['Brak wynikw dla "',o,'"']})]}),s.length>0&&e.jsxs("div",{style:{marginTop:16,padding:10,background:"rgba(59,130,246,0.04)",borderRadius:8,border:"1px solid rgba(59,130,246,0.15)"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:6},children:"Inne powizania (informacyjnie)"}),s.map(j=>e.jsxs("div",{style:{fontSize:12,padding:"3px 0",display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:9,color:"var(--blue)",textTransform:"uppercase",fontWeight:600},children:j.entity_type==="asset"?"Aktyw":j.entity_type==="incident"?"Incydent":j.entity_type==="audit"?"Audyt":j.entity_type==="policy_exception"?"Wyjtek":j.entity_type}),e.jsx("span",{children:j.entity_name??`#${j.entity_id}`})]},j.id))]})]})}function lE({editAction:t,implementationNotes:n,setImplementationNotes:a,effectivenessRating:s,setEffectivenessRating:o,effectivenessNotes:c,setEffectivenessNotes:u,attachments:h,onFileUpload:f,onDeleteAttachment:p}){const x=m.useRef(null),j=Dp?.VITE_API_URL??"",y=["","1  Minimalna","2  Niska","3  rednia","4  Wysoka","5  Pena"];return e.jsxs("div",{children:[t.completed_at&&e.jsx("div",{style:{marginBottom:14,padding:12,background:"rgba(52,211,153,0.08)",borderRadius:8,border:"1px solid rgba(52,211,153,0.2)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"score-badge",style:{background:"rgba(34,197,94,0.15)",color:"var(--green)",fontSize:11},children:"Zamknite"}),e.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)"},children:t.completed_at.slice(0,10)})]})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis zrealizowanych dziaa"}),e.jsx("textarea",{className:"form-control",rows:4,value:n,onChange:S=>a(S.target.value),placeholder:"Opisz co zostao wykonane, jakie kroki podjto, jakie wyniki osignito..."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ocena skutecznoci mitygacji ryzyka (1-5)"}),e.jsxs("select",{className:"form-control",value:s??"",onChange:S=>o(S.target.value?Number(S.target.value):null),children:[e.jsx("option",{value:"",children:"Brak oceny"}),e.jsx("option",{value:"1",children:"1  Minimalna (dziaanie niemal bez efektu)"}),e.jsx("option",{value:"2",children:"2  Niska (czciowo zrealizowane)"}),e.jsx("option",{value:"3",children:"3  rednia (zrealizowane, umiarkowany efekt)"}),e.jsx("option",{value:"4",children:"4  Wysoka (dobrze zrealizowane)"}),e.jsx("option",{value:"5",children:"5  Pena (w peni skuteczne)"})]})]}),s!=null&&e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"100%",height:8,borderRadius:4,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s*20}%`,height:"100%",borderRadius:4,background:s>=4?"var(--green)":s>=3?"var(--blue)":s>=2?"var(--orange)":"var(--red)",transition:"width 0.3s"}})}),e.jsx("span",{style:{marginLeft:8,fontSize:12,fontWeight:600,fontFamily:"'JetBrains Mono',monospace"},children:y[s]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki dot. skutecznoci"}),e.jsx("textarea",{className:"form-control",rows:2,value:c,onChange:S=>u(S.target.value),placeholder:"Opisz rezultaty, co si udao, co mona poprawi..."})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs("label",{style:{fontSize:12,color:"var(--text-muted)"},children:["Zaczniki (",h.length,")"]}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>x.current?.click(),children:"+ Dodaj zacznik"}),e.jsx("input",{type:"file",ref:x,style:{display:"none"},onChange:f})]}),h.length===0&&e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak zacznikw. Dodaj pliki jako dowody realizacji dziaania."}),h.map(S=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",borderRadius:6,marginBottom:4,background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.12)"},children:[e.jsxs("div",{children:[e.jsx("a",{href:`${j}/api/v1/actions/${t.id}/attachments/${S.id}/download`,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,fontWeight:500,color:"var(--blue)",textDecoration:"none"},children:S.original_name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[eE(S.file_size)," | ",S.created_at.slice(0,16).replace("T"," ")]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"2px 6px",fontSize:10,color:"var(--red)"},onClick:()=>p(S.id),children:""})]},S.id))]})]})}function oE({actionId:t}){const[n,a]=m.useState([]),[s,o]=m.useState(!0),[c,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(""),b=m.useCallback(()=>{le.get(`/api/v1/actions/${t}/comments`).then(a).catch(()=>{}).finally(()=>o(!1))},[t]);m.useEffect(()=>{b()},[b]);const _=async()=>{if(c.trim()){x(!0);try{const N=await le.post(`/api/v1/actions/${t}/comments`,{content:c.trim(),author:h.trim()||null});a(O=>[...O,N]),u("")}catch(N){alert("Bd: "+N)}x(!1)}},E=async N=>{if(S.trim())try{const O=await le.put(`/api/v1/actions/${t}/comments/${N}`,{content:S.trim()});a(Q=>Q.map(U=>U.id===N?O:U)),y(null)}catch(O){alert("Bd: "+O)}},z=async N=>{if(confirm("Usun komentarz?"))try{await le.delete(`/api/v1/actions/${t}/comments/${N}`),a(O=>O.filter(Q=>Q.id!==N))}catch(O){alert("Bd: "+O)}};return s?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"adowanie komentarzy..."}):e.jsxs("div",{children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto",marginBottom:16},children:[n.length===0&&e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak komentarzy. Dodaj pierwszy komentarz poniej."}),n.map(N=>e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,marginBottom:6,background:"var(--bg-inset)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:"var(--blue)"},children:N.author||"Anonim"}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:N.created_at.slice(0,16).replace("T"," ")}),N.updated_at!==N.created_at&&e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)",fontStyle:"italic"},children:"(edytowany)"})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},onClick:()=>{y(N.id),w(N.content)},children:"Edytuj"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10,color:"var(--red)"},onClick:()=>z(N.id),children:"Usu"})]})]}),j===N.id?e.jsxs("div",{children:[e.jsx("textarea",{className:"form-control",rows:2,value:S,onChange:O=>w(O.target.value),style:{fontSize:12}}),e.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10},onClick:()=>y(null),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",style:{fontSize:10},onClick:()=>E(N.id),disabled:!S.trim(),children:"Zapisz"})]})]}):e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",whiteSpace:"pre-wrap",lineHeight:1.5},children:N.content})]},N.id))]}),e.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:6},children:"Nowy komentarz"}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:8},children:e.jsx("input",{className:"form-control",style:{width:180,fontSize:11},placeholder:"Autor (opcjonalnie)",value:h,onChange:N=>f(N.target.value)})}),e.jsx("textarea",{className:"form-control",rows:3,style:{fontSize:12},value:c,onChange:N=>u(N.target.value),placeholder:"Wpisz komentarz, uwag, pytanie..."}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:p||!c.trim(),onClick:_,children:p?"...":"Dodaj komentarz"})})]})]})}function cE({history:t}){if(t.length===0)return e.jsx("div",{style:{padding:30,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak historii zmian. Zmiany bd rejestrowane automatycznie po pierwszej edycji."});const n=[];let a="";for(const s of t){const o=s.created_at.slice(0,19);o!==a?(n.push({timestamp:o,reason:s.change_reason,entries:[s]}),a=o):(n[n.length-1].entries.push(s),s.change_reason&&!n[n.length-1].reason&&(n[n.length-1].reason=s.change_reason))}return e.jsx("div",{style:{maxHeight:450,overflowY:"auto"},children:n.map((s,o)=>e.jsxs("div",{style:{marginBottom:12,padding:10,borderRadius:8,background:"var(--bg-inset)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontSize:11,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-muted)"},children:s.timestamp.replace("T"," ")}),s.entries[0].changed_by&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:s.entries[0].changed_by})]}),s.reason&&e.jsxs("div",{style:{fontSize:11,color:"var(--blue)",padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:6,fontStyle:"italic"},children:["Powd: ",s.reason]}),s.entries.map(c=>e.jsxs("div",{style:{fontSize:12,padding:"4px 0",display:"grid",gridTemplateColumns:"120px 1fr",gap:8},children:[e.jsx("span",{style:{color:"var(--blue)",fontWeight:500,fontSize:11},children:Sb[c.field_name]??c.field_name}),e.jsxs("div",{children:[c.old_value&&e.jsx("div",{style:{color:"var(--red)",fontSize:11,textDecoration:"line-through",opacity:.8,wordBreak:"break-word"},children:c.old_value}),c.new_value&&e.jsx("div",{style:{color:"var(--green)",fontSize:11,wordBreak:"break-word"},children:c.new_value})]})]},c.id))]},o))})}const dE=["","risks","cis","org_units","dictionaries","security_areas","threats","vulnerabilities","safeguards"],uE={"":"Wszystkie moduy",risks:"Analiza Ryzyka",cis:"CIS Benchmark",org_units:"Struktura Org.",dictionaries:"Sowniki",security_areas:"Obszary bezp.",threats:"Zagroenia",vulnerabilities:"Podatnoci",safeguards:"Zabezpieczenia"},fE={create:{bg:"var(--green-dim)",fg:"var(--green)"},update:{bg:"var(--blue-dim)",fg:"var(--blue)"},delete:{bg:"var(--red-dim)",fg:"var(--red)"},review:{bg:"var(--yellow-dim)",fg:"var(--yellow)"},approve:{bg:"var(--purple-dim)",fg:"var(--purple)"}};function hE(){const[t,n]=m.useState(null),[a,s]=m.useState(!0),[o,c]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(1),x=(y,S,w)=>{s(!0);const b=new URLSearchParams;y&&b.set("module",y),S&&b.set("action",S),b.set("page",String(w)),b.set("per_page","50");const _=b.toString();le.get(`/api/v1/audit-log?${_}`).then(n).catch(()=>n(null)).finally(()=>s(!1))};m.useEffect(()=>{x(o,u,f)},[o,u,f]);const j=t?Math.ceil(t.total/t.per_page):0;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx("select",{className:"form-control",style:{width:180},value:o,onChange:y=>{c(y.target.value),p(1)},children:dE.map(y=>e.jsx("option",{value:y,children:uE[y]??y},y))}),e.jsxs("select",{className:"form-control",style:{width:140},value:u,onChange:y=>{h(y.target.value),p(1)},children:[e.jsx("option",{value:"",children:"Wszystkie akcje"}),e.jsx("option",{value:"create",children:"Utworzenie"}),e.jsx("option",{value:"update",children:"Zmiana"}),e.jsx("option",{value:"delete",children:"Usunicie"}),e.jsx("option",{value:"review",children:"Przegld"}),e.jsx("option",{value:"approve",children:"Zatwierdzenie"})]}),(o||u)&&e.jsx("button",{className:"btn btn-sm",onClick:()=>{c(""),h(""),p(1)},children:"Wyczy filtry"})]}),e.jsx("div",{className:"toolbar-right",children:t&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[t.total," wpisw  Strona ",t.page," / ",j||1]})})]}),e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:a?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie..."}):!t||t.items.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak wpisw w audit trail."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"Akcja"}),e.jsx("th",{children:"Modu"}),e.jsx("th",{children:"Obiekt"}),e.jsx("th",{children:"Pole"}),e.jsx("th",{children:"Stara warto"}),e.jsx("th",{children:"Nowa warto"}),e.jsx("th",{children:"Uytkownik"})]})}),e.jsx("tbody",{children:t.items.map(y=>{const S=fE[y.action]??{bg:"var(--blue-dim)",fg:"var(--blue)"};return e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)",whiteSpace:"nowrap"},children:y.created_at?.replace("T"," ").slice(0,19)}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:S.bg,color:S.fg},children:y.action})}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)"},children:y.module})}),e.jsxs("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:[y.entity_type,"#",y.entity_id]}),e.jsx("td",{style:{fontSize:12},children:y.field_name??""}),e.jsx("td",{style:{color:"var(--red)",fontSize:12,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.old_value??""}),e.jsx("td",{style:{color:"var(--green)",fontSize:12,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.new_value??""}),e.jsx("td",{style:{fontSize:12},children:y.user_name??"system"})]},y.id)})})]})}),j>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm",disabled:f<=1,onClick:()=>p(f-1),children:"Poprzednia"}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",alignSelf:"center"},children:[f," / ",j]}),e.jsx("button",{className:"btn btn-sm",disabled:f>=j,onClick:()=>p(f+1),children:"Nastpna"})]})]})}function np(t){return t==="A"?"var(--green)":t==="B"?"var(--cyan)":t==="C"?"var(--yellow)":t==="D"?"var(--orange)":"var(--red)"}function mE(t){return t==="high"?"var(--red)":t==="medium"?"var(--orange)":"var(--green)"}function pE(t){return t==="high"?"var(--red-dim)":t==="medium"?"var(--orange-dim)":"var(--green-dim)"}function Cv(t){return t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function gE(){const[t,n]=m.useState(null),[a,s]=m.useState(!0),[o,c]=m.useState([]),[u,h]=m.useState(""),f=on(),p=b=>{s(!0);const _=b?`?org_unit_id=${b}`:"";le.get(`/api/v1/domains/dashboard/scores${_}`).then(n).catch(()=>{}).finally(()=>s(!1))};m.useEffect(()=>{le.get("/api/v1/org-units/tree").then(c).catch(()=>{}),p()},[]);const x=b=>{h(b),p(b||void 0)};if(a&&!t)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Ladowanie dashboardu domen..."})});const j=t?.overall_score??0,y=t?.overall_grade??"F",S=t?.domains??[],w=[...S].sort((b,_)=>b.score-_.score);return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx(jn,{tree:o,value:u?Number(u):null,onChange:b=>x(b?String(b):""),placeholder:"Cala organizacja",allowClear:!0,style:{width:300}}),a&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odswiezanie..."})]}),e.jsx("div",{className:"toolbar-right",children:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Ogolny wynik"}),e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:6},children:[e.jsx("span",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:np(y)},children:Math.round(j)}),e.jsx("span",{style:{fontSize:16,fontWeight:600,color:np(y)},children:y})]})]})})]}),S.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Brak zdefiniowanych domen bezpieczenstwa. Dodaj domeny w Konfiguracji."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:14},children:w.map(b=>e.jsx(xE,{domain:b,navigate:f},b.domain_id))})]})}function xE({domain:t,navigate:n}){const a=np(t.grade),s=2*Math.PI*24,o=s-t.score/100*s;return e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden",cursor:"default"},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:`2px solid ${t.color??"var(--border)"}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:8,background:`${t.color??"var(--blue)"}20`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,color:t.color??"var(--blue)"},children:t.icon?yE(t.icon):"?"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:t.domain_name}),t.owner&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:t.owner})]})]}),e.jsxs("div",{style:{position:"relative",width:56,height:56},children:[e.jsxs("svg",{width:"56",height:"56",viewBox:"0 0 56 56",children:[e.jsx("circle",{cx:"28",cy:"28",r:"24",fill:"none",stroke:"var(--bg-subtle)",strokeWidth:"4"}),e.jsx("circle",{cx:"28",cy:"28",r:"24",fill:"none",stroke:a,strokeWidth:"4",strokeDasharray:s,strokeDashoffset:o,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"28px 28px"}})]}),e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a,lineHeight:1},children:Math.round(t.score)}),e.jsx("div",{style:{fontSize:9,color:a},children:t.grade})]})]})]}),e.jsxs("div",{style:{padding:"12px 16px"},children:[e.jsx("div",{style:{display:"flex",gap:6,marginBottom:10},children:[{label:"Wysokie",count:t.risk_high,color:"var(--red)",bg:"var(--red-dim)"},{label:"Srednie",count:t.risk_medium,color:"var(--orange)",bg:"var(--orange-dim)"},{label:"Niskie",count:t.risk_low,color:"var(--green)",bg:"var(--green-dim)"}].map(c=>e.jsxs("div",{style:{flex:1,textAlign:"center",background:c.bg,borderRadius:6,padding:"6px 4px"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:c.color},children:c.count}),e.jsx("div",{style:{fontSize:9,color:c.color},children:c.label})]},c.label))}),t.cis_control_count>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,marginBottom:3},children:[e.jsxs("span",{style:{color:"var(--text-muted)"},children:["CIS (",t.cis_control_count," kontroli)"]}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:t.cis_pct!=null?Cv(t.cis_pct):"var(--text-muted)"},children:t.cis_pct!=null?`${Math.round(t.cis_pct)}%`:""})]}),e.jsx("div",{className:"bar-track",style:{height:6},children:e.jsx("div",{className:"bar-fill",style:{width:`${t.cis_pct??0}%`,background:t.cis_pct!=null?Cv(t.cis_pct):"var(--text-muted)",height:6}})})]}),t.top_risks.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)",marginBottom:4},children:"Top ryzyka"}),t.top_risks.map(c=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11,cursor:"pointer"},onClick:()=>n(`/risks?highlight=${c.id}`),children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:c.asset_name}),e.jsx("span",{className:"score-badge",style:{background:pE(c.risk_level),color:mE(c.risk_level),fontSize:10},children:Number(c.risk_score).toFixed(0)})]},c.id))]}),t.risk_count===0&&t.cis_control_count===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",padding:8},children:"Brak ryzyk i kontroli CIS"})]})]})}function yE(t){return{monitor:"",database:"",settings:"",users:"","shield-alert":"","file-text":"",mail:"",bug:"",wifi:"","hard-drive":"",building:"",scale:"",activity:"","graduation-cap":"","alert-triangle":""}[t]??""}const hu=[{filename:"mapping-adobe-ccf-v5-and-bsi-c5-2020.yaml",source:"Adobe CCF v5",target:"BSI C5 2020",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-cyber_essentials_requirements_for_it_infrastructure.yaml",source:"Adobe CCF v5",target:"Cyber Essentials",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-fedramp-rev5.yaml",source:"Adobe CCF v5",target:"FedRAMP Rev5",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-iso27001-2022.yaml",source:"Adobe CCF v5",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-nist-csf-1.1.yaml",source:"Adobe CCF v5",target:"NIST CSF 1.1",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-pcidss-4_0.yaml",source:"Adobe CCF v5",target:"PCI DSS 4.0",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-soc2-2017-rev-2022.yaml",source:"Adobe CCF v5",target:"SOC2 2017",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-ccb-cff-2023-03-01.yaml",source:"NIS2 Annex",target:"CCB CFF 2023",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-iso27001-2022.yaml",source:"NIS2 Annex",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-nist-csf-2.0.yaml",source:"NIS2 Annex",target:"NIST CSF 2.0",direction:"and"},{filename:"mapping-ccb-cff-2023-03-01-and-ccb-cyfun2025.yaml",source:"CCB CFF 2023",target:"CCB CyFun 2025",direction:"and"},{filename:"mapping-ccb-cff-2023-03-01-to-iso27001-2022.yaml",source:"CCB CFF 2023",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-cis-controls-v8-and-iso27001-2022.yaml",source:"CIS Controls v8",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-cis-controls-v8-and-scf-2025.2.2.yaml",source:"CIS Controls v8",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-bsi-c5-2020.yaml",source:"Cisco CCF v3.0",target:"BSI C5 2020",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-esquema-nacional-de-seguridad.yaml",source:"Cisco CCF v3.0",target:"ENS",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-fedramp-rev5.yaml",source:"Cisco CCF v3.0",target:"FedRAMP Rev5",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-iso27001-2022.yaml",source:"Cisco CCF v3.0",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-ncsc-caf-3.2.yaml",source:"Cisco CCF v3.0",target:"NCSC CAF 3.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-800-171-rev2.yaml",source:"Cisco CCF v3.0",target:"NIST 800-171 Rev2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-800-171-rev3.yaml",source:"Cisco CCF v3.0",target:"NIST 800-171 Rev3",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-ssdf-1.1.yaml",source:"Cisco CCF v3.0",target:"NIST SSDF 1.1",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-pcidss-4_0.yaml",source:"Cisco CCF v3.0",target:"PCI DSS 4.0",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-secnumcloud-3.2.yaml",source:"Cisco CCF v3.0",target:"SecNumCloud 3.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-soc2-2017-rev-2022.yaml",source:"Cisco CCF v3.0",target:"SOC2 2017",direction:"and"},{filename:"mapping-cjis-policy-5.9.4-to-cjis-policy-5.9.yaml",source:"CJIS 5.9.4",target:"CJIS 5.9",direction:"to"},{filename:"mapping-dora-and-finma-2023-01.yaml",source:"DORA",target:"FINMA 2023-01",direction:"and"},{filename:"mapping-india-dpdpa-2023-and-scf-2025.2.2.yaml",source:"India DPDPA 2023",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-iso27001-2013-to-iso27001-2022.yaml",source:"ISO 27001:2013",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-iso27001-2022-and-scf-2025.2.2.yaml",source:"ISO 27001:2022",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-iso27001-2022-to-secnumcloud-3.2.yaml",source:"ISO 27001:2022",target:"SecNumCloud 3.2",direction:"to"},{filename:"mapping-iso42001-2023-and-scf-2025.2.2.yaml",source:"ISO 42001:2023",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-nist-csf-2.0-and-scf-2025.2.2.yaml",source:"NIST CSF 2.0",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-nist-csf-2.0-to-iso27001-2022.yaml",source:"NIST CSF 2.0",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml",source:"NIST SP 800-53 Rev5",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-csf-1.1.yaml",source:"NIST SP 800-66 Rev2",target:"NIST CSF 1.1",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-csf-2.0.yaml",source:"NIST SP 800-66 Rev2",target:"NIST CSF 2.0",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-sp-800-53-rev5.yaml",source:"NIST SP 800-66 Rev2",target:"NIST SP 800-53 Rev5",direction:"to"},{filename:"mapping-pcidss-4_0-and-scf-2025.2.2.yaml",source:"PCI DSS 4.0",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-scf-2025.2.2-and-swift-cscf-v2025.yaml",source:"SCF 2025.2.2",target:"SWIFT CSCF v2025",direction:"and"},{filename:"mapping-secnumcloud-3.2-to-iso27001-2022.yaml",source:"SecNumCloud 3.2",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-soc2-2017-rev-2022-and-scf-2025.2.2.yaml",source:"SOC2 2017",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-soc2-2017-rev-2022-to-iso27001-2022.yaml",source:"SOC2 2017",target:"ISO 27001:2022",direction:"to"}],Tv={nist:"NIST",iso:"ISO",cis:"CIS",pci:"PCI",soc:"SOC",gdpr:"GDPR/Privacy",eu:"EU/NIS2/DORA",cloud:"Cloud",ccf:"CCF",other:"Inne"},Nv={nist:"#6366f1",iso:"#10b981",cis:"#f59e0b",pci:"#ef4444",soc:"#8b5cf6",gdpr:"#ec4899",eu:"#3b82f6",cloud:"#06b6d4",ccf:"#14b8a6",other:"#94a3b8"},Zd=[{filename:"nist-sp-800-53-rev5.yaml",name:"NIST SP 800-53 Rev5",provider:"NIST",category:"nist"},{filename:"nist-csf-2.0.yaml",name:"NIST CSF 2.0",provider:"NIST",category:"nist"},{filename:"nist-csf-1.1.yaml",name:"NIST CSF 1.1",provider:"NIST",category:"nist"},{filename:"nist-800-171-rev2.yaml",name:"NIST 800-171 Rev2",provider:"NIST",category:"nist"},{filename:"nist-800-171-rev3.yaml",name:"NIST 800-171 Rev3",provider:"NIST",category:"nist"},{filename:"nist-sp-800-66-rev2.yaml",name:"NIST SP 800-66 Rev2 (HIPAA)",provider:"NIST",category:"nist"},{filename:"nist-ssdf-1.1.yaml",name:"NIST SSDF 1.1",provider:"NIST",category:"nist"},{filename:"nist-ai-rmf-1.0.yaml",name:"NIST AI RMF 1.0",provider:"NIST",category:"nist"},{filename:"nist-privacy-1.0.yaml",name:"NIST Privacy Framework 1.0",provider:"NIST",category:"nist"},{filename:"nist-sp-800-82-annex-f.yaml",name:"NIST SP 800-82 Annex F",provider:"NIST",category:"nist"},{filename:"fedramp-rev5.yaml",name:"FedRAMP Rev5",provider:"NIST/GSA",category:"nist"},{filename:"iso27001-2022.yaml",name:"ISO 27001:2022",provider:"ISO",category:"iso"},{filename:"iso27001-2013.yaml",name:"ISO 27001:2013",provider:"ISO",category:"iso"},{filename:"iso22301-2019.yaml",name:"ISO 22301:2019 (BCM)",provider:"ISO",category:"iso"},{filename:"iso42001-2023.yaml",name:"ISO 42001:2023 (AI)",provider:"ISO",category:"iso"},{filename:"cis-controls-v8.xlsx",name:"CIS Controls v8",provider:"CIS",category:"cis"},{filename:"cis-benchmark-kubernetes.yaml",name:"CIS Benchmark Kubernetes",provider:"CIS",category:"cis"},{filename:"pcidss-4_0.yaml",name:"PCI DSS 4.0",provider:"PCI SSC",category:"pci"},{filename:"soc2-2017-rev-2022.yaml",name:"SOC2 2017 Rev 2022",provider:"AICPA",category:"soc"},{filename:"gdpr.yaml",name:"GDPR",provider:"EU",category:"gdpr"},{filename:"gdpr-checklist.yaml",name:"GDPR Checklist",provider:"EU",category:"gdpr"},{filename:"ccpa_act.yaml",name:"CCPA Act",provider:"California",category:"gdpr"},{filename:"ccpa_regulations.yaml",name:"CCPA Regulations",provider:"California",category:"gdpr"},{filename:"india-dpdpa-2023.yaml",name:"India DPDPA 2023",provider:"India",category:"gdpr"},{filename:"dora.yaml",name:"DORA",provider:"EU",category:"eu"},{filename:"annex-nis2-regulation--2024-2690-with-technical-implementation-guidance-by-enisa.yaml",name:"NIS2 Annex (ENISA Technical Guide)",provider:"ENISA",category:"eu"},{filename:"ai-act.yaml",name:"EU AI Act",provider:"EU",category:"eu"},{filename:"ens-decreto.yaml",name:"ENS (Esquema Nacional de Seguridad)",provider:"Spain",category:"eu"},{filename:"esrs-p1.yaml",name:"ESRS Part 1",provider:"EFRAG",category:"eu"},{filename:"esrs-p2.yaml",name:"ESRS Part 2",provider:"EFRAG",category:"eu"},{filename:"cra-regulation-annexes.yaml",name:"Cyber Resilience Act Annexes",provider:"EU",category:"eu"},{filename:"ccb-cff-2023-03-01.yaml",name:"CCB CFF 2023",provider:"CCB Belgium",category:"eu"},{filename:"ccb-cyfun2025.yaml",name:"CCB CyFun 2025",provider:"CCB Belgium",category:"eu"},{filename:"finma-2023-01.yaml",name:"FINMA 2023-01",provider:"Switzerland",category:"eu"},{filename:"secnumcloud-3.2.yaml",name:"SecNumCloud 3.2",provider:"ANSSI",category:"cloud"},{filename:"bsi-c5-2020.yaml",name:"BSI C5 2020",provider:"BSI Germany",category:"cloud"},{filename:"adobe-ccf-v5.yaml",name:"Adobe CCF v5",provider:"Adobe",category:"ccf"},{filename:"cisco-ccf-v3.0.yaml",name:"Cisco CCF v3.0",provider:"Cisco",category:"ccf"},{filename:"scf-2025.2.2.yaml",name:"SCF 2025.2.2",provider:"Secure Controls Framework",category:"ccf"},{filename:"cmmc-2.0.yaml",name:"CMMC 2.0",provider:"DoD",category:"other"},{filename:"owasp-asvs-4.0.3.yaml",name:"OWASP ASVS 4.0.3",provider:"OWASP",category:"other"},{filename:"owasp-asvs-5.0.0.yaml",name:"OWASP ASVS 5.0.0",provider:"OWASP",category:"other"},{filename:"essential-eight.yaml",name:"Essential Eight",provider:"Australia ASD",category:"other"},{filename:"cyber_essentials.yaml",name:"Cyber Essentials",provider:"NCSC UK",category:"other"},{filename:"ncsc-caf-3.2.yaml",name:"NCSC CAF 3.2",provider:"NCSC UK",category:"other"},{filename:"swift-cscf-v2025.yaml",name:"SWIFT CSCF v2025",provider:"SWIFT",category:"other"},{filename:"cjis-version-5.9.5.yaml",name:"CJIS v5.9.5",provider:"FBI",category:"other"},{filename:"3cf-v2.yaml",name:"3CF v2",provider:"3CF",category:"other"},{filename:"aircyber-v1.5.2.yaml",name:"AirCyber v1.5.2",provider:"GIFAS",category:"other"},{filename:"dfs-500-2023-11.yaml",name:"DFS 500 (2023-11)",provider:"NY DFS",category:"other"}],Lp={draft:{label:"Szkic",cls:"badge-gray",color:"var(--text-muted)",bg:"var(--bg-inset)"},review:{label:"Przegld",cls:"badge-yellow",color:"var(--orange)",bg:"var(--orange-dim)"},published:{label:"Zatwierdzony",cls:"badge-green",color:"var(--green)",bg:"var(--green-dim)"},deprecated:{label:"Wycofany",cls:"badge-red",color:"var(--red)",bg:"var(--red-dim)"},archived:{label:"Zarchiwizowany",cls:"badge-gray",color:"var(--text-muted)",bg:"var(--bg-inset)"}};function Gd(t){return Lp[t]?.color??"var(--text-muted)"}function Av(t){return Lp[t]?.bg??"var(--bg-inset)"}function gm(t){return Lp[t]?.label??t}function vE(t){return t?t==="manual"?"Rczny":t==="ciso_assistant_yaml"?"YAML":t==="ciso_assistant_excel"?"Excel":t==="copy"?"Kopia":t==="custom_import"?"AI Import":t:""}const Kd={internal:"Wewntrzny",external:"Zewntrzny"};function xm({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:n})]})}function br({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function jE(){const t=on(),[n]=hc(),[a,s]=m.useState([]),[o,c]=m.useState(!0),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(null),[y,S]=m.useState(!1),[w,b]=m.useState(!1),[_,E]=m.useState(!1),[z,N]=m.useState(null),[O,Q]=m.useState(null),[U,L]=m.useState(!1),[H,A]=m.useState(!1),[R,G]=m.useState([]),[F,q]=m.useState(n.get("type")),[ee,me]=m.useState(n.get("origin")),W=m.useRef(null),J=m.useRef(null),[M,V]=m.useState(!1),[ne,P]=m.useState(null),T=m.useRef(!1),C=m.useCallback(((oe,Ue)=>{T.current&&!confirm(`Import AI jest w toku. Przejcie na inn stron przerwie proces importu.

Czy na pewno chcesz przerwa?`)||t(oe,Ue)}),[t]);m.useEffect(()=>{const oe=Ue=>{T.current&&(confirm(`Import AI jest w toku. Cofnicie przerwie proces importu.

Czy na pewno chcesz przerwa?`)||(Ue.preventDefault(),window.history.pushState(null,"",window.location.href)))};return window.addEventListener("popstate",oe),()=>window.removeEventListener("popstate",oe)},[]),m.useEffect(()=>{le.get("/api/v1/dictionaries/entries?type_code=document_type").then(G).catch(()=>G([]))},[]);const k=()=>{c(!0);const oe=new URLSearchParams;if(y||oe.set("is_active","true"),F){const Qe=R.find(lt=>lt.code===F);Qe&&oe.set("document_type_id",String(Qe.id))}ee&&oe.set("document_origin",ee);const Ue=oe.toString()?`?${oe.toString()}`:"";le.get(`/api/v1/frameworks${Ue}`).then(s).catch(()=>s([])).finally(()=>c(!1))};m.useEffect(()=>{k()},[y,F,ee,R]);const I=async oe=>{h(!0),p(null),j(null);const Ue=new FormData;Ue.append("file",oe);const lt=oe.name.endsWith(".yaml")||oe.name.endsWith(".yml")?"/api/v1/frameworks/import/yaml":"/api/v1/frameworks/import/excel";try{const tt=await le.postFormData(lt,Ue);p(tt),N(tt.framework_id),E(!0),k()}catch(tt){j(tt instanceof Error?tt.message:"Bd importu"),k()}finally{h(!1),W.current&&(W.current.value="")}},D=async oe=>{V(!0),T.current=!0,p(null),j(null),P({percent:0,message:"Wysyanie pliku...",nodes_found:0});const Ue=xt=>(xt.preventDefault(),xt.returnValue="Import AI jest w toku. Przeadowanie strony przerwie proces. Kontynuowa?",xt.returnValue);window.addEventListener("beforeunload",Ue);const Qe=new FormData;Qe.append("file",oe);const lt="",tt=new AbortController;let ht=null;try{const xt=fetch(`${lt}/api/v1/frameworks/import/ai`,{method:"POST",body:Qe,signal:tt.signal});let qe=null;ht=setInterval(async()=>{if(qe)try{const _t=await fetch(`${lt}/api/v1/frameworks/import/ai/progress/${qe}`);if(_t.ok){const zt=await _t.json();P({percent:zt.percent??0,message:zt.message??"",nodes_found:zt.nodes_found??0})}}catch{}},2e3);const Nt=await xt;if(qe=Nt.headers.get("x-import-task-id"),!Nt.ok){const _t=await Nt.text().catch(()=>"");throw new Error(`API ${Nt.status}: ${_t}`)}const st=await Nt.json();p(st),N(st.framework_id),E(!0),P({percent:100,message:`Import zakoczony  ${st.total_nodes} wzw`,nodes_found:st.total_nodes??0}),k()}catch(xt){const qe=xt instanceof Error?xt.message:"Bd importu AI";qe.includes("Failed to fetch")?j("Nie mona poczy si z backendem. Sprawd czy serwer dziaa i czy zainstalowane s: pdfplumber, python-docx (pip install pdfplumber python-docx)."):j(qe),k()}finally{window.removeEventListener("beforeunload",Ue),ht&&clearInterval(ht),V(!1),T.current=!1,setTimeout(()=>P(null),5e3),J.current&&(J.current.value="")}},de=async oe=>{const Ue=oe.lifecycle_status==="draft"||oe.lifecycle_status==="review";if(confirm(`Czy na pewno chcesz ${Ue?"usun":"zarchiwizowa"} wskazany dokument "${oe.name}"?`))try{await le.delete(`/api/v1/frameworks/${oe.id}`),Q(null),k()}catch(tt){alert(tt instanceof Error?tt.message:"Bd usuwania")}},he=async oe=>{try{const Ue=await le.post(`/api/v1/frameworks/${oe.id}/copy`,{copy_org_unit_links:!0});C(`/frameworks/${Ue.id}`)}catch(Ue){alert(Ue instanceof Error?Ue.message:"Bd kopiowania")}},ie=async oe=>{try{const Ue=await le.post("/api/v1/frameworks",oe);b(!1),C(`/frameworks/${Ue.id}`)}catch(Ue){alert(Ue instanceof Error?Ue.message:"Bd tworzenia")}},ve=m.useMemo(()=>{const oe=[{code:null,label:"Wszystkie",count:a.length}];for(const Ue of R){const Qe=a.filter(lt=>lt.document_type_id===Ue.id).length;oe.push({code:Ue.code,label:Ue.label,count:Qe})}return oe},[R,a]),je=[{key:"name",header:"Nazwa"},{key:"document_type_name",header:"Typ dokumentu",format:oe=>oe.document_type_name||""},{key:"document_origin",header:"Pochodzenie",format:oe=>Kd[oe.document_origin]||oe.document_origin},{key:"owner",header:"Waciciel",format:oe=>oe.owner||""},{key:"display_version",header:"Wersja",format:oe=>oe.display_version||oe.published_version||oe.version||""},{key:"provider",header:"Dostawca",format:oe=>oe.provider??""},{key:"total_nodes",header:"Wzy",format:oe=>String(oe.total_nodes)},{key:"total_assessable",header:"Ocenialne",format:oe=>String(oe.total_assessable)},{key:"lifecycle_status",header:"Status",format:oe=>gm(oe.lifecycle_status)},{key:"next_review_date",header:"Nastpny przegld",format:oe=>oe.next_review_date||"",defaultVisible:!1},{key:"ref_id",header:"Ref ID",defaultVisible:!1},{key:"source_format",header:"rdo",format:oe=>vE(oe.source_format),defaultVisible:!1}],{visible:fe,toggle:_e}=da(je,"frameworks"),Se=Aa({data:a,storageKey:"frameworks",defaultSort:"name",defaultSortDir:"asc"}),Ve=Se.filteredCount!==Se.totalCount,be=m.useMemo(()=>{const oe=Se.filtered,Ue=oe.filter(qe=>qe.lifecycle_status==="published").length,Qe=oe.filter(qe=>qe.lifecycle_status==="draft").length,lt=oe.filter(qe=>qe.requires_review&&qe.next_review_date&&new Date(qe.next_review_date)<new Date).length,tt=a.filter(qe=>qe.lifecycle_status==="published").length,ht=a.filter(qe=>qe.lifecycle_status==="draft").length,xt=a.filter(qe=>qe.requires_review&&qe.next_review_date&&new Date(qe.next_review_date)<new Date).length;return[{label:"Dokumentw",value:oe.length,total:a.length,color:"var(--blue)"},{label:"Zatwierdzonych",value:Ue,total:tt,color:"var(--green)"},{label:"Szkicw",value:Qe,total:ht,color:"var(--orange)"},{label:"Zalegy przegld",value:lt,total:xt,color:"var(--red)"}]},[Se.filtered,a]);return e.jsxs("div",{children:[f&&!_&&e.jsxs("div",{className:"card",style:{background:"var(--green-dim)",borderLeft:"3px solid var(--green)",marginBottom:12,padding:"10px 14px",fontSize:12},children:[e.jsx("strong",{children:"Import zakoczony:"})," ",f.name,"  ",f.total_nodes," wzw, ",f.total_assessable," ocenialnych, ",f.dimensions_created," wymiarw",e.jsx("button",{className:"btn btn-sm",style:{marginLeft:12,fontSize:10},onClick:()=>p(null),children:""})]}),x&&e.jsxs("div",{className:"card",style:{background:"var(--red-dim)",borderLeft:"3px solid var(--red)",marginBottom:12,padding:"10px 14px",fontSize:12},children:[e.jsx("strong",{children:"Bd importu:"})," ",x,e.jsx("button",{className:"btn btn-sm",style:{marginLeft:12,fontSize:10},onClick:()=>j(null),children:""})]}),ne&&e.jsxs("div",{className:"card",style:{marginBottom:12,padding:"14px 16px",borderLeft:`3px solid ${ne.percent>=100?"var(--green)":"var(--blue)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:ne.percent>=100?"Import AI zakoczony":"AI analizuje dokument..."}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[ne.nodes_found>0&&e.jsxs("span",{style:{color:"var(--blue)",fontWeight:600},children:[ne.nodes_found," wzw"]})," ",ne.percent,"%"]})]}),e.jsx("div",{className:"bar-track",style:{height:8,marginBottom:6},children:e.jsx("div",{className:"bar-fill",style:{width:`${ne.percent}%`,background:ne.percent>=100?"var(--green)":"var(--blue)",transition:"width 0.5s ease"}})}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:ne.message}),ne.percent<100&&e.jsx("div",{style:{fontSize:11,color:"var(--orange)",marginTop:6,fontWeight:500},children:"Nie zamykaj ani nie przeadowuj strony  import zostanie przerwany."})]}),e.jsx(Ia,{cards:be,isFiltered:Ve}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:12},children:[ve.map(oe=>e.jsxs("button",{className:"btn btn-sm",style:{background:F===oe.code?"var(--blue)":"var(--bg-inset)",color:F===oe.code?"#fff":"var(--text-muted)",border:F===oe.code?"1px solid var(--blue)":"1px solid var(--border)",borderRadius:16,padding:"3px 12px",fontSize:11},onClick:()=>{q(F===oe.code?null:oe.code)},children:[oe.label," (",oe.count,")"]},oe.code??"all")),e.jsx("span",{style:{borderLeft:"1px solid var(--border)",margin:"0 4px"}}),["internal","external"].map(oe=>e.jsx("button",{className:"btn btn-sm",style:{background:ee===oe?"var(--purple)":"var(--bg-inset)",color:ee===oe?"#fff":"var(--text-muted)",border:ee===oe?"1px solid var(--purple)":"1px solid var(--border)",borderRadius:16,padding:"3px 12px",fontSize:11},onClick:()=>me(ee===oe?null:oe),children:Kd[oe]},oe))]}),e.jsx("input",{ref:W,type:"file",accept:".xlsx,.xls,.yaml,.yml",style:{display:"none"},onChange:oe=>oe.target.files?.[0]&&I(oe.target.files[0])}),e.jsx("input",{ref:J,type:"file",accept:".pdf,.docx,.doc",style:{display:"none"},onChange:oe=>oe.target.files?.[0]&&D(oe.target.files[0])}),e.jsx(ma,{filteredCount:Se.filteredCount,totalCount:Se.totalCount,unitLabel:"dokumentw",search:Se.search,onSearchChange:Se.setSearch,searchPlaceholder:"Szukaj dokumentw...",showFilters:U,onToggleFilters:()=>L(oe=>!oe),hasActiveFilters:Se.hasActiveFilters,onClearFilters:Se.clearAllFilters,columns:je,visibleColumns:fe,onToggleColumn:_e,data:Se.filtered,exportFilename:"repozytorium_wymagan",primaryLabel:"Nowy dokument",onPrimaryAction:()=>b(!0),secondaryActions:[{label:"Import z CISO Assistant",onClick:()=>A(!0)},{label:u?"Importowanie...":"Import z pliku",onClick:()=>W.current?.click()},{label:M?" AI analizuje...":" AI Import (PDF/DOCX)",onClick:()=>J.current?.click()},{label:y?"Ukryj archiwalne":"Poka archiwalne",onClick:()=>S(oe=>!oe)}]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:je,visibleColumns:fe,data:Se.pageData,rowKey:oe=>oe.id,selectedKey:O?.id??null,onRowClick:oe=>Q(O?.id===oe.id?null:oe),rowBorderColor:oe=>Gd(oe.lifecycle_status),sortField:Se.sortField,sortDir:Se.sortDir,onSort:Se.toggleSort,columnFilters:Se.columnFilters,onColumnFilter:Se.setColumnFilter,showFilters:U,page:Se.page,totalPages:Se.totalPages,pageSize:Se.pageSize,totalItems:Se.totalCount,filteredItems:Se.filteredCount,onPageChange:Se.setPage,onPageSizeChange:Se.setPageSize,loading:o,emptyMessage:"Brak dokumentw referencyjnych. Zaimportuj z pliku lub utwrz rcznie.",emptyFilteredMessage:"Brak dokumentw pasujcych do filtrw.",renderCell:(oe,Ue)=>{if(Ue==="name")return e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600},children:oe.name}),oe.updates_document_id&&e.jsx("span",{style:{fontSize:9,color:"var(--orange)",marginLeft:6},children:"AKTUALIZACJA"})]});if(Ue==="document_type_name")return e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:oe.document_type_name||""});if(Ue==="document_origin")return e.jsx("span",{className:"score-badge",style:{background:oe.document_origin==="internal"?"var(--blue-dim)":"var(--bg-inset)",color:oe.document_origin==="internal"?"var(--blue)":"var(--text-muted)",fontSize:10},children:Kd[oe.document_origin]||oe.document_origin});if(Ue==="total_nodes")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.total_nodes});if(Ue==="total_assessable")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.total_assessable});if(Ue==="lifecycle_status")return e.jsx("span",{className:"score-badge",style:{background:Av(oe.lifecycle_status),color:Gd(oe.lifecycle_status)},children:gm(oe.lifecycle_status)});if(Ue==="display_version")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.display_version||oe.published_version||""});if(Ue==="next_review_date"){if(!oe.next_review_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const Qe=new Date(oe.next_review_date)<new Date;return e.jsxs("span",{style:{color:Qe?"var(--red)":"var(--text-muted)",fontWeight:Qe?600:400},children:[oe.next_review_date,Qe&&" !"]})}}}),O&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy dokumentu"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>C(`/frameworks/${O.id}`),title:"Otwrz",children:"Otwrz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>Q(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Gd(O.lifecycle_status)},children:O.display_version||`v${O.edit_version}`}),e.jsx("span",{className:"score-badge",style:{background:Av(O.lifecycle_status),color:Gd(O.lifecycle_status),fontSize:13,padding:"4px 12px"},children:gm(O.lifecycle_status)}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:[O.total_nodes," wzw | ",O.total_assessable," ocenialnych"]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(xm,{number:1,label:"Informacje"}),e.jsx(br,{label:"Nazwa",value:e.jsx("span",{style:{fontWeight:500},children:O.name})}),e.jsx(br,{label:"Typ dokumentu",value:O.document_type_name||""}),e.jsx(br,{label:"Pochodzenie",value:Kd[O.document_origin]||O.document_origin}),e.jsx(br,{label:"Waciciel",value:O.owner}),e.jsx(br,{label:"Dostawca",value:O.provider}),e.jsx(br,{label:"Wersja",value:O.display_version||O.published_version||O.version}),e.jsx(br,{label:"Ref ID",value:O.ref_id}),e.jsx(xm,{number:2,label:"Przegldy"}),e.jsx(br,{label:"Wymaga przegldu",value:O.requires_review?"Tak":"Nie",color:O.requires_review?"var(--blue)":void 0}),O.requires_review&&e.jsx(e.Fragment,{children:e.jsx(br,{label:"Nastpny przegld",value:O.next_review_date||"Nie ustalono",color:O.next_review_date&&new Date(O.next_review_date)<new Date?"var(--red)":void 0})}),e.jsx(xm,{number:3,label:"Struktura"}),e.jsx(br,{label:"Wzy",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700},children:O.total_nodes})}),e.jsx(br,{label:"Ocenialne",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700},children:O.total_assessable})})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>C(`/frameworks/${O.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:()=>he(O),children:"Kopiuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>de(O),children:O.lifecycle_status==="published"?"Archiwizuj":"Usu"})]})]})]}),e.jsx(gt,{open:w,onClose:()=>b(!1),title:"Nowy dokument referencyjny",children:e.jsx(bE,{onClose:()=>b(!1),onCreate:ie,documentTypes:R})}),e.jsx(gt,{open:_,onClose:()=>{E(!1),N(null)},title:"Formularz adopcji dokumentu",children:z&&e.jsx(_E,{frameworkId:z,documentTypes:R,importResult:f,onClose:()=>{E(!1),N(null),k()},onAdoptAndOpen:oe=>{E(!1),C(`/frameworks/${oe}`)}})}),e.jsx(gt,{open:H,onClose:()=>A(!1),title:"Katalog CISO Assistant Community",wide:!0,children:e.jsx(SE,{existingFrameworks:a,onImportDone:oe=>{N(oe.framework_id),A(!1),E(!0),k()}})})]})}function bE({onClose:t,onCreate:n,documentTypes:a}){const[s,o]=m.useState(""),[c,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState(""),[b,_]=m.useState(null),[E,z]=m.useState("external"),[N,O]=m.useState(!1),[Q,U]=m.useState(12);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa dokumentu *"}),e.jsx("input",{className:"form-control",value:s,onChange:L=>o(L.target.value),placeholder:"np. ISO 27001:2022, Polityka Bezpieczestwa IT",autoFocus:!0})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ dokumentu"}),e.jsxs("select",{className:"form-control",value:b??"",onChange:L=>_(L.target.value?Number(L.target.value):null),children:[e.jsx("option",{value:"",children:" Wybierz typ "}),a.map(L=>e.jsx("option",{value:L.id,children:L.label},L.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pochodzenie"}),e.jsxs("select",{className:"form-control",value:E,onChange:L=>z(L.target.value),children:[e.jsx("option",{value:"external",children:"Zewntrzny"}),e.jsx("option",{value:"internal",children:"Wewntrzny"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:c,onChange:L=>u(L.target.value),placeholder:"np. ISO-27001-2022"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja publikacji"}),e.jsx("input",{className:"form-control",value:p,onChange:L=>x(L.target.value),placeholder:"np. 2022"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dostawca / Wydawca"}),e.jsx("input",{className:"form-control",value:j,onChange:L=>y(L.target.value),placeholder:"np. ISO, NIST, CIS"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:S,onChange:L=>w(L.target.value),placeholder:"Osoba odpowiedzialna"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:h,onChange:L=>f(L.target.value),rows:3,placeholder:"Opis dokumentu..."})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N,onChange:L=>O(L.target.checked)}),"Podlega przegldom okresowym"]}),N&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"co"}),e.jsx("input",{type:"number",className:"form-control",style:{width:60},value:Q,onChange:L=>U(Number(L.target.value)),min:1,max:60}),e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"mies."})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{className:"btn",onClick:t,children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!s.trim(),onClick:()=>n({name:s,ref_id:c,description:h,version:p,provider:j,owner:S,document_type_id:b,document_origin:E,requires_review:N,review_frequency_months:Q}),children:"Utwrz"})]})]})}function _E({frameworkId:t,documentTypes:n,importResult:a,onClose:s,onAdoptAndOpen:o}){const[c,u]=m.useState(""),[h,f]=m.useState(null),[p,x]=m.useState("external"),[j,y]=m.useState(""),[S,w]=m.useState(!1),[b,_]=m.useState(12),[E,z]=m.useState(!0),[N,O]=m.useState(!1),Q=a?.metrics_summary??[],U=a?.metrics_detected??!1,L=Q.filter(A=>A.detected).length;m.useEffect(()=>{le.get(`/api/v1/frameworks/${t}`).then(A=>{u(A.name),x(A.document_origin||"external"),O(!0)}).catch(()=>O(!0))},[t]);const H=async()=>{try{!E&&U&&await le.delete(`/api/v1/frameworks/${t}/metrics`).catch(()=>{}),await le.put(`/api/v1/frameworks/${t}/adopt`,{name:c||void 0,document_type_id:h,document_origin:p,owner:j||void 0,requires_review:S,review_frequency_months:b}),o(t)}catch(A){alert(A instanceof Error?A.message:"Bd adopcji")}};return N?e.jsxs("div",{children:[e.jsx("div",{style:{background:"var(--blue-dim)",borderLeft:"3px solid var(--blue)",padding:"10px 14px",marginBottom:16,fontSize:12},children:"Dokument zosta zaimportowany jako szkic. Uzupenij jego atrybuty i przejrzyj struktur przed zatwierdzeniem."}),e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa dokumentu"}),e.jsx("input",{className:"form-control",value:c,onChange:A=>u(A.target.value)})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ dokumentu"}),e.jsxs("select",{className:"form-control",value:h??"",onChange:A=>f(A.target.value?Number(A.target.value):null),children:[e.jsx("option",{value:"",children:" Wybierz typ "}),n.map(A=>e.jsx("option",{value:A.id,children:A.label},A.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pochodzenie"}),e.jsxs("select",{className:"form-control",value:p,onChange:A=>x(A.target.value),children:[e.jsx("option",{value:"external",children:"Zewntrzny"}),e.jsx("option",{value:"internal",children:"Wewntrzny"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:j,onChange:A=>y(A.target.value),placeholder:"Osoba odpowiedzialna za dokument"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:S,onChange:A=>w(A.target.checked)}),"Podlega przegldom okresowym"]}),S&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"co"}),e.jsx("input",{type:"number",className:"form-control",style:{width:60},value:b,onChange:A=>_(Number(A.target.value)),min:1,max:60}),e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"mies."})]})]}),Q.length>0&&e.jsxs("div",{style:{background:U?"var(--green-dim)":"var(--bg-inset)",border:`1px solid ${U?"var(--green)":"var(--border)"}`,borderRadius:8,padding:"12px 14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[e.jsxs("strong",{style:{fontSize:13},children:["Metryka dokumentu ",U?e.jsxs("span",{style:{color:"var(--green)",fontWeight:400,fontSize:12},children:["(",L,"/",Q.length," wykryto)"]}):e.jsx("span",{style:{color:"var(--text-muted)",fontWeight:400,fontSize:12},children:"(nie wykryto)"})]}),U&&e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",fontSize:12},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:A=>z(A.target.checked)}),"Importuj metryki"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"3px 16px",fontSize:12},children:Q.map(A=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"2px 0"},children:[e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:4,fontSize:11,fontWeight:700,background:A.detected?"var(--green)":"var(--bg-subtle)",color:A.detected?"#fff":"var(--text-muted)"},children:A.detected?"+":""}),e.jsx("span",{style:{color:A.detected?"var(--text)":"var(--text-muted)"},children:A.label})]},A.key))})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{className:"btn",onClick:s,children:"Pomi (pozostaw szkic)"}),e.jsx("button",{className:"btn btn-primary",onClick:H,children:"Zapisz i otwrz dokument"})]})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie..."})}function SE({existingFrameworks:t,onImportDone:n}){const[a,s]=m.useState(""),[o,c]=m.useState(null),[u,h]=m.useState(null),[f,p]=m.useState(null),x=w=>{const b=w.name.toLowerCase();return t.some(_=>{const E=_.name.toLowerCase();return E.includes(b)||b.includes(E)||w.filename.replace(/\.yaml|\.xlsx/g,"").replace(/-/g," ").toLowerCase().split(" ").filter(z=>z.length>2).some(z=>E.includes(z))&&E.length>5})},j=m.useMemo(()=>{let w=Zd;if(o&&(w=w.filter(b=>b.category===o)),a.trim()){const b=a.toLowerCase();w=w.filter(_=>_.name.toLowerCase().includes(b)||_.provider.toLowerCase().includes(b)||_.filename.toLowerCase().includes(b))}return w},[a,o]),y=m.useMemo(()=>{const w={};for(const b of Zd)w[b.category]=(w[b.category]||0)+1;return Object.entries(Tv).map(([b,_])=>({key:b,label:_,count:w[b]||0,color:Nv[b]})).filter(b=>b.count>0)},[]),S=async w=>{h(w.filename),p(null);try{const b=await le.post(`/api/v1/frameworks/import/github?framework_path=${encodeURIComponent(w.filename)}`,{});n(b)}catch(b){p(b instanceof Error?b.message:"Bd importu")}finally{h(null)}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Katalog CISO Assistant Community"}),e.jsx("div",{style:{color:"var(--text-muted)",lineHeight:1.6},children:"Przegldaj i importuj frameworki bezpieczestwa z repozytorium open-source CISO Assistant. Po imporcie uzupenij atrybuty dokumentu w formularzu adopcji."})]}),f&&e.jsxs("div",{style:{padding:"10px 14px",borderRadius:8,fontSize:12,background:"#7f1d1d",color:"#fca5a5"},children:[e.jsx("strong",{children:"Bd:"})," ",f,e.jsx("button",{className:"btn btn-sm",style:{marginLeft:8,fontSize:10},onClick:()=>p(null),children:""})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj frameworka...",value:a,onChange:w=>s(w.target.value),style:{flex:"1 1 200px",fontSize:12,padding:"6px 10px"},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[e.jsxs("button",{className:"btn btn-sm",style:{borderRadius:16,padding:"2px 10px",fontSize:10,background:o?"var(--bg-inset)":"var(--blue)",color:o?"var(--text-muted)":"#fff",border:o?"1px solid var(--border)":"1px solid var(--blue)"},onClick:()=>c(null),children:["Wszystkie (",Zd.length,")"]}),y.map(w=>e.jsxs("button",{className:"btn btn-sm",style:{borderRadius:16,padding:"2px 10px",fontSize:10,background:o===w.key?w.color:"var(--bg-inset)",color:o===w.key?"#fff":"var(--text-muted)",border:`1px solid ${o===w.key?w.color:"var(--border)"}`},onClick:()=>c(o===w.key?null:w.key),children:[w.label," (",w.count,")"]},w.key))]})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[j.length," z ",Zd.length," frameworkw"]}),e.jsx("div",{style:{maxHeight:400,overflowY:"auto",border:"1px solid var(--border)",borderRadius:8},children:j.length===0?e.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak frameworkw pasujcych do wyszukiwania"}):j.map(w=>{const b=x(w),_=u===w.filename,E=Nv[w.category];return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderBottom:"1px solid var(--border)",opacity:_?.6:1},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{padding:"1px 8px",borderRadius:10,fontSize:9,fontWeight:600,background:`${E}18`,color:E,border:`1px solid ${E}40`,flexShrink:0},children:Tv[w.category]}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:w.name}),b&&e.jsx("span",{style:{padding:"1px 6px",borderRadius:10,fontSize:9,background:"#10b98118",color:"#10b981",border:"1px solid #10b98140"},children:"zaimportowany"})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:[w.provider,"  ",w.filename]})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginLeft:12,flexShrink:0,...b?{}:{background:"var(--blue)",color:"#fff",border:"1px solid var(--blue)"}},onClick:()=>S(w),disabled:_,children:_?"Importowanie...":b?"Reimportuj":"Importuj"})]},w.filename)})})]})}const wE="",kE={ai_enabled:!1,ai_features:{}};let qd=null,Ev=0;const zE=6e4;function Mp(){const[t,n]=m.useState(qd??kE),[a,s]=m.useState(!qd),o=m.useCallback(async()=>{try{const c=await fetch(`${wE}/api/v1/config/features`);if(c.ok){const u=await c.json();qd=u,Ev=Date.now(),n(u)}}catch{}finally{s(!1)}},[]);return m.useEffect(()=>{!qd||Date.now()-Ev>zE?o():s(!1)},[o]),{flags:t,loading:a,refresh:o,aiEnabled:t.ai_enabled,hasFeature:c=>t.ai_enabled&&!!t.ai_features[c]}}function Dr(t,n,a){return`${t}:${n}:${a||""}`}const Ip={draft:{label:"Szkic",color:"var(--text-muted)",bg:"var(--bg-inset)"},review:{label:"Przegld",color:"var(--orange)",bg:"var(--orange-dim)"},published:{label:"Zatwierdzony",color:"var(--green)",bg:"var(--green-dim)"},deprecated:{label:"Wycofany",color:"var(--red)",bg:"var(--red-dim)"},archived:{label:"Zarchiwizowany",color:"var(--text-muted)",bg:"var(--bg-inset)"}},CE={draft:["review","published"],review:["draft","published"],published:["deprecated","draft"],deprecated:["archived","draft"],archived:["draft"]},Fv={external:"Zewntrzny",internal:"Wewntrzny"};function wb(t){return Ip[t]?.color??"var(--text-muted)"}function kb(t){return Ip[t]?.bg??"var(--bg-inset)"}function mu(t){return Ip[t]?.label??t}function tn({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function TE(){const{fwId:t}=Lu(),n=on(),[a,s]=m.useState(null),[o,c]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState([]),[x,j]=m.useState([]),[y,S]=m.useState([]),[w,b]=m.useState(!0),[_,E]=m.useState("tree"),[z,N]=m.useState(new Set),[O,Q]=m.useState(null),[U,L]=m.useState(null),{aiEnabled:H}=Mp(),[A,R]=m.useState(new Map),[G,F]=m.useState(null),q=m.useCallback(de=>{le.get(`/api/v1/ai/node-cache/${de}`).then(he=>{const ie=new Map;for(const ve of he)ie.set(Dr(ve.node_id,ve.action_type,ve.language),ve);R(ie)}).catch(()=>{})},[]),ee=()=>{t&&(b(!0),Promise.all([le.get(`/api/v1/frameworks/${t}`),le.get(`/api/v1/frameworks/${t}/tree`),le.get(`/api/v1/frameworks/${t}/versions`),le.get(`/api/v1/frameworks/${t}/org-units`).catch(()=>[]),le.get(`/api/v1/frameworks/${t}/reviews`).catch(()=>[])]).then(([de,he,ie,ve,je])=>{s(de),c(he),h(ie),p(ve),j(je);const fe=new Set;for(const _e of he){fe.add(_e.id);for(const Se of _e.children)fe.add(Se.id)}N(fe)}).catch(()=>{}).finally(()=>b(!1)))};m.useEffect(()=>{le.get("/api/v1/dictionaries/by-code/point_type").then(de=>S(de.entries?.filter(he=>he.is_active)??[])).catch(()=>{})},[]),m.useEffect(()=>{ee()},[t]),m.useEffect(()=>{a&&H&&q(a.id)},[a?.id,H,q]);const me=de=>{N(he=>{const ie=new Set(he);return ie.has(de)?ie.delete(de):ie.add(de),ie})},W=()=>{const de=new Set,he=ie=>{for(const ve of ie)de.add(ve.id),he(ve.children)};he(o),N(de)},J=()=>N(new Set),M=m.useMemo(()=>{let de=0,he=0,ie=0;const ve=je=>{for(const fe of je)de++,fe.assessable&&he++,fe.depth>ie&&(ie=fe.depth),ve(fe.children)};return ve(o),{total:de,assessable:he,maxDepth:ie}},[o]),V=async de=>{if(!a)return;const he=prompt("Opis zmiany statusu (opcjonalnie):");let ie;de==="published"&&(ie=confirm("Czy zachowa istniejce oceny? (OK = zachowaj, Anuluj = wymagaj ponownej oceny)"));try{await le.put(`/api/v1/frameworks/${a.id}/lifecycle`,{status:de,change_summary:he||void 0,keep_existing_assessments:ie}),ee()}catch(ve){alert(ve instanceof Error?ve.message:"Bd zmiany statusu")}},ne=async de=>{if(a)try{await le.post(`/api/v1/frameworks/${a.id}/nodes`,de),L(null),ee()}catch(he){alert(he instanceof Error?he.message:"Bd dodawania wza")}},P=async de=>{if(!(!a||!confirm("Usun ten wze? Elementy podrzdne zostan przeniesione poziom wyej.")))try{await le.delete(`/api/v1/frameworks/${a.id}/nodes/${de}`),Q(null),ee()}catch(he){alert(he instanceof Error?he.message:"Bd usuwania")}},T=async(de,he)=>{if(a)try{await le.put(`/api/v1/frameworks/${a.id}/nodes/${de}`,he),Q(null),ee()}catch(ie){alert(ie instanceof Error?ie.message:"Bd edycji")}},C=async()=>{if(!a)return;const he=a.lifecycle_status==="draft"?`Czy na pewno chcesz trwale usun dokument ${a.name}"? Operacja jest nieodwracalna.`:`Czy na pewno chcesz zarchiwizowa dokument ${a.name}"? Dokument zostanie przeniesiony do archiwum i nie bdzie widoczny na licie aktywnych dokumentw.`;if(confirm(he))try{await le.delete(`/api/v1/frameworks/${a.id}`),n("/frameworks")}catch(ie){alert(ie instanceof Error?ie.message:"Bd usuwania")}},k=async()=>{if(!a)return;const de=prompt("Nazwa kopii:",`${a.name}  kopia`);if(de)try{const he=await le.post(`/api/v1/frameworks/${a.id}/copy`,{new_name:de});n(`/frameworks/${he.id}`)}catch(he){alert(he instanceof Error?he.message:"Bd kopiowania")}},I=a?.next_review_date&&new Date(a.next_review_date)<new Date;if(w)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"adowanie dokumentu..."});if(!a)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Dokument nie znaleziony"});const D=CE[a.lifecycle_status]||[];return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8},children:[e.jsxs("div",{className:"toolbar-left",style:{alignItems:"center"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>n("/frameworks"),style:{marginRight:8},children:" Wstecz"}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a.name}),e.jsx("span",{className:"score-badge",style:{background:kb(a.lifecycle_status),color:wb(a.lifecycle_status),fontSize:11},children:mu(a.lifecycle_status)}),I&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)",fontSize:10},children:"Przegld przeterminowany"})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:2},children:[a.document_type_name&&e.jsx("span",{children:a.document_type_name}),e.jsxs("span",{children:["| ",Fv[a.document_origin]??a.document_origin]}),a.provider&&e.jsxs("span",{children:["| ",a.provider]}),a.display_version&&e.jsxs("span",{children:["| v",a.display_version]}),e.jsxs("span",{children:["| ",a.total_nodes," wzw"]}),e.jsxs("span",{children:["| ",a.total_assessable," ocenialnych"]}),a.owner&&e.jsxs("span",{children:["| Waciciel: ",a.owner]})]})]})]}),e.jsxs("div",{className:"toolbar-right",style:{alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm",onClick:k,title:"Utwrz kopi dokumentu",children:"Kopiuj"}),D.map(de=>e.jsx("button",{className:"btn btn-sm",onClick:()=>V(de),title:`Zmie na: ${mu(de)}`,children:mu(de)},de)),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:C,children:a.lifecycle_status==="draft"?"Usu":"Archiwizuj"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>n(`/compliance/assessments?framework_id=${a.id}`),children:"Nowa ocena"})]})]}),e.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"8px 24px",fontSize:12},children:[e.jsx(tn,{label:"Typ dokumentu",value:a.document_type_name??""}),e.jsx(tn,{label:"Pochodzenie",value:Fv[a.document_origin]??a.document_origin}),e.jsx(tn,{label:"Waciciel",value:a.owner}),e.jsx(tn,{label:"Wersja",value:a.display_version}),e.jsx(tn,{label:"Zatwierdzony przez",value:a.approved_by}),e.jsx(tn,{label:"Data zatwierdzenia",value:a.approved_at?new Date(a.approved_at).toLocaleDateString("pl-PL"):null}),e.jsx(tn,{label:"Wymaga przegldu",value:a.requires_review?"Tak":"Nie"}),a.requires_review&&e.jsxs(e.Fragment,{children:[e.jsx(tn,{label:"Czstotliwo przegldu",value:`co ${a.review_frequency_months} mies.`}),e.jsx(tn,{label:"Nastpny przegld",value:a.next_review_date?new Date(a.next_review_date).toLocaleDateString("pl-PL"):null,color:I?"var(--red)":void 0}),e.jsx(tn,{label:"Ostatni przegld",value:a.last_reviewed_at?new Date(a.last_reviewed_at).toLocaleDateString("pl-PL"):null}),e.jsx(tn,{label:"Przegldajcy",value:a.reviewed_by})]}),a.updates_document_name&&e.jsx(tn,{label:"Aktualizuje dokument",value:a.updates_document_name,color:"var(--blue)"})]})}),a.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:"8px 12px",marginBottom:12},children:a.description}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:16,flexWrap:"wrap"},children:[{key:"tree",label:`Struktura (${M.total})`},{key:"dimensions",label:`Wymiary (${a.dimensions.length})`},{key:"org-units",label:`Jedn. organizacyjne (${f.length})`},{key:"reviews",label:`Przegldy (${x.length})`},{key:"versions",label:`Historia wersji (${u.length})`},{key:"metrics",label:"Metryka dokumentu"},{key:"attachments",label:"Zaczniki"},{key:"edit",label:"Edycja metadanych"}].map(de=>e.jsx("button",{style:{padding:"8px 16px",fontSize:12,fontWeight:_===de.key?600:400,background:_===de.key?"var(--blue-dim)":"transparent",borderBottom:_===de.key?"2px solid var(--blue)":"2px solid transparent",color:_===de.key?"var(--blue)":"var(--text-muted)",border:"none",borderBottomWidth:2,borderBottomStyle:"solid",cursor:"pointer"},onClick:()=>E(de.key),children:de.label},de.key))}),_==="tree"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr 420px":"1fr",gap:14},children:[e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)",display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm",onClick:W,children:"Rozwi wszystko"}),e.jsx("button",{className:"btn btn-sm",onClick:J,children:"Zwi wszystko"}),e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[M.total," wzw | ",M.assessable," ocenialnych | gb. ",M.maxDepth]}),e.jsx("div",{style:{flex:1}}),H&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>F("interpret"),style:{fontSize:10,background:"var(--blue-dim)",color:"var(--blue)",border:"1px solid var(--blue)"},children:" Interpretuj dokument"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>F("translate"),style:{fontSize:10,background:"rgba(139,92,246,0.1)",color:"var(--purple, #8b5cf6)",border:"1px solid var(--purple, #8b5cf6)"},children:" Tumacz dokument"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>F("evidence"),style:{fontSize:10,background:"var(--green-dim)",color:"var(--green)",border:"1px solid var(--green)"},children:" Generuj dowody"})]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>L({parentId:null}),children:"+ Dodaj wze gwny"})]}),o.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak wzw. Dodaj pierwszy wze lub zaimportuj dokument."}):e.jsx("div",{style:{padding:"4px 0",maxHeight:"calc(100vh - 320px)",overflowY:"auto"},children:o.map(de=>e.jsx(zb,{node:de,expanded:z,onToggle:me,selectedId:O?.id??null,onSelect:Q,onAddChild:he=>L({parentId:he}),pointTypes:y,aiCache:H?A:void 0},de.id))})]}),O&&e.jsx("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:e.jsx(NE,{node:O,pointTypes:y,onClose:()=>Q(null),onDelete:()=>P(O.id),onSave:de=>T(O.id,de),onAddChild:()=>L({parentId:O.id}),frameworkName:a.name,aiEnabled:H,aiCache:A,onCacheUpdate:()=>a&&q(a.id)})})]}),_==="dimensions"&&e.jsx(EE,{dimensions:a.dimensions}),_==="org-units"&&e.jsx(FE,{fwId:a.id,orgUnits:f,onReload:ee}),_==="reviews"&&e.jsx(RE,{fwId:a.id,reviews:x,onReload:ee}),_==="versions"&&e.jsx(BE,{versions:u}),_==="metrics"&&e.jsx(ME,{fwId:a.id}),_==="attachments"&&e.jsx(IE,{fwId:a.id}),_==="edit"&&e.jsx(OE,{fw:a,onSaved:ee}),e.jsx(gt,{open:!!U,onClose:()=>L(null),title:U?.parentId?"Dodaj podwze":"Dodaj wze gwny",children:U&&e.jsx(AE,{parentId:U.parentId,pointTypes:y,onClose:()=>L(null),onCreate:ne})}),G&&a&&e.jsx(LE,{action:G,tree:o,frameworkName:a.name,aiCache:A,onClose:()=>F(null),onDone:()=>{q(a.id),F(null)}})]})}function zb({node:t,expanded:n,onToggle:a,selectedId:s,onSelect:o,onAddChild:c,pointTypes:u,aiCache:h}){const f=t.children.length>0,p=n.has(t.id),x=s===t.id,j=(t.depth-1)*24,y=t.point_type_id?u.find(E=>E.id===t.point_type_id)?.label:null,S=h?.has(Dr(t.id,"interpret")),w=h?.has(Dr(t.id,"evidence")),b=h?Array.from(h.values()).find(E=>E.node_id===t.id&&E.action_type==="translate"):void 0,_=b?b.result_json.translated_name:void 0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:6,padding:"5px 12px",paddingLeft:j+12,fontSize:12,background:x?"var(--bg-card-hover)":void 0,borderLeft:x?"3px solid var(--blue)":"3px solid transparent",cursor:"pointer",transition:"background 0.1s"},onClick:E=>{E.stopPropagation(),o(t)},children:[e.jsx("span",{style:{width:18,textAlign:"center",fontSize:10,color:"var(--text-muted)",flexShrink:0,cursor:f?"pointer":"default",lineHeight:"18px",userSelect:"none"},onClick:E=>{E.stopPropagation(),f&&a(t.id)},children:f?p?"":"":""}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[y&&e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:8,padding:"1px 5px"},children:y}),t.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--blue)",fontWeight:600,flexShrink:0},children:t.ref_id}),e.jsx("span",{style:{fontWeight:t.depth<=2?600:400},children:t.name_pl||t.name}),t.assessable&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)",fontSize:8,padding:"1px 5px"},children:"ocenialny"}),t.implementation_groups&&e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:8,padding:"1px 5px"},children:t.implementation_groups}),S&&e.jsx("span",{title:"Zinterpretowany (AI)",style:{fontSize:10,color:"var(--blue)",fontWeight:700,cursor:"default"},children:"i"}),_&&e.jsx("span",{title:"Przetumaczony (AI)",style:{fontSize:10,color:"var(--purple, #8b5cf6)",fontWeight:700,cursor:"default"},children:"A"}),w&&e.jsx("span",{title:"Dowody audytowe (AI)",style:{fontSize:10,color:"var(--green)",fontWeight:700,cursor:"default"},children:"E"})]}),_&&_!==t.name&&e.jsx("div",{style:{fontSize:10,color:"var(--purple, #8b5cf6)",marginTop:1,fontStyle:"italic",lineHeight:1.3},children:_}),t.description&&(p||!f)&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2,lineHeight:1.3,maxHeight:40,overflow:"hidden"},children:t.description})]}),e.jsx("span",{style:{fontSize:14,color:"var(--text-muted)",cursor:"pointer",padding:"0 4px",flexShrink:0,lineHeight:"18px",opacity:.5},title:"Dodaj podwze",onClick:E=>{E.stopPropagation(),c(t.id)},children:"+"})]}),p&&t.children.map(E=>e.jsx(zb,{node:E,expanded:n,onToggle:a,selectedId:s,onSelect:o,onAddChild:c,pointTypes:u,aiCache:h},E.id))]})}const Cb=[{code:"pl",label:"Polski"},{code:"en",label:"English"},{code:"de",label:"Deutsch"},{code:"fr",label:"Franais"},{code:"es",label:"Espaol"},{code:"it",label:"Italiano"},{code:"uk",label:""}];function NE({node:t,pointTypes:n,onClose:a,onDelete:s,onSave:o,onAddChild:c,frameworkName:u,aiEnabled:h,aiCache:f,onCacheUpdate:p}){const[x,j]=m.useState(!1),[y,S]=m.useState(t.name),[w,b]=m.useState(t.ref_id||""),[_,E]=m.useState(t.description||""),[z,N]=m.useState(t.assessable),[O,Q]=m.useState(t.annotation||""),[U,L]=m.useState(t.point_type_id??null),[H,A]=m.useState("none"),[R,G]=m.useState(!1),[F,q]=m.useState(null),[ee,me]=m.useState(null),[W,J]=m.useState(null),[M,V]=m.useState("pl"),[ne,P]=m.useState(null),T=t.point_type_id?n.find(D=>D.id===t.point_type_id)?.label:null;m.useEffect(()=>{S(t.name),b(t.ref_id||""),E(t.description||""),N(t.assessable),Q(t.annotation||""),L(t.point_type_id??null),j(!1),A("none"),q(null);const D=f?.get(Dr(t.id,"interpret"));if(D){const ie=D.result_json;me({interpretation:ie.interpretation||"",practical_examples:ie.practical_examples||[],common_pitfalls:ie.common_pitfalls||[],related_standards:ie.related_standards||[]})}else me(null);const de=f?.get(Dr(t.id,"translate",M));if(de){const ie=de.result_json;J({translated_name:ie.translated_name||"",translated_description:ie.translated_description??null,terminology_notes:ie.terminology_notes||[]})}else J(null);const he=f?.get(Dr(t.id,"evidence"));if(he){const ie=he.result_json;P({evidence_items:ie.evidence_items||[],audit_tips:ie.audit_tips||[]})}else P(null)},[t.id,f]);const C=async(D=!1)=>{G(!0),q(null),D&&me(null);try{const de=await le.post("/api/v1/ai/interpret-node",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,node_id:t.id,force:D});me(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{G(!1)}},k=async(D=!1)=>{G(!0),q(null),D&&J(null);try{const de=await le.post("/api/v1/ai/translate-node",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,target_language:M,node_id:t.id,force:D});J(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{G(!1)}},I=async(D=!1)=>{G(!0),q(null),D&&P(null);try{const de=await le.post("/api/v1/ai/generate-evidence",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,node_id:t.id,force:D});P(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{G(!1)}};return e.jsxs("div",{style:{fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy wza"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[!x&&e.jsx("button",{className:"btn btn-sm",onClick:()=>j(!0),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:a,children:""})]})]}),x?e.jsxs("div",{style:{display:"grid",gap:10},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa"}),e.jsx("input",{className:"form-control",value:y,onChange:D=>S(D.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:w,onChange:D=>b(D.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ punktu"}),e.jsxs("select",{className:"form-control",value:U??"",onChange:D=>L(D.target.value?Number(D.target.value):null),children:[e.jsx("option",{value:"",children:" brak "}),n.map(D=>e.jsx("option",{value:D.id,children:D.label},D.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:_,onChange:D=>E(D.target.value),rows:4})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Adnotacja"}),e.jsx("textarea",{className:"form-control",value:O,onChange:D=>Q(D.target.value),rows:2})]}),e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:z,onChange:D=>N(D.target.checked)}),"Ocenialny (li drzewa do oceny)"]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{o({name:y,ref_id:w||null,description:_||null,assessable:z,annotation:O||null,point_type_id:U})},children:"Zapisz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>j(!1),children:"Anuluj"})]})]}):e.jsxs(e.Fragment,{children:[T&&e.jsx("div",{style:{marginBottom:4},children:e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:10},children:T})}),t.ref_id&&e.jsx("div",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--blue)",fontWeight:600,marginBottom:4},children:t.ref_id}),e.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:14},children:t.name_pl||t.name}),W&&W.translated_name!==t.name&&e.jsx("div",{style:{fontSize:12,color:"var(--purple, #8b5cf6)",fontStyle:"italic",marginBottom:4,lineHeight:1.4},children:W.translated_name}),t.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5},children:t.description}),W?.translated_description&&W.translated_description!==t.description&&e.jsx("div",{style:{fontSize:11,color:"var(--purple, #8b5cf6)",fontStyle:"italic",background:"rgba(139,92,246,0.05)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5},children:W.translated_description}),ee&&H!=="interpret"&&e.jsxs("div",{style:{fontSize:11,color:"var(--blue)",background:"var(--blue-dim)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5,cursor:"pointer"},onClick:()=>A("interpret"),title:"Kliknij aby rozwin",children:[e.jsx("strong",{children:"Interpretacja:"})," ",ee.interpretation.slice(0,150),ee.interpretation.length>150?"...":""]}),t.content&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4},children:"Pena tre sekcji"}),e.jsx("div",{style:{fontSize:12,color:"var(--text)",background:"var(--bg-inset)",borderRadius:6,padding:10,lineHeight:1.6,maxHeight:300,overflowY:"auto",whiteSpace:"pre-wrap"},children:t.content})]}),t.annotation&&e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11},children:[e.jsx("strong",{children:"Adnotacja:"}),e.jsx("br",{}),t.annotation]}),t.typical_evidence&&e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11},children:[e.jsx("strong",{children:"Typowe dowody:"}),e.jsx("br",{}),t.typical_evidence]}),e.jsxs("div",{style:{lineHeight:2},children:[e.jsx(tn,{label:"Gboko",value:t.depth}),e.jsx(tn,{label:"Typ punktu",value:T??""}),e.jsx(tn,{label:"Ocenialny",value:t.assessable?e.jsx("span",{style:{color:"var(--green)",fontWeight:500},children:"Tak"}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"Nie"})}),t.implementation_groups&&e.jsx(tn,{label:"Gr. implementacji",value:t.implementation_groups}),t.importance&&e.jsx(tn,{label:"Wano",value:t.importance})]}),h&&e.jsxs("div",{style:{marginTop:12,borderTop:"1px solid var(--border)",paddingTop:10},children:[e.jsxs("div",{style:{display:"flex",gap:6,marginBottom:8},children:[e.jsxs("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:H==="interpret"?"var(--blue)":void 0,color:H==="interpret"?"#fff":void 0,border:H==="interpret"?"1px solid var(--blue)":void 0},onClick:()=>{H==="interpret"?A("none"):(A("interpret"),ee||C(!1))},disabled:R,title:"Interpretacja AI",children:[" Interpretacja",ee&&e.jsx("span",{style:{fontSize:9,marginLeft:2},children:""})]}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:H==="translate"?"var(--purple, #8b5cf6)":void 0,color:H==="translate"?"#fff":void 0,border:H==="translate"?"1px solid var(--purple, #8b5cf6)":void 0},onClick:()=>A(H==="translate"?"none":"translate"),disabled:R,title:"Tumaczenie AI",children:" Tumaczenie"}),e.jsxs("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:H==="evidence"?"var(--green)":void 0,color:H==="evidence"?"#fff":void 0,border:H==="evidence"?"1px solid var(--green)":void 0},onClick:()=>{H==="evidence"?A("none"):(A("evidence"),ne||I(!1))},disabled:R,title:"Dowody audytowe",children:[" Dowody",ne&&e.jsx("span",{style:{fontSize:9,marginLeft:2},children:""})]})]}),R&&e.jsx("div",{style:{padding:12,textAlign:"center",fontSize:11,color:"var(--text-muted)"},children:"Przetwarzanie AI..."}),F&&e.jsx("div",{style:{padding:8,borderRadius:6,background:"#7f1d1d",color:"#fca5a5",fontSize:11,marginBottom:8},children:F}),H==="interpret"&&ee&&!R&&e.jsxs("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10,fontSize:11,lineHeight:1.6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--blue)"},children:"Interpretacja"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:9,padding:"1px 6px"},onClick:()=>C(!0),disabled:R,children:"Ponw"})]}),e.jsx("div",{style:{marginBottom:8},children:ee.interpretation}),ee.practical_examples.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--green)"},children:"Przykady praktyczne"}),e.jsx("ul",{style:{margin:"0 0 8px",paddingLeft:16},children:ee.practical_examples.map((D,de)=>e.jsx("li",{children:D},de))})]}),ee.common_pitfalls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--orange)"},children:"Typowe bdy"}),e.jsx("ul",{style:{margin:"0 0 8px",paddingLeft:16},children:ee.common_pitfalls.map((D,de)=>e.jsx("li",{children:D},de))})]}),ee.related_standards.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--text-muted)"},children:"Powizane standardy"}),e.jsx("div",{children:ee.related_standards.join(", ")})]})]}),H==="translate"&&e.jsxs("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10},children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8,alignItems:"center"},children:[e.jsx("select",{className:"form-control",value:M,onChange:D=>{V(D.target.value),J(null)},style:{fontSize:11,flex:1},children:Cb.map(D=>e.jsx("option",{value:D.code,children:D.label},D.code))}),e.jsx("button",{className:"btn btn-sm",onClick:()=>k(!1),disabled:R,style:{fontSize:10,background:"var(--purple, #8b5cf6)",color:"#fff",border:"none"},children:"Tumacz"}),W&&e.jsx("button",{className:"btn btn-sm",onClick:()=>k(!0),disabled:R,style:{fontSize:9,padding:"2px 6px"},children:"Ponw"})]}),W&&!R&&e.jsxs("div",{style:{fontSize:11,lineHeight:1.6},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--purple, #8b5cf6)",marginBottom:4},children:"Tumaczenie"}),e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:W.translated_name}),W.translated_description&&e.jsx("div",{style:{marginBottom:6,color:"var(--text-secondary)"},children:W.translated_description}),W.terminology_notes.length>0&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",fontStyle:"italic"},children:W.terminology_notes.join(" | ")})]})]}),H==="evidence"&&e.jsx("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10,fontSize:11,lineHeight:1.6},children:ne&&!R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--green)"},children:"Dowody audytowe"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:9,padding:"1px 6px"},onClick:()=>I(!0),disabled:R,children:"Ponw"})]}),ne.evidence_items.map((D,de)=>e.jsxs("div",{style:{marginBottom:6,padding:"4px 6px",borderLeft:`2px solid ${D.priority==="required"?"var(--red)":D.priority==="recommended"?"var(--orange)":"var(--text-muted)"}`},children:[e.jsxs("div",{style:{fontWeight:600},children:[D.name,e.jsx("span",{className:"score-badge",style:{marginLeft:6,fontSize:8,padding:"1px 4px",background:D.type==="document"?"var(--blue-dim)":D.type==="record"?"var(--green-dim)":"var(--bg-inset)",color:D.type==="document"?"var(--blue)":D.type==="record"?"var(--green)":"var(--text-muted)"},children:D.type}),e.jsx("span",{className:"score-badge",style:{marginLeft:4,fontSize:8,padding:"1px 4px",background:D.priority==="required"?"var(--red-dim)":D.priority==="recommended"?"var(--orange-dim)":"var(--bg-inset)",color:D.priority==="required"?"var(--red)":D.priority==="recommended"?"var(--orange)":"var(--text-muted)"},children:D.priority==="required"?"wymagane":D.priority==="recommended"?"zalecane":"opcjonalne"})]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:D.description})]},de)),ne.audit_tips.length>0&&e.jsxs("div",{style:{marginTop:8,padding:6,background:"var(--bg-card-hover)",borderRadius:4,fontSize:10},children:[e.jsx("strong",{children:"Wskazwki:"}),e.jsx("ul",{style:{margin:"4px 0 0",paddingLeft:16},children:ne.audit_tips.map((D,de)=>e.jsx("li",{children:D},de))})]})]}):null})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>j(!0),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:c,children:"+ Podwze"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:s,children:"Usu"})]})]})]})}function AE({parentId:t,pointTypes:n,onClose:a,onCreate:s}){const[o,c]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(""),[x,j]=m.useState(!1),[y,S]=m.useState(null);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{className:"form-control",value:o,onChange:w=>c(w.target.value),placeholder:"Nazwa wza",autoFocus:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:u,onChange:w=>h(w.target.value),placeholder:"np. A.5.1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ punktu"}),e.jsxs("select",{className:"form-control",value:y??"",onChange:w=>S(w.target.value?Number(w.target.value):null),children:[e.jsx("option",{value:"",children:" brak "}),n.map(w=>e.jsx("option",{value:w.id,children:w.label},w.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:f,onChange:w=>p(w.target.value),rows:3})]}),e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:w=>j(w.target.checked)}),"Ocenialny (li drzewa do oceny)"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:a,children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!o.trim(),onClick:()=>s({name:o,ref_id:u,description:f,assessable:x,parent_id:t,point_type_id:y}),children:"Dodaj"})]})]})}function EE({dimensions:t}){return t.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Ten dokument nie ma zdefiniowanych wymiarw oceny."}):e.jsx("div",{style:{display:"grid",gap:12},children:t.map(n=>e.jsxs("div",{className:"card",style:{padding:"12px 16px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:n.name_pl||n.name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Klucz: ",n.dimension_key," | Waga: ",n.weight]})]})}),n.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:8},children:n.description}),n.levels.length>0&&e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:n.levels.map(a=>e.jsxs("div",{style:{padding:"4px 10px",borderRadius:6,fontSize:11,background:a.color?`${a.color}20`:"var(--bg-inset)",color:a.color??"var(--text)",border:`1px solid ${a.color??"var(--border)"}`},children:[e.jsx("strong",{children:a.value}),"  ",a.label_pl||a.label]},a.id))})]},n.id))})}function FE({fwId:t,orgUnits:n,onReload:a}){const[s,o]=m.useState(!1),[c,u]=m.useState(""),[h,f]=m.useState("not_assessed"),[p,x]=m.useState(""),[j,y]=m.useState(!1),S=async()=>{if(c){y(!0);try{await le.post(`/api/v1/frameworks/${t}/org-units`,{org_unit_id:Number(c),compliance_status:h,notes:p||null}),o(!1),u(""),x(""),a()}catch(_){alert(_ instanceof Error?_.message:"Bd dodawania")}finally{y(!1)}}},w=async _=>{if(confirm("Usun powizanie z jednostk organizacyjn?"))try{await le.delete(`/api/v1/frameworks/${t}/org-units/${_}`),a()}catch(E){alert(E instanceof Error?E.message:"Bd usuwania")}},b={not_assessed:{label:"Nieoceniony",color:"var(--text-muted)"},compliant:{label:"Zgodny",color:"var(--green)"},partially_compliant:{label:"Czciowo zgodny",color:"var(--orange)"},non_compliant:{label:"Niezgodny",color:"var(--red)"}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--text)"},children:["Powizane jednostki organizacyjne (",n.length,")"]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>o(!0),children:"+ Dodaj powizanie"})]}),n.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak powiza z jednostkami organizacyjnymi. Dodaj powizanie, aby ledzi zgodno."}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Jednostka organizacyjna"}),e.jsx("th",{children:"Status zgodnoci"}),e.jsx("th",{children:"Ostatnia ocena"}),e.jsx("th",{children:"Notatki"}),e.jsx("th",{style:{width:60}})]})}),e.jsx("tbody",{children:n.map(_=>{const E=b[_.compliance_status]??{label:_.compliance_status,color:"var(--text-muted)"};return e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:_.org_unit_name??`ID: ${_.org_unit_id}`}),e.jsx("td",{children:e.jsx("span",{style:{color:E.color,fontWeight:500,fontSize:11},children:E.label})}),e.jsx("td",{style:{fontSize:11},children:_.last_assessed_at?new Date(_.last_assessed_at).toLocaleDateString("pl-PL"):""}),e.jsx("td",{style:{fontSize:11,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:_.notes||""}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)",fontSize:10},onClick:()=>w(_.id),children:"Usu"})})]},_.id)})})]})}),e.jsx(gt,{open:s,onClose:()=>o(!1),title:"Dodaj powizanie z jednostk organizacyjn",children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID jednostki organizacyjnej *"}),e.jsx("input",{className:"form-control",type:"number",value:c,onChange:_=>u(_.target.value),placeholder:"ID jednostki",autoFocus:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status zgodnoci"}),e.jsxs("select",{className:"form-control",value:h,onChange:_=>f(_.target.value),children:[e.jsx("option",{value:"not_assessed",children:"Nieoceniony"}),e.jsx("option",{value:"compliant",children:"Zgodny"}),e.jsx("option",{value:"partially_compliant",children:"Czciowo zgodny"}),e.jsx("option",{value:"non_compliant",children:"Niezgodny"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki"}),e.jsx("textarea",{className:"form-control",value:p,onChange:_=>x(_.target.value),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!c||j,onClick:S,children:j?"Zapisywanie...":"Dodaj"})]})]})})]})}function RE({fwId:t,reviews:n,onReload:a}){const[s,o]=m.useState(!1),[c,u]=m.useState(""),[h,f]=m.useState("periodic"),[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState("completed"),[b,_]=m.useState(!1),E=async()=>{_(!0);try{await le.post(`/api/v1/frameworks/${t}/reviews`,{reviewer:c||null,review_type:h,findings:p||null,recommendations:j||null,status:S}),o(!1),u(""),x(""),y(""),a()}catch(N){alert(N instanceof Error?N.message:"Bd dodawania przegldu")}finally{_(!1)}},z={completed:{label:"Zakoczony",color:"var(--green)"},in_progress:{label:"W trakcie",color:"var(--orange)"},planned:{label:"Zaplanowany",color:"var(--blue)"}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--text)"},children:["Historia przegldw (",n.length,")"]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>o(!0),children:"+ Nowy przegld"})]}),n.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak zarejestrowanych przegldw dla tego dokumentu."}):e.jsx("div",{style:{display:"grid",gap:10},children:n.map(N=>{const O=z[N.status]??{label:N.status,color:"var(--text-muted)"};return e.jsxs("div",{className:"card",style:{padding:"12px 16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13},children:N.review_date?new Date(N.review_date).toLocaleDateString("pl-PL"):""}),e.jsx("span",{style:{color:O.color,fontSize:11,fontWeight:500},children:O.label}),e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",fontSize:9},children:N.review_type==="periodic"?"Okresowy":N.review_type==="ad_hoc"?"Ad hoc":N.review_type})]}),N.reviewer&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:N.reviewer})]}),N.findings&&e.jsxs("div",{style:{fontSize:11,marginBottom:4},children:[e.jsx("strong",{children:"Ustalenia:"})," ",N.findings]}),N.recommendations&&e.jsxs("div",{style:{fontSize:11},children:[e.jsx("strong",{children:"Rekomendacje:"})," ",N.recommendations]}),N.next_review_date&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4},children:["Nastpny przegld: ",new Date(N.next_review_date).toLocaleDateString("pl-PL")]})]},N.id)})}),e.jsx(gt,{open:s,onClose:()=>o(!1),title:"Rejestruj przegld dokumentu",children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Przegldajcy"}),e.jsx("input",{className:"form-control",value:c,onChange:N=>u(N.target.value),placeholder:"Imi i nazwisko",autoFocus:!0})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ przegldu"}),e.jsxs("select",{className:"form-control",value:h,onChange:N=>f(N.target.value),children:[e.jsx("option",{value:"periodic",children:"Okresowy"}),e.jsx("option",{value:"ad_hoc",children:"Ad hoc"}),e.jsx("option",{value:"initial",children:"Wstpny"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:S,onChange:N=>w(N.target.value),children:[e.jsx("option",{value:"completed",children:"Zakoczony"}),e.jsx("option",{value:"in_progress",children:"W trakcie"}),e.jsx("option",{value:"planned",children:"Zaplanowany"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ustalenia"}),e.jsx("textarea",{className:"form-control",value:p,onChange:N=>x(N.target.value),rows:3,placeholder:"Wyniki przegldu..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rekomendacje"}),e.jsx("textarea",{className:"form-control",value:j,onChange:N=>y(N.target.value),rows:3,placeholder:"Zalecenia..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:b,onClick:E,children:b?"Zapisywanie...":"Zarejestruj przegld"})]})]})})]})}function BE({versions:t}){return t.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak historii wersji."}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Wersja"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Opis zmian"}),e.jsx("th",{children:"Zmienione przez"}),e.jsx("th",{children:"Data"}),e.jsx("th",{style:{textAlign:"right"},children:"Wzy"}),e.jsx("th",{style:{textAlign:"right"},children:"Ocenialne"})]})}),e.jsx("tbody",{children:t.map(n=>e.jsxs("tr",{children:[e.jsxs("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:["v",n.edit_version]}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:kb(n.lifecycle_status),color:wb(n.lifecycle_status),fontSize:10},children:mu(n.lifecycle_status)})}),e.jsx("td",{style:{fontSize:11,maxWidth:300},children:n.change_summary||""}),e.jsx("td",{style:{fontSize:11},children:n.changed_by||""}),e.jsx("td",{style:{fontSize:11,whiteSpace:"nowrap"},children:n.changed_at?new Date(n.changed_at).toLocaleString("pl-PL"):""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:n.snapshot_nodes_count??""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:n.snapshot_assessable_count??""})]},n.id))})]})})})}function OE({fw:t,onSaved:n}){const[a,s]=m.useState(t.name),[o,c]=m.useState(t.ref_id||""),[u,h]=m.useState(t.description||""),[f,p]=m.useState(t.version||""),[x,j]=m.useState(t.provider||""),[y,S]=m.useState(t.published_version||""),[w,b]=m.useState(t.owner||""),[_,E]=m.useState(t.requires_review),[z,N]=m.useState(t.review_frequency_months),[O,Q]=m.useState(""),[U,L]=m.useState(!1),H=async()=>{L(!0);try{await le.put(`/api/v1/frameworks/${t.id}`,{name:a||void 0,ref_id:o||void 0,description:u||void 0,version:f||void 0,provider:x||void 0,published_version:y||void 0,owner:w||void 0,requires_review:_,review_frequency_months:z,change_summary:O||void 0}),Q(""),n()}catch(A){alert(A instanceof Error?A.message:"Bd zapisu")}finally{L(!1)}};return e.jsx("div",{className:"card",style:{padding:"16px 20px"},children:e.jsx("div",{style:{maxWidth:600},children:e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa"}),e.jsx("input",{className:"form-control",value:a,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:o,onChange:A=>c(A.target.value)})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja rdowa"}),e.jsx("input",{className:"form-control",value:f,onChange:A=>p(A.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja publikacji"}),e.jsx("input",{className:"form-control",value:y,onChange:A=>S(A.target.value),placeholder:"np. 1.0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dostawca"}),e.jsx("input",{className:"form-control",value:x,onChange:A=>j(A.target.value)})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:w,onChange:A=>b(A.target.value),placeholder:"Imi i nazwisko lub rola"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:u,onChange:A=>h(A.target.value),rows:4})]}),e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:12},children:[e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[e.jsx("input",{type:"checkbox",checked:_,onChange:A=>E(A.target.checked)}),"Wymaga okresowego przegldu"]}),_&&e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{children:"Czstotliwo przegldu (miesice)"}),e.jsx("input",{className:"form-control",type:"number",min:1,max:120,value:z,onChange:A=>N(Number(A.target.value))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis zmian (do historii wersji)"}),e.jsx("input",{className:"form-control",value:O,onChange:A=>Q(A.target.value),placeholder:"Co zostao zmienione?"})]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{className:"btn btn-primary",onClick:H,disabled:U,children:U?"Zapisywanie...":"Zapisz zmiany"})}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4},children:["Kada edycja tworzy now wersj w historii. Wersja dokumentu: ",t.display_version??`${t.major_version}.${t.minor_version}`," (edycja v",t.edit_version,")."]})]})})})}function Rv(t){const n=[],a=s=>{for(const o of s)n.push(o),a(o.children)};return a(t),n}function DE(t,n){const a=[],s=(o,c)=>{for(const u of o){const h=c||n.has(u.id);h&&a.push(u),s(u.children,h)}};return s(t,!1),a}function LE({action:t,tree:n,frameworkName:a,aiCache:s,onClose:o,onDone:c}){const[u,h]=m.useState("all"),[f,p]=m.useState(new Set),[x,j]=m.useState("pl"),[y,S]=m.useState(!0),[w,b]=m.useState(!1),[_,E]=m.useState({done:0,total:0,errors:0,skipped:0}),[z,N]=m.useState(null),O=m.useRef(!1),Q=m.useMemo(()=>Rv(n),[n]),U=m.useMemo(()=>n,[n]),L=m.useMemo(()=>u==="all"?Q:u==="chapters"?DE(n,f):Q,[u,Q,n,f]),H=m.useMemo(()=>{let W=0;for(const J of L){const M=t==="translate"?Dr(J.id,"translate",x):Dr(J.id,t);s.has(M)&&W++}return W},[L,t,x,s]),A=W=>{p(J=>{const M=new Set(J);return M.has(W)?M.delete(W):M.add(W),M})},R=async()=>{O.current=!1,b(!0);const W=L,J=W.length;let M=0,V=0,ne=0;E({done:0,total:J,errors:0,skipped:0});for(const P of W){if(O.current)break;if(y){const T=t==="translate"?Dr(P.id,"translate",x):Dr(P.id,t);if(s.has(T)){ne++,M++,E({done:M,total:J,errors:V,skipped:ne});continue}}N(P.ref_id?`${P.ref_id}  ${P.name}`:P.name);try{t==="interpret"?await le.post("/api/v1/ai/interpret-node",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,node_id:P.id,force:!y}):t==="translate"?await le.post("/api/v1/ai/translate-node",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,target_language:x,node_id:P.id,force:!y}):await le.post("/api/v1/ai/generate-evidence",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,node_id:P.id,force:!y})}catch{V++}M++,E({done:M,total:J,errors:V,skipped:ne})}N(null),b(!1)},G=()=>{O.current=!0},F=t==="interpret",q=t==="evidence",ee=F?"Interpretacja dokumentu (AI)":q?"Generowanie dowodw (AI)":"Tumaczenie dokumentu (AI)",me=_.total>0?Math.round(_.done/_.total*100):0;return e.jsx(gt,{open:!0,onClose:w?()=>{}:o,title:ee,children:e.jsx("div",{style:{minWidth:400,maxWidth:600},children:w?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[e.jsxs("span",{children:[F?"Interpretacja":q?"Generowanie dowodw":"Tumaczenie"," w toku..."]}),e.jsxs("span",{style:{fontWeight:600},children:[me,"%"]})]}),e.jsx("div",{style:{height:6,background:"var(--bg-inset)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${me}%`,background:F?"var(--blue)":"var(--purple, #8b5cf6)",borderRadius:3,transition:"width 0.3s"}})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:[_.done," / ",_.total,_.skipped>0&&e.jsxs(e.Fragment,{children:[" (pominite: ",_.skipped,")"]}),_.errors>0&&e.jsxs("span",{style:{color:"var(--red)"},children:[" | Bdy: ",_.errors]})]})]}),z&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)",padding:8,background:"var(--bg-inset)",borderRadius:6,marginBottom:12,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Przetwarzanie: ",z]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:_.done<_.total?e.jsx("button",{className:"btn",style:{color:"var(--red)"},onClick:G,children:"Zatrzymaj"}):e.jsx("button",{className:"btn btn-primary",onClick:c,children:"Zamknij"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:6},children:"Zakres"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:4,cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"scope",checked:u==="all",onChange:()=>h("all")}),"Cay dokument (",Q.length," wzw)"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:4,cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"scope",checked:u==="chapters",onChange:()=>h("chapters")}),"Wybrane rozdziay"]})]}),u==="chapters"&&e.jsx("div",{style:{maxHeight:200,overflowY:"auto",border:"1px solid var(--border)",borderRadius:6,padding:8,marginBottom:12},children:U.length===0?e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Brak rozdziaw."}):U.map(W=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:11,padding:"3px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:f.has(W.id),onChange:()=>A(W.id)}),W.ref_id&&e.jsx("span",{style:{fontFamily:"monospace",color:"var(--blue)",fontSize:10},children:W.ref_id}),W.name,e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:10},children:["(",Rv([W]).length," wzw)"]})]},W.id))}),t==="translate"&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Jzyk docelowy"}),e.jsx("select",{className:"form-control",value:x,onChange:W=>j(W.target.value),style:{fontSize:12},children:Cb.map(W=>e.jsx("option",{value:W.code,children:W.label},W.code))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:y,onChange:W=>S(W.target.checked)}),"Pomi ju przetworzone (",H," z ",L.length," w cache)"]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:12,padding:8,background:"var(--bg-inset)",borderRadius:6},children:[F?"Interpretacja":q?"Generowanie dowodw":"Tumaczenie"," obejmie ",e.jsx("strong",{children:L.length})," wzw.",y&&H>0&&e.jsxs(e.Fragment,{children:[" Z tego ",e.jsx("strong",{children:H})," zostanie pominitych (cache)."]})," ","Szacowany czas: ~",Math.max(1,Math.ceil((L.length-(y?H:0))*3/60))," min."]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:o,children:"Anuluj"}),e.jsxs("button",{className:"btn btn-primary",disabled:u==="chapters"&&f.size===0,onClick:R,children:["Rozpocznij ",F?"interpretacj":q?"generowanie":"tumaczenie"]})]})]})})})}function ME({fwId:t}){const[n,a]=m.useState(null),[s,o]=m.useState(!0),[c,u]=m.useState(!1),[h,f]=m.useState(!1),[p,x]=m.useState([]),[j,y]=m.useState([]),[S,w]=m.useState({});m.useEffect(()=>{o(!0),le.get(`/api/v1/frameworks/${t}/metrics`).then(N=>{a(N),x(N.change_history||[]),y(N.responsibilities||[]),w({implementation_date:N.implementation_date||"",implementation_method:N.implementation_method||"",verification_date:N.verification_date||"",effective_date:N.effective_date||"",distribution_responsible:N.distribution_responsible||"",distribution_date:N.distribution_date||"",distribution_list:N.distribution_list||"",notification_method:N.notification_method||"",access_level:N.access_level||"",classification:N.classification||"",additional_permissions:N.additional_permissions||"",applicable_roles:N.applicable_roles||"",management_approved:N.management_approved||""})}).catch(()=>a(null)).finally(()=>o(!1))},[t]);const b=async()=>{f(!0);try{await le.put(`/api/v1/frameworks/${t}/metrics`,{change_history:p,responsibilities:j,...S}),u(!1);const N=await le.get(`/api/v1/frameworks/${t}/metrics`);a(N)}catch(N){alert(N instanceof Error?N.message:"Bd zapisu")}finally{f(!1)}};if(s)return e.jsx("div",{className:"card",style:{padding:40,textAlign:"center"},children:"adowanie metryki..."});const _={width:"100%",borderCollapse:"collapse",fontSize:12,marginBottom:16},E={textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11,color:"var(--text-muted)",fontWeight:600},z={padding:"6px 10px",borderBottom:"1px solid var(--border)"};return e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Metryka dokumentu"}),c?e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:b,disabled:h,children:h?"...":"Zapisz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>u(!1),children:"Anuluj"})]}):e.jsx("button",{className:"btn btn-sm",onClick:()=>u(!0),children:"Edytuj"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Historia zmian dokumentu"}),e.jsxs("table",{style:_,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:E,children:"Wersja"}),e.jsx("th",{style:E,children:"Data"}),e.jsx("th",{style:E,children:"Autor"}),e.jsx("th",{style:E,children:"Opis zmiany"}),c&&e.jsx("th",{style:E})]})}),e.jsxs("tbody",{children:[p.map((N,O)=>e.jsx("tr",{children:c?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:z,children:e.jsx("input",{style:{width:50,fontSize:12},value:N.version,onChange:Q=>{const U=[...p];U[O]={...N,version:Q.target.value},x(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:90,fontSize:12},value:N.date,onChange:Q=>{const U=[...p];U[O]={...N,date:Q.target.value},x(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:120,fontSize:12},value:N.author,onChange:Q=>{const U=[...p];U[O]={...N,author:Q.target.value},x(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.description,onChange:Q=>{const U=[...p];U[O]={...N,description:Q.target.value},x(U)}})}),e.jsx("td",{style:z,children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>x(p.filter((Q,U)=>U!==O)),children:"X"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{style:z,children:N.version}),e.jsx("td",{style:z,children:N.date}),e.jsx("td",{style:z,children:N.author}),e.jsx("td",{style:z,children:N.description})]})},O)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:c?5:4,style:{...z,color:"var(--text-muted)",textAlign:"center"},children:"Brak wpisw"})})]})]}),c&&e.jsx("button",{className:"btn btn-sm",style:{marginBottom:16},onClick:()=>x([...p,{version:"",date:"",author:"",description:""}]),children:"+ Dodaj wiersz"}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Odpowiedzialnoci i akceptacje"}),e.jsxs("table",{style:_,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:E,children:"Rola"}),e.jsx("th",{style:E,children:"Imi i nazwisko"}),e.jsx("th",{style:E,children:"Stanowisko"}),e.jsx("th",{style:E,children:"Data"}),c&&e.jsx("th",{style:E})]})}),e.jsxs("tbody",{children:[j.map((N,O)=>e.jsx("tr",{children:c?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:z,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.role,onChange:Q=>{const U=[...j];U[O]={...N,role:Q.target.value},y(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.name,onChange:Q=>{const U=[...j];U[O]={...N,name:Q.target.value},y(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.title,onChange:Q=>{const U=[...j];U[O]={...N,title:Q.target.value},y(U)}})}),e.jsx("td",{style:z,children:e.jsx("input",{style:{width:90,fontSize:12},value:N.date,onChange:Q=>{const U=[...j];U[O]={...N,date:Q.target.value},y(U)}})}),e.jsx("td",{style:z,children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>y(j.filter((Q,U)=>U!==O)),children:"X"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{style:z,children:N.role}),e.jsx("td",{style:z,children:N.name}),e.jsx("td",{style:z,children:N.title}),e.jsx("td",{style:z,children:N.date})]})},O)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:c?5:4,style:{...z,color:"var(--text-muted)",textAlign:"center"},children:"Brak wpisw"})})]})]}),c&&e.jsx("button",{className:"btn btn-sm",style:{marginBottom:16},onClick:()=>y([...j,{role:"",name:"",title:"",date:""}]),children:"+ Dodaj wiersz"}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Wdroenie dokumentu"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[{key:"applicable_roles",label:"Role i obszary obowizywania"},{key:"implementation_date",label:"Data zakoczenia wdroenia"},{key:"verification_date",label:"Data weryfikacji wdroenia"},{key:"effective_date",label:"Dokument obowizuje od"},{key:"distribution_responsible",label:"Odpowiedzialny za dystrybucj"},{key:"distribution_date",label:"Data dystrybucji"},{key:"distribution_list",label:"Dystrybucja do"},{key:"notification_method",label:"Forma poinformowania"},{key:"access_level",label:"Poziom uprawnie dostpu"},{key:"additional_permissions",label:"Uprawnienia dodatkowe"},{key:"management_approved",label:"Zasady zatwierdzane przez Zarzd"}].map(N=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:2},children:N.label}),c?e.jsx("input",{className:"form-input",style:{width:"100%",fontSize:12},value:S[N.key]||"",onChange:O=>w({...S,[N.key]:O.target.value})}):e.jsx("div",{style:{fontSize:12,padding:"4px 0"},children:S[N.key]||""})]},N.key))}),!n?.exists&&!c&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:'Brak metryki dokumentu. Metryka zostanie wyodrbniona automatycznie podczas importu AI lub moesz j doda rcznie klikajc "Edytuj".'})]})}function IE({fwId:t}){const[n,a]=m.useState([]),[s,o]=m.useState(!0),[c,u]=m.useState(!1),h=m.useRef(null),f=()=>{o(!0),le.get(`/api/v1/frameworks/${t}/attachments`).then(a).catch(()=>a([])).finally(()=>o(!1))};m.useEffect(()=>{f()},[t]);const p=async S=>{u(!0);try{const w=new FormData;w.append("file",S),await fetch(`/api/v1/frameworks/${t}/attachments`,{method:"POST",body:w}),f()}catch(w){alert(w instanceof Error?w.message:"Bd uploadu")}finally{u(!1),h.current&&(h.current.value="")}},x=S=>{window.open(`/api/v1/frameworks/${t}/attachments/${S.id}/download`,"_blank")},j=async S=>{if(confirm(`Usun zacznik "${S.original_name}"?`))try{await le.delete(`/api/v1/frameworks/${t}/attachments/${S.id}`),f()}catch(w){alert(w instanceof Error?w.message:"Bd usuwania")}},y=S=>S<1024?`${S} B`:S<1024*1024?`${(S/1024).toFixed(1)} KB`:`${(S/1024/1024).toFixed(1)} MB`;return s?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center"},children:"adowanie zacznikw..."}):e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Zaczniki dokumentu"}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("input",{ref:h,type:"file",style:{display:"none"},onChange:S=>S.target.files?.[0]&&p(S.target.files[0])}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>h.current?.click(),disabled:c,children:c?"Uploading...":"+ Dodaj zacznik"})]})]}),n.length===0?e.jsx("div",{style:{padding:30,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zacznikw. Plik rdowy jest automatycznie doczany podczas importu AI."}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Nazwa pliku"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Rozmiar"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Dodano"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Opis"}),e.jsx("th",{style:{textAlign:"right",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11}})]})}),e.jsx("tbody",{children:n.map(S=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)"},children:e.jsx("span",{style:{color:"var(--blue)",cursor:"pointer"},onClick:()=>x(S),children:S.original_name})}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:y(S.file_size)}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:S.created_at?new Date(S.created_at).toLocaleString("pl"):""}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:S.description||""}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:4,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>x(S),children:"Pobierz"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>j(S),children:"Usu"})]})})]},S.id))})]})]})}function PE(t){return t==="approved"?"badge-green":t==="in_progress"?"badge-yellow":"badge-gray"}function WE(t){return t==="approved"?"Zatwierdzony":t==="in_progress"?"W trakcie":t==="draft"?"Szkic":t}function UE(t){return t==null?"var(--text-muted)":t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function Bv(){const t=on(),[n]=hc(),[a,s]=m.useState([]),[o,c]=m.useState([]),[u,h]=m.useState(!0),[f,p]=m.useState(!!n.get("framework_id")),[x,j]=m.useState([]),[y,S]=m.useState({framework_id:n.get("framework_id")??"",org_unit_id:"",title:"",assessor:"",implementation_group_filter:"",notes:""}),[w,b]=m.useState(!1);m.useEffect(()=>{Promise.all([le.get("/api/v1/assessments"),le.get("/api/v1/frameworks?is_active=true"),le.get("/api/v1/org-units/tree")]).then(([E,z,N])=>{s(E),c(z),j(N)}).catch(()=>{}).finally(()=>h(!1))},[]);const _=async()=>{if(y.framework_id){b(!0);try{const E={framework_id:Number(y.framework_id),org_unit_id:y.org_unit_id?Number(y.org_unit_id):null,title:y.title||null,assessor:y.assessor||null,implementation_group_filter:y.implementation_group_filter||null,notes:y.notes||null},z=await le.post("/api/v1/assessments",E);t(`/assessments/${z.id}`)}catch{alert("Blad tworzenia oceny")}finally{b(!1)}}};return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"toolbar-left",children:e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Oceny (Assessments)"})}),e.jsx("div",{className:"toolbar-right",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>p(E=>!E),children:f?"Anuluj":"Nowa ocena"})})]}),f&&e.jsxs("div",{className:"card",style:{padding:16,marginBottom:12},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:10},children:"Nowa ocena"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Framework *"}),e.jsxs("select",{className:"form-control",value:y.framework_id,onChange:E=>S(z=>({...z,framework_id:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Wybierz --"}),o.map(E=>e.jsxs("option",{value:E.id,children:[E.name," ",E.version?`v${E.version}`:""]},E.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Jednostka org."}),e.jsx(jn,{tree:x,value:y.org_unit_id?Number(y.org_unit_id):null,onChange:E=>S(z=>({...z,org_unit_id:E?String(E):""})),placeholder:"Cala organizacja",allowClear:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Tytul"}),e.jsx("input",{className:"form-control",value:y.title,onChange:E=>S(z=>({...z,title:E.target.value})),placeholder:"np. Ocena Q1 2026"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Oceniajacy"}),e.jsx("input",{className:"form-control",value:y.assessor,onChange:E=>S(z=>({...z,assessor:E.target.value})),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Filtr IG"}),e.jsxs("select",{className:"form-control",value:y.implementation_group_filter,onChange:E=>S(z=>({...z,implementation_group_filter:E.target.value})),children:[e.jsx("option",{value:"",children:"Wszystkie"}),e.jsx("option",{value:"IG1",children:"IG1"}),e.jsx("option",{value:"IG2",children:"IG2"}),e.jsx("option",{value:"IG3",children:"IG3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Notatki"}),e.jsx("input",{className:"form-control",value:y.notes,onChange:E=>S(z=>({...z,notes:E.target.value}))})]})]}),e.jsxs("div",{style:{marginTop:10,display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary",onClick:_,disabled:!y.framework_id||w,children:w?"Tworzenie...":"Utworz ocene"}),e.jsx("button",{className:"btn",onClick:()=>p(!1),children:"Anuluj"})]})]}),u?e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ladowanie..."}):a.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:'Brak ocen. Utworz nowa ocene klikajac "Nowa ocena".'}):e.jsx("div",{className:"card",style:{padding:0,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Jednostka"}),e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Wynik"}),e.jsx("th",{style:{textAlign:"right"},children:"Ukonczenie"})]})}),e.jsx("tbody",{children:a.map(E=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>t(`/assessments/${E.id}`),children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:E.id}),e.jsx("td",{style:{fontWeight:600},children:E.framework_name??""}),e.jsx("td",{children:E.org_unit_name??"Cala org."}),e.jsx("td",{children:E.assessment_date}),e.jsx("td",{children:e.jsx("span",{className:`badge ${PE(E.status)}`,children:WE(E.status)})}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:UE(E.overall_score)},children:E.overall_score!=null?`${E.overall_score.toFixed(1)}%`:""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace"},children:E.completion_pct!=null?`${E.completion_pct.toFixed(0)}%`:""})]},E.id))})]})})]})}function $E(){const{assessmentId:t}=Lu(),n=on(),[a,s]=m.useState(null),[o,c]=m.useState([]),[u,h]=m.useState(null),[f,p]=m.useState(null),[x,j]=m.useState(!0),[y,S]=m.useState(!1),[w,b]=m.useState("answers");m.useEffect(()=>{t&&(j(!0),le.get(`/api/v1/assessments/${t}`).then(U=>(s(U),Promise.all([le.get(`/api/v1/assessments/${t}/answers`),le.get(`/api/v1/assessments/${t}/score`),le.get(`/api/v1/frameworks/${U.framework_id}`)]))).then(([U,L,H])=>{c(U),h(L),p(H)}).catch(()=>{}).finally(()=>j(!1)))},[t]);const _=m.useMemo(()=>{const U=new Map;for(const L of o)U.has(L.framework_node_id)||U.set(L.framework_node_id,{ref_id:L.node_ref_id,name:L.node_name,answers:[]}),U.get(L.framework_node_id).answers.push(L);return Array.from(U.entries())},[o]),E=m.useMemo(()=>{if(!f)return new Map;const U=new Map;for(const L of f.dimensions)U.set(L.id,L.levels.map(H=>({id:H.id,value:H.value,label:H.label_pl||H.label})));return U},[f]),z=async(U,L,H)=>{S(!0);try{const A=new URLSearchParams;L!=null&&A.set("level_id",String(L)),A.set("not_applicable",String(H));const R=await le.patch(`/api/v1/assessments/${t}/answers/${U}?${A.toString()}`,{});c(G=>G.map(F=>F.id===U?{...F,level_id:L,not_applicable:H}:F)),u&&h({...u,overall_score:R.overall_score,completion_pct:R.completion_pct}),a&&s({...a,overall_score:R.overall_score,completion_pct:R.completion_pct})}catch{}finally{S(!1)}},N=async()=>{if(!t||!confirm("Zatwierdzic ocene?"))return;const U=await le.post(`/api/v1/assessments/${t}/approve?approved_by=CISO`,{});s(U)};if(x)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ladowanie oceny..."});if(!a)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ocena nie znaleziona"});const O=a.completion_pct??0,Q=a.overall_score;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>n("/assessments"),style:{marginRight:8},children:" Wstecz"}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a.title||a.ref_id||`Ocena #${a.id}`}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[a.framework_name," | ",a.assessment_date,a.org_unit_name&&` | ${a.org_unit_name}`,a.assessor&&` | ${a.assessor}`]})]})]}),e.jsxs("div",{className:"toolbar-right",style:{display:"flex",gap:16,alignItems:"center"},children:[y&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zapisywanie..."}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:"Ukonczenie"}),e.jsxs("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:O>=100?"var(--green)":"var(--yellow)"},children:[O.toFixed(0),"%"]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:"Wynik"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Q!=null?Q>=75?"var(--green)":Q>=50?"var(--yellow)":"var(--red)":"var(--text-muted)"},children:Q!=null?`${Q.toFixed(1)}%`:""})]}),a.status!=="approved"&&e.jsx("button",{className:"btn btn-primary",onClick:N,children:"Zatwierdz"}),a.status==="approved"&&e.jsx("span",{className:"badge badge-green",style:{fontSize:12,padding:"4px 12px"},children:"Zatwierdzony"})]})]}),e.jsx("div",{className:"card",style:{padding:"8px 12px",marginBottom:12},children:e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${O}%`,height:8,background:O>=100?"var(--green)":"var(--blue)"}})})}),e.jsxs("div",{style:{display:"flex",gap:4,marginBottom:12},children:[e.jsxs("button",{className:`btn btn-sm ${w==="answers"?"btn-primary":""}`,onClick:()=>b("answers"),children:["Formularz odpowiedzi (",o.length,")"]}),e.jsx("button",{className:`btn btn-sm ${w==="scores"?"btn-primary":""}`,onClick:()=>b("scores"),children:"Wyniki"})]}),w==="answers"&&e.jsx("div",{style:{display:"grid",gap:10},children:_.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Brak pytan do oceny."}):_.map(([U,L])=>e.jsxs("div",{className:"card",style:{padding:"10px 14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[L.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--blue)",fontWeight:600},children:L.ref_id}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:L.name})]}),L.answers.map(H=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"4px 0",borderTop:"1px solid rgba(42,53,84,0.08)",fontSize:12},children:[e.jsx("span",{style:{width:100,flexShrink:0,fontSize:10,color:"var(--text-muted)"},children:H.dimension_key}),e.jsxs("select",{className:"form-control",style:{flex:1,maxWidth:300},value:H.not_applicable?"NA":H.level_id??"",onChange:A=>{const R=A.target.value;R==="NA"?z(H.id,null,!0):R===""?z(H.id,null,!1):z(H.id,Number(R),!1)},disabled:a.status==="approved",children:[e.jsx("option",{value:"",children:"-- Wybierz --"}),(E.get(H.dimension_id)??[]).map(A=>e.jsxs("option",{value:A.id,children:[A.value,"  ",A.label]},A.id)),e.jsx("option",{value:"NA",children:"N/A (nie dotyczy)"})]}),H.level_label&&!H.not_applicable&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:H.level_label}),H.not_applicable&&e.jsx("span",{className:"badge badge-gray",style:{fontSize:9},children:"N/A"})]},H.id))]},U))}),w==="scores"&&u&&e.jsx(HE,{score:u,dimensions:f?.dimensions??[]})]})}function HE({score:t,dimensions:n}){return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:10,marginBottom:14},children:[e.jsx(Ro,{label:"Wynik ogolny",value:t.overall_score!=null?`${t.overall_score.toFixed(1)}%`:"",color:t.overall_score!=null&&t.overall_score>=75?"var(--green)":"var(--yellow)"}),e.jsx(Ro,{label:"Ukonczenie",value:`${(t.completion_pct??0).toFixed(0)}%`,color:"var(--blue)"}),e.jsx(Ro,{label:"Ocenialne",value:String(t.total_assessable),color:"var(--text-primary)"}),e.jsx(Ro,{label:"Odpowiedziane",value:String(t.answered_count),color:"var(--cyan)"}),e.jsx(Ro,{label:"N/A",value:String(t.na_count),color:"var(--text-muted)"})]}),Object.keys(t.dimension_averages).length>0&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:"Srednie wymiarow"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:8},children:Object.entries(t.dimension_averages).map(([a,s])=>{const o=n.find(c=>c.dimension_key===a);return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[e.jsx("span",{style:{fontSize:12},children:o?.name_pl||o?.name||a}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,fontSize:13,color:s!=null&&s>=75?"var(--green)":s!=null&&s>=50?"var(--yellow)":"var(--red)"},children:s!=null?`${s.toFixed(1)}%`:""})]},a)})})]}),Object.keys(t.ig_scores).length>0&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:"Wyniki wg Implementation Groups"}),e.jsx("div",{style:{display:"flex",gap:16},children:Object.entries(t.ig_scores).map(([a,s])=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:a}),e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:s!=null&&s>=75?"var(--green)":"var(--yellow)"},children:s!=null?`${s.toFixed(1)}%`:""})]},a))})]}),t.node_scores.length>0&&e.jsx("div",{className:"card",style:{padding:0,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Kontrola"}),e.jsx("th",{style:{textAlign:"right"},children:"Wynik"}),n.map(a=>e.jsx("th",{style:{textAlign:"right",fontSize:10},children:a.dimension_key},a.id)),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.node_scores.map(a=>e.jsxs("tr",{style:{opacity:a.not_applicable?.5:1},children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--blue)"},children:a.ref_id}),e.jsx("td",{style:{fontSize:12},children:a.name}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:a.score!=null?`${a.score.toFixed(1)}%`:""}),n.map(s=>e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:a.dimension_scores[s.dimension_key]!=null?`${a.dimension_scores[s.dimension_key].toFixed(0)}%`:""},s.id)),e.jsx("td",{children:a.not_applicable?e.jsx("span",{className:"badge badge-gray",style:{fontSize:9},children:"N/A"}):null})]},a.framework_node_id))})]})})]})}function Ro({label:t,value:n,color:a}){return e.jsxs("div",{className:"card",style:{padding:"10px 14px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:t}),e.jsx("div",{style:{fontSize:22,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a},children:n})]})}const Bo="";function Yd(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("krytyczny")||n.includes("critical")?"var(--red)":n.includes("wysoki")||n.includes("high")?"var(--orange)":n.includes("redni")||n.includes("medium")||n.includes("sredni")?"var(--yellow)":n.includes("niski")||n.includes("low")?"var(--green)":"var(--text-muted)"}function Ov(t){if(!t)return"transparent";const n=t.toLowerCase();return n.includes("krytyczny")||n.includes("critical")?"var(--red-dim)":n.includes("wysoki")||n.includes("high")?"var(--orange-dim)":n.includes("redni")||n.includes("medium")||n.includes("sredni")?"var(--yellow-dim)":n.includes("niski")||n.includes("low")?"var(--green-dim)":"transparent"}function VE(t){if(!t)return!1;const n=t.toLowerCase();return n.includes("krytyczny")||n.includes("critical")||n.includes("wysoki")||n.includes("high")}function _r({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function hs({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}const ZE="1px solid var(--red)",GE="0 0 0 3px var(--red-dim)",ym=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytu",format:t=>t.title},{key:"severity_name",header:"Wano",format:t=>t.severity_name??""},{key:"cvss_score",header:"CVSS",format:t=>t.cvss_score??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"cve_id",header:"CVE",format:t=>t.cve_id??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"owner",header:"Waciciel",format:t=>t.owner??""},{key:"detected_at",header:"Wykryto",format:t=>t.detected_at?.slice(0,10)??""},{key:"sla_deadline",header:"SLA",format:t=>t.sla_deadline?.slice(0,10)??""},{key:"source_name",header:"rdo",format:t=>t.source_name??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo",format:t=>t.asset_name??"",defaultVisible:!1},{key:"category_name",header:"Kategoria",format:t=>t.category_name??"",defaultVisible:!1},{key:"remediation_priority_name",header:"Priorytet naprawy",format:t=>t.remediation_priority_name??"",defaultVisible:!1},{key:"cvss_vector",header:"Wektor CVSS",format:t=>t.cvss_vector??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:t=>t.closed_at?.slice(0,10)??"",defaultVisible:!1},{key:"created_by",header:"Utworzy",format:t=>t.created_by??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1}];function KE(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[z,N]=m.useState([]),[O,Q]=m.useState([]),[U,L]=m.useState([]),[H,A]=m.useState([]),{visible:R,toggle:G}=da(ym,"vulns"),[F,q]=m.useState(!1),ee=Aa({data:t,storageKey:"vulns",defaultSort:"detected_at",defaultSortDir:"desc"}),[me,W]=m.useState({title:"",description:"",source_id:null,org_unit_id:null,category_id:null,severity_id:null,cvss_score:null,cve_id:"",status_id:null,remediation_priority_id:null,owner:"",detected_at:new Date().toISOString().slice(0,10),sla_deadline:"",created_by:""}),J=()=>{W({title:"",description:"",source_id:null,org_unit_id:null,category_id:null,severity_id:null,cvss_score:null,cve_id:"",status_id:null,remediation_priority_id:null,owner:"",detected_at:new Date().toISOString().slice(0,10),sla_deadline:"",created_by:""}),S(!1)};m.useEffect(()=>{M()},[]);async function M(){s(!0),c(null);try{const[k,I]=await Promise.all([fetch(`${Bo}/api/v1/vulnerabilities`),fetch(`${Bo}/api/v1/org-units/tree`)]);k.ok?n(await k.json()):c(`API ${k.status}`),I.ok&&b(await I.json());for(const[D,de]of[["severity_universal",E],["vuln_status",N],["vuln_source",Q],["vuln_category",L],["remediation_priority",A]]){const he=await fetch(`${Bo}/api/v1/dictionaries/by-code/${D}`);if(he.ok){const ie=await he.json();de(ie.entries??[])}}}catch(k){c(String(k))}s(!1)}async function V(){if(S(!0),!(!me.title||!me.org_unit_id||!me.owner||!me.detected_at)){j(!0);try{const k={...me,cvss_score:me.cvss_score||null,cve_id:me.cve_id||null,sla_deadline:me.sla_deadline||null,created_by:me.created_by||null},I=await fetch(`${Bo}/api/v1/vulnerabilities`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});I.ok?(h(!1),J(),M()):alert("Blad zapisu: "+await I.text())}catch(k){alert("Blad: "+k)}j(!1)}}async function ne(k){confirm("Archiwizowac podatnosc?")&&(await fetch(`${Bo}/api/v1/vulnerabilities/${k}`,{method:"DELETE"}),f?.id===k&&p(null),M())}const P=m.useMemo(()=>{const k=de=>de.filter(he=>VE(he.severity_name)).length,I=de=>de.filter(he=>!he.closed_at).length,D=de=>{const he=de.filter(ie=>ie.cvss_score!=null);return he.length===0?"":(he.reduce((ie,ve)=>ie+(ve.cvss_score??0),0)/he.length).toFixed(1)};return[{label:"Podatnoci",value:ee.filteredCount,total:ee.totalCount,color:"var(--blue)"},{label:"Krytycznych / Wysokich",value:k(ee.filtered),total:k(t),color:k(ee.filtered)>0?"var(--red)":"var(--green)"},{label:"Otwartych",value:I(ee.filtered),total:I(t),color:I(ee.filtered)>0?"var(--orange)":"var(--green)"},{label:"redni CVSS",value:D(ee.filtered),total:D(t),color:"var(--purple)"}]},[t,ee.filtered,ee.filteredCount,ee.totalCount]),T=k=>y&&!k?{border:ZE,boxShadow:GE}:{},C=ee.filteredCount!==ee.totalCount;return e.jsxs("div",{children:[e.jsx(Ia,{cards:P,isFiltered:C}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"podatnosci",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj (tytul, CVE, ref)...",showFilters:F,onToggleFilters:()=>q(k=>!k),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:ym,visibleColumns:R,onToggleColumn:G,data:ee.filtered,exportFilename:"podatnosci",primaryLabel:"Nowa podatnosc",onPrimaryAction:()=>{J(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:ym,visibleColumns:R,data:ee.pageData,rowKey:k=>k.id,selectedKey:f?.id??null,onRowClick:k=>p(f?.id===k.id?null:k),rowBorderColor:k=>Yd(k.severity_name),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,showFilters:F,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,loading:a,emptyMessage:"Brak podatnosci w systemie.",emptyFilteredMessage:"Brak podatnosci pasujacych do filtrow.",renderCell:(k,I)=>{if(I==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:k.ref_id});if(I==="title")return e.jsx("span",{style:{fontWeight:500},children:k.title});if(I==="severity_name")return k.severity_name?e.jsx("span",{className:"score-badge",style:{background:Ov(k.severity_name),color:Yd(k.severity_name)},children:k.severity_name}):"";if(I==="cvss_score")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:k.cvss_score!=null?k.cvss_score.toFixed(1):""});if(I==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:k.status_name??""});if(I==="cve_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:k.cve_id??""});if(I==="sla_deadline"){const D=k.sla_deadline&&new Date(k.sla_deadline)<new Date;return e.jsxs("span",{style:{fontSize:12,color:D?"var(--red)":void 0,fontWeight:D?600:void 0},children:[k.sla_deadline?.slice(0,10)??"",D?" !":""]})}}}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Podatnosci"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.severity_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("span",{className:"score-badge",style:{background:Ov(f.severity_name),color:Yd(f.severity_name),fontSize:14,padding:"6px 16px"},children:f.severity_name}),f.cvss_score!=null&&e.jsxs("div",{style:{marginTop:4,fontSize:20,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Yd(f.severity_name)},children:["CVSS ",f.cvss_score.toFixed(1)]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(hs,{number:"",label:"Dane podatnosci"}),e.jsx(_r,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(_r,{label:"Tytul",value:e.jsx("strong",{children:f.title})}),e.jsx(_r,{label:"CVE",value:f.cve_id}),e.jsx(_r,{label:"Kategoria",value:f.category_name}),e.jsx(_r,{label:"Zrodlo",value:f.source_name}),e.jsx(hs,{number:"",label:"Przypisanie"}),e.jsx(_r,{label:"Jednostka",value:f.org_unit_name}),e.jsx(_r,{label:"Wlasciciel",value:f.owner}),e.jsx(_r,{label:"Priorytet",value:f.remediation_priority_name}),e.jsx(hs,{number:"",label:"Status i daty"}),e.jsx(_r,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(_r,{label:"Wykryto",value:f.detected_at}),e.jsx(_r,{label:"SLA",value:f.sla_deadline,color:f.sla_deadline&&new Date(f.sla_deadline)<new Date?"var(--red)":void 0}),f.description&&e.jsxs(e.Fragment,{children:[e.jsx(hs,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:f.description})]})]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{ne(f.id),p(null)},children:"Archiwizuj"})})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowa podatnosc",wide:!0,children:[e.jsx(hs,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:T(!!me.title),value:me.title,onChange:k=>W({...me,title:k.target.value}),placeholder:"Nazwa podatnosci"}),y&&!me.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org. *"}),e.jsx(jn,{tree:w,value:me.org_unit_id,onChange:k=>W({...me,org_unit_id:k}),placeholder:"-- wybierz --",allowClear:!1,style:T(!!me.org_unit_id)}),y&&!me.org_unit_id&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel remediacji *"}),e.jsx("input",{className:"form-control",style:T(!!me.owner),value:me.owner,onChange:k=>W({...me,owner:k.target.value})}),y&&!me.owner&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data wykrycia *"}),e.jsx("input",{className:"form-control",type:"date",style:T(!!me.detected_at),value:me.detected_at,onChange:k=>W({...me,detected_at:k.target.value})}),y&&!me.detected_at&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]})]}),e.jsx(hs,{number:"",label:"Klasyfikacja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zrodlo"}),e.jsxs("select",{className:"form-control",value:me.source_id??"",onChange:k=>W({...me,source_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:me.category_id??"",onChange:k=>W({...me,category_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),U.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waznosc"}),e.jsxs("select",{className:"form-control",value:me.severity_id??"",onChange:k=>W({...me,severity_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),_.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"CVSS"}),e.jsx("input",{className:"form-control",type:"number",step:"0.1",min:"0",max:"10",value:me.cvss_score??"",onChange:k=>W({...me,cvss_score:k.target.value?Number(k.target.value):null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"CVE ID"}),e.jsx("input",{className:"form-control",value:me.cve_id,onChange:k=>W({...me,cve_id:k.target.value}),placeholder:"CVE-20XX-XXXXX"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:me.status_id??"",onChange:k=>W({...me,status_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),z.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priorytet"}),e.jsxs("select",{className:"form-control",value:me.remediation_priority_id??"",onChange:k=>W({...me,remediation_priority_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),H.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin SLA"}),e.jsx("input",{className:"form-control",type:"date",value:me.sla_deadline,onChange:k=>W({...me,sla_deadline:k.target.value})})]})]}),e.jsx(hs,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:me.description,onChange:k=>W({...me,description:k.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:V,children:x?"Zapisywanie...":"Zapisz podatnosc"})]})]})]})}const Oo="";function vm(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("krytyczny")||n.includes("critical")?"var(--red)":n.includes("wysoki")||n.includes("high")?"var(--orange)":n.includes("redni")||n.includes("medium")||n.includes("sredni")?"var(--yellow)":n.includes("niski")||n.includes("low")?"var(--green)":"var(--text-muted)"}function Dv(t){if(!t)return"transparent";const n=t.toLowerCase();return n.includes("krytyczny")||n.includes("critical")?"var(--red-dim)":n.includes("wysoki")||n.includes("high")?"var(--orange-dim)":n.includes("redni")||n.includes("medium")||n.includes("sredni")?"var(--yellow-dim)":n.includes("niski")||n.includes("low")?"var(--green-dim)":"transparent"}function Ho(t){return t===null?"":t<60?`${t}m`:t<1440?`${Math.round(t/60)}h`:`${Math.round(t/1440)}d`}function Pi({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}function Tn({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}const qE="1px solid var(--red)",YE="0 0 0 3px var(--red-dim)",jm=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytu",format:t=>t.title},{key:"category_name",header:"Kategoria",format:t=>t.category_name??""},{key:"severity_name",header:"Wano",format:t=>t.severity_name??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"assigned_to",header:"Przypisany",format:t=>t.assigned_to??""},{key:"reported_at",header:"Zgoszono",format:t=>t.reported_at?.slice(0,16).replace("T"," ")??""},{key:"ttr_minutes",header:"TTR",format:t=>Ho(t.ttr_minutes)},{key:"personal_data_breach",header:"RODO",format:t=>t.personal_data_breach?"TAK":"NIE"},{key:"asset_name",header:"Aktywo",format:t=>t.asset_name??"",defaultVisible:!1},{key:"reported_by",header:"Zgosi",format:t=>t.reported_by??"",defaultVisible:!1},{key:"impact_name",header:"Wpyw",format:t=>t.impact_name??"",defaultVisible:!1},{key:"detected_at",header:"Wykryto",format:t=>t.detected_at?.slice(0,16).replace("T"," ")??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:t=>t.closed_at?.slice(0,16).replace("T"," ")??"",defaultVisible:!1},{key:"authority_notification",header:"Powiad. organ",format:t=>t.authority_notification?"TAK":"NIE",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1}];function JE(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[z,N]=m.useState([]),[O,Q]=m.useState([]),[U,L]=m.useState([]),{visible:H,toggle:A}=da(jm,"incidents"),[R,G]=m.useState(!1),F=Aa({data:t,storageKey:"incidents",defaultSort:"reported_at",defaultSortDir:"desc"}),[q,ee]=m.useState({title:"",description:"",category_id:null,severity_id:null,org_unit_id:null,reported_by:"",assigned_to:"",status_id:null,reported_at:new Date().toISOString().slice(0,16),impact_id:null,personal_data_breach:!1,authority_notification:!1}),me=()=>{ee({title:"",description:"",category_id:null,severity_id:null,org_unit_id:null,reported_by:"",assigned_to:"",status_id:null,reported_at:new Date().toISOString().slice(0,16),impact_id:null,personal_data_breach:!1,authority_notification:!1}),S(!1)};m.useEffect(()=>{W()},[]);async function W(){s(!0),c(null);try{const[T,C]=await Promise.all([fetch(`${Oo}/api/v1/incidents`),fetch(`${Oo}/api/v1/org-units/tree`)]);T.ok?n(await T.json()):c(`API ${T.status}`),C.ok&&b(await C.json());for(const[k,I]of[["severity_universal",E],["incident_status",N],["incident_category",Q],["incident_impact",L]]){const D=await fetch(`${Oo}/api/v1/dictionaries/by-code/${k}`);if(D.ok){const de=await D.json();I(de.entries??[])}}}catch(T){c(String(T))}s(!1)}async function J(){if(S(!0),!(!q.title||!q.org_unit_id||!q.reported_by||!q.assigned_to||!q.description||!q.reported_at)){j(!0);try{const T={...q,reported_at:new Date(q.reported_at).toISOString()},C=await fetch(`${Oo}/api/v1/incidents`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});C.ok?(h(!1),me(),W()):alert("Blad zapisu: "+await C.text())}catch(T){alert("Blad: "+T)}j(!1)}}async function M(T){confirm("Archiwizowac incydent?")&&(await fetch(`${Oo}/api/v1/incidents/${T}`,{method:"DELETE"}),f?.id===T&&p(null),W())}const V=m.useMemo(()=>{const T=t.length,C=t.filter(_e=>{const Se=(_e.severity_name??"").toLowerCase();return Se.includes("krytyczny")||Se.includes("critical")||Se.includes("wysoki")||Se.includes("high")}).length,k=t.filter(_e=>_e.personal_data_breach).length,I=t.filter(_e=>_e.ttr_minutes!=null),D=I.length>0?Ho(Math.round(I.reduce((_e,Se)=>_e+(Se.ttr_minutes??0),0)/I.length)):"",de=F.filtered,he=de.length,ie=de.filter(_e=>{const Se=(_e.severity_name??"").toLowerCase();return Se.includes("krytyczny")||Se.includes("critical")||Se.includes("wysoki")||Se.includes("high")}).length,ve=de.filter(_e=>_e.personal_data_breach).length,je=de.filter(_e=>_e.ttr_minutes!=null),fe=je.length>0?Ho(Math.round(je.reduce((_e,Se)=>_e+(Se.ttr_minutes??0),0)/je.length)):"";return[{label:"Aktywnych incydentw",value:he,total:T,color:"var(--blue)"},{label:"Krytycznych / Wysokich",value:ie,total:C,color:C>0?"var(--red)":"var(--green)"},{label:"Narusze RODO",value:ve,total:k,color:k>0?"var(--red)":"var(--green)"},{label:"redni TTR",value:fe,total:D,color:"var(--purple)"}]},[t,F.filtered]),ne=T=>y&&!T?{border:qE,boxShadow:YE}:{},P=(T,C)=>{if(C==="severity_name")return T.severity_name?e.jsx("span",{className:"score-badge",style:{background:Dv(T.severity_name),color:vm(T.severity_name)},children:T.severity_name}):"";if(C==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:T.status_name??""});if(C==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.ref_id});if(C==="title")return e.jsx("span",{style:{fontWeight:500},children:T.title});if(C==="ttr_minutes")return e.jsx("span",{style:{fontSize:12,fontFamily:"'JetBrains Mono',monospace"},children:Ho(T.ttr_minutes)});if(C==="personal_data_breach")return T.personal_data_breach?e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"TAK"}):""};return e.jsxs("div",{children:[e.jsx(Ia,{cards:V,isFiltered:F.hasActiveFilters||!!F.search}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:F.filteredCount,totalCount:F.totalCount,unitLabel:"incydentw",search:F.search,onSearchChange:F.setSearch,searchPlaceholder:"Szukaj (tytu, ref, osoba)...",showFilters:R,onToggleFilters:()=>G(T=>!T),hasActiveFilters:F.hasActiveFilters,onClearFilters:F.clearAllFilters,columns:jm,visibleColumns:H,onToggleColumn:A,data:F.filtered,exportFilename:"incydenty",primaryLabel:"Nowy incydent",onPrimaryAction:()=>{me(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:jm,visibleColumns:H,data:F.pageData,renderCell:P,onRowClick:T=>p(f?.id===T.id?null:T),rowKey:T=>T.id,selectedKey:f?.id??null,rowBorderColor:T=>T.severity_name?vm(T.severity_name):void 0,sortField:F.sortField,sortDir:F.sortDir,onSort:F.toggleSort,columnFilters:F.columnFilters,onColumnFilter:F.setColumnFilter,showFilters:R,page:F.page,totalPages:F.totalPages,pageSize:F.pageSize,totalItems:F.totalCount,filteredItems:F.filteredCount,onPageChange:F.setPage,onPageSizeChange:F.setPageSize,loading:a,emptyMessage:"Brak incydentw w systemie.",emptyFilteredMessage:"Brak incydentw pasujcych do filtrw."}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Incydentu"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.severity_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Waznosc"}),e.jsx("span",{className:"score-badge",style:{background:Dv(f.severity_name),color:vm(f.severity_name),fontSize:14,padding:"6px 16px"},children:f.severity_name})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Pi,{number:"",label:"Dane incydentu"}),e.jsx(Tn,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(Tn,{label:"Tytul",value:e.jsx("strong",{children:f.title})}),e.jsx(Tn,{label:"Kategoria",value:f.category_name}),e.jsx(Tn,{label:"Jednostka",value:f.org_unit_name}),e.jsx(Tn,{label:"Zglaszajacy",value:f.reported_by}),e.jsx(Tn,{label:"Przypisany",value:f.assigned_to}),e.jsx(Pi,{number:"",label:"Status i wplyw"}),e.jsx(Tn,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(Tn,{label:"Wplyw",value:f.impact_name}),e.jsx(Tn,{label:"TTR",value:Ho(f.ttr_minutes)}),e.jsx(Tn,{label:"RODO",value:f.personal_data_breach?e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"TAK"}):"NIE"}),e.jsx(Tn,{label:"UODO/CERT",value:f.authority_notification?e.jsx("span",{style:{color:"var(--orange)",fontWeight:600},children:"TAK"}):"NIE"}),e.jsx(Pi,{number:"",label:"Daty"}),e.jsx(Tn,{label:"Zgloszono",value:f.reported_at?.slice(0,16).replace("T"," ")}),f.detected_at&&e.jsx(Tn,{label:"Wykryto",value:f.detected_at.slice(0,16).replace("T"," ")}),f.closed_at&&e.jsx(Tn,{label:"Zamknieto",value:f.closed_at.slice(0,16).replace("T"," ")}),f.description&&e.jsxs(e.Fragment,{children:[e.jsx(Pi,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:f.description})]})]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{M(f.id),p(null)},children:"Archiwizuj"})})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy incydent bezpieczenstwa",wide:!0,children:[e.jsx(Pi,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul incydentu *"}),e.jsx("input",{className:"form-control",style:ne(!!q.title),value:q.title,onChange:T=>ee({...q,title:T.target.value}),placeholder:"Krotki opis incydentu"}),y&&!q.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:w,value:q.org_unit_id,onChange:T=>ee({...q,org_unit_id:T}),placeholder:"Wybierz...",allowClear:!1,style:ne(!!q.org_unit_id)}),y&&!q.org_unit_id&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:q.category_id??"",onChange:T=>ee({...q,category_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),O.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zglaszajacy *"}),e.jsx("input",{className:"form-control",style:ne(!!q.reported_by),value:q.reported_by,onChange:T=>ee({...q,reported_by:T.target.value}),placeholder:"Imie i nazwisko"}),y&&!q.reported_by&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Przypisany do *"}),e.jsx("input",{className:"form-control",style:ne(!!q.assigned_to),value:q.assigned_to,onChange:T=>ee({...q,assigned_to:T.target.value}),placeholder:"Imie i nazwisko"}),y&&!q.assigned_to&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]})]}),e.jsx(Pi,{number:"",label:"Klasyfikacja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waznosc"}),e.jsxs("select",{className:"form-control",value:q.severity_id??"",onChange:T=>ee({...q,severity_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),_.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:q.status_id??"",onChange:T=>ee({...q,status_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),z.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wplyw"}),e.jsxs("select",{className:"form-control",value:q.impact_id??"",onChange:T=>ee({...q,impact_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),U.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]})]}),e.jsx(Pi,{number:"",label:"Data i RODO"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data zgloszenia *"}),e.jsx("input",{className:"form-control",type:"datetime-local",style:ne(!!q.reported_at),value:q.reported_at,onChange:T=>ee({...q,reported_at:T.target.value})}),y&&!q.reported_at&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",style:{display:"flex",gap:20,alignItems:"flex-end",paddingBottom:16},children:[e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:q.personal_data_breach,onChange:T=>ee({...q,personal_data_breach:T.target.checked}),style:{width:16,height:16,accentColor:"var(--red)"}}),e.jsx("span",{style:{fontSize:12,color:q.personal_data_breach?"var(--red)":"var(--text-secondary)",fontWeight:q.personal_data_breach?600:400},children:"RODO"})]}),e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:q.authority_notification,onChange:T=>ee({...q,authority_notification:T.target.checked}),style:{width:16,height:16,accentColor:"var(--orange)"}}),e.jsx("span",{style:{fontSize:12,color:q.authority_notification?"var(--orange)":"var(--text-secondary)",fontWeight:q.authority_notification?600:400},children:"Zgloszenie UODO/CERT"})]})]})]}),e.jsx(Pi,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis incydentu *"}),e.jsx("textarea",{className:"form-control",rows:3,style:ne(!!q.description),value:q.description,onChange:T=>ee({...q,description:T.target.value}),placeholder:"Szczegolowy opis incydentu, okolicznosci, przebieg..."}),y&&!q.description&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:J,children:x?"Zapisywanie...":"Zapisz incydent"})]})]})]})}function ti(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function Jo(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function Bu(t){return t>=221?"Wysokie":t>=31?"Srednie":"Niskie"}function Un({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}function Sa({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}const Lv="1px solid var(--red)",Mv="0 0 0 3px var(--red-dim)";function XE(){const t=[{key:"ref_id",header:"Ref",format:M=>M.ref_id??""},{key:"title",header:"Tytu"},{key:"policy_title",header:"Polityka",format:M=>M.policy_title??""},{key:"org_unit_name",header:"Pion",format:M=>M.org_unit_name??""},{key:"risk_score",header:"Ryzyko odst.",format:M=>M.risk_score!=null?Number(M.risk_score).toFixed(1):""},{key:"status_name",header:"Status",format:M=>M.status_name??""},{key:"expiry_date",header:"Wygasa"},{key:"category_name",header:"Kategoria",format:M=>M.category_name??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo",format:M=>M.asset_name??"",defaultVisible:!1},{key:"requested_by",header:"Wnioskujcy",format:M=>M.requested_by??"",defaultVisible:!1},{key:"approved_by",header:"Zatwierdzajcy",format:M=>M.approved_by??"",defaultVisible:!1},{key:"risk_level_name",header:"Poziom ryzyka",format:M=>M.risk_level_name??"",defaultVisible:!1},{key:"compensating_controls",header:"Kontrole kompensujce",format:M=>M.compensating_controls??"",defaultVisible:!1},{key:"start_date",header:"Data rozpoczcia",format:M=>M.start_date??"",defaultVisible:!1},{key:"review_date",header:"Data przegldu",format:M=>M.review_date??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:M=>M.closed_at??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:M=>M.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"exceptions"),[s,o]=m.useState([]),[c,u]=m.useState(!0),[h,f]=m.useState(!1),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(null),[b,_]=m.useState(null),[E,z]=m.useState([]),[N,O]=m.useState(!1),Q=Aa({data:s,storageKey:"exceptions",defaultSort:"expiry_date",defaultSortDir:"asc"}),U=()=>{le.get("/api/v1/exceptions").then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(()=>{U(),le.get("/api/v1/org-units/tree").then(z).catch(()=>{})},[]);const L=m.useMemo(()=>Tl(E),[E]),H=async()=>{if(j)return j;const[M,V,ne,P,T,C]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/policies").catch(()=>[]),le.get("/api/v1/domains").catch(()=>[]),le.get("/api/v1/threat-catalog").catch(()=>[]),le.get("/api/v1/weakness-catalog").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),k=V.map(fe=>({id:fe.id,title:fe.title})),I=async fe=>{try{return(await le.get(`/api/v1/dictionaries/${fe}/entries`)).entries.filter(Se=>Se.is_active).map(Se=>({id:Se.id,label:Se.label}))}catch{return[]}},[D,de,he,ie]=await Promise.all([I("exception_category"),I("exception_status"),I("risk_level"),I("risk_strategy")]),ve=C.map(fe=>({id:fe.id,name:fe.name,org_unit_id:fe.org_unit_id,org_unit_name:fe.org_unit_name})),je={orgUnits:M,policies:k,categories:D,statuses:de,riskLevels:he,areas:ne,threats:P,vulns:T,strategies:ie,assets:ve};return y(je),je},A=async()=>{await H(),_(null),f(!0)},R=async M=>{await H(),_(M),f(!0)},G=new Date,F=M=>{if(!M)return!1;const V=(new Date(M).getTime()-G.getTime())/864e5;return V>=0&&V<=30},q=M=>M?new Date(M)<G:!1,ee=j?D1(j.orgUnits):[],me=j?.orgUnits??[],W=Q.filteredCount!==Q.totalCount,J=m.useMemo(()=>{const M=Q.filtered,V=s.filter(I=>I.is_active).length,ne=M.filter(I=>I.is_active).length,P=M.filter(I=>F(I.expiry_date)).length,T=s.filter(I=>F(I.expiry_date)).length,C=M.length>0?M.reduce((I,D)=>I+(D.risk_score??0),0)/M.length:0,k=s.length>0?s.reduce((I,D)=>I+(D.risk_score??0),0)/s.length:0;return[{label:"Wszystkich wyjtkw",value:M.length,total:s.length,color:"var(--blue)"},{label:"Aktywnych",value:ne,total:V,color:"var(--green)"},{label:"Wygasajcych",value:P,total:T,color:"var(--orange)"},{label:"r. ryzyko odst.",value:C.toFixed(1),total:k.toFixed(1),color:"var(--red)"}]},[Q.filtered,s]);return e.jsxs("div",{children:[e.jsx(Ia,{cards:J,isFiltered:W}),e.jsx(ma,{filteredCount:Q.filteredCount,totalCount:Q.totalCount,unitLabel:"wyjtkw",search:Q.search,onSearchChange:Q.setSearch,searchPlaceholder:"Szukaj wyjtkw...",showFilters:N,onToggleFilters:()=>O(M=>!M),hasActiveFilters:Q.hasActiveFilters,onClearFilters:Q.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:Q.filtered,exportFilename:"wyjatki",primaryLabel:"Nowy wyjtek",onPrimaryAction:A}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:S?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:Q.pageData,rowKey:M=>M.id,selectedKey:S?.id??null,onRowClick:M=>w(S?.id===M.id?null:M),rowBorderColor:M=>M.risk_score!=null?ti(M.risk_score):void 0,sortField:Q.sortField,sortDir:Q.sortDir,onSort:Q.toggleSort,columnFilters:Q.columnFilters,onColumnFilter:Q.setColumnFilter,showFilters:N,page:Q.page,totalPages:Q.totalPages,pageSize:Q.pageSize,totalItems:Q.totalCount,filteredItems:Q.filteredCount,onPageChange:Q.setPage,onPageSizeChange:Q.setPageSize,loading:c,emptyMessage:"Brak wyjatkow w systemie.",emptyFilteredMessage:"Brak wyjatkow pasujcych do filtrw.",renderCell:(M,V)=>{if(V==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:M.ref_id});if(V==="title")return e.jsx("span",{style:{fontWeight:500},children:M.title});if(V==="policy_title")return e.jsx("span",{style:{fontSize:11},children:M.policy_title??""});if(V==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:L.get(M.org_unit_id)??M.org_unit_name});if(V==="risk_score")return M.risk_score!=null?e.jsxs("span",{className:"score-badge",style:{background:Jo(Number(M.risk_score)),color:ti(Number(M.risk_score))},children:[Number(M.risk_score).toFixed(1)," ",Bu(Number(M.risk_score))]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:M.risk_level_name??""});if(V==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:M.status_name??""});if(V==="expiry_date")return e.jsxs("span",{style:{color:q(M.expiry_date)?"var(--red)":F(M.expiry_date)?"var(--orange)":void 0,fontWeight:q(M.expiry_date)||F(M.expiry_date)?600:void 0,fontSize:12},children:[M.expiry_date,q(M.expiry_date)&&" (WYGASLY)",F(M.expiry_date)&&" (reocena)"]})}}),S&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Wyjatku"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>R(S),title:"Edytuj",children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>w(null),children:""})]})]}),S.risk_score!=null&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Ryzyko odstepstwa"}),e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:ti(Number(S.risk_score))},children:Number(S.risk_score).toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:Jo(Number(S.risk_score)),color:ti(Number(S.risk_score)),fontSize:13,padding:"4px 12px"},children:Bu(Number(S.risk_score))}),S.risk_id&&e.jsx("div",{style:{marginTop:6},children:e.jsx("a",{href:`/risks?highlight=${S.risk_id}`,style:{fontSize:11,color:"var(--blue)",textDecoration:"none"},children:"Przejdz do ryzyka w rejestrze "})})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Un,{number:"",label:"Dane wyjatku"}),e.jsx(Sa,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:S.ref_id})}),e.jsx(Sa,{label:"Tytul",value:e.jsx("strong",{children:S.title})}),e.jsx(Sa,{label:"Polityka",value:S.policy_title}),e.jsx(Sa,{label:"Pion",value:L.get(S.org_unit_id)??S.org_unit_name}),e.jsx(Sa,{label:"Kategoria",value:S.category_name}),S.asset_name&&e.jsx(Sa,{label:"Powiazany aktyw",value:e.jsx("span",{style:{color:"var(--purple)",fontWeight:500},children:S.asset_name})}),e.jsx(Sa,{label:"Wnioskujacy",value:S.requested_by}),e.jsx(Sa,{label:"Zatwierdzajacy",value:S.approved_by}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),S.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginBottom:8},children:S.description}),S.compensating_controls&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2,fontSize:11},children:"Srodki kompensacyjne"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:S.compensating_controls})]}),e.jsx(Un,{number:"",label:"Daty i status"}),e.jsx(Sa,{label:"Status",value:S.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:S.status_name}):""}),e.jsx(Sa,{label:"Poczatek",value:S.start_date}),e.jsx(Sa,{label:"Wygasniecie",value:e.jsxs("span",{style:{color:q(S.expiry_date)?"var(--red)":F(S.expiry_date)?"var(--orange)":void 0,fontWeight:q(S.expiry_date)?600:void 0},children:[S.expiry_date,q(S.expiry_date)&&" (WYGASLY!)",F(S.expiry_date)&&" (reocena)"]})}),e.jsx(Sa,{label:"Data przegladu",value:S.review_date}),S.closed_at&&e.jsx(Sa,{label:"Zamknieto",value:S.closed_at})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:()=>R(S),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:async()=>{confirm(`Archiwizowac wyjatek ${S.ref_id}?`)&&(await le.delete(`/api/v1/exceptions/${S.id}`),w(null),u(!0),U())},children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:h,onClose:()=>{f(!1),_(null)},title:b?`Edycja wyjatku ${b.ref_id??""}`:"Nowy wyjatek od polityki",wide:!0,children:j?e.jsx(QE,{lookups:j,flatUnits:ee,orgTree:me,saving:p,editingException:b,onSubmit:async M=>{x(!0);try{b?await le.put(`/api/v1/exceptions/${b.id}`,M):await le.post("/api/v1/exceptions/with-risk",M),f(!1),_(null),w(null),u(!0),U()}catch(V){alert("Blad zapisu: "+V)}finally{x(!1)}},onCancel:()=>{f(!1),_(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})})]})}const rp=[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}];function Iv({value:t,onChange:n,readonly:a}){return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),rp.map(s=>{const o=Math.abs(t-s.value)<.01;return e.jsxs("div",{style:{padding:"6px 10px",borderRadius:6,fontSize:11,cursor:a?"default":"pointer",display:"flex",alignItems:"center",gap:8,background:o?`${s.color}18`:"transparent",border:o?`2px solid ${s.color}`:"2px solid var(--border)",color:o?s.color:"var(--text-muted)",fontWeight:o?600:400,transition:"all 0.15s"},onClick:()=>!a&&n?.(s.value),children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:o?s.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:30},children:s.value.toFixed(2)}),e.jsx("span",{children:s.label})]},s.value)})]})}function QE({lookups:t,flatUnits:n,orgTree:a,saving:s,editingException:o,onSubmit:c,onCancel:u}){const h=!!o,[f,p]=m.useState(1),[x,j]=m.useState(!1),[y,S]=m.useState("basic"),[w,b]=m.useState(null),[_,E]=m.useState(!1),[z,N]=m.useState(!1),[O,Q]=m.useState(!1),[U,L]=m.useState(""),[H,A]=m.useState(o?.title??""),[R,G]=m.useState(o?.description??""),[F,q]=m.useState(o?.policy_id??null),[ee,me]=m.useState(o?.category_id??null),[W,J]=m.useState(o?.org_unit_id??null),[M,V]=m.useState(o?.asset_id??null),[ne,P]=m.useState(o?.requested_by??""),[T,C]=m.useState(o?.approved_by??""),[k,I]=m.useState(o?.compensating_controls??""),[D,de]=m.useState(o?.status_id??null),[he,ie]=m.useState(o?.start_date??new Date().toISOString().slice(0,10)),[ve,je]=m.useState(o?.expiry_date??""),[fe,_e]=m.useState(""),[Se,Ve]=m.useState(null),[be,oe]=m.useState(null),[Ue,Qe]=m.useState(null),[lt,tt]=m.useState(""),[ht,xt]=m.useState(""),[qe,Nt]=m.useState(2),[st,_t]=m.useState(2),[zt,It]=m.useState(.25),[va,rt]=m.useState(""),[oa,ca]=m.useState(null),[ze,et]=m.useState(""),it=Math.exp(qe)*st/zt,Be=it>=221?"var(--red)":it>=31?"var(--orange)":"var(--green)",at=it>=221?"var(--red-dim)":it>=31?"var(--orange-dim)":"var(--green-dim)",nt=Bu(it),ut=t.assets.find(ge=>ge.id===M),ta=ut&&W&&ut.org_unit_id&&ut.org_unit_id!==W;m.useEffect(()=>{h&&o?.risk_id&&(E(!0),le.get(`/api/v1/risks/${o.risk_id}`).then(ge=>{b(ge),L(`Plan postepowania: ${o.title}`)}).catch(()=>{}).finally(()=>E(!1)))},[]);const Pt=async()=>{if(!(!o||!w)){N(!0);try{const ge=[{entity_type:"risk",entity_id:w.id},{entity_type:"policy_exception",entity_id:o.id}];M&&ge.push({entity_type:"asset",entity_id:M}),await le.post("/api/v1/actions",{title:U||`Plan postepowania: ${o.title}`,description:w.treatment_plan||null,org_unit_id:o.org_unit_id,owner:w.owner||null,links:ge}),Q(!0)}catch(ge){alert("Blad tworzenia dzialania: "+ge)}finally{N(!1)}}},Tt=m.useMemo(()=>{if(!he)return"";const ge=new Date(he);return ge.setMonth(ge.getMonth()+6),ge.toISOString().slice(0,10)},[he]),xe=ve&&Tt&&ve>Tt,Ie={title:!H,description:!R,policyId:!F,orgUnitId:!W,requestedBy:!ne,startDate:!he,expiryDate:!ve||!!xe},mt=!Object.values(Ie).some(Boolean),Oe=fe&&qe&&st&&zt,ct=ge=>{if(!(!x||!ge))return{border:Lv,boxShadow:Mv}},At=()=>{j(!0),mt&&(p(2),j(!1))},za=ge=>{if(V(ge),!h&&ge){const Ft=t.assets.find(ga=>ga.id===ge);Ft&&_e(Ft.name)}},ja=()=>{if(h)c({title:H,description:R,category_id:ee,asset_id:M,approved_by:T||null,compensating_controls:k||null,status_id:D,expiry_date:ve});else{if(!Oe)return;c({title:H,description:R,policy_id:F,category_id:ee,org_unit_id:W,asset_id:M,requested_by:ne,approved_by:T||null,compensating_controls:k||null,status_id:D,start_date:he,expiry_date:ve,vulnerability_id:null,risk_asset_name:fe,risk_security_area_id:Se,risk_threat_id:be,risk_vulnerability_id:Ue,risk_consequence:lt||null,risk_existing_controls:ht||null,risk_impact_level:qe,risk_probability_level:st,risk_safeguard_rating:zt,risk_owner:va||null,risk_strategy_id:oa,risk_treatment_plan:ze||null})}};m.useEffect(()=>{!fe&&H&&_e(M?t.assets.find(ge=>ge.id===M)?.name??H:H)},[f]);const Et=({gridColumn:ge})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:ge?{gridColumn:ge}:void 0,children:[e.jsx("label",{children:"Powiazany aktyw"}),e.jsxs("select",{className:"form-control",value:M??"",onChange:Ft=>za(Ft.target.value?Number(Ft.target.value):null),children:[e.jsx("option",{value:"",children:"Brak powiazania"}),t.assets.map(Ft=>e.jsxs("option",{value:Ft.id,children:[Ft.name,Ft.org_unit_name?` (${Ft.org_unit_name})`:""]},Ft.id))]})]}),ta&&e.jsxs("div",{style:{gridColumn:ge??"span 2",padding:"8px 12px",borderRadius:6,fontSize:11,background:"var(--orange-dim)",border:"1px solid var(--orange)",color:"var(--orange)"},children:["Uwaga: Jednostka org. aktywa (",ut?.org_unit_name,") rozni sie od jednostki wyjatku. Nadrzedna jest jednostka z aktywa."]})]});return h?e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20},children:[{key:"basic",label:"Dane podstawowe"},{key:"risk",label:"Ryzyko odstepstwa"}].map(ge=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"10px 16px",background:y===ge.key?"var(--blue-dim)":"transparent",borderBottom:y===ge.key?"2px solid var(--blue)":"2px solid var(--border)",color:y===ge.key?"var(--blue)":"var(--text-muted)",fontWeight:y===ge.key?600:400,fontSize:13,cursor:"pointer",transition:"all 0.2s"},onClick:()=>S(ge.key),children:ge.label},ge.key))}),y==="basic"&&e.jsxs("div",{children:[e.jsx(Un,{number:"",label:"Dane podstawowe wyjatku"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul wyjatku *"}),e.jsx("input",{className:"form-control",value:H,onChange:ge=>A(ge.target.value),placeholder:"np. Brak szyfrowania dyskow na stacjach roboczych w oddziale X"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Polityka"}),e.jsx("input",{className:"form-control",disabled:!0,value:t.policies.find(ge=>ge.id===F)?.title??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx("input",{className:"form-control",disabled:!0,value:n.find(ge=>ge.id===W)?.name??""})]}),e.jsx(Et,{}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wnioskujacy"}),e.jsx("input",{className:"form-control",disabled:!0,value:ne})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zatwierdzajacy"}),e.jsx("input",{className:"form-control",value:T,onChange:ge=>C(ge.target.value),placeholder:"Imie i nazwisko"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:ee??"",onChange:ge=>me(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.categories.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:D??"",onChange:ge=>de(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.statuses.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",disabled:!0,value:he})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Data wygasniecia *",Tt&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",fontWeight:400},children:[" (max ",Tt,")"]})]}),e.jsx("input",{className:"form-control",type:"date",value:ve,max:Tt,style:xe?{border:Lv,boxShadow:Mv}:void 0,onChange:ge=>je(ge.target.value)}),xe&&e.jsxs("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:["Data wygasniecia nie moze byc wieksza niz 6 miesiecy od daty rozpoczecia (",Tt,")."]})]})]}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uzasadnienie biznesowe *"}),e.jsx("textarea",{className:"form-control",rows:3,value:R,onChange:ge=>G(ge.target.value),placeholder:"Opisz powod wyjatku, wplyw na biznes, uzasadnienie..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Srodki kompensacyjne"}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:ge=>I(ge.target.value),placeholder:"Opisz jakie dodatkowe srodki bezpieczenstwa zostana wdrozone..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!H||!R||!!xe,onClick:ja,children:s?"Zapisywanie...":"Zapisz zmiany"})]})]}),y==="risk"&&e.jsx("div",{children:_?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych ryzyka..."}):w?e.jsxs(e.Fragment,{children:[(()=>{const ge=w.risk_score,Ft=ti(ge),ga=Jo(ge);return e.jsxs("div",{style:{background:ga,border:`1px solid ${Ft}`,borderRadius:10,padding:"12px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Ft,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ryzyko odstepstwa"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",w.impact_level,")  ",w.probability_level," / ",w.safeguard_rating," = ",e.jsx("strong",{style:{color:Ft},children:ge.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Ft},children:ge.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Ft}30`,color:Ft,fontSize:12},children:Bu(ge)})]})]})})(),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(ge=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:ge},ge)),[3,2,1].map(ge=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",ge]},`w${ge}`),[1,2,3].map(Ft=>{const ga=Math.exp(ge)*Ft/w.safeguard_rating,Y=ge===w.impact_level&&Ft===w.probability_level;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:Y?700:400,background:Jo(ga),color:ti(ga),border:Y?`2px solid ${ti(ga)}`:"2px solid transparent"},children:ga.toFixed(0)},`${ge}-${Ft}`)})]}))]})]}),e.jsx(Iv,{value:w.safeguard_rating,readonly:!0})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Un,{number:"",label:"Identyfikacja ryzyka"}),e.jsx(Sa,{label:"Aktywo",value:w.asset_name}),e.jsx(Sa,{label:"Domena",value:w.security_area_name}),e.jsx(Sa,{label:"Zagrozenie",value:w.threats?.map(ge=>ge.threat_name).join(", ")??""}),e.jsx(Sa,{label:"Podatnosc",value:w.vulnerabilities?.map(ge=>ge.vulnerability_name).join(", ")??""}),w.consequence_description&&e.jsxs("div",{style:{marginTop:4,marginBottom:8},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Konsekwencje:"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginTop:2},children:w.consequence_description})]}),e.jsx(Un,{number:"",label:"Analiza ryzyka"}),e.jsx(Sa,{label:"Wplyw (W)",value:`${w.impact_level}  ${["","Niski","Sredni","Wysoki"][w.impact_level]}`}),e.jsx(Sa,{label:"Prawdopodobienstwo (P)",value:`${w.probability_level}  ${["","Niskie","Srednie","Wysokie"][w.probability_level]}`}),e.jsx(Sa,{label:"Ocena zabezpieczen (Z)",value:e.jsxs("span",{style:{color:rp.find(ge=>Math.abs(ge.value-w.safeguard_rating)<.01)?.color},children:[w.safeguard_rating.toFixed(2),"  ",rp.find(ge=>Math.abs(ge.value-w.safeguard_rating)<.01)?.label??""]})}),e.jsx(Un,{number:"",label:"Postepowanie z ryzykiem"}),e.jsx(Sa,{label:"Wlasciciel",value:w.owner}),e.jsx(Sa,{label:"Strategia",value:w.strategy_name}),w.treatment_plan&&e.jsxs("div",{style:{marginTop:4,marginBottom:8},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Plan postepowania:"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginTop:2},children:w.treatment_plan})]}),w.linked_actions.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Powiazane dzialania"}),e.jsx("div",{className:"tag-list",children:w.linked_actions.map(ge=>e.jsxs("span",{className:"tag",style:{cursor:"default",borderLeft:`3px solid ${ge.is_overdue?"var(--red)":ge.status_name?.toLowerCase().includes("zamkn")?"var(--green)":"var(--blue)"}`},children:[e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",marginRight:4},children:["D-",ge.action_id]}),ge.title,ge.is_overdue&&e.jsx("span",{style:{color:"var(--red)",marginLeft:4,fontSize:10},children:"!"})]},ge.action_id))})]})]}),e.jsxs("div",{style:{marginTop:16,padding:14,borderRadius:8,background:"rgba(59,130,246,0.05)",border:"1px solid rgba(59,130,246,0.15)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--blue)",fontWeight:600,marginBottom:8},children:"Zarejestruj dzialanie z planu postepowania"}),O?e.jsx("div",{style:{fontSize:12,color:"var(--green)",padding:"8px 0"},children:"Dzialanie zostalo utworzone i powiazane z ryzykiem oraz wyjatkiem."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-group",style:{marginBottom:8},children:e.jsx("input",{className:"form-control",value:U,onChange:ge=>L(ge.target.value),placeholder:"Tytul dzialania...",style:{fontSize:12}})}),e.jsx("button",{className:"btn btn-sm btn-primary",disabled:z||!U,onClick:Pt,children:z?"Tworzenie...":"Utworz dzialanie"})]})]})]}):e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Brak powiazanego ryzyka odstepstwa."})})]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20},children:[{n:1,label:"Dane wyjatku"},{n:2,label:"Ocena ryzyka odstepstwa"}].map(ge=>e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"10px 16px",background:f===ge.n?"var(--blue-dim)":"transparent",borderBottom:f===ge.n?"2px solid var(--blue)":"2px solid var(--border)",color:f===ge.n?"var(--blue)":"var(--text-muted)",fontWeight:f===ge.n?600:400,fontSize:13,cursor:ge.n<f?"pointer":void 0,transition:"all 0.2s"},onClick:()=>{ge.n<f&&p(ge.n)},children:[e.jsx("span",{style:{display:"inline-flex",width:22,height:22,borderRadius:"50%",alignItems:"center",justifyContent:"center",fontSize:11,background:f>=ge.n?"var(--blue)":"var(--border)",color:f>=ge.n?"#fff":"var(--text-muted)",marginRight:8},children:ge.n}),ge.label]},ge.n))}),f===1&&e.jsxs("div",{children:[e.jsx(Un,{number:"",label:"Dane podstawowe wyjatku"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul wyjatku *"}),e.jsx("input",{className:"form-control",value:H,onChange:ge=>A(ge.target.value),style:ct(Ie.title),placeholder:"np. Brak szyfrowania dyskw na stacjach roboczych w oddziale X"}),x&&Ie.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Polityka *"}),e.jsxs("select",{className:"form-control",value:F??"",style:ct(Ie.policyId),onChange:ge=>q(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz polityk..."}),t.policies.map(ge=>e.jsx("option",{value:ge.id,children:ge.title},ge.id))]}),x&&Ie.policyId&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:a,value:W,onChange:J,placeholder:"Wybierz...",allowClear:!1,style:ct(Ie.orgUnitId)}),x&&Ie.orgUnitId&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsx(Et,{gridColumn:"span 2"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wnioskujacy *"}),e.jsx("input",{className:"form-control",value:ne,onChange:ge=>P(ge.target.value),style:ct(Ie.requestedBy),placeholder:"Imie i nazwisko"}),x&&Ie.requestedBy&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zatwierdzajacy"}),e.jsx("input",{className:"form-control",value:T,onChange:ge=>C(ge.target.value),placeholder:"Imie i nazwisko"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:ee??"",onChange:ge=>me(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.categories.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:D??"",onChange:ge=>de(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.statuses.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia *"}),e.jsx("input",{className:"form-control",type:"date",value:he,style:ct(Ie.startDate),onChange:ge=>ie(ge.target.value)}),x&&Ie.startDate&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Data wygasniecia *",Tt&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",fontWeight:400},children:[" (max ",Tt,")"]})]}),e.jsx("input",{className:"form-control",type:"date",value:ve,max:Tt,style:ct(Ie.expiryDate),onChange:ge=>je(ge.target.value)}),x&&!ve&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"}),xe&&e.jsxs("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:["Data wygasniecia nie moze byc wieksza niz 6 miesiecy od daty rozpoczecia (",Tt,")."]})]})]}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uzasadnienie biznesowe *"}),e.jsx("textarea",{className:"form-control",rows:3,value:R,onChange:ge=>G(ge.target.value),style:ct(Ie.description),placeholder:"Opisz powod wyjatku, wplyw na biznes, uzasadnienie..."}),x&&Ie.description&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Srodki kompensacyjne"}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:ge=>I(ge.target.value),placeholder:"Opisz jakie dodatkowe srodki bezpieczenstwa zostana wdrozone..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:At,children:"Dalej: Ocena ryzyka "})]})]}),f===2&&e.jsxs("div",{children:[e.jsx("div",{style:{background:"var(--orange-dim)",border:"1px solid var(--orange)",borderRadius:8,padding:"10px 16px",marginBottom:16,fontSize:12,color:"var(--orange)"},children:"Kazdy wyjatek od polityki wymaga formalnej oceny ryzyka odstepstwa zgodnie z macierza ryzyka. Ryzyko zostanie automatycznie zarejestrowane w rejestrze ryzyk."}),e.jsxs("div",{style:{background:at,border:`1px solid ${Be}`,borderRadius:10,padding:"12px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Be,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ocena ryzyka odstepstwa"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",qe,")  ",st," / ",zt," = ",e.jsx("strong",{style:{color:Be},children:it.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Be},children:it.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Be}30`,color:Be,fontSize:12},children:nt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(ge=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:ge},ge)),[3,2,1].map(ge=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",ge]},`w${ge}`),[1,2,3].map(Ft=>{const ga=Math.exp(ge)*Ft/zt,Y=ge===qe&&Ft===st;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:Y?700:400,background:Jo(ga),color:ti(ga),border:Y?`2px solid ${ti(ga)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{Nt(ge),_t(Ft)},children:ga.toFixed(0)},`${ge}-${Ft}`)})]}))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginTop:4},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsx(Iv,{value:zt,onChange:It})]}),e.jsx(Un,{number:"",label:"Identyfikacja ryzyka"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Aktywo / obszar narazony na ryzyko *"}),e.jsx("input",{className:"form-control",required:!0,value:fe,onChange:ge=>_e(ge.target.value),placeholder:"np. Stacje robocze oddzialu X"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Domena bezpieczenstwa"}),e.jsxs("select",{className:"form-control",value:Se??"",onChange:ge=>Ve(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.areas.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zagrozenie"}),e.jsxs("select",{className:"form-control",value:be??"",onChange:ge=>oe(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.threats.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:Ue??"",onChange:ge=>Qe(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.vulns.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis konsekwencji realizacji ryzyka"}),e.jsx("textarea",{className:"form-control",rows:2,value:lt,onChange:ge=>tt(ge.target.value),placeholder:"Co moze sie stac jezeli ryzyko sie zmaterializuje..."})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Istniejace zabezpieczenia / kontrole"}),e.jsx("textarea",{className:"form-control",rows:2,value:ht,onChange:ge=>xt(ge.target.value),placeholder:"Jakie srodki sa juz wdrozone..."})]})]}),e.jsx(Un,{number:"",label:"Ocena ryzyka (macierz)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wplyw (W) *"}),e.jsxs("select",{className:"form-control",required:!0,value:qe,onChange:ge=>Nt(Number(ge.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niski"}),e.jsx("option",{value:"2",children:"2 -- Sredni"}),e.jsx("option",{value:"3",children:"3 -- Wysoki"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Prawdopodobienstwo (P) *"}),e.jsxs("select",{className:"form-control",required:!0,value:st,onChange:ge=>_t(Number(ge.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niskie"}),e.jsx("option",{value:"2",children:"2 -- Srednie"}),e.jsx("option",{value:"3",children:"3 -- Wysokie"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ocena zabezpieczen (Z) *"}),e.jsxs("select",{className:"form-control",required:!0,value:zt,onChange:ge=>It(Number(ge.target.value)),children:[e.jsx("option",{value:"0.10",children:"0,10 -- Brak zabezpieczen"}),e.jsx("option",{value:"0.25",children:"0,25 -- Czesciowe"}),e.jsx("option",{value:"0.70",children:"0,70 -- Dobra jakosc"}),e.jsx("option",{value:"0.95",children:"0,95 -- Skuteczne, testowane"})]})]})]}),e.jsx(Un,{number:"",label:"Postepowanie z ryzykiem"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel ryzyka"}),e.jsx("input",{className:"form-control",value:va,onChange:ge=>rt(ge.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Strategia"}),e.jsxs("select",{className:"form-control",value:oa??"",onChange:ge=>ca(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.strategies.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Plan postepowania z ryzykiem"}),e.jsx("textarea",{className:"form-control",rows:2,value:ze,onChange:ge=>et(ge.target.value),placeholder:"Jakie dzialania beda podjete aby zredukowac ryzyko..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>p(1),children:" Wstecz"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!Oe,onClick:ja,children:s?"Zapisywanie...":"Zapisz wyjatek + ryzyko"})]})]})]})]})}const Do="";function Pv({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}function Wv(t){switch(t){case"in_progress":return"var(--orange)";case"completed":return"var(--green)";case"cancelled":return"var(--text-muted)";default:return"var(--blue)"}}function e3(t){switch(t){case"in_progress":return"var(--orange-dim)";case"completed":return"var(--green-dim)";case"cancelled":return"transparent";default:return"var(--blue-dim)"}}function Tb(t){switch(t){case"planned":return"Planowany";case"in_progress":return"W trakcie";case"completed":return"Zakoczony";case"cancelled":return"Anulowany";default:return t}}const t3="1px solid var(--red)",a3="0 0 0 3px var(--red-dim)",bm=[{key:"id",header:"ID",format:t=>String(t.id),defaultVisible:!1},{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytul",format:t=>t.title},{key:"audit_type_name",header:"Typ",format:t=>t.audit_type_name??""},{key:"framework",header:"Framework",format:t=>t.framework??""},{key:"auditor",header:"Audytor",format:t=>t.auditor},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"status",header:"Status",format:t=>Tb(t.status)},{key:"start_date",header:"Rozpoczecie",format:t=>t.start_date??""},{key:"end_date",header:"Zakoczenie",format:t=>t.end_date??""},{key:"overall_rating_name",header:"Ocena",format:t=>t.overall_rating_name??""},{key:"findings_count",header:"Findings",format:t=>t.findings_count}];function n3(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState([]),[w,b]=m.useState([]),[,_]=m.useState([]),[E,z]=m.useState(null),[N,O]=m.useState([]),{visible:Q,toggle:U}=da(bm,"audits"),[L,H]=m.useState(!1),A=Aa({data:t,storageKey:"audits",defaultSort:"start_date",defaultSortDir:"desc"}),[R,G]=m.useState({title:"",auditor:"",framework:"",audit_type_id:null,org_unit_id:null,status:"planned",start_date:"",end_date:""}),F=()=>{G({title:"",auditor:"",framework:"",audit_type_id:null,org_unit_id:null,status:"planned",start_date:"",end_date:""}),j(!1)};m.useEffect(()=>{q()},[]);async function q(){s(!0),c(null);try{const[V,ne]=await Promise.all([fetch(`${Do}/api/v1/audits`),fetch(`${Do}/api/v1/org-units/tree`)]);V.ok?n(await V.json()):c(`API ${V.status}`),ne.ok&&S(await ne.json());for(const[P,T]of[["audit_type",b],["audit_rating",_]]){const C=await fetch(`${Do}/api/v1/dictionaries/by-code/${P}`);if(C.ok){const k=await C.json();T(k.entries??[])}}}catch(V){c(String(V))}s(!1)}async function ee(){if(j(!0),!(!R.title||!R.auditor)){p(!0);try{const V={...R,framework:R.framework||null,start_date:R.start_date||null,end_date:R.end_date||null},ne=await fetch(`${Do}/api/v1/audits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});ne.ok?(h(!1),F(),q()):alert("Blad zapisu: "+await ne.text())}catch(V){alert("Blad: "+V)}p(!1)}}async function me(V){if(E===V){z(null);return}z(V);try{const ne=await fetch(`${Do}/api/v1/audits/${V}/findings`);ne.ok?O(await ne.json()):O([])}catch{O([])}}const W=V=>x&&!V?{border:t3,boxShadow:a3}:{},J=A.filteredCount!==A.totalCount,M=m.useMemo(()=>{const V=A.filtered,ne=V.filter(D=>D.status==="in_progress").length,P=V.filter(D=>D.status==="completed").length,T=V.length>0?V.reduce((D,de)=>D+de.findings_count,0)/V.length:0,C=t.filter(D=>D.status==="in_progress").length,k=t.filter(D=>D.status==="completed").length,I=t.length>0?t.reduce((D,de)=>D+de.findings_count,0)/t.length:0;return[{label:"Wszystkich audytw",value:V.length,total:t.length,color:"var(--blue)"},{label:"W trakcie",value:ne,total:C,color:"var(--orange)"},{label:"Zakoczonych",value:P,total:k,color:"var(--green)"},{label:"rednia findings",value:T.toFixed(1),total:I.toFixed(1),color:"var(--purple)"}]},[A.filtered,t]);return e.jsxs("div",{children:[o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(Ia,{cards:M,isFiltered:J}),e.jsx(ma,{filteredCount:A.filteredCount,totalCount:A.totalCount,unitLabel:"audytow",search:A.search,onSearchChange:A.setSearch,searchPlaceholder:"Szukaj (tytul, ref, audytor, framework)...",showFilters:L,onToggleFilters:()=>H(V=>!V),hasActiveFilters:A.hasActiveFilters,onClearFilters:A.clearAllFilters,columns:bm,visibleColumns:Q,onToggleColumn:U,data:A.filtered,exportFilename:"audyty",primaryLabel:"Nowy audyt",onPrimaryAction:()=>{F(),h(!0)}}),e.jsx(Ea,{columns:bm,visibleColumns:Q,data:A.pageData,rowKey:V=>V.id,selectedKey:E,onRowClick:V=>me(V.id),rowBorderColor:V=>Wv(V.status),sortField:A.sortField,sortDir:A.sortDir,onSort:A.toggleSort,columnFilters:A.columnFilters,onColumnFilter:A.setColumnFilter,showFilters:L,page:A.page,totalPages:A.totalPages,pageSize:A.pageSize,totalItems:A.totalCount,filteredItems:A.filteredCount,onPageChange:A.setPage,onPageSizeChange:A.setPageSize,loading:a,emptyMessage:"Brak audytow w systemie.",emptyFilteredMessage:"Brak audytow pasujacych do filtrow.",renderCell:(V,ne)=>{if(ne==="status")return e.jsx("span",{className:"score-badge",style:{background:e3(V.status),color:Wv(V.status)},children:Tb(V.status)});if(ne==="findings_count")return e.jsx("span",{style:{fontWeight:V.findings_count>0?700:void 0,fontFamily:"'JetBrains Mono',monospace",color:V.findings_count>0?"var(--red)":void 0},children:V.findings_count});if(ne==="overall_rating_name")return V.overall_rating_name?e.jsx("span",{style:{color:"var(--blue)",fontWeight:500},children:V.overall_rating_name}):e.jsx("span",{children:""})}}),E!=null&&e.jsxs("div",{className:"card",style:{marginTop:0,borderTop:"none",borderTopLeftRadius:0,borderTopRightRadius:0,padding:"8px 16px"},children:[e.jsxs("strong",{style:{fontSize:12},children:["Findings (",N.length,"):"]}),N.length===0&&e.jsx("p",{style:{color:"var(--text-muted)",margin:"4px 0",fontSize:12},children:"Brak findingw"}),N.length>0&&e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Tytul"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Waznosc"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Wlasciciel"}),e.jsx("th",{children:"SLA"})]})}),e.jsx("tbody",{children:N.map(V=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:V.ref_id??""}),e.jsx("td",{style:{fontWeight:500,fontSize:12},children:V.title}),e.jsx("td",{style:{fontSize:12},children:V.finding_type_name??""}),e.jsx("td",{style:{fontSize:12},children:V.severity_name??""}),e.jsx("td",{style:{fontSize:12},children:V.status_name??""}),e.jsx("td",{style:{fontSize:12},children:V.remediation_owner??""}),e.jsxs("td",{style:{fontSize:12,color:V.sla_deadline&&new Date(V.sla_deadline)<new Date?"var(--red)":void 0,fontWeight:V.sla_deadline&&new Date(V.sla_deadline)<new Date?600:void 0},children:[V.sla_deadline??"",V.sla_deadline&&new Date(V.sla_deadline)<new Date?" !":""]})]},V.id))})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy audyt",wide:!0,children:[e.jsx(Pv,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:W(!!R.title),value:R.title,onChange:V=>G({...R,title:V.target.value}),placeholder:"Nazwa audytu"}),x&&!R.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Audytor *"}),e.jsx("input",{className:"form-control",style:W(!!R.auditor),value:R.auditor,onChange:V=>G({...R,auditor:V.target.value}),placeholder:"Imie i nazwisko"}),x&&!R.auditor&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ audytu"}),e.jsxs("select",{className:"form-control",value:R.audit_type_id??"",onChange:V=>G({...R,audit_type_id:V.target.value?Number(V.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),w.map(V=>e.jsx("option",{value:V.id,children:V.label},V.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Framework"}),e.jsx("input",{className:"form-control",value:R.framework,onChange:V=>G({...R,framework:V.target.value}),placeholder:"np. ISO 27001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org."}),e.jsx(jn,{tree:y,value:R.org_unit_id,onChange:V=>G({...R,org_unit_id:V}),placeholder:"-- brak --",allowClear:!0})]})]}),e.jsx(Pv,{number:"",label:"Status i daty"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:R.status,onChange:V=>G({...R,status:V.target.value}),children:[e.jsx("option",{value:"planned",children:"Planowany"}),e.jsx("option",{value:"in_progress",children:"W trakcie"}),e.jsx("option",{value:"completed",children:"Zakoczony"}),e.jsx("option",{value:"cancelled",children:"Anulowany"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:R.start_date,onChange:V=>G({...R,start_date:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data zakonczenia"}),e.jsx("input",{className:"form-control",type:"date",value:R.end_date,onChange:V=>G({...R,end_date:V.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:f,onClick:ee,children:f?"Zapisywanie...":"Utworz audyt"})]})]})]})}const _m="";function Lo(t){if(t){if(t.startsWith("A"))return"#16a34a";if(t.startsWith("B"))return"#ca8a04";if(t.startsWith("C"))return"#ea580c";if(t.startsWith("D"))return"#dc2626"}}function Uv(t){return t?t.startsWith("A")?"var(--green-dim)":t.startsWith("B")?"var(--yellow-dim)":t.startsWith("C")?"var(--orange-dim)":t.startsWith("D")?"var(--red-dim)":"transparent":"transparent"}function ms(t){return!!t&&new Date(t)<new Date}function $v(t){if(!t)return!1;const n=new Date(t),a=new Date,s=new Date;return s.setDate(s.getDate()+90),n>=a&&n<=s}function hl({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}function In({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}const r3="1px solid var(--red)",i3="0 0 0 3px var(--red-dim)",Sm=[{key:"ref_id",header:"Ref",defaultVisible:!0,format:t=>t.ref_id??""},{key:"name",header:"Nazwa",defaultVisible:!0,format:t=>t.name},{key:"category_name",header:"Kategoria",defaultVisible:!0,format:t=>t.category_name??""},{key:"criticality_name",header:"Krytycznosc",defaultVisible:!0,format:t=>t.criticality_name??""},{key:"status_name",header:"Status",defaultVisible:!0,format:t=>t.status_name??""},{key:"risk_rating_name",header:"Rating",defaultVisible:!0,format:t=>t.risk_rating_name??""},{key:"risk_score",header:"Wynik",defaultVisible:!0,format:t=>t.risk_score!=null?`${t.risk_score}%`:""},{key:"contract_end",header:"Koniec umowy",defaultVisible:!0,format:t=>t.contract_end??""},{key:"last_assessment_date",header:"Ostatnia ocena",defaultVisible:!0,format:t=>t.last_assessment_date??""},{key:"next_assessment_date",header:"Nastepna ocena",defaultVisible:!0,format:t=>t.next_assessment_date??""},{key:"contract_owner",header:"Wlasciciel umowy",defaultVisible:!1,format:t=>t.contract_owner??""},{key:"questionnaire_completed",header:"Kwestionariusz",defaultVisible:!1,format:t=>t.questionnaire_completed?"TAK":"NIE"},{key:"is_active",header:"Aktywny",defaultVisible:!1,format:t=>t.is_active?"TAK":"NIE"}];function s3(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[z,N]=m.useState([]),[O,Q]=m.useState([]),{visible:U,toggle:L}=da(Sm,"vendors"),[H,A]=m.useState(!1),R=Aa({data:t,storageKey:"vendors",defaultSort:"name",defaultSortDir:"asc"}),[G,F]=m.useState({name:"",category_id:null,criticality_id:null,services_provided:"",data_access_level_id:null,contract_owner:"",security_contact:"",contract_start:"",contract_end:"",sla_description:"",status_id:null,certifications:""}),q=()=>{F({name:"",category_id:null,criticality_id:null,services_provided:"",data_access_level_id:null,contract_owner:"",security_contact:"",contract_start:"",contract_end:"",sla_description:"",status_id:null,certifications:""}),S(!1)};m.useEffect(()=>{ee()},[]);async function ee(){s(!0),c(null);try{const ne=await fetch(`${_m}/api/v1/vendors`);ne.ok?n(await ne.json()):c(`API ${ne.status}`);for(const[P,T]of[["vendor_category",b],["vendor_status",N],["asset_criticality",E],["vendor_data_access",Q]]){const C=await fetch(`${_m}/api/v1/dictionaries/by-code/${P}`);if(C.ok){const k=await C.json();T(k.entries??[])}}}catch(ne){c(String(ne))}s(!1)}async function me(){if(S(!0),!!G.name){j(!0);try{const ne={...G,services_provided:G.services_provided||null,contract_start:G.contract_start||null,contract_end:G.contract_end||null,sla_description:G.sla_description||null,certifications:G.certifications||null},P=await fetch(`${_m}/api/v1/vendors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});P.ok?(h(!1),q(),ee()):alert("Blad zapisu: "+await P.text())}catch(ne){alert("Blad: "+ne)}j(!1)}}const W=ne=>{const P=(ne.criticality_name??"").toLowerCase();return P.includes("wysoki")||P.includes("high")||P.includes("krytyczny")||P.includes("critical")},J=m.useMemo(()=>{const ne=R.filtered,P=t,T=ne.filter(W).length,C=P.filter(W).length,k=ne.filter(ve=>ve.risk_score!=null),I=P.filter(ve=>ve.risk_score!=null),D=k.length>0?k.reduce((ve,je)=>ve+(je.risk_score??0),0)/k.length:0,de=I.length>0?I.reduce((ve,je)=>ve+(je.risk_score??0),0)/I.length:0,he=ne.filter(ve=>$v(ve.contract_end)).length,ie=P.filter(ve=>$v(ve.contract_end)).length;return[{label:"Wszystkich dostawcow",value:ne.length,total:P.length,color:"var(--blue)"},{label:"Krytycznych",value:T,total:C,color:"var(--red)"},{label:"Sr. wynik ryzyka",value:D,total:de,color:"var(--orange, #ea580c)",formatValue:ve=>typeof ve=="number"?`${ve.toFixed(1)}%`:`${ve}%`},{label:"Umowy wygasajace",value:he,total:ie,color:"var(--purple, #7c3aed)"}]},[t,R.filtered]),M=ne=>y&&!ne?{border:r3,boxShadow:i3}:{},V=(ne,P)=>{switch(P){case"name":return e.jsx("span",{style:{fontWeight:500},children:ne.name});case"criticality_name":return ne.criticality_name?e.jsx("span",{className:"score-badge",style:{background:W(ne)?"var(--red-dim)":"var(--blue-dim)",color:W(ne)?"var(--red)":"var(--blue)"},children:ne.criticality_name}):"";case"risk_rating_name":return ne.risk_rating_name?e.jsx("span",{className:"score-badge",style:{background:Uv(ne.risk_rating_name),color:Lo(ne.risk_rating_name),fontWeight:600},children:ne.risk_rating_name}):"";case"risk_score":return ne.risk_score==null?"":e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:Lo(ne.risk_rating_name)},children:[ne.risk_score,"%"]});case"contract_end":return ne.contract_end?e.jsxs("span",{style:{fontSize:12,color:ms(ne.contract_end)?"var(--red)":void 0,fontWeight:ms(ne.contract_end)?600:void 0},children:[ne.contract_end,ms(ne.contract_end)?" !":""]}):"";default:return}};return e.jsxs("div",{children:[e.jsx(Ia,{cards:J,isFiltered:R.filteredCount!==R.totalCount}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"dostawcow",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj (nazwa, ref, wlasciciel)...",showFilters:H,onToggleFilters:()=>A(ne=>!ne),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:Sm,visibleColumns:U,onToggleColumn:L,data:R.filtered,exportFilename:"dostawcy",primaryLabel:"Nowy dostawca",onPrimaryAction:()=>{q(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:Sm,visibleColumns:U,data:R.pageData,renderCell:V,onRowClick:ne=>p(f?.id===ne.id?null:ne),rowKey:ne=>ne.id,selectedKey:f?.id??null,sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:H,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:a,emptyMessage:"Brak dostawcow w systemie.",emptyFilteredMessage:"Brak dostawcow pasujacych do filtrow."}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Dostawcy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.risk_rating_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Risk Rating"}),e.jsx("span",{className:"score-badge",style:{background:Uv(f.risk_rating_name),color:Lo(f.risk_rating_name),fontSize:14,padding:"6px 16px"},children:f.risk_rating_name}),f.risk_score!=null&&e.jsxs("div",{style:{marginTop:4,fontSize:20,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Lo(f.risk_rating_name)},children:[f.risk_score,"%"]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(hl,{number:"",label:"Dane dostawcy"}),e.jsx(In,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(In,{label:"Nazwa",value:e.jsx("strong",{children:f.name})}),e.jsx(In,{label:"Kategoria",value:f.category_name}),e.jsx(In,{label:"Krytycznosc",value:f.criticality_name}),e.jsx(In,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(hl,{number:"",label:"Umowa i kontakt"}),e.jsx(In,{label:"Wlasciciel umowy",value:f.contract_owner}),e.jsx(In,{label:"Koniec umowy",value:f.contract_end?e.jsxs("span",{children:[f.contract_end,ms(f.contract_end)?" !":""]}):"",color:ms(f.contract_end)?"var(--red)":void 0}),e.jsx(In,{label:"Kwestionariusz",value:f.questionnaire_completed?e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:"TAK"}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"NIE"})}),e.jsx(In,{label:"Aktywny",value:f.is_active?e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:"TAK"}):e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"NIE"})}),e.jsx(hl,{number:"",label:"Oceny i ryzyko"}),e.jsx(In,{label:"Risk Rating",value:f.risk_rating_name,color:Lo(f.risk_rating_name)}),e.jsx(In,{label:"Risk Score",value:f.risk_score!=null?`${f.risk_score}%`:""}),e.jsx(In,{label:"Ostatnia ocena",value:f.last_assessment_date}),e.jsx(In,{label:"Nastepna ocena",value:f.next_assessment_date?e.jsxs("span",{children:[f.next_assessment_date,ms(f.next_assessment_date)?" !":""]}):"",color:ms(f.next_assessment_date)?"var(--red)":void 0})]})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy dostawca (TPRM)",wide:!0,children:[e.jsx(hl,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:M(!!G.name),value:G.name,onChange:ne=>F({...G,name:ne.target.value}),placeholder:"Nazwa dostawcy"}),y&&!G.name&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:G.category_id??"",onChange:ne=>F({...G,category_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),w.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{className:"form-control",value:G.criticality_id??"",onChange:ne=>F({...G,criticality_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),_.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Poziom dostepu do danych"}),e.jsxs("select",{className:"form-control",value:G.data_access_level_id??"",onChange:ne=>F({...G,data_access_level_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]})]}),e.jsx(hl,{number:"",label:"Umowa i kontakt"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel umowy"}),e.jsx("input",{className:"form-control",value:G.contract_owner,onChange:ne=>F({...G,contract_owner:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kontakt bezpieczenstwa"}),e.jsx("input",{className:"form-control",value:G.security_contact,onChange:ne=>F({...G,security_contact:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:G.status_id??"",onChange:ne=>F({...G,status_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),z.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:G.contract_start,onChange:ne=>F({...G,contract_start:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data konca umowy"}),e.jsx("input",{className:"form-control",type:"date",value:G.contract_end,onChange:ne=>F({...G,contract_end:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Certyfikaty"}),e.jsx("input",{className:"form-control",value:G.certifications,onChange:ne=>F({...G,certifications:ne.target.value}),placeholder:"ISO 27001, SOC2..."})]})]}),e.jsx(hl,{number:"",label:"Opis uslug"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis swiadczonych uslug"}),e.jsx("textarea",{className:"form-control",rows:3,value:G.services_provided,onChange:ne=>F({...G,services_provided:ne.target.value}),placeholder:"Szczegolowy opis uslug dostawcy..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis SLA"}),e.jsx("textarea",{className:"form-control",rows:2,value:G.sla_description,onChange:ne=>F({...G,sla_description:ne.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:me,children:x?"Zapisywanie...":"Utworz dostawce"})]})]})]})}const Mo="";function Jd(t){if(!t)return"var(--text-muted)";const n=t.toLowerCase();return n.includes("planowana")||n.includes("planned")?"#6b7280":n.includes("w trakcie")||n.includes("in_progress")||n.includes("in progress")?"#2563eb":n.includes("zakonczona")||n.includes("zakoczona")||n.includes("completed")?"#16a34a":"var(--text-muted)"}function wm(t){if(!t)return"transparent";const n=t.toLowerCase();return n.includes("planowana")||n.includes("planned")?"rgba(107,114,128,0.15)":n.includes("w trakcie")||n.includes("in_progress")||n.includes("in progress")?"var(--blue-dim)":n.includes("zakonczona")||n.includes("zakoczona")||n.includes("completed")?"var(--green-dim)":"transparent"}function l3(t){if(!t)return!1;const n=t.toLowerCase();return n.includes("w trakcie")||n.includes("in_progress")||n.includes("in progress")}function o3(t){if(!t)return!1;const n=t.toLowerCase();return n.includes("zakonczona")||n.includes("zakoczona")||n.includes("completed")}function Pn({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function ps({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}const c3="1px solid var(--red)",d3="0 0 0 3px var(--red-dim)",km=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytul",format:t=>t.title},{key:"campaign_type_name",header:"Typ",format:t=>t.campaign_type_name??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??"Cala org."},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"target_audience_count",header:"Uczestnicy",format:t=>t.target_audience_count},{key:"start_date",header:"Start",format:t=>t.start_date??""},{key:"end_date",header:"Koniec",format:t=>t.end_date??""},{key:"owner",header:"Wlasciciel",format:t=>t.owner??""}];function u3(){const[t,n]=m.useState([]),[a,s]=m.useState(!0),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState({}),[_,E]=m.useState(null),[z,N]=m.useState([]),[O,Q]=m.useState([]),[U,L]=m.useState([]),[H,A]=m.useState(""),[R,G]=m.useState("start_date"),[F,q]=m.useState("desc"),[ee,me]=m.useState(!1),[W,J]=m.useState(""),[M,V]=m.useState(""),{visible:ne,toggle:P}=da(km,"awareness"),T={title:"",description:"",campaign_type_id:null,org_unit_id:null,target_audience_count:0,start_date:"",end_date:"",status_id:null,owner:"",content_url:""},[C,k]=m.useState(T),I=()=>{k({...T}),j(!1)};m.useEffect(()=>{D()},[]);async function D(){s(!0),c(null);try{const[be,oe]=await Promise.all([fetch(`${Mo}/api/v1/awareness-campaigns`),fetch(`${Mo}/api/v1/org-units/tree`)]);be.ok?n(await be.json()):c(`API ${be.status}`),oe.ok&&L(await oe.json());for(const[Ue,Qe]of[["campaign_type",N],["campaign_status",Q]]){const lt=await fetch(`${Mo}/api/v1/dictionaries/by-code/${Ue}`);if(lt.ok){const tt=await lt.json();Qe(tt.entries??[])}}}catch(be){c(String(be))}s(!1)}async function de(be){if(w[be]){S(y===be?null:be);return}try{const oe=await fetch(`${Mo}/api/v1/awareness-campaigns/${be}/results`);if(oe.ok){const Ue=await oe.json();b(Qe=>({...Qe,[be]:Ue}))}}catch{}S(be)}async function he(){if(j(!0),!!C.title){p(!0);try{const be={...C,description:C.description||null,start_date:C.start_date||null,end_date:C.end_date||null,content_url:C.content_url||null,owner:C.owner||null},oe=await fetch(`${Mo}/api/v1/awareness-campaigns`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)});oe.ok?(h(!1),I(),D()):alert("Blad zapisu: "+await oe.text())}catch(be){alert("Blad: "+be)}p(!1)}}const ie=be=>{R===be?q(oe=>oe==="asc"?"desc":"asc"):(G(be),q("asc"))},ve=!!W||!!M,je=()=>{J(""),V("")},fe=m.useMemo(()=>{let be=[...t];if(H){const oe=H.toLowerCase();be=be.filter(Ue=>(Ue.title??"").toLowerCase().includes(oe)||(Ue.ref_id??"").toLowerCase().includes(oe)||(Ue.owner??"").toLowerCase().includes(oe)||(Ue.campaign_type_name??"").toLowerCase().includes(oe)||(Ue.org_unit_name??"").toLowerCase().includes(oe))}return W&&(be=be.filter(oe=>{const Ue=O.find(Qe=>String(Qe.id)===W);return Ue?oe.status_name===Ue.label:!1})),M&&(be=be.filter(oe=>{const Ue=z.find(Qe=>String(Qe.id)===M);return Ue?oe.campaign_type_name===Ue.label:!1})),be.sort((oe,Ue)=>{const Qe=oe[R],lt=Ue[R];let tt=0;return Qe==null&&lt==null?tt=0:Qe==null?tt=1:lt==null?tt=-1:typeof Qe=="number"&&typeof lt=="number"?tt=Qe-lt:tt=String(Qe).localeCompare(String(lt),"pl"),F==="asc"?tt:-tt}),be},[t,H,W,M,O,z,R,F]),_e=m.useMemo(()=>{const be=t.length,oe=t.filter(ht=>l3(ht.status_name)).length,Ue=t.filter(ht=>o3(ht.status_name)).length,lt=Object.values(w).flat().filter(ht=>ht.completion_rate!=null),tt=lt.length>0?(lt.reduce((ht,xt)=>ht+(xt.completion_rate??0),0)/lt.length).toFixed(1):"";return{total:be,active:oe,completed:Ue,avgCompletion:tt}},[t,w]),Se=({field:be,label:oe})=>e.jsxs("th",{style:{cursor:"pointer",userSelect:"none",whiteSpace:"nowrap"},onClick:()=>ie(be),children:[oe,R===be&&e.jsx("span",{style:{marginLeft:4,fontSize:9,opacity:.7},children:F==="asc"?"":""})]}),Ve=be=>x&&!be?{border:c3,boxShadow:d3}:{};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-4",children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--blue)"},children:_e.total}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Kampanii ogolnie"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:_e.active>0?"#2563eb":"var(--text-muted)"},children:_e.active}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Aktywnych / W trakcie"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:_e.completed>0?"#16a34a":"var(--text-muted)"},children:_e.completed}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zakonczonych"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsxs("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)"},children:[_e.avgCompletion,_e.avgCompletion!==""?"%":""]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Sredni % ukonczenia"})]})]}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:fe.length,totalCount:t.length,unitLabel:"kampanii",search:H,onSearchChange:A,searchPlaceholder:"Szukaj (tytul, ref, wlasciciel)...",showFilters:ee,onToggleFilters:()=>me(be=>!be),hasActiveFilters:ve,onClearFilters:je,columns:km,visibleColumns:ne,onToggleColumn:P,data:fe,exportFilename:"awareness_campaigns",primaryLabel:"Nowa kampania",onPrimaryAction:()=>{I(),h(!0)}}),ee&&e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12,display:"flex",gap:12,flexWrap:"wrap"},children:[e.jsxs("select",{className:"form-control",style:{width:180,padding:"5px 10px",fontSize:12},value:W,onChange:be=>J(be.target.value),children:[e.jsx("option",{value:"",children:"Wszystkie statusy"}),O.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]}),e.jsxs("select",{className:"form-control",style:{width:180,padding:"5px 10px",fontSize:12},value:M,onChange:be=>V(be.target.value),children:[e.jsx("option",{value:"",children:"Wszystkie typy"}),z.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:_?"1fr 420px":"1fr",gap:14},children:[e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:a?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Ladowanie..."}):fe.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:t.length===0?"Brak kampanii w systemie.":"Brak kampanii pasujacych do filtrow."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[ne.has("ref_id")&&e.jsx(Se,{field:"ref_id",label:"Ref"}),ne.has("title")&&e.jsx(Se,{field:"title",label:"Tytul"}),ne.has("campaign_type_name")&&e.jsx(Se,{field:"campaign_type_name",label:"Typ"}),ne.has("org_unit_name")&&e.jsx(Se,{field:"org_unit_name",label:"Jednostka"}),ne.has("status_name")&&e.jsx(Se,{field:"status_name",label:"Status"}),ne.has("target_audience_count")&&e.jsx(Se,{field:"target_audience_count",label:"Uczestnicy"}),ne.has("start_date")&&e.jsx(Se,{field:"start_date",label:"Start"}),ne.has("end_date")&&e.jsx(Se,{field:"end_date",label:"Koniec"}),ne.has("owner")&&e.jsx(Se,{field:"owner",label:"Wlasciciel"}),e.jsx("th",{style:{width:70},children:"Wyniki"})]})}),e.jsx("tbody",{children:fe.map(be=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{cursor:"pointer",borderLeft:`3px solid ${Jd(be.status_name)}`,background:_?.id===be.id?"var(--bg-card-hover)":void 0},onClick:()=>E(_?.id===be.id?null:be),children:[ne.has("ref_id")&&e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:be.ref_id??""}),ne.has("title")&&e.jsx("td",{style:{fontWeight:500},children:be.title}),ne.has("campaign_type_name")&&e.jsx("td",{style:{fontSize:12},children:be.campaign_type_name??""}),ne.has("org_unit_name")&&e.jsx("td",{style:{fontSize:12},children:be.org_unit_name??"Cala org."}),ne.has("status_name")&&e.jsx("td",{children:be.status_name?e.jsx("span",{className:"score-badge",style:{background:wm(be.status_name),color:Jd(be.status_name)},children:be.status_name}):""}),ne.has("target_audience_count")&&e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:be.target_audience_count}),ne.has("start_date")&&e.jsx("td",{style:{fontSize:12},children:be.start_date??""}),ne.has("end_date")&&e.jsx("td",{style:{fontSize:12},children:be.end_date??""}),ne.has("owner")&&e.jsx("td",{style:{fontSize:12},children:be.owner??""}),e.jsx("td",{onClick:oe=>oe.stopPropagation(),children:e.jsx("button",{className:"btn btn-sm",onClick:()=>de(be.id),style:{fontSize:11},children:y===be.id?"Zwin":"Pokaz"})})]},be.id),y===be.id&&w[be.id]&&e.jsx("tr",{children:e.jsx("td",{colSpan:km.length+1,style:{padding:0},children:e.jsxs("div",{style:{margin:"8px 12px 12px",borderRadius:"var(--radius-sm)",overflow:"hidden",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{padding:"8px 12px",fontSize:11,fontWeight:600,color:"var(--blue)",background:"rgba(59,130,246,0.06)",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Wyniki kampanii: ",be.title]}),w[be.id].length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak wynikow"}):e.jsxs("table",{className:"data-table",style:{margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Jednostka"}),e.jsx("th",{children:"Uczestnicy"}),e.jsx("th",{children:"Ukonczone"}),e.jsx("th",{children:"Nie zdalo"}),e.jsx("th",{children:"Zglosilo"}),e.jsx("th",{children:"Ukonczenie %"}),e.jsx("th",{children:"Click rate %"}),e.jsx("th",{children:"Report rate %"}),e.jsx("th",{children:"Sr. wynik"})]})}),e.jsx("tbody",{children:w[be.id].map(oe=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:12},children:oe.org_unit_name??""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.participants_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.completed_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,color:oe.failed_count>0?"var(--red)":void 0},children:oe.failed_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.reported_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.completion_rate!=null?e.jsxs("span",{style:{color:oe.completion_rate>=80?"#16a34a":oe.completion_rate>=50?"#ca8a04":"var(--red)"},children:[oe.completion_rate,"%"]}):""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,color:oe.click_rate!=null&&oe.click_rate>20?"#dc2626":void 0},children:oe.click_rate!=null?`${oe.click_rate}%`:""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.report_rate!=null?`${oe.report_rate}%`:""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,fontWeight:600},children:oe.avg_score!=null?oe.avg_score:""})]},oe.id))})]})]})})},`res-${be.id}`)]}))})]})}),_&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly kampanii"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>E(null),children:""})]}),_.status_name&&e.jsx("div",{style:{textAlign:"center",marginBottom:16},children:e.jsx("span",{className:"score-badge",style:{background:wm(_.status_name),color:Jd(_.status_name),fontSize:14,padding:"6px 16px"},children:_.status_name})}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(ps,{number:"",label:"Dane kampanii"}),e.jsx(Pn,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:_.ref_id})}),e.jsx(Pn,{label:"Tytul",value:e.jsx("strong",{children:_.title})}),e.jsx(Pn,{label:"Typ",value:_.campaign_type_name}),e.jsx(Pn,{label:"Jednostka",value:_.org_unit_name??"Cala org."}),e.jsx(ps,{number:"",label:"Uczestnicy i daty"}),e.jsx(Pn,{label:"Uczestnicy",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:_.target_audience_count})}),e.jsx(Pn,{label:"Data startu",value:_.start_date}),e.jsx(Pn,{label:"Data konca",value:_.end_date}),e.jsx(Pn,{label:"Wlasciciel",value:_.owner}),e.jsx(ps,{number:"",label:"Status"}),e.jsx(Pn,{label:"Status",value:_.status_name?e.jsx("span",{className:"score-badge",style:{background:wm(_.status_name),color:Jd(_.status_name)},children:_.status_name}):""}),e.jsx(Pn,{label:"Aktywna",value:_.is_active?"Tak":"Nie",color:_.is_active?"#16a34a":"var(--text-muted)"}),w[_.id]&&w[_.id].length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ps,{number:"",label:"Podsumowanie wynikow"}),w[_.id].map(be=>e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",borderRadius:6,background:"var(--bg-inset)"},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:2},children:be.org_unit_name??"Cala org."}),e.jsx(Pn,{label:"Ukonczenie",value:be.completion_rate!=null?`${be.completion_rate}%`:"",color:be.completion_rate!=null&&be.completion_rate>=80?"#16a34a":be.completion_rate!=null&&be.completion_rate<50?"var(--red)":void 0}),e.jsx(Pn,{label:"Click rate",value:be.click_rate!=null?`${be.click_rate}%`:"",color:be.click_rate!=null&&be.click_rate>20?"#dc2626":void 0}),e.jsx(Pn,{label:"Sr. wynik",value:be.avg_score!=null?String(be.avg_score):""})]},be.id))]})]})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowa kampania awareness",wide:!0,children:[e.jsx(ps,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:Ve(!!C.title),value:C.title,onChange:be=>k({...C,title:be.target.value}),placeholder:"Nazwa kampanii"}),x&&!C.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ kampanii"}),e.jsxs("select",{className:"form-control",value:C.campaign_type_id??"",onChange:be=>k({...C,campaign_type_id:be.target.value?Number(be.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),z.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org."}),e.jsx(jn,{tree:U,value:C.org_unit_id,onChange:be=>k({...C,org_unit_id:be}),placeholder:"-- cala org. --",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:C.owner,onChange:be=>k({...C,owner:be.target.value}),placeholder:"Osoba odpowiedzialna"})]})]}),e.jsx(ps,{number:"",label:"Uczestnicy i terminy"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Liczba uczestnikow"}),e.jsx("input",{className:"form-control",type:"number",min:0,value:C.target_audience_count,onChange:be=>k({...C,target_audience_count:Number(be.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:C.start_date,onChange:be=>k({...C,start_date:be.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data konca"}),e.jsx("input",{className:"form-control",type:"date",value:C.end_date,onChange:be=>k({...C,end_date:be.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:C.status_id??"",onChange:be=>k({...C,status_id:be.target.value?Number(be.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"URL materialow"}),e.jsx("input",{className:"form-control",value:C.content_url,onChange:be=>k({...C,content_url:be.target.value}),placeholder:"https://..."})]})]}),e.jsx(ps,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis kampanii"}),e.jsx("textarea",{className:"form-control",rows:3,value:C.description,onChange:be=>k({...C,description:be.target.value}),placeholder:"Opcjonalny opis kampanii..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:f,onClick:he,children:f?"Zapisywanie...":"Utworz kampanie"})]})]})]})}const Xd="";function ml(t){return t>=80?"#16a34a":t>=60?"#ca8a04":t>=40?"#ea580c":"#dc2626"}function f3(t){return t>=80?"#dcfce7":t>=60?"#fef9c3":t>=40?"#fed7aa":"#fecaca"}function h3(){const[t,n]=m.useState(null),[a,s]=m.useState([]),[o,c]=m.useState(null),[u,h]=m.useState(!0),[f,p]=m.useState("dashboard");m.useEffect(()=>{x()},[]);async function x(){h(!0);try{const[y,S,w]=await Promise.all([fetch(`${Xd}/api/v1/security-score`),fetch(`${Xd}/api/v1/security-score/history?limit=30`),fetch(`${Xd}/api/v1/security-score/methodology`)]);y.ok&&n(await y.json()),S.ok&&s(await S.json()),w.ok&&c(await w.json())}catch{}h(!1)}async function j(){(await fetch(`${Xd}/api/v1/security-score/snapshot`,{method:"POST"})).ok&&x()}return u?e.jsx("div",{className:"page-container",children:e.jsx("p",{children:"adowanie..."})}):e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Security Score"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:`btn ${f==="dashboard"?"btn-primary":""}`,onClick:()=>p("dashboard"),children:"Dashboard"}),e.jsx("button",{className:`btn ${f==="methodology"?"btn-primary":""}`,onClick:()=>p("methodology"),children:"Metodologia"}),e.jsx("button",{className:`btn ${f==="history"?"btn-primary":""}`,onClick:()=>p("history"),children:"Historia"}),e.jsx("button",{className:"btn",onClick:j,title:"Wymu snapshot",children:"Snapshot"})]})]}),f==="dashboard"&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",style:{padding:24,textAlign:"center",marginBottom:16},children:[e.jsxs("div",{style:{width:180,height:180,borderRadius:"50%",border:`8px solid ${t.color}`,backgroundColor:f3(t.total_score),display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"0 auto"},children:[e.jsx("div",{style:{fontSize:48,fontWeight:700,color:t.color},children:t.total_score}),e.jsx("div",{style:{fontSize:14,color:t.color,fontWeight:600},children:t.rating})]}),e.jsxs("div",{style:{marginTop:12,color:"#6b7280",fontSize:13},children:["Config v",t.config_version]})]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsx("h3",{style:{marginBottom:12},children:"Rozbicie na filary"}),t.pillars.sort((y,S)=>S.weight-y.weight).map(y=>e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4,fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:y.name})," (",y.weight,"%)"]}),e.jsx("span",{style:{color:ml(y.score),fontWeight:600},children:y.score})]}),e.jsx("div",{style:{background:"#e5e7eb",borderRadius:4,height:20,overflow:"hidden"},children:e.jsx("div",{style:{width:`${y.score}%`,height:"100%",background:ml(y.score),borderRadius:4,transition:"width 0.5s ease"}})})]},y.name))]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{marginBottom:12},children:"Najsabsze filary"}),t.pillars.sort((y,S)=>y.score-S.score).slice(0,3).map((y,S)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",marginBottom:4,background:S===0?"#fef2f2":S===1?"#fffbeb":"#f0f9ff",borderRadius:6,alignItems:"center"},children:[e.jsxs("span",{children:[e.jsxs("strong",{children:["#",S+1]})," ",y.name,e.jsxs("span",{style:{color:"#9ca3af",marginLeft:8,fontSize:12},children:["waga: ",y.weight,"%"]})]}),e.jsx("span",{style:{color:ml(y.score),fontWeight:700,fontSize:18},children:y.score})]},y.name))]})]}),f==="methodology"&&o&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{children:o.title}),e.jsxs("p",{style:{color:"#6b7280",marginBottom:16},children:[o.scale_description,e.jsx("br",{}),"Config v",o.config_version," | Wynik: ",e.jsx("strong",{style:{color:ml(o.total_score)},children:o.total_score})," (",o.rating,")"]}),o.pillars.map(y=>e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("strong",{children:y.name}),e.jsxs("span",{style:{color:ml(y.current_score),fontWeight:600},children:[y.current_score," (",y.weight,"%)"]})]}),e.jsx("p",{style:{fontSize:13,color:"#6b7280",marginBottom:4},children:y.description}),e.jsxs("p",{style:{fontSize:12,color:"#9ca3af"},children:["rdo: ",y.data_source,e.jsx("br",{}),"Formua: ",e.jsx("code",{children:y.formula})]})]},y.name))]}),f==="history"&&e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Risk"}),e.jsx("th",{children:"Vuln"}),e.jsx("th",{children:"Inc"}),e.jsx("th",{children:"Exc"}),e.jsx("th",{children:"Matur."}),e.jsx("th",{children:"Audit"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"TPRM"}),e.jsx("th",{children:"Policy"}),e.jsx("th",{children:"Aware."}),e.jsx("th",{children:"Trigger"})]})}),e.jsxs("tbody",{children:[a.map(y=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:12},children:new Date(y.snapshot_date).toLocaleString("pl-PL")}),e.jsx("td",{style:{color:ml(y.total_score),fontWeight:700},children:y.total_score}),e.jsx("td",{children:y.risk_score??""}),e.jsx("td",{children:y.vulnerability_score??""}),e.jsx("td",{children:y.incident_score??""}),e.jsx("td",{children:y.exception_score??""}),e.jsx("td",{children:y.maturity_score??""}),e.jsx("td",{children:y.audit_score??""}),e.jsx("td",{children:y.asset_score??""}),e.jsx("td",{children:y.tprm_score??""}),e.jsx("td",{children:y.policy_score??""}),e.jsx("td",{children:y.awareness_score??""}),e.jsx("td",{style:{fontSize:11},children:y.triggered_by??""})]},y.id)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,style:{textAlign:"center",color:"#9ca3af"},children:"Brak snapshotw"})})]})]})]})}const m3=[{key:"info",label:"Informacje",icon:""},{key:"issues",label:"Czynniki",icon:""},{key:"obligations",label:"Zobowizania",icon:""},{key:"stakeholders",label:"Interesariusze",icon:""},{key:"scope",label:"Zakres SZ",icon:""},{key:"risk_appetite",label:"Apetyt na ryzyko",icon:""},{key:"reviews",label:"Przegldy",icon:""}];function pu(t){if(!t)return"var(--text-muted)";switch(t){case"approved":return"var(--green)";case"in_review":return"var(--blue)";case"draft":return"var(--orange)";case"needs_update":return"var(--red)";default:return"var(--text-muted)"}}function gu(t){if(!t)return"";switch(t){case"approved":return"Zatwierdzony";case"in_review":return"W przegldzie";case"draft":return"Szkic";case"needs_update":return"Wymaga aktualizacji";default:return t}}function pl(t){switch(t){case"high":return"var(--red)";case"medium":return"var(--orange)";case"low":return"var(--green)";default:return"var(--text-muted)"}}function gs(t){switch(t){case"high":return"Wysoka";case"medium":return"rednia";case"low":return"Niska";default:return""}}function Hv(t){switch(t){case"positive":return"Pozytywny";case"negative":return"Negatywny";case"neutral":return"Neutralny";default:return""}}function Vv(t){switch(t){case"compliant":return"var(--green)";case"partially_compliant":return"var(--orange)";case"non_compliant":return"var(--red)";default:return"var(--text-muted)"}}function Zv(t){switch(t){case"compliant":return"Zgodny";case"partially_compliant":return"Czciowo zgodny";case"non_compliant":return"Niezgodny";case"not_assessed":return"Nieoceniony";default:return""}}function St({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,padding:"2px 0"},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}const p3="1px solid var(--red)",g3="0 0 0 3px var(--red-dim)";function Nb({node:t,depth:n,selectedId:a,onSelect:s,overviews:o}){const[c,u]=m.useState(!1),h=t.children.length>0,f=a===t.id,p=o.get(t.id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>s(t.id),style:{display:"flex",alignItems:"center",gap:6,padding:"6px 10px",paddingLeft:n*20+10,cursor:"pointer",background:f?"var(--blue-dim)":"transparent",borderLeft:f?"3px solid var(--blue)":"3px solid transparent",fontSize:13,transition:"background 0.15s"},onMouseEnter:x=>{f||(x.currentTarget.style.background="var(--bg-card-hover)")},onMouseLeave:x=>{f||(x.currentTarget.style.background="transparent")},children:[h&&e.jsx("span",{onClick:x=>{x.stopPropagation(),u(!c)},style:{cursor:"pointer",fontSize:10,width:14,textAlign:"center",color:"var(--text-muted)",userSelect:"none"},children:c?"":""}),!h&&e.jsx("span",{style:{width:14}}),e.jsx("span",{style:{fontWeight:n===0?600:400},children:t.name}),e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)",marginLeft:4},children:t.symbol}),p&&e.jsxs("span",{style:{marginLeft:"auto",display:"flex",gap:4,alignItems:"center",fontSize:11},children:[p.context_status&&e.jsx("span",{style:{padding:"1px 6px",borderRadius:4,fontSize:10,background:p.context_status==="approved"?"var(--green-dim)":p.context_status==="draft"?"var(--orange-dim)":"var(--blue-dim)",color:pu(p.context_status)},children:gu(p.context_status)}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[p.issues_count,"c ",p.obligations_count,"z ",p.stakeholders_count,"i"]})]})]}),!c&&h&&t.children.map(x=>e.jsx(Nb,{node:x,depth:n+1,selectedId:a,onSelect:s,overviews:o},x.id))]})}function x3(){const t=[{key:"title",header:"Tytu"},{key:"issue_type",header:"Typ",format:Z=>Z.issue_type==="internal"?"Wewntrzny":"Zewntrzny"},{key:"category_name",header:"Kategoria",format:Z=>Z.category_name??""},{key:"impact_level",header:"Wpyw",format:Z=>Hv(Z.impact_level)},{key:"relevance",header:"Istotno",format:Z=>gs(Z.relevance)},{key:"org_unit_name",header:"Jednostka",format:Z=>Z.org_unit_name??""},{key:"inherited",header:"rdo",format:Z=>Z.inherited?"Odziedziczony":"Wasny"}],n=[{key:"custom_name",header:"Nazwa",format:Z=>Z.custom_name??Z.regulation_name??""},{key:"obligation_type",header:"Typ"},{key:"compliance_status",header:"Status zgodnoci",format:Z=>Zv(Z.compliance_status)},{key:"responsible_person",header:"Odpowiedzialny",format:Z=>Z.responsible_person??""},{key:"effective_from",header:"Obowizuje od",format:Z=>Z.effective_from??""},{key:"org_unit_name",header:"Jednostka",format:Z=>Z.org_unit_name??""},{key:"inherited",header:"rdo",format:Z=>Z.inherited?"Odziedziczony":"Wasny"}],a=[{key:"name",header:"Nazwa"},{key:"stakeholder_type",header:"Typ",format:Z=>Z.stakeholder_type==="internal"?"Wewntrzny":"Zewntrzny"},{key:"category_name",header:"Kategoria",format:Z=>Z.category_name??""},{key:"influence_level",header:"Wpyw",format:Z=>gs(Z.influence_level)},{key:"relevance",header:"Istotno",format:Z=>gs(Z.relevance)},{key:"org_unit_name",header:"Jednostka",format:Z=>Z.org_unit_name??""},{key:"inherited",header:"rdo",format:Z=>Z.inherited?"Odziedziczony":"Wasny"}],s=[{key:"review_date",header:"Data przegldu"},{key:"reviewer",header:"Przegldajcy"},{key:"review_type",header:"Typ",format:Z=>Z.review_type==="scheduled"?"Planowany":Z.review_type==="triggered"?"Wyzwolony":"Pocztkowy"},{key:"approved_by",header:"Zatwierdzony przez",format:Z=>Z.approved_by??""},{key:"next_review_date",header:"Nastpny przegld",format:Z=>Z.next_review_date??""}],{visible:o,toggle:c}=da(t,"ctx-issues"),{visible:u,toggle:h}=da(n,"ctx-obligations"),{visible:f,toggle:p}=da(a,"ctx-stakeholders"),{visible:x,toggle:j}=da(s,"ctx-reviews"),[y,S]=m.useState([]),[w,b]=m.useState(null),[_,E]=m.useState("info"),[z,N]=m.useState(!0),[O,Q]=m.useState(!0),[U,L]=m.useState(null),[H,A]=m.useState(new Map),[R,G]=m.useState(null),[F,q]=m.useState(null),[ee,me]=m.useState([]),[W,J]=m.useState([]),[M,V]=m.useState([]),[ne,P]=m.useState([]),[T,C]=m.useState(null),[k,I]=m.useState([]),[D,de]=m.useState(""),[he,ie]=m.useState(""),[ve,je]=m.useState(!1),[fe,_e]=m.useState(!1),[Se,Ve]=m.useState(!1),[be,oe]=m.useState(!1),[Ue,Qe]=m.useState(!1),[lt,tt]=m.useState(!1),[ht,xt]=m.useState(null),[qe,Nt]=m.useState(null),[st,_t]=m.useState(null),[zt,It]=m.useState(null),[va,rt]=m.useState(null),[oa,ca]=m.useState(null),[ze,et]=m.useState([]),[it,Be]=m.useState(!1),[at,nt]=m.useState(!1),[ut,ta]=m.useState(!1),[Pt,Tt]=m.useState({}),[xe,Ie]=m.useState(null),[mt,Oe]=m.useState(!1),[ct,At]=m.useState({}),[za,ja]=m.useState(!1),[Et,ge]=m.useState({}),[Ft,ga]=m.useState([]),[Y,se]=m.useState(!1),[te,ae]=m.useState({}),re=m.useMemo(()=>{function Z(Ge,Ca){for(const ua of Ge){if(ua.id===Ca)return ua;const Ha=Z(ua.children,Ca);if(Ha)return Ha}return null}return w?Z(y,w):null},[y,w]);m.useEffect(()=>{Q(!0),le.get("/api/v1/org-units/tree").then(Z=>{S(Z),Z.length>0&&!w&&b(Z[0].id),Ce(Z)}).catch(()=>{}).finally(()=>Q(!1)),le.get("/api/v1/dictionaries/by-code/management_system").then(Z=>ga(Z.entries??[])).catch(()=>{})},[]);function ce(Z){const Ge=[];for(const Ca of Z)Ge.push(Ca.id),Ge.push(...ce(Ca.children));return Ge}async function Ce(Z){const Ge=ce(Z),Ca=new Map;await Promise.all(Ge.map(async ua=>{try{const Ha=await le.get(`/api/v1/org-units/${ua}/context`);Ca.set(ua,Ha)}catch{}})),A(Ca)}m.useEffect(()=>{w&&De(w)},[w]);async function De(Z){N(!0),L(null),xt(null),Nt(null),_t(null);try{const Ge=`/api/v1/org-units/${Z}/context`,[Ca,ua,Ha,pr,Cc,Fs,Rs,Tc]=await Promise.all([le.get(Ge),le.get(Ge+"/general"),le.get(Ge+"/issues"),le.get(Ge+"/obligations"),le.get(Ge+"/stakeholders"),le.get(Ge+"/scope").catch(()=>[]),le.get(Ge+"/risk-appetite").catch(()=>null),le.get(Ge+"/reviews")]);G(Ca),q(ua),me(Ha),J(pr),V(Cc),P(Fs??[]),C(Rs),I(Tc),A(dn=>{const Cr=new Map(dn);return Cr.set(Z,Ca),Cr})}catch(Ge){L(String(Ge))}N(!1)}const Ne=async()=>{if(ze.length===0)try{const Z=await le.get("/api/v1/org-levels");et(Z)}catch{}Be(!0)};async function Fe(Z){Z.preventDefault(),nt(!0);const Ge=new FormData(Z.currentTarget),Ca={parent_id:xe,level_id:Number(Ge.get("level_id")),name:Ge.get("name"),symbol:Ge.get("symbol"),owner:Ge.get("owner")||null,security_contact:Ge.get("security_contact")||null,it_coordinator:Ge.get("it_coordinator")||null,description:Ge.get("description")||null};try{await le.post("/api/v1/org-units",Ca),Be(!1);const ua=await le.get("/api/v1/org-units/tree");S(ua),Ce(ua)}catch(ua){L("Bd zapisu: "+ua)}nt(!1)}async function K(){if(re){nt(!0);try{await le.put(`/api/v1/org-units/${re.id}`,Pt),ta(!1);const Z=await le.get("/api/v1/org-units/tree");S(Z),Ce(Z),De(re.id)}catch(Z){L("Bd zapisu: "+Z)}nt(!1)}}async function ue(){if(re&&confirm(`Dezaktywowa jednostk "${re.name}"?`))try{await le.delete(`/api/v1/org-units/${re.id}`),b(null);const Z=await le.get("/api/v1/org-units/tree");S(Z),Ce(Z)}catch(Z){L("Bd: "+Z)}}const ke={issue_type:"internal",title:"",description:"",impact_level:"",relevance:"",response_action:"",review_date:""},[Te,Me]=m.useState(ke);async function Ye(){if(!w||!Te.title){tt(!0);return}Qe(!0);try{const Z={...Te};Z.impact_level||delete Z.impact_level,Z.relevance||delete Z.relevance,Z.review_date||delete Z.review_date,await le.post(`/api/v1/org-units/${w}/context/issues`,Z),je(!1),Me({...ke}),tt(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}const $e={obligation_type:"legal",custom_name:"",description:"",responsible_person:"",compliance_status:"not_assessed",effective_from:""},[yt,jt]=m.useState($e);async function Kt(){if(!w||!yt.custom_name){tt(!0);return}Qe(!0);try{const Z={...yt};Z.effective_from||delete Z.effective_from,await le.post(`/api/v1/org-units/${w}/context/obligations`,Z),_e(!1),jt({...$e}),tt(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}const cn={stakeholder_type:"internal",name:"",description:"",needs_expectations:"",requirements_type:"",influence_level:"",relevance:""},[sa,Pa]=m.useState(cn);async function qn(){if(!w||!sa.name){tt(!0);return}Qe(!0);try{const Z={...sa};Z.requirements_type||delete Z.requirements_type,Z.influence_level||delete Z.influence_level,Z.relevance||delete Z.relevance,await le.post(`/api/v1/org-units/${w}/context/stakeholders`,Z),Ve(!1),Pa({...cn}),tt(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}const ui={review_date:"",reviewer:"",review_type:"scheduled",changes_summary:"",next_review_date:""},[Zt,ur]=m.useState(ui);async function fr(){if(!w||!Zt.review_date||!Zt.reviewer){tt(!0);return}Qe(!0);try{const Z={...Zt};Z.next_review_date||delete Z.next_review_date,await le.post(`/api/v1/org-units/${w}/context/reviews`,Z),oe(!1),ur({...ui}),tt(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}async function bn(){if(w){Qe(!0);try{await le.put(`/api/v1/org-units/${w}/context/general`,ct),Oe(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}}async function jc(){if(w){Qe(!0);try{await le.post(`/api/v1/org-units/${w}/context/scope`,Et),ja(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}}async function Gu(){if(w){Qe(!0);try{await le.post(`/api/v1/org-units/${w}/context/risk-appetite`,te),se(!1),De(w)}catch(Z){L(String(Z))}Qe(!1)}}async function Rl(Z){if(!w||!Te.title){tt(!0);return}Qe(!0);try{const Ge={...Te};Ge.impact_level||delete Ge.impact_level,Ge.relevance||delete Ge.relevance,Ge.review_date||delete Ge.review_date,await le.put(`/api/v1/org-units/${w}/context/issues/${Z}`,Ge),It(null),je(!1),Me({...ke}),tt(!1),De(w)}catch(Ge){L(String(Ge))}Qe(!1)}async function bc(Z){if(!w||!yt.custom_name){tt(!0);return}Qe(!0);try{const Ge={...yt};Ge.effective_from||delete Ge.effective_from,await le.put(`/api/v1/org-units/${w}/context/obligations/${Z}`,Ge),rt(null),_e(!1),jt({...$e}),tt(!1),De(w)}catch(Ge){L(String(Ge))}Qe(!1)}async function Ns(Z){if(!w||!sa.name){tt(!0);return}Qe(!0);try{const Ge={...sa};Ge.requirements_type||delete Ge.requirements_type,Ge.influence_level||delete Ge.influence_level,Ge.relevance||delete Ge.relevance,await le.put(`/api/v1/org-units/${w}/context/stakeholders/${Z}`,Ge),ca(null),Ve(!1),Pa({...cn}),tt(!1),De(w)}catch(Ge){L(String(Ge))}Qe(!1)}async function Ku(Z){w&&(await le.delete(`/api/v1/org-units/${w}/context/issues/${Z}`),xt(null),De(w))}async function _n(Z){w&&(await le.delete(`/api/v1/org-units/${w}/context/obligations/${Z}`),Nt(null),De(w))}async function Bl(Z){w&&(await le.delete(`/api/v1/org-units/${w}/context/stakeholders/${Z}`),_t(null),De(w))}function _c(Z){It(Z.id),Me({issue_type:Z.issue_type,title:Z.title,description:Z.description??"",impact_level:Z.impact_level??"",relevance:Z.relevance??"",response_action:Z.response_action??"",review_date:Z.review_date??""}),je(!0)}function Ol(Z){rt(Z.id),jt({obligation_type:Z.obligation_type,custom_name:Z.custom_name??"",description:Z.description??"",responsible_person:Z.responsible_person??"",compliance_status:Z.compliance_status??"not_assessed",effective_from:Z.effective_from??""}),_e(!0)}function fi(Z){ca(Z.id),Pa({stakeholder_type:Z.stakeholder_type,name:Z.name,description:Z.description??"",needs_expectations:Z.needs_expectations??"",requirements_type:Z.requirements_type??"",influence_level:Z.influence_level??"",relevance:Z.relevance??""}),Ve(!0)}const Sc=m.useMemo(()=>{if(!he)return y;const Z=he.toLowerCase();function Ge(Ca){const ua=[];for(const Ha of Ca){const pr=Ge(Ha.children);(Ha.name.toLowerCase().includes(Z)||Ha.symbol.toLowerCase().includes(Z)||pr.length>0)&&ua.push({...Ha,children:pr.length>0?pr:Ha.children.length>0&&Ha.name.toLowerCase().includes(Z)?Ha.children:pr})}return ua}return Ge(y)},[y,he]),Yi=m.useMemo(()=>{if(!D)return ee;const Z=D.toLowerCase();return ee.filter(Ge=>Ge.title.toLowerCase().includes(Z)||(Ge.description??"").toLowerCase().includes(Z))},[ee,D]),hr=m.useMemo(()=>{if(!D)return W;const Z=D.toLowerCase();return W.filter(Ge=>(Ge.custom_name??"").toLowerCase().includes(Z)||(Ge.description??"").toLowerCase().includes(Z))},[W,D]),As=m.useMemo(()=>{if(!D)return M;const Z=D.toLowerCase();return M.filter(Ge=>Ge.name.toLowerCase().includes(Z)||(Ge.description??"").toLowerCase().includes(Z))},[M,D]),hi=Z=>lt&&!Z?{border:p3,boxShadow:g3}:{};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:0,height:"calc(100vh - 60px)"},children:[e.jsx("div",{style:{padding:"12px 16px 8px",borderBottom:"1px solid var(--border)"},children:e.jsxs("h2",{style:{margin:0},children:["Kontekst Organizacyjny ",e.jsx("span",{style:{fontSize:14,color:"var(--text-muted)"},children:"ISO 27001 / 22301 klauzula 4"})]})}),U&&e.jsx("div",{className:"card",style:{background:"var(--red-dim)",color:"var(--red)",padding:12,margin:"8px 16px 0"},children:U}),e.jsxs("div",{style:{display:"flex",flex:1,minHeight:0},children:[e.jsxs("div",{style:{width:320,minWidth:280,maxWidth:400,borderRight:"1px solid var(--border)",overflowY:"auto",background:"var(--bg-card)"},children:[e.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:.5},children:"Struktura organizacyjna"}),e.jsx("button",{className:"btn btn-sm btn-primary",style:{fontSize:11,padding:"2px 8px"},onClick:Ne,children:"+ Dodaj"})]}),e.jsx("input",{className:"form-control",placeholder:"Szukaj jednostki...",value:he,onChange:Z=>ie(Z.target.value),style:{fontSize:12,padding:"4px 8px"}})]}),O?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie..."}):y.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak jednostek"}):e.jsx("div",{style:{padding:"4px 0"},children:Sc.map(Z=>e.jsx(Nb,{node:Z,depth:0,selectedId:w,onSelect:b,overviews:H},Z.id))})]}),e.jsx("div",{style:{flex:1,minWidth:0,overflowY:"auto",display:"flex",flexDirection:"column"},children:w?e.jsxs(e.Fragment,{children:[re&&e.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:15},children:re.name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[re.level_name,"  ",re.symbol," ",re.owner?` ${re.owner}`:""]})]}),R&&e.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:e.jsx("span",{style:{fontSize:12,color:pu(R.context_status),fontWeight:500},children:gu(R.context_status)})})]}),e.jsx("div",{style:{display:"flex",gap:0,borderBottom:"1px solid var(--border)",padding:"0 16px",background:"var(--bg-card)"},children:m3.map(Z=>e.jsxs("button",{onClick:()=>{E(Z.key),de("")},style:{padding:"8px 14px",background:_===Z.key?"var(--blue-dim)":"transparent",color:_===Z.key?"var(--blue)":"var(--text-muted)",border:"none",borderBottom:_===Z.key?"2px solid var(--blue)":"2px solid transparent",cursor:"pointer",fontWeight:_===Z.key?600:400,fontSize:13},children:[Z.icon," ",Z.label]},Z.key))}),e.jsxs("div",{style:{flex:1,padding:16,overflowY:"auto"},children:[z&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"adowanie..."}),!z&&_==="info"&&wc(),!z&&_==="issues"&&Dl(),!z&&_==="obligations"&&qu(),!z&&_==="stakeholders"&&Yu(),!z&&_==="scope"&&Es(),!z&&_==="risk_appetite"&&mr(),!z&&_==="reviews"&&Ll()]})]}):e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:14},children:"Wybierz jednostk z drzewa po lewej stronie"})})]}),Ml(),mi(),pi(),kc(),Il(),Ji(),zc()]});function wc(){return re?ut?e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:15},children:["Edycja jednostki: ",re.name]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",value:Pt.name??"",onChange:Z=>Tt({...Pt,name:Z.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Symbol *"}),e.jsx("input",{className:"form-control",value:Pt.symbol??"",onChange:Z=>Tt({...Pt,symbol:Z.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Waciciel biznesowy"}),e.jsx("input",{className:"form-control",value:Pt.owner??"",onChange:Z=>Tt({...Pt,owner:Z.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator bezpieczestwa"}),e.jsx("input",{className:"form-control",value:Pt.security_contact??"",onChange:Z=>Tt({...Pt,security_contact:Z.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator IT"}),e.jsx("input",{className:"form-control",value:Pt.it_coordinator??"",onChange:Z=>Tt({...Pt,it_coordinator:Z.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status"}),e.jsxs("select",{className:"form-control",value:Pt.is_active?"active":"inactive",onChange:Z=>Tt({...Pt,is_active:Z.target.value==="active"}),children:[e.jsx("option",{value:"active",children:"Aktywna"}),e.jsx("option",{value:"inactive",children:"Nieaktywna"})]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:Pt.description??"",onChange:Z=>Tt({...Pt,description:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>ta(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:K,disabled:at,children:at?"Zapisywanie...":"Zapisz zmiany"})]})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Atrybuty jednostki"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:ue,children:"Dezaktywuj"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ta(!0),Tt({name:re.name,symbol:re.symbol,owner:re.owner,security_contact:re.security_contact,it_coordinator:re.it_coordinator??null,description:re.description,is_active:re.is_active})},children:"Edytuj"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,fontSize:13},children:[e.jsx(St,{label:"Nazwa",value:re.name}),e.jsx(St,{label:"Poziom",value:re.level_name}),e.jsx(St,{label:"Symbol",value:re.symbol}),e.jsx(St,{label:"Waciciel biznesowy",value:re.owner}),e.jsx(St,{label:"Koordynator bezpieczestwa",value:re.security_contact}),e.jsx(St,{label:"Koordynator IT",value:re.it_coordinator}),e.jsx(St,{label:"Status",value:re.is_active?"Aktywna":"Nieaktywna",color:re.is_active?"var(--green)":"var(--red)"}),re.description&&e.jsx("div",{style:{gridColumn:"span 2"},children:e.jsx(St,{label:"Opis",value:re.description})})]})]}),ne.length>0&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:15},children:"Zakresy Systemw Zarzdzania"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:ne.map(Z=>e.jsxs("span",{onClick:()=>E("scope"),style:{padding:"4px 12px",borderRadius:12,fontSize:12,fontWeight:500,cursor:"pointer",background:Z.inherited?"var(--blue-dim)":"var(--green-dim)",color:Z.inherited?"var(--blue)":"var(--green)",border:`1px solid ${Z.inherited?"var(--blue)":"var(--green)"}`},children:[Z.management_system_name??"Zakres"," (v",Z.version,")",Z.inherited&&e.jsx("span",{style:{marginLeft:4,fontSize:10},children:"odz."})]},Z.id))})]}),R&&e.jsxs("div",{className:"grid-4",children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status kontekstu"}),e.jsx("div",{style:{fontSize:18,fontWeight:600,color:pu(R.context_status)},children:gu(R.context_status)})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("issues"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Czynniki"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.issues_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.issues_own," w.)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("obligations"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zobowizania"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.obligations_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.obligations_own," w.)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("stakeholders"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Interesariusze"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.stakeholders_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.stakeholders_own," w.)"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[F&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Dane kontekstowe"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>{Oe(!0),At({headcount:F.headcount,mission_vision:F.mission_vision,key_products_services:F.key_products_services,strategic_objectives:F.strategic_objectives,key_processes_notes:F.key_processes_notes,context_status:F.context_status,context_reviewer:F.context_reviewer})},children:"Edytuj"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,fontSize:13},children:[e.jsx(St,{label:"Zatrudnienie",value:F.headcount??""}),e.jsx(St,{label:"Status",value:gu(F.context_status),color:pu(F.context_status)}),e.jsx(St,{label:"Przegldajcy",value:F.context_reviewer}),e.jsx(St,{label:"Ostatni przegld",value:F.context_review_date}),e.jsx(St,{label:"Nastpny przegld",value:F.context_next_review})]}),F.mission_vision&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Misja / Wizja"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.mission_vision})]}),F.key_products_services&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Kluczowe produkty / usugi"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.key_products_services})]}),F.strategic_objectives&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Cele strategiczne"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.strategic_objectives})]}),F.key_processes_notes&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Uwagi do kluczowych procesw"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.key_processes_notes})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:R&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Zakres SZ"}),R.has_scope?e.jsxs("div",{style:{fontSize:13},children:[e.jsxs("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:["Zdefiniowany (",ne.length,")"]}),R.scope_inherited&&e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--text-muted)"},children:"(odziedziczony)"})]}):e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)"},children:"Nie zdefiniowano"})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Apetyt na ryzyko"}),R.has_risk_appetite?e.jsxs("div",{style:{fontSize:13},children:[e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:"Zdefiniowany"}),R.risk_appetite_inherited&&e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--text-muted)"},children:"(odziedziczony)"})]}):e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)"},children:"Nie zdefiniowano"})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Przegldy"}),e.jsxs("div",{style:{fontSize:13},children:[e.jsx(St,{label:"Liczba przegldw",value:R.reviews_count}),e.jsx(St,{label:"Ostatni przegld",value:R.last_review_date??""}),e.jsx(St,{label:"Nastpny przegld",value:R.next_review_date??""})]})]})]})})]}),mt&&e.jsxs(gt,{open:mt,onClose:()=>Oe(!1),title:"Edytuj dane kontekstowe",wide:!0,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatrudnienie"}),e.jsx("input",{type:"number",className:"form-control",value:ct.headcount??"",onChange:Z=>At({...ct,headcount:Z.target.value?Number(Z.target.value):null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status kontekstu"}),e.jsxs("select",{className:"form-control",value:ct.context_status??"",onChange:Z=>At({...ct,context_status:Z.target.value||null}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"draft",children:"Szkic"}),e.jsx("option",{value:"in_review",children:"W przegldzie"}),e.jsx("option",{value:"approved",children:"Zatwierdzony"}),e.jsx("option",{value:"needs_update",children:"Wymaga aktualizacji"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Przegldajcy"}),e.jsx("input",{className:"form-control",value:ct.context_reviewer??"",onChange:Z=>At({...ct,context_reviewer:Z.target.value||null})})]})]}),e.jsxs("div",{style:{marginTop:14},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Misja / Wizja"}),e.jsx("textarea",{className:"form-control",rows:3,value:ct.mission_vision??"",onChange:Z=>At({...ct,mission_vision:Z.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Kluczowe produkty / usugi"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.key_products_services??"",onChange:Z=>At({...ct,key_products_services:Z.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Cele strategiczne"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.strategic_objectives??"",onChange:Z=>At({...ct,strategic_objectives:Z.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Uwagi o kluczowych procesach"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.key_processes_notes??"",onChange:Z=>At({...ct,key_processes_notes:Z.target.value||null})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>Oe(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:bn,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:40},children:"Wybierz jednostk z drzewa"})}function Dl(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:t,visibleColumns:o,onToggleColumn:c,data:Yi,filteredCount:Yi.length,totalCount:ee.length,unitLabel:"czynnikw",exportFilename:"kontekst-czynniki",primaryLabel:"Dodaj czynnik",onPrimaryAction:()=>je(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:t.filter(Z=>o.has(Z.key)).map(Z=>e.jsx("th",{children:Z.header},Z.key))})}),e.jsxs("tbody",{children:[Yi.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),Yi.map(Z=>e.jsx("tr",{onClick:()=>xt(Z),style:{cursor:"pointer",background:ht?.id===Z.id?"var(--bg-card-hover)":void 0,opacity:Z.inherited?.75:1},children:t.filter(Ge=>o.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="relevance"?e.jsx("span",{style:{color:pl(Z.relevance)},children:Ge.format?Ge.format(Z):Z[Ge.key]}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:Z.inherited?"var(--blue-dim)":"var(--green-dim)",color:Z.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(Z)}):Ge.format?Ge.format(Z):Z[Ge.key]},Ge.key))},Z.id))]})]})]}),ht&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>xt(null),children:""})]}),e.jsx(St,{label:"Tytu",value:ht.title}),e.jsx(St,{label:"Typ",value:ht.issue_type==="internal"?"Wewntrzny":"Zewntrzny"}),e.jsx(St,{label:"Kategoria",value:ht.category_name}),e.jsx(St,{label:"Wpyw",value:Hv(ht.impact_level)}),e.jsx(St,{label:"Istotno",value:gs(ht.relevance),color:pl(ht.relevance)}),e.jsx(St,{label:"Jednostka",value:ht.org_unit_name}),e.jsx(St,{label:"rdo",value:ht.inherited?"Odziedziczony":"Wasny"}),ht.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:ht.description})]}),ht.response_action&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Dziaanie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:ht.response_action})]}),!ht.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>_c(ht),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>Ku(ht.id),children:"Dezaktywuj"})]})]})]})}function qu(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:n,visibleColumns:u,onToggleColumn:h,data:hr,filteredCount:hr.length,totalCount:W.length,unitLabel:"zobowiza",exportFilename:"kontekst-zobowiazania",primaryLabel:"Dodaj zobowizanie",onPrimaryAction:()=>_e(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:n.filter(Z=>u.has(Z.key)).map(Z=>e.jsx("th",{children:Z.header},Z.key))})}),e.jsxs("tbody",{children:[hr.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:n.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),hr.map(Z=>e.jsx("tr",{onClick:()=>Nt(Z),style:{cursor:"pointer",background:qe?.id===Z.id?"var(--bg-card-hover)":void 0,opacity:Z.inherited?.75:1},children:n.filter(Ge=>u.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="compliance_status"?e.jsx("span",{style:{color:Vv(Z.compliance_status)},children:Ge.format(Z)}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:Z.inherited?"var(--blue-dim)":"var(--green-dim)",color:Z.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(Z)}):Ge.format?Ge.format(Z):Z[Ge.key]},Ge.key))},Z.id))]})]})]}),qe&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>Nt(null),children:""})]}),e.jsx(St,{label:"Nazwa",value:qe.custom_name}),e.jsx(St,{label:"Typ",value:qe.obligation_type}),e.jsx(St,{label:"Zgodno",value:Zv(qe.compliance_status),color:Vv(qe.compliance_status)}),e.jsx(St,{label:"Odpowiedzialny",value:qe.responsible_person}),e.jsx(St,{label:"Obowizuje od",value:qe.effective_from}),e.jsx(St,{label:"Jednostka",value:qe.org_unit_name}),qe.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:qe.description})]}),!qe.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Ol(qe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>_n(qe.id),children:"Dezaktywuj"})]})]})]})}function Yu(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:a,visibleColumns:f,onToggleColumn:p,data:As,filteredCount:As.length,totalCount:M.length,unitLabel:"interesariuszy",exportFilename:"kontekst-interesariusze",primaryLabel:"Dodaj interesariusza",onPrimaryAction:()=>Ve(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:a.filter(Z=>f.has(Z.key)).map(Z=>e.jsx("th",{children:Z.header},Z.key))})}),e.jsxs("tbody",{children:[As.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:a.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),As.map(Z=>e.jsx("tr",{onClick:()=>_t(Z),style:{cursor:"pointer",background:st?.id===Z.id?"var(--bg-card-hover)":void 0,opacity:Z.inherited?.75:1},children:a.filter(Ge=>f.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="relevance"||Ge.key==="influence_level"?e.jsx("span",{style:{color:pl(Ge.key==="relevance"?Z.relevance:Z.influence_level)},children:Ge.format(Z)}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:Z.inherited?"var(--blue-dim)":"var(--green-dim)",color:Z.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(Z)}):Ge.format?Ge.format(Z):Z[Ge.key]},Ge.key))},Z.id))]})]})]}),st&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>_t(null),children:""})]}),e.jsx(St,{label:"Nazwa",value:st.name}),e.jsx(St,{label:"Typ",value:st.stakeholder_type==="internal"?"Wewntrzny":"Zewntrzny"}),e.jsx(St,{label:"Kategoria",value:st.category_name}),e.jsx(St,{label:"Wpyw",value:gs(st.influence_level),color:pl(st.influence_level)}),e.jsx(St,{label:"Istotno",value:gs(st.relevance),color:pl(st.relevance)}),e.jsx(St,{label:"Kana komunikacji",value:st.communication_channel}),e.jsx(St,{label:"Jednostka",value:st.org_unit_name}),st.needs_expectations&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Potrzeby / oczekiwania"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:st.needs_expectations})]}),!st.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>fi(st),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>Bl(st.id),children:"Dezaktywuj"})]})]})]})}function Es(){return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Zakresy Systemw Zarzdzania"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ge({}),ja(!0)},children:"+ Dodaj zakres"})]}),ne.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",color:"var(--text-muted)",padding:30},children:"Zakres nie zosta zdefiniowany dla tej jednostki ani jednostek nadrzdnych."}):ne.map(Z=>e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsxs("h4",{style:{margin:0,fontSize:14},children:[e.jsx("span",{style:{padding:"2px 8px",borderRadius:8,fontSize:12,background:Z.inherited?"var(--blue-dim)":"var(--green-dim)",color:Z.inherited?"var(--blue)":"var(--green)",marginRight:8},children:Z.management_system_name??"Oglny"}),"Wersja ",Z.version]}),!Z.inherited&&e.jsx("button",{className:"btn btn-sm",onClick:()=>{ge({management_system_id:Z.management_system_id,scope_statement:Z.scope_statement,in_scope_description:Z.in_scope_description,out_of_scope_description:Z.out_of_scope_description,geographic_boundaries:Z.geographic_boundaries,technology_boundaries:Z.technology_boundaries,organizational_boundaries:Z.organizational_boundaries,interfaces_dependencies:Z.interfaces_dependencies,approved_by:Z.approved_by,approved_date:Z.approved_date}),ja(!0)},children:"Edytuj"})]}),e.jsxs("div",{style:{fontSize:13},children:[Z.inherited&&e.jsxs("div",{style:{marginBottom:12,padding:"8px 12px",background:"var(--blue-dim)",borderRadius:6,fontSize:12},children:["Odziedziczono z: ",e.jsx("strong",{children:Z.org_unit_name})]}),e.jsx(St,{label:"Zatwierdzony przez",value:Z.approved_by}),e.jsx(St,{label:"Data zatwierdzenia",value:Z.approved_date}),Z.scope_statement&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Owiadczenie o zakresie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.scope_statement})]}),Z.in_scope_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"W zakresie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.in_scope_description})]}),Z.out_of_scope_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Poza zakresem"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.out_of_scope_description})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:14},children:[Z.geographic_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice geograficzne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.geographic_boundaries})]}),Z.technology_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice technologiczne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.technology_boundaries})]}),Z.organizational_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice organizacyjne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:Z.organizational_boundaries})]})]})]})]},Z.id))]})}function mr(){return e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Apetyt na Ryzyko"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ae(T?{risk_appetite_statement:T.risk_appetite_statement,max_acceptable_risk_level:T.max_acceptable_risk_level,max_acceptable_risk_score:T.max_acceptable_risk_score,exception_approval_authority:T.exception_approval_authority,financial_risk_tolerance:T.financial_risk_tolerance,reputational_risk_tolerance:T.reputational_risk_tolerance,operational_risk_tolerance:T.operational_risk_tolerance}:{}),se(!0)},children:T&&!T.inherited?"Edytuj":"Zdefiniuj wasny"})]}),T?e.jsxs("div",{style:{fontSize:13},children:[T.inherited&&e.jsxs("div",{style:{marginBottom:12,padding:"8px 12px",background:"var(--blue-dim)",borderRadius:6,fontSize:12},children:["Odziedziczono z: ",e.jsx("strong",{children:T.org_unit_name})]}),e.jsx(St,{label:"Maks. akceptowalny poziom ryzyka",value:gs(T.max_acceptable_risk_level),color:pl(T.max_acceptable_risk_level)}),e.jsx(St,{label:"Maks. akceptowalny wynik ryzyka",value:T.max_acceptable_risk_score}),e.jsx(St,{label:"Organ zatwierdzajcy wyjtki",value:T.exception_approval_authority}),e.jsx(St,{label:"Zatwierdzony przez",value:T.approved_by}),e.jsx(St,{label:"Data zatwierdzenia",value:T.approved_date}),T.risk_appetite_statement&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Owiadczenie o apetycie na ryzyko"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.risk_appetite_statement})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:14},children:[T.financial_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja fin."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.financial_risk_tolerance})]}),T.reputational_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja reput."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.reputational_risk_tolerance})]}),T.operational_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja oper."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.operational_risk_tolerance})]})]})]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:30},children:"Apetyt na ryzyko nie zosta zdefiniowany."})]})}function Ll(){return e.jsxs("div",{children:[e.jsx(ma,{search:D,onSearchChange:de,columns:s,visibleColumns:x,onToggleColumn:j,data:k,filteredCount:k.length,totalCount:k.length,unitLabel:"przegldw",exportFilename:"kontekst-przeglady",primaryLabel:"Dodaj przegld",onPrimaryAction:()=>oe(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:s.filter(Z=>x.has(Z.key)).map(Z=>e.jsx("th",{children:Z.header},Z.key))})}),e.jsxs("tbody",{children:[k.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak przegldw"})}),k.map(Z=>e.jsx("tr",{children:s.filter(Ge=>x.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.format?Ge.format(Z):Z[Ge.key]},Ge.key))},Z.id))]})]})]})}function Ml(){return e.jsxs(gt,{open:ve,onClose:()=>{je(!1),It(null),tt(!1)},title:zt?"Edytuj czynnik":"Nowy czynnik kontekstowy",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:Te.issue_type,onChange:Z=>Me({...Te,issue_type:Z.target.value}),children:[e.jsx("option",{value:"internal",children:"Wewntrzny"}),e.jsx("option",{value:"external",children:"Zewntrzny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Istotno"}),e.jsxs("select",{className:"form-control",value:Te.relevance,onChange:Z=>Me({...Te,relevance:Z.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoka"}),e.jsx("option",{value:"medium",children:"rednia"}),e.jsx("option",{value:"low",children:"Niska"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tytu *"}),e.jsx("input",{className:"form-control",style:hi(!!Te.title),value:Te.title,onChange:Z=>Me({...Te,title:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:Te.description,onChange:Z=>Me({...Te,description:Z.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Wpyw"}),e.jsxs("select",{className:"form-control",value:Te.impact_level,onChange:Z=>Me({...Te,impact_level:Z.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"positive",children:"Pozytywny"}),e.jsx("option",{value:"negative",children:"Negatywny"}),e.jsx("option",{value:"neutral",children:"Neutralny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data przegldu"}),e.jsx("input",{type:"date",className:"form-control",value:Te.review_date,onChange:Z=>Me({...Te,review_date:Z.target.value})})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Dziaanie"}),e.jsx("textarea",{className:"form-control",rows:2,value:Te.response_action,onChange:Z=>Me({...Te,response_action:Z.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{je(!1),It(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>zt?Rl(zt):Ye(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function mi(){return e.jsxs(gt,{open:fe,onClose:()=>{_e(!1),rt(null),tt(!1)},title:va?"Edytuj zobowizanie":"Nowe zobowizanie",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:yt.obligation_type,onChange:Z=>jt({...yt,obligation_type:Z.target.value}),children:[e.jsx("option",{value:"legal",children:"Prawne"}),e.jsx("option",{value:"regulatory",children:"Regulacyjne"}),e.jsx("option",{value:"contractual",children:"Kontraktowe"}),e.jsx("option",{value:"voluntary",children:"Dobrowolne"}),e.jsx("option",{value:"internal",children:"Wewntrzne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status zgodnoci"}),e.jsxs("select",{className:"form-control",value:yt.compliance_status,onChange:Z=>jt({...yt,compliance_status:Z.target.value}),children:[e.jsx("option",{value:"not_assessed",children:"Nieoceniony"}),e.jsx("option",{value:"compliant",children:"Zgodny"}),e.jsx("option",{value:"partially_compliant",children:"Czciowo zgodny"}),e.jsx("option",{value:"non_compliant",children:"Niezgodny"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:hi(!!yt.custom_name),value:yt.custom_name,onChange:Z=>jt({...yt,custom_name:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:yt.description,onChange:Z=>jt({...yt,description:Z.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Odpowiedzialny"}),e.jsx("input",{className:"form-control",value:yt.responsible_person,onChange:Z=>jt({...yt,responsible_person:Z.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Obowizuje od"}),e.jsx("input",{type:"date",className:"form-control",value:yt.effective_from,onChange:Z=>jt({...yt,effective_from:Z.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{_e(!1),rt(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>va?bc(va):Kt(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function pi(){return e.jsxs(gt,{open:Se,onClose:()=>{Ve(!1),ca(null),tt(!1)},title:oa?"Edytuj interesariusza":"Nowy interesariusz",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:sa.stakeholder_type,onChange:Z=>Pa({...sa,stakeholder_type:Z.target.value}),children:[e.jsx("option",{value:"internal",children:"Wewntrzny"}),e.jsx("option",{value:"external",children:"Zewntrzny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Istotno"}),e.jsxs("select",{className:"form-control",value:sa.relevance,onChange:Z=>Pa({...sa,relevance:Z.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoka"}),e.jsx("option",{value:"medium",children:"rednia"}),e.jsx("option",{value:"low",children:"Niska"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:hi(!!sa.name),value:sa.name,onChange:Z=>Pa({...sa,name:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:sa.description,onChange:Z=>Pa({...sa,description:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Potrzeby / oczekiwania"}),e.jsx("textarea",{className:"form-control",rows:2,value:sa.needs_expectations,onChange:Z=>Pa({...sa,needs_expectations:Z.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ wymaga"}),e.jsxs("select",{className:"form-control",value:sa.requirements_type,onChange:Z=>Pa({...sa,requirements_type:Z.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"legal",children:"Prawne"}),e.jsx("option",{value:"contractual",children:"Kontraktowe"}),e.jsx("option",{value:"voluntary",children:"Dobrowolne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poziom wpywu"}),e.jsxs("select",{className:"form-control",value:sa.influence_level,onChange:Z=>Pa({...sa,influence_level:Z.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"low",children:"Niski"})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{Ve(!1),ca(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>oa?Ns(oa):qn(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function kc(){return e.jsxs(gt,{open:be,onClose:()=>{oe(!1),tt(!1)},title:"Nowy przegld kontekstu",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data przegldu *"}),e.jsx("input",{type:"date",className:"form-control",style:hi(!!Zt.review_date),value:Zt.review_date,onChange:Z=>ur({...Zt,review_date:Z.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ"}),e.jsxs("select",{className:"form-control",value:Zt.review_type,onChange:Z=>ur({...Zt,review_type:Z.target.value}),children:[e.jsx("option",{value:"scheduled",children:"Planowany"}),e.jsx("option",{value:"triggered",children:"Wyzwolony"}),e.jsx("option",{value:"initial",children:"Pocztkowy"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Przegldajcy *"}),e.jsx("input",{className:"form-control",style:hi(!!Zt.reviewer),value:Zt.reviewer,onChange:Z=>ur({...Zt,reviewer:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Podsumowanie zmian"}),e.jsx("textarea",{className:"form-control",rows:3,value:Zt.changes_summary,onChange:Z=>ur({...Zt,changes_summary:Z.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data nastpnego przegldu"}),e.jsx("input",{type:"date",className:"form-control",value:Zt.next_review_date,onChange:Z=>ur({...Zt,next_review_date:Z.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{oe(!1),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:fr,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function Il(){return e.jsxs(gt,{open:za,onClose:()=>ja(!1),title:"Zakres Systemu Zarzdzania",wide:!0,children:[e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Norma ISO"}),e.jsxs("select",{className:"form-control",value:Et.management_system_id??"",onChange:Z=>ge({...Et,management_system_id:Z.target.value?Number(Z.target.value):null}),children:[e.jsx("option",{value:"",children:" wybierz norm "}),Ft.map(Z=>e.jsx("option",{value:Z.id,children:Z.label},Z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Owiadczenie o zakresie"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.scope_statement??"",onChange:Z=>ge({...Et,scope_statement:Z.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"W zakresie"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.in_scope_description??"",onChange:Z=>ge({...Et,in_scope_description:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poza zakresem"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.out_of_scope_description??"",onChange:Z=>ge({...Et,out_of_scope_description:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice geograficzne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.geographic_boundaries??"",onChange:Z=>ge({...Et,geographic_boundaries:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice technologiczne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.technology_boundaries??"",onChange:Z=>ge({...Et,technology_boundaries:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice organizacyjne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.organizational_boundaries??"",onChange:Z=>ge({...Et,organizational_boundaries:Z.target.value||null})})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Interfejsy / zalenoci"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.interfaces_dependencies??"",onChange:Z=>ge({...Et,interfaces_dependencies:Z.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzony przez"}),e.jsx("input",{className:"form-control",value:Et.approved_by??"",onChange:Z=>ge({...Et,approved_by:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data zatwierdzenia"}),e.jsx("input",{type:"date",className:"form-control",value:Et.approved_date??"",onChange:Z=>ge({...Et,approved_date:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>ja(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:jc,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function zc(){return e.jsx(gt,{open:it,onClose:()=>Be(!1),title:"Dodaj jednostk organizacyjn",children:e.jsxs("form",{onSubmit:Fe,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Jednostka nadrzdna"}),e.jsx(jn,{tree:y,value:xe,onChange:Ie,placeholder:"Brak (najwyszy poziom)",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poziom *"}),e.jsxs("select",{name:"level_id",className:"form-control",required:!0,children:[e.jsx("option",{value:"",children:"Wybierz..."}),ze.map(Z=>e.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,placeholder:"np. Dzia IT"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Symbol *"}),e.jsx("input",{name:"symbol",className:"form-control",required:!0,placeholder:"np. DIT"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Waciciel biznesowy"}),e.jsx("input",{name:"owner",className:"form-control",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator bezpieczestwa"}),e.jsx("input",{name:"security_contact",className:"form-control",placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator IT"}),e.jsx("input",{name:"it_coordinator",className:"form-control",placeholder:"np. Piotr Winiewski"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",placeholder:"Opis jednostki..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>Be(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:at,children:at?"Zapisywanie...":"Dodaj jednostk"})]})]})})}function Ji(){return e.jsxs(gt,{open:Y,onClose:()=>se(!1),title:"Apetyt na ryzyko",wide:!0,children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Owiadczenie o apetycie na ryzyko"}),e.jsx("textarea",{className:"form-control",rows:3,value:te.risk_appetite_statement??"",onChange:Z=>ae({...te,risk_appetite_statement:Z.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Maks. poziom ryzyka"}),e.jsxs("select",{className:"form-control",value:te.max_acceptable_risk_level??"",onChange:Z=>ae({...te,max_acceptable_risk_level:Z.target.value||null}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"low",children:"Niski"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"high",children:"Wysoki"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Maks. wynik ryzyka"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:te.max_acceptable_risk_score??"",onChange:Z=>ae({...te,max_acceptable_risk_score:Z.target.value?Number(Z.target.value):null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzanie wyjtkw"}),e.jsx("input",{className:"form-control",value:te.exception_approval_authority??"",onChange:Z=>ae({...te,exception_approval_authority:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja fin."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.financial_risk_tolerance??"",onChange:Z=>ae({...te,financial_risk_tolerance:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja reput."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.reputational_risk_tolerance??"",onChange:Z=>ae({...te,reputational_risk_tolerance:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja oper."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.operational_risk_tolerance??"",onChange:Z=>ae({...te,operational_risk_tolerance:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzony przez"}),e.jsx("input",{className:"form-control",value:te.approved_by??"",onChange:Z=>ae({...te,approved_by:Z.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data zatwierdzenia"}),e.jsx("input",{type:"date",className:"form-control",value:te.approved_date??"",onChange:Z=>ae({...te,approved_date:Z.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>se(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:Gu,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}}const y3=["HardDrive","Server","Monitor","Laptop","Smartphone","Printer","Database","Network","Globe","Router","Shield","Code","Layers","AppWindow","Cloud","Settings","Users","User","UsersGroup","Briefcase","FileText","File","Table","Key","Building","MapPin","Door","Workflow","GitBranch","Headphones"],Gv=[{value:"text",label:"Tekst"},{value:"number",label:"Liczba"},{value:"date",label:"Data"},{value:"boolean",label:"Tak/Nie"},{value:"select",label:"Lista wyboru"},{value:"multiselect",label:"Wielokrotny wybor"},{value:"reference",label:"Referencja do aktywa"},{value:"textarea",label:"Tekst wieloliniowy"},{value:"url",label:"URL"},{value:"email",label:"Email"}],Kv=["#3B82F6","#2563EB","#1D4ED8","#60A5FA","#8B5CF6","#7C3AED","#A78BFA","#10B981","#059669","#34D399","#6EE7B7","#F59E0B","#D97706","#FBBF24","#EF4444","#DC2626","#F87171","#06B6D4","#0891B2","#22D3EE","#EC4899","#DB2777","#F97316","#6366F1","#14B8A6"];function v3(){const[t,n]=m.useState([]),[a,s]=m.useState(null),[o,c]=m.useState(!0),[u,h]=m.useState([]),[f,p]=m.useState(!1),[x,j]=m.useState([]),[y,S]=m.useState(!1),[w,b]=m.useState(null),[_,E]=m.useState(!1),[z,N]=m.useState(!1),[O,Q]=m.useState(null),[U,L]=m.useState(!1),[H,A]=m.useState(!1),[R,G]=m.useState(null),[F,q]=m.useState(!1),[ee,me]=m.useState("fields"),W=m.useMemo(()=>{const fe=[],_e=Se=>{for(const Ve of Se)fe.push(Ve),_e(Ve.children)};return _e(t),fe},[t]),J=m.useCallback(()=>{c(!0),le.get("/api/v1/asset-categories/tree?include_inactive=true").then(n).catch(()=>{}).finally(()=>c(!1))},[]),M=m.useCallback(()=>{le.get("/api/v1/asset-categories/relationship-types/all?include_inactive=true").then(j).catch(()=>{})},[]);m.useEffect(()=>{J(),M()},[J,M]),m.useEffect(()=>{a?(p(!0),le.get(`/api/v1/asset-categories/${a.id}/fields`).then(h).catch(()=>h([])).finally(()=>p(!1))):h([])},[a?.id]);const V=fe=>{b(null),S(!0)},ne=fe=>{b(fe),S(!0)},P=async fe=>{fe.preventDefault(),E(!0);const _e=new FormData(fe.currentTarget),Se={name:_e.get("name"),name_plural:_e.get("name_plural")||null,code:_e.get("code"),icon:_e.get("icon")||null,color:_e.get("color")||null,description:_e.get("description")||null,is_abstract:_e.get("is_abstract")==="true",sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0,parent_id:_e.get("parent_id")?Number(_e.get("parent_id")):null};try{w?await le.put(`/api/v1/asset-categories/${w.id}`,Se):await le.post("/api/v1/asset-categories",Se),S(!1),b(null),J()}catch(Ve){alert("Blad zapisu: "+Ve)}finally{E(!1)}},T=async fe=>{const _e=fe.is_active?"dezaktywowac":"aktywowac";if(confirm(`${_e} kategorie "${fe.name}"?`))try{fe.is_active?await le.delete(`/api/v1/asset-categories/${fe.id}`):await le.put(`/api/v1/asset-categories/${fe.id}`,{is_active:!0}),J()}catch(Se){alert("Blad: "+Se)}},C=()=>{Q(null),N(!0)},k=fe=>{Q(fe),N(!0)},I=async fe=>{if(fe.preventDefault(),!a)return;L(!0);const _e=new FormData(fe.currentTarget);let Se=null;const Ve=(_e.get("options_raw")||"").trim();Ve&&(Se=Ve.split(`
`).map(oe=>oe.trim()).filter(Boolean));const be={category_id:a.id,field_key:_e.get("field_key"),label:_e.get("label"),label_en:_e.get("label_en")||null,field_type:_e.get("field_type"),tab_name:_e.get("tab_name")||"Informacje",is_required:_e.get("is_required")==="true",is_unique:_e.get("is_unique")==="true",default_value:_e.get("default_value")||null,placeholder:_e.get("placeholder")||null,help_text:_e.get("help_text")||null,min_value:_e.get("min_value")?Number(_e.get("min_value")):null,max_value:_e.get("max_value")?Number(_e.get("max_value")):null,max_length:_e.get("max_length")?Number(_e.get("max_length")):null,options_json:Se,reference_category_id:_e.get("reference_category_id")?Number(_e.get("reference_category_id")):null,show_in_list:_e.get("show_in_list")==="true",sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0,column_width:_e.get("column_width")?Number(_e.get("column_width")):150};try{O?await le.put(`/api/v1/asset-categories/fields/${O.id}`,be):await le.post(`/api/v1/asset-categories/${a.id}/fields`,be),N(!1),Q(null);const oe=await le.get(`/api/v1/asset-categories/${a.id}/fields`);h(oe)}catch(oe){alert("Blad zapisu pola: "+oe)}finally{L(!1)}},D=async fe=>{if(!(!a||!confirm(`Usunac pole "${fe.label}"?`)))try{await le.delete(`/api/v1/asset-categories/fields/${fe.id}`);const _e=await le.get(`/api/v1/asset-categories/${a.id}/fields`);h(_e)}catch(_e){alert("Blad: "+_e)}},de=()=>{G(null),A(!0)},he=fe=>{G(fe),A(!0)},ie=async fe=>{fe.preventDefault(),q(!0);const _e=new FormData(fe.currentTarget),Se={code:_e.get("code"),name:_e.get("name"),name_reverse:_e.get("name_reverse")||null,color:_e.get("color")||null,icon:_e.get("icon")||null,description:_e.get("description")||null,sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0};try{R?await le.put(`/api/v1/asset-categories/relationship-types/${R.id}`,Se):await le.post("/api/v1/asset-categories/relationship-types",Se),A(!1),G(null),M()}catch(Ve){alert("Blad: "+Ve)}finally{q(!1)}},ve=async fe=>{const _e=fe.is_active?"dezaktywowac":"aktywowac";if(confirm(`${_e} typ relacji "${fe.name}"?`))try{fe.is_active?await le.delete(`/api/v1/asset-categories/relationship-types/${fe.id}`):await le.put(`/api/v1/asset-categories/relationship-types/${fe.id}`,{is_active:!0}),M()}catch(Se){alert("Blad: "+Se)}},je=m.useMemo(()=>{const fe=new Map;for(const _e of u){const Se=_e.tab_name||"Informacje";fe.has(Se)||fe.set(Se,[]),fe.get(Se).push(_e)}for(const[,_e]of fe)_e.sort((Se,Ve)=>Se.sort_order-Ve.sort_order);return fe},[u]);return e.jsxs("div",{style:{display:"flex",height:"calc(100vh - 56px)",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:220,maxWidth:280,width:250,borderRight:"1px solid var(--border)",background:"var(--bg-card)"},children:[e.jsx(vb,{tree:t,selectedId:a?.id??null,onSelect:fe=>s(fe),loading:o}),e.jsx("div",{style:{padding:8,borderTop:"1px solid var(--border)"},children:e.jsx("button",{className:"btn btn-sm btn-primary",style:{width:"100%",fontSize:11},onClick:()=>V(),children:"+ Nowa kategoria"})})]}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"0 20px 20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 0 8px"},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Administracja CMDB"}),e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim, rgba(139,92,246,0.15))",color:"var(--purple, #8B5CF6)",fontSize:11},children:"Kategorie & Formularze"})]}),a?e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{className:"card",style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:6},children:[e.jsx("span",{style:{fontSize:22},children:a.icon||""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"var(--text-primary)"},children:a.name}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:a.code})]})]}),a.description&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:12,marginTop:4,marginBottom:0},children:a.description}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("span",{className:"score-badge",style:{background:a.is_abstract?"var(--orange-dim, rgba(245,158,11,0.15))":"var(--green-dim, rgba(16,185,129,0.15))",color:a.is_abstract?"var(--orange)":"var(--green)",fontSize:10},children:a.is_abstract?"Grupa (abstrakcyjna)":"Konkretna (przypisywalna)"}),e.jsxs("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:[a.asset_count," aktywow"]}),!a.is_active&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim, rgba(239,68,68,0.15))",color:"var(--red)",fontSize:10},children:"Nieaktywna"})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>ne(a),children:"Edytuj kategorie"}),e.jsx("button",{className:"btn btn-sm",style:{color:a.is_active?"var(--red)":"var(--green)"},onClick:()=>T(a),children:a.is_active?"Dezaktywuj":"Aktywuj"})]})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("h3",{style:{margin:0,fontSize:15,fontWeight:600},children:["Definicja formularza (",u.length," pol)"]}),!a.is_abstract&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:C,children:"+ Dodaj pole"})]}),a.is_abstract?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:"Kategorie abstrakcyjne (grupy) nie maja wlasnych pol formularza. Pola definiuje sie na konkretnych podkategoriach."}):f?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:"Ladowanie pol..."}):u.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:'Brak zdefiniowanych pol. Kliknij "Dodaj pole" aby rozpoczac budowe formularza.'}):[...je.entries()].map(([fe,_e])=>e.jsxs("div",{className:"card",style:{marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"var(--text-primary)",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",background:"var(--bg-subtle)",padding:"2px 8px",borderRadius:8},children:"Zakladka"}),fe]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"#"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Klucz"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Etykieta"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Typ"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Wymagane"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"W liscie"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Zrodlo"}),e.jsx("th",{style:{textAlign:"right",padding:"6px 8px"}})]})}),e.jsx("tbody",{children:_e.map(Se=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"5px 8px",fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:Se.sort_order}),e.jsx("td",{style:{padding:"5px 8px",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:Se.field_key}),e.jsx("td",{style:{padding:"5px 8px",fontWeight:500},children:Se.label}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center"},children:e.jsx("span",{className:"score-badge",style:{background:"var(--bg-subtle)",color:"var(--text-secondary)",fontSize:10},children:Gv.find(Ve=>Ve.value===Se.field_type)?.label||Se.field_type})}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center",color:Se.is_required?"var(--red)":"var(--text-muted)"},children:Se.is_required?"":""}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center",color:Se.show_in_list?"var(--green)":"var(--text-muted)"},children:Se.show_in_list?"":""}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center"},children:Se.inherited_from_id?e.jsx("span",{style:{fontSize:9,color:"var(--purple)",background:"rgba(139,92,246,0.1)",padding:"2px 6px",borderRadius:8},children:"Odziedziczone"}):e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)"},children:"Wlasne"})}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"right"},children:!Se.inherited_from_id&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 6px",marginRight:4},onClick:()=>k(Se),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 6px",color:"var(--red)"},onClick:()=>D(Se),children:"Usun"})]})})]},Se.id))})]})]},fe))]}):e.jsxs("div",{style:{marginTop:20},children:[e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-title",children:"Przegladaj kategorie"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Wybierz kategorie z drzewa po lewej stronie, aby zarzadzac jej polami formularza. Mozesz tez dodac nowa kategorie przyciskiem na dole panelu."})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"fields",label:"Statystyki kategorii"},{key:"reltypes",label:`Typy relacji (${x.length})`}].map(fe=>e.jsx("div",{onClick:()=>me(fe.key),style:{padding:"8px 16px",fontSize:13,cursor:"pointer",borderBottom:ee===fe.key?"2px solid var(--blue)":"2px solid var(--border)",color:ee===fe.key?"var(--blue)":"var(--text-muted)",fontWeight:ee===fe.key?600:400},children:fe.label},fe.key))}),ee==="fields"&&e.jsx("div",{className:"card",children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kategoria"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kod"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Typ"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywow"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywna"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 10px"}})]})}),e.jsx("tbody",{children:W.map(fe=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)",opacity:fe.is_active?1:.4},children:[e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx("span",{style:{paddingLeft:fe.parent_id?16:0,fontWeight:fe.is_abstract?600:400},children:fe.name})}),e.jsx("td",{style:{padding:"6px 10px",fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:fe.code}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("span",{className:"score-badge",style:{background:fe.is_abstract?"var(--orange-dim, rgba(245,158,11,0.15))":"var(--green-dim, rgba(16,185,129,0.15))",color:fe.is_abstract?"var(--orange)":"var(--green)",fontSize:10},children:fe.is_abstract?"Grupa":"Konkretna"})}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center",fontFamily:"'JetBrains Mono',monospace"},children:fe.asset_count}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.is_active?"":""}),e.jsxs("td",{style:{padding:"6px 10px",textAlign:"right"},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginRight:4},onClick:()=>ne(fe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:fe.is_active?"var(--red)":"var(--green)"},onClick:()=>T(fe),children:fe.is_active?"Dezaktywuj":"Aktywuj"})]})]},fe.id))})]})}),ee==="reltypes"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:"Typy relacji miedzy aktywami"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:de,children:"+ Dodaj typ"})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kod"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa odwrotna"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kolor"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywny"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 10px"}})]})}),e.jsx("tbody",{children:x.map(fe=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)",opacity:fe.is_active?1:.4},children:[e.jsx("td",{style:{padding:"6px 10px",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:fe.code}),e.jsx("td",{style:{padding:"6px 10px"},children:fe.name}),e.jsx("td",{style:{padding:"6px 10px",color:"var(--text-muted)"},children:fe.name_reverse||""}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.color&&e.jsx("span",{style:{display:"inline-block",width:16,height:16,borderRadius:"50%",background:fe.color,verticalAlign:"middle"}})}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.is_active?"":""}),e.jsxs("td",{style:{padding:"6px 10px",textAlign:"right"},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginRight:4},onClick:()=>he(fe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:fe.is_active?"var(--red)":"var(--green)"},onClick:()=>ve(fe),children:fe.is_active?"Dezaktywuj":"Aktywuj"})]})]},fe.id))})]})]})]})]}),e.jsx(gt,{open:y,onClose:()=>{S(!1),b(null)},title:w?`Edytuj: ${w.name}`:"Nowa kategoria",wide:!0,children:e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:w?.name??"",placeholder:"np. Serwery"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa w l. mnogiej"}),e.jsx("input",{name:"name_plural",className:"form-control",defaultValue:w?.name_plural??"",placeholder:"np. Serwery"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod (unikalny) *"}),e.jsx("input",{name:"code",className:"form-control",required:!0,defaultValue:w?.code??"",placeholder:"np. servers",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria nadrzedna"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:w?.parent_id??a?.id??"",children:[e.jsx("option",{value:"",children:"Brak (glowny poziom)"}),W.filter(fe=>!w||fe.id!==w.id).map(fe=>e.jsxs("option",{value:fe.id,children:[fe.parent_id?"  ":"",fe.name]},fe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ikona"}),e.jsxs("select",{name:"icon",className:"form-control",defaultValue:w?.icon??"",children:[e.jsx("option",{value:"",children:"Brak"}),y3.map(fe=>e.jsx("option",{value:fe,children:fe},fe))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("div",{style:{display:"flex",gap:4,alignItems:"center"},children:e.jsx("input",{name:"color",className:"form-control",defaultValue:w?.color??"",placeholder:"#3B82F6",style:{flex:1}})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:3,marginTop:6},children:Kv.map(fe=>e.jsx("span",{onClick:_e=>{const Se=_e.currentTarget.parentElement?.parentElement?.querySelector('input[name="color"]');Se&&(Se.value=fe)},style:{width:18,height:18,borderRadius:4,background:fe,cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"}},fe))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc sortowania"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:w?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ kategorii"}),e.jsxs("select",{name:"is_abstract",className:"form-control",defaultValue:w?.is_abstract?"true":"false",children:[e.jsx("option",{value:"false",children:"Konkretna (przypisywalna do aktywow)"}),e.jsx("option",{value:"true",children:"Abstrakcyjna (grupa/folder)"})]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:w?.description??"",placeholder:"Opcjonalny opis kategorii"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{S(!1),b(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:_,children:_?"Zapisywanie...":w?"Zapisz zmiany":"Utwrz kategorie"})]})]})}),e.jsx(gt,{open:z,onClose:()=>{N(!1),Q(null)},title:O?`Edytuj pole: ${O.label}`:"Nowe pole formularza",wide:!0,children:e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Klucz pola (field_key) *"}),e.jsx("input",{name:"field_key",className:"form-control",required:!0,defaultValue:O?.field_key??"",placeholder:"np. hostname",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Unikalny identyfikator pola w JSON-ie custom_attributes"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta (PL) *"}),e.jsx("input",{name:"label",className:"form-control",required:!0,defaultValue:O?.label??"",placeholder:"np. Nazwa hosta"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta (EN)"}),e.jsx("input",{name:"label_en",className:"form-control",defaultValue:O?.label_en??"",placeholder:"np. Hostname"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ pola *"}),e.jsx("select",{name:"field_type",className:"form-control",required:!0,defaultValue:O?.field_type??"text",children:Gv.map(fe=>e.jsx("option",{value:fe.value,children:fe.label},fe.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zakladka"}),e.jsx("input",{name:"tab_name",className:"form-control",defaultValue:O?.tab_name??"Informacje",placeholder:"np. Informacje"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Nazwa zakladki w formularzu (Informacje, Zarzadzanie, Bezpieczenstwo...)"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:O?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Placeholder"}),e.jsx("input",{name:"placeholder",className:"form-control",defaultValue:O?.placeholder??"",placeholder:"np. Wpisz wartosc..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wartosc domyslna"}),e.jsx("input",{name:"default_value",className:"form-control",defaultValue:O?.default_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wymagane"}),e.jsxs("select",{name:"is_required",className:"form-control",defaultValue:O?.is_required?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Unikalne"}),e.jsxs("select",{name:"is_unique",className:"form-control",defaultValue:O?.is_unique?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Widoczne w liscie"}),e.jsxs("select",{name:"show_in_list",className:"form-control",defaultValue:O?.show_in_list?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak  pokaz jako kolumne w tabeli"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Szerokosc kolumny (px)"}),e.jsx("input",{name:"column_width",type:"number",className:"form-control",defaultValue:O?.column_width??150})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Min. wartosc (number)"}),e.jsx("input",{name:"min_value",type:"number",className:"form-control",defaultValue:O?.min_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max. wartosc (number)"}),e.jsx("input",{name:"max_value",type:"number",className:"form-control",defaultValue:O?.max_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max. dlugosc (text)"}),e.jsx("input",{name:"max_length",type:"number",className:"form-control",defaultValue:O?.max_length??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria referencyjna (reference)"}),e.jsxs("select",{name:"reference_category_id",className:"form-control",defaultValue:O?.reference_category_id??"",children:[e.jsx("option",{value:"",children:"Brak"}),W.filter(fe=>!fe.is_abstract).map(fe=>e.jsx("option",{value:fe.id,children:fe.name},fe.id))]}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:'Tylko dla typu "Referencja do aktywa"'})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opcje (select / multiselect)"}),e.jsx("textarea",{name:"options_raw",className:"form-control",rows:3,defaultValue:O?.options_json?j3(O.options_json):"",placeholder:`Jedna opcja na linie, np.:
Produkcja
Staging
Development
Test`}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Kazda linia = jedna opcja. Dotyczy typow: Lista wyboru, Wielokrotny wybor."})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tekst pomocy"}),e.jsx("textarea",{name:"help_text",className:"form-control",rows:2,defaultValue:O?.help_text??"",placeholder:"Dodatkowa informacja dla uzytkownika..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{N(!1),Q(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:U,children:U?"Zapisywanie...":O?"Zapisz zmiany":"Dodaj pole"})]})]})}),e.jsx(gt,{open:H,onClose:()=>{A(!1),G(null)},title:R?`Edytuj: ${R.name}`:"Nowy typ relacji",children:e.jsxs("form",{onSubmit:ie,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod (unikalny) *"}),e.jsx("input",{name:"code",className:"form-control",required:!0,defaultValue:R?.code??"",placeholder:"np. depends_on",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki",disabled:!!R})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:'Nazwa (np. "Zalezy od") *'}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:R?.name??"",placeholder:"np. Zalezy od"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:'Nazwa odwrotna (np. "Jest wymagany przez")'}),e.jsx("input",{name:"name_reverse",className:"form-control",defaultValue:R?.name_reverse??"",placeholder:"np. Jest wymagany przez"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("input",{name:"color",className:"form-control",defaultValue:R?.color??"",placeholder:"#3B82F6"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:3,marginTop:6},children:Kv.slice(0,12).map(fe=>e.jsx("span",{onClick:_e=>{const Se=_e.currentTarget.parentElement?.parentElement?.querySelector('input[name="color"]');Se&&(Se.value=fe)},style:{width:18,height:18,borderRadius:4,background:fe,cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"}},fe))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ikona"}),e.jsx("input",{name:"icon",className:"form-control",defaultValue:R?.icon??"",placeholder:"np. ArrowRight"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:R?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:R?.description??""})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{A(!1),G(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:F,children:F?"Zapisywanie...":R?"Zapisz":"Utwrz"})]})]})})]})}function j3(t){if(!t)return"";let n=t;if(typeof t=="string")try{n=JSON.parse(t)}catch{return String(t)}return Array.isArray(n)?n.map(a=>typeof a=="string"?a:typeof a=="object"&&a!==null&&"label"in a?String(a.label):String(a)).join(`
`):""}const Qd="",b3=[{id:"executive",title:"Executive Summary",description:"Podsumowanie wykonawcze: KPI, top ryzyka, przeglad aktywow wg kategorii CMDB.",icon:"",endpoint:"/api/v1/reports/executive"},{id:"risks",title:"Rejestr Ryzyk",description:"Pelny rejestr ryzyk z ocenami, statusami, wlascicielami i terminami.",icon:"",endpoint:"/api/v1/reports/risks",params:[{key:"org_unit_id",label:"Jednostka org. (ID, opcjonalnie)",type:"number"}]},{id:"assets",title:"Rejestr Aktywow (CMDB)",description:"Lista aktywow z kategoriami CMDB, wlascicielami, lokalizacjami i ryzykami.",icon:"",endpoint:"/api/v1/reports/assets",params:[{key:"asset_category_id",label:"Kategoria CMDB (ID, opcjonalnie)",type:"number"}]}];function _3(){const[t,n]=m.useState(null),[a,s]=m.useState(null),[o,c]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState([]),[y,S]=m.useState(!1),w=m.useRef(!1),b=m.useCallback(async()=>{try{const N=await fetch(`${Qd}/api/v1/reports/ai-management/history`);N.ok&&j(await N.json())}catch{}},[]);m.useEffect(()=>{b()},[b]),m.useEffect(()=>{const N=O=>{w.current&&(confirm(`Generowanie raportu AI jest w toku. Cofniecie przerwie proces.

Czy na pewno chcesz przerwac?`)||(O.preventDefault(),window.history.pushState(null,"",window.location.href)))};return window.addEventListener("popstate",N),()=>window.removeEventListener("popstate",N)},[]);const _=async(N,O)=>{n(N.id);try{const Q=new URLSearchParams;if(O)for(const[G,F]of Object.entries(O))F&&Q.set(G,F);const U=Q.toString()?`?${Q.toString()}`:"",L=await fetch(`${Qd}${N.endpoint}${U}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const H=await L.blob(),A=URL.createObjectURL(H),R=document.createElement("a");R.href=A,R.download=`raport_${N.id}_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(A)}catch(Q){alert("Blad generowania raportu: "+Q)}finally{n(null)}},E=async()=>{h(!0),w.current=!0,c(null),s(null),p({percent:0,message:"Laczenie z modelem AI..."});const N=U=>(U.preventDefault(),U.returnValue="Generowanie raportu AI jest w toku. Przeladowanie strony przerwie proces. Kontynuowac?",U.returnValue);window.addEventListener("beforeunload",N);const Q=[{at:800,percent:5,message:"Zbieranie danych z systemu..."},{at:2500,percent:12,message:"Analiza rejestru ryzyk..."},{at:5e3,percent:22,message:"Analiza aktywow i podatnosci..."},{at:8e3,percent:35,message:"Analiza incydentow i compliance..."},{at:12e3,percent:48,message:"AI generuje raport zarzadczy..."},{at:2e4,percent:60,message:"AI analizuje korelacje i trendy..."},{at:3e4,percent:72,message:"AI przygotowuje rekomendacje..."},{at:45e3,percent:82,message:"AI finalizuje sekcje raportu..."},{at:6e4,percent:88,message:"Oczekiwanie na odpowiedz AI..."},{at:9e4,percent:92,message:"Wciaz czekam na AI  dluzszy raport..."}].map(U=>setTimeout(()=>p({percent:U.percent,message:U.message}),U.at));try{const U=await fetch(`${Qd}/api/v1/reports/ai-management`);if(!U.ok){const H=await U.json().catch(()=>null);throw new Error(H?.detail||`HTTP ${U.status}`)}const L=await U.json();p({percent:100,message:"Raport wygenerowany pomyslnie"}),s(L),b()}catch(U){c(U instanceof Error?U.message:String(U)),p(null)}finally{window.removeEventListener("beforeunload",N),Q.forEach(U=>clearTimeout(U)),h(!1),w.current=!1,setTimeout(()=>p(null),4e3)}},z=async N=>{S(!0),c(null);try{const O=await fetch(`${Qd}/api/v1/reports/ai-management/${N}`);if(!O.ok)throw new Error(`HTTP ${O.status}`);s(await O.json())}catch(O){c(O instanceof Error?O.message:String(O))}finally{S(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Raporty"}),e.jsx("span",{className:"score-badge",style:{background:"var(--cyan-dim, rgba(6,182,212,0.15))",color:"var(--cyan, #06B6D4)",fontSize:11},children:"Excel / XLSX"})]}),e.jsx("div",{className:"grid-3",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:16},children:b3.map(N=>e.jsx(S3,{report:N,generating:t===N.id,onGenerate:_},N.id))}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginTop:32,marginBottom:20},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:" Raport Zarzadczy AI"}),e.jsx("span",{className:"score-badge",style:{background:"rgba(139,92,246,0.15)",color:"#8b5cf6",fontSize:11},children:"AI"})]}),e.jsxs("div",{className:"grid-3",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:16},children:[e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,marginBottom:10},children:[e.jsx("span",{style:{fontSize:28},children:""}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:14,fontWeight:600,color:"var(--text-primary)",marginBottom:4},children:"Raport Zarzadczy AI"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.4},children:"Kompleksowy raport dla zarzadu generowany przez AI na podstawie aktualnych danych: ryzyka, aktywa, podatnosci, incydenty, compliance, Security Score."})]})]}),e.jsx("div",{style:{marginTop:"auto"},children:e.jsx("button",{className:"btn btn-primary",style:{width:"100%",background:u?void 0:"#7c3aed"},disabled:u,onClick:E,children:u?" Generowanie raportu AI...":" Generuj raport AI"})})]}),e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:10},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:"Historia raportow"})]}),x.length===0?e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",padding:"12px 0"},children:"Brak zapisanych raportow. Wygeneruj pierwszy raport AI."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,maxHeight:240,overflowY:"auto"},children:x.map(N=>e.jsxs("button",{className:"btn btn-sm",style:{textAlign:"left",fontSize:12,padding:"6px 10px",display:"flex",justifyContent:"space-between",alignItems:"center",opacity:y?.6:1},disabled:y,onClick:()=>z(N.id),children:[e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:8},children:N.title}),e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)",whiteSpace:"nowrap"},children:new Date(N.generated_at).toLocaleString("pl-PL")})]},N.id))})]})]}),f&&e.jsxs("div",{className:"card no-print",style:{marginTop:12,padding:"14px 16px",borderLeft:`3px solid ${f.percent>=100?"var(--green)":"#7c3aed"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:f.percent>=100?" Raport wygenerowany":" Generowanie raportu AI..."}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[f.percent,"%"]})]}),e.jsx("div",{className:"bar-track",style:{height:8,marginBottom:6},children:e.jsx("div",{className:"bar-fill",style:{width:`${f.percent}%`,background:f.percent>=100?"var(--green)":"#7c3aed",transition:"width 0.5s ease"}})}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:f.message}),f.percent<100&&e.jsx("div",{style:{fontSize:11,color:"var(--orange)",marginTop:6,fontWeight:500},children:"Nie zamykaj ani nie przeladowuj strony  generowanie zostanie przerwane."})]}),o&&e.jsxs("div",{className:"card",style:{marginTop:16,borderLeft:"4px solid #ef4444",background:"rgba(239,68,68,0.05)"},children:[e.jsx("div",{style:{fontSize:13,color:"#ef4444",fontWeight:600,marginBottom:4},children:"Blad generowania raportu AI"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:o})]}),a&&e.jsx(w3,{data:a})]})}function S3({report:t,generating:n,onGenerate:a}){const[s,o]=m.useState(!1),[c,u]=m.useState({});return e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,marginBottom:10},children:[e.jsx("span",{style:{fontSize:28},children:t.icon}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)",marginBottom:4},children:t.title}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.4},children:t.description})]})]}),t.params&&t.params.length>0&&e.jsx("div",{children:s?e.jsx("div",{style:{marginBottom:10,padding:10,background:"var(--bg-inset)",borderRadius:6,border:"1px solid var(--border)"},children:t.params.map(h=>e.jsxs("div",{className:"form-group",style:{marginBottom:8},children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)"},children:h.label}),e.jsx("input",{className:"form-control",type:h.type,value:c[h.key]||"",onChange:f=>u(p=>({...p,[h.key]:f.target.value})),style:{fontSize:12}})]},h.key))}):e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginBottom:8},onClick:()=>o(!0),children:"Parametry filtrowania..."})}),e.jsx("div",{style:{marginTop:"auto"},children:e.jsx("button",{className:"btn btn-primary",style:{width:"100%"},disabled:n,onClick:()=>a(t,c),children:n?"Generowanie...":"Pobierz raport (XLSX)"})})]})}const zm={krytyczny:"#dc2626",wysoki:"#ef4444",sredni:"#f59e0b",niski:"#22c55e"},qv={krytyczny:"#dc2626",wysoki:"#ef4444",umiarkowany:"#f59e0b",niski:"#22c55e"};function w3({data:t}){const n=t.report,a=new Date(t.generated_at).toLocaleString("pl-PL"),s=()=>{window.print()};return e.jsxs("div",{className:"card",style:{marginTop:24,padding:24},id:"ai-report",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24,borderBottom:"2px solid var(--border)",paddingBottom:16},children:[e.jsxs("div",{children:[e.jsxs("h3",{style:{margin:0,fontSize:20,fontWeight:700,color:"#7c3aed",display:"flex",alignItems:"center",gap:10},children:[e.jsx("span",{style:{fontSize:24},children:""}),"Raport Zarzadczy  SecurePosture"]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:["Wygenerowano: ",a," | AI-powered"]})]}),e.jsx("button",{className:"btn btn-sm",onClick:s,style:{fontSize:11},children:"Drukuj / PDF"})]}),n.executive_summary&&e.jsx(xs,{title:"Podsumowanie wykonawcze",icon:"",children:e.jsx("p",{style:{fontSize:13,lineHeight:1.7,whiteSpace:"pre-line"},children:n.executive_summary})}),n.risk_assessment&&e.jsxs(xs,{title:"Ocena profilu ryzyka",icon:"",children:[n.risk_assessment.overall_rating&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"Ocena ogolna: "}),e.jsx("span",{style:{fontSize:13,fontWeight:700,padding:"2px 10px",borderRadius:4,background:`${qv[n.risk_assessment.overall_rating]||"#6b7280"}20`,color:qv[n.risk_assessment.overall_rating]||"#6b7280"},children:n.risk_assessment.overall_rating.toUpperCase()})]}),n.risk_assessment.analysis&&e.jsx("p",{style:{fontSize:13,lineHeight:1.7,whiteSpace:"pre-line"},children:n.risk_assessment.analysis}),n.risk_assessment.key_concerns&&n.risk_assessment.key_concerns.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:6,color:"var(--text-muted)"},children:"Glowne obawy:"}),e.jsx("ul",{style:{margin:0,paddingLeft:20,fontSize:13,lineHeight:1.6},children:n.risk_assessment.key_concerns.map((o,c)=>e.jsx("li",{children:o.concern||o.description||JSON.stringify(o)},c))})]})]}),n.strengths&&n.strengths.length>0&&e.jsx(xs,{title:"Mocne strony",icon:"",children:e.jsx("div",{style:{display:"grid",gap:8},children:n.strengths.map((o,c)=>e.jsxs("div",{style:{padding:10,background:"rgba(34,197,94,0.05)",borderRadius:6,borderLeft:"3px solid #22c55e"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#16a34a"},children:o.area}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:o.description})]},c))})}),n.critical_findings&&n.critical_findings.length>0&&e.jsx(xs,{title:"Krytyczne ustalenia",icon:"",children:e.jsx("div",{style:{display:"grid",gap:8},children:n.critical_findings.map((o,c)=>e.jsxs("div",{style:{padding:10,background:"rgba(239,68,68,0.04)",borderRadius:6,borderLeft:`3px solid ${zm[o.severity]||"#6b7280"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:o.finding}),e.jsx("span",{style:{fontSize:10,fontWeight:700,padding:"1px 8px",borderRadius:4,background:`${zm[o.severity]||"#6b7280"}20`,color:zm[o.severity]||"#6b7280"},children:o.severity})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:[e.jsx("strong",{children:"Wplyw:"})," ",o.impact]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:[e.jsx("strong",{children:"Rekomendacja:"})," ",o.recommendation]})]},c))})}),n.recommendations&&n.recommendations.length>0&&e.jsx(xs,{title:"Rekomendacje",icon:"",children:e.jsxs("table",{style:{width:"100%",fontSize:12,borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600,width:30},children:"P"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Dzialanie"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Naklad"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Rola"})]})}),e.jsx("tbody",{children:n.recommendations.sort((o,c)=>o.priority-c.priority).map((o,c)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:700,color:o.priority<=2?"#ef4444":o.priority<=3?"#f59e0b":"#6b7280"},children:o.priority}),e.jsxs("td",{style:{padding:"8px"},children:[e.jsx("div",{style:{fontWeight:500},children:o.action}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:o.rationale})]}),e.jsx("td",{style:{padding:"8px",color:"var(--text-muted)"},children:o.estimated_effort||"-"}),e.jsx("td",{style:{padding:"8px",color:"var(--text-muted)"},children:o.responsible_role||"-"})]},c))})]})}),n.action_plan&&n.action_plan.length>0&&e.jsx(xs,{title:"Plan dzialan (90 dni)",icon:"",children:e.jsx("div",{style:{display:"grid",gap:8},children:n.action_plan.map((o,c)=>e.jsxs("div",{style:{display:"flex",gap:12,padding:10,background:"var(--bg-inset)",borderRadius:6},children:[e.jsxs("div",{style:{minWidth:50,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#3b82f6"},children:o.deadline_days}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)"},children:"dni"})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:o.action}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:2},children:[o.responsible_role,"  ",o.expected_outcome]})]})]},c))})}),n.kpi_targets&&n.kpi_targets.length>0&&e.jsx(xs,{title:"Cele KPI na nastepny kwartal",icon:"",children:e.jsxs("table",{style:{width:"100%",fontSize:12,borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"KPI"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Obecnie"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Cel"}),e.jsx("th",{style:{padding:"6px 8px",color:"var(--text-muted)",fontWeight:600},children:"Uzasadnienie"})]})}),e.jsx("tbody",{children:n.kpi_targets.map((o,c)=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"8px",fontWeight:500},children:o.kpi_name}),e.jsx("td",{style:{padding:"8px",color:"var(--text-muted)"},children:String(o.current_value)}),e.jsx("td",{style:{padding:"8px",fontWeight:600,color:"#3b82f6"},children:String(o.target_value)}),e.jsx("td",{style:{padding:"8px",fontSize:11,color:"var(--text-muted)"},children:o.rationale})]},c))})]})})]})}function xs({title:t,icon:n,children:a}){return e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:15,fontWeight:700,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:n})," ",t]}),a]})}const Ua="",k3=[{key:"threats",label:"Zagrozenia",icon:""},{key:"weaknesses",label:"Podatnosci",icon:""},{key:"controls",label:"Zabezpieczenia",icon:""},{key:"correlations",label:"Mapa Powiazan",icon:""},{key:"coverage",label:"Analiza Luk i Skutecznosci",icon:""}],z3={key:"ai",label:"AI Asystent",icon:""},C3=["NATURAL","ENVIRONMENTAL","HUMAN_INTENTIONAL","HUMAN_ACCIDENTAL","TECHNICAL","ORGANIZATIONAL"],T3=["INTERNAL","EXTERNAL","BOTH"],N3=["HARDWARE","SOFTWARE","NETWORK","PERSONNEL","SITE","ORGANIZATION","PROCESS"],A3=["TECHNICAL","ORGANIZATIONAL","PHYSICAL","LEGAL"],E3=["PREVENTIVE","DETECTIVE","CORRECTIVE","DETERRENT","COMPENSATING"],F3=["HIGH","MEDIUM","LOW"],Wi={NATURAL:"#06b6d4",ENVIRONMENTAL:"#0891b2",HUMAN_INTENTIONAL:"#dc2626",HUMAN_ACCIDENTAL:"#f59e0b",TECHNICAL:"#8b5cf6",ORGANIZATIONAL:"#3b82f6",HARDWARE:"#64748b",SOFTWARE:"#8b5cf6",NETWORK:"#06b6d4",PERSONNEL:"#f59e0b",SITE:"#84cc16",ORGANIZATION:"#3b82f6",PROCESS:"#ec4899",PHYSICAL:"#84cc16",LEGAL:"#a855f7",PREVENTIVE:"#16a34a",DETECTIVE:"#2563eb",CORRECTIVE:"#ea580c",DETERRENT:"#dc2626",COMPENSATING:"#6366f1"},gn={HIGH:"#dc2626",MEDIUM:"#f59e0b",LOW:"#16a34a"};function Ot({text:t,color:n}){return e.jsx("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:600,background:n?`${n}22`:"var(--bg-alt)",color:n??"var(--text-muted)",whiteSpace:"nowrap"},children:t})}function Yv({cia:t}){return t?e.jsxs("span",{style:{fontFamily:"monospace",fontSize:13,letterSpacing:2},children:[e.jsx("span",{style:{color:t.C?"#dc2626":"var(--border)",fontWeight:t.C?700:400},children:"C"}),e.jsx("span",{style:{color:t.I?"#f59e0b":"var(--border)",fontWeight:t.I?700:400},children:"I"}),e.jsx("span",{style:{color:t.A?"#16a34a":"var(--border)",fontWeight:t.A?700:400},children:"A"})]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}function Qa({number:t,label:n}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",n]})}function pn({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function R3({pct:t,label:n,gaps:a}){const s=t>=80?"#16a34a":t>=50?"#f59e0b":"#dc2626";return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4},children:[e.jsx("span",{children:n}),e.jsxs("span",{children:[e.jsxs("span",{style:{fontWeight:700,color:s},children:[t.toFixed(0),"%"]}),a>0&&e.jsxs("span",{style:{color:"#dc2626",marginLeft:8,fontSize:11},children:[a," luk"]})]})]}),e.jsx("div",{style:{height:8,background:"var(--bg-alt)",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${Math.min(t,100)}%`,background:s,borderRadius:4,transition:"width 0.5s ease"}})})]})}const Cm=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"source",header:"Zrodlo"},{key:"cia_impact",header:"CIA",format:()=>""},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],Tm=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],Nm=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"implementation_type",header:"Typ impl."},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],Jv=[{key:"threat_ref_id",header:"Zagrozenie (Ref)",format:t=>t.threat_ref_id??""},{key:"threat_name",header:"Zagrozenie",format:t=>t.threat_name??""},{key:"weakness_ref_id",header:"Podatnosc (Ref)",format:t=>t.weakness_ref_id??""},{key:"weakness_name",header:"Podatnosc",format:t=>t.weakness_name??""},{key:"control_ref_id",header:"Zabezpieczenie (Ref)",format:t=>t.control_ref_id??""},{key:"control_name",header:"Zabezpieczenie",format:t=>t.control_name??""},{key:"relevance",header:"Istotnosc",format:t=>t.relevance??""},{key:"effectiveness",header:"Skutecznosc",format:t=>t.effectiveness??""},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"}];function B3(){const{aiEnabled:t,hasFeature:n}=Mp(),[a,s]=m.useState("threats"),[o,c]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState([]),[x,j]=m.useState([]),[y,S]=m.useState(!0),[w,b]=m.useState(null),[_,E]=m.useState(!1),[z,N]=m.useState(null),[O,Q]=m.useState(null),U=m.useMemo(()=>{const K=[...k3];return t&&K.push(z3),K},[t]),[L,H]=m.useState(!1),[A,R]=m.useState(null),[G,F]=m.useState(!1),[q,ee]=m.useState(null),[me,W]=m.useState(null),[J,M]=m.useState(null),[V,ne]=m.useState([]),[P,T]=m.useState([]),[C,k]=m.useState("tw"),[I,D]=m.useState([]),[de,he]=m.useState(!1),[ie,ve]=m.useState(null),[je,fe]=m.useState(!1),[_e,Se]=m.useState(null),[Ve,be]=m.useState({}),[oe,Ue]=m.useState(!1),[Qe,lt]=m.useState({}),[tt,ht]=m.useState([]),[xt,qe]=m.useState([]),[Nt,st]=m.useState([]),[_t,zt]=m.useState(!1),[It,va]=m.useState({threats:"",weaknesses:"",controls:""}),[rt,oa]=m.useState(null),[ca,ze]=m.useState(!1),[et,it]=m.useState(!1),Be=Aa({data:o,storageKey:"catalog-threats",defaultSort:"ref_id"}),at=Aa({data:u,storageKey:"catalog-weaknesses",defaultSort:"ref_id"}),nt=Aa({data:f,storageKey:"catalog-controls",defaultSort:"ref_id"}),ut=Aa({data:I,storageKey:"catalog-links",defaultSort:"threat_ref_id"}),{visible:ta,toggle:Pt}=da(Cm,"catalog-threats"),{visible:Tt,toggle:xe}=da(Tm,"catalog-weaknesses"),{visible:Ie,toggle:mt}=da(Nm,"catalog-controls"),{visible:Oe}=da(Jv,"catalog-links"),ct=m.useCallback(async()=>{S(!0),b(null);try{const[K,ue,ke,Te]=await Promise.all([fetch(`${Ua}/api/v1/threat-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/weakness-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/control-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/asset-categories`).then(Me=>Me.ok?Me.json():[]).catch(()=>[])]);c(K),h(ue),p(ke),j(Array.isArray(Te)?Te.filter(Me=>!Me.is_abstract):[])}catch(K){b(K instanceof Error?K.message:"Blad ladowania danych")}finally{S(!1)}},[]);m.useEffect(()=>{ct()},[ct]);const At=m.useCallback(async K=>{try{const[ue,ke]=await Promise.all([fetch(`${Ua}/api/v1/suggestions/weaknesses?threat_id=${K}`).then(Te=>Te.json()),fetch(`${Ua}/api/v1/suggestions/controls?threat_id=${K}`).then(Te=>Te.json())]);ne(ue),T(ke)}catch{}},[]),za=m.useCallback(async K=>{he(!0);try{const ke=await fetch(`${Ua}/api/v1/links/${K==="tw"?"threat-weakness":K==="tc"?"threat-control":"weakness-control"}`).then(Te=>Te.json());D(ke)}catch{D([])}finally{he(!1)}},[]),ja=m.useCallback(async()=>{try{const[K,ue,ke]=await Promise.all([fetch(`${Ua}/api/v1/links/threat-weakness`).then(Te=>Te.json()).catch(()=>[]),fetch(`${Ua}/api/v1/links/threat-control`).then(Te=>Te.json()).catch(()=>[]),fetch(`${Ua}/api/v1/links/weakness-control`).then(Te=>Te.json()).catch(()=>[])]);ht(K),qe(ue),st(ke),zt(!0)}catch{}},[]),Et=m.useCallback(K=>({weaknesses:tt.filter(ue=>ue.threat_id===K),controls:xt.filter(ue=>ue.threat_id===K)}),[tt,xt]),ge=m.useCallback(K=>({threats:tt.filter(ue=>ue.weakness_id===K),controls:Nt.filter(ue=>ue.weakness_id===K)}),[tt,Nt]),Ft=m.useCallback(K=>({threats:xt.filter(ue=>ue.control_id===K),weaknesses:Nt.filter(ue=>ue.control_id===K)}),[xt,Nt]),ga=m.useCallback(async()=>{Ue(!0);const K=x.filter(ke=>!ke.is_abstract),ue={};await Promise.all(K.map(async ke=>{try{const Te=await fetch(`${Ua}/api/v1/coverage/asset-category/${ke.id}`).then(Me=>Me.json());ue[ke.id]=Te}catch{}})),be(ue),Ue(!1)},[x]);m.useEffect(()=>{a==="correlations"&&(za(C),_t||ja())},[a,C,za,_t,ja]),m.useEffect(()=>{a==="coverage"&&x.length>0&&(ga(),_t||ja())},[a,x,ga,_t,ja]),m.useEffect(()=>{(q||me||J)&&!_t&&ja()},[q,me,J,_t,ja]),m.useEffect(()=>{ee(null),W(null),M(null),ve(null),ne([]),T([])},[a]);const Y=m.useMemo(()=>a==="threats"?[{label:"Zagrozenia",value:Be.filteredCount,total:Be.totalCount,color:"#dc2626"},{label:"Systemowe",value:Be.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Kategorie",value:new Set(Be.filtered.map(K=>K.category)).size,color:"#8b5cf6"},{label:"Zewnetrzne",value:Be.filtered.filter(K=>K.source==="EXTERNAL").length,color:"#f59e0b"}]:a==="weaknesses"?[{label:"Podatnosci",value:at.filteredCount,total:at.totalCount,color:"#f59e0b"},{label:"Systemowe",value:at.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Kategorie",value:new Set(at.filtered.map(K=>K.category)).size,color:"#8b5cf6"}]:a==="controls"?[{label:"Zabezpieczenia",value:nt.filteredCount,total:nt.totalCount,color:"#16a34a"},{label:"Systemowe",value:nt.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Prewencyjne",value:nt.filtered.filter(K=>K.implementation_type==="PREVENTIVE").length,color:"#16a34a"},{label:"Detektywne",value:nt.filtered.filter(K=>K.implementation_type==="DETECTIVE").length,color:"#2563eb"}]:a==="correlations"?[{label:"Korelacje",value:ut.filteredCount,total:ut.totalCount,color:"#8b5cf6"},{label:"Systemowe",value:ut.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"HIGH",value:ut.filtered.filter(K=>(K.relevance??K.effectiveness)==="HIGH").length,color:"#dc2626"}]:[],[a,Be,at,nt,ut]),se=a==="threats"?Be.filteredCount!==Be.totalCount:a==="weaknesses"?at.filteredCount!==at.totalCount:a==="controls"?nt.filteredCount!==nt.totalCount:a==="correlations"?ut.filteredCount!==ut.totalCount:!1,te=async K=>{F(!0);try{const ue=!!A;let ke="";a==="threats"?ke=`${Ua}/api/v1/threat-catalog`:a==="weaknesses"?ke=`${Ua}/api/v1/weakness-catalog`:a==="controls"&&(ke=`${Ua}/api/v1/control-catalog`),ue&&(ke+=`/${A.id}`),await fetch(ke,{method:ue?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)}),H(!1),R(null),await ct()}catch(ue){alert(ue instanceof Error?ue.message:"Blad zapisu")}finally{F(!1)}},ae=async(K,ue)=>{if(!confirm("Archiwizowac wpis?"))return;await fetch(`${Ua}/api/v1/${K==="threat"?"threat-catalog":K==="weakness"?"weakness-catalog":"control-catalog"}/${ue}`,{method:"DELETE"}),await ct()},re=async K=>{F(!0);try{const ue=C==="tw"?"threat-weakness":C==="tc"?"threat-control":"weakness-control",ke=!!_e,Te=ke?`${Ua}/api/v1/links/${ue}/${_e.id}`:`${Ua}/api/v1/links/${ue}`;await fetch(Te,{method:ke?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)}),fe(!1),Se(null),await za(C)}catch(ue){alert(ue instanceof Error?ue.message:"Blad zapisu korelacji")}finally{F(!1)}},ce=async K=>{if(!confirm("Usunac korelacje?"))return;await fetch(`${Ua}/api/v1/links/${C==="tw"?"threat-weakness":C==="tc"?"threat-control":"weakness-control"}/${K}`,{method:"DELETE"}),ve(null),await za(C)},Ce=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="source")return e.jsx(Ot,{text:K.source});if(ue==="cia_impact")return e.jsx(Yv,{cia:K.cia_impact});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},De=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},Ne=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="implementation_type")return e.jsx(Ot,{text:K.implementation_type,color:Wi[K.implementation_type]});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},Fe=(K,ue)=>{if(ue==="threat_ref_id"||ue==="weakness_ref_id"||ue==="control_ref_id"){const ke=K[ue];return ke?e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:String(ke)}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}if(ue==="relevance")return K.relevance?e.jsx(Ot,{text:K.relevance,color:gn[K.relevance]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(ue==="effectiveness")return K.effectiveness?e.jsx(Ot,{text:K.effectiveness,color:gn[K.effectiveness]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"})};return y?e.jsx("div",{className:"page-loading",children:"Ladowanie Smart Catalog..."}):w?e.jsxs("div",{className:"card",style:{color:"#dc2626",padding:24},children:["Blad: ",w]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:e.jsx("h2",{style:{margin:0},children:"Katalog Zagrozen, Podatnosci i Zabezpieczen"})}),e.jsx("div",{style:{display:"flex",gap:4,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:0},children:U.map(K=>e.jsxs("button",{onClick:()=>s(K.key),style:{padding:"8px 16px",border:"none",cursor:"pointer",background:a===K.key?"var(--blue)":"transparent",color:a===K.key?"#fff":"var(--text-muted)",borderRadius:"6px 6px 0 0",fontWeight:a===K.key?600:400,fontSize:13,transition:"all 0.2s"},children:[K.icon," ",K.label]},K.key))}),Y.length>0&&e.jsx(Ia,{cards:Y,isFiltered:se}),a==="threats"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:Be.filteredCount,totalCount:Be.totalCount,unitLabel:"zagrozenia",search:Be.search,onSearchChange:Be.setSearch,searchPlaceholder:"Szukaj zagrozenia...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:Be.hasActiveFilters,onClearFilters:Be.clearAllFilters,columns:Cm,visibleColumns:ta,onToggleColumn:Pt,data:Be.filtered,exportFilename:"zagrozenia",primaryLabel:"Nowe zagrozenie",onPrimaryAction:()=>{R(null),H(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:q?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:Cm,visibleColumns:ta,data:Be.pageData,rowKey:K=>K.id,selectedKey:q?.id??null,onRowClick:K=>{q?.id===K.id?ee(null):(ee(K),At(K.id))},renderCell:Ce,sortField:Be.sortField,sortDir:Be.sortDir,onSort:Be.toggleSort,columnFilters:Be.columnFilters,onColumnFilter:Be.setColumnFilter,showFilters:et,page:Be.page,totalPages:Be.totalPages,pageSize:Be.pageSize,totalItems:Be.totalCount,filteredItems:Be.filteredCount,onPageChange:Be.setPage,onPageSizeChange:Be.setPageSize,loading:y,emptyMessage:"Brak zagrozenia w katalogu.",emptyFilteredMessage:"Brak zagrozenia pasujacych do filtrow."}),q&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly zagrozenia"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(q),H(!0)},children:"Edytuj"}),!q.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("threat",q.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>ee(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane zagrozenia"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:q.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:q.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:q.category,color:Wi[q.category]})}),e.jsx(pn,{label:"Zrodlo",value:e.jsx(Ot,{text:q.source})}),e.jsx(pn,{label:"CIA",value:e.jsx(Yv,{cia:q.cia_impact})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:q.is_system?"Systemowy":"Organizacyjny",color:q.is_system?"#3b82f6":"#16a34a"})}),q.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:q.description})]}),q.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:q.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=Et(q.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane podatnosci (${K.weaknesses.length})`}),K.weaknesses.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.weaknesses.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=u.find(Te=>Te.id===ue.weakness_id);ke&&(s("weaknesses"),W(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.weakness_ref_id})," ",ue.weakness_name]}),ue.relevance&&e.jsx(Ot,{text:ue.relevance,color:gn[ue.relevance]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane zabezpieczenia (${K.controls.length})`}),K.controls.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.controls.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=f.find(Te=>Te.id===ue.control_id);ke&&(s("controls"),M(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.control_ref_id})," ",ue.control_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})(),e.jsx(Qa,{number:"",label:`Sugerowane podatnosci (${V.length})`}),V.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak sugestii"}),V.map(K=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id})," ",K.name]}),e.jsx(Ot,{text:K.relevance,color:gn[K.relevance]})]},K.weakness_id)),e.jsx(Qa,{number:"",label:`Sugerowane zabezpieczenia (${P.length})`}),P.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak sugestii"}),P.map(K=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id})," ",K.name,K.applied_status&&e.jsx(Ot,{text:K.applied_status,color:"#16a34a"})]}),e.jsx(Ot,{text:K.effectiveness,color:gn[K.effectiveness]})]},K.control_id))]})]})]})]}),a==="weaknesses"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:at.filteredCount,totalCount:at.totalCount,unitLabel:"podatnosci",search:at.search,onSearchChange:at.setSearch,searchPlaceholder:"Szukaj podatnosci...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:at.hasActiveFilters,onClearFilters:at.clearAllFilters,columns:Tm,visibleColumns:Tt,onToggleColumn:xe,data:at.filtered,exportFilename:"podatnosci",primaryLabel:"Nowa podatnosc",onPrimaryAction:()=>{R(null),H(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:me?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:Tm,visibleColumns:Tt,data:at.pageData,rowKey:K=>K.id,selectedKey:me?.id??null,onRowClick:K=>W(me?.id===K.id?null:K),renderCell:De,sortField:at.sortField,sortDir:at.sortDir,onSort:at.toggleSort,columnFilters:at.columnFilters,onColumnFilter:at.setColumnFilter,showFilters:et,page:at.page,totalPages:at.totalPages,pageSize:at.pageSize,totalItems:at.totalCount,filteredItems:at.filteredCount,onPageChange:at.setPage,onPageSizeChange:at.setPageSize,loading:y,emptyMessage:"Brak podatnosci w katalogu.",emptyFilteredMessage:"Brak podatnosci pasujacych do filtrow."}),me&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly podatnosci"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(me),H(!0)},children:"Edytuj"}),!me.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("weakness",me.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>W(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane podatnosci"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:me.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:me.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:me.category,color:Wi[me.category]})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:me.is_system?"Systemowy":"Organizacyjny",color:me.is_system?"#3b82f6":"#16a34a"})}),me.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:me.description})]}),me.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:me.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=ge(me.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane zagrozenia (${K.threats.length})`}),K.threats.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.threats.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=o.find(Te=>Te.id===ue.threat_id);ke&&(s("threats"),ee(ke),At(ke.id))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.threat_ref_id})," ",ue.threat_name]}),ue.relevance&&e.jsx(Ot,{text:ue.relevance,color:gn[ue.relevance]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane zabezpieczenia (${K.controls.length})`}),K.controls.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.controls.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=f.find(Te=>Te.id===ue.control_id);ke&&(s("controls"),M(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.control_ref_id})," ",ue.control_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})()]})]})]})]}),a==="controls"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:nt.filteredCount,totalCount:nt.totalCount,unitLabel:"zabezpieczen",search:nt.search,onSearchChange:nt.setSearch,searchPlaceholder:"Szukaj zabezpieczen...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:nt.hasActiveFilters,onClearFilters:nt.clearAllFilters,columns:Nm,visibleColumns:Ie,onToggleColumn:mt,data:nt.filtered,exportFilename:"zabezpieczenia",primaryLabel:"Nowe zabezpieczenie",onPrimaryAction:()=>{R(null),H(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:J?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:Nm,visibleColumns:Ie,data:nt.pageData,rowKey:K=>K.id,selectedKey:J?.id??null,onRowClick:K=>M(J?.id===K.id?null:K),renderCell:Ne,sortField:nt.sortField,sortDir:nt.sortDir,onSort:nt.toggleSort,columnFilters:nt.columnFilters,onColumnFilter:nt.setColumnFilter,showFilters:et,page:nt.page,totalPages:nt.totalPages,pageSize:nt.pageSize,totalItems:nt.totalCount,filteredItems:nt.filteredCount,onPageChange:nt.setPage,onPageSizeChange:nt.setPageSize,loading:y,emptyMessage:"Brak zabezpieczen w katalogu.",emptyFilteredMessage:"Brak zabezpieczen pasujacych do filtrow."}),J&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly zabezpieczenia"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(J),H(!0)},children:"Edytuj"}),!J.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("control",J.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>M(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane zabezpieczenia"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:J.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:J.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:J.category,color:Wi[J.category]})}),e.jsx(pn,{label:"Typ implementacji",value:e.jsx(Ot,{text:J.implementation_type,color:Wi[J.implementation_type]})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:J.is_system?"Systemowy":"Organizacyjny",color:J.is_system?"#3b82f6":"#16a34a"})}),J.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:J.description})]}),J.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:J.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=Ft(J.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane zagrozenia (${K.threats.length})`}),K.threats.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.threats.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=o.find(Te=>Te.id===ue.threat_id);ke&&(s("threats"),ee(ke),At(ke.id))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.threat_ref_id})," ",ue.threat_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane podatnosci (${K.weaknesses.length})`}),K.weaknesses.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.weaknesses.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=u.find(Te=>Te.id===ue.weakness_id);ke&&(s("weaknesses"),W(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.weakness_ref_id})," ",ue.weakness_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})()]})]})]})]}),a==="correlations"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(139,92,246,0.06)",border:"1px solid rgba(139,92,246,0.15)",borderRadius:8,padding:"10px 16px",marginBottom:14,fontSize:12,color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsxs("span",{children:[e.jsx("strong",{children:"Mapa powiazan"}),"  trojstronny widok zagrozen, podatnosci i zabezpieczen. Kliknij element w dowolnej kolumnie aby zobaczyc jego powiazania. Mozesz tworzyc nowe korelacje bezposrednio z tego widoku."]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["Korelacje: ",e.jsx("strong",{children:tt.length+xt.length+Nt.length})]}),e.jsxs("select",{className:"form-control",value:C,onChange:K=>{k(K.target.value),oa(null)},style:{width:260,padding:"5px 10px",fontSize:12},children:[e.jsx("option",{value:"tw",children:"Zagrozenie  Podatnosc"}),e.jsx("option",{value:"tc",children:"Zagrozenie  Zabezpieczenie"}),e.jsx("option",{value:"wc",children:"Podatnosc  Zabezpieczenie"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{Se(null),fe(!0)},children:"+ Nowa korelacja"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{border:"1px solid rgba(220,38,38,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(220,38,38,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#dc2626"},children:["Zagrozenia (",o.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj zagrozen...",value:It.threats,onChange:K=>va(ue=>({...ue,threats:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:o.filter(K=>!It.threats||K.ref_id.toLowerCase().includes(It.threats.toLowerCase())||K.name.toLowerCase().includes(It.threats.toLowerCase())).map(K=>{const ue=rt?.type==="threat"&&rt.id===K.id,ke=rt&&rt.type!=="threat"&&(rt.type==="weakness"&&tt.some(Te=>Te.threat_id===K.id&&Te.weakness_id===rt.id)||rt.type==="control"&&xt.some(Te=>Te.threat_id===K.id&&Te.control_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(220,38,38,0.15)":ke?"rgba(220,38,38,0.08)":"transparent",border:ke?"1px solid rgba(220,38,38,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"threat",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#dc2626",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#dc2626"},children:""})]},K.id)})})]}),e.jsxs("div",{style:{border:"1px solid rgba(245,158,11,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(245,158,11,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#f59e0b"},children:["Podatnosci (",u.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj podatnosci...",value:It.weaknesses,onChange:K=>va(ue=>({...ue,weaknesses:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:u.filter(K=>!It.weaknesses||K.ref_id.toLowerCase().includes(It.weaknesses.toLowerCase())||K.name.toLowerCase().includes(It.weaknesses.toLowerCase())).map(K=>{const ue=rt?.type==="weakness"&&rt.id===K.id,ke=rt&&rt.type!=="weakness"&&(rt.type==="threat"&&tt.some(Te=>Te.weakness_id===K.id&&Te.threat_id===rt.id)||rt.type==="control"&&Nt.some(Te=>Te.weakness_id===K.id&&Te.control_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(245,158,11,0.15)":ke?"rgba(245,158,11,0.08)":"transparent",border:ke?"1px solid rgba(245,158,11,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"weakness",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#f59e0b",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#f59e0b"},children:""})]},K.id)})})]}),e.jsxs("div",{style:{border:"1px solid rgba(22,163,74,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(22,163,74,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#16a34a"},children:["Zabezpieczenia (",f.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj zabezpieczen...",value:It.controls,onChange:K=>va(ue=>({...ue,controls:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:f.filter(K=>!It.controls||K.ref_id.toLowerCase().includes(It.controls.toLowerCase())||K.name.toLowerCase().includes(It.controls.toLowerCase())).map(K=>{const ue=rt?.type==="control"&&rt.id===K.id,ke=rt&&rt.type!=="control"&&(rt.type==="threat"&&xt.some(Te=>Te.control_id===K.id&&Te.threat_id===rt.id)||rt.type==="weakness"&&Nt.some(Te=>Te.control_id===K.id&&Te.weakness_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(22,163,74,0.15)":ke?"rgba(22,163,74,0.08)":"transparent",border:ke?"1px solid rgba(22,163,74,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"control",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#16a34a",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#16a34a"},children:""})]},K.id)})})]})]}),rt&&(()=>{const K=rt.type==="threat"?o.find($e=>$e.id===rt.id):rt.type==="weakness"?u.find($e=>$e.id===rt.id):f.find($e=>$e.id===rt.id);if(!K)return null;const ue=rt.type==="threat"?"Zagrozenie":rt.type==="weakness"?"Podatnosc":"Zabezpieczenie",ke=rt.type==="threat"?"#dc2626":rt.type==="weakness"?"#f59e0b":"#16a34a",Te=rt.type==="threat"?tt.filter($e=>$e.threat_id===rt.id):rt.type==="control"?Nt.filter($e=>$e.control_id===rt.id):[],Me=rt.type==="weakness"?tt.filter($e=>$e.weakness_id===rt.id):rt.type==="control"?xt.filter($e=>$e.control_id===rt.id):[],Ye=rt.type==="threat"?xt.filter($e=>$e.threat_id===rt.id):rt.type==="weakness"?Nt.filter($e=>$e.weakness_id===rt.id):[];return e.jsxs("div",{style:{border:`1px solid ${ke}30`,borderRadius:8,padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{fontWeight:700,color:ke},children:[ue,":"]}),e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id}),e.jsx("span",{style:{fontWeight:500},children:K.name})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(K),H(!0)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>oa(null),children:""})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:(rt.type==="weakness"||rt.type==="threat","1fr 1fr"),gap:16},children:[rt.type!=="threat"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:6},children:["Powiazane zagrozenia (",Me.length,")"]}),Me.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#dc2626"},children:$e.threat_ref_id})," ",$e.threat_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[($e.relevance||$e.effectiveness)&&e.jsx(Ot,{text:$e.relevance??$e.effectiveness,color:gn[$e.relevance??$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#dc2626"},onClick:()=>{Se(null),k(rt.type==="weakness"?"tw":"tc"),fe(!0)},children:"+ Powiaz z zagrozeniem"})]}),rt.type!=="weakness"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#f59e0b",marginBottom:6},children:["Powiazane podatnosci (",Te.length,")"]}),Te.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#f59e0b"},children:$e.weakness_ref_id})," ",$e.weakness_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[($e.relevance||$e.effectiveness)&&e.jsx(Ot,{text:$e.relevance??$e.effectiveness,color:gn[$e.relevance??$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#f59e0b"},onClick:()=>{Se(null),k(rt.type==="threat"?"tw":"wc"),fe(!0)},children:"+ Powiaz z podatnoscia"})]}),rt.type!=="control"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#16a34a",marginBottom:6},children:["Powiazane zabezpieczenia (",Ye.length,")"]}),Ye.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#16a34a"},children:$e.control_ref_id})," ",$e.control_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[$e.effectiveness&&e.jsx(Ot,{text:$e.effectiveness,color:gn[$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#16a34a"},onClick:()=>{Se(null),k(rt.type==="threat"?"tc":"wc"),fe(!0)},children:"+ Powiaz z zabezpieczeniem"})]})]})]})})(),e.jsxs("details",{style:{marginTop:16},children:[e.jsxs("summary",{style:{cursor:"pointer",fontSize:12,color:"var(--text-muted)",padding:"8px 0"},children:["Widok tabelaryczny korelacji (",ut.totalCount,")"]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8,marginBottom:0},children:e.jsx("div",{className:"toolbar-left",style:{alignItems:"center"},children:e.jsx("input",{className:"form-control",style:{width:200,padding:"5px 10px",fontSize:12},placeholder:"Szukaj korelacji...",value:ut.search,onChange:K=>ut.setSearch(K.target.value)})})}),de?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie..."}):e.jsx(Ea,{columns:Jv,visibleColumns:Oe,data:ut.pageData,rowKey:K=>K.id,selectedKey:ie?.id??null,onRowClick:K=>ve(ie?.id===K.id?null:K),renderCell:Fe,sortField:ut.sortField,sortDir:ut.sortDir,onSort:ut.toggleSort,columnFilters:ut.columnFilters,onColumnFilter:ut.setColumnFilter,showFilters:et,page:ut.page,totalPages:ut.totalPages,pageSize:ut.pageSize,totalItems:ut.totalCount,filteredItems:ut.filteredCount,onPageChange:ut.setPage,onPageSizeChange:ut.setPageSize,loading:de,emptyMessage:"Brak korelacji.",emptyFilteredMessage:"Brak korelacji pasujacych do filtrow."})]})]})]}),a==="coverage"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.15)",borderRadius:8,padding:"14px 18px",marginBottom:16,fontSize:12,lineHeight:1.8},children:[e.jsx("div",{style:{fontWeight:700,fontSize:14,color:"var(--blue)",marginBottom:6},children:"Analiza Luk i Skutecznosci Zabezpieczen"}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Ta analiza pokazuje, dla kazdej kategorii aktywow:"}),e.jsxs("ul",{style:{margin:"4px 0 0 16px",padding:0,color:"var(--text-secondary)"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Pokrycie"}),"  ile zagrozen przypisanych do kategorii ma powiazane zabezpieczenia (korelacje ZagrozenieZabezpieczenie)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Luki"}),"  zagrozenia BEZ zabezpieczen. Kliknij luke aby od razu dodac brakujace zabezpieczenie"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Skutecznosc"}),"  sredni poziom skutecznosci zastosowanych zabezpieczen (na podstawie ocen korelacji)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:14},children:"Pokrycie wg kategorii aktywow"}),oe?e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:24},children:"Analizowanie pokrycia..."}):x.length===0?e.jsx("div",{style:{color:"var(--text-muted)"},children:"Brak kategorii aktywow"}):e.jsxs(e.Fragment,{children:[x.filter(K=>Ve[K.id]&&Ve[K.id].total_threats>0).sort((K,ue)=>(Ve[K.id]?.coverage_pct??0)-(Ve[ue.id]?.coverage_pct??0)).map(K=>{const ue=Ve[K.id],ke=Qe[K.id]??!1;return e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{cursor:"pointer"},onClick:()=>lt(Te=>({...Te,[K.id]:!Te[K.id]})),children:e.jsx(R3,{label:`${K.name} (${ue.covered}/${ue.total_threats})`,pct:ue.coverage_pct,gaps:ue.gaps.length})}),ke&&ue.gaps.length>0&&e.jsxs("div",{style:{marginTop:4,marginLeft:8,padding:"10px 14px",background:"rgba(220,38,38,0.04)",border:"1px solid rgba(220,38,38,0.15)",borderRadius:6},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:8},children:["Luki  zagrozenia bez zabezpieczen (",ue.gaps.length,")"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:'Te zagrozenia nie maja powiazanego zabezpieczenia. Kliknij "Dodaj zabezpieczenie" aby utworzyc korelacje.'}),ue.gaps.map((Te,Me)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{color:"#dc2626",marginRight:6},children:""}),Te.ref_id&&e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,marginRight:4},children:Te.ref_id}),Te.name??"Nieznane zagrozenie"]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,color:"#16a34a",border:"1px solid rgba(22,163,74,0.3)",background:"rgba(22,163,74,0.06)"},onClick:()=>{o.find($e=>$e.ref_id===Te.ref_id)&&(k("tc"),Se(null),fe(!0))},children:"+ Dodaj zabezpieczenie"})]},Me))]}),ke&&ue.gaps.length===0&&e.jsx("div",{style:{marginTop:4,marginLeft:8,padding:"8px 14px",fontSize:12,background:"rgba(22,163,74,0.06)",border:"1px solid rgba(22,163,74,0.15)",borderRadius:6,color:"#16a34a"},children:" Pelne pokrycie  wszystkie zagrozenia maja powiazane zabezpieczenia"})]},K.id)}),Object.keys(Ve).length===0&&e.jsx("div",{style:{color:"var(--text-muted)"},children:"Brak danych pokrycia  sprawdz czy tabele korelacji maja dane."})]})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Ocena Skutecznosci Zabezpieczen"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>ze(!ca),style:{fontSize:11},children:ca?"Zwien":"Rozwin analize"})]}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:"Ocena skutecznosci kazdego zabezpieczenia na podstawie: ilosci pokrywanych zagrozen, sredniego poziomu skutecznosci (z korelacji) oraz pokrycia kategorii aktywow."}),ca&&_t&&e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Pokrywa zagrozen"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Pokrywa podatnosci"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Sred. skutecznosc"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",color:"var(--text-muted)"},children:"Ocena"})]})}),e.jsx("tbody",{children:f.map(K=>{const ue=xt.filter(jt=>jt.control_id===K.id),ke=Nt.filter(jt=>jt.control_id===K.id),Te=[...ue,...ke].map(jt=>jt.effectiveness).filter(Boolean),Me=Te.length>0?Te.reduce((jt,Kt)=>jt+(Kt==="HIGH"?3:Kt==="MEDIUM"?2:1),0)/Te.length:0,Ye=Me>=2.5?"Skuteczne":Me>=1.5?"Czesciowe":Me>0?"Niewystarczajace":"Brak oceny",$e=Me>=2.5?"#16a34a":Me>=1.5?"#f59e0b":Me>0?"#dc2626":"var(--text-muted)",yt=Me>0?Me/3*100:0;return e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("td",{style:{padding:"6px"},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#16a34a",marginRight:4},children:K.ref_id}),K.name]}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:e.jsx("span",{style:{fontWeight:600},children:ue.length})}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:e.jsx("span",{style:{fontWeight:600},children:ke.length})}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:Te.length>0?e.jsx(Ot,{text:Me>=2.5?"HIGH":Me>=1.5?"MEDIUM":"LOW",color:$e}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsx("td",{style:{padding:"6px",minWidth:160},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:6,background:"var(--bg-alt)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${yt}%`,background:$e,borderRadius:3,transition:"width 0.5s ease"}})}),e.jsx("span",{style:{fontSize:10,color:$e,fontWeight:600,whiteSpace:"nowrap"},children:Ye})]})})]},K.id)})})]})}),ca&&!_t&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie danych korelacji..."})]})]}),a==="ai"&&t&&e.jsx(M3,{assetCategories:x,aiLoading:_,aiResult:z,aiError:O,hasFeature:n,onAction:async(K,ue)=>{E(!0),Q(null),N(null);try{const ke=await fetch(`${Ua}/api/v1/ai/${K}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!ke.ok){const Te=await ke.text();throw new Error(ke.status===503?"AI niedostepne":ke.status===429?"Limit zapytan przekroczony":Te)}N(await ke.json())}catch(ke){Q(ke instanceof Error?ke.message:"Blad AI")}finally{E(!1)}}}),e.jsx(O3,{open:L,onClose:()=>{H(!1),R(null)},tab:a,editItem:A,saving:G,onSave:te,assetCategories:x,threats:o,weaknesses:u,controls:f,allTWLinks:tt,allTCLinks:xt,allWCLinks:Nt,onLinksChanged:()=>{ja()}}),e.jsx(L3,{open:je,onClose:()=>{fe(!1),Se(null)},corrType:C,editLink:_e,saving:G,onSave:re,threats:o,weaknesses:u,controls:f})]})}function O3({open:t,onClose:n,tab:a,editItem:s,saving:o,onSave:c,assetCategories:u,threats:h,weaknesses:f,controls:p,allTWLinks:x,allTCLinks:j,allWCLinks:y,onLinksChanged:S}){const[w,b]=m.useState(""),[_,E]=m.useState(""),[z,N]=m.useState(""),[O,Q]=m.useState(""),[U,L]=m.useState("BOTH"),[H,A]=m.useState(""),[R,G]=m.useState(!1),[F,q]=m.useState(!1),[ee,me]=m.useState(!1),[W,J]=m.useState([]);m.useEffect(()=>{if(t&&s){if(b(s.ref_id),E(s.name),N(s.description??""),Q(s.category),J(s.asset_category_ids??[]),"source"in s&&L(s.source),"cia_impact"in s){const C=s.cia_impact;G(C?.C??!1),q(C?.I??!1),me(C?.A??!1)}"implementation_type"in s&&A(s.implementation_type)}else t&&(b(""),E(""),N(""),Q(""),L("BOTH"),A(""),G(!1),q(!1),me(!1),J([]))},[t,s]);const M=C=>{C.preventDefault();const k={ref_id:w,name:_,description:z||null,category:O,asset_category_ids:W};a==="threats"&&(k.source=U,k.cia_impact={C:R,I:F,A:ee}),a==="controls"&&(k.implementation_type=H),c(k)},V=s?.is_system===!0,ne=a==="threats"?C3:a==="weaknesses"?N3:A3,P=a==="threats"?"zagrozenia":a==="weaknesses"?"podatnosci":"zabezpieczenia",T=V?`Podglad ${P} (systemowy)`:s?`Edytuj ${P}`:`Nowe ${P}`;return e.jsxs(gt,{open:t,onClose:n,title:T,wide:!0,children:[V&&e.jsx("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:6,padding:"8px 12px",marginBottom:16,fontSize:12,color:"var(--blue)"},children:"Wpis systemowy  tylko podglad. Aby edytowac, utworz kopie jako wpis organizacyjny."}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Ref ID"}),e.jsx("input",{className:"form-control",value:w,onChange:C=>b(C.target.value),required:!0,placeholder:"np. T-100",disabled:!!s,readOnly:V})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:O,onChange:C=>Q(C.target.value),required:!0,disabled:V,children:[e.jsx("option",{value:"",children:"Wybierz..."}),ne.map(C=>e.jsx("option",{value:C,children:C},C))]})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Nazwa"}),e.jsx("input",{className:"form-control",value:_,onChange:C=>E(C.target.value),required:!0,placeholder:"Nazwa wpisu",readOnly:V})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",value:z,onChange:C=>N(C.target.value),rows:3,placeholder:"Opcjonalny opis...",readOnly:V,style:{resize:"vertical"}})]}),a==="threats"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zrodlo"}),e.jsx("select",{className:"form-control",value:U,onChange:C=>L(C.target.value),disabled:V,children:T3.map(C=>e.jsx("option",{value:C,children:C},C))})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",display:"block",marginBottom:4},children:"Wplyw CIA"}),e.jsxs("div",{style:{display:"flex",gap:16,marginTop:6},children:[e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:R,onChange:C=>G(C.target.checked),disabled:V}),e.jsx("span",{style:{fontWeight:600,color:"#dc2626"},children:"C"}),"onfidentiality"]}),e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:F,onChange:C=>q(C.target.checked),disabled:V}),e.jsx("span",{style:{fontWeight:600,color:"#f59e0b"},children:"I"}),"ntegrity"]}),e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ee,onChange:C=>me(C.target.checked),disabled:V}),e.jsx("span",{style:{fontWeight:600,color:"#16a34a"},children:"A"}),"vailability"]})]})]})]}),a==="controls"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Typ implementacji"}),e.jsxs("select",{className:"form-control",value:H,onChange:C=>A(C.target.value),required:!0,disabled:V,children:[e.jsx("option",{value:"",children:"Wybierz..."}),E3.map(C=>e.jsx("option",{value:C,children:C},C))]})]}),u.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",display:"block",marginBottom:4},children:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,maxHeight:120,overflow:"auto",padding:8,border:"1px solid var(--border)",borderRadius:6},children:u.map(C=>e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:W.includes(C.id),onChange:k=>{k.target.checked?J([...W,C.id]):J(W.filter(I=>I!==C.id))},disabled:V}),C.name]},C.id))})]}),s&&!V&&h&&f&&p&&e.jsx(D3,{tab:a,editItemId:s.id,threats:h,weaknesses:f,controls:p,allTWLinks:x??[],allTCLinks:j??[],allWCLinks:y??[],onLinksChanged:S}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:n,children:V?"Zamknij":"Anuluj"}),!V&&e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Zapisywanie...":s?"Zapisz zmiany":"Dodaj"})]})]})]})}function D3({tab:t,editItemId:n,threats:a,weaknesses:s,controls:o,allTWLinks:c,allTCLinks:u,allWCLinks:h,onLinksChanged:f}){const[p,x]=m.useState(!1),[j,y]=m.useState(""),[S,w]=m.useState("MEDIUM"),[b,_]=m.useState("first"),E="",z=t==="threats",N=t==="weaknesses",O=t==="controls",Q=z?c.filter(I=>I.threat_id===n):[],U=N?c.filter(I=>I.weakness_id===n):[],L=O?u.filter(I=>I.control_id===n):[],H=z?u.filter(I=>I.threat_id===n):[],A=N?h.filter(I=>I.weakness_id===n):[],R=O?h.filter(I=>I.control_id===n):[],G=z?Q:N?U:L,F=z?H:N?A:R,q=z?"Powiazane podatnosci":"Powiazane zagrozenia",ee=z||N?"Powiazane zabezpieczenia":"Powiazane podatnosci",me=z?"#f59e0b":"#dc2626",W=z||N?"#16a34a":"#f59e0b",J=z?s:a,M=z||N?o:s,V=new Set(G.map(I=>I.weakness_id??I.threat_id??I.control_id)),ne=new Set(F.map(I=>I.control_id??I.weakness_id??I.threat_id)),P=J.filter(I=>!V.has(I.id)),T=M.filter(I=>!ne.has(I.id)),C=async()=>{if(j){x(!0);try{let I="";const D={};b==="first"?z?(I="threat-weakness",D.threat_id=n,D.weakness_id=Number(j),D.relevance=S):N?(I="threat-weakness",D.threat_id=Number(j),D.weakness_id=n,D.relevance=S):(I="threat-control",D.threat_id=Number(j),D.control_id=n,D.effectiveness=S):z?(I="threat-control",D.threat_id=n,D.control_id=Number(j),D.effectiveness=S):N?(I="weakness-control",D.weakness_id=n,D.control_id=Number(j),D.effectiveness=S):(I="weakness-control",D.weakness_id=Number(j),D.control_id=n,D.effectiveness=S),await fetch(`${E}/api/v1/links/${I}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)}),y(""),w("MEDIUM"),f?.()}catch(I){alert("Blad dodawania powiazania: "+(I instanceof Error?I.message:I))}finally{x(!1)}}},k=async(I,D)=>{try{await fetch(`${E}/api/v1/links/${D}/${I}`,{method:"DELETE"}),f?.()}catch{}};return e.jsxs("div",{style:{marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--blue)",marginBottom:12},children:"Powiazania z innymi elementami katalogu"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:me,marginBottom:6},children:[q," (",G.length,")"]}),G.map(I=>{const D=I.weakness_ref_id??I.threat_ref_id??I.control_ref_id,de=I.weakness_name??I.threat_name??I.control_name,he=I.relevance??I.effectiveness,ie=z||N?"threat-weakness":"threat-control";return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:D})," ",de]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[he&&e.jsx(Ot,{text:he,color:gn[he]}),!I.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>k(I.id,ie),children:""})]})]},I.id)}),e.jsxs("div",{style:{display:"flex",gap:4,marginTop:6,alignItems:"center"},children:[e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:11,padding:"3px 6px"},value:b==="first"?j:"",onChange:I=>{_("first"),y(I.target.value?Number(I.target.value):"")},children:[e.jsx("option",{value:"",children:"+ Dodaj..."}),P.map(I=>e.jsxs("option",{value:I.id,children:[I.ref_id,"  ",I.name]},I.id))]}),b==="first"&&j&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-control",style:{width:80,fontSize:11,padding:"3px 6px"},value:S,onChange:I=>w(I.target.value),children:[e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"LOW",children:"LOW"})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},disabled:p,onClick:C,children:p?"...":"Dodaj"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:W,marginBottom:6},children:[ee," (",F.length,")"]}),F.map(I=>{const D=I.control_ref_id??I.weakness_ref_id??I.threat_ref_id,de=I.control_name??I.weakness_name??I.threat_name,he=I.effectiveness??I.relevance,ie=z?"threat-control":"weakness-control";return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:D})," ",de]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[he&&e.jsx(Ot,{text:he,color:gn[he]}),!I.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>k(I.id,ie),children:""})]})]},I.id)}),e.jsxs("div",{style:{display:"flex",gap:4,marginTop:6,alignItems:"center"},children:[e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:11,padding:"3px 6px"},value:b==="second"?j:"",onChange:I=>{_("second"),y(I.target.value?Number(I.target.value):"")},children:[e.jsx("option",{value:"",children:"+ Dodaj..."}),T.map(I=>e.jsxs("option",{value:I.id,children:[I.ref_id,"  ",I.name]},I.id))]}),b==="second"&&j&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-control",style:{width:80,fontSize:11,padding:"3px 6px"},value:S,onChange:I=>w(I.target.value),children:[e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"LOW",children:"LOW"})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},disabled:p,onClick:C,children:p?"...":"Dodaj"})]})]})]})]})]})}function L3({open:t,onClose:n,corrType:a,editLink:s,saving:o,onSave:c,threats:u,weaknesses:h,controls:f}){const[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState(""),[b,_]=m.useState("MEDIUM"),[E,z]=m.useState("MEDIUM"),[N,O]=m.useState("");m.useEffect(()=>{t&&s?(x(s.threat_id??""),y(s.weakness_id??""),w(s.control_id??""),_(s.relevance??"MEDIUM"),z(s.effectiveness??"MEDIUM"),O(s.description??"")):t&&(x(""),y(""),w(""),_("MEDIUM"),z("MEDIUM"),O(""))},[t,s]);const Q=A=>{A.preventDefault();const R={description:N||null};a==="tw"?(R.threat_id=Number(p),R.weakness_id=Number(j),R.relevance=b):a==="tc"?(R.threat_id=Number(p),R.control_id=Number(S),R.effectiveness=E):(R.weakness_id=Number(j),R.control_id=Number(S),R.effectiveness=E),c(R)},U=s?.is_system===!0,L=a==="tw"?"Zagrozenie  Podatnosc":a==="tc"?"Zagrozenie  Zabezpieczenie":"Podatnosc  Zabezpieczenie",H=U?`Podglad korelacji (${L})`:s?`Edytuj korelacje (${L})`:`Nowa korelacja (${L})`;return e.jsxs(gt,{open:t,onClose:n,title:H,wide:!0,children:[U&&e.jsx("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:6,padding:"8px 12px",marginBottom:16,fontSize:12,color:"var(--blue)"},children:"Korelacja systemowa  tylko podglad."}),e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[a!=="wc"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zagrozenie"}),e.jsxs("select",{className:"form-control",value:p,onChange:A=>x(A.target.value?Number(A.target.value):""),required:!0,disabled:U||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zagrozenie..."}),u.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="tw"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:j,onChange:A=>y(A.target.value?Number(A.target.value):""),required:!0,disabled:U||!!s,children:[e.jsx("option",{value:"",children:"Wybierz podatnosc..."}),h.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="tc"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("select",{className:"form-control",value:S,onChange:A=>w(A.target.value?Number(A.target.value):""),required:!0,disabled:U||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zabezpieczenie..."}),f.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="wc"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:j,onChange:A=>y(A.target.value?Number(A.target.value):""),required:!0,disabled:U||!!s,children:[e.jsx("option",{value:"",children:"Wybierz podatnosc..."}),h.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("select",{className:"form-control",value:S,onChange:A=>w(A.target.value?Number(A.target.value):""),required:!0,disabled:U||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zabezpieczenie..."}),f.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:a==="tw"?"Istotnosc":"Skutecznosc"}),e.jsx("select",{className:"form-control",value:a==="tw"?b:E,onChange:A=>a==="tw"?_(A.target.value):z(A.target.value),disabled:U,children:F3.map(A=>e.jsx("option",{value:A,children:A},A))})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis (opcjonalnie)"}),e.jsx("textarea",{className:"form-control",value:N,onChange:A=>O(A.target.value),rows:2,placeholder:"Opis korelacji...",readOnly:U,style:{resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:n,children:U?"Zamknij":"Anuluj"}),!U&&e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Zapisywanie...":s?"Zapisz zmiany":"Dodaj korelacje"})]})]})]})}function M3({assetCategories:t,aiLoading:n,aiResult:a,aiError:s,hasFeature:o,onAction:c}){const[u,h]=m.useState("scenarios"),[f,p]=m.useState(""),[x,j]=m.useState(""),[y,S]=m.useState(""),[w,b]=m.useState(""),[_,E]=m.useState("threat"),z=[{key:"scenarios",label:"Scenariusze ryzyka",feature:"scenario_generation"},{key:"enrich",label:"Wzbogac korelacje",feature:"correlation_enrichment"},{key:"search",label:"Wyszukiwanie NL",feature:"natural_language_search"},{key:"gap",label:"Analiza luk",feature:"gap_analysis"},{key:"assist",label:"Asystent wpisu",feature:"entry_assist"}].filter(O=>o(O.feature)),N=()=>{switch(u){case"scenarios":f&&c("generate-scenarios",{asset_category_id:Number(f)});break;case"enrich":c("enrich-correlations",{scope:"all"});break;case"search":x.length>=3&&c("search",{query:x});break;case"gap":c("gap-analysis",f?{asset_category_id:Number(f)}:{});break;case"assist":y&&c("assist-entry",{entry_type:_,name:y,description:w});break}};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem"},children:"AI Asystent"}),z.length===0?e.jsx("p",{style:{color:"var(--text-muted)"},children:"Brak wlaczonych funkcji AI."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16},children:z.map(O=>e.jsx("button",{className:`btn ${u===O.key?"btn-primary":"btn-secondary"}`,style:{fontSize:12},onClick:()=>h(O.key),children:O.label},O.key))}),u==="scenarios"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria aktywa"}),e.jsxs("select",{className:"form-control",value:f,onChange:O=>p(O.target.value?Number(O.target.value):""),children:[e.jsx("option",{value:"",children:"Wybierz kategorie..."}),t.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),u==="search"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Pytanie"}),e.jsx("input",{className:"form-control",value:x,onChange:O=>j(O.target.value),placeholder:"np. Jakie zagrozenia dotycza pracy zdalnej?"})]}),u==="gap"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria aktywa (opcjonalnie)"}),e.jsxs("select",{className:"form-control",value:f,onChange:O=>p(O.target.value?Number(O.target.value):""),children:[e.jsx("option",{value:"",children:"Wszystkie kategorie"}),t.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),u==="assist"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Typ wpisu"}),e.jsxs("select",{className:"form-control",value:_,onChange:O=>E(O.target.value),children:[e.jsx("option",{value:"threat",children:"Zagrozenie"}),e.jsx("option",{value:"weakness",children:"Podatnosc"}),e.jsx("option",{value:"control",children:"Zabezpieczenie"})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Nazwa"}),e.jsx("input",{className:"form-control",value:y,onChange:O=>S(O.target.value),placeholder:"Nazwa wpisu..."})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",value:w,onChange:O=>b(O.target.value),rows:2,placeholder:"Opis wpisu...",style:{resize:"vertical"}})]})]}),e.jsx("button",{className:"btn btn-primary",style:{marginTop:16},onClick:N,disabled:n,children:n?"AI analizuje...":"Uruchom AI"})]}),s&&e.jsx("div",{style:{marginTop:12,padding:"8px 12px",borderRadius:6,background:"rgba(239,68,68,0.1)",color:"var(--color-danger, #dc2626)",fontSize:"0.85rem"},children:s})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem"},children:"Wyniki AI"}),n&&e.jsx("div",{style:{textAlign:"center",padding:24,color:"var(--text-muted)"},children:"AI analizuje dane..."}),!n&&!a&&!s&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem"},children:'Wybierz funkcje AI i kliknij "Uruchom AI" aby zobaczyc wyniki.'}),a&&e.jsx("div",{style:{maxHeight:500,overflow:"auto"},children:e.jsx(I3,{data:a,mode:u})})]})]})}function I3({data:t,mode:n}){if(n==="scenarios"&&Array.isArray(t.scenarios)){const a=t.scenarios;return e.jsx("div",{children:a.map((s,o)=>e.jsxs("div",{style:{marginBottom:16,padding:12,border:"1px solid var(--border)",borderRadius:8},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:4},children:[String(s.threat_ref_id??"")," ",String(s.threat_name??`Scenariusz ${o+1}`)]}),s.rationale!=null&&e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",margin:"4px 0"},children:String(s.rationale)}),Array.isArray(s.weaknesses)&&s.weaknesses.length>0&&e.jsxs("div",{style:{fontSize:"0.8rem",marginTop:4},children:[e.jsx("span",{style:{fontWeight:600},children:"Podatnosci:"})," ",s.weaknesses.map(c=>String(c.name??c.ref_id??"")).join(", ")]}),Array.isArray(s.suggested_controls)&&s.suggested_controls.length>0&&e.jsxs("div",{style:{fontSize:"0.8rem",marginTop:4},children:[e.jsx("span",{style:{fontWeight:600},children:"Zabezpieczenia:"})," ",s.suggested_controls.map(c=>String(c.name??c.ref_id??"")).join(", ")]})]},o))})}if(n==="enrich"&&Array.isArray(t.suggestions)){const a=t.suggestions;return e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginBottom:12},children:[a.length," sugestii powiazan"]}),a.map((s,o)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:String(s.threat_ref_id??"")}),"  ",String(s.target_type??""),": ",e.jsx("strong",{children:String(s.target_ref_id??"")})]}),e.jsx("span",{style:{color:"var(--text-muted)"},children:String(s.relevance??"")})]},o))]})}if(n==="gap"){const a=t;return e.jsxs("div",{children:[a.coverage_pct!=null&&e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700,marginBottom:12},children:["Pokrycie: ",Number(a.coverage_pct).toFixed(0),"%"]}),Array.isArray(a.critical_gaps)&&a.critical_gaps.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontSize:"0.9rem",marginBottom:8},children:"Krytyczne luki"}),a.critical_gaps.map((s,o)=>e.jsxs("div",{style:{padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsx("strong",{children:String(s.area??"")}),": ",String(s.description??"")]},o))]}),Array.isArray(a.recommendations)&&a.recommendations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontSize:"0.9rem",marginTop:16,marginBottom:8},children:"Rekomendacje"}),a.recommendations.map((s,o)=>e.jsxs("div",{style:{padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsxs("strong",{children:["P",String(s.priority??""),":"]})," ",String(s.action??"")]},o))]})]})}return e.jsx("pre",{style:{fontSize:"0.8rem",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:400,overflow:"auto"},children:JSON.stringify(t,null,2)})}const ai="",P3={id:0,provider_type:"none",api_endpoint:null,api_key_masked:null,model_name:null,is_active:!1,max_tokens:4e3,temperature:.3,max_requests_per_user_per_hour:20,max_requests_per_user_per_day:100,max_requests_per_org_per_day:500,feature_scenario_generation:!0,feature_correlation_enrichment:!0,feature_natural_language_search:!0,feature_gap_analysis:!0,feature_entry_assist:!0,feature_interpret:!0,feature_translate:!0,feature_evidence:!0,feature_security_area_map:!0,feature_cross_mapping:!0,feature_coverage_report:!0,feature_document_import:!0,feature_management_report:!0,last_test_at:null,last_test_ok:null,last_test_error:null},Xv=[{value:"none",label:"Brak (wyczone)"},{value:"anthropic",label:"Anthropic Claude"},{value:"openai_compatible",label:"OpenAI-compatible (OpenAI, vLLM, Ollama)"}],Am=[{key:"feature_scenario_generation",label:"Generowanie scenariuszy ryzyka",desc:"AI tworzy scenariusze zagroe dla kategorii aktyww",group:"catalog",promptKeys:["scenario_gen"]},{key:"feature_correlation_enrichment",label:"Wzbogacanie korelacji",desc:"AI sugeruje brakujce powizania threat-weakness-control",group:"catalog",promptKeys:["enrichment"]},{key:"feature_natural_language_search",label:"Wyszukiwanie w jzyku naturalnym",desc:"Wyszukiwanie w katalogach za pomoc pyta w jzyku naturalnym",group:"catalog",promptKeys:["search"]},{key:"feature_gap_analysis",label:"Analiza luk bezpieczestwa",desc:"AI analizuje pokrycie i identyfikuje luki",group:"catalog",promptKeys:["gap_analysis"]},{key:"feature_entry_assist",label:"Asystent tworzenia wpisw",desc:"AI podpowiada klasyfikacj i powizania nowych wpisw",group:"catalog",promptKeys:["assist"]},{key:"feature_interpret",label:"Interpretacja wymaga",desc:"AI wyjania wymagania z frameworkw w praktycznym kontekcie",group:"framework",promptKeys:["interpret"]},{key:"feature_translate",label:"Tumaczenie wymaga",desc:"AI tumaczy wymagania na wybrany jzyk z zachowaniem terminologii",group:"framework",promptKeys:["translate"]},{key:"feature_evidence",label:"Generowanie dowodw audytowych",desc:"AI generuje list dowodw jakich moe wymaga audytor",group:"framework",promptKeys:["evidence"]},{key:"feature_security_area_map",label:"Mapowanie obszarw bezpieczestwa",desc:"AI przypisuje wymagania do obszarw bezpieczestwa",group:"framework",promptKeys:["security_area_map"]},{key:"feature_cross_mapping",label:"Cross-mapping frameworkw",desc:"AI mapuje wymagania midzy rnymi standardami",group:"framework",promptKeys:["cross_mapping"]},{key:"feature_coverage_report",label:"Raporty pokrycia",desc:"AI generuje raporty zarzdcze o pokryciu midzy frameworkami",group:"framework",promptKeys:["coverage_report"]},{key:"feature_document_import",label:"Import dokumentw AI",desc:"AI analizuje dokumenty PDF/DOCX i wyodrbnia struktur frameworka",group:"framework",promptKeys:["document_import","document_import_continuation"]},{key:"feature_management_report",label:"Raport zarzdczy AI",desc:"AI generuje kompleksowy raport zarzdczy na podstawie danych o ryzykach, aktywach i stanie bezpieczestwa",group:"reports",promptKeys:["management_report"]}],W3={SCENARIO_GEN:"Scenariusze ryzyka",ENRICHMENT:"Wzbogacanie korelacji",SEARCH:"Wyszukiwanie NLP",GAP_ANALYSIS:"Analiza luk",ASSIST:"Asystent wpisw",INTERPRET:"Interpretacja wymaga",TRANSLATE:"Tumaczenia",EVIDENCE:"Dowody audytowe",SECURITY_AREA_MAP:"Mapowanie obszarw",CROSS_MAPPING:"Cross-mapping",COVERAGE_REPORT:"Raporty pokrycia",DOCUMENT_IMPORT:"Import dokumentw",MANAGEMENT_REPORT:"Raport zarzdczy"};function U3(){const[t,n]=m.useState(P3),[a,s]=m.useState(!0),[o,c]=m.useState(!1),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(null),[y,S]=m.useState(null),[w,b]=m.useState(null),[_,E]=m.useState(30),[z,N]=m.useState({provider_type:"none",api_endpoint:"",api_key:"",model_name:"",max_tokens:4e3,temperature:.3,max_requests_per_user_per_hour:20,max_requests_per_user_per_day:100,max_requests_per_org_per_day:500,feature_scenario_generation:!0,feature_correlation_enrichment:!0,feature_natural_language_search:!0,feature_gap_analysis:!0,feature_entry_assist:!0,feature_interpret:!0,feature_translate:!0,feature_evidence:!0,feature_security_area_map:!0,feature_cross_mapping:!0,feature_coverage_report:!0,feature_document_import:!0,feature_management_report:!0}),O=m.useCallback(async()=>{try{const G=await fetch(`${ai}/api/v1/admin/ai-config`);if(G.ok){const F=await G.json();n(F),N({provider_type:F.provider_type,api_endpoint:F.api_endpoint??"",api_key:"",model_name:F.model_name??"",max_tokens:F.max_tokens,temperature:F.temperature,max_requests_per_user_per_hour:F.max_requests_per_user_per_hour,max_requests_per_user_per_day:F.max_requests_per_user_per_day,max_requests_per_org_per_day:F.max_requests_per_org_per_day,feature_scenario_generation:F.feature_scenario_generation,feature_correlation_enrichment:F.feature_correlation_enrichment,feature_natural_language_search:F.feature_natural_language_search,feature_gap_analysis:F.feature_gap_analysis,feature_entry_assist:F.feature_entry_assist,feature_interpret:F.feature_interpret,feature_translate:F.feature_translate,feature_evidence:F.feature_evidence,feature_security_area_map:F.feature_security_area_map,feature_cross_mapping:F.feature_cross_mapping,feature_coverage_report:F.feature_coverage_report,feature_document_import:F.feature_document_import,feature_management_report:F.feature_management_report})}}catch{}finally{s(!1)}},[]),Q=m.useCallback(async()=>{try{const G=await fetch(`${ai}/api/v1/ai/usage-stats?days=${_}`);G.ok&&j(await G.json())}catch{}},[_]);m.useEffect(()=>{O()},[O]),m.useEffect(()=>{Q()},[Q]);const U=async()=>{c(!0),S(null),b(null);try{const G={...z};z.api_key||delete G.api_key;const F=await fetch(`${ai}/api/v1/admin/ai-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)});if(F.ok)b("Konfiguracja zapisana"),O(),Q(),setTimeout(()=>b(null),3e3);else{const q=await F.text();S(`Bd zapisu: ${q}`)}}catch(G){S(`Bd: ${G}`)}finally{c(!1)}},L=async()=>{h(!0),p(null);try{const F=await(await fetch(`${ai}/api/v1/admin/ai-config/test`,{method:"POST"})).json();p(F),O()}catch(G){p({success:!1,message:`Bd poczenia: ${G}`})}finally{h(!1)}},H=async G=>{try{(await fetch(`${ai}/api/v1/admin/ai-config/${G?"activate":"deactivate"}`,{method:"POST"})).ok&&(b(G?"AI aktywowane":"AI dezaktywowane"),O(),setTimeout(()=>b(null),3e3))}catch(F){S(`Bd: ${F}`)}};if(a)return e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"adowanie konfiguracji AI..."});const A=Xv.find(G=>G.value===t.provider_type)?.label??t.provider_type,R=x?Object.values(x.by_action).reduce((G,F)=>G+F,0):0;return e.jsxs("div",{style:{padding:"20px 24px",maxWidth:1e3},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,margin:0},children:"Integracja AI"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13,marginTop:4},children:"AI jest opcjonalnym pluginem. System dziaa w peni bez AI  elementy AI pojawiaj si dopiero po aktywacji."})]}),y&&e.jsxs("div",{className:"card",style:{background:"var(--red-dim)",borderColor:"var(--red)",marginBottom:16,padding:"12px 16px"},children:[e.jsx("span",{style:{color:"var(--red)",fontSize:13},children:y}),e.jsx("button",{onClick:()=>S(null),className:"btn btn-sm",style:{float:"right",padding:"2px 8px",fontSize:11},children:""})]}),w&&e.jsx("div",{className:"card",style:{background:"var(--green-dim)",borderColor:"var(--green)",marginBottom:16,padding:"12px 16px"},children:e.jsx("span",{style:{color:"var(--green)",fontSize:13},children:w})}),e.jsxs("div",{className:"grid-2",style:{marginBottom:20,maxWidth:500},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 12px",borderRadius:12,background:t.is_active?"var(--green-dim)":"rgba(255,255,255,0.06)",color:t.is_active?"var(--green)":"var(--text-muted)",fontSize:13,fontWeight:600},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:t.is_active?"var(--green)":"var(--text-muted)"}}),t.is_active?"Aktywne":"Nieaktywne"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:"Status AI"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--blue)"},children:A}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:t.model_name||""})]})]}),e.jsxs("div",{className:"grid-2",style:{alignItems:"start"},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Dostawca AI"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ providera"}),e.jsx("select",{className:"form-control",value:z.provider_type,onChange:G=>N({...z,provider_type:G.target.value}),children:Xv.map(G=>e.jsx("option",{value:G.value,children:G.label},G.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Model"}),e.jsx("input",{className:"form-control",value:z.model_name,onChange:G=>N({...z,model_name:G.target.value}),placeholder:z.provider_type==="anthropic"?"claude-sonnet-4-5-20250929":"gpt-4o"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"API Endpoint"}),e.jsx("input",{className:"form-control",value:z.api_endpoint,onChange:G=>N({...z,api_endpoint:G.target.value}),placeholder:z.provider_type==="anthropic"?"https://api.anthropic.com":"https://api.openai.com"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["API Key",t.api_key_masked&&e.jsxs("span",{style:{fontWeight:400,textTransform:"none",letterSpacing:0},children:[" ","(aktualny: ",t.api_key_masked,")"]})]}),e.jsx("input",{className:"form-control",type:"password",value:z.api_key,onChange:G=>N({...z,api_key:G.target.value}),placeholder:"Zostaw puste aby nie zmienia"})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-primary",onClick:U,disabled:o,children:o?"Zapisywanie...":"Zapisz"}),e.jsx("button",{className:"btn",onClick:L,disabled:u||z.provider_type==="none",style:u?{opacity:.7}:void 0,children:u?"Testowanie...":"Testuj poczenie"}),t.id>0&&e.jsx("button",{className:t.is_active?"btn btn-danger":"btn",onClick:()=>H(!t.is_active),style:t.is_active?void 0:{color:"var(--green)",borderColor:"rgba(34,197,94,0.3)"},children:t.is_active?"Dezaktywuj":"Aktywuj AI"})]}),f&&e.jsxs("div",{style:{marginTop:12,padding:"8px 12px",borderRadius:6,fontSize:13,background:f.success?"var(--green-dim)":"var(--red-dim)",color:f.success?"var(--green)":"var(--red)"},children:[f.success?"OK":"Bd",": ",f.message,f.response_time_ms!=null&&e.jsxs("span",{style:{opacity:.7},children:[" (",f.response_time_ms,"ms)"]})]}),t.last_test_at&&e.jsxs("div",{style:{marginTop:6,fontSize:11,color:"var(--text-muted)"},children:["Ostatni test: ",new Date(t.last_test_at).toLocaleString("pl-PL"),t.last_test_ok?"  OK":`  ${t.last_test_error}`]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Parametry modelu"}),e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max tokens"}),e.jsx("input",{className:"form-control",type:"number",value:z.max_tokens,onChange:G=>N({...z,max_tokens:parseInt(G.target.value)||4e3})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Temperature"}),e.jsx("input",{className:"form-control",type:"number",step:"0.05",min:"0",max:"1",value:z.temperature,onChange:G=>N({...z,temperature:parseFloat(G.target.value)||.3})})]})]}),e.jsx("div",{className:"card-title",style:{marginTop:8},children:"Limity zapyta"}),e.jsxs("div",{className:"grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik / h"}),e.jsx("input",{className:"form-control",type:"number",value:z.max_requests_per_user_per_hour,onChange:G=>N({...z,max_requests_per_user_per_hour:parseInt(G.target.value)||20})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik / dzie"}),e.jsx("input",{className:"form-control",type:"number",value:z.max_requests_per_user_per_day,onChange:G=>N({...z,max_requests_per_user_per_day:parseInt(G.target.value)||100})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Organizacja / dzie"}),e.jsx("input",{className:"form-control",type:"number",value:z.max_requests_per_org_per_day,onChange:G=>N({...z,max_requests_per_org_per_day:parseInt(G.target.value)||500})})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:U,disabled:o,children:o?"Zapisywanie...":"Zapisz parametry"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Funkcje AI"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"0 0 14px"},children:"Wcz/wycz poszczeglne moliwoci AI. Wyczone nie bd widoczne w UI."}),e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Smart Catalog"}),Am.filter(G=>G.group==="catalog").map(G=>e.jsx(Em,{ft:G,form:z,setForm:N},G.key)),e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8,marginTop:16},children:"Frameworki / Dokumenty"}),Am.filter(G=>G.group==="framework").map(G=>e.jsx(Em,{ft:G,form:z,setForm:N},G.key)),e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8,marginTop:16},children:"Raporty"}),Am.filter(G=>G.group==="reports").map(G=>e.jsx(Em,{ft:G,form:z,setForm:N},G.key)),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:U,disabled:o,style:{marginTop:4},children:o?"Zapisywanie...":"Zapisz funkcje"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Informacje o poczeniu"}),e.jsx("table",{style:{width:"100%",fontSize:13},children:e.jsxs("tbody",{children:[e.jsx(gl,{label:"Provider",value:A}),e.jsx(gl,{label:"Model",value:t.model_name??""}),e.jsx(gl,{label:"Endpoint",value:t.api_endpoint??""}),e.jsx(gl,{label:"API Key",value:t.api_key_masked??"nie ustawiony"}),e.jsx(gl,{label:"Status",value:t.is_active?e.jsx("span",{className:"score-badge badge-green",children:"Aktywne"}):e.jsx("span",{className:"score-badge badge-red",children:"Nieaktywne"})}),e.jsx(gl,{label:"Ostatni test",value:t.last_test_at?e.jsxs(e.Fragment,{children:[new Date(t.last_test_at).toLocaleString("pl-PL")," ",t.last_test_ok?e.jsx("span",{className:"score-badge badge-green",style:{marginLeft:6},children:"OK"}):e.jsx("span",{className:"score-badge badge-red",style:{marginLeft:6},children:"Bd"})]}):""})]})})]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:4},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Statystyki uycia"}),e.jsx("div",{style:{display:"flex",gap:4},children:[7,30,90].map(G=>e.jsxs("button",{className:`btn btn-sm ${G===_?"btn-primary":""}`,onClick:()=>E(G),style:{padding:"3px 10px",fontSize:11},children:[G,"d"]},G))})]}),!x||x.requests_count===0?e.jsx("div",{style:{textAlign:"center",padding:"20px 0",color:"var(--text-muted)",fontSize:13},children:"Brak danych o uyciu AI w wybranym okresie."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:10,marginBottom:16},children:[e.jsx(Io,{label:"Zapyta",value:String(x.requests_count),color:"var(--blue)"}),e.jsx(Io,{label:"Tokeny IN",value:(x.tokens_input??0).toLocaleString("pl-PL"),color:"var(--cyan, #06b6d4)"}),e.jsx(Io,{label:"Tokeny OUT",value:(x.tokens_output??0).toLocaleString("pl-PL"),color:"var(--purple)"}),e.jsx(Io,{label:"Koszt",value:`$${x.cost_usd.toFixed(4)}`,color:"var(--orange)"}),e.jsx(Io,{label:"Akceptacja",value:x.acceptance_rate!=null?`${x.acceptance_rate.toFixed(0)}%`:"",color:"var(--green)"})]}),x.requests_with_tracking<x.requests_count&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:12,padding:"6px 10px",background:"var(--bg-subtle)",borderRadius:4},children:["ledzenie tokenw/kosztw dostpne dla ",x.requests_with_tracking," z ",x.requests_count," zapyta.",x.requests_with_tracking===0&&" Koszty pojawi si po pierwszym udanym zapytaniu AI z nowym kodem."]}),R>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:10},children:"Rozkad wg typu"}),Object.entries(x.by_action).sort(([,G],[,F])=>F-G).map(([G,F])=>{const q=R>0?F/R*100:0;return e.jsxs("div",{className:"bar-row",children:[e.jsx("div",{className:"bar-label",children:W3[G]??G}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill","data-value":F,style:{width:`${Math.max(q,3)}%`,background:"var(--blue)"}})}),e.jsx("div",{className:"bar-score",children:F})]},G)})]})]})]})]})}function gl({label:t,value:n}){return e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 0",color:"var(--text-muted)",fontSize:12,width:110,verticalAlign:"top"},children:t}),e.jsx("td",{style:{padding:"6px 0",fontWeight:500,wordBreak:"break-all"},children:n})]})}function Em({ft:t,form:n,setForm:a}){const s=!!n[t.key],[o,c]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState(""),[x,j]=m.useState(null),[y,S]=m.useState(!1),w=async E=>{if(o===E){c(null);return}try{const z=await fetch(`${ai}/api/v1/admin/ai-prompts/${E}`);if(!z.ok)throw new Error("Nie znaleziono promptu");const N=await z.json();h(N.prompt_text),p(N.default_text||""),j({display_name:N.display_name,is_customized:N.is_customized}),c(E)}catch{alert("Nie udao si zaadowa promptu")}},b=async()=>{if(o){S(!0);try{await fetch(`${ai}/api/v1/admin/ai-prompts/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt_text:u})}),j(E=>E&&{...E,is_customized:!0}),alert("Prompt zapisany!")}catch{alert("Bd zapisu promptu")}finally{S(!1)}}},_=async E=>{if(confirm("Przywrci domylny prompt? Twoje zmiany zostan utracone."))try{await fetch(`${ai}/api/v1/admin/ai-prompts/${E}/reset`,{method:"POST"});const z=await fetch(`${ai}/api/v1/admin/ai-prompts/${E}`);if(z.ok){const N=await z.json();h(N.prompt_text),j({display_name:N.display_name,is_customized:!1})}}catch{alert("Bd resetowania promptu")}};return e.jsxs("div",{style:{marginBottom:10,borderRadius:6,background:s?"var(--blue-dim)":"var(--bg-subtle)",border:"1px solid",borderColor:s?"rgba(59,130,246,0.2)":"transparent",transition:"all 0.15s"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:10,cursor:"pointer",padding:"8px 10px"},children:[e.jsx("input",{type:"checkbox",checked:s,onChange:E=>a({...n,[t.key]:E.target.checked}),style:{width:16,height:16,marginTop:1,accentColor:"var(--blue)",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:500},children:t.label}),t.promptKeys&&t.promptKeys.length>0&&e.jsx("div",{style:{display:"flex",gap:4},children:t.promptKeys.map(E=>e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 8px",lineHeight:1.4},onClick:z=>{z.preventDefault(),z.stopPropagation(),w(E)},children:o===E?"Zwi prompt":t.promptKeys.length>1?`Prompt: ${E.replace("document_import_continuation","kontynuacja").replace("document_import","gwny")}`:"Edytuj prompt"},E))})]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:t.desc})]})]}),o&&e.jsx("div",{style:{padding:"0 10px 10px 36px"},onClick:E=>E.stopPropagation(),children:e.jsxs("div",{style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:6,padding:10,marginTop:4},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)"},children:["Prompt systemowy: ",x?.display_name??o]}),x?.is_customized&&e.jsx("span",{className:"score-badge badge-blue",style:{fontSize:9},children:"Zmodyfikowany"})]}),e.jsx("textarea",{value:u,onChange:E=>h(E.target.value),style:{width:"100%",minHeight:180,fontFamily:"'JetBrains Mono',monospace",fontSize:11,padding:8,borderRadius:4,border:"1px solid var(--border)",background:"var(--bg-subtle)",color:"var(--text)",resize:"vertical"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},children:[e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>h(f),children:"Wstaw domylny"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,color:"var(--orange)"},onClick:()=>_(o),children:"Reset do domylnego"})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>c(null),children:"Anuluj"}),e.jsx("button",{className:"btn btn-sm btn-primary",style:{fontSize:10},onClick:b,disabled:y,children:y?"Zapisuj...":"Zapisz prompt"})]})]})]})})]})}function Io({label:t,value:n,color:a}){return e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,background:"var(--bg-subtle)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a},children:n}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:t})]})}const eu="",$3={"mysql+asyncmy":"MySQL (asyncmy)","mysql+aiomysql":"MySQL (aiomysql)","postgresql+asyncpg":"PostgreSQL (asyncpg)","sqlite+aiosqlite":"SQLite (aiosqlite)"};function H3(){const[t,n]=m.useState(null),[a,s]=m.useState(!1),[o,c]=m.useState(""),[u,h]=m.useState(3306),[f,p]=m.useState(""),[x,j]=m.useState(""),[y,S]=m.useState(""),[w,b]=m.useState("mysql+asyncmy"),[_,E]=m.useState(!1),[z,N]=m.useState(null),[O,Q]=m.useState(!1),[U,L]=m.useState(null),[H,A]=m.useState(!1),[R,G]=m.useState(null);m.useEffect(()=>{fetch(`${eu}/api/v1/admin/db-config`).then(V=>V.json()).then(V=>{n(V),c(V.host),h(V.port),p(V.database),j(V.user),b(V.driver)}).catch(()=>{})},[]);const F=()=>{confirm("Czy na pewno chcesz edytowa parametry poczenia z baz danych? Nieprawidowe zmiany mog uniemoliwi dziaanie aplikacji.")&&(s(!0),N(null),L(null),G(null))},q=()=>{t&&(c(t.host),h(t.port),p(t.database),j(t.user),b(t.driver)),S(""),s(!1),N(null),L(null),G(null)},ee=async()=>{E(!0),N(null),L(null);try{const V=await fetch(`${eu}/api/v1/admin/db-config/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})});N(await V.json())}catch{N({status:"error",message:"Nie mona poczy si z backendem"})}finally{E(!1)}},me=async()=>{if(confirm("Czy na pewno chcesz zainicjalizowa schemat bazy danych? Ta operacja utworzy wszystkie tabele i dane pocztkowe.")){Q(!0),L(null);try{const V=await fetch(`${eu}/api/v1/admin/db-config/init-schema`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})});L(await V.json())}catch{L({status:"error",message:"Bd poczenia z backendem"})}finally{Q(!1)}}},W=async()=>{if(confirm("Zapisa now konfiguracj? Aplikacja bdzie wymagaa restartu.")){A(!0),G(null);try{const ne=await(await fetch(`${eu}/api/v1/admin/db-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})})).json();G(ne.message),n({host:o,port:u,database:f,user:x,driver:w,connected:!0}),s(!1)}catch{G("Bd zapisu konfiguracji")}finally{A(!1)}}},J=o!==t?.host||u!==t?.port||f!==t?.database,M=V=>({...V?{background:"var(--bg-subtle)",color:"var(--text-secondary)",cursor:"not-allowed",border:"1px solid transparent"}:{}});return e.jsxs("div",{style:{maxWidth:720,margin:"0 auto"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:600,marginBottom:4},children:"Konfiguracja bazy danych"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:20},children:"Zarzdzaj poczeniem z baz danych. Moesz podczy si do nowej bazy i automatycznie utworzy schemat."}),t&&e.jsxs("div",{style:{background:t.connected?"var(--green-dim)":"var(--red-dim)",border:`1px solid ${t.connected?"var(--green)":"var(--red)"}`,borderRadius:8,padding:"10px 14px",marginBottom:20,fontSize:12},children:[e.jsx("strong",{children:"Aktywne poczenie:"})," ",t.user,"@",t.host,":",t.port,"/",t.database,e.jsx("span",{style:{marginLeft:8,color:t.connected?"var(--green)":"var(--red)"},children:t.connected?"Poczono":"Brak poczenia"})]}),e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:"Parametry poczenia"}),a?e.jsx("button",{className:"btn btn-secondary",onClick:q,style:{fontSize:12,padding:"4px 12px"},children:"Anuluj"}):e.jsx("button",{className:"btn btn-secondary",onClick:F,style:{fontSize:12,padding:"4px 12px"},children:"Edytuj"})]}),!a&&e.jsx("div",{style:{background:"var(--bg-subtle)",borderRadius:6,padding:"6px 10px",marginBottom:14,fontSize:11,color:"var(--text-muted)"},children:'Pola s zablokowane. Kliknij Edytuj" aby zmieni parametry poczenia.'}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Host (IP / hostname)"}),e.jsx("input",{className:"form-control",value:o,onChange:V=>c(V.target.value),placeholder:"192.168.1.100",readOnly:!a,style:M(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Port"}),e.jsx("input",{className:"form-control",type:"number",value:u,onChange:V=>h(Number(V.target.value)),readOnly:!a,style:M(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa bazy danych"}),e.jsx("input",{className:"form-control",value:f,onChange:V=>p(V.target.value),placeholder:"secureposture",readOnly:!a,style:M(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sterownik"}),a?e.jsxs("select",{className:"form-control",value:w,onChange:V=>b(V.target.value),children:[e.jsx("option",{value:"mysql+asyncmy",children:"MySQL (asyncmy)"}),e.jsx("option",{value:"mysql+aiomysql",children:"MySQL (aiomysql)"}),e.jsx("option",{value:"postgresql+asyncpg",children:"PostgreSQL (asyncpg)"}),e.jsx("option",{value:"sqlite+aiosqlite",children:"SQLite (aiosqlite)"})]}):e.jsx("input",{className:"form-control",value:$3[w]||w,readOnly:!0,style:M(!0)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik"}),e.jsx("input",{className:"form-control",value:x,onChange:V=>j(V.target.value),placeholder:"root",readOnly:!a,style:M(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Haso"}),a?e.jsx("input",{className:"form-control",type:"password",value:y,onChange:V=>S(V.target.value),placeholder:"Nowe haso do bazy"}):e.jsx("input",{className:"form-control",type:"password",value:"********",readOnly:!0,style:M(!0)})]})]}),a&&e.jsx("div",{style:{display:"flex",gap:8,marginTop:16},children:e.jsx("button",{className:"btn btn-primary",onClick:ee,disabled:_||!o||!f||!x,children:_?"Testowanie...":"Testuj poczenie"})})]}),a&&z&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:16,background:z.status==="ok"?"var(--green-dim)":"var(--red-dim)",borderLeft:`3px solid ${z.status==="ok"?"var(--green)":"var(--red)"}`},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:4},children:z.status==="ok"?"Poczenie udane":"Bd poczenia"}),e.jsx("div",{style:{fontSize:12},children:z.message}),z.status==="ok"&&e.jsxs("div",{style:{fontSize:12,marginTop:6,color:"var(--text-muted)"},children:["Tabel w bazie: ",e.jsx("strong",{children:z.tables_found}),z.schema_initialized?e.jsx("span",{style:{color:"var(--green)",marginLeft:8},children:"Schemat istnieje"}):e.jsx("span",{style:{color:"var(--orange)",marginLeft:8},children:"Baza pusta  wymaga inicjalizacji"})]})]}),a&&z?.status==="ok"&&e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Inicjalizacja schematu"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:z.schema_initialized?"Baza zawiera tabele. Moesz ponownie uruchomi migracje aby zaktualizowa schemat do najnowszej wersji.":"Baza jest pusta. Kliknij poniej aby utworzy wszystkie tabele, indeksy i dane pocztkowe."}),e.jsx("button",{className:"btn btn-primary",onClick:me,disabled:O,children:O?"Inicjalizacja...":z.schema_initialized?"Aktualizuj schemat":"Utwrz schemat bazy"}),U&&e.jsxs("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:6,fontSize:12,background:U.status==="ok"?"var(--green-dim)":"var(--red-dim)",borderLeft:`3px solid ${U.status==="ok"?"var(--green)":"var(--red)"}`},children:[e.jsxs("strong",{children:[U.status==="ok"?"Sukces":"Bd",":"]})," ",U.message,U.details&&e.jsx("pre",{style:{marginTop:6,fontSize:11,whiteSpace:"pre-wrap",opacity:.8,maxHeight:120,overflow:"auto"},children:U.details})]})]}),a&&z?.status==="ok"&&J&&e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Zapisz konfiguracj"}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:["Zapisanie nowej konfiguracji zaktualizuje plik .env. Po zapisie wymagany jest ",e.jsx("strong",{children:"restart serwera"})," aby aplikacja poczya si z now baz."]}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:H,children:H?"Zapisywanie...":"Zapisz i przecz baz"}),R&&e.jsx("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:6,fontSize:12,background:"var(--blue-dim)",borderLeft:"3px solid var(--blue)"},children:R})]})]})}const Ui="",Fm={planned:"Planowane",in_progress:"W trakcie",implemented:"Wdroone",partial:"Czciowo",not_applicable:"Nie dotyczy"},Qv={planned:"#6b7280",in_progress:"#f59e0b",implemented:"#16a34a",partial:"#f97316",not_applicable:"#9ca3af"},e1={positive:"Pozytywny",conditional:"Warunkowy",negative:"Negatywny"},V3={positive:"#16a34a",conditional:"#f59e0b",negative:"#dc2626"},t1={manual_test:"Test manualny",automated_test:"Test automatyczny",audit:"Audyt",review:"Przegld",pentest:"Pen-test"};function tu(t){return t==null?"var(--text-muted)":t>=85?"#16a34a":t>=60?"#f59e0b":t>=30?"#f97316":"#dc2626"}function Z3(t){return!!t&&new Date(t)<new Date}const Rm=[{key:"ref_id",header:"Ref"},{key:"control_ref_id",header:"Zabezpieczenie"},{key:"control_name",header:"Nazwa zabezpieczenia"},{key:"org_unit_name",header:"Jednostka org."},{key:"asset_name",header:"Aktyw",defaultVisible:!1},{key:"security_area_name",header:"Obszar",defaultVisible:!1},{key:"status",header:"Status"},{key:"responsible",header:"Odpowiedzialny"},{key:"implementation_date",header:"Data wdroenia",defaultVisible:!1},{key:"design_effectiveness",header:"Projekt %"},{key:"operational_effectiveness",header:"Operacyjna %"},{key:"overall_effectiveness",header:"Oglna %"},{key:"coverage_percent",header:"Pokrycie %",defaultVisible:!1},{key:"last_test_date",header:"Ostatni test"},{key:"next_test_date",header:"Nastpny test"},{key:"actions",header:"Akcje"}];function G3(){const[t,n]=m.useState([]),[a,s]=m.useState(null),[o,c]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState(!0),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(!1),[_,E]=m.useState(null),[z,N]=m.useState(!1),[O,Q]=m.useState(null),[U,L]=m.useState({control_id:0,org_unit_id:0,asset_id:null,security_area_id:null,status:"planned",responsible:"",implementation_date:"",description:"",evidence_url:"",design_effectiveness:"",operational_effectiveness:"",coverage_percent:"",test_frequency_days:""}),[H,A]=m.useState({test_date:new Date().toISOString().split("T")[0],test_type:"manual_test",tester:"",result:"positive",design_score:"",operational_score:"",findings:"",recommendations:""}),[R,G]=m.useState(!1),{visible:F,toggle:q}=da(Rm,"ctrl-eff"),ee=Aa({data:t,storageKey:"ctrl-eff",defaultSort:"overall_effectiveness",defaultSortDir:"desc"}),me=async()=>{p(!0);try{const[k,I,D,de]=await Promise.all([fetch(`${Ui}/api/v1/control-effectiveness`),fetch(`${Ui}/api/v1/control-effectiveness/metrics/summary`),fetch(`${Ui}/api/v1/smart-catalog/controls`),fetch(`${Ui}/api/v1/org-units`)]);if(k.ok&&n(await k.json()),I.ok&&s(await I.json()),D.ok){const he=await D.json();c(he.map(ie=>({id:ie.id,ref_id:ie.ref_id,name:ie.name})))}if(de.ok){const he=await de.json();h(he.map(ie=>({id:ie.id,name:ie.name})))}}catch{}p(!1)};m.useEffect(()=>{me()},[]);const W=m.useMemo(()=>a?[{label:"Wdroone",value:a.implemented_count,total:a.total_implementations,color:"#16a34a"},{label:"Czciowo",value:a.partial_count,color:"#f97316"},{label:"r. skuteczno",value:a.avg_overall_effectiveness!=null?`${a.avg_overall_effectiveness}%`:"",color:tu(a.avg_overall_effectiveness)},{label:"Testy (90d)",value:a.tests_last_90_days,color:a.overdue_tests>0?"#dc2626":"var(--text-secondary)"}]:[],[a]),J=()=>{S(null),L({control_id:o[0]?.id??0,org_unit_id:u[0]?.id??0,asset_id:null,security_area_id:null,status:"planned",responsible:"",implementation_date:"",description:"",evidence_url:"",design_effectiveness:"",operational_effectiveness:"",coverage_percent:"",test_frequency_days:""}),j(!0)},M=k=>{S(k),L({control_id:k.control_id,org_unit_id:k.org_unit_id,asset_id:k.asset_id,security_area_id:k.security_area_id,status:k.status,responsible:k.responsible||"",implementation_date:k.implementation_date||"",description:k.description||"",evidence_url:k.evidence_url||"",design_effectiveness:k.design_effectiveness??"",operational_effectiveness:k.operational_effectiveness??"",coverage_percent:k.coverage_percent??"",test_frequency_days:k.test_frequency_days??""}),j(!0)},V=k=>{E(k),A({test_date:new Date().toISOString().split("T")[0],test_type:"manual_test",tester:"",result:"positive",design_score:"",operational_score:"",findings:"",recommendations:""}),b(!0)},ne=k=>{Q(k),N(!0)},P=async()=>{const k={control_id:U.control_id,org_unit_id:U.org_unit_id,status:U.status};U.asset_id&&(k.asset_id=U.asset_id),U.security_area_id&&(k.security_area_id=U.security_area_id),U.responsible&&(k.responsible=U.responsible),U.implementation_date&&(k.implementation_date=U.implementation_date),U.description&&(k.description=U.description),U.evidence_url&&(k.evidence_url=U.evidence_url),U.design_effectiveness!==""&&(k.design_effectiveness=Number(U.design_effectiveness)),U.operational_effectiveness!==""&&(k.operational_effectiveness=Number(U.operational_effectiveness)),U.coverage_percent!==""&&(k.coverage_percent=Number(U.coverage_percent)),U.test_frequency_days!==""&&(k.test_frequency_days=Number(U.test_frequency_days));const I=y?`${Ui}/api/v1/control-effectiveness/${y.id}`:`${Ui}/api/v1/control-effectiveness`;await fetch(I,{method:y?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),j(!1),me()},T=async()=>{if(!_)return;const k={test_date:H.test_date,test_type:H.test_type,tester:H.tester,result:H.result};H.design_score!==""&&(k.design_score=Number(H.design_score)),H.operational_score!==""&&(k.operational_score=Number(H.operational_score)),H.findings&&(k.findings=H.findings),H.recommendations&&(k.recommendations=H.recommendations),await fetch(`${Ui}/api/v1/control-effectiveness/${_.id}/tests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),b(!1),me()},C=async k=>{await fetch(`${Ui}/api/v1/control-effectiveness/${k}`,{method:"DELETE"}),me()};return f?e.jsx("div",{style:{padding:32},children:"adowanie..."}):e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:8},children:"Ocena Skutecznoci Zabezpiecze"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:16},children:"ledzenie wdroe zabezpiecze z katalogu kontroli, ich skutecznoci operacyjnej i wynikw testw/walidacji."}),e.jsx(Ia,{cards:W,isFiltered:ee.hasActiveFilters}),a?.recommended_safeguard_rating!=null&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:16,display:"flex",gap:16,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Rekomendowane Z (safeguard_rating) na podstawie ocen:"}),e.jsx("span",{style:{fontWeight:700,fontSize:18,color:tu(a.avg_overall_effectiveness)},children:a.recommended_safeguard_rating}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",a.avg_overall_effectiveness!=null?`skuteczno ${a.avg_overall_effectiveness}%`:"brak danych",")"]}),a.overdue_tests>0&&e.jsxs("span",{style:{fontSize:12,color:"#dc2626",marginLeft:"auto"},children:[a.overdue_tests," przeterminowanych testw"]})]}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"wdroe",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj zabezpieczenia...",showFilters:R,onToggleFilters:()=>G(!R),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:Rm,visibleColumns:F,onToggleColumn:q,data:ee.filtered,exportFilename:"skutecznosc_zabezpieczen",primaryLabel:"+ Dodaj wdroenie",onPrimaryAction:J}),e.jsx(Ea,{columns:Rm,visibleColumns:F,data:ee.pageData,rowKey:k=>String(k.id),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,showFilters:R,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,onRowClick:ne,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,renderCell:(k,I)=>{if(I==="status")return e.jsx("span",{style:{color:Qv[k.status]||"inherit",fontWeight:600},children:Fm[k.status]||k.status});if(I==="design_effectiveness"||I==="operational_effectiveness"||I==="overall_effectiveness"||I==="coverage_percent"){const D=k[I];return D==null?e.jsx("span",{style:{color:"var(--text-muted)"},children:""}):e.jsxs("span",{style:{color:tu(D),fontWeight:600},children:[D,"%"]})}if(I==="next_test_date"){if(!k.next_test_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const D=Z3(k.next_test_date);return e.jsxs("span",{style:{color:D?"#dc2626":"inherit",fontWeight:D?600:400},children:[k.next_test_date,D&&" !"]})}if(I==="last_test_date")return k.last_test_date||e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(I==="actions")return e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-xs",title:"Edytuj",onClick:D=>{D.stopPropagation(),M(k)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-xs btn-primary",title:"Test",onClick:D=>{D.stopPropagation(),V(k)},children:"+ Test"}),e.jsx("button",{className:"btn btn-xs btn-danger",title:"Dezaktywuj",onClick:D=>{D.stopPropagation(),C(k.id)},children:"X"})]})}}),e.jsxs(gt,{open:x,title:y?`Edycja: ${y.ref_id}`:"Nowe wdroenie zabezpieczenia",onClose:()=>j(!1),children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Zabezpieczenie *"}),e.jsxs("select",{value:U.control_id,onChange:k=>L({...U,control_id:Number(k.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),o.map(k=>e.jsxs("option",{value:k.id,children:[k.ref_id,"  ",k.name]},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsxs("select",{value:U.org_unit_id,onChange:k=>L({...U,org_unit_id:Number(k.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),u.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status *"}),e.jsx("select",{value:U.status,onChange:k=>L({...U,status:k.target.value}),children:Object.entries(Fm).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny"}),e.jsx("input",{type:"text",value:U.responsible,onChange:k=>L({...U,responsible:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data wdroenia"}),e.jsx("input",{type:"date",value:U.implementation_date,onChange:k=>L({...U,implementation_date:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Skuteczno projektowa (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:U.design_effectiveness,onChange:k=>L({...U,design_effectiveness:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Skuteczno operacyjna (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:U.operational_effectiveness,onChange:k=>L({...U,operational_effectiveness:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pokrycie % (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:U.coverage_percent,onChange:k=>L({...U,coverage_percent:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Czstotliwo testw (dni)"}),e.jsx("input",{type:"number",min:1,value:U.test_frequency_days,onChange:k=>L({...U,test_frequency_days:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{rows:3,value:U.description,onChange:k=>L({...U,description:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"URL dowodu"}),e.jsx("input",{type:"text",value:U.evidence_url,onChange:k=>L({...U,evidence_url:k.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>j(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:P,disabled:!U.control_id||!U.org_unit_id,children:y?"Zapisz":"Dodaj"})]})]}),e.jsxs(gt,{open:w,title:`Nowy test: ${_?.ref_id??""}`,onClose:()=>b(!1),children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data testu *"}),e.jsx("input",{type:"date",value:H.test_date,onChange:k=>A({...H,test_date:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ testu *"}),e.jsx("select",{value:H.test_type,onChange:k=>A({...H,test_type:k.target.value}),children:Object.entries(t1).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tester *"}),e.jsx("input",{type:"text",value:H.tester,onChange:k=>A({...H,tester:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik *"}),e.jsx("select",{value:H.result,onChange:k=>A({...H,result:k.target.value}),children:Object.entries(e1).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik projektowy (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:H.design_score,onChange:k=>A({...H,design_score:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik operacyjny (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:H.operational_score,onChange:k=>A({...H,operational_score:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Ustalenia"}),e.jsx("textarea",{rows:3,value:H.findings,onChange:k=>A({...H,findings:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Rekomendacje"}),e.jsx("textarea",{rows:3,value:H.recommendations,onChange:k=>A({...H,recommendations:k.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:T,disabled:!H.tester,children:"Zapisz test"})]})]}),e.jsx(gt,{open:z,title:`Szczegy: ${O?.ref_id??""}`,onClose:()=>N(!1),children:O&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("div",{style:{fontWeight:600},children:[O.control_ref_id,"  ",O.control_name]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Jednostka org."}),e.jsx("div",{children:O.org_unit_name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{style:{color:Qv[O.status],fontWeight:600},children:Fm[O.status]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odpowiedzialny"}),e.jsx("div",{children:O.responsible||""})]})]}),e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:[{label:"Projektowa",val:O.design_effectiveness},{label:"Operacyjna",val:O.operational_effectiveness},{label:"Oglna",val:O.overall_effectiveness},{label:"Pokrycie",val:O.coverage_percent}].map(k=>e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:tu(k.val)},children:k.val!=null?`${k.val}%`:""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:k.label})]},k.label))}),O.description&&e.jsxs("div",{className:"card",style:{padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:O.description})]}),e.jsxs("h4",{style:{marginBottom:8},children:["Historia testw (",O.tests.length,")"]}),O.tests.length===0?e.jsx("div",{style:{color:"var(--text-muted)",padding:12},children:"Brak testw"}):e.jsxs("table",{className:"data-table",style:{width:"100%",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Tester"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Projekt"}),e.jsx("th",{children:"Operac."})]})}),e.jsx("tbody",{children:O.tests.map(k=>e.jsxs("tr",{children:[e.jsx("td",{children:k.test_date}),e.jsx("td",{children:t1[k.test_type]||k.test_type}),e.jsx("td",{children:k.tester}),e.jsx("td",{style:{color:V3[k.result],fontWeight:600},children:e1[k.result]||k.result}),e.jsx("td",{children:k.design_score!=null?`${k.design_score}%`:""}),e.jsx("td",{children:k.operational_score!=null?`${k.operational_score}%`:""})]},k.id))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>{N(!1),V(O)},children:"+ Dodaj test"}),e.jsx("button",{className:"btn",onClick:()=>N(!1),children:"Zamknij"})]})]})})]})}const a1={draft:"#94a3b8",in_progress:"var(--blue)",completed:"var(--green)",archived:"#6b7280"},K3={draft:"Szkic",in_progress:"W toku",completed:"Zakoczona",archived:"Archiwalna"},n1={planned:"#94a3b8",scoping:"var(--purple)",fieldwork:"var(--yellow)",reporting:"var(--blue)",review:"var(--cyan)",completed:"var(--green)",closed:"#6b7280",cancelled:"var(--red)"},q3={planned:"Zaplanowane",scoping:"Scoping",fieldwork:"Fieldwork",reporting:"Raportowanie",review:"Review",completed:"Zakoczone",closed:"Zamknite",cancelled:"Anulowane"},r1={critical:"var(--red)",high:"var(--orange)",medium:"var(--blue)",low:"var(--green)"},Y3={critical:"Krytyczny",high:"Wysoki",medium:"redni",low:"Niski"};function i1(t){return t==null?"var(--text-muted)":t>=80?"var(--green)":t>=60?"var(--yellow)":"var(--red)"}function J3(t){return t==null?"transparent":t>=80?"var(--green-dim)":t>=60?"var(--yellow-dim)":"var(--red-dim)"}function X3(){const[t,n]=m.useState([]),[a,s]=m.useState([]),[o,c]=m.useState([]),[u,h]=m.useState(!0),f=on();m.useEffect(()=>{Promise.all([le.get("/api/v1/compliance-assessments/"),le.get("/api/v1/audit-engagements/"),le.get("/api/v1/audit-programs/").catch(()=>[])]).then(([_,E,z])=>{n(_),s(E),c(z)}).catch(()=>{}).finally(()=>h(!1))},[]);const p=t.filter(_=>_.status!=="archived"),x=p.filter(_=>_.compliance_score!=null),j=x.length>0?x.reduce((_,E)=>_+(E.compliance_score??0),0)/x.length:null,y=a.filter(_=>!["completed","closed","cancelled"].includes(_.status)),S=a.reduce((_,E)=>_+E.findings_count,0),w=o.filter(_=>["active","approved"].includes(_.status)),b=[{label:"Aktywne oceny",value:p.length,color:"var(--blue)"},{label:"redni % zgodnoci",value:j!=null?`${j.toFixed(1)}%`:"",color:i1(j)},{label:"Otwarte audyty",value:y.length,color:"var(--orange)"},{label:"Ustalenia audytowe",value:S,color:S>0?"var(--red)":"var(--green)"}];return u?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."}):e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{style:{margin:0},children:"Compliance & Audit Dashboard"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>f("/compliance/assessments"),children:"+ Nowa ocena"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>f("/audit-engagements"),children:"+ Nowy audyt"})]})]}),e.jsx(Ia,{cards:b}),e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:[{label:"Oceny Zgodnoci",count:p.length,to:"/compliance/assessments",color:"var(--blue)"},{label:"Programy Audytw",count:w.length,to:"/audit-programs",color:"var(--purple)"},{label:"Zadania Audytowe",count:y.length,to:"/audit-engagements",color:"var(--orange)"},{label:"Ustalenia",count:S,to:"/audit-findings",color:S>0?"var(--red)":"var(--green)"}].map(_=>e.jsx("div",{className:"card",style:{padding:"12px 16px",cursor:"pointer",borderLeft:`3px solid ${_.color}`},onClick:()=>f(_.to),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:13,fontWeight:600},children:_.label}),e.jsx("span",{style:{fontSize:20,fontWeight:700,color:_.color,fontFamily:"'JetBrains Mono', monospace"},children:_.count})]})},_.label))}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Oceny zgodnoci"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/compliance/assessments"),children:"Zobacz wszystkie"})]}),p.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak ocen zgodnoci. Utwrz pierwsz ocen dla wybranego frameworka."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Scope"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Zgodno %"}),e.jsx("th",{style:{textAlign:"right"},children:"Postp"}),e.jsx("th",{style:{textAlign:"right"},children:"Wymagania"})]})}),e.jsx("tbody",{children:p.slice(0,10).map(_=>{const E=_.total_requirements>0?Math.round(_.assessed_count/_.total_requirements*100):0;return e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>f(`/compliance/assessments/${_.id}`),children:[e.jsx("td",{style:{fontWeight:600},children:_.framework_name}),e.jsx("td",{children:_.scope_name||_.scope_type}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{backgroundColor:`${a1[_.status]||"#94a3b8"}20`,color:a1[_.status]||"#94a3b8"},children:K3[_.status]||_.status})}),e.jsx("td",{style:{textAlign:"right"},children:_.compliance_score!=null?e.jsxs("span",{style:{background:J3(_.compliance_score),color:i1(_.compliance_score),borderRadius:6,padding:"2px 8px",fontSize:12,fontWeight:600},children:[_.compliance_score,"%"]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:6},children:[e.jsx("div",{style:{width:60,height:6,backgroundColor:"var(--border)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{width:`${E}%`,height:"100%",backgroundColor:E>=80?"var(--green)":E>=50?"var(--yellow)":"var(--red)",borderRadius:3}})}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[E,"%"]})]})}),e.jsxs("td",{style:{textAlign:"right",fontSize:12},children:[e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:_.compliant_count}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" / ",_.total_requirements]})]})]},_.id)})})]})})]}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Aktywne zadania audytowe"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/audit-engagements"),children:"Zobacz wszystkie"})]}),y.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak aktywnych zada audytowych."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Nazwa"}),e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Priorytet"}),e.jsx("th",{children:"Lead Auditor"}),e.jsx("th",{style:{textAlign:"right"},children:"Testy"}),e.jsx("th",{style:{textAlign:"right"},children:"Ustalenia"})]})}),e.jsx("tbody",{children:y.slice(0,10).map(_=>e.jsxs("tr",{style:{cursor:"pointer",borderLeft:`3px solid ${r1[_.priority]||"transparent"}`},onClick:()=>f(`/audit-engagements/${_.id}`),children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:_.ref_id}),e.jsx("td",{style:{fontWeight:600},children:_.name}),e.jsx("td",{children:_.framework_name}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{backgroundColor:`${n1[_.status]||"#94a3b8"}20`,color:n1[_.status]||"#94a3b8"},children:q3[_.status]||_.status})}),e.jsx("td",{children:e.jsx("span",{style:{color:r1[_.priority]||"inherit",fontWeight:600,fontSize:12},children:Y3[_.priority]||_.priority})}),e.jsx("td",{children:_.lead_auditor}),e.jsx("td",{style:{textAlign:"right"},children:_.tests_count}),e.jsx("td",{style:{textAlign:"right",color:_.findings_count>0?"var(--red)":"inherit",fontWeight:_.findings_count>0?600:400},children:_.findings_count})]},_.id))})]})})]}),o.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Programy audytw"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/audit-programs"),children:"Zobacz wszystkie"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:12,padding:16},children:o.slice(0,6).map(_=>e.jsxs("div",{className:"card",style:{padding:"12px 16px",cursor:"pointer"},onClick:()=>f(`/audit-engagements?program_id=${_.id}`),children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:_.name}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{className:"badge",style:{backgroundColor:_.status==="active"?"var(--blue-dim)":"var(--bg-subtle)",color:_.status==="active"?"var(--blue)":"var(--text-muted)"},children:[_.status,"  ",_.year]}),e.jsx("span",{style:{fontSize:16,fontWeight:700,color:"var(--blue)",fontFamily:"'JetBrains Mono', monospace"},children:_.engagement_count})]})]},_.id))})]})]})}function au(t){return t==null?"var(--text-muted)":t>=80?"var(--green)":t>=60?"var(--yellow)":"var(--red)"}function Q3(t){return t==null?"transparent":t>=80?"var(--green-dim)":t>=60?"var(--yellow-dim)":"var(--red-dim)"}const Bm={draft:"#94a3b8",in_progress:"var(--blue)",completed:"var(--green)",archived:"#6b7280"},Om={draft:"Szkic",in_progress:"W toku",completed:"Zakoczona",archived:"Archiwalna"},s1={continuous:"Bieca",audit_snapshot:"Snapshot"},l1={organization:"Organizacja",org_unit:"Jednostka org.",service:"Usuga",process:"Proces",project:"Projekt"};function Dm({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function ir({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function e8(){const t=[{key:"name",header:"Nazwa",format:V=>V.name||`#${V.id}`},{key:"framework_name",header:"Framework"},{key:"scope_type",header:"Scope",format:V=>l1[V.scope_type]||V.scope_type},{key:"scope_name",header:"Scope nazwa",format:V=>V.scope_name??"",defaultVisible:!1},{key:"assessment_type",header:"Typ",format:V=>s1[V.assessment_type]||V.assessment_type},{key:"status",header:"Status",format:V=>Om[V.status]||V.status},{key:"compliance_score",header:"Zgodno %",format:V=>V.compliance_score!=null?`${V.compliance_score}%`:""},{key:"assessed_count",header:"Ocenione",format:V=>`${V.assessed_count}/${V.total_requirements}`},{key:"compliant_count",header:"Zgodne",format:V=>String(V.compliant_count)},{key:"partially_count",header:"Czciowo",format:V=>String(V.partially_count),defaultVisible:!1},{key:"non_compliant_count",header:"Niezgodne",format:V=>String(V.non_compliant_count),defaultVisible:!1},{key:"not_applicable_count",header:"N/A",format:V=>String(V.not_applicable_count),defaultVisible:!1},{key:"created_at",header:"Utworzono",format:V=>V.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:V=>V.updated_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"compliance-assessments"),[s,o]=m.useState([]),[c,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),b=on(),[_,E]=m.useState({framework_id:0,scope_type:"organization",scope_name:"",name:""}),z=Aa({data:s,storageKey:"compliance-assessments",defaultSort:"compliance_score",defaultSortDir:"desc"}),N=()=>{f(!0),Promise.all([le.get("/api/v1/compliance-assessments/"),le.get("/api/v1/frameworks/")]).then(([V,ne])=>{o(V),u(ne.filter(P=>P.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(N,[]);const O=async()=>{if(_.framework_id)try{const V=await le.post("/api/v1/compliance-assessments/",{framework_id:_.framework_id,scope_type:_.scope_type,scope_name:_.scope_name||null,name:_.name||null});y(!1),b(`/compliance/assessments/${V.id}`)}catch{alert("Bd tworzenia oceny")}},Q=z.filtered,U=Q.filter(V=>V.status==="in_progress").length,L=Q.filter(V=>V.status==="completed").length,H=Q.filter(V=>V.compliance_score!=null),A=H.length>0?H.reduce((V,ne)=>V+(ne.compliance_score??0),0)/H.length:null,R=s.filter(V=>V.status==="in_progress").length,G=s.filter(V=>V.status==="completed").length,F=s.filter(V=>V.compliance_score!=null),q=F.length>0?F.reduce((V,ne)=>V+(ne.compliance_score??0),0)/F.length:null,ee=z.filteredCount!==z.totalCount,me=[{label:"Oceny ogem",value:Q.length,total:s.length,color:"var(--blue)"},{label:"W toku",value:U,total:R,color:"var(--orange)"},{label:"Zakoczone",value:L,total:G,color:"var(--green)"},{label:"redni % zgodnoci",value:A!=null?A.toFixed(1):"",total:q!=null?q.toFixed(1):"",color:au(A)}],W=p,J=W&&W.total_requirements>0?Math.round(W.assessed_count/W.total_requirements*100):0,M=W?W.total_requirements-W.assessed_count:0;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Oceny Zgodnoci"}),e.jsx(Ia,{cards:me,isFiltered:ee}),e.jsx(ma,{filteredCount:z.filteredCount,totalCount:z.totalCount,unitLabel:"ocen",search:z.search,onSearchChange:z.setSearch,searchPlaceholder:"Szukaj ocen...",showFilters:S,onToggleFilters:()=>w(V=>!V),hasActiveFilters:z.hasActiveFilters,onClearFilters:z.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:z.filtered,exportFilename:"compliance_assessments",primaryLabel:"Nowa ocena",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:z.pageData,rowKey:V=>V.id,selectedKey:p?.id??null,onRowClick:V=>x(ne=>ne?.id===V.id?null:V),rowBorderColor:V=>{const ne=V.compliance_score;if(ne!=null)return ne>=80?"var(--green)":ne>=60?"var(--orange)":"var(--red)"},renderCell:(V,ne)=>{if(ne==="compliance_score"){const P=V.compliance_score;return P==null?e.jsx("span",{style:{color:"var(--text-muted)"},children:""}):e.jsxs("span",{style:{background:Q3(P),color:au(P),borderRadius:6,padding:"2px 8px",fontSize:12,fontWeight:600},children:[P,"%"]})}if(ne==="status"){const P=Bm[V.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${P}20`,color:P},children:Om[V.status]||V.status})}if(ne==="compliant_count")return e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:V.compliant_count});if(ne==="name")return e.jsx("span",{style:{fontWeight:600},children:V.name||`#${V.id}`})},sortField:z.sortField,sortDir:z.sortDir,onSort:z.toggleSort,columnFilters:z.columnFilters,onColumnFilter:z.setColumnFilter,showFilters:S,page:z.page,totalPages:z.totalPages,pageSize:z.pageSize,totalItems:z.totalCount,filteredItems:z.filteredCount,onPageChange:z.setPage,onPageSizeChange:z.setPageSize,loading:h,emptyMessage:"Brak ocen zgodnoci. Utwrz pierwsz ocen, wybierajc framework."}),W&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:W.name||`#${W.id}`}),e.jsx("span",{className:"badge",style:{backgroundColor:`${Bm[W.status]||"#94a3b8"}20`,color:Bm[W.status]||"#94a3b8"},children:Om[W.status]||W.status})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>b(`/compliance/assessments/${W.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]})]}),W.compliance_score!=null&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono', monospace",color:au(W.compliance_score)},children:[W.compliance_score,"%"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zgodno"}),e.jsx("div",{style:{marginTop:8,height:6,backgroundColor:"var(--border)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{width:`${J}%`,height:"100%",backgroundColor:au(W.compliance_score),borderRadius:3,transition:"width 0.3s"}})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Postp: ",W.assessed_count," / ",W.total_requirements]})]}),e.jsx(Dm,{number:"1",label:"Framework i scope"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ir,{label:"Framework",value:W.framework_name}),e.jsx(ir,{label:"Scope",value:l1[W.scope_type]||W.scope_type}),W.scope_name&&e.jsx(ir,{label:"Scope nazwa",value:W.scope_name}),e.jsx(ir,{label:"Typ oceny",value:s1[W.assessment_type]||W.assessment_type})]}),e.jsx(Dm,{number:"2",label:"Wyniki oceny"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ir,{label:"Zgodne",value:W.compliant_count,color:"var(--green)"}),e.jsx(ir,{label:"Czciowo zgodne",value:W.partially_count,color:"var(--yellow)"}),e.jsx(ir,{label:"Niezgodne",value:W.non_compliant_count,color:"var(--red)"}),e.jsx(ir,{label:"Nie dotyczy",value:W.not_applicable_count}),e.jsx(ir,{label:"Nieocenione",value:M>0?M:0}),e.jsx(ir,{label:"Razem wymaga",value:W.total_requirements})]}),e.jsx(Dm,{number:"3",label:"Daty"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13},children:[e.jsx(ir,{label:"Utworzono",value:W.created_at?.slice(0,10)}),e.jsx(ir,{label:"Aktualizacja",value:W.updated_at?.slice(0,10)})]})]})]}),e.jsx(gt,{open:j,title:"Nowa ocena zgodnoci",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Framework *",e.jsxs("select",{className:"form-control",value:_.framework_id,onChange:V=>E({..._,framework_id:Number(V.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),c.map(V=>e.jsxs("option",{value:V.id,children:[V.name," (",V.total_assessable," wymaga)"]},V.id))]})]}),e.jsxs("label",{children:["Scope",e.jsxs("select",{className:"form-control",value:_.scope_type,onChange:V=>E({..._,scope_type:V.target.value}),children:[e.jsx("option",{value:"organization",children:"Caa organizacja"}),e.jsx("option",{value:"org_unit",children:"Jednostka organizacyjna"}),e.jsx("option",{value:"service",children:"Usuga"}),e.jsx("option",{value:"process",children:"Proces"})]})]}),e.jsxs("label",{children:["Nazwa scope",e.jsx("input",{className:"form-control",value:_.scope_name,onChange:V=>E({..._,scope_name:V.target.value}),placeholder:"np. Dzia IT"})]}),e.jsxs("label",{children:["Nazwa oceny (opcjonalna)",e.jsx("input",{className:"form-control",value:_.name,onChange:V=>E({..._,name:V.target.value}),placeholder:"np. ISO 27001  IT  2026"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:!_.framework_id,children:"Utwrz"})]})]})})]})}const ip=[{value:"not_assessed",label:"Nieocenione",color:"#94a3b8",icon:""},{value:"compliant",label:"Zgodne",color:"#22c55e",icon:""},{value:"partially_compliant",label:"Czciowo zgodne",color:"#f59e0b",icon:""},{value:"non_compliant",label:"Niezgodne",color:"#ef4444",icon:""},{value:"not_applicable",label:"Nie dotyczy",color:"#6b7280",icon:""}];function t8(t){return ip.find(n=>n.value===t)||ip[0]}function a8(t){return t==null?"var(--text-muted)":t>=80?"#22c55e":t>=60?"#f59e0b":"#ef4444"}function n8(){const{assessmentId:t}=Lu(),n=on(),[a,s]=m.useState(null),[o,c]=m.useState([]),[u,h]=m.useState(!0),[f,p]=m.useState(null),[x,j]=m.useState(new Set),y=m.useCallback(async()=>{if(t)try{const[z,N]=await Promise.all([le.get(`/api/v1/compliance-assessments/${t}`),le.get(`/api/v1/compliance-assessments/${t}/requirements?selected_only=false`)]);s(z),c(N);const O=new Set(N.filter(Q=>Q.node_depth===1).map(Q=>Q.requirement_node_id));j(O)}catch{alert("Bd wczytywania oceny")}finally{h(!1)}},[t]);m.useEffect(()=>{y()},[y]);const S=async(z,N)=>{p(z.id);try{const O=await le.put(`/api/v1/compliance-assessments/requirements/${z.id}`,{result:N});c(U=>U.map(L=>L.id===z.id?{...L,...O}:L));const Q=await le.get(`/api/v1/compliance-assessments/${t}`);s(Q)}catch{alert("Bd zapisu")}finally{p(null)}},w=z=>{j(N=>{const O=new Set(N);return O.has(z)?O.delete(z):O.add(z),O})};if(u||!a)return e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."});const b=a.total_requirements>0?Math.round(a.assessed_count/a.total_requirements*100):0,_=[{label:"Zgodno",value:a.compliance_score!=null?`${a.compliance_score}%`:"",color:a8(a.compliance_score)},{label:"Postp oceny",value:`${b}%`,color:b>=80?"#22c55e":"#f59e0b"},{label:"Zgodne",value:a.compliant_count,color:"#22c55e"},{label:"Niezgodne",value:a.non_compliant_count,color:"#ef4444"}];o.filter(z=>z.node_assessable===!1||z.node_depth===1),o.filter(z=>z.node_assessable===!0);const E=z=>{const N=o.indexOf(z);for(let O=N-1;O>=0;O--){const Q=o[O];if(Q.node_depth!=null&&z.node_depth!=null&&Q.node_depth<z.node_depth)return Q.requirement_node_id}return null};return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-xs",onClick:()=>n("/compliance/assessments"),style:{marginBottom:8},children:" Powrt"}),e.jsx("h2",{style:{margin:0},children:a.name||a.framework_name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:[a.framework_name," | ",a.scope_name||a.scope_type," | Status: ",a.status]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[a.status==="draft"&&e.jsx("button",{className:"btn btn-primary",onClick:async()=>{await le.put(`/api/v1/compliance-assessments/${t}`,{status:"in_progress"}),y()},children:"Rozpocznij ocen"}),a.status==="in_progress"&&e.jsx("button",{className:"btn btn-primary",onClick:async()=>{await le.put(`/api/v1/compliance-assessments/${t}`,{status:"completed"}),y()},children:"Zakocz ocen"})]})]}),e.jsx(Ia,{cards:_}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4,color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Postp: ",a.assessed_count," / ",a.total_requirements," wymaga"]}),e.jsxs("span",{children:[b,"%"]})]}),e.jsx("div",{style:{height:8,backgroundColor:"var(--border)",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{width:`${b}%`,height:"100%",backgroundColor:b>=80?"#22c55e":b>=50?"#f59e0b":"#3b82f6",borderRadius:4,transition:"width 0.3s"}})})]}),e.jsx("div",{className:"card",children:o.map(z=>{const N=t8(z.result),O=z.node_assessable===!1,Q=z.node_assessable===!0,U=z.node_depth||1,L=x.has(z.requirement_node_id);if(!O&&U>1){const H=E(z);if(H&&!x.has(H))return null}if(O){const H=o.indexOf(z);let A=0,R=0;for(let G=H+1;G<o.length;G++){const F=o[G];if(F.node_depth!=null&&F.node_depth<=U)break;F.node_assessable&&(A++,F.result==="compliant"&&R++)}return e.jsxs("div",{style:{padding:"10px 16px",paddingLeft:16+(U-1)*20,backgroundColor:U===1?"var(--bg-subtle)":void 0,borderBottom:"1px solid var(--border)",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onClick:()=>w(z.requirement_node_id),children:[e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:12},children:L?"":""}),e.jsxs("span",{style:{fontWeight:600,fontSize:13},children:[z.node_ref_id&&e.jsx("span",{style:{color:"var(--text-muted)",marginRight:6},children:z.node_ref_id}),z.node_name_pl||z.node_name]})]}),A>0&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[R,"/",A," "]})]},z.id)}return Q?e.jsxs("div",{style:{padding:"8px 16px",paddingLeft:16+(U-1)*20,borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,opacity:f===z.id?.6:1},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13},children:[z.node_ref_id&&e.jsx("span",{style:{color:"var(--text-muted)",marginRight:6,fontFamily:"monospace",fontSize:11},children:z.node_ref_id}),z.node_name_pl||z.node_name]}),z.notes&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:z.notes})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,flexShrink:0},children:[z.evidence_count>0&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},title:"Dowody",children:["",z.evidence_count]}),e.jsx("select",{className:"form-control",value:z.result,onChange:H=>S(z,H.target.value),disabled:f===z.id,style:{width:180,fontSize:12,color:N.color,fontWeight:600,padding:"4px 8px"},children:ip.map(H=>e.jsxs("option",{value:H.value,children:[H.icon," ",H.label]},H.value))})]})]},z.id):null})})]})}const Lm={draft:"#94a3b8",submitted:"var(--purple)",approved:"var(--green)",active:"var(--blue)",completed:"#6b7280",archived:"#6b7280"},Mm={draft:"Szkic",submitted:"Zgoszony",approved:"Zatwierdzony",active:"Aktywny",completed:"Zakoczony",archived:"Archiwalny"};function o1({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function nu({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function r8(){const t=[{key:"name",header:"Nazwa"},{key:"year",header:"Rok",format:q=>String(q.year)},{key:"status",header:"Status",format:q=>Mm[q.status]||q.status},{key:"engagement_count",header:"Zadania",format:q=>String(q.engagement_count)},{key:"prepared_by",header:"Przygotowa",format:q=>q.prepared_by??""},{key:"approved_by",header:"Zatwierdzi",format:q=>q.approved_by??"",defaultVisible:!1},{key:"approved_at",header:"Data zatwierdzenia",format:q=>q.approved_at?.slice(0,10)??"",defaultVisible:!1},{key:"description",header:"Opis",format:q=>q.description??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:q=>q.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"audit-programs"),[s,o]=m.useState([]),[c,u]=m.useState(!0),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j,y]=m.useState(!1),S=on(),[w,b]=m.useState({name:"",year:new Date().getFullYear(),description:"",prepared_by:""}),_=Aa({data:s,storageKey:"audit-programs",defaultSort:"year",defaultSortDir:"desc"}),E=()=>{u(!0),le.get("/api/v1/audit-programs/").then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(E,[]);const z=async()=>{if(w.name.trim())try{await le.post("/api/v1/audit-programs/",{name:w.name,year:w.year,description:w.description||null,prepared_by:w.prepared_by||null}),x(!1),b({name:"",year:new Date().getFullYear(),description:"",prepared_by:""}),E()}catch{alert("Bd tworzenia programu")}},N=_.filtered,O=N.filter(q=>["active","approved"].includes(q.status)).length,Q=N.reduce((q,ee)=>q+ee.engagement_count,0),U=N.filter(q=>q.status==="completed").length,L=s.filter(q=>["active","approved"].includes(q.status)).length,H=s.reduce((q,ee)=>q+ee.engagement_count,0),A=s.filter(q=>q.status==="completed").length,R=_.filteredCount!==_.totalCount,G=[{label:"Programy ogem",value:N.length,total:s.length,color:"var(--blue)"},{label:"Aktywne",value:O,total:L,color:"var(--green)"},{label:"Zakoczone",value:U,total:A,color:"#6b7280"},{label:"Zadania cznie",value:Q,total:H,color:"var(--purple)"}],F=h;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Programy Audytw"}),e.jsx(Ia,{cards:G,isFiltered:R}),e.jsx(ma,{filteredCount:_.filteredCount,totalCount:_.totalCount,unitLabel:"programw",search:_.search,onSearchChange:_.setSearch,searchPlaceholder:"Szukaj programw...",showFilters:j,onToggleFilters:()=>y(q=>!q),hasActiveFilters:_.hasActiveFilters,onClearFilters:_.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:_.filtered,exportFilename:"audit_programs",primaryLabel:"Nowy program",onPrimaryAction:()=>x(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:_.pageData,rowKey:q=>q.id,selectedKey:h?.id??null,onRowClick:q=>f(ee=>ee?.id===q.id?null:q),renderCell:(q,ee)=>{if(ee==="name")return e.jsx("span",{style:{fontWeight:600},children:q.name});if(ee==="status"){const me=Lm[q.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${me}20`,color:me},children:Mm[q.status]||q.status})}if(ee==="engagement_count")return e.jsx("span",{style:{fontWeight:600,color:q.engagement_count>0?"var(--blue)":"var(--text-muted)"},children:q.engagement_count})},sortField:_.sortField,sortDir:_.sortDir,onSort:_.toggleSort,columnFilters:_.columnFilters,onColumnFilter:_.setColumnFilter,showFilters:j,page:_.page,totalPages:_.totalPages,pageSize:_.pageSize,totalItems:_.totalCount,filteredItems:_.filteredCount,onPageChange:_.setPage,onPageSizeChange:_.setPageSize,loading:c,emptyMessage:"Brak programw audytw. Utwrz roczny plan audytw."}),F&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:F.name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${Lm[F.status]||"#94a3b8"}20`,color:Lm[F.status]||"#94a3b8"},children:Mm[F.status]||F.status}),e.jsx("span",{className:"badge",style:{backgroundColor:"var(--blue-dim)",color:"var(--blue)"},children:F.year})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>S(`/audit-engagements?program_id=${F.id}`),children:"Zadania"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono', monospace",color:"var(--blue)"},children:F.engagement_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zada audytowych"})]}),e.jsx(o1,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(nu,{label:"Rok",value:F.year}),e.jsx(nu,{label:"Przygotowa",value:F.prepared_by}),e.jsx(nu,{label:"Zatwierdzi",value:F.approved_by}),e.jsx(nu,{label:"Data zatwierdzenia",value:F.approved_at?.slice(0,10)})]}),F.description&&e.jsxs(e.Fragment,{children:[e.jsx(o1,{number:"2",label:"Opis"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:F.description})]})]})]}),e.jsx(gt,{open:p,title:"Nowy program audytw",onClose:()=>x(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:w.name,onChange:q=>b({...w,name:q.target.value}),placeholder:"np. Program Audytw IT 2026"})]}),e.jsxs("label",{children:["Rok ",e.jsx("input",{className:"form-control",type:"number",value:w.year,onChange:q=>b({...w,year:Number(q.target.value)})})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:w.description,onChange:q=>b({...w,description:q.target.value}),rows:3})]}),e.jsxs("label",{children:["Przygotowa ",e.jsx("input",{className:"form-control",value:w.prepared_by,onChange:q=>b({...w,prepared_by:q.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>x(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:z,disabled:!w.name.trim(),children:"Utwrz"})]})]})})]})}const Im={planned:"#94a3b8",scoping:"var(--purple)",fieldwork:"var(--yellow)",reporting:"var(--blue)",review:"var(--cyan)",completed:"var(--green)",closed:"#6b7280",cancelled:"var(--red)"},Pm={planned:"Zaplanowane",scoping:"Scoping",fieldwork:"Fieldwork",reporting:"Raportowanie",review:"Review",completed:"Zakoczone",closed:"Zamknite",cancelled:"Anulowane"},ru={critical:"var(--red)",high:"var(--orange)",medium:"var(--blue)",low:"var(--green)"},Wm={critical:"Krytyczny",high:"Wysoki",medium:"redni",low:"Niski"};function Um({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function ei({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function i8(){const t=[{key:"ref_id",header:"Ref",format:J=>J.ref_id},{key:"name",header:"Nazwa"},{key:"framework_name",header:"Framework"},{key:"status",header:"Status",format:J=>Pm[J.status]||J.status},{key:"priority",header:"Priorytet",format:J=>Wm[J.priority]||J.priority},{key:"lead_auditor",header:"Lead Auditor"},{key:"planned_start",header:"Plan start",format:J=>J.planned_start??""},{key:"planned_end",header:"Plan koniec",format:J=>J.planned_end??"",defaultVisible:!1},{key:"actual_start",header:"Faktyczny start",format:J=>J.actual_start??"",defaultVisible:!1},{key:"actual_end",header:"Faktyczny koniec",format:J=>J.actual_end??"",defaultVisible:!1},{key:"scope_type",header:"Scope",format:J=>J.scope_type,defaultVisible:!1},{key:"scope_name",header:"Scope nazwa",format:J=>J.scope_name??"",defaultVisible:!1},{key:"supervisor",header:"Supervisor",format:J=>J.supervisor??"",defaultVisible:!1},{key:"program_name",header:"Program",format:J=>J.program_name??"",defaultVisible:!1},{key:"tests_count",header:"Testy",format:J=>String(J.tests_count)},{key:"findings_count",header:"Ustalenia",format:J=>String(J.findings_count)},{key:"created_at",header:"Utworzono",format:J=>J.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"audit-engagements"),[s,o]=m.useState([]),[c,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b]=hc(),_=b.get("program_id"),E=on(),[z,N]=m.useState({name:"",framework_id:0,objective:"",lead_auditor:"",priority:"medium",scope_type:"organization",scope_name:"",planned_start:"",planned_end:"",audit_program_id:_?Number(_):null}),O=Aa({data:s,storageKey:"audit-engagements",defaultSort:"created_at",defaultSortDir:"desc"}),Q=()=>{f(!0);const J=_?`/api/v1/audit-engagements/?program_id=${_}`:"/api/v1/audit-engagements/";Promise.all([le.get(J),le.get("/api/v1/frameworks/")]).then(([M,V])=>{o(M),u(V.filter(ne=>ne.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(Q,[_]);const U=async()=>{if(!(!z.name.trim()||!z.framework_id||!z.objective.trim()||!z.lead_auditor.trim()))try{const J=await le.post("/api/v1/audit-engagements/",{name:z.name,framework_id:z.framework_id,objective:z.objective,lead_auditor:z.lead_auditor,priority:z.priority,scope_type:z.scope_type,scope_name:z.scope_name||null,planned_start:z.planned_start||null,planned_end:z.planned_end||null,audit_program_id:z.audit_program_id});y(!1),E(`/audit-engagements/${J.id}`)}catch{alert("Bd tworzenia zadania")}},L=O.filtered,H=L.filter(J=>!["completed","closed","cancelled"].includes(J.status)),A=L.reduce((J,M)=>J+M.findings_count,0),R=L.reduce((J,M)=>J+M.tests_count,0),G=s.filter(J=>!["completed","closed","cancelled"].includes(J.status)),F=s.reduce((J,M)=>J+M.findings_count,0),q=s.reduce((J,M)=>J+M.tests_count,0),ee=O.filteredCount!==O.totalCount,me=[{label:"Zadania ogem",value:L.length,total:s.length,color:"var(--blue)"},{label:"W toku",value:H.length,total:G.length,color:"var(--orange)"},{label:"Testy",value:R,total:q,color:"var(--purple)"},{label:"Ustalenia",value:A,total:F,color:A>0?"var(--red)":"var(--green)"}],W=p;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Zadania Audytowe"}),_&&e.jsxs("div",{style:{background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:"var(--radius-sm)",padding:"8px 14px",marginBottom:12,fontSize:12,color:"var(--blue)",display:"flex",alignItems:"center",gap:8},children:["Filtr programu: ID ",_,e.jsx("button",{className:"btn btn-xs",onClick:()=>E("/audit-engagements"),style:{marginLeft:"auto"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:me,isFiltered:ee}),e.jsx(ma,{filteredCount:O.filteredCount,totalCount:O.totalCount,unitLabel:"zada",search:O.search,onSearchChange:O.setSearch,searchPlaceholder:"Szukaj zada audytowych...",showFilters:S,onToggleFilters:()=>w(J=>!J),hasActiveFilters:O.hasActiveFilters,onClearFilters:O.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:O.filtered,exportFilename:"audit_engagements",primaryLabel:"Nowe zadanie",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:O.pageData,rowKey:J=>J.id,selectedKey:p?.id??null,onRowClick:J=>x(M=>M?.id===J.id?null:J),rowBorderColor:J=>ru[J.priority]||void 0,renderCell:(J,M)=>{if(M==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:J.ref_id});if(M==="name")return e.jsx("span",{style:{fontWeight:600},children:J.name});if(M==="status"){const V=Im[J.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${V}20`,color:V},children:Pm[J.status]||J.status})}if(M==="priority"){const V=ru[J.priority]||"inherit";return e.jsx("span",{style:{color:V,fontWeight:600,fontSize:12},children:Wm[J.priority]||J.priority})}if(M==="findings_count")return e.jsx("span",{style:{color:J.findings_count>0?"var(--red)":"inherit",fontWeight:J.findings_count>0?600:400},children:J.findings_count})},sortField:O.sortField,sortDir:O.sortDir,onSort:O.toggleSort,columnFilters:O.columnFilters,onColumnFilter:O.setColumnFilter,showFilters:S,page:O.page,totalPages:O.totalPages,pageSize:O.pageSize,totalItems:O.totalCount,filteredItems:O.filteredCount,onPageChange:O.setPage,onPageSizeChange:O.setPageSize,loading:h,emptyMessage:"Brak zada audytowych. Utwrz pierwsze zadanie."}),W&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)",marginBottom:2},children:W.ref_id}),e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:W.name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${Im[W.status]||"#94a3b8"}20`,color:Im[W.status]||"#94a3b8"},children:Pm[W.status]||W.status}),e.jsx("span",{className:"badge",style:{backgroundColor:`${ru[W.priority]}20`,color:ru[W.priority]},children:Wm[W.priority]||W.priority})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>E(`/audit-engagements/${W.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:10},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"var(--purple)",fontFamily:"'JetBrains Mono', monospace"},children:W.tests_count}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Testw"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:10},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:W.findings_count>0?"var(--red)":"var(--green)",fontFamily:"'JetBrains Mono', monospace"},children:W.findings_count}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Ustale"})]})]}),e.jsx(Um,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ei,{label:"Framework",value:W.framework_name}),e.jsx(ei,{label:"Scope",value:W.scope_name||W.scope_type}),e.jsx(ei,{label:"Lead auditor",value:W.lead_auditor}),W.supervisor&&e.jsx(ei,{label:"Supervisor",value:W.supervisor}),W.program_name&&e.jsx(ei,{label:"Program",value:W.program_name})]}),e.jsx(Um,{number:"2",label:"Cel audytu"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",marginBottom:12,lineHeight:1.5},children:W.objective}),e.jsx(Um,{number:"3",label:"Harmonogram"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13},children:[e.jsx(ei,{label:"Plan start",value:W.planned_start}),e.jsx(ei,{label:"Plan koniec",value:W.planned_end}),e.jsx(ei,{label:"Faktyczny start",value:W.actual_start}),e.jsx(ei,{label:"Faktyczny koniec",value:W.actual_end})]})]})]}),e.jsx(gt,{open:j,title:"Nowe zadanie audytowe",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:z.name,onChange:J=>N({...z,name:J.target.value}),placeholder:"np. Audyt ISO 27001  Dzia IT"})]}),e.jsxs("label",{children:["Framework *",e.jsxs("select",{className:"form-control",value:z.framework_id,onChange:J=>N({...z,framework_id:Number(J.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),c.map(J=>e.jsx("option",{value:J.id,children:J.name},J.id))]})]}),e.jsxs("label",{children:["Cel audytu * ",e.jsx("textarea",{className:"form-control",value:z.objective,onChange:J=>N({...z,objective:J.target.value}),rows:2,placeholder:"Cel i zakres audytu..."})]}),e.jsxs("label",{children:["Lead Auditor * ",e.jsx("input",{className:"form-control",value:z.lead_auditor,onChange:J=>N({...z,lead_auditor:J.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Priorytet",e.jsxs("select",{className:"form-control",value:z.priority,onChange:J=>N({...z,priority:J.target.value}),children:[e.jsx("option",{value:"low",children:"Niski"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"critical",children:"Krytyczny"})]})]}),e.jsxs("label",{children:["Scope",e.jsxs("select",{className:"form-control",value:z.scope_type,onChange:J=>N({...z,scope_type:J.target.value}),children:[e.jsx("option",{value:"organization",children:"Caa organizacja"}),e.jsx("option",{value:"org_unit",children:"Jednostka org."}),e.jsx("option",{value:"service",children:"Usuga"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Planowany start ",e.jsx("input",{className:"form-control",type:"date",value:z.planned_start,onChange:J=>N({...z,planned_start:J.target.value})})]}),e.jsxs("label",{children:["Planowany koniec ",e.jsx("input",{className:"form-control",type:"date",value:z.planned_end,onChange:J=>N({...z,planned_end:J.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:U,disabled:!z.name.trim()||!z.framework_id||!z.objective.trim()||!z.lead_auditor.trim(),children:"Utwrz"})]})]})})]})}const c1={planned:"#94a3b8",scoping:"#8b5cf6",fieldwork:"#f59e0b",reporting:"#3b82f6",review:"#06b6d4",completed:"#22c55e",closed:"#6b7280",cancelled:"#ef4444"},s8={pass:"#22c55e",fail:"#ef4444",partial:"#f59e0b",not_tested:"#94a3b8",inconclusive:"#8b5cf6"},d1={critical:"#dc2626",high:"#f59e0b",medium:"#3b82f6",low:"#22c55e",informational:"#6b7280"},l8=["Przegld","Testy","Ustalenia","Raport"];function o8(){const{engId:t}=Lu(),n=on(),[a,s]=m.useState(null),[o,c]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState("Przegld"),[x,j]=m.useState(!0),[y,S]=m.useState(!1),[w,b]=m.useState(!1),[_,E]=m.useState({name:"",test_type:"design",description:""}),[z,N]=m.useState({title:"",condition_text:"",criteria_text:"",severity:"medium",recommendation:""}),O=m.useCallback(async()=>{if(t)try{const[F,q,ee]=await Promise.all([le.get(`/api/v1/audit-engagements/${t}`),le.get(`/api/v1/audit-engagements/${t}/tests`),le.get(`/api/v1/audit-engagements/${t}/findings`)]);s(F),c(q),h(ee)}catch{}finally{j(!1)}},[t]);m.useEffect(()=>{O()},[O]);const Q=async F=>{try{await le.post(`/api/v1/audit-engagements/${t}/transition`,{target_status:F}),O()}catch(q){alert(q.message||"Bd zmiany statusu")}},U=async()=>{_.name.trim()&&(await le.post(`/api/v1/audit-engagements/${t}/tests`,_),S(!1),E({name:"",test_type:"design",description:""}),O())},L=async()=>{!z.title.trim()||!z.condition_text.trim()||!z.criteria_text.trim()||(await le.post(`/api/v1/audit-engagements/${t}/findings`,z),b(!1),N({title:"",condition_text:"",criteria_text:"",severity:"medium",recommendation:""}),O())},H=async(F,q)=>{await le.put(`/api/v1/audit-engagements/tests/${F}`,{test_result:q}),O()};if(x||!a)return e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."});const A=Object.entries({planned:"scoping",scoping:"fieldwork",fieldwork:"reporting",reporting:"review",review:"completed",completed:"closed"})[Object.keys({planned:1,scoping:1,fieldwork:1,reporting:1,review:1,completed:1}).indexOf(a.status)],R=o.filter(F=>F.test_result==="pass").length,G=o.filter(F=>F.test_result==="fail").length;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("button",{className:"btn btn-xs",onClick:()=>n("/audit-engagements"),style:{marginBottom:8},children:" Powrt"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontFamily:"monospace",fontSize:16,marginRight:8},children:a.ref_id}),a.name]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4,display:"flex",gap:16,alignItems:"center"},children:[e.jsxs("span",{children:["Framework: ",a.framework_name]}),e.jsxs("span",{children:["Lead: ",a.lead_auditor]}),e.jsx("span",{className:"badge",style:{backgroundColor:`${c1[a.status]}20`,color:c1[a.status]},children:a.status})]})]}),A&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>Q(A[1]),children:[" ",A[1]]})]}),e.jsx("div",{style:{display:"flex",gap:0,borderBottom:"2px solid var(--border)",marginBottom:16},children:l8.map(F=>e.jsx("button",{onClick:()=>p(F),style:{padding:"8px 20px",border:"none",background:"none",cursor:"pointer",fontWeight:f===F?600:400,color:f===F?"var(--primary)":"var(--text-muted)",borderBottom:f===F?"2px solid var(--primary)":"2px solid transparent",marginBottom:-2},children:F},F))}),f==="Przegld"&&e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:"var(--text-muted)"},children:"Cel audytu"}),e.jsx("p",{style:{margin:0,fontSize:14},children:a.objective})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:"var(--text-muted)"},children:"Harmonogram"}),e.jsxs("div",{style:{fontSize:13},children:[e.jsxs("div",{children:["Plan: ",a.planned_start||"","  ",a.planned_end||""]}),e.jsxs("div",{children:["Faktycznie: ",a.actual_start||"","  ",a.actual_end||""]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginTop:20},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#3b82f6"},children:o.length}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Testw"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#22c55e"},children:R}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pass"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#ef4444"},children:G}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Fail"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:u.length>0?"#ef4444":"#22c55e"},children:u.length}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Ustale"})]})]})]}),f==="Testy"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>S(!0),children:"+ Dodaj test"})}),o.length===0?e.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak testw. Dodaj testy audytowe."}):e.jsx("div",{className:"card",children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Nazwa"}),e.jsx("th",{children:"Wymaganie"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Audytor"})]})}),e.jsx("tbody",{children:o.map(F=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:12},children:F.ref_id}),e.jsx("td",{style:{fontWeight:600},children:F.name}),e.jsx("td",{style:{fontSize:12},children:F.node_ref_id||""}),e.jsx("td",{style:{fontSize:12},children:F.test_type}),e.jsx("td",{children:e.jsxs("select",{className:"form-control",value:F.test_result,onChange:q=>H(F.id,q.target.value),style:{fontSize:12,padding:"2px 6px",color:s8[F.test_result],fontWeight:600},children:[e.jsx("option",{value:"not_tested",children:"Not tested"}),e.jsx("option",{value:"pass",children:"Pass"}),e.jsx("option",{value:"fail",children:"Fail"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"inconclusive",children:"Inconclusive"})]})}),e.jsx("td",{style:{fontSize:12},children:F.auditor_name||""})]},F.id))})]})})]}),f==="Ustalenia"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>b(!0),children:"+ Nowe ustalenie"})}),u.length===0?e.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak ustale audytowych."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:u.map(F=>e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontSize:12,color:"var(--text-muted)",marginRight:8},children:F.ref_id}),e.jsx("span",{style:{fontWeight:600},children:F.title})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${d1[F.severity]}20`,color:d1[F.severity]},children:F.severity}),e.jsx("span",{className:"badge",children:F.status})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,fontSize:13},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:11,color:"var(--text-muted)"},children:"Stan faktyczny:"}),e.jsx("p",{style:{margin:"4px 0 0"},children:F.condition_text})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:11,color:"var(--text-muted)"},children:"Kryterium:"}),e.jsx("p",{style:{margin:"4px 0 0"},children:F.criteria_text})]})]}),F.target_date&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:8},children:["Termin: ",F.target_date]})]},F.id))})]}),f==="Raport"&&e.jsxs("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:["Raport audytowy  funkcjonalno w przygotowaniu.",e.jsx("br",{}),"Raport zostanie wygenerowany automatycznie na bazie ustale i wynikw testw."]}),e.jsx(gt,{open:y,title:"Dodaj test audytowy",onClose:()=>S(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:_.name,onChange:F=>E({..._,name:F.target.value})})]}),e.jsxs("label",{children:["Typ",e.jsxs("select",{className:"form-control",value:_.test_type,onChange:F=>E({..._,test_type:F.target.value}),children:[e.jsx("option",{value:"design",children:"Design"}),e.jsx("option",{value:"operating",children:"Operating"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:_.description,onChange:F=>E({..._,description:F.target.value}),rows:3})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>S(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:U,disabled:!_.name.trim(),children:"Dodaj"})]})]})}),e.jsx(gt,{open:w,title:"Nowe ustalenie audytowe (format IIA)",onClose:()=>b(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Tytu * ",e.jsx("input",{className:"form-control",value:z.title,onChange:F=>N({...z,title:F.target.value})})]}),e.jsxs("label",{children:["Stan faktyczny (Condition) * ",e.jsx("textarea",{className:"form-control",value:z.condition_text,onChange:F=>N({...z,condition_text:F.target.value}),rows:3,placeholder:"Co jest  co faktycznie stwierdzono"})]}),e.jsxs("label",{children:["Kryterium (Criteria) * ",e.jsx("textarea",{className:"form-control",value:z.criteria_text,onChange:F=>N({...z,criteria_text:F.target.value}),rows:3,placeholder:"Co powinno by  wymaganie"})]}),e.jsxs("label",{children:["Severity",e.jsxs("select",{className:"form-control",value:z.severity,onChange:F=>N({...z,severity:F.target.value}),children:[e.jsx("option",{value:"informational",children:"Informational"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("label",{children:["Rekomendacja ",e.jsx("textarea",{className:"form-control",value:z.recommendation,onChange:F=>N({...z,recommendation:F.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:L,disabled:!z.title.trim()||!z.condition_text.trim()||!z.criteria_text.trim(),children:"Utwrz"})]})]})})]})}const oc={equal:"Equal (=)",subset:"Subset ()",superset:"Superset ()",intersect:"Intersect ()",not_related:"Not Related ()"},Vi={equal:"#10b981",subset:"#6366f1",superset:"#8b5cf6",intersect:"#f59e0b",not_related:"#94a3b8"},Ou={equal:"Ekwiwalentne",subset:"Podzbir",superset:"Nadzbir",intersect:"Przecicie",not_related:"Brak powizania"},cc={1:"Sabe",2:"Umiarkowane",3:"Silne"},dc={1:"#f87171",2:"#f59e0b",3:"#10b981"},$m={syntactic:"Syntaktyczne",semantic:"Semantyczne",functional:"Funkcjonalne"},iu={manual:"Rczne",ai_assisted:"AI-Assisted",scf_strm:"SCF STRM",import:"Import"},Ab={draft:"Wersja robocza",confirmed:"Potwierdzone"};function Xo({rel:t}){const n=Vi[t]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${n}18`,color:n,border:`1px solid ${n}40`},children:oc[t]||t})}function Qo({strength:t}){return e.jsxs("span",{style:{display:"inline-flex",gap:3,alignItems:"center"},children:[[1,2,3].map(n=>e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:n<=t?dc[t]:"var(--border)"}},n)),e.jsx("span",{style:{marginLeft:4,fontSize:11,color:"var(--text-muted)"},children:cc[t]||t})]})}function sp({status:t}){const n=t==="draft";return e.jsx("span",{className:"badge",style:{backgroundColor:n?"#f59e0b18":"#10b98118",color:n?"#f59e0b":"#10b981",border:`1px solid ${n?"#f59e0b40":"#10b98140"}`},children:Ab[t]||t})}function su({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function Wn({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function u1({percent:t,label:n,color:a}){return e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:n}),e.jsxs("span",{style:{fontWeight:600,color:a},children:[t.toFixed(1),"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:3,background:a,width:`${Math.min(t,100)}%`,transition:"width 0.3s"}})})]})}function c8({data:t}){const n=Object.values(t).reduce((a,s)=>a+s,0);return n?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Object.entries(t).map(([a,s])=>{const o=s/n*100,c=Vi[a]||"#94a3b8";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,marginBottom:2},children:[e.jsx("span",{style:{color:c,fontWeight:500},children:Ou[a]||a}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[s," (",o.toFixed(0),"%)"]})]}),e.jsx("div",{style:{height:4,borderRadius:2,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:2,background:c,width:`${o}%`}})})]},a)})}):e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak danych"})}function d8({active:t,onChange:n}){const a=[{id:"mappings",label:"Mapowania",icon:""},{id:"sets",label:"Zestawy",icon:""},{id:"ai_suggest",label:"AI Suggest",icon:""},{id:"coverage",label:"Pokrycie",icon:""},{id:"matrix",label:"Matryca",icon:""},{id:"transitive",label:"Tranzytywne",icon:""}];return e.jsx("div",{style:{display:"flex",gap:2,background:"var(--bg-secondary)",borderRadius:8,padding:3,marginBottom:16},children:a.map(s=>e.jsxs("button",{onClick:()=>n(s.id),style:{flex:1,padding:"8px 12px",borderRadius:6,border:"none",cursor:"pointer",background:t===s.id?"var(--bg-primary)":"transparent",color:t===s.id?"var(--text-primary)":"var(--text-muted)",fontWeight:t===s.id?600:400,fontSize:13,boxShadow:t===s.id?"0 1px 3px rgba(0,0,0,0.08)":"none",transition:"all 0.15s"},children:[e.jsx("span",{style:{marginRight:6},children:s.icon}),s.label]},s.id))})}function u8({value:t,onChange:n}){const[a,s]=m.useState(""),o=m.useMemo(()=>{if(!a.trim())return hu;const c=a.toLowerCase();return hu.filter(u=>u.source.toLowerCase().includes(c)||u.target.toLowerCase().includes(c)||u.filename.toLowerCase().includes(c))},[a]);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj frameworka...",value:a,onChange:c=>s(c.target.value),style:{fontSize:12}}),e.jsx("div",{style:{border:"1px solid var(--border)",borderRadius:8,overflowY:"auto",maxHeight:"min(50vh, 340px)",minHeight:120},children:o.length===0?e.jsxs("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:['Brak wynikw dla "',a,'"']}):o.map(c=>e.jsxs("div",{onClick:()=>n(c.filename),style:{padding:"8px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",background:c.filename===t?"var(--blue-dim, rgba(99,102,241,0.08))":"transparent",borderLeft:c.filename===t?"3px solid var(--blue)":"3px solid transparent",transition:"background 0.1s"},onMouseEnter:u=>{c.filename!==t&&(u.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:u=>{c.filename!==t&&(u.currentTarget.style.background=c.filename===t?"var(--blue-dim, rgba(99,102,241,0.08))":"transparent")},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:c.source}),e.jsx("span",{style:{padding:"1px 6px",borderRadius:4,fontSize:10,background:c.direction==="and"?"#6366f118":"#10b98118",color:c.direction==="and"?"#6366f1":"#10b981",fontWeight:600},children:c.direction==="and"?"":""}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:c.target})]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:c.filename})]},c.filename))}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"right"},children:[o.length," / ",hu.length," plikw"]})]})}function f8({sets:t,frameworks:n,onRefresh:a}){const[s,o]=m.useState(!1),[c,u]=m.useState(!1),[h,f]=m.useState("file"),[p,x]=m.useState(null),[j,y]=m.useState("mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml"),[S,w]=m.useState(0),[b,_]=m.useState(0),[E,z]=m.useState(!0),[N,O]=m.useState(!1),[Q,U]=m.useState(null),L=m.useRef(null),[H,A]=m.useState({source_framework_id:0,target_framework_id:0,name:""}),[R,G]=m.useState(""),F=async()=>{if(!(!H.source_framework_id||!H.target_framework_id))try{await le.post("/api/v1/framework-mappings/sets",{source_framework_id:H.source_framework_id,target_framework_id:H.target_framework_id,name:H.name||void 0}),o(!1),A({source_framework_id:0,target_framework_id:0,name:""}),a()}catch{alert("Bd tworzenia zestawu")}},q=async()=>{O(!0),U(null);try{let W;if(h==="file"){if(!p)return;const J=new FormData;J.append("file",p);const M=new URLSearchParams;S&&M.set("source_framework_id",String(S)),b&&M.set("target_framework_id",String(b)),M.set("auto_revert",String(E)),W=await le.postFormData(`/api/v1/framework-mappings/import/yaml?${M}`,J)}else{if(!j.trim())return;const J=new URLSearchParams({mapping_path:j.trim(),auto_revert:String(E)});S&&J.set("source_framework_id",String(S)),b&&J.set("target_framework_id",String(b)),W=await le.post(`/api/v1/framework-mappings/import/github-mapping?${J}`,{})}U(W),a()}catch(W){const J=W?.message||"Bd importu";U({mapping_set_id:null,source_framework_name:null,target_framework_name:null,created:0,revert_created:0,skipped:0,errors:[J]})}O(!1)},ee=()=>{x(null),U(null),w(0),_(0),z(!0),y("mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml"),f("file")},me=m.useMemo(()=>{if(!R.trim())return t;const W=R.toLowerCase();return t.filter(J=>(J.name||"").toLowerCase().includes(W)||(J.source_framework_name||"").toLowerCase().includes(W)||(J.target_framework_name||"").toLowerCase().includes(W))},[t,R]);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,flexWrap:"wrap",gap:8},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:16},children:"Zestawy Mapowa"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"var(--text-muted)"},children:"Grupuj mapowania midzy parami frameworkw (wzorzec CISO Assistant)"})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj zestaww...",value:R,onChange:W=>G(W.target.value),style:{width:200,fontSize:12,padding:"6px 10px"}}),e.jsx("button",{className:"btn",onClick:()=>{ee(),u(!0)},style:{display:"flex",alignItems:"center",gap:6},children:"Import mapowa"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>o(!0),children:"Nowy zestaw"})]})]}),R.trim()&&e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:["Znaleziono: ",me.length," z ",t.length," zestaww"]}),me.length===0?e.jsx("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:R.trim()?`Brak zestaww pasujcych do "${R}"`:"Brak zestaww mapowa. Utwrz zestaw, aby grupowa mapowania midzy frameworkami."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:12},children:me.map(W=>e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:W.name||`Set #${W.id}`}),e.jsx(sp,{status:W.status})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:[W.source_framework_name,"  ",W.target_framework_name]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{style:{padding:"8px 12px",borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--blue)"},children:W.mapping_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Mapowa"})]}),e.jsxs("div",{style:{padding:"8px 12px",borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:W.coverage_percent!=null&&W.coverage_percent>=80?"#10b981":"#f59e0b"},children:W.coverage_percent!=null?`${W.coverage_percent}%`:""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pokrycie"})]})]})]},W.id))}),e.jsx(gt,{open:s,title:"Nowy zestaw mapowa",onClose:()=>o(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Source Framework *",e.jsxs("select",{className:"form-control",value:H.source_framework_id,onChange:W=>A({...H,source_framework_id:Number(W.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),n.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{children:["Target Framework *",e.jsxs("select",{className:"form-control",value:H.target_framework_id,onChange:W=>A({...H,target_framework_id:Number(W.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),n.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{children:["Nazwa (opcjonalna)",e.jsx("input",{className:"form-control",value:H.name,onChange:W=>A({...H,name:W.target.value}),placeholder:"Auto: Framework A <-> Framework B"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:F,disabled:!H.source_framework_id||!H.target_framework_id,children:"Utwrz"})]})]})}),e.jsx(gt,{open:c,title:"Import mapowa CISO Assistant",onClose:()=>u(!1),wide:!0,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Format CISO Assistant YAML"}),e.jsxs("div",{style:{color:"var(--text-muted)",lineHeight:1.6},children:["Importuj pliki mapowa z repozytorium CISO Assistant Community. Pliki zawieraj",""," sekcj",""," ",e.jsx("code",{children:"requirement_mapping_sets"})," z definicjami powi","","za",""," mi","","dzy wymaganiami dw","","ch framework","","w. Frameworki ","r'","d","","owe i docelowe musz",""," by",""," wcze","","niej zaimportowane."]})]}),e.jsxs("div",{style:{display:"flex",gap:2,background:"var(--bg-secondary)",borderRadius:6,padding:2},children:[e.jsx("button",{onClick:()=>f("file"),style:{flex:1,padding:"6px 12px",borderRadius:4,border:"none",cursor:"pointer",background:h==="file"?"var(--bg-primary)":"transparent",color:h==="file"?"var(--text-primary)":"var(--text-muted)",fontWeight:h==="file"?600:400,fontSize:12},children:"Import z pliku"}),e.jsx("button",{onClick:()=>f("github"),style:{flex:1,padding:"6px 12px",borderRadius:4,border:"none",cursor:"pointer",background:h==="github"?"var(--bg-primary)":"transparent",color:h==="github"?"var(--text-primary)":"var(--text-muted)",fontWeight:h==="github"?600:400,fontSize:12},children:"Import z CISO Assistant"})]}),h==="file"&&e.jsxs("div",{children:[e.jsx("input",{ref:L,type:"file",accept:".yaml,.yml",style:{display:"none"},onChange:W=>x(W.target.files?.[0]||null)}),e.jsx("div",{onClick:()=>L.current?.click(),style:{border:"2px dashed var(--border)",borderRadius:8,padding:24,textAlign:"center",cursor:"pointer",transition:"border-color 0.15s",background:p?"var(--bg-secondary)":"transparent"},children:p?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:4},children:p.name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[(p.size/1024).toFixed(1)," KB  kliknij aby zmieni",""]})]}):e.jsxs("div",{style:{color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:24,marginBottom:4},children:"+"}),e.jsxs("div",{style:{fontSize:13},children:["Kliknij aby wybra",""," plik YAML"]}),e.jsx("div",{style:{fontSize:11,marginTop:4},children:"mapping-*.yaml z repozytorium CISO Assistant"})]})})]}),h==="github"&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Plik mapowania z repozytorium CISO Assistant"}),e.jsx(u8,{value:j,onChange:y}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:[hu.length," plikw mapowa w katalogu CISO Assistant Community"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Source Framework (opcjonalnie)",e.jsxs("select",{className:"form-control",value:S,onChange:W=>w(Number(W.target.value)),children:[e.jsx("option",{value:0,children:" auto z YAML "}),n.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Target Framework (opcjonalnie)",e.jsxs("select",{className:"form-control",value:b,onChange:W=>_(Number(W.target.value)),children:[e.jsx("option",{value:0,children:" auto z YAML "}),n.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:W=>z(W.target.checked)}),"Auto-revert (generuj odwrotne mapowania)"]}),Q&&e.jsx("div",{style:{padding:12,borderRadius:8,fontSize:13,lineHeight:1.6,background:Q.created>0?"#10b98118":"#ef444418",border:`1px solid ${Q.created>0?"#10b98140":"#ef444440"}`},children:Q.created>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:600,color:"#10b981",marginBottom:4},children:["Import zako","","czony pomy","","lnie"]}),e.jsxs("div",{children:["Utworzono: ",e.jsx("strong",{children:Q.created})," mapowa",""]}),Q.revert_created>0&&e.jsxs("div",{children:["Odwrotne: ",e.jsx("strong",{children:Q.revert_created})," mapowa",""]}),Q.skipped>0&&e.jsxs("div",{children:["Pomini","","to (duplikaty): ",e.jsx("strong",{children:Q.skipped})]}),Q.source_framework_name&&Q.target_framework_name&&e.jsxs("div",{style:{marginTop:4,color:"var(--text-muted)"},children:[Q.source_framework_name," ",""," ",Q.target_framework_name]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444",marginBottom:4},children:["B","","d importu"]}),Q.errors.map((W,J)=>e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:W},J))]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:4},children:[e.jsx("button",{className:"btn",onClick:()=>u(!1),children:Q?.created?"Zamknij":"Anuluj"}),!Q?.created&&e.jsx("button",{className:"btn btn-primary",onClick:q,disabled:N||h==="file"&&!p||h==="github"&&!j.trim(),children:N?"Importowanie...":"Importuj mapowania"})]})]})})]})}function h8({frameworks:t,onRefresh:n}){const[a,s]=m.useState(0),[o,c]=m.useState(0),[u,h]=m.useState(3),[f,p]=m.useState(.45),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(new Set),[_,E]=m.useState(!1),[z,N]=m.useState(null),O=async()=>{if(!(!a||!o)){j(!0),S(null),b(new Set),N(null);try{const A=new URLSearchParams({source_framework_id:String(a),target_framework_id:String(o),top_k:String(u),min_score:String(f)}),R=await le.post(`/api/v1/framework-mappings/ai-suggest?${A}`,{});S(R);const G=new Set;R.suggestions.forEach((F,q)=>{F.score>=.6&&G.add(q)}),b(G)}catch(A){alert(A?.message||"Bd generowania sugestii AI")}j(!1)}},Q=A=>{b(R=>{const G=new Set(R);return G.has(A)?G.delete(A):G.add(A),G})},U=()=>{y&&(w.size===y.suggestions.length?b(new Set):b(new Set(y.suggestions.map((A,R)=>R))))},L=async()=>{if(!(!y||w.size===0)){E(!0),N(null);try{const A=[...w].map(F=>y.suggestions[F]).map(F=>({source_node_id:F.source_node_id,target_node_id:F.target_node_id,relationship_type:F.relationship_type,strength:F.strength,score:F.score,model_name:y.model_name})),R=new URLSearchParams({source_framework_id:String(y.source_framework_id),target_framework_id:String(y.target_framework_id),auto_revert:"true"}),G=await le.post(`/api/v1/framework-mappings/ai-suggest/accept?${R}`,A);N(G),n()}catch(A){alert(A?.message||"Bd akceptowania sugestii")}E(!1)}},H=A=>A>=.85?"#10b981":A>=.7?"#6366f1":A>=.55?"#f59e0b":"#94a3b8";return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"AI-Suggest Mapowania (SBERT)"}),e.jsxs("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:["Automatyczne sugestie mapowa",""," na podstawie podobie","","stwa semantycznego tekst","","w wymaga",""," (sentence-transformers)"]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Source Framework *",e.jsxs("select",{className:"form-control",value:a,onChange:A=>s(Number(A.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Target Framework *",e.jsxs("select",{className:"form-control",value:o,onChange:A=>c(Number(A.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Top-K (maks. wynik","","w na wymaganie)",e.jsx("select",{className:"form-control",value:u,onChange:A=>h(Number(A.target.value)),children:[1,2,3,5,10].map(A=>e.jsx("option",{value:A,children:A},A))})]}),e.jsxs("label",{style:{fontSize:13},children:["Min. score (pr","","g podobie","","stwa)",e.jsx("select",{className:"form-control",value:f,onChange:A=>p(Number(A.target.value)),children:[.3,.35,.4,.45,.5,.55,.6,.7].map(A=>e.jsxs("option",{value:A,children:[(A*100).toFixed(0),"%"]},A))})]})]}),e.jsxs("div",{style:{padding:10,borderRadius:6,background:"var(--bg-secondary)",fontSize:12,color:"var(--text-muted)",lineHeight:1.6,marginBottom:12},children:["Model: ",e.jsx("strong",{children:"all-MiniLM-L6-v2"}),"  szybki, wieloj","","zyczny model sentence-transformers. Oblicza cosine similarity mi","","dzy tekstami wymaga",""," i sugeruje mapowania powy","","ej progu. Wyniki s",""," w statusie ",e.jsx("em",{children:"draft"}),"  wymagaj",""," potwierdzenia."]}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:x||!a||!o||a===o,style:{width:"100%"},children:x?"Generowanie sugestii AI...":"Generuj sugestie SBERT"})]}),y&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:10,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--blue)"},children:y.total_suggestions}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Sugestii"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#10b981"},children:y.source_nodes_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Source nodes"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6366f1"},children:y.target_nodes_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Target nodes"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#f59e0b"},children:w.size}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zaznaczonych"})]})]}),!z&&y.suggestions.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:w.size===y.suggestions.length,onChange:U}),"Zaznacz wszystkie"]}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[w.size," z ",y.suggestions.length," zaznaczonych"]})]}),e.jsx("button",{className:"btn btn-primary",onClick:L,disabled:_||w.size===0,children:_?"Akceptowanie...":`Akceptuj ${w.size} sugestii`})]}),z&&e.jsxs("div",{style:{padding:12,borderRadius:8,marginBottom:12,fontSize:13,lineHeight:1.6,background:"#10b98118",border:"1px solid #10b98140"},children:[e.jsx("div",{style:{fontWeight:600,color:"#10b981",marginBottom:4},children:"Sugestie zaakceptowane"}),e.jsxs("div",{children:["Utworzono: ",e.jsx("strong",{children:z.created})," mapowa",""]}),z.revert_created>0&&e.jsxs("div",{children:["Odwrotne: ",e.jsx("strong",{children:z.revert_created})," mapowa",""]}),z.skipped>0&&e.jsxs("div",{children:["Pomini","","to (duplikaty): ",e.jsx("strong",{children:z.skipped})]})]}),y.suggestions.length>0?e.jsx("div",{className:"card",style:{overflow:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"8px 10px",width:36}}),e.jsx("th",{style:{padding:"8px 10px"},children:"Source"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Target"}),e.jsx("th",{style:{padding:"8px 10px",width:80},children:"Score"}),e.jsx("th",{style:{padding:"8px 10px",width:100},children:"Relacja"}),e.jsxs("th",{style:{padding:"8px 10px",width:60},children:["Si","","a"]})]})}),e.jsx("tbody",{children:y.suggestions.map((A,R)=>e.jsxs("tr",{onClick:()=>Q(R),style:{borderBottom:"1px solid var(--border)",cursor:"pointer",background:w.has(R)?"var(--bg-secondary)":"transparent",opacity:z?.6:1},children:[e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("input",{type:"checkbox",checked:w.has(R),readOnly:!0})}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:A.source_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A.source_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:A.target_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A.target_name})]}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:40,height:6,borderRadius:3,background:"var(--border)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${A.score*100}%`,height:"100%",borderRadius:3,background:H(A.score)}})}),e.jsxs("span",{style:{fontSize:11,fontWeight:600,color:H(A.score)},children:[(A.score*100).toFixed(1),"%"]})]})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Xo,{rel:A.relationship_type})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Qo,{strength:A.strength})})]},R))})]})}):e.jsxs("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:["Brak sugestii powy","","ej progu podobie","","stwa. Spr","","buj obni","","y",""," pr","","g min. score."]})]})]})}function m8({frameworks:t}){const[n,a]=m.useState(0),[s,o]=m.useState(0),[c,u]=m.useState(null),[h,f]=m.useState(!1),{aiEnabled:p}=Mp(),[x,j]=m.useState(null),[y,S]=m.useState(!1),w=async()=>{if(!(!n||!s)){f(!0),j(null);try{const _=await le.get(`/api/v1/framework-mappings/coverage?source_framework_id=${n}&target_framework_id=${s}`);u(_)}catch{u(null)}f(!1)}},b=async()=>{if(!(!n||!s)){S(!0);try{const _=await le.post("/api/v1/ai/coverage-report",{source_framework_id:n,target_framework_id:s});j(_)}catch{}S(!1)}};return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Analiza Pokrycia"}),e.jsx("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:"Sprawd, jakie wymagania s pokryte mapowaniami midzy frameworkami"}),e.jsx("div",{className:"card",style:{padding:16,marginBottom:16},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{margin:0},children:["Source Framework",e.jsxs("select",{className:"form-control",value:n,onChange:_=>a(Number(_.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]})]}),e.jsxs("label",{style:{margin:0},children:["Target Framework",e.jsxs("select",{className:"form-control",value:s,onChange:_=>o(Number(_.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]})]}),e.jsx("button",{className:"btn btn-primary",onClick:w,disabled:!n||!s||h,children:h?"Analizuj...":"Analizuj pokrycie"}),p&&c&&e.jsx("button",{className:"btn btn-sm",onClick:b,disabled:y,style:{background:"var(--blue-dim)",color:"var(--blue)",border:"1px solid var(--blue)",fontSize:11},children:y?"Generuj raport...":"Raport AI"})]})}),c&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 16px",fontSize:14},children:"Pokrycie wymaga"}),e.jsx("div",{style:{textAlign:"center",marginBottom:16},children:e.jsx("div",{style:{width:100,height:100,borderRadius:"50%",margin:"0 auto 8px",background:`conic-gradient(#10b981 ${c.coverage_percent*3.6}deg, var(--border) 0deg)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{width:76,height:76,borderRadius:"50%",background:"var(--bg-primary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,fontWeight:700,color:c.coverage_percent>=80?"#10b981":c.coverage_percent>=50?"#f59e0b":"#ef4444"},children:[c.coverage_percent,"%"]})})}),e.jsx(u1,{percent:c.coverage_percent,label:"Cakowite pokrycie",color:"#10b981"}),e.jsx(u1,{percent:c.confirmed_coverage_percent,label:"Potwierdzone pokrycie",color:"#6366f1"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8,marginTop:12},children:[e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"var(--blue)"},children:c.total_requirements}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Wymaga"})]}),e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#10b981"},children:c.covered}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Pokryte"})]}),e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#ef4444"},children:c.uncovered}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Brak"})]})]})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 16px",fontSize:14},children:"Rozkad relacji"}),e.jsx(c8,{data:c.by_relationship}),e.jsx("h4",{style:{margin:"16px 0 12px",fontSize:14},children:"Sia powiza"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Object.entries(c.by_strength).map(([_,E])=>{const z=Number(_),N=Object.values(c.by_strength).reduce((Q,U)=>Q+U,0),O=N>0?E/N*100:0;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,marginBottom:2},children:[e.jsx("span",{style:{color:dc[z],fontWeight:500},children:cc[z]||`Poziom ${_}`}),e.jsx("span",{style:{color:"var(--text-muted)"},children:E})]}),e.jsx("div",{style:{height:4,borderRadius:2,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:2,background:dc[z],width:`${O}%`}})})]},_)})})]}),c.uncovered_requirements.length>0&&e.jsxs("div",{className:"card",style:{padding:16,gridColumn:"1 / -1"},children:[e.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14},children:["Niepokryte wymagania (",c.uncovered_requirements.length,")"]}),e.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:e.jsxs("table",{style:{width:"100%",fontSize:12,borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Ref ID"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa"})]})}),e.jsx("tbody",{children:c.uncovered_requirements.map(_=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"6px 8px",fontFamily:"'JetBrains Mono', monospace",fontSize:11},children:_.ref_id||""}),e.jsx("td",{style:{padding:"6px 8px"},children:_.name||""})]},_.id))})]})})]}),x&&e.jsxs("div",{className:"card",style:{padding:16,gridColumn:"1 / -1",borderLeft:`3px solid ${x.risk_level==="critical"?"var(--red)":x.risk_level==="high"?"var(--orange)":x.risk_level==="medium"?"#f59e0b":"var(--green)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h4",{style:{margin:0,fontSize:14},children:"Raport AI"}),e.jsxs("span",{className:"score-badge",style:{background:x.risk_level==="critical"?"var(--red-dim)":x.risk_level==="high"?"var(--orange-dim)":x.risk_level==="medium"?"#fef3c7":"var(--green-dim)",color:x.risk_level==="critical"?"var(--red)":x.risk_level==="high"?"var(--orange)":x.risk_level==="medium"?"#92400e":"var(--green)",fontSize:10},children:["Ryzyko: ",x.risk_level]})]}),e.jsx("div",{style:{fontSize:12,lineHeight:1.6,marginBottom:12},children:x.executive_summary}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[x.strengths.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--green)",marginBottom:4},children:"Mocne strony"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,fontSize:11},children:x.strengths.map((_,E)=>e.jsx("li",{children:_},E))})]}),x.gaps.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--red)",marginBottom:4},children:"Luki"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,fontSize:11},children:x.gaps.map((_,E)=>e.jsx("li",{children:_},E))})]})]}),x.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--blue)",marginBottom:4},children:"Rekomendacje"}),e.jsx("div",{style:{display:"grid",gap:6},children:x.recommendations.map((_,E)=>e.jsxs("div",{style:{padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11,display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{className:"score-badge",style:{fontSize:8,padding:"1px 5px",background:_.priority==="high"?"var(--red-dim)":_.priority==="medium"?"var(--orange-dim)":"var(--bg-inset)",color:_.priority==="high"?"var(--red)":_.priority==="medium"?"var(--orange)":"var(--text-muted)"},children:_.priority}),e.jsx("span",{style:{flex:1},children:_.action}),e.jsxs("span",{className:"score-badge",style:{fontSize:8,padding:"1px 5px",background:"var(--bg-inset)",color:"var(--text-muted)"},children:["nakad: ",_.effort]})]},E))})]})]})]})]})}function p8({frameworks:t}){const[n,a]=m.useState(0),[s,o]=m.useState(0),[c,u]=m.useState(null),[h,f]=m.useState(!1),p=async()=>{if(!(!n||!s)){f(!0);try{const j=await le.get(`/api/v1/framework-mappings/matrix?source_framework_id=${n}&target_framework_id=${s}`);u(j)}catch{u(null)}f(!1)}},x=m.useMemo(()=>{if(!c?.mappings?.length)return null;const j=[...new Set(c.mappings.map(w=>w.source_ref_id))].sort(),y=[...new Set(c.mappings.map(w=>w.target_ref_id))].sort(),S=new Map;for(const w of c.mappings)S.set(`${w.source_ref_id}|${w.target_ref_id}`,w);return{srcRefs:j,tgtRefs:y,lookup:S}},[c]);return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Matryca Mapowa"}),e.jsx("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:"Wizualizacja powiza midzy wymaganiami dwch frameworkw w formie heatmapy"}),e.jsx("div",{className:"card",style:{padding:16,marginBottom:16},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{margin:0},children:["Source Framework",e.jsxs("select",{className:"form-control",value:n,onChange:j=>a(Number(j.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsxs("label",{style:{margin:0},children:["Target Framework",e.jsxs("select",{className:"form-control",value:s,onChange:j=>o(Number(j.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsx("button",{className:"btn btn-primary",onClick:p,disabled:!n||!s||h,children:h?"aduj...":"Poka matryc"})]})}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--blue)"},children:c.total_mappings}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Mapowa"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:22,fontWeight:700,color:"#10b981"},children:[c.coverage_percent,"%"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pokrycie"})]}),e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Relacje"}),e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:Object.entries(c.by_relationship||{}).map(([j,y])=>e.jsxs("span",{className:"badge",style:{backgroundColor:`${Vi[j]||"#94a3b8"}18`,color:Vi[j]||"#94a3b8",fontSize:10},children:[Ou[j]||j,": ",y]},j))})]}),e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Sia"}),e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:Object.entries(c.by_strength||{}).map(([j,y])=>e.jsxs("span",{className:"badge",style:{backgroundColor:`${dc[Number(j)]||"#94a3b8"}18`,color:dc[Number(j)]||"#94a3b8",fontSize:10},children:[cc[Number(j)]||j,": ",y]},j))})]})]}),x&&e.jsxs("div",{className:"card",style:{padding:16,overflowX:"auto"},children:[e.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14},children:[c.source_framework_name,"  ",c.target_framework_name]}),e.jsx("div",{style:{display:"flex",gap:12,marginBottom:12,fontSize:11,flexWrap:"wrap"},children:Object.entries(oc).filter(([j])=>j!=="not_related").map(([j,y])=>e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:12,height:12,borderRadius:2,background:Vi[j]}}),e.jsx("span",{style:{color:"var(--text-muted)"},children:y})]},j))}),e.jsx("div",{style:{overflow:"auto",maxHeight:500},children:e.jsxs("table",{style:{borderCollapse:"collapse",fontSize:10},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:4,background:"var(--bg-secondary)",position:"sticky",left:0,zIndex:2}}),x.tgtRefs.map(j=>e.jsx("th",{style:{padding:"4px 2px",background:"var(--bg-secondary)",writingMode:"vertical-lr",transform:"rotate(180deg)",fontWeight:500,color:"var(--text-muted)",minWidth:22,whiteSpace:"nowrap"},children:j},j))]})}),e.jsx("tbody",{children:x.srcRefs.map(j=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"2px 6px",background:"var(--bg-secondary)",fontWeight:500,color:"var(--text-muted)",position:"sticky",left:0,zIndex:1,whiteSpace:"nowrap"},children:j}),x.tgtRefs.map(y=>{const S=x.lookup.get(`${j}|${y}`);return e.jsx("td",{style:{width:20,height:20,padding:0,textAlign:"center",background:S?`${Vi[S.relationship_type]}${S.strength===3?"cc":S.strength===2?"80":"40"}`:"transparent",border:"1px solid var(--border)",cursor:S?"pointer":"default"},title:S?`${j}  ${y}: ${oc[S.relationship_type]} (${cc[S.strength]})`:"",children:S&&e.jsx("span",{style:{fontSize:8,color:"var(--text-primary)"},children:S.strength})},y)})]},j))})]})})]})]})]})}function g8({frameworks:t,onRefresh:n}){const[a,s]=m.useState(0),[o,c]=m.useState(0),[u,h]=m.useState(0),[f,p]=m.useState(2),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(new Set),[_,E]=m.useState(!1),[z,N]=m.useState(null),O=async()=>{if(!(!a||!o||!u)){j(!0),S(null),b(new Set),N(null);try{const H=new URLSearchParams({framework_a_id:String(a),framework_b_id:String(o),framework_c_id:String(u),min_strength:String(f),auto_create:"false"}),A=await le.post(`/api/v1/framework-mappings/transitive?${H}`,{});S(A),b(new Set(A.suggestions.map((R,G)=>G)))}catch(H){alert(H?.message||"Bd analizy tranzytywnej")}j(!1)}},Q=async()=>{if(!(!a||!o||!u)){E(!0);try{const H=new URLSearchParams({framework_a_id:String(a),framework_b_id:String(o),framework_c_id:String(u),min_strength:String(f),auto_create:"true"}),A=await le.post(`/api/v1/framework-mappings/transitive?${H}`,{});N(A.created),n()}catch(H){alert(H?.message||"Bd tworzenia mapowa")}E(!1)}},U=H=>{b(A=>{const R=new Set(A);return R.has(H)?R.delete(H):R.add(H),R})},L=()=>{y&&(w.size===y.suggestions.length?b(new Set):b(new Set(y.suggestions.map((H,A)=>A))))};return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Mapowania Tranzytywne"}),e.jsxs("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:["Je","","li A","","B i B","","C istniej","",", wnioskuj A","","C przez framework po","","redni"]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Framework A (","rdowy",") *",e.jsxs("select",{className:"form-control",value:a,onChange:H=>s(Number(H.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(H=>e.jsx("option",{value:H.id,children:H.name},H.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Framework B (po","","redni) *",e.jsxs("select",{className:"form-control",value:o,onChange:H=>c(Number(H.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(H=>e.jsx("option",{value:H.id,children:H.name},H.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Framework C (docelowy) *",e.jsxs("select",{className:"form-control",value:u,onChange:H=>h(Number(H.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(H=>e.jsx("option",{value:H.id,children:H.name},H.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{fontSize:13,margin:0},children:["Min. si","","a powi","","zania",e.jsxs("select",{className:"form-control",value:f,onChange:H=>p(Number(H.target.value)),children:[e.jsxs("option",{value:1,children:["1 ",""," S","","abe"]}),e.jsxs("option",{value:2,children:["2 ",""," Umiarkowane"]}),e.jsxs("option",{value:3,children:["3 ",""," Silne"]})]})]}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:x||!a||!o||!u||a===o||o===u||a===u,children:x?"Analizuj...":"Analizuj tranzytywno"})]}),e.jsxs("div",{style:{padding:10,borderRadius:6,background:"var(--bg-secondary)",fontSize:12,color:"var(--text-muted)",lineHeight:1.6,marginTop:12},children:["Algorytm: dla ka","","dego mapowania A","","B i B","","C oblicza potencjalne A","","C. Si","","a = min(si","","a AB, si","","a BC). Relacja = s","","absza z dw","","ch. Pomija istniej","","ce mapowania A","",'C oraz relacje "not_related".']})]}),y&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:10,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--blue)"},children:y.ab_mappings_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["A","","B"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6366f1"},children:y.bc_mappings_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["B","","C"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#94a3b8"},children:y.existing_ac_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Istniej","","ce A","","C"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#10b981"},children:y.transitive_suggestions}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Nowe sugestie"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#f59e0b"},children:w.size}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Zaznaczonych"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,padding:"12px 16px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:16,fontSize:13},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--blue)"},children:y.framework_a}),e.jsx("span",{style:{color:"var(--text-muted)"},children:""}),e.jsx("span",{style:{fontWeight:600,color:"#6366f1",padding:"2px 8px",borderRadius:4,background:"#6366f118",border:"1px solid #6366f140"},children:y.framework_b}),e.jsx("span",{style:{color:"var(--text-muted)"},children:""}),e.jsx("span",{style:{fontWeight:600,color:"#10b981"},children:y.framework_c})]}),z!==null?e.jsx("div",{style:{padding:12,borderRadius:8,marginBottom:12,fontSize:13,lineHeight:1.6,background:"#10b98118",border:"1px solid #10b98140"},children:e.jsxs("div",{style:{fontWeight:600,color:"#10b981"},children:["Utworzono ",e.jsx("strong",{children:z})," tranzytywnych mapowa",""]})}):y.suggestions.length>0?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:w.size===y.suggestions.length,onChange:L}),"Zaznacz wszystkie"]}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[w.size," z ",y.suggestions.length]})]}),e.jsx("button",{className:"btn btn-primary",onClick:Q,disabled:_||w.size===0,children:_?"Tworzenie...":`Utwrz ${w.size} mapowa`})]}):null,y.suggestions.length>0?e.jsx("div",{className:"card",style:{overflow:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"8px 10px",width:36}}),e.jsx("th",{style:{padding:"8px 10px"},children:"Source (A)"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Via (B)"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Target (C)"}),e.jsx("th",{style:{padding:"8px 10px",width:100},children:"Relacja"}),e.jsxs("th",{style:{padding:"8px 10px",width:60},children:["Si","","a"]}),e.jsxs("th",{style:{padding:"8px 10px",width:160},children:["","a","","cuch"]})]})}),e.jsx("tbody",{children:y.suggestions.map((H,A)=>e.jsxs("tr",{onClick:()=>U(A),style:{borderBottom:"1px solid var(--border)",cursor:"pointer",background:w.has(A)?"var(--bg-secondary)":"transparent",opacity:z!==null?.6:1},children:[e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("input",{type:"checkbox",checked:w.has(A),readOnly:!0})}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:H.source_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:H.source_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"#6366f1"},children:H.via_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--text-muted)"},children:H.via_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:H.target_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:H.target_name})]}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Xo,{rel:H.relationship_type})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Qo,{strength:H.strength})}),e.jsx("td",{style:{padding:"6px 10px",fontSize:10,color:"var(--text-muted)",fontFamily:"'JetBrains Mono', monospace"},children:H.chain})]},A))})]})}):e.jsxs("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:["Brak nowych tranzytywnych mapowa",""," do zasugerowania. Wszystkie mo","","liwe A","","C ju",""," istniej",""," lub si","","a jest poni","","ej progu."]})]})]})}function x8(){const[t,n]=m.useState("mappings"),a=[{key:"source_framework_name",header:"Source Framework"},{key:"source_requirement_ref",header:"Source Ref",format:ie=>ie.source_requirement_ref??""},{key:"source_requirement_name",header:"Source Wymag.",format:ie=>ie.source_requirement_name??""},{key:"target_framework_name",header:"Target Framework"},{key:"target_requirement_ref",header:"Target Ref",format:ie=>ie.target_requirement_ref??""},{key:"target_requirement_name",header:"Target Wymag.",format:ie=>ie.target_requirement_name??"",defaultVisible:!1},{key:"relationship_type",header:"Relacja",format:ie=>Ou[ie.relationship_type]||ie.relationship_type},{key:"strength",header:"Sia",format:ie=>cc[ie.strength]||String(ie.strength)},{key:"mapping_status",header:"Status",format:ie=>Ab[ie.mapping_status]||ie.mapping_status},{key:"mapping_source",header:"rdo",format:ie=>iu[ie.mapping_source]||ie.mapping_source,defaultVisible:!1},{key:"rationale_type",header:"Uzasadnienie",format:ie=>ie.rationale_type?$m[ie.rationale_type]||ie.rationale_type:"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:ie=>ie.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:s,toggle:o}=da(a,"framework-mappings-v2"),[c,u]=m.useState([]),[h,f]=m.useState([]),[p,x]=m.useState([]),[j,y]=m.useState(null),[S,w]=m.useState(!0),[b,_]=m.useState(null),[E,z]=m.useState(null),[N,O]=m.useState(!1),[Q,U]=m.useState(!1),[L,H]=m.useState({source_framework_id:0,source_requirement_id:0,target_framework_id:0,target_requirement_id:0,relationship_type:"intersect",strength:2,rationale_type:"",rationale:"",mapping_source:"manual"}),[A,R]=m.useState([]),[G,F]=m.useState([]),q=Aa({data:c,storageKey:"framework-mappings-v2",defaultSort:"source_framework_name",defaultSortDir:"asc"}),ee=()=>{w(!0),_(null),le.get("/api/v1/frameworks").then(ie=>{const ve=ie.filter(je=>je.is_active!==!1);x(ve)}).catch(ie=>{console.error("[Mappings] load frameworks failed:",ie),_(String(ie))}),Promise.allSettled([le.get("/api/v1/framework-mappings/"),le.get("/api/v1/framework-mappings/sets"),le.get("/api/v1/framework-mappings/stats")]).then(([ie,ve,je])=>{ie.status==="fulfilled"&&u(ie.value),ve.status==="fulfilled"&&f(ve.value),je.status==="fulfilled"&&y(je.value)}).finally(()=>w(!1))};m.useEffect(ee,[]);const me=async(ie,ve)=>{if(ie)try{const fe=(await le.get(`/api/v1/frameworks/${ie}/nodes`)).map(_e=>({id:_e.id,ref_id:_e.ref_id,name:_e.name_pl||_e.name}));ve==="source"?R(fe):F(fe)}catch{}},W=async()=>{if(!(!L.source_requirement_id||!L.target_requirement_id))try{await le.post("/api/v1/framework-mappings/",{source_framework_id:L.source_framework_id,source_requirement_id:L.source_requirement_id,target_framework_id:L.target_framework_id,target_requirement_id:L.target_requirement_id,relationship_type:L.relationship_type,strength:L.strength,rationale_type:L.rationale_type||void 0,rationale:L.rationale||void 0,mapping_source:L.mapping_source}),U(!1),ee()}catch{alert("Bd tworzenia mapowania")}},J=async ie=>{try{await le.post(`/api/v1/framework-mappings/${ie}/confirm`,{confirmed_by:"admin"}),ee()}catch{alert("Bd potwierdzania")}},M=async ie=>{if(confirm("Czy na pewno chcesz usun to mapowanie?"))try{await le.delete(`/api/v1/framework-mappings/${ie}`),z(null),ee()}catch{alert("Bd usuwania")}},V=q.filtered,ne=V.filter(ie=>ie.relationship_type==="equal").length,P=V.filter(ie=>ie.relationship_type==="intersect").length,T=V.filter(ie=>ie.mapping_status==="confirmed").length,C=c.filter(ie=>ie.relationship_type==="equal").length,k=c.filter(ie=>ie.relationship_type==="intersect").length,I=c.filter(ie=>ie.mapping_status==="confirmed").length,D=q.filteredCount!==q.totalCount,de=[{label:"Mapowania ogem",value:V.length,total:c.length,color:"var(--blue)"},{label:"Equal (=)",value:ne,total:C,color:"#10b981"},{label:"Intersect ()",value:P,total:k,color:"#f59e0b"},{label:"Potwierdzone",value:T,total:I,color:"#6366f1"}],he=E;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0},children:"Mapowania Frameworkw"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"var(--text-muted)"},children:"Mapowanie teoriomnogociowe wymaga (model CISO Assistant)"})]}),j&&e.jsxs("div",{style:{display:"flex",gap:12,fontSize:12,color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Zestawy: ",e.jsx("strong",{children:j.mapping_sets})]}),e.jsxs("span",{children:["Pary fw: ",e.jsx("strong",{children:j.framework_pairs})]})]})]}),e.jsx(d8,{active:t,onChange:n}),t==="mappings"&&e.jsxs(e.Fragment,{children:[e.jsx(Ia,{cards:de,isFiltered:D}),e.jsx(ma,{filteredCount:q.filteredCount,totalCount:q.totalCount,unitLabel:"mapowa",search:q.search,onSearchChange:q.setSearch,searchPlaceholder:"Szukaj mapowa...",showFilters:N,onToggleFilters:()=>O(ie=>!ie),hasActiveFilters:q.hasActiveFilters,onClearFilters:q.clearAllFilters,columns:a,visibleColumns:s,onToggleColumn:o,data:q.filtered,exportFilename:"framework_mappings",primaryLabel:"Nowe mapowanie",onPrimaryAction:()=>U(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:E?"1fr 440px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:a,visibleColumns:s,data:q.pageData,rowKey:ie=>ie.id,selectedKey:E?.id??null,onRowClick:ie=>z(ve=>ve?.id===ie.id?null:ie),rowBorderColor:ie=>Vi[ie.relationship_type]||void 0,renderCell:(ie,ve)=>{if(ve==="source_requirement_ref"||ve==="target_requirement_ref"){const je=ve==="source_requirement_ref"?ie.source_requirement_ref:ie.target_requirement_ref;return je?e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:je}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}if(ve==="relationship_type")return e.jsx(Xo,{rel:ie.relationship_type});if(ve==="strength")return e.jsx(Qo,{strength:ie.strength});if(ve==="mapping_status")return e.jsx(sp,{status:ie.mapping_status});if(ve==="mapping_source")return e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:iu[ie.mapping_source]||ie.mapping_source})},sortField:q.sortField,sortDir:q.sortDir,onSort:q.toggleSort,columnFilters:q.columnFilters,onColumnFilter:q.setColumnFilter,showFilters:N,page:q.page,totalPages:q.totalPages,pageSize:q.pageSize,totalItems:q.totalCount,filteredItems:q.filteredCount,onPageChange:q.setPage,onPageSizeChange:q.setPageSize,loading:S,emptyMessage:"Brak mapowa. Utwrz korelacj midzy wymaganiami frameworkw."}),he&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:700,fontSize:15,marginBottom:6},children:["Mapowanie #",he.id]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx(Xo,{rel:he.relationship_type}),e.jsx(sp,{status:he.mapping_status})]})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>z(null),title:"Zamknij",children:""})]}),e.jsxs("div",{style:{textAlign:"center",margin:"12px 0 16px"},children:[e.jsx(Qo,{strength:he.strength}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Sia powizania: ",he.strength,"/3"]})]}),e.jsx(su,{number:"1",label:"Source (rdo)"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Framework",value:he.source_framework_name}),e.jsx(Wn,{label:"Ref ID",value:he.source_requirement_ref}),e.jsx(Wn,{label:"Wymaganie",value:he.source_requirement_name})]}),e.jsx(su,{number:"2",label:"Target (cel)"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Framework",value:he.target_framework_name}),e.jsx(Wn,{label:"Ref ID",value:he.target_requirement_ref}),e.jsx(Wn,{label:"Wymaganie",value:he.target_requirement_name})]}),e.jsx(su,{number:"3",label:"Metadane"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Relacja",value:e.jsx(Xo,{rel:he.relationship_type})}),e.jsx(Wn,{label:"Sia",value:e.jsx(Qo,{strength:he.strength})}),e.jsx(Wn,{label:"Uzasadnienie",value:he.rationale_type?$m[he.rationale_type]||he.rationale_type:null}),e.jsx(Wn,{label:"rdo",value:iu[he.mapping_source]||he.mapping_source}),he.ai_score!=null&&e.jsx(Wn,{label:"AI Score",value:`${(he.ai_score*100).toFixed(1)}%`,color:"#6366f1"}),he.confirmed_by&&e.jsx(Wn,{label:"Potwierdzi",value:he.confirmed_by}),he.confirmed_at&&e.jsx(Wn,{label:"Data potwierdzenia",value:he.confirmed_at.slice(0,10)})]}),he.rationale&&e.jsxs(e.Fragment,{children:[e.jsx(su,{number:"4",label:"Uzasadnienie"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:he.rationale})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[he.mapping_status==="draft"&&e.jsx("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>J(he.id),children:"Potwierd"}),e.jsx("button",{className:"btn",style:{color:"#ef4444"},onClick:()=>M(he.id),children:"Usu"})]})]})]})]}),t==="sets"&&e.jsx(f8,{sets:h,frameworks:p,onRefresh:ee}),t==="ai_suggest"&&e.jsx(h8,{frameworks:p,onRefresh:ee}),t==="coverage"&&e.jsx(m8,{frameworks:p}),t==="matrix"&&e.jsx(p8,{frameworks:p}),t==="transitive"&&e.jsx(g8,{frameworks:p,onRefresh:ee}),e.jsx(gt,{open:Q,title:"Nowe mapowanie frameworkw",onClose:()=>U(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Typy relacji (CISO Assistant):"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4},children:Object.entries(oc).map(([ie,ve])=>e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:2,background:Vi[ie]}}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[ve,"  ",Ou[ie]]})]},ie))})]}),e.jsxs("label",{children:["Source Framework *",e.jsxs("select",{className:"form-control",value:L.source_framework_id,onChange:ie=>{const ve=Number(ie.target.value);H({...L,source_framework_id:ve,source_requirement_id:0}),me(ve,"source")},children:[e.jsx("option",{value:0,children:" wybierz "}),p.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("label",{children:["Source wymaganie *",e.jsxs("select",{className:"form-control",value:L.source_requirement_id,onChange:ie=>H({...L,source_requirement_id:Number(ie.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),A.map(ie=>e.jsxs("option",{value:ie.id,children:[ie.ref_id?`${ie.ref_id}  `:"",ie.name]},ie.id))]})]}),e.jsxs("label",{children:["Target Framework *",e.jsxs("select",{className:"form-control",value:L.target_framework_id,onChange:ie=>{const ve=Number(ie.target.value);H({...L,target_framework_id:ve,target_requirement_id:0}),me(ve,"target")},children:[e.jsx("option",{value:0,children:" wybierz "}),p.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("label",{children:["Target wymaganie *",e.jsxs("select",{className:"form-control",value:L.target_requirement_id,onChange:ie=>H({...L,target_requirement_id:Number(ie.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),G.map(ie=>e.jsxs("option",{value:ie.id,children:[ie.ref_id?`${ie.ref_id}  `:"",ie.name]},ie.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Relacja *",e.jsx("select",{className:"form-control",value:L.relationship_type,onChange:ie=>H({...L,relationship_type:ie.target.value}),children:Object.entries(oc).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))})]}),e.jsxs("label",{children:["Sia (1-3) *",e.jsxs("select",{className:"form-control",value:L.strength,onChange:ie=>H({...L,strength:Number(ie.target.value)}),children:[e.jsx("option",{value:1,children:"1  Sabe"}),e.jsx("option",{value:2,children:"2  Umiarkowane"}),e.jsx("option",{value:3,children:"3  Silne"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Uzasadnienie (typ)",e.jsxs("select",{className:"form-control",value:L.rationale_type,onChange:ie=>H({...L,rationale_type:ie.target.value}),children:[e.jsx("option",{value:"",children:" brak "}),Object.entries($m).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))]})]}),e.jsxs("label",{children:["rdo",e.jsx("select",{className:"form-control",value:L.mapping_source,onChange:ie=>H({...L,mapping_source:ie.target.value}),children:Object.entries(iu).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))})]})]}),e.jsxs("label",{children:["Uzasadnienie (opis) ",e.jsx("textarea",{className:"form-control",value:L.rationale,onChange:ie=>H({...L,rationale:ie.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>U(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:!L.source_requirement_id||!L.target_requirement_id,children:"Utwrz"})]})]})})]})}const Po={inquiry:"Wywiad",observation:"Obserwacja",inspection:"Inspekcja",reperformance:"Re-wykonanie",analytical:"Analityczny",walkthrough:"Przegld procesu"},lu={inquiry:"var(--blue)",observation:"var(--purple)",inspection:"var(--green)",reperformance:"var(--orange)",analytical:"var(--cyan)",walkthrough:"var(--yellow)"};function ou({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function Hm({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function y8(){const t=[{key:"name",header:"Nazwa"},{key:"test_type",header:"Typ testu",format:R=>Po[R.test_type]||R.test_type},{key:"framework_name",header:"Framework",format:R=>R.framework_name??""},{key:"description",header:"Opis",format:R=>R.description??"",defaultVisible:!1},{key:"expected_evidence",header:"Oczekiwany dowd",format:R=>R.expected_evidence??"",defaultVisible:!1},{key:"is_active",header:"Aktywny",format:R=>R.is_active?"Tak":"Nie",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:R=>R.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"test-templates"),[s,o]=m.useState([]),[c,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b,_]=m.useState({name:"",test_type:"inquiry",description:"",procedure:"",expected_evidence:"",framework_id:null}),E=Aa({data:s,storageKey:"test-templates",defaultSort:"name",defaultSortDir:"asc"}),z=()=>{f(!0),Promise.all([le.get("/api/v1/test-templates/"),le.get("/api/v1/frameworks/")]).then(([R,G])=>{o(R),u(G.filter(F=>F.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(z,[]);const N=async()=>{if(b.name.trim())try{await le.post("/api/v1/test-templates/",{name:b.name,test_type:b.test_type,description:b.description||null,procedure:b.procedure||null,expected_evidence:b.expected_evidence||null,framework_id:b.framework_id}),y(!1),_({name:"",test_type:"inquiry",description:"",procedure:"",expected_evidence:"",framework_id:null}),z()}catch{alert("Bd tworzenia szablonu")}},O=E.filtered,Q=R=>O.filter(G=>G.test_type===R).length,U=R=>s.filter(G=>G.test_type===R).length,L=E.filteredCount!==E.totalCount,H=[{label:"Szablony ogem",value:O.length,total:s.length,color:"var(--blue)"},{label:"Inspekcja",value:Q("inspection"),total:U("inspection"),color:"var(--green)"},{label:"Wywiad",value:Q("inquiry"),total:U("inquiry"),color:"var(--purple)"},{label:"Inne typy",value:O.length-Q("inspection")-Q("inquiry"),total:s.length-U("inspection")-U("inquiry"),color:"var(--orange)"}],A=p;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Szablony Testw Audytowych"}),e.jsx(Ia,{cards:H,isFiltered:L}),e.jsx(ma,{filteredCount:E.filteredCount,totalCount:E.totalCount,unitLabel:"szablonw",search:E.search,onSearchChange:E.setSearch,searchPlaceholder:"Szukaj szablonw...",showFilters:S,onToggleFilters:()=>w(R=>!R),hasActiveFilters:E.hasActiveFilters,onClearFilters:E.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:E.filtered,exportFilename:"test_templates",primaryLabel:"Nowy szablon",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:E.pageData,rowKey:R=>R.id,selectedKey:p?.id??null,onRowClick:R=>x(G=>G?.id===R.id?null:R),renderCell:(R,G)=>{if(G==="name")return e.jsx("span",{style:{fontWeight:600},children:R.name});if(G==="test_type"){const F=lu[R.test_type]||"var(--blue)";return e.jsx("span",{className:"badge",style:{backgroundColor:`${F}20`,color:F},children:Po[R.test_type]||R.test_type})}},sortField:E.sortField,sortDir:E.sortDir,onSort:E.toggleSort,columnFilters:E.columnFilters,onColumnFilter:E.setColumnFilter,showFilters:S,page:E.page,totalPages:E.totalPages,pageSize:E.pageSize,totalItems:E.totalCount,filteredItems:E.filteredCount,onPageChange:E.setPage,onPageSizeChange:E.setPageSize,loading:h,emptyMessage:"Brak szablonw testw. Utwrz katalog testw audytowych."}),A&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:A.name}),e.jsx("span",{className:"badge",style:{backgroundColor:`${lu[A.test_type]||"var(--blue)"}20`,color:lu[A.test_type]||"var(--blue)"},children:Po[A.test_type]||A.test_type})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]}),e.jsx(ou,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Hm,{label:"Typ testu",value:Po[A.test_type]||A.test_type,color:lu[A.test_type]}),e.jsx(Hm,{label:"Framework",value:A.framework_name}),e.jsx(Hm,{label:"Aktywny",value:A.is_active?"Tak":"Nie",color:A.is_active?"var(--green)":"var(--red)"})]}),A.description&&e.jsxs(e.Fragment,{children:[e.jsx(ou,{number:"2",label:"Opis"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.description})]}),A.procedure&&e.jsxs(e.Fragment,{children:[e.jsx(ou,{number:"3",label:"Procedura testowa"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12,whiteSpace:"pre-wrap"},children:A.procedure})]}),A.expected_evidence&&e.jsxs(e.Fragment,{children:[e.jsx(ou,{number:"4",label:"Oczekiwany dowd"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:A.expected_evidence})]})]})]}),e.jsx(gt,{open:j,title:"Nowy szablon testu",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:b.name,onChange:R=>_({...b,name:R.target.value}),placeholder:"np. Test kontroli dostpu"})]}),e.jsxs("label",{children:["Typ testu",e.jsx("select",{className:"form-control",value:b.test_type,onChange:R=>_({...b,test_type:R.target.value}),children:Object.entries(Po).map(([R,G])=>e.jsx("option",{value:R,children:G},R))})]}),e.jsxs("label",{children:["Framework",e.jsxs("select",{className:"form-control",value:b.framework_id??"",onChange:R=>_({...b,framework_id:R.target.value?Number(R.target.value):null}),children:[e.jsx("option",{value:"",children:" brak "}),c.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))]})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:b.description,onChange:R=>_({...b,description:R.target.value}),rows:2})]}),e.jsxs("label",{children:["Procedura testowa ",e.jsx("textarea",{className:"form-control",value:b.procedure,onChange:R=>_({...b,procedure:R.target.value}),rows:3})]}),e.jsxs("label",{children:["Oczekiwany dowd ",e.jsx("textarea",{className:"form-control",value:b.expected_evidence,onChange:R=>_({...b,expected_evidence:R.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:N,disabled:!b.name.trim(),children:"Utwrz"})]})]})})]})}const cu={critical:"var(--red)",high:"var(--orange)",medium:"var(--yellow)",low:"var(--green)",informational:"#94a3b8"},Vm={critical:"Krytyczne",high:"Wysokie",medium:"rednie",low:"Niskie",informational:"Informacyjne"},Zm={draft:"#94a3b8",open:"var(--red)",in_progress:"var(--blue)",resolved:"var(--green)",closed:"#6b7280",accepted:"var(--purple)"},Gm={draft:"Szkic",open:"Otwarte",in_progress:"W realizacji",resolved:"Rozwizane",closed:"Zamknite",accepted:"Zaakceptowane"};function ys({number:t,label:n}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:n})]})}function Wo({label:t,value:n,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:n??""})]})}function v8(){const t=[{key:"ref_id",header:"Ref",format:F=>F.ref_id},{key:"title",header:"Tytu"},{key:"audit_engagement_id",header:"Zadanie ID",format:F=>String(F.audit_engagement_id)},{key:"severity",header:"Istotno",format:F=>Vm[F.severity]||F.severity},{key:"status",header:"Status",format:F=>Gm[F.status]||F.status},{key:"target_date",header:"Termin",format:F=>F.target_date??""},{key:"actual_close_date",header:"Zamknito",format:F=>F.actual_close_date??"",defaultVisible:!1},{key:"management_response_by",header:"Odp. kierownictwo",format:F=>F.management_response_by??"",defaultVisible:!1},{key:"verified_by",header:"Zweryfikowa",format:F=>F.verified_by??"",defaultVisible:!1},{key:"condition_text",header:"Stan (Condition)",format:F=>F.condition_text??"",defaultVisible:!1},{key:"criteria_text",header:"Kryterium",format:F=>F.criteria_text??"",defaultVisible:!1},{key:"cause_text",header:"Przyczyna",format:F=>F.cause_text??"",defaultVisible:!1},{key:"effect_text",header:"Skutek",format:F=>F.effect_text??"",defaultVisible:!1},{key:"created_by",header:"Autor",format:F=>F.created_by??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:F=>F.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:n,toggle:a}=da(t,"audit-findings"),[s,o]=m.useState([]),[c,u]=m.useState(!0),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j]=hc(),y=j.get("engagement_id"),S=on(),w=Aa({data:s,storageKey:"audit-findings",defaultSort:"created_at",defaultSortDir:"desc"}),b=()=>{u(!0);const F=y?`/api/v1/audit-engagements/${y}/findings`:"/api/v1/audit-findings/";le.get(F).then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(b,[y]);const _=w.filtered,E=_.filter(F=>["open","in_progress"].includes(F.status)).length,z=_.filter(F=>F.severity==="critical"||F.severity==="high").length,N=_.filter(F=>!F.target_date||["resolved","closed"].includes(F.status)?!1:new Date(F.target_date)<new Date).length;_.filter(F=>["resolved","closed"].includes(F.status)).length;const O=s.filter(F=>["open","in_progress"].includes(F.status)).length,Q=s.filter(F=>F.severity==="critical"||F.severity==="high").length,U=s.filter(F=>!F.target_date||["resolved","closed"].includes(F.status)?!1:new Date(F.target_date)<new Date).length;s.filter(F=>["resolved","closed"].includes(F.status)).length;const L=w.filteredCount!==w.totalCount,H=[{label:"Ustalenia ogem",value:_.length,total:s.length,color:"var(--blue)"},{label:"Otwarte",value:E,total:O,color:"var(--orange)"},{label:"Krytyczne/Wysokie",value:z,total:Q,color:"var(--red)"},{label:"Przeterminowane",value:N,total:U,color:N>0?"var(--red)":"var(--green)"}],A=h,R=new Date,G=A?.target_date&&!["resolved","closed"].includes(A.status)&&new Date(A.target_date)<R;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Ustalenia Audytowe (Findings)"}),y&&e.jsxs("div",{style:{background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:"var(--radius-sm)",padding:"8px 14px",marginBottom:12,fontSize:12,color:"var(--blue)",display:"flex",alignItems:"center",gap:8},children:["Filtr zadania: ID ",y,e.jsx("button",{className:"btn btn-xs",onClick:()=>S("/audit-findings"),style:{marginLeft:"auto"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:H,isFiltered:L}),e.jsx(ma,{filteredCount:w.filteredCount,totalCount:w.totalCount,unitLabel:"ustale",search:w.search,onSearchChange:w.setSearch,searchPlaceholder:"Szukaj ustale...",showFilters:p,onToggleFilters:()=>x(F=>!F),hasActiveFilters:w.hasActiveFilters,onClearFilters:w.clearAllFilters,columns:t,visibleColumns:n,onToggleColumn:a,data:w.filtered,exportFilename:"audit_findings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:n,data:w.pageData,rowKey:F=>F.id,selectedKey:h?.id??null,onRowClick:F=>f(q=>q?.id===F.id?null:F),rowBorderColor:F=>cu[F.severity]||void 0,renderCell:(F,q)=>{if(q==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:F.ref_id});if(q==="title")return e.jsx("span",{style:{fontWeight:600},children:F.title});if(q==="severity"){const ee=cu[F.severity]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${ee}20`,color:ee},children:Vm[F.severity]||F.severity})}if(q==="status"){const ee=Zm[F.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${ee}20`,color:ee},children:Gm[F.status]||F.status})}if(q==="target_date"){if(!F.target_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const ee=!["resolved","closed"].includes(F.status)&&new Date(F.target_date)<R;return e.jsx("span",{style:{color:ee?"var(--red)":void 0,fontWeight:ee?600:void 0},children:F.target_date})}},sortField:w.sortField,sortDir:w.sortDir,onSort:w.toggleSort,columnFilters:w.columnFilters,onColumnFilter:w.setColumnFilter,showFilters:p,page:w.page,totalPages:w.totalPages,pageSize:w.pageSize,totalItems:w.totalCount,filteredItems:w.filteredCount,onPageChange:w.setPage,onPageSizeChange:w.setPageSize,loading:c,emptyMessage:"Brak ustale audytowych."}),A&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)",marginBottom:2},children:A.ref_id}),e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:A.title}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${cu[A.severity]||"#94a3b8"}20`,color:cu[A.severity]||"#94a3b8"},children:Vm[A.severity]||A.severity}),e.jsx("span",{className:"badge",style:{backgroundColor:`${Zm[A.status]||"#94a3b8"}20`,color:Zm[A.status]||"#94a3b8"},children:Gm[A.status]||A.status})]})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f(null),children:""})]}),e.jsx(ys,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wo,{label:"Zadanie ID",value:A.audit_engagement_id}),e.jsx(Wo,{label:"Autor",value:A.created_by}),e.jsx(Wo,{label:"Termin",value:A.target_date,color:G?"var(--red)":void 0}),e.jsx(Wo,{label:"Zamknito",value:A.actual_close_date,color:A.actual_close_date?"var(--green)":void 0}),e.jsx(Wo,{label:"Zweryfikowa",value:A.verified_by})]}),e.jsx(ys,{number:"2",label:"IIA  Stan (Condition)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.condition_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak opisu stanu"})}),e.jsx(ys,{number:"3",label:"IIA  Kryterium (Criteria)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.criteria_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak kryterium"})}),e.jsx(ys,{number:"4",label:"IIA  Przyczyna (Cause)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.cause_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak przyczyny"})}),e.jsx(ys,{number:"5",label:"IIA  Skutek (Effect)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.effect_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak skutku"})}),A.recommendation&&e.jsxs(e.Fragment,{children:[e.jsx(ys,{number:"6",label:"Rekomendacja"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.recommendation})]}),A.management_response&&e.jsxs(e.Fragment,{children:[e.jsx(ys,{number:"7",label:"Odpowied kierownictwa"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:A.management_response})]})]})]})]})}function j8(){return e.jsx(h2,{children:e.jsx(E2,{children:e.jsx(Uw,{children:e.jsxs(vt,{element:e.jsx(A2,{}),children:[e.jsx(vt,{index:!0,element:e.jsx(O2,{})}),e.jsx(vt,{path:"security-score",element:e.jsx(h3,{})}),e.jsx(vt,{path:"domains",element:e.jsx(gE,{})}),e.jsx(vt,{path:"assets",element:e.jsx(YA,{})}),e.jsx(vt,{path:"assets/legacy",element:e.jsx($A,{})}),e.jsx(vt,{path:"assets/graph",element:e.jsx(cl,{to:"/assets",replace:!0})}),e.jsx(vt,{path:"assets/admin",element:e.jsx(v3,{})}),e.jsx(vt,{path:"risks",element:e.jsx(FA,{})}),e.jsx(vt,{path:"reviews",element:e.jsx(PA,{})}),e.jsx(vt,{path:"frameworks",element:e.jsx(jE,{})}),e.jsx(vt,{path:"frameworks/:fwId",element:e.jsx(TE,{})}),e.jsx(vt,{path:"assessments",element:e.jsx(Bv,{})}),e.jsx(vt,{path:"assessments/new",element:e.jsx(Bv,{})}),e.jsx(vt,{path:"assessments/:assessmentId",element:e.jsx($E,{})}),e.jsx(vt,{path:"compliance",element:e.jsx(X3,{})}),e.jsx(vt,{path:"compliance/assessments",element:e.jsx(e8,{})}),e.jsx(vt,{path:"compliance/assessments/:assessmentId",element:e.jsx(n8,{})}),e.jsx(vt,{path:"framework-mappings",element:e.jsx(x8,{})}),e.jsx(vt,{path:"audit-programs",element:e.jsx(r8,{})}),e.jsx(vt,{path:"audit-engagements",element:e.jsx(i8,{})}),e.jsx(vt,{path:"audit-engagements/:engId",element:e.jsx(o8,{})}),e.jsx(vt,{path:"test-templates",element:e.jsx(y8,{})}),e.jsx(vt,{path:"audit-findings",element:e.jsx(v8,{})}),e.jsx(vt,{path:"cis",element:e.jsx(cl,{to:"/frameworks",replace:!0})}),e.jsx(vt,{path:"cis/assess",element:e.jsx(cl,{to:"/compliance/assessments",replace:!0})}),e.jsx(vt,{path:"vulnerabilities",element:e.jsx(KE,{})}),e.jsx(vt,{path:"incidents",element:e.jsx(JE,{})}),e.jsx(vt,{path:"policies",element:e.jsx(cl,{to:"/frameworks?origin=internal&type=polityka_wewnetrzna",replace:!0})}),e.jsx(vt,{path:"exceptions",element:e.jsx(XE,{})}),e.jsx(vt,{path:"audits",element:e.jsx(n3,{})}),e.jsx(vt,{path:"vendors",element:e.jsx(s3,{})}),e.jsx(vt,{path:"awareness",element:e.jsx(u3,{})}),e.jsx(vt,{path:"org-context",element:e.jsx(x3,{})}),e.jsx(vt,{path:"org-structure",element:e.jsx(cl,{to:"/org-context",replace:!0})}),e.jsx(vt,{path:"smart-catalog",element:e.jsx(B3,{})}),e.jsx(vt,{path:"control-effectiveness",element:e.jsx(G3,{})}),e.jsx(vt,{path:"ai-config",element:e.jsx(U3,{})}),e.jsx(vt,{path:"db-admin",element:e.jsx(H3,{})}),e.jsx(vt,{path:"catalogs",element:e.jsx(cl,{to:"/smart-catalog",replace:!0})}),e.jsx(vt,{path:"dictionaries",element:e.jsx(WA,{})}),e.jsx(vt,{path:"actions",element:e.jsx(rE,{})}),e.jsx(vt,{path:"reports",element:e.jsx(_3,{})}),e.jsx(vt,{path:"audit",element:e.jsx(hE,{})})]})})})})}US.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(z2,{children:e.jsx(j8,{})})}));
