(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const u of d.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(o){if(o.ep)return;o.ep=!0;const d=a(o);fetch(o.href,d)}})();var Kh={exports:{}},ko={};var cy;function NS(){if(cy)return ko;cy=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(s,o,d){var u=null;if(d!==void 0&&(u=""+d),o.key!==void 0&&(u=""+o.key),"key"in o){d={};for(var h in o)h!=="key"&&(d[h]=o[h])}else d=o;return o=d.ref,{$$typeof:t,type:s,key:u,ref:o!==void 0?o:null,props:d}}return ko.Fragment=r,ko.jsx=a,ko.jsxs=a,ko}var dy;function AS(){return dy||(dy=1,Kh.exports=NS()),Kh.exports}var e=AS(),qh={exports:{}},bt={};var uy;function ES(){if(uy)return bt;uy=1;var t=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),d=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),y=Symbol.iterator;function S(P){return P===null||typeof P!="object"?null:(P=y&&P[y]||P["@@iterator"],typeof P=="function"?P:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function E(P,T,z){this.props=P,this.context=T,this.refs=_,this.updater=z||w}E.prototype.isReactComponent={},E.prototype.setState=function(P,T){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,T,"setState")},E.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function C(){}C.prototype=E.prototype;function N(P,T,z){this.props=P,this.context=T,this.refs=_,this.updater=z||w}var O=N.prototype=new C;O.constructor=N,b(O,E.prototype),O.isPureReactComponent=!0;var Q=Array.isArray;function G(){}var M={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function A(P,T,z){var k=z.ref;return{$$typeof:t,type:P,key:T,ref:k!==void 0?k:null,props:z}}function R(P,T){return A(P.type,T,P.props)}function Z(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function F(P){var T={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(z){return T[z]})}var q=/\/+/g;function ee(P,T){return typeof P=="object"&&P!==null&&P.key!=null?F(""+P.key):T.toString(36)}function me(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(G,G):(P.status="pending",P.then(function(T){P.status==="pending"&&(P.status="fulfilled",P.value=T)},function(T){P.status==="pending"&&(P.status="rejected",P.reason=T)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function W(P,T,z,k,I){var D=typeof P;(D==="undefined"||D==="boolean")&&(P=null);var de=!1;if(P===null)de=!0;else switch(D){case"bigint":case"string":case"number":de=!0;break;case"object":switch(P.$$typeof){case t:case r:de=!0;break;case x:return de=P._init,W(de(P._payload),T,z,k,I)}}if(de)return I=I(P),de=k===""?"."+ee(P,0):k,Q(I)?(z="",de!=null&&(z=de.replace(q,"$&/")+"/"),W(I,T,z,"",function(ve){return ve})):I!=null&&(Z(I)&&(I=R(I,z+(I.key==null||P&&P.key===I.key?"":(""+I.key).replace(q,"$&/")+"/")+de)),T.push(I)),1;de=0;var he=k===""?".":k+":";if(Q(P))for(var ie=0;ie<P.length;ie++)k=P[ie],D=he+ee(k,ie),de+=W(k,T,z,D,I);else if(ie=S(P),typeof ie=="function")for(P=ie.call(P),ie=0;!(k=P.next()).done;)k=k.value,D=he+ee(k,ie++),de+=W(k,T,z,D,I);else if(D==="object"){if(typeof P.then=="function")return W(me(P),T,z,k,I);throw T=String(P),Error("Objects are not valid as a React child (found: "+(T==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":T)+"). If you meant to render a collection of children, use an array instead.")}return de}function J(P,T,z){if(P==null)return P;var k=[],I=0;return W(P,k,"","",function(D){return T.call(z,D,I++)}),k}function L(P){if(P._status===-1){var T=P._result;T=T(),T.then(function(z){(P._status===0||P._status===-1)&&(P._status=1,P._result=z)},function(z){(P._status===0||P._status===-1)&&(P._status=2,P._result=z)}),P._status===-1&&(P._status=0,P._result=T)}if(P._status===1)return P._result.default;throw P._result}var H=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var T=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(T))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},ne={map:J,forEach:function(P,T,z){J(P,function(){T.apply(this,arguments)},z)},count:function(P){var T=0;return J(P,function(){T++}),T},toArray:function(P){return J(P,function(T){return T})||[]},only:function(P){if(!Z(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return bt.Activity=j,bt.Children=ne,bt.Component=E,bt.Fragment=a,bt.Profiler=o,bt.PureComponent=N,bt.StrictMode=s,bt.Suspense=f,bt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,bt.__COMPILER_RUNTIME={__proto__:null,c:function(P){return M.H.useMemoCache(P)}},bt.cache=function(P){return function(){return P.apply(null,arguments)}},bt.cacheSignal=function(){return null},bt.cloneElement=function(P,T,z){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var k=b({},P.props),I=P.key;if(T!=null)for(D in T.key!==void 0&&(I=""+T.key),T)!U.call(T,D)||D==="key"||D==="__self"||D==="__source"||D==="ref"&&T.ref===void 0||(k[D]=T[D]);var D=arguments.length-2;if(D===1)k.children=z;else if(1<D){for(var de=Array(D),he=0;he<D;he++)de[he]=arguments[he+2];k.children=de}return A(P.type,I,k)},bt.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:d,_context:P},P},bt.createElement=function(P,T,z){var k,I={},D=null;if(T!=null)for(k in T.key!==void 0&&(D=""+T.key),T)U.call(T,k)&&k!=="key"&&k!=="__self"&&k!=="__source"&&(I[k]=T[k]);var de=arguments.length-2;if(de===1)I.children=z;else if(1<de){for(var he=Array(de),ie=0;ie<de;ie++)he[ie]=arguments[ie+2];I.children=he}if(P&&P.defaultProps)for(k in de=P.defaultProps,de)I[k]===void 0&&(I[k]=de[k]);return A(P,D,I)},bt.createRef=function(){return{current:null}},bt.forwardRef=function(P){return{$$typeof:h,render:P}},bt.isValidElement=Z,bt.lazy=function(P){return{$$typeof:x,_payload:{_status:-1,_result:P},_init:L}},bt.memo=function(P,T){return{$$typeof:p,type:P,compare:T===void 0?null:T}},bt.startTransition=function(P){var T=M.T,z={};M.T=z;try{var k=P(),I=M.S;I!==null&&I(z,k),typeof k=="object"&&k!==null&&typeof k.then=="function"&&k.then(G,H)}catch(D){H(D)}finally{T!==null&&z.types!==null&&(T.types=z.types),M.T=T}},bt.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},bt.use=function(P){return M.H.use(P)},bt.useActionState=function(P,T,z){return M.H.useActionState(P,T,z)},bt.useCallback=function(P,T){return M.H.useCallback(P,T)},bt.useContext=function(P){return M.H.useContext(P)},bt.useDebugValue=function(){},bt.useDeferredValue=function(P,T){return M.H.useDeferredValue(P,T)},bt.useEffect=function(P,T){return M.H.useEffect(P,T)},bt.useEffectEvent=function(P){return M.H.useEffectEvent(P)},bt.useId=function(){return M.H.useId()},bt.useImperativeHandle=function(P,T,z){return M.H.useImperativeHandle(P,T,z)},bt.useInsertionEffect=function(P,T){return M.H.useInsertionEffect(P,T)},bt.useLayoutEffect=function(P,T){return M.H.useLayoutEffect(P,T)},bt.useMemo=function(P,T){return M.H.useMemo(P,T)},bt.useOptimistic=function(P,T){return M.H.useOptimistic(P,T)},bt.useReducer=function(P,T,z){return M.H.useReducer(P,T,z)},bt.useRef=function(P){return M.H.useRef(P)},bt.useState=function(P){return M.H.useState(P)},bt.useSyncExternalStore=function(P,T,z){return M.H.useSyncExternalStore(P,T,z)},bt.useTransition=function(){return M.H.useTransition()},bt.version="19.2.4",bt}var fy;function ap(){return fy||(fy=1,qh.exports=ES()),qh.exports}var m=ap(),Yh={exports:{}},zo={},Jh={exports:{}},Xh={};var hy;function FS(){return hy||(hy=1,(function(t){function r(W,J){var L=W.length;W.push(J);e:for(;0<L;){var H=L-1>>>1,ne=W[H];if(0<o(ne,J))W[H]=J,W[L]=ne,L=H;else break e}}function a(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var J=W[0],L=W.pop();if(L!==J){W[0]=L;e:for(var H=0,ne=W.length,P=ne>>>1;H<P;){var T=2*(H+1)-1,z=W[T],k=T+1,I=W[k];if(0>o(z,L))k<ne&&0>o(I,z)?(W[H]=I,W[k]=L,H=k):(W[H]=z,W[T]=L,H=T);else if(k<ne&&0>o(I,L))W[H]=I,W[k]=L,H=k;else break e}}return J}function o(W,J){var L=W.sortIndex-J.sortIndex;return L!==0?L:W.id-J.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;t.unstable_now=function(){return d.now()}}else{var u=Date,h=u.now();t.unstable_now=function(){return u.now()-h}}var f=[],p=[],x=1,j=null,y=3,S=!1,w=!1,b=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function O(W){for(var J=a(p);J!==null;){if(J.callback===null)s(p);else if(J.startTime<=W)s(p),J.sortIndex=J.expirationTime,r(f,J);else break;J=a(p)}}function Q(W){if(b=!1,O(W),!w)if(a(f)!==null)w=!0,G||(G=!0,F());else{var J=a(p);J!==null&&me(Q,J.startTime-W)}}var G=!1,M=-1,U=5,A=-1;function R(){return _?!0:!(t.unstable_now()-A<U)}function Z(){if(_=!1,G){var W=t.unstable_now();A=W;var J=!0;try{e:{w=!1,b&&(b=!1,C(M),M=-1),S=!0;var L=y;try{t:{for(O(W),j=a(f);j!==null&&!(j.expirationTime>W&&R());){var H=j.callback;if(typeof H=="function"){j.callback=null,y=j.priorityLevel;var ne=H(j.expirationTime<=W);if(W=t.unstable_now(),typeof ne=="function"){j.callback=ne,O(W),J=!0;break t}j===a(f)&&s(f),O(W)}else s(f);j=a(f)}if(j!==null)J=!0;else{var P=a(p);P!==null&&me(Q,P.startTime-W),J=!1}}break e}finally{j=null,y=L,S=!1}J=void 0}}finally{J?F():G=!1}}}var F;if(typeof N=="function")F=function(){N(Z)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ee=q.port2;q.port1.onmessage=Z,F=function(){ee.postMessage(null)}}else F=function(){E(Z,0)};function me(W,J){M=E(function(){W(t.unstable_now())},J)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(W){switch(y){case 1:case 2:case 3:var J=3;break;default:J=y}var L=y;y=J;try{return W()}finally{y=L}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(W,J){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var L=y;y=W;try{return J()}finally{y=L}},t.unstable_scheduleCallback=function(W,J,L){var H=t.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?H+L:H):L=H,W){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=L+ne,W={id:x++,callback:J,priorityLevel:W,startTime:L,expirationTime:ne,sortIndex:-1},L>H?(W.sortIndex=L,r(p,W),a(f)===null&&W===a(p)&&(b?(C(M),M=-1):b=!0,me(Q,L-H))):(W.sortIndex=ne,r(f,W),w||S||(w=!0,G||(G=!0,F()))),W},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(W){var J=y;return function(){var L=y;y=J;try{return W.apply(this,arguments)}finally{y=L}}}})(Xh)),Xh}var my;function RS(){return my||(my=1,Jh.exports=FS()),Jh.exports}var Qh={exports:{}},un={};var py;function BS(){if(py)return un;py=1;var t=ap();function r(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)p+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function d(f,p,x){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:j==null?null:""+j,children:f,containerInfo:p,implementation:x}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,un.createPortal=function(f,p){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(r(299));return d(f,p,null,x)},un.flushSync=function(f){var p=u.T,x=s.p;try{if(u.T=null,s.p=2,f)return f()}finally{u.T=p,s.p=x,s.d.f()}},un.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,s.d.C(f,p))},un.prefetchDNS=function(f){typeof f=="string"&&s.d.D(f)},un.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var x=p.as,j=h(x,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;x==="style"?s.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:j,integrity:y,fetchPriority:S}):x==="script"&&s.d.X(f,{crossOrigin:j,integrity:y,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},un.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var x=h(p.as,p.crossOrigin);s.d.M(f,{crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&s.d.M(f)},un.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var x=p.as,j=h(x,p.crossOrigin);s.d.L(f,x,{crossOrigin:j,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},un.preloadModule=function(f,p){if(typeof f=="string")if(p){var x=h(p.as,p.crossOrigin);s.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:x,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else s.d.m(f)},un.requestFormReset=function(f){s.d.r(f)},un.unstable_batchedUpdates=function(f,p){return f(p)},un.useFormState=function(f,p,x){return u.H.useFormState(f,p,x)},un.useFormStatus=function(){return u.H.useHostTransitionStatus()},un.version="19.2.4",un}var gy;function OS(){if(gy)return Qh.exports;gy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Qh.exports=BS(),Qh.exports}var xy;function DS(){if(xy)return zo;xy=1;var t=RS(),r=ap(),a=OS();function s(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function d(n){var i=n,l=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(l=i.return),n=i.return;while(n)}return i.tag===3?l:null}function u(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function h(n){if(n.tag===31){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function f(n){if(d(n)!==n)throw Error(s(188))}function p(n){var i=n.alternate;if(!i){if(i=d(n),i===null)throw Error(s(188));return i!==n?null:n}for(var l=n,c=i;;){var g=l.return;if(g===null)break;var v=g.alternate;if(v===null){if(c=g.return,c!==null){l=c;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===l)return f(g),n;if(v===c)return f(g),i;v=v.sibling}throw Error(s(188))}if(l.return!==c.return)l=g,c=v;else{for(var B=!1,X=g.child;X;){if(X===l){B=!0,l=g,c=v;break}if(X===c){B=!0,c=g,l=v;break}X=X.sibling}if(!B){for(X=v.child;X;){if(X===l){B=!0,l=v,c=g;break}if(X===c){B=!0,c=v,l=g;break}X=X.sibling}if(!B)throw Error(s(189))}}if(l.alternate!==c)throw Error(s(190))}if(l.tag!==3)throw Error(s(188));return l.stateNode.current===l?n:i}function x(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=x(n),i!==null)return i;n=n.sibling}return null}var j=Object.assign,y=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.consumer"),N=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),G=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function F(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var q=Symbol.for("react.client.reference");function ee(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===q?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case b:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case Q:return"Suspense";case G:return"SuspenseList";case A:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case w:return"Portal";case N:return n.displayName||"Context";case C:return(n._context.displayName||"Context")+".Consumer";case O:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case M:return i=n.displayName||null,i!==null?i:ee(n.type)||"Memo";case U:i=n._payload,n=n._init;try{return ee(n(i))}catch{}}return null}var me=Array.isArray,W=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},H=[],ne=-1;function P(n){return{current:n}}function T(n){0>ne||(n.current=H[ne],H[ne]=null,ne--)}function z(n,i){ne++,H[ne]=n.current,n.current=i}var k=P(null),I=P(null),D=P(null),de=P(null);function he(n,i){switch(z(D,i),z(I,n),z(k,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?Fx(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=Fx(i),n=Rx(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}T(k),z(k,n)}function ie(){T(k),T(I),T(D)}function ve(n){n.memoizedState!==null&&z(de,n);var i=k.current,l=Rx(i,n.type);i!==l&&(z(I,n),z(k,l))}function je(n){I.current===n&&(T(k),T(I)),de.current===n&&(T(de),bo._currentValue=L)}var fe,_e;function Se(n){if(fe===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);fe=i&&i[1]||"",_e=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fe+n+_e}var Ve=!1;function be(n,i){if(!n||Ve)return"";Ve=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(i){var Ze=function(){throw Error()};if(Object.defineProperty(Ze.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ze,[])}catch(Le){var Re=Le}Reflect.construct(n,[],Ze)}else{try{Ze.call()}catch(Le){Re=Le}n.call(Ze.prototype)}}else{try{throw Error()}catch(Le){Re=Le}(Ze=n())&&typeof Ze.catch=="function"&&Ze.catch(function(){})}}catch(Le){if(Le&&Re&&typeof Le.stack=="string")return[Le.stack,Re.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),B=v[0],X=v[1];if(B&&X){var pe=B.split(`
`),Ee=X.split(`
`);for(g=c=0;c<pe.length&&!pe[c].includes("DetermineComponentFrameRoot");)c++;for(;g<Ee.length&&!Ee[g].includes("DetermineComponentFrameRoot");)g++;if(c===pe.length||g===Ee.length)for(c=pe.length-1,g=Ee.length-1;1<=c&&0<=g&&pe[c]!==Ee[g];)g--;for(;1<=c&&0<=g;c--,g--)if(pe[c]!==Ee[g]){if(c!==1||g!==1)do if(c--,g--,0>g||pe[c]!==Ee[g]){var We=`
`+pe[c].replace(" at new "," at ");return n.displayName&&We.includes("<anonymous>")&&(We=We.replace("<anonymous>",n.displayName)),We}while(1<=c&&0<=g);break}}}finally{Ve=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?Se(l):""}function oe(n,i){switch(n.tag){case 26:case 27:case 5:return Se(n.type);case 16:return Se("Lazy");case 13:return n.child!==i&&i!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return be(n.type,!1);case 11:return be(n.type.render,!1);case 1:return be(n.type,!0);case 31:return Se("Activity");default:return""}}function Ue(n){try{var i="",l=null;do i+=oe(n,l),l=n,n=n.return;while(n);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Qe=Object.prototype.hasOwnProperty,lt=t.unstable_scheduleCallback,tt=t.unstable_cancelCallback,ht=t.unstable_shouldYield,xt=t.unstable_requestPaint,qe=t.unstable_now,Nt=t.unstable_getCurrentPriorityLevel,st=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,zt=t.unstable_NormalPriority,It=t.unstable_LowPriority,va=t.unstable_IdlePriority,rt=t.log,oa=t.unstable_setDisableYieldValue,ca=null,ze=null;function et(n){if(typeof rt=="function"&&oa(n),ze&&typeof ze.setStrictMode=="function")try{ze.setStrictMode(ca,n)}catch{}}var it=Math.clz32?Math.clz32:nt,Be=Math.log,at=Math.LN2;function nt(n){return n>>>=0,n===0?32:31-(Be(n)/at|0)|0}var ut=256,ta=262144,Pt=4194304;function Tt(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function xe(n,i,l){var c=n.pendingLanes;if(c===0)return 0;var g=0,v=n.suspendedLanes,B=n.pingedLanes;n=n.warmLanes;var X=c&134217727;return X!==0?(c=X&~v,c!==0?g=Tt(c):(B&=X,B!==0?g=Tt(B):l||(l=X&~n,l!==0&&(g=Tt(l))))):(X=c&~v,X!==0?g=Tt(X):B!==0?g=Tt(B):l||(l=c&~n,l!==0&&(g=Tt(l)))),g===0?0:i!==0&&i!==g&&(i&v)===0&&(v=g&-g,l=i&-i,v>=l||v===32&&(l&4194048)!==0)?i:g}function Ie(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function mt(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oe(){var n=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),n}function ct(n){for(var i=[],l=0;31>l;l++)i.push(n);return i}function At(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function za(n,i,l,c,g,v){var B=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var X=n.entanglements,pe=n.expirationTimes,Ee=n.hiddenUpdates;for(l=B&~l;0<l;){var We=31-it(l),Ze=1<<We;X[We]=0,pe[We]=-1;var Re=Ee[We];if(Re!==null)for(Ee[We]=null,We=0;We<Re.length;We++){var Le=Re[We];Le!==null&&(Le.lane&=-536870913)}l&=~Ze}c!==0&&ja(n,c,0),v!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=v&~(B&~i))}function ja(n,i,l){n.pendingLanes|=i,n.suspendedLanes&=~i;var c=31-it(i);n.entangledLanes|=i,n.entanglements[c]=n.entanglements[c]|1073741824|l&261930}function Et(n,i){var l=n.entangledLanes|=i;for(n=n.entanglements;l;){var c=31-it(l),g=1<<c;g&i|n[c]&i&&(n[c]|=i),l&=~g}}function ge(n,i){var l=i&-i;return l=(l&42)!==0?1:Ft(l),(l&(n.suspendedLanes|i))!==0?0:l}function Ft(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ga(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Y(){var n=J.p;return n!==0?n:(n=window.event,n===void 0?32:ay(n.type))}function se(n,i){var l=J.p;try{return J.p=n,i()}finally{J.p=l}}var te=Math.random().toString(36).slice(2),ae="__reactFiber$"+te,re="__reactProps$"+te,ce="__reactContainer$"+te,Ce="__reactEvents$"+te,De="__reactListeners$"+te,Ne="__reactHandles$"+te,Fe="__reactResources$"+te,K="__reactMarker$"+te;function ue(n){delete n[ae],delete n[re],delete n[Ce],delete n[De],delete n[Ne]}function ke(n){var i=n[ae];if(i)return i;for(var l=n.parentNode;l;){if(i=l[ce]||l[ae]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(n=Px(n);n!==null;){if(l=n[ae])return l;n=Px(n)}return i}n=l,l=n.parentNode}return null}function Te(n){if(n=n[ae]||n[ce]){var i=n.tag;if(i===5||i===6||i===13||i===31||i===26||i===27||i===3)return n}return null}function Me(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(s(33))}function Ye(n){var i=n[Fe];return i||(i=n[Fe]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function $e(n){n[K]=!0}var yt=new Set,jt={};function Kt(n,i){cn(n,i),cn(n+"Capture",i)}function cn(n,i){for(jt[n]=i,n=0;n<i.length;n++)yt.add(i[n])}var sa=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Pa={},qn={};function ui(n){return Qe.call(qn,n)?!0:Qe.call(Pa,n)?!1:sa.test(n)?qn[n]=!0:(Pa[n]=!0,!1)}function Zt(n,i,l){if(ui(i))if(l===null)n.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var c=i.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+l)}}function ur(n,i,l){if(l===null)n.removeAttribute(i);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+l)}}function fr(n,i,l,c){if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(i,l,""+c)}}function bn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function vc(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Vu(n,i,l){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,i);if(!n.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,v=c.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return g.call(this)},set:function(B){l=""+B,v.call(this,B)}}),Object.defineProperty(n,i,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(B){l=""+B},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Fl(n){if(!n._valueTracker){var i=vc(n)?"checked":"value";n._valueTracker=Vu(n,i,""+n[i])}}function jc(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var l=i.getValue(),c="";return n&&(c=vc(n)?n.checked?"true":"false":n.value),n=c,n!==l?(i.setValue(n),!0):!1}function Ts(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Zu=/[\n"\\]/g;function _n(n){return n.replace(Zu,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Rl(n,i,l,c,g,v,B,X){n.name="",B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?n.type=B:n.removeAttribute("type"),i!=null?B==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+bn(i)):n.value!==""+bn(i)&&(n.value=""+bn(i)):B!=="submit"&&B!=="reset"||n.removeAttribute("value"),i!=null?Bl(n,B,bn(i)):l!=null?Bl(n,B,bn(l)):c!=null&&n.removeAttribute("value"),g==null&&v!=null&&(n.defaultChecked=!!v),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?n.name=""+bn(X):n.removeAttribute("name")}function bc(n,i,l,c,g,v,B,X){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(n.type=v),i!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||i!=null)){Fl(n);return}l=l!=null?""+bn(l):"",i=i!=null?""+bn(i):l,X||i===n.value||(n.value=i),n.defaultValue=i}c=c??g,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=X?n.checked:!!c,n.defaultChecked=!!c,B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"&&(n.name=B),Fl(n)}function Bl(n,i,l){i==="number"&&Ts(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function fi(n,i,l,c){if(n=n.options,i){i={};for(var g=0;g<l.length;g++)i["$"+l[g]]=!0;for(l=0;l<n.length;l++)g=i.hasOwnProperty("$"+n[l].value),n[l].selected!==g&&(n[l].selected=g),g&&c&&(n[l].defaultSelected=!0)}else{for(l=""+bn(l),i=null,g=0;g<n.length;g++){if(n[g].value===l){n[g].selected=!0,c&&(n[g].defaultSelected=!0);return}i!==null||n[g].disabled||(i=n[g])}i!==null&&(i.selected=!0)}}function _c(n,i,l){if(i!=null&&(i=""+bn(i),i!==n.value&&(n.value=i),l==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=l!=null?""+bn(l):""}function Yi(n,i,l,c){if(i==null){if(c!=null){if(l!=null)throw Error(s(92));if(me(c)){if(1<c.length)throw Error(s(93));c=c[0]}l=c}l==null&&(l=""),i=l}l=bn(i),n.defaultValue=l,c=n.textContent,c===l&&c!==""&&c!==null&&(n.value=c),Fl(n)}function hr(n,i){if(i){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=i;return}}n.textContent=i}var Ns=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hi(n,i,l){var c=i.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":c?n.setProperty(i,l):typeof l!="number"||l===0||Ns.has(i)?i==="float"?n.cssFloat=l:n[i]=(""+l).trim():n[i]=l+"px"}function Sc(n,i,l){if(i!=null&&typeof i!="object")throw Error(s(62));if(n=n.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||i!=null&&i.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var g in i)c=i[g],i.hasOwnProperty(g)&&l[g]!==c&&hi(n,g,c)}else for(var v in i)i.hasOwnProperty(v)&&hi(n,v,i[v])}function Ol(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ku=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function As(n){return Ku.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function mr(){}var Dl=null;function Ll(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var mi=null,pi=null;function wc(n){var i=Te(n);if(i&&(n=i.stateNode)){var l=n[re]||null;e:switch(n=i.stateNode,i.type){case"input":if(Rl(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),i=l.name,l.type==="radio"&&i!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+_n(""+i)+'"][type="radio"]'),i=0;i<l.length;i++){var c=l[i];if(c!==n&&c.form===n.form){var g=c[re]||null;if(!g)throw Error(s(90));Rl(c,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(i=0;i<l.length;i++)c=l[i],c.form===n.form&&jc(c)}break e;case"textarea":_c(n,l.value,l.defaultValue);break e;case"select":i=l.value,i!=null&&fi(n,!!l.multiple,i,!1)}}}var Ml=!1;function kc(n,i,l){if(Ml)return n(i,l);Ml=!0;try{var c=n(i);return c}finally{if(Ml=!1,(mi!==null||pi!==null)&&(ud(),mi&&(i=mi,n=pi,pi=mi=null,wc(i),n)))for(i=0;i<n.length;i++)wc(n[i])}}function Ji(n,i){var l=n.stateNode;if(l===null)return null;var c=l[re]||null;if(c===null)return null;l=c[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(s(231,i,typeof l));return l}var V=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ge=!1;if(V)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Ge=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Ge=!1}var ua=null,Ha=null,pr=null;function zc(){if(pr)return pr;var n,i=Ha,l=i.length,c,g="value"in ua?ua.value:ua.textContent,v=g.length;for(n=0;n<l&&i[n]===g[n];n++);var B=l-n;for(c=1;c<=B&&i[l-c]===g[v-c];c++);return pr=g.slice(n,1<c?1-c:void 0)}function Es(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function Fs(){return!0}function Cc(){return!1}function dn(n){function i(l,c,g,v,B){this._reactName=l,this._targetInst=g,this.type=c,this.nativeEvent=v,this.target=B,this.currentTarget=null;for(var X in n)n.hasOwnProperty(X)&&(l=n[X],this[X]=l?l(v):v[X]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Fs:Cc,this.isPropagationStopped=Cc,this}return j(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Fs)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Fs)},persist:function(){},isPersistent:Fs}),i}var Cr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tc=dn(Cr),Il=j({},Cr,{view:0,detail:0}),Cb=dn(Il),qu,Yu,Pl,Nc=j({},Il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Pl&&(Pl&&n.type==="mousemove"?(qu=n.screenX-Pl.screenX,Yu=n.screenY-Pl.screenY):Yu=qu=0,Pl=n),qu)},movementY:function(n){return"movementY"in n?n.movementY:Yu}}),Op=dn(Nc),Tb=j({},Nc,{dataTransfer:0}),Nb=dn(Tb),Ab=j({},Il,{relatedTarget:0}),Ju=dn(Ab),Eb=j({},Cr,{animationName:0,elapsedTime:0,pseudoElement:0}),Fb=dn(Eb),Rb=j({},Cr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Bb=dn(Rb),Ob=j({},Cr,{data:0}),Dp=dn(Ob),Db={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ib(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Mb[n])?!!i[n]:!1}function Xu(){return Ib}var Pb=j({},Il,{key:function(n){if(n.key){var i=Db[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Es(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Lb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(n){return n.type==="keypress"?Es(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Es(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Wb=dn(Pb),Ub=j({},Nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lp=dn(Ub),$b=j({},Il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),Hb=dn($b),Vb=j({},Cr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zb=dn(Vb),Gb=j({},Nc,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Kb=dn(Gb),qb=j({},Cr,{newState:0,oldState:0}),Yb=dn(qb),Jb=[9,13,27,32],Qu=V&&"CompositionEvent"in window,Wl=null;V&&"documentMode"in document&&(Wl=document.documentMode);var Xb=V&&"TextEvent"in window&&!Wl,Mp=V&&(!Qu||Wl&&8<Wl&&11>=Wl),Ip=" ",Pp=!1;function Wp(n,i){switch(n){case"keyup":return Jb.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Up(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rs=!1;function Qb(n,i){switch(n){case"compositionend":return Up(i);case"keypress":return i.which!==32?null:(Pp=!0,Ip);case"textInput":return n=i.data,n===Ip&&Pp?null:n;default:return null}}function e_(n,i){if(Rs)return n==="compositionend"||!Qu&&Wp(n,i)?(n=zc(),pr=Ha=ua=null,Rs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Mp&&i.locale!=="ko"?null:i.data;default:return null}}var t_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $p(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!t_[n.type]:i==="textarea"}function Hp(n,i,l,c){mi?pi?pi.push(c):pi=[c]:mi=c,i=yd(i,"onChange"),0<i.length&&(l=new Tc("onChange","change",null,l,c),n.push({event:l,listeners:i}))}var Ul=null,$l=null;function a_(n){zx(n,0)}function Ac(n){var i=Me(n);if(jc(i))return n}function Vp(n,i){if(n==="change")return i}var Zp=!1;if(V){var ef;if(V){var tf="oninput"in document;if(!tf){var Gp=document.createElement("div");Gp.setAttribute("oninput","return;"),tf=typeof Gp.oninput=="function"}ef=tf}else ef=!1;Zp=ef&&(!document.documentMode||9<document.documentMode)}function Kp(){Ul&&(Ul.detachEvent("onpropertychange",qp),$l=Ul=null)}function qp(n){if(n.propertyName==="value"&&Ac($l)){var i=[];Hp(i,$l,n,Ll(n)),kc(a_,i)}}function n_(n,i,l){n==="focusin"?(Kp(),Ul=i,$l=l,Ul.attachEvent("onpropertychange",qp)):n==="focusout"&&Kp()}function r_(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ac($l)}function i_(n,i){if(n==="click")return Ac(i)}function s_(n,i){if(n==="input"||n==="change")return Ac(i)}function l_(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Fn=typeof Object.is=="function"?Object.is:l_;function Hl(n,i){if(Fn(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var l=Object.keys(n),c=Object.keys(i);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var g=l[c];if(!Qe.call(i,g)||!Fn(n[g],i[g]))return!1}return!0}function Yp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Jp(n,i){var l=Yp(n);n=0;for(var c;l;){if(l.nodeType===3){if(c=n+l.textContent.length,n<=i&&c>=i)return{node:l,offset:i-n};n=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Yp(l)}}function Xp(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Xp(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Qp(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Ts(n.document);i instanceof n.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)n=i.contentWindow;else break;i=Ts(n.document)}return i}function af(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var o_=V&&"documentMode"in document&&11>=document.documentMode,Bs=null,nf=null,Vl=null,rf=!1;function eg(n,i,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;rf||Bs==null||Bs!==Ts(c)||(c=Bs,"selectionStart"in c&&af(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Vl&&Hl(Vl,c)||(Vl=c,c=yd(nf,"onSelect"),0<c.length&&(i=new Tc("onSelect","select",null,i,l),n.push({event:i,listeners:c}),i.target=Bs)))}function Xi(n,i){var l={};return l[n.toLowerCase()]=i.toLowerCase(),l["Webkit"+n]="webkit"+i,l["Moz"+n]="moz"+i,l}var Os={animationend:Xi("Animation","AnimationEnd"),animationiteration:Xi("Animation","AnimationIteration"),animationstart:Xi("Animation","AnimationStart"),transitionrun:Xi("Transition","TransitionRun"),transitionstart:Xi("Transition","TransitionStart"),transitioncancel:Xi("Transition","TransitionCancel"),transitionend:Xi("Transition","TransitionEnd")},sf={},tg={};V&&(tg=document.createElement("div").style,"AnimationEvent"in window||(delete Os.animationend.animation,delete Os.animationiteration.animation,delete Os.animationstart.animation),"TransitionEvent"in window||delete Os.transitionend.transition);function Qi(n){if(sf[n])return sf[n];if(!Os[n])return n;var i=Os[n],l;for(l in i)if(i.hasOwnProperty(l)&&l in tg)return sf[n]=i[l];return n}var ag=Qi("animationend"),ng=Qi("animationiteration"),rg=Qi("animationstart"),c_=Qi("transitionrun"),d_=Qi("transitionstart"),u_=Qi("transitioncancel"),ig=Qi("transitionend"),sg=new Map,lf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lf.push("scrollEnd");function gr(n,i){sg.set(n,i),Kt(i,[n])}var Ec=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Yn=[],Ds=0,of=0;function Fc(){for(var n=Ds,i=of=Ds=0;i<n;){var l=Yn[i];Yn[i++]=null;var c=Yn[i];Yn[i++]=null;var g=Yn[i];Yn[i++]=null;var v=Yn[i];if(Yn[i++]=null,c!==null&&g!==null){var B=c.pending;B===null?g.next=g:(g.next=B.next,B.next=g),c.pending=g}v!==0&&lg(l,g,v)}}function Rc(n,i,l,c){Yn[Ds++]=n,Yn[Ds++]=i,Yn[Ds++]=l,Yn[Ds++]=c,of|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function cf(n,i,l,c){return Rc(n,i,l,c),Bc(n)}function es(n,i){return Rc(n,null,null,i),Bc(n)}function lg(n,i,l){n.lanes|=l;var c=n.alternate;c!==null&&(c.lanes|=l);for(var g=!1,v=n.return;v!==null;)v.childLanes|=l,c=v.alternate,c!==null&&(c.childLanes|=l),v.tag===22&&(n=v.stateNode,n===null||n._visibility&1||(g=!0)),n=v,v=v.return;return n.tag===3?(v=n.stateNode,g&&i!==null&&(g=31-it(l),n=v.hiddenUpdates,c=n[g],c===null?n[g]=[i]:c.push(i),i.lane=l|536870912),v):null}function Bc(n){if(50<mo)throw mo=0,yh=null,Error(s(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Ls={};function f_(n,i,l,c){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rn(n,i,l,c){return new f_(n,i,l,c)}function df(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ir(n,i){var l=n.alternate;return l===null?(l=Rn(n.tag,i,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=i,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,i=n.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function og(n,i){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,i=l.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function Oc(n,i,l,c,g,v){var B=0;if(c=n,typeof n=="function")df(n)&&(B=1);else if(typeof n=="string")B=xS(n,l,k.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case A:return n=Rn(31,l,i,g),n.elementType=A,n.lanes=v,n;case b:return ts(l.children,g,v,i);case _:B=8,g|=24;break;case E:return n=Rn(12,l,i,g|2),n.elementType=E,n.lanes=v,n;case Q:return n=Rn(13,l,i,g),n.elementType=Q,n.lanes=v,n;case G:return n=Rn(19,l,i,g),n.elementType=G,n.lanes=v,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case N:B=10;break e;case C:B=9;break e;case O:B=11;break e;case M:B=14;break e;case U:B=16,c=null;break e}B=29,l=Error(s(130,n===null?"null":typeof n,"")),c=null}return i=Rn(B,l,i,g),i.elementType=n,i.type=c,i.lanes=v,i}function ts(n,i,l,c){return n=Rn(7,n,c,i),n.lanes=l,n}function uf(n,i,l){return n=Rn(6,n,null,i),n.lanes=l,n}function cg(n){var i=Rn(18,null,null,0);return i.stateNode=n,i}function ff(n,i,l){return i=Rn(4,n.children!==null?n.children:[],n.key,i),i.lanes=l,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var dg=new WeakMap;function Jn(n,i){if(typeof n=="object"&&n!==null){var l=dg.get(n);return l!==void 0?l:(i={value:n,source:i,stack:Ue(i)},dg.set(n,i),i)}return{value:n,source:i,stack:Ue(i)}}var Ms=[],Is=0,Dc=null,Zl=0,Xn=[],Qn=0,gi=null,Tr=1,Nr="";function Pr(n,i){Ms[Is++]=Zl,Ms[Is++]=Dc,Dc=n,Zl=i}function ug(n,i,l){Xn[Qn++]=Tr,Xn[Qn++]=Nr,Xn[Qn++]=gi,gi=n;var c=Tr;n=Nr;var g=32-it(c)-1;c&=~(1<<g),l+=1;var v=32-it(i)+g;if(30<v){var B=g-g%5;v=(c&(1<<B)-1).toString(32),c>>=B,g-=B,Tr=1<<32-it(i)+g|l<<g|c,Nr=v+n}else Tr=1<<v|l<<g|c,Nr=n}function hf(n){n.return!==null&&(Pr(n,1),ug(n,1,0))}function mf(n){for(;n===Dc;)Dc=Ms[--Is],Ms[Is]=null,Zl=Ms[--Is],Ms[Is]=null;for(;n===gi;)gi=Xn[--Qn],Xn[Qn]=null,Nr=Xn[--Qn],Xn[Qn]=null,Tr=Xn[--Qn],Xn[Qn]=null}function fg(n,i){Xn[Qn++]=Tr,Xn[Qn++]=Nr,Xn[Qn++]=gi,Tr=i.id,Nr=i.overflow,gi=n}var qa=null,fa=null,Mt=!1,xi=null,er=!1,pf=Error(s(519));function yi(n){var i=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Gl(Jn(i,n)),pf}function hg(n){var i=n.stateNode,l=n.type,c=n.memoizedProps;switch(i[ae]=n,i[re]=c,l){case"dialog":Bt("cancel",i),Bt("close",i);break;case"iframe":case"object":case"embed":Bt("load",i);break;case"video":case"audio":for(l=0;l<go.length;l++)Bt(go[l],i);break;case"source":Bt("error",i);break;case"img":case"image":case"link":Bt("error",i),Bt("load",i);break;case"details":Bt("toggle",i);break;case"input":Bt("invalid",i),bc(i,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Bt("invalid",i);break;case"textarea":Bt("invalid",i),Yi(i,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||i.textContent===""+l||c.suppressHydrationWarning===!0||Ax(i.textContent,l)?(c.popover!=null&&(Bt("beforetoggle",i),Bt("toggle",i)),c.onScroll!=null&&Bt("scroll",i),c.onScrollEnd!=null&&Bt("scrollend",i),c.onClick!=null&&(i.onclick=mr),i=!0):i=!1,i||yi(n,!0)}function mg(n){for(qa=n.return;qa;)switch(qa.tag){case 5:case 31:case 13:er=!1;return;case 27:case 3:er=!0;return;default:qa=qa.return}}function Ps(n){if(n!==qa)return!1;if(!Mt)return mg(n),Mt=!0,!1;var i=n.tag,l;if((l=i!==3&&i!==27)&&((l=i===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Rh(n.type,n.memoizedProps)),l=!l),l&&fa&&yi(n),mg(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));fa=Ix(n)}else if(i===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(317));fa=Ix(n)}else i===27?(i=fa,Fi(n.type)?(n=Mh,Mh=null,fa=n):fa=i):fa=qa?ar(n.stateNode.nextSibling):null;return!0}function as(){fa=qa=null,Mt=!1}function gf(){var n=xi;return n!==null&&(zn===null?zn=n:zn.push.apply(zn,n),xi=null),n}function Gl(n){xi===null?xi=[n]:xi.push(n)}var xf=P(null),ns=null,Wr=null;function vi(n,i,l){z(xf,i._currentValue),i._currentValue=l}function Ur(n){n._currentValue=xf.current,T(xf)}function yf(n,i,l){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===l)break;n=n.return}}function vf(n,i,l,c){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var v=g.dependencies;if(v!==null){var B=g.child;v=v.firstContext;e:for(;v!==null;){var X=v;v=g;for(var pe=0;pe<i.length;pe++)if(X.context===i[pe]){v.lanes|=l,X=v.alternate,X!==null&&(X.lanes|=l),yf(v.return,l,n),c||(B=null);break e}v=X.next}}else if(g.tag===18){if(B=g.return,B===null)throw Error(s(341));B.lanes|=l,v=B.alternate,v!==null&&(v.lanes|=l),yf(B,l,n),B=null}else B=g.child;if(B!==null)B.return=g;else for(B=g;B!==null;){if(B===n){B=null;break}if(g=B.sibling,g!==null){g.return=B.return,B=g;break}B=B.return}g=B}}function Ws(n,i,l,c){n=null;for(var g=i,v=!1;g!==null;){if(!v){if((g.flags&524288)!==0)v=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var B=g.alternate;if(B===null)throw Error(s(387));if(B=B.memoizedProps,B!==null){var X=g.type;Fn(g.pendingProps.value,B.value)||(n!==null?n.push(X):n=[X])}}else if(g===de.current){if(B=g.alternate,B===null)throw Error(s(387));B.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(bo):n=[bo])}g=g.return}n!==null&&vf(i,n,l,c),i.flags|=262144}function Lc(n){for(n=n.firstContext;n!==null;){if(!Fn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function rs(n){ns=n,Wr=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ya(n){return pg(ns,n)}function Mc(n,i){return ns===null&&rs(n),pg(n,i)}function pg(n,i){var l=i._currentValue;if(i={context:i,memoizedValue:l,next:null},Wr===null){if(n===null)throw Error(s(308));Wr=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else Wr=Wr.next=i;return l}var h_=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(l,c){n.push(c)}};this.abort=function(){i.aborted=!0,n.forEach(function(l){return l()})}},m_=t.unstable_scheduleCallback,p_=t.unstable_NormalPriority,Fa={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jf(){return{controller:new h_,data:new Map,refCount:0}}function Kl(n){n.refCount--,n.refCount===0&&m_(p_,function(){n.controller.abort()})}var ql=null,bf=0,Us=0,$s=null;function g_(n,i){if(ql===null){var l=ql=[];bf=0,Us=wh(),$s={status:"pending",value:void 0,then:function(c){l.push(c)}}}return bf++,i.then(gg,gg),i}function gg(){if(--bf===0&&ql!==null){$s!==null&&($s.status="fulfilled");var n=ql;ql=null,Us=0,$s=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function x_(n,i){var l=[],c={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return n.then(function(){c.status="fulfilled",c.value=i;for(var g=0;g<l.length;g++)(0,l[g])(i)},function(g){for(c.status="rejected",c.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),c}var xg=W.S;W.S=function(n,i){ex=qe(),typeof i=="object"&&i!==null&&typeof i.then=="function"&&g_(n,i),xg!==null&&xg(n,i)};var is=P(null);function _f(){var n=is.current;return n!==null?n:la.pooledCache}function Ic(n,i){i===null?z(is,is.current):z(is,i.pool)}function yg(){var n=_f();return n===null?null:{parent:Fa._currentValue,pool:n}}var Hs=Error(s(460)),Sf=Error(s(474)),Pc=Error(s(542)),Wc={then:function(){}};function vg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function jg(n,i,l){switch(l=n[l],l===void 0?n.push(i):l!==i&&(i.then(mr,mr),i=l),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,_g(n),n;default:if(typeof i.status=="string")i.then(mr,mr);else{if(n=la,n!==null&&100<n.shellSuspendCounter)throw Error(s(482));n=i,n.status="pending",n.then(function(c){if(i.status==="pending"){var g=i;g.status="fulfilled",g.value=c}},function(c){if(i.status==="pending"){var g=i;g.status="rejected",g.reason=c}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,_g(n),n}throw ls=i,Hs}}function ss(n){try{var i=n._init;return i(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(ls=l,Hs):l}}var ls=null;function bg(){if(ls===null)throw Error(s(459));var n=ls;return ls=null,n}function _g(n){if(n===Hs||n===Pc)throw Error(s(483))}var Vs=null,Yl=0;function Uc(n){var i=Yl;return Yl+=1,Vs===null&&(Vs=[]),jg(Vs,n,i)}function Jl(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function $c(n,i){throw i.$$typeof===y?Error(s(525)):(n=Object.prototype.toString.call(i),Error(s(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Sg(n){function i(we,ye){if(n){var Ae=we.deletions;Ae===null?(we.deletions=[ye],we.flags|=16):Ae.push(ye)}}function l(we,ye){if(!n)return null;for(;ye!==null;)i(we,ye),ye=ye.sibling;return null}function c(we){for(var ye=new Map;we!==null;)we.key!==null?ye.set(we.key,we):ye.set(we.index,we),we=we.sibling;return ye}function g(we,ye){return we=Ir(we,ye),we.index=0,we.sibling=null,we}function v(we,ye,Ae){return we.index=Ae,n?(Ae=we.alternate,Ae!==null?(Ae=Ae.index,Ae<ye?(we.flags|=67108866,ye):Ae):(we.flags|=67108866,ye)):(we.flags|=1048576,ye)}function B(we){return n&&we.alternate===null&&(we.flags|=67108866),we}function X(we,ye,Ae,He){return ye===null||ye.tag!==6?(ye=uf(Ae,we.mode,He),ye.return=we,ye):(ye=g(ye,Ae),ye.return=we,ye)}function pe(we,ye,Ae,He){var ft=Ae.type;return ft===b?We(we,ye,Ae.props.children,He,Ae.key):ye!==null&&(ye.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===U&&ss(ft)===ye.type)?(ye=g(ye,Ae.props),Jl(ye,Ae),ye.return=we,ye):(ye=Oc(Ae.type,Ae.key,Ae.props,null,we.mode,He),Jl(ye,Ae),ye.return=we,ye)}function Ee(we,ye,Ae,He){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==Ae.containerInfo||ye.stateNode.implementation!==Ae.implementation?(ye=ff(Ae,we.mode,He),ye.return=we,ye):(ye=g(ye,Ae.children||[]),ye.return=we,ye)}function We(we,ye,Ae,He,ft){return ye===null||ye.tag!==7?(ye=ts(Ae,we.mode,He,ft),ye.return=we,ye):(ye=g(ye,Ae),ye.return=we,ye)}function Ze(we,ye,Ae){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=uf(""+ye,we.mode,Ae),ye.return=we,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case S:return Ae=Oc(ye.type,ye.key,ye.props,null,we.mode,Ae),Jl(Ae,ye),Ae.return=we,Ae;case w:return ye=ff(ye,we.mode,Ae),ye.return=we,ye;case U:return ye=ss(ye),Ze(we,ye,Ae)}if(me(ye)||F(ye))return ye=ts(ye,we.mode,Ae,null),ye.return=we,ye;if(typeof ye.then=="function")return Ze(we,Uc(ye),Ae);if(ye.$$typeof===N)return Ze(we,Mc(we,ye),Ae);$c(we,ye)}return null}function Re(we,ye,Ae,He){var ft=ye!==null?ye.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ft!==null?null:X(we,ye,""+Ae,He);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case S:return Ae.key===ft?pe(we,ye,Ae,He):null;case w:return Ae.key===ft?Ee(we,ye,Ae,He):null;case U:return Ae=ss(Ae),Re(we,ye,Ae,He)}if(me(Ae)||F(Ae))return ft!==null?null:We(we,ye,Ae,He,null);if(typeof Ae.then=="function")return Re(we,ye,Uc(Ae),He);if(Ae.$$typeof===N)return Re(we,ye,Mc(we,Ae),He);$c(we,Ae)}return null}function Le(we,ye,Ae,He,ft){if(typeof He=="string"&&He!==""||typeof He=="number"||typeof He=="bigint")return we=we.get(Ae)||null,X(ye,we,""+He,ft);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case S:return we=we.get(He.key===null?Ae:He.key)||null,pe(ye,we,He,ft);case w:return we=we.get(He.key===null?Ae:He.key)||null,Ee(ye,we,He,ft);case U:return He=ss(He),Le(we,ye,Ae,He,ft)}if(me(He)||F(He))return we=we.get(Ae)||null,We(ye,we,He,ft,null);if(typeof He.then=="function")return Le(we,ye,Ae,Uc(He),ft);if(He.$$typeof===N)return Le(we,ye,Ae,Mc(ye,He),ft);$c(ye,He)}return null}function ot(we,ye,Ae,He){for(var ft=null,Wt=null,dt=ye,kt=ye=0,Lt=null;dt!==null&&kt<Ae.length;kt++){dt.index>kt?(Lt=dt,dt=null):Lt=dt.sibling;var Ut=Re(we,dt,Ae[kt],He);if(Ut===null){dt===null&&(dt=Lt);break}n&&dt&&Ut.alternate===null&&i(we,dt),ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut,dt=Lt}if(kt===Ae.length)return l(we,dt),Mt&&Pr(we,kt),ft;if(dt===null){for(;kt<Ae.length;kt++)dt=Ze(we,Ae[kt],He),dt!==null&&(ye=v(dt,ye,kt),Wt===null?ft=dt:Wt.sibling=dt,Wt=dt);return Mt&&Pr(we,kt),ft}for(dt=c(dt);kt<Ae.length;kt++)Lt=Le(dt,we,kt,Ae[kt],He),Lt!==null&&(n&&Lt.alternate!==null&&dt.delete(Lt.key===null?kt:Lt.key),ye=v(Lt,ye,kt),Wt===null?ft=Lt:Wt.sibling=Lt,Wt=Lt);return n&&dt.forEach(function(Li){return i(we,Li)}),Mt&&Pr(we,kt),ft}function pt(we,ye,Ae,He){if(Ae==null)throw Error(s(151));for(var ft=null,Wt=null,dt=ye,kt=ye=0,Lt=null,Ut=Ae.next();dt!==null&&!Ut.done;kt++,Ut=Ae.next()){dt.index>kt?(Lt=dt,dt=null):Lt=dt.sibling;var Li=Re(we,dt,Ut.value,He);if(Li===null){dt===null&&(dt=Lt);break}n&&dt&&Li.alternate===null&&i(we,dt),ye=v(Li,ye,kt),Wt===null?ft=Li:Wt.sibling=Li,Wt=Li,dt=Lt}if(Ut.done)return l(we,dt),Mt&&Pr(we,kt),ft;if(dt===null){for(;!Ut.done;kt++,Ut=Ae.next())Ut=Ze(we,Ut.value,He),Ut!==null&&(ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut);return Mt&&Pr(we,kt),ft}for(dt=c(dt);!Ut.done;kt++,Ut=Ae.next())Ut=Le(dt,we,kt,Ut.value,He),Ut!==null&&(n&&Ut.alternate!==null&&dt.delete(Ut.key===null?kt:Ut.key),ye=v(Ut,ye,kt),Wt===null?ft=Ut:Wt.sibling=Ut,Wt=Ut);return n&&dt.forEach(function(TS){return i(we,TS)}),Mt&&Pr(we,kt),ft}function ra(we,ye,Ae,He){if(typeof Ae=="object"&&Ae!==null&&Ae.type===b&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case S:e:{for(var ft=Ae.key;ye!==null;){if(ye.key===ft){if(ft=Ae.type,ft===b){if(ye.tag===7){l(we,ye.sibling),He=g(ye,Ae.props.children),He.return=we,we=He;break e}}else if(ye.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===U&&ss(ft)===ye.type){l(we,ye.sibling),He=g(ye,Ae.props),Jl(He,Ae),He.return=we,we=He;break e}l(we,ye);break}else i(we,ye);ye=ye.sibling}Ae.type===b?(He=ts(Ae.props.children,we.mode,He,Ae.key),He.return=we,we=He):(He=Oc(Ae.type,Ae.key,Ae.props,null,we.mode,He),Jl(He,Ae),He.return=we,we=He)}return B(we);case w:e:{for(ft=Ae.key;ye!==null;){if(ye.key===ft)if(ye.tag===4&&ye.stateNode.containerInfo===Ae.containerInfo&&ye.stateNode.implementation===Ae.implementation){l(we,ye.sibling),He=g(ye,Ae.children||[]),He.return=we,we=He;break e}else{l(we,ye);break}else i(we,ye);ye=ye.sibling}He=ff(Ae,we.mode,He),He.return=we,we=He}return B(we);case U:return Ae=ss(Ae),ra(we,ye,Ae,He)}if(me(Ae))return ot(we,ye,Ae,He);if(F(Ae)){if(ft=F(Ae),typeof ft!="function")throw Error(s(150));return Ae=ft.call(Ae),pt(we,ye,Ae,He)}if(typeof Ae.then=="function")return ra(we,ye,Uc(Ae),He);if(Ae.$$typeof===N)return ra(we,ye,Mc(we,Ae),He);$c(we,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint"?(Ae=""+Ae,ye!==null&&ye.tag===6?(l(we,ye.sibling),He=g(ye,Ae),He.return=we,we=He):(l(we,ye),He=uf(Ae,we.mode,He),He.return=we,we=He),B(we)):l(we,ye)}return function(we,ye,Ae,He){try{Yl=0;var ft=ra(we,ye,Ae,He);return Vs=null,ft}catch(dt){if(dt===Hs||dt===Pc)throw dt;var Wt=Rn(29,dt,null,we.mode);return Wt.lanes=He,Wt.return=we,Wt}}}var os=Sg(!0),wg=Sg(!1),ji=!1;function wf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function kf(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function bi(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function _i(n,i,l){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Ht&2)!==0){var g=c.pending;return g===null?i.next=i:(i.next=g.next,g.next=i),c.pending=i,i=Bc(n),lg(n,null,l),i}return Rc(n,c,i,l),Bc(n)}function Xl(n,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194048)!==0)){var c=i.lanes;c&=n.pendingLanes,l|=c,i.lanes=l,Et(n,l)}}function zf(n,i){var l=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var g=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var B={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?g=v=B:v=v.next=B,l=l.next}while(l!==null);v===null?g=v=i:v=v.next=i}else g=v=i;l={baseState:c.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=i:n.next=i,l.lastBaseUpdate=i}var Cf=!1;function Ql(){if(Cf){var n=$s;if(n!==null)throw n}}function eo(n,i,l,c){Cf=!1;var g=n.updateQueue;ji=!1;var v=g.firstBaseUpdate,B=g.lastBaseUpdate,X=g.shared.pending;if(X!==null){g.shared.pending=null;var pe=X,Ee=pe.next;pe.next=null,B===null?v=Ee:B.next=Ee,B=pe;var We=n.alternate;We!==null&&(We=We.updateQueue,X=We.lastBaseUpdate,X!==B&&(X===null?We.firstBaseUpdate=Ee:X.next=Ee,We.lastBaseUpdate=pe))}if(v!==null){var Ze=g.baseState;B=0,We=Ee=pe=null,X=v;do{var Re=X.lane&-536870913,Le=Re!==X.lane;if(Le?(Dt&Re)===Re:(c&Re)===Re){Re!==0&&Re===Us&&(Cf=!0),We!==null&&(We=We.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var ot=n,pt=X;Re=i;var ra=l;switch(pt.tag){case 1:if(ot=pt.payload,typeof ot=="function"){Ze=ot.call(ra,Ze,Re);break e}Ze=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=pt.payload,Re=typeof ot=="function"?ot.call(ra,Ze,Re):ot,Re==null)break e;Ze=j({},Ze,Re);break e;case 2:ji=!0}}Re=X.callback,Re!==null&&(n.flags|=64,Le&&(n.flags|=8192),Le=g.callbacks,Le===null?g.callbacks=[Re]:Le.push(Re))}else Le={lane:Re,tag:X.tag,payload:X.payload,callback:X.callback,next:null},We===null?(Ee=We=Le,pe=Ze):We=We.next=Le,B|=Re;if(X=X.next,X===null){if(X=g.shared.pending,X===null)break;Le=X,X=Le.next,Le.next=null,g.lastBaseUpdate=Le,g.shared.pending=null}}while(!0);We===null&&(pe=Ze),g.baseState=pe,g.firstBaseUpdate=Ee,g.lastBaseUpdate=We,v===null&&(g.shared.lanes=0),Ci|=B,n.lanes=B,n.memoizedState=Ze}}function kg(n,i){if(typeof n!="function")throw Error(s(191,n));n.call(i)}function zg(n,i){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)kg(l[n],i)}var Zs=P(null),Hc=P(0);function Cg(n,i){n=Jr,z(Hc,n),z(Zs,i),Jr=n|i.baseLanes}function Tf(){z(Hc,Jr),z(Zs,Zs.current)}function Nf(){Jr=Hc.current,T(Zs),T(Hc)}var Bn=P(null),tr=null;function Si(n){var i=n.alternate;z(Ta,Ta.current&1),z(Bn,n),tr===null&&(i===null||Zs.current!==null||i.memoizedState!==null)&&(tr=n)}function Af(n){z(Ta,Ta.current),z(Bn,n),tr===null&&(tr=n)}function Tg(n){n.tag===22?(z(Ta,Ta.current),z(Bn,n),tr===null&&(tr=n)):wi()}function wi(){z(Ta,Ta.current),z(Bn,Bn.current)}function On(n){T(Bn),tr===n&&(tr=null),T(Ta)}var Ta=P(0);function Vc(n){for(var i=n;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Dh(l)||Lh(l)))return i}else if(i.tag===19&&(i.memoizedProps.revealOrder==="forwards"||i.memoizedProps.revealOrder==="backwards"||i.memoizedProps.revealOrder==="unstable_legacy-backwards"||i.memoizedProps.revealOrder==="together")){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var $r=0,wt=null,aa=null,Ra=null,Zc=!1,Gs=!1,cs=!1,Gc=0,to=0,Ks=null,y_=0;function ba(){throw Error(s(321))}function Ef(n,i){if(i===null)return!1;for(var l=0;l<i.length&&l<n.length;l++)if(!Fn(n[l],i[l]))return!1;return!0}function Ff(n,i,l,c,g,v){return $r=v,wt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,W.H=n===null||n.memoizedState===null?u0:Gf,cs=!1,v=l(c,g),cs=!1,Gs&&(v=Ag(i,l,c,g)),Ng(n),v}function Ng(n){W.H=ro;var i=aa!==null&&aa.next!==null;if($r=0,Ra=aa=wt=null,Zc=!1,to=0,Ks=null,i)throw Error(s(300));n===null||Ba||(n=n.dependencies,n!==null&&Lc(n)&&(Ba=!0))}function Ag(n,i,l,c){wt=n;var g=0;do{if(Gs&&(Ks=null),to=0,Gs=!1,25<=g)throw Error(s(301));if(g+=1,Ra=aa=null,n.updateQueue!=null){var v=n.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}W.H=f0,v=i(l,c)}while(Gs);return v}function v_(){var n=W.H,i=n.useState()[0];return i=typeof i.then=="function"?ao(i):i,n=n.useState()[0],(aa!==null?aa.memoizedState:null)!==n&&(wt.flags|=1024),i}function Rf(){var n=Gc!==0;return Gc=0,n}function Bf(n,i,l){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~l}function Of(n){if(Zc){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Zc=!1}$r=0,Ra=aa=wt=null,Gs=!1,to=Gc=0,Ks=null}function mn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ra===null?wt.memoizedState=Ra=n:Ra=Ra.next=n,Ra}function Na(){if(aa===null){var n=wt.alternate;n=n!==null?n.memoizedState:null}else n=aa.next;var i=Ra===null?wt.memoizedState:Ra.next;if(i!==null)Ra=i,aa=n;else{if(n===null)throw wt.alternate===null?Error(s(467)):Error(s(310));aa=n,n={memoizedState:aa.memoizedState,baseState:aa.baseState,baseQueue:aa.baseQueue,queue:aa.queue,next:null},Ra===null?wt.memoizedState=Ra=n:Ra=Ra.next=n}return Ra}function Kc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ao(n){var i=to;return to+=1,Ks===null&&(Ks=[]),n=jg(Ks,n,i),i=wt,(Ra===null?i.memoizedState:Ra.next)===null&&(i=i.alternate,W.H=i===null||i.memoizedState===null?u0:Gf),n}function qc(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ao(n);if(n.$$typeof===N)return Ya(n)}throw Error(s(438,String(n)))}function Df(n){var i=null,l=wt.updateQueue;if(l!==null&&(i=l.memoCache),i==null){var c=wt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(i={data:c.data.map(function(g){return g.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),l===null&&(l=Kc(),wt.updateQueue=l),l.memoCache=i,l=i.data[i.index],l===void 0)for(l=i.data[i.index]=Array(n),c=0;c<n;c++)l[c]=R;return i.index++,l}function Hr(n,i){return typeof i=="function"?i(n):i}function Yc(n){var i=Na();return Lf(i,aa,n)}function Lf(n,i,l){var c=n.queue;if(c===null)throw Error(s(311));c.lastRenderedReducer=l;var g=n.baseQueue,v=c.pending;if(v!==null){if(g!==null){var B=g.next;g.next=v.next,v.next=B}i.baseQueue=g=v,c.pending=null}if(v=n.baseState,g===null)n.memoizedState=v;else{i=g.next;var X=B=null,pe=null,Ee=i,We=!1;do{var Ze=Ee.lane&-536870913;if(Ze!==Ee.lane?(Dt&Ze)===Ze:($r&Ze)===Ze){var Re=Ee.revertLane;if(Re===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),Ze===Us&&(We=!0);else if(($r&Re)===Re){Ee=Ee.next,Re===Us&&(We=!0);continue}else Ze={lane:0,revertLane:Ee.revertLane,gesture:null,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(X=pe=Ze,B=v):pe=pe.next=Ze,wt.lanes|=Re,Ci|=Re;Ze=Ee.action,cs&&l(v,Ze),v=Ee.hasEagerState?Ee.eagerState:l(v,Ze)}else Re={lane:Ze,revertLane:Ee.revertLane,gesture:Ee.gesture,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(X=pe=Re,B=v):pe=pe.next=Re,wt.lanes|=Ze,Ci|=Ze;Ee=Ee.next}while(Ee!==null&&Ee!==i);if(pe===null?B=v:pe.next=X,!Fn(v,n.memoizedState)&&(Ba=!0,We&&(l=$s,l!==null)))throw l;n.memoizedState=v,n.baseState=B,n.baseQueue=pe,c.lastRenderedState=v}return g===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Mf(n){var i=Na(),l=i.queue;if(l===null)throw Error(s(311));l.lastRenderedReducer=n;var c=l.dispatch,g=l.pending,v=i.memoizedState;if(g!==null){l.pending=null;var B=g=g.next;do v=n(v,B.action),B=B.next;while(B!==g);Fn(v,i.memoizedState)||(Ba=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),l.lastRenderedState=v}return[v,c]}function Eg(n,i,l){var c=wt,g=Na(),v=Mt;if(v){if(l===void 0)throw Error(s(407));l=l()}else l=i();var B=!Fn((aa||g).memoizedState,l);if(B&&(g.memoizedState=l,Ba=!0),g=g.queue,Wf(Bg.bind(null,c,g,n),[n]),g.getSnapshot!==i||B||Ra!==null&&Ra.memoizedState.tag&1){if(c.flags|=2048,qs(9,{destroy:void 0},Rg.bind(null,c,g,l,i),null),la===null)throw Error(s(349));v||($r&127)!==0||Fg(c,i,l)}return l}function Fg(n,i,l){n.flags|=16384,n={getSnapshot:i,value:l},i=wt.updateQueue,i===null?(i=Kc(),wt.updateQueue=i,i.stores=[n]):(l=i.stores,l===null?i.stores=[n]:l.push(n))}function Rg(n,i,l,c){i.value=l,i.getSnapshot=c,Og(i)&&Dg(n)}function Bg(n,i,l){return l(function(){Og(i)&&Dg(n)})}function Og(n){var i=n.getSnapshot;n=n.value;try{var l=i();return!Fn(n,l)}catch{return!0}}function Dg(n){var i=es(n,2);i!==null&&Cn(i,n,2)}function If(n){var i=mn();if(typeof n=="function"){var l=n;if(n=l(),cs){et(!0);try{l()}finally{et(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:n},i}function Lg(n,i,l,c){return n.baseState=l,Lf(n,aa,typeof c=="function"?c:Hr)}function j_(n,i,l,c,g){if(Qc(n))throw Error(s(485));if(n=i.action,n!==null){var v={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(B){v.listeners.push(B)}};W.T!==null?l(!0):v.isTransition=!1,c(v),l=i.pending,l===null?(v.next=i.pending=v,Mg(i,v)):(v.next=l.next,i.pending=l.next=v)}}function Mg(n,i){var l=i.action,c=i.payload,g=n.state;if(i.isTransition){var v=W.T,B={};W.T=B;try{var X=l(g,c),pe=W.S;pe!==null&&pe(B,X),Ig(n,i,X)}catch(Ee){Pf(n,i,Ee)}finally{v!==null&&B.types!==null&&(v.types=B.types),W.T=v}}else try{v=l(g,c),Ig(n,i,v)}catch(Ee){Pf(n,i,Ee)}}function Ig(n,i,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){Pg(n,i,c)},function(c){return Pf(n,i,c)}):Pg(n,i,l)}function Pg(n,i,l){i.status="fulfilled",i.value=l,Wg(i),n.state=l,i=n.pending,i!==null&&(l=i.next,l===i?n.pending=null:(l=l.next,i.next=l,Mg(n,l)))}function Pf(n,i,l){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do i.status="rejected",i.reason=l,Wg(i),i=i.next;while(i!==c)}n.action=null}function Wg(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function Ug(n,i){return i}function $g(n,i){if(Mt){var l=la.formState;if(l!==null){e:{var c=wt;if(Mt){if(fa){t:{for(var g=fa,v=er;g.nodeType!==8;){if(!v){g=null;break t}if(g=ar(g.nextSibling),g===null){g=null;break t}}v=g.data,g=v==="F!"||v==="F"?g:null}if(g){fa=ar(g.nextSibling),c=g.data==="F!";break e}}yi(c)}c=!1}c&&(i=l[0])}}return l=mn(),l.memoizedState=l.baseState=i,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ug,lastRenderedState:i},l.queue=c,l=o0.bind(null,wt,c),c.dispatch=l,c=If(!1),v=Zf.bind(null,wt,!1,c.queue),c=mn(),g={state:i,dispatch:null,action:n,pending:null},c.queue=g,l=j_.bind(null,wt,g,v,l),g.dispatch=l,c.memoizedState=n,[i,l,!1]}function Hg(n){var i=Na();return Vg(i,aa,n)}function Vg(n,i,l){if(i=Lf(n,i,Ug)[0],n=Yc(Hr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var c=ao(i)}catch(B){throw B===Hs?Pc:B}else c=i;i=Na();var g=i.queue,v=g.dispatch;return l!==i.memoizedState&&(wt.flags|=2048,qs(9,{destroy:void 0},b_.bind(null,g,l),null)),[c,v,n]}function b_(n,i){n.action=i}function Zg(n){var i=Na(),l=aa;if(l!==null)return Vg(i,l,n);Na(),i=i.memoizedState,l=Na();var c=l.queue.dispatch;return l.memoizedState=n,[i,c,!1]}function qs(n,i,l,c){return n={tag:n,create:l,deps:c,inst:i,next:null},i=wt.updateQueue,i===null&&(i=Kc(),wt.updateQueue=i),l=i.lastEffect,l===null?i.lastEffect=n.next=n:(c=l.next,l.next=n,n.next=c,i.lastEffect=n),n}function Gg(){return Na().memoizedState}function Jc(n,i,l,c){var g=mn();wt.flags|=n,g.memoizedState=qs(1|i,{destroy:void 0},l,c===void 0?null:c)}function Xc(n,i,l,c){var g=Na();c=c===void 0?null:c;var v=g.memoizedState.inst;aa!==null&&c!==null&&Ef(c,aa.memoizedState.deps)?g.memoizedState=qs(i,v,l,c):(wt.flags|=n,g.memoizedState=qs(1|i,v,l,c))}function Kg(n,i){Jc(8390656,8,n,i)}function Wf(n,i){Xc(2048,8,n,i)}function __(n){wt.flags|=4;var i=wt.updateQueue;if(i===null)i=Kc(),wt.updateQueue=i,i.events=[n];else{var l=i.events;l===null?i.events=[n]:l.push(n)}}function qg(n){var i=Na().memoizedState;return __({ref:i,nextImpl:n}),function(){if((Ht&2)!==0)throw Error(s(440));return i.impl.apply(void 0,arguments)}}function Yg(n,i){return Xc(4,2,n,i)}function Jg(n,i){return Xc(4,4,n,i)}function Xg(n,i){if(typeof i=="function"){n=n();var l=i(n);return function(){typeof l=="function"?l():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Qg(n,i,l){l=l!=null?l.concat([n]):null,Xc(4,4,Xg.bind(null,i,n),l)}function Uf(){}function e0(n,i){var l=Na();i=i===void 0?null:i;var c=l.memoizedState;return i!==null&&Ef(i,c[1])?c[0]:(l.memoizedState=[n,i],n)}function t0(n,i){var l=Na();i=i===void 0?null:i;var c=l.memoizedState;if(i!==null&&Ef(i,c[1]))return c[0];if(c=n(),cs){et(!0);try{n()}finally{et(!1)}}return l.memoizedState=[c,i],c}function $f(n,i,l){return l===void 0||($r&1073741824)!==0&&(Dt&261930)===0?n.memoizedState=i:(n.memoizedState=l,n=ax(),wt.lanes|=n,Ci|=n,l)}function a0(n,i,l,c){return Fn(l,i)?l:Zs.current!==null?(n=$f(n,l,c),Fn(n,i)||(Ba=!0),n):($r&42)===0||($r&1073741824)!==0&&(Dt&261930)===0?(Ba=!0,n.memoizedState=l):(n=ax(),wt.lanes|=n,Ci|=n,i)}function n0(n,i,l,c,g){var v=J.p;J.p=v!==0&&8>v?v:8;var B=W.T,X={};W.T=X,Zf(n,!1,i,l);try{var pe=g(),Ee=W.S;if(Ee!==null&&Ee(X,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var We=x_(pe,c);no(n,i,We,Mn(n))}else no(n,i,c,Mn(n))}catch(Ze){no(n,i,{then:function(){},status:"rejected",reason:Ze},Mn())}finally{J.p=v,B!==null&&X.types!==null&&(B.types=X.types),W.T=B}}function S_(){}function Hf(n,i,l,c){if(n.tag!==5)throw Error(s(476));var g=r0(n).queue;n0(n,g,i,L,l===null?S_:function(){return i0(n),l(c)})}function r0(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:L},next:null};var l={};return i.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hr,lastRenderedState:l},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function i0(n){var i=r0(n);i.next===null&&(i=n.alternate.memoizedState),no(n,i.next.queue,{},Mn())}function Vf(){return Ya(bo)}function s0(){return Na().memoizedState}function l0(){return Na().memoizedState}function w_(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var l=Mn();n=bi(l);var c=_i(i,n,l);c!==null&&(Cn(c,i,l),Xl(c,i,l)),i={cache:jf()},n.payload=i;return}i=i.return}}function k_(n,i,l){var c=Mn();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Qc(n)?c0(i,l):(l=cf(n,i,l,c),l!==null&&(Cn(l,n,c),d0(l,i,c)))}function o0(n,i,l){var c=Mn();no(n,i,l,c)}function no(n,i,l,c){var g={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Qc(n))c0(i,g);else{var v=n.alternate;if(n.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var B=i.lastRenderedState,X=v(B,l);if(g.hasEagerState=!0,g.eagerState=X,Fn(X,B))return Rc(n,i,g,0),la===null&&Fc(),!1}catch{}if(l=cf(n,i,g,c),l!==null)return Cn(l,n,c),d0(l,i,c),!0}return!1}function Zf(n,i,l,c){if(c={lane:2,revertLane:wh(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Qc(n)){if(i)throw Error(s(479))}else i=cf(n,l,c,2),i!==null&&Cn(i,n,2)}function Qc(n){var i=n.alternate;return n===wt||i!==null&&i===wt}function c0(n,i){Gs=Zc=!0;var l=n.pending;l===null?i.next=i:(i.next=l.next,l.next=i),n.pending=i}function d0(n,i,l){if((l&4194048)!==0){var c=i.lanes;c&=n.pendingLanes,l|=c,i.lanes=l,Et(n,l)}}var ro={readContext:Ya,use:qc,useCallback:ba,useContext:ba,useEffect:ba,useImperativeHandle:ba,useLayoutEffect:ba,useInsertionEffect:ba,useMemo:ba,useReducer:ba,useRef:ba,useState:ba,useDebugValue:ba,useDeferredValue:ba,useTransition:ba,useSyncExternalStore:ba,useId:ba,useHostTransitionStatus:ba,useFormState:ba,useActionState:ba,useOptimistic:ba,useMemoCache:ba,useCacheRefresh:ba};ro.useEffectEvent=ba;var u0={readContext:Ya,use:qc,useCallback:function(n,i){return mn().memoizedState=[n,i===void 0?null:i],n},useContext:Ya,useEffect:Kg,useImperativeHandle:function(n,i,l){l=l!=null?l.concat([n]):null,Jc(4194308,4,Xg.bind(null,i,n),l)},useLayoutEffect:function(n,i){return Jc(4194308,4,n,i)},useInsertionEffect:function(n,i){Jc(4,2,n,i)},useMemo:function(n,i){var l=mn();i=i===void 0?null:i;var c=n();if(cs){et(!0);try{n()}finally{et(!1)}}return l.memoizedState=[c,i],c},useReducer:function(n,i,l){var c=mn();if(l!==void 0){var g=l(i);if(cs){et(!0);try{l(i)}finally{et(!1)}}}else g=i;return c.memoizedState=c.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},c.queue=n,n=n.dispatch=k_.bind(null,wt,n),[c.memoizedState,n]},useRef:function(n){var i=mn();return n={current:n},i.memoizedState=n},useState:function(n){n=If(n);var i=n.queue,l=o0.bind(null,wt,i);return i.dispatch=l,[n.memoizedState,l]},useDebugValue:Uf,useDeferredValue:function(n,i){var l=mn();return $f(l,n,i)},useTransition:function(){var n=If(!1);return n=n0.bind(null,wt,n.queue,!0,!1),mn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,l){var c=wt,g=mn();if(Mt){if(l===void 0)throw Error(s(407));l=l()}else{if(l=i(),la===null)throw Error(s(349));(Dt&127)!==0||Fg(c,i,l)}g.memoizedState=l;var v={value:l,getSnapshot:i};return g.queue=v,Kg(Bg.bind(null,c,v,n),[n]),c.flags|=2048,qs(9,{destroy:void 0},Rg.bind(null,c,v,l,i),null),l},useId:function(){var n=mn(),i=la.identifierPrefix;if(Mt){var l=Nr,c=Tr;l=(c&~(1<<32-it(c)-1)).toString(32)+l,i="_"+i+"R_"+l,l=Gc++,0<l&&(i+="H"+l.toString(32)),i+="_"}else l=y_++,i="_"+i+"r_"+l.toString(32)+"_";return n.memoizedState=i},useHostTransitionStatus:Vf,useFormState:$g,useActionState:$g,useOptimistic:function(n){var i=mn();i.memoizedState=i.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=l,i=Zf.bind(null,wt,!0,l),l.dispatch=i,[n,i]},useMemoCache:Df,useCacheRefresh:function(){return mn().memoizedState=w_.bind(null,wt)},useEffectEvent:function(n){var i=mn(),l={impl:n};return i.memoizedState=l,function(){if((Ht&2)!==0)throw Error(s(440));return l.impl.apply(void 0,arguments)}}},Gf={readContext:Ya,use:qc,useCallback:e0,useContext:Ya,useEffect:Wf,useImperativeHandle:Qg,useInsertionEffect:Yg,useLayoutEffect:Jg,useMemo:t0,useReducer:Yc,useRef:Gg,useState:function(){return Yc(Hr)},useDebugValue:Uf,useDeferredValue:function(n,i){var l=Na();return a0(l,aa.memoizedState,n,i)},useTransition:function(){var n=Yc(Hr)[0],i=Na().memoizedState;return[typeof n=="boolean"?n:ao(n),i]},useSyncExternalStore:Eg,useId:s0,useHostTransitionStatus:Vf,useFormState:Hg,useActionState:Hg,useOptimistic:function(n,i){var l=Na();return Lg(l,aa,n,i)},useMemoCache:Df,useCacheRefresh:l0};Gf.useEffectEvent=qg;var f0={readContext:Ya,use:qc,useCallback:e0,useContext:Ya,useEffect:Wf,useImperativeHandle:Qg,useInsertionEffect:Yg,useLayoutEffect:Jg,useMemo:t0,useReducer:Mf,useRef:Gg,useState:function(){return Mf(Hr)},useDebugValue:Uf,useDeferredValue:function(n,i){var l=Na();return aa===null?$f(l,n,i):a0(l,aa.memoizedState,n,i)},useTransition:function(){var n=Mf(Hr)[0],i=Na().memoizedState;return[typeof n=="boolean"?n:ao(n),i]},useSyncExternalStore:Eg,useId:s0,useHostTransitionStatus:Vf,useFormState:Zg,useActionState:Zg,useOptimistic:function(n,i){var l=Na();return aa!==null?Lg(l,aa,n,i):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Df,useCacheRefresh:l0};f0.useEffectEvent=qg;function Kf(n,i,l,c){i=n.memoizedState,l=l(c,i),l=l==null?i:j({},i,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var qf={enqueueSetState:function(n,i,l){n=n._reactInternals;var c=Mn(),g=bi(c);g.payload=i,l!=null&&(g.callback=l),i=_i(n,g,c),i!==null&&(Cn(i,n,c),Xl(i,n,c))},enqueueReplaceState:function(n,i,l){n=n._reactInternals;var c=Mn(),g=bi(c);g.tag=1,g.payload=i,l!=null&&(g.callback=l),i=_i(n,g,c),i!==null&&(Cn(i,n,c),Xl(i,n,c))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var l=Mn(),c=bi(l);c.tag=2,i!=null&&(c.callback=i),i=_i(n,c,l),i!==null&&(Cn(i,n,l),Xl(i,n,l))}};function h0(n,i,l,c,g,v,B){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,v,B):i.prototype&&i.prototype.isPureReactComponent?!Hl(l,c)||!Hl(g,v):!0}function m0(n,i,l,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,c),i.state!==n&&qf.enqueueReplaceState(i,i.state,null)}function ds(n,i){var l=i;if("ref"in i){l={};for(var c in i)c!=="ref"&&(l[c]=i[c])}if(n=n.defaultProps){l===i&&(l=j({},l));for(var g in n)l[g]===void 0&&(l[g]=n[g])}return l}function p0(n){Ec(n)}function g0(n){console.error(n)}function x0(n){Ec(n)}function ed(n,i){try{var l=n.onUncaughtError;l(i.value,{componentStack:i.stack})}catch(c){setTimeout(function(){throw c})}}function y0(n,i,l){try{var c=n.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Yf(n,i,l){return l=bi(l),l.tag=3,l.payload={element:null},l.callback=function(){ed(n,i)},l}function v0(n){return n=bi(n),n.tag=3,n}function j0(n,i,l,c){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=c.value;n.payload=function(){return g(v)},n.callback=function(){y0(i,l,c)}}var B=l.stateNode;B!==null&&typeof B.componentDidCatch=="function"&&(n.callback=function(){y0(i,l,c),typeof g!="function"&&(Ti===null?Ti=new Set([this]):Ti.add(this));var X=c.stack;this.componentDidCatch(c.value,{componentStack:X!==null?X:""})})}function z_(n,i,l,c,g){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(i=l.alternate,i!==null&&Ws(i,l,g,!0),l=Bn.current,l!==null){switch(l.tag){case 31:case 13:return tr===null?fd():l.alternate===null&&_a===0&&(_a=3),l.flags&=-257,l.flags|=65536,l.lanes=g,c===Wc?l.flags|=16384:(i=l.updateQueue,i===null?l.updateQueue=new Set([c]):i.add(c),bh(n,c,g)),!1;case 22:return l.flags|=65536,c===Wc?l.flags|=16384:(i=l.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=i):(l=i.retryQueue,l===null?i.retryQueue=new Set([c]):l.add(c)),bh(n,c,g)),!1}throw Error(s(435,l.tag))}return bh(n,c,g),fd(),!1}if(Mt)return i=Bn.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=g,c!==pf&&(n=Error(s(422),{cause:c}),Gl(Jn(n,l)))):(c!==pf&&(i=Error(s(423),{cause:c}),Gl(Jn(i,l))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,c=Jn(c,l),g=Yf(n.stateNode,c,g),zf(n,g),_a!==4&&(_a=2)),!1;var v=Error(s(520),{cause:c});if(v=Jn(v,l),ho===null?ho=[v]:ho.push(v),_a!==4&&(_a=2),i===null)return!0;c=Jn(c,l),l=i;do{switch(l.tag){case 3:return l.flags|=65536,n=g&-g,l.lanes|=n,n=Yf(l.stateNode,c,n),zf(l,n),!1;case 1:if(i=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ti===null||!Ti.has(v))))return l.flags|=65536,g&=-g,l.lanes|=g,g=v0(g),j0(g,n,l,c),zf(l,g),!1}l=l.return}while(l!==null);return!1}var Jf=Error(s(461)),Ba=!1;function Ja(n,i,l,c){i.child=n===null?wg(i,null,l,c):os(i,n.child,l,c)}function b0(n,i,l,c,g){l=l.render;var v=i.ref;if("ref"in c){var B={};for(var X in c)X!=="ref"&&(B[X]=c[X])}else B=c;return rs(i),c=Ff(n,i,l,B,v,g),X=Rf(),n!==null&&!Ba?(Bf(n,i,g),Vr(n,i,g)):(Mt&&X&&hf(i),i.flags|=1,Ja(n,i,c,g),i.child)}function _0(n,i,l,c,g){if(n===null){var v=l.type;return typeof v=="function"&&!df(v)&&v.defaultProps===void 0&&l.compare===null?(i.tag=15,i.type=v,S0(n,i,v,c,g)):(n=Oc(l.type,null,c,i,i.mode,g),n.ref=i.ref,n.return=i,i.child=n)}if(v=n.child,!ih(n,g)){var B=v.memoizedProps;if(l=l.compare,l=l!==null?l:Hl,l(B,c)&&n.ref===i.ref)return Vr(n,i,g)}return i.flags|=1,n=Ir(v,c),n.ref=i.ref,n.return=i,i.child=n}function S0(n,i,l,c,g){if(n!==null){var v=n.memoizedProps;if(Hl(v,c)&&n.ref===i.ref)if(Ba=!1,i.pendingProps=c=v,ih(n,g))(n.flags&131072)!==0&&(Ba=!0);else return i.lanes=n.lanes,Vr(n,i,g)}return Xf(n,i,l,c,g)}function w0(n,i,l,c){var g=c.children,v=n!==null?n.memoizedState:null;if(n===null&&i.stateNode===null&&(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((i.flags&128)!==0){if(v=v!==null?v.baseLanes|l:l,n!==null){for(c=i.child=n.child,g=0;c!==null;)g=g|c.lanes|c.childLanes,c=c.sibling;c=g&~v}else c=0,i.child=null;return k0(n,i,v,l,c)}if((l&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&Ic(i,v!==null?v.cachePool:null),v!==null?Cg(i,v):Tf(),Tg(i);else return c=i.lanes=536870912,k0(n,i,v!==null?v.baseLanes|l:l,l,c)}else v!==null?(Ic(i,v.cachePool),Cg(i,v),wi(),i.memoizedState=null):(n!==null&&Ic(i,null),Tf(),wi());return Ja(n,i,g,l),i.child}function io(n,i){return n!==null&&n.tag===22||i.stateNode!==null||(i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),i.sibling}function k0(n,i,l,c,g){var v=_f();return v=v===null?null:{parent:Fa._currentValue,pool:v},i.memoizedState={baseLanes:l,cachePool:v},n!==null&&Ic(i,null),Tf(),Tg(i),n!==null&&Ws(n,i,c,!0),i.childLanes=g,null}function td(n,i){return i=nd({mode:i.mode,children:i.children},n.mode),i.ref=n.ref,n.child=i,i.return=n,i}function z0(n,i,l){return os(i,n.child,null,l),n=td(i,i.pendingProps),n.flags|=2,On(i),i.memoizedState=null,n}function C_(n,i,l){var c=i.pendingProps,g=(i.flags&128)!==0;if(i.flags&=-129,n===null){if(Mt){if(c.mode==="hidden")return n=td(i,c),i.lanes=536870912,io(null,n);if(Af(i),(n=fa)?(n=Mx(n,er),n=n!==null&&n.data==="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:gi!==null?{id:Tr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=cg(n),l.return=i,i.child=l,qa=i,fa=null)):n=null,n===null)throw yi(i);return i.lanes=536870912,null}return td(i,c)}var v=n.memoizedState;if(v!==null){var B=v.dehydrated;if(Af(i),g)if(i.flags&256)i.flags&=-257,i=z0(n,i,l);else if(i.memoizedState!==null)i.child=n.child,i.flags|=128,i=null;else throw Error(s(558));else if(Ba||Ws(n,i,l,!1),g=(l&n.childLanes)!==0,Ba||g){if(c=la,c!==null&&(B=ge(c,l),B!==0&&B!==v.retryLane))throw v.retryLane=B,es(n,B),Cn(c,n,B),Jf;fd(),i=z0(n,i,l)}else n=v.treeContext,fa=ar(B.nextSibling),qa=i,Mt=!0,xi=null,er=!1,n!==null&&fg(i,n),i=td(i,c),i.flags|=4096;return i}return n=Ir(n.child,{mode:c.mode,children:c.children}),n.ref=i.ref,i.child=n,n.return=i,n}function ad(n,i){var l=i.ref;if(l===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(s(284));(n===null||n.ref!==l)&&(i.flags|=4194816)}}function Xf(n,i,l,c,g){return rs(i),l=Ff(n,i,l,c,void 0,g),c=Rf(),n!==null&&!Ba?(Bf(n,i,g),Vr(n,i,g)):(Mt&&c&&hf(i),i.flags|=1,Ja(n,i,l,g),i.child)}function C0(n,i,l,c,g,v){return rs(i),i.updateQueue=null,l=Ag(i,c,l,g),Ng(n),c=Rf(),n!==null&&!Ba?(Bf(n,i,v),Vr(n,i,v)):(Mt&&c&&hf(i),i.flags|=1,Ja(n,i,l,v),i.child)}function T0(n,i,l,c,g){if(rs(i),i.stateNode===null){var v=Ls,B=l.contextType;typeof B=="object"&&B!==null&&(v=Ya(B)),v=new l(c,v),i.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=qf,i.stateNode=v,v._reactInternals=i,v=i.stateNode,v.props=c,v.state=i.memoizedState,v.refs={},wf(i),B=l.contextType,v.context=typeof B=="object"&&B!==null?Ya(B):Ls,v.state=i.memoizedState,B=l.getDerivedStateFromProps,typeof B=="function"&&(Kf(i,l,B,c),v.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(B=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),B!==v.state&&qf.enqueueReplaceState(v,v.state,null),eo(i,c,v,g),Ql(),v.state=i.memoizedState),typeof v.componentDidMount=="function"&&(i.flags|=4194308),c=!0}else if(n===null){v=i.stateNode;var X=i.memoizedProps,pe=ds(l,X);v.props=pe;var Ee=v.context,We=l.contextType;B=Ls,typeof We=="object"&&We!==null&&(B=Ya(We));var Ze=l.getDerivedStateFromProps;We=typeof Ze=="function"||typeof v.getSnapshotBeforeUpdate=="function",X=i.pendingProps!==X,We||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(X||Ee!==B)&&m0(i,v,c,B),ji=!1;var Re=i.memoizedState;v.state=Re,eo(i,c,v,g),Ql(),Ee=i.memoizedState,X||Re!==Ee||ji?(typeof Ze=="function"&&(Kf(i,l,Ze,c),Ee=i.memoizedState),(pe=ji||h0(i,l,pe,c,Re,Ee,B))?(We||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(i.flags|=4194308)):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=Ee),v.props=c,v.state=Ee,v.context=B,c=pe):(typeof v.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{v=i.stateNode,kf(n,i),B=i.memoizedProps,We=ds(l,B),v.props=We,Ze=i.pendingProps,Re=v.context,Ee=l.contextType,pe=Ls,typeof Ee=="object"&&Ee!==null&&(pe=Ya(Ee)),X=l.getDerivedStateFromProps,(Ee=typeof X=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(B!==Ze||Re!==pe)&&m0(i,v,c,pe),ji=!1,Re=i.memoizedState,v.state=Re,eo(i,c,v,g),Ql();var Le=i.memoizedState;B!==Ze||Re!==Le||ji||n!==null&&n.dependencies!==null&&Lc(n.dependencies)?(typeof X=="function"&&(Kf(i,l,X,c),Le=i.memoizedState),(We=ji||h0(i,l,We,c,Re,Le,pe)||n!==null&&n.dependencies!==null&&Lc(n.dependencies))?(Ee||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,Le,pe),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,Le,pe)),typeof v.componentDidUpdate=="function"&&(i.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof v.componentDidUpdate!="function"||B===n.memoizedProps&&Re===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||B===n.memoizedProps&&Re===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=Le),v.props=c,v.state=Le,v.context=pe,c=We):(typeof v.componentDidUpdate!="function"||B===n.memoizedProps&&Re===n.memoizedState||(i.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||B===n.memoizedProps&&Re===n.memoizedState||(i.flags|=1024),c=!1)}return v=c,ad(n,i),c=(i.flags&128)!==0,v||c?(v=i.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:v.render(),i.flags|=1,n!==null&&c?(i.child=os(i,n.child,null,g),i.child=os(i,null,l,g)):Ja(n,i,l,g),i.memoizedState=v.state,n=i.child):n=Vr(n,i,g),n}function N0(n,i,l,c){return as(),i.flags|=256,Ja(n,i,l,c),i.child}var Qf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function eh(n){return{baseLanes:n,cachePool:yg()}}function th(n,i,l){return n=n!==null?n.childLanes&~l:0,i&&(n|=Ln),n}function A0(n,i,l){var c=i.pendingProps,g=!1,v=(i.flags&128)!==0,B;if((B=v)||(B=n!==null&&n.memoizedState===null?!1:(Ta.current&2)!==0),B&&(g=!0,i.flags&=-129),B=(i.flags&32)!==0,i.flags&=-33,n===null){if(Mt){if(g?Si(i):wi(),(n=fa)?(n=Mx(n,er),n=n!==null&&n.data!=="&"?n:null,n!==null&&(i.memoizedState={dehydrated:n,treeContext:gi!==null?{id:Tr,overflow:Nr}:null,retryLane:536870912,hydrationErrors:null},l=cg(n),l.return=i,i.child=l,qa=i,fa=null)):n=null,n===null)throw yi(i);return Lh(n)?i.lanes=32:i.lanes=536870912,null}var X=c.children;return c=c.fallback,g?(wi(),g=i.mode,X=nd({mode:"hidden",children:X},g),c=ts(c,g,l,null),X.return=i,c.return=i,X.sibling=c,i.child=X,c=i.child,c.memoizedState=eh(l),c.childLanes=th(n,B,l),i.memoizedState=Qf,io(null,c)):(Si(i),ah(i,X))}var pe=n.memoizedState;if(pe!==null&&(X=pe.dehydrated,X!==null)){if(v)i.flags&256?(Si(i),i.flags&=-257,i=nh(n,i,l)):i.memoizedState!==null?(wi(),i.child=n.child,i.flags|=128,i=null):(wi(),X=c.fallback,g=i.mode,c=nd({mode:"visible",children:c.children},g),X=ts(X,g,l,null),X.flags|=2,c.return=i,X.return=i,c.sibling=X,i.child=c,os(i,n.child,null,l),c=i.child,c.memoizedState=eh(l),c.childLanes=th(n,B,l),i.memoizedState=Qf,i=io(null,c));else if(Si(i),Lh(X)){if(B=X.nextSibling&&X.nextSibling.dataset,B)var Ee=B.dgst;B=Ee,c=Error(s(419)),c.stack="",c.digest=B,Gl({value:c,source:null,stack:null}),i=nh(n,i,l)}else if(Ba||Ws(n,i,l,!1),B=(l&n.childLanes)!==0,Ba||B){if(B=la,B!==null&&(c=ge(B,l),c!==0&&c!==pe.retryLane))throw pe.retryLane=c,es(n,c),Cn(B,n,c),Jf;Dh(X)||fd(),i=nh(n,i,l)}else Dh(X)?(i.flags|=192,i.child=n.child,i=null):(n=pe.treeContext,fa=ar(X.nextSibling),qa=i,Mt=!0,xi=null,er=!1,n!==null&&fg(i,n),i=ah(i,c.children),i.flags|=4096);return i}return g?(wi(),X=c.fallback,g=i.mode,pe=n.child,Ee=pe.sibling,c=Ir(pe,{mode:"hidden",children:c.children}),c.subtreeFlags=pe.subtreeFlags&65011712,Ee!==null?X=Ir(Ee,X):(X=ts(X,g,l,null),X.flags|=2),X.return=i,c.return=i,c.sibling=X,i.child=c,io(null,c),c=i.child,X=n.child.memoizedState,X===null?X=eh(l):(g=X.cachePool,g!==null?(pe=Fa._currentValue,g=g.parent!==pe?{parent:pe,pool:pe}:g):g=yg(),X={baseLanes:X.baseLanes|l,cachePool:g}),c.memoizedState=X,c.childLanes=th(n,B,l),i.memoizedState=Qf,io(n.child,c)):(Si(i),l=n.child,n=l.sibling,l=Ir(l,{mode:"visible",children:c.children}),l.return=i,l.sibling=null,n!==null&&(B=i.deletions,B===null?(i.deletions=[n],i.flags|=16):B.push(n)),i.child=l,i.memoizedState=null,l)}function ah(n,i){return i=nd({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function nd(n,i){return n=Rn(22,n,null,i),n.lanes=0,n}function nh(n,i,l){return os(i,n.child,null,l),n=ah(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function E0(n,i,l){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),yf(n.return,i,l)}function rh(n,i,l,c,g,v){var B=n.memoizedState;B===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:g,treeForkCount:v}:(B.isBackwards=i,B.rendering=null,B.renderingStartTime=0,B.last=c,B.tail=l,B.tailMode=g,B.treeForkCount=v)}function F0(n,i,l){var c=i.pendingProps,g=c.revealOrder,v=c.tail;c=c.children;var B=Ta.current,X=(B&2)!==0;if(X?(B=B&1|2,i.flags|=128):B&=1,z(Ta,B),Ja(n,i,c,l),c=Mt?Zl:0,!X&&n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&E0(n,l,i);else if(n.tag===19)E0(n,l,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(l=i.child,g=null;l!==null;)n=l.alternate,n!==null&&Vc(n)===null&&(g=l),l=l.sibling;l=g,l===null?(g=i.child,i.child=null):(g=l.sibling,l.sibling=null),rh(i,!1,g,l,v,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=i.child,i.child=null;g!==null;){if(n=g.alternate,n!==null&&Vc(n)===null){i.child=g;break}n=g.sibling,g.sibling=l,l=g,g=n}rh(i,!0,l,null,v,c);break;case"together":rh(i,!1,null,null,void 0,c);break;default:i.memoizedState=null}return i.child}function Vr(n,i,l){if(n!==null&&(i.dependencies=n.dependencies),Ci|=i.lanes,(l&i.childLanes)===0)if(n!==null){if(Ws(n,i,l,!1),(l&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(s(153));if(i.child!==null){for(n=i.child,l=Ir(n,n.pendingProps),i.child=l,l.return=i;n.sibling!==null;)n=n.sibling,l=l.sibling=Ir(n,n.pendingProps),l.return=i;l.sibling=null}return i.child}function ih(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&Lc(n)))}function T_(n,i,l){switch(i.tag){case 3:he(i,i.stateNode.containerInfo),vi(i,Fa,n.memoizedState.cache),as();break;case 27:case 5:ve(i);break;case 4:he(i,i.stateNode.containerInfo);break;case 10:vi(i,i.type,i.memoizedProps.value);break;case 31:if(i.memoizedState!==null)return i.flags|=128,Af(i),null;break;case 13:var c=i.memoizedState;if(c!==null)return c.dehydrated!==null?(Si(i),i.flags|=128,null):(l&i.child.childLanes)!==0?A0(n,i,l):(Si(i),n=Vr(n,i,l),n!==null?n.sibling:null);Si(i);break;case 19:var g=(n.flags&128)!==0;if(c=(l&i.childLanes)!==0,c||(Ws(n,i,l,!1),c=(l&i.childLanes)!==0),g){if(c)return F0(n,i,l);i.flags|=128}if(g=i.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),z(Ta,Ta.current),c)break;return null;case 22:return i.lanes=0,w0(n,i,l,i.pendingProps);case 24:vi(i,Fa,n.memoizedState.cache)}return Vr(n,i,l)}function R0(n,i,l){if(n!==null)if(n.memoizedProps!==i.pendingProps)Ba=!0;else{if(!ih(n,l)&&(i.flags&128)===0)return Ba=!1,T_(n,i,l);Ba=(n.flags&131072)!==0}else Ba=!1,Mt&&(i.flags&1048576)!==0&&ug(i,Zl,i.index);switch(i.lanes=0,i.tag){case 16:e:{var c=i.pendingProps;if(n=ss(i.elementType),i.type=n,typeof n=="function")df(n)?(c=ds(n,c),i.tag=1,i=T0(null,i,n,c,l)):(i.tag=0,i=Xf(null,i,n,c,l));else{if(n!=null){var g=n.$$typeof;if(g===O){i.tag=11,i=b0(null,i,n,c,l);break e}else if(g===M){i.tag=14,i=_0(null,i,n,c,l);break e}}throw i=ee(n)||n,Error(s(306,i,""))}}return i;case 0:return Xf(n,i,i.type,i.pendingProps,l);case 1:return c=i.type,g=ds(c,i.pendingProps),T0(n,i,c,g,l);case 3:e:{if(he(i,i.stateNode.containerInfo),n===null)throw Error(s(387));c=i.pendingProps;var v=i.memoizedState;g=v.element,kf(n,i),eo(i,c,null,l);var B=i.memoizedState;if(c=B.cache,vi(i,Fa,c),c!==v.cache&&vf(i,[Fa],l,!0),Ql(),c=B.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:B.cache},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){i=N0(n,i,c,l);break e}else if(c!==g){g=Jn(Error(s(424)),i),Gl(g),i=N0(n,i,c,l);break e}else for(n=i.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,fa=ar(n.firstChild),qa=i,Mt=!0,xi=null,er=!0,l=wg(i,null,c,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(as(),c===g){i=Vr(n,i,l);break e}Ja(n,i,c,l)}i=i.child}return i;case 26:return ad(n,i),n===null?(l=Hx(i.type,null,i.pendingProps,null))?i.memoizedState=l:Mt||(l=i.type,n=i.pendingProps,c=vd(D.current).createElement(l),c[ae]=i,c[re]=n,Xa(c,l,n),$e(c),i.stateNode=c):i.memoizedState=Hx(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return ve(i),n===null&&Mt&&(c=i.stateNode=Wx(i.type,i.pendingProps,D.current),qa=i,er=!0,g=fa,Fi(i.type)?(Mh=g,fa=ar(c.firstChild)):fa=g),Ja(n,i,i.pendingProps.children,l),ad(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&Mt&&((g=c=fa)&&(c=rS(c,i.type,i.pendingProps,er),c!==null?(i.stateNode=c,qa=i,fa=ar(c.firstChild),er=!1,g=!0):g=!1),g||yi(i)),ve(i),g=i.type,v=i.pendingProps,B=n!==null?n.memoizedProps:null,c=v.children,Rh(g,v)?c=null:B!==null&&Rh(g,B)&&(i.flags|=32),i.memoizedState!==null&&(g=Ff(n,i,v_,null,null,l),bo._currentValue=g),ad(n,i),Ja(n,i,c,l),i.child;case 6:return n===null&&Mt&&((n=l=fa)&&(l=iS(l,i.pendingProps,er),l!==null?(i.stateNode=l,qa=i,fa=null,n=!0):n=!1),n||yi(i)),null;case 13:return A0(n,i,l);case 4:return he(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=os(i,null,c,l):Ja(n,i,c,l),i.child;case 11:return b0(n,i,i.type,i.pendingProps,l);case 7:return Ja(n,i,i.pendingProps,l),i.child;case 8:return Ja(n,i,i.pendingProps.children,l),i.child;case 12:return Ja(n,i,i.pendingProps.children,l),i.child;case 10:return c=i.pendingProps,vi(i,i.type,c.value),Ja(n,i,c.children,l),i.child;case 9:return g=i.type._context,c=i.pendingProps.children,rs(i),g=Ya(g),c=c(g),i.flags|=1,Ja(n,i,c,l),i.child;case 14:return _0(n,i,i.type,i.pendingProps,l);case 15:return S0(n,i,i.type,i.pendingProps,l);case 19:return F0(n,i,l);case 31:return C_(n,i,l);case 22:return w0(n,i,l,i.pendingProps);case 24:return rs(i),c=Ya(Fa),n===null?(g=_f(),g===null&&(g=la,v=jf(),g.pooledCache=v,v.refCount++,v!==null&&(g.pooledCacheLanes|=l),g=v),i.memoizedState={parent:c,cache:g},wf(i),vi(i,Fa,g)):((n.lanes&l)!==0&&(kf(n,i),eo(i,null,null,l),Ql()),g=n.memoizedState,v=i.memoizedState,g.parent!==c?(g={parent:c,cache:c},i.memoizedState=g,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=g),vi(i,Fa,c)):(c=v.cache,vi(i,Fa,c),c!==g.cache&&vf(i,[Fa],l,!0))),Ja(n,i,i.pendingProps.children,l),i.child;case 29:throw i.pendingProps}throw Error(s(156,i.tag))}function Zr(n){n.flags|=4}function sh(n,i,l,c,g){if((i=(n.mode&32)!==0)&&(i=!1),i){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(sx())n.flags|=8192;else throw ls=Wc,Sf}else n.flags&=-16777217}function B0(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!qx(i))if(sx())n.flags|=8192;else throw ls=Wc,Sf}function rd(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?Oe():536870912,n.lanes|=i,Qs|=i)}function so(n,i){if(!Mt)switch(n.tailMode){case"hidden":i=n.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function ha(n){var i=n.alternate!==null&&n.alternate.child===n.child,l=0,c=0;if(i)for(var g=n.child;g!==null;)l|=g.lanes|g.childLanes,c|=g.subtreeFlags&65011712,c|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)l|=g.lanes|g.childLanes,c|=g.subtreeFlags,c|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=c,n.childLanes=l,i}function N_(n,i,l){var c=i.pendingProps;switch(mf(i),i.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ha(i),null;case 1:return ha(i),null;case 3:return l=i.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),Ur(Fa),ie(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Ps(i)?Zr(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,gf())),ha(i),null;case 26:var g=i.type,v=i.memoizedState;return n===null?(Zr(i),v!==null?(ha(i),B0(i,v)):(ha(i),sh(i,g,null,c,l))):v?v!==n.memoizedState?(Zr(i),ha(i),B0(i,v)):(ha(i),i.flags&=-16777217):(n=n.memoizedProps,n!==c&&Zr(i),ha(i),sh(i,g,n,c,l)),null;case 27:if(je(i),l=D.current,g=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&Zr(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return ha(i),null}n=k.current,Ps(i)?hg(i):(n=Wx(g,c,l),i.stateNode=n,Zr(i))}return ha(i),null;case 5:if(je(i),g=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==c&&Zr(i);else{if(!c){if(i.stateNode===null)throw Error(s(166));return ha(i),null}if(v=k.current,Ps(i))hg(i);else{var B=vd(D.current);switch(v){case 1:v=B.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:v=B.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":v=B.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":v=B.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":v=B.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?B.createElement("select",{is:c.is}):B.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?B.createElement(g,{is:c.is}):B.createElement(g)}}v[ae]=i,v[re]=c;e:for(B=i.child;B!==null;){if(B.tag===5||B.tag===6)v.appendChild(B.stateNode);else if(B.tag!==4&&B.tag!==27&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===i)break e;for(;B.sibling===null;){if(B.return===null||B.return===i)break e;B=B.return}B.sibling.return=B.return,B=B.sibling}i.stateNode=v;e:switch(Xa(v,g,c),g){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Zr(i)}}return ha(i),sh(i,i.type,n===null?null:n.memoizedProps,i.pendingProps,l),null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==c&&Zr(i);else{if(typeof c!="string"&&i.stateNode===null)throw Error(s(166));if(n=D.current,Ps(i)){if(n=i.stateNode,l=i.memoizedProps,c=null,g=qa,g!==null)switch(g.tag){case 27:case 5:c=g.memoizedProps}n[ae]=i,n=!!(n.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||Ax(n.nodeValue,l)),n||yi(i,!0)}else n=vd(n).createTextNode(c),n[ae]=i,i.stateNode=n}return ha(i),null;case 31:if(l=i.memoizedState,n===null||n.memoizedState!==null){if(c=Ps(i),l!==null){if(n===null){if(!c)throw Error(s(318));if(n=i.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(s(557));n[ae]=i}else as(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ha(i),n=!1}else l=gf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return i.flags&256?(On(i),i):(On(i),null);if((i.flags&128)!==0)throw Error(s(558))}return ha(i),null;case 13:if(c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=Ps(i),c!==null&&c.dehydrated!==null){if(n===null){if(!g)throw Error(s(318));if(g=i.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(s(317));g[ae]=i}else as(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;ha(i),g=!1}else g=gf(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return i.flags&256?(On(i),i):(On(i),null)}return On(i),(i.flags&128)!==0?(i.lanes=l,i):(l=c!==null,n=n!==null&&n.memoizedState!==null,l&&(c=i.child,g=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(g=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==g&&(c.flags|=2048)),l!==n&&l&&(i.child.flags|=8192),rd(i,i.updateQueue),ha(i),null);case 4:return ie(),n===null&&Th(i.stateNode.containerInfo),ha(i),null;case 10:return Ur(i.type),ha(i),null;case 19:if(T(Ta),c=i.memoizedState,c===null)return ha(i),null;if(g=(i.flags&128)!==0,v=c.rendering,v===null)if(g)so(c,!1);else{if(_a!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(v=Vc(n),v!==null){for(i.flags|=128,so(c,!1),n=v.updateQueue,i.updateQueue=n,rd(i,n),i.subtreeFlags=0,n=l,l=i.child;l!==null;)og(l,n),l=l.sibling;return z(Ta,Ta.current&1|2),Mt&&Pr(i,c.treeForkCount),i.child}n=n.sibling}c.tail!==null&&qe()>cd&&(i.flags|=128,g=!0,so(c,!1),i.lanes=4194304)}else{if(!g)if(n=Vc(v),n!==null){if(i.flags|=128,g=!0,n=n.updateQueue,i.updateQueue=n,rd(i,n),so(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!Mt)return ha(i),null}else 2*qe()-c.renderingStartTime>cd&&l!==536870912&&(i.flags|=128,g=!0,so(c,!1),i.lanes=4194304);c.isBackwards?(v.sibling=i.child,i.child=v):(n=c.last,n!==null?n.sibling=v:i.child=v,c.last=v)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=qe(),n.sibling=null,l=Ta.current,z(Ta,g?l&1|2:l&1),Mt&&Pr(i,c.treeForkCount),n):(ha(i),null);case 22:case 23:return On(i),Nf(),c=i.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(i.flags|=8192):c&&(i.flags|=8192),c?(l&536870912)!==0&&(i.flags&128)===0&&(ha(i),i.subtreeFlags&6&&(i.flags|=8192)):ha(i),l=i.updateQueue,l!==null&&rd(i,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),c=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),c!==l&&(i.flags|=2048),n!==null&&T(is),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),i.memoizedState.cache!==l&&(i.flags|=2048),Ur(Fa),ha(i),null;case 25:return null;case 30:return null}throw Error(s(156,i.tag))}function A_(n,i){switch(mf(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return Ur(Fa),ie(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return je(i),null;case 31:if(i.memoizedState!==null){if(On(i),i.alternate===null)throw Error(s(340));as()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 13:if(On(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(s(340));as()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return T(Ta),null;case 4:return ie(),null;case 10:return Ur(i.type),null;case 22:case 23:return On(i),Nf(),n!==null&&T(is),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return Ur(Fa),null;case 25:return null;default:return null}}function O0(n,i){switch(mf(i),i.tag){case 3:Ur(Fa),ie();break;case 26:case 27:case 5:je(i);break;case 4:ie();break;case 31:i.memoizedState!==null&&On(i);break;case 13:On(i);break;case 19:T(Ta);break;case 10:Ur(i.type);break;case 22:case 23:On(i),Nf(),n!==null&&T(is);break;case 24:Ur(Fa)}}function lo(n,i){try{var l=i.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var g=c.next;l=g;do{if((l.tag&n)===n){c=void 0;var v=l.create,B=l.inst;c=v(),B.destroy=c}l=l.next}while(l!==g)}}catch(X){Yt(i,i.return,X)}}function ki(n,i,l){try{var c=i.updateQueue,g=c!==null?c.lastEffect:null;if(g!==null){var v=g.next;c=v;do{if((c.tag&n)===n){var B=c.inst,X=B.destroy;if(X!==void 0){B.destroy=void 0,g=i;var pe=l,Ee=X;try{Ee()}catch(We){Yt(g,pe,We)}}}c=c.next}while(c!==v)}}catch(We){Yt(i,i.return,We)}}function D0(n){var i=n.updateQueue;if(i!==null){var l=n.stateNode;try{zg(i,l)}catch(c){Yt(n,n.return,c)}}}function L0(n,i,l){l.props=ds(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(c){Yt(n,i,c)}}function oo(n,i){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof l=="function"?n.refCleanup=l(c):l.current=c}}catch(g){Yt(n,i,g)}}function Ar(n,i){var l=n.ref,c=n.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(g){Yt(n,i,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){Yt(n,i,g)}else l.current=null}function M0(n){var i=n.type,l=n.memoizedProps,c=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(g){Yt(n,n.return,g)}}function lh(n,i,l){try{var c=n.stateNode;X_(c,n.type,l,i),c[re]=i}catch(g){Yt(n,n.return,g)}}function I0(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Fi(n.type)||n.tag===4}function oh(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||I0(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Fi(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ch(n,i,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,i):(i=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,i.appendChild(n),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=mr));else if(c!==4&&(c===27&&Fi(n.type)&&(l=n.stateNode,i=null),n=n.child,n!==null))for(ch(n,i,l),n=n.sibling;n!==null;)ch(n,i,l),n=n.sibling}function id(n,i,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?l.insertBefore(n,i):l.appendChild(n);else if(c!==4&&(c===27&&Fi(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(id(n,i,l),n=n.sibling;n!==null;)id(n,i,l),n=n.sibling}function P0(n){var i=n.stateNode,l=n.memoizedProps;try{for(var c=n.type,g=i.attributes;g.length;)i.removeAttributeNode(g[0]);Xa(i,c,l),i[ae]=n,i[re]=l}catch(v){Yt(n,n.return,v)}}var Gr=!1,Oa=!1,dh=!1,W0=typeof WeakSet=="function"?WeakSet:Set,Va=null;function E_(n,i){if(n=n.containerInfo,Eh=zd,n=Qp(n),af(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var g=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var B=0,X=-1,pe=-1,Ee=0,We=0,Ze=n,Re=null;t:for(;;){for(var Le;Ze!==l||g!==0&&Ze.nodeType!==3||(X=B+g),Ze!==v||c!==0&&Ze.nodeType!==3||(pe=B+c),Ze.nodeType===3&&(B+=Ze.nodeValue.length),(Le=Ze.firstChild)!==null;)Re=Ze,Ze=Le;for(;;){if(Ze===n)break t;if(Re===l&&++Ee===g&&(X=B),Re===v&&++We===c&&(pe=B),(Le=Ze.nextSibling)!==null)break;Ze=Re,Re=Ze.parentNode}Ze=Le}l=X===-1||pe===-1?null:{start:X,end:pe}}else l=null}l=l||{start:0,end:0}}else l=null;for(Fh={focusedElem:n,selectionRange:l},zd=!1,Va=i;Va!==null;)if(i=Va,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Va=n;else for(;Va!==null;){switch(i=Va,v=i.alternate,n=i.flags,i.tag){case 0:if((n&4)!==0&&(n=i.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)g=n[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&v!==null){n=void 0,l=i,g=v.memoizedProps,v=v.memoizedState,c=l.stateNode;try{var ot=ds(l.type,g);n=c.getSnapshotBeforeUpdate(ot,v),c.__reactInternalSnapshotBeforeUpdate=n}catch(pt){Yt(l,l.return,pt)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,l=n.nodeType,l===9)Oh(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Oh(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(s(163))}if(n=i.sibling,n!==null){n.return=i.return,Va=n;break}Va=i.return}}function U0(n,i,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:qr(n,l),c&4&&lo(5,l);break;case 1:if(qr(n,l),c&4)if(n=l.stateNode,i===null)try{n.componentDidMount()}catch(B){Yt(l,l.return,B)}else{var g=ds(l.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(g,i,n.__reactInternalSnapshotBeforeUpdate)}catch(B){Yt(l,l.return,B)}}c&64&&D0(l),c&512&&oo(l,l.return);break;case 3:if(qr(n,l),c&64&&(n=l.updateQueue,n!==null)){if(i=null,l.child!==null)switch(l.child.tag){case 27:case 5:i=l.child.stateNode;break;case 1:i=l.child.stateNode}try{zg(n,i)}catch(B){Yt(l,l.return,B)}}break;case 27:i===null&&c&4&&P0(l);case 26:case 5:qr(n,l),i===null&&c&4&&M0(l),c&512&&oo(l,l.return);break;case 12:qr(n,l);break;case 31:qr(n,l),c&4&&V0(n,l);break;case 13:qr(n,l),c&4&&Z0(n,l),c&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=P_.bind(null,l),sS(n,l))));break;case 22:if(c=l.memoizedState!==null||Gr,!c){i=i!==null&&i.memoizedState!==null||Oa,g=Gr;var v=Oa;Gr=c,(Oa=i)&&!v?Yr(n,l,(l.subtreeFlags&8772)!==0):qr(n,l),Gr=g,Oa=v}break;case 30:break;default:qr(n,l)}}function $0(n){var i=n.alternate;i!==null&&(n.alternate=null,$0(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&ue(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var xa=null,Sn=!1;function Kr(n,i,l){for(l=l.child;l!==null;)H0(n,i,l),l=l.sibling}function H0(n,i,l){if(ze&&typeof ze.onCommitFiberUnmount=="function")try{ze.onCommitFiberUnmount(ca,l)}catch{}switch(l.tag){case 26:Oa||Ar(l,i),Kr(n,i,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Oa||Ar(l,i);var c=xa,g=Sn;Fi(l.type)&&(xa=l.stateNode,Sn=!1),Kr(n,i,l),yo(l.stateNode),xa=c,Sn=g;break;case 5:Oa||Ar(l,i);case 6:if(c=xa,g=Sn,xa=null,Kr(n,i,l),xa=c,Sn=g,xa!==null)if(Sn)try{(xa.nodeType===9?xa.body:xa.nodeName==="HTML"?xa.ownerDocument.body:xa).removeChild(l.stateNode)}catch(v){Yt(l,i,v)}else try{xa.removeChild(l.stateNode)}catch(v){Yt(l,i,v)}break;case 18:xa!==null&&(Sn?(n=xa,Dx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),ll(n)):Dx(xa,l.stateNode));break;case 4:c=xa,g=Sn,xa=l.stateNode.containerInfo,Sn=!0,Kr(n,i,l),xa=c,Sn=g;break;case 0:case 11:case 14:case 15:ki(2,l,i),Oa||ki(4,l,i),Kr(n,i,l);break;case 1:Oa||(Ar(l,i),c=l.stateNode,typeof c.componentWillUnmount=="function"&&L0(l,i,c)),Kr(n,i,l);break;case 21:Kr(n,i,l);break;case 22:Oa=(c=Oa)||l.memoizedState!==null,Kr(n,i,l),Oa=c;break;default:Kr(n,i,l)}}function V0(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ll(n)}catch(l){Yt(i,i.return,l)}}}function Z0(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ll(n)}catch(l){Yt(i,i.return,l)}}function F_(n){switch(n.tag){case 31:case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new W0),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new W0),i;default:throw Error(s(435,n.tag))}}function sd(n,i){var l=F_(n);i.forEach(function(c){if(!l.has(c)){l.add(c);var g=W_.bind(null,n,c);c.then(g,g)}})}function wn(n,i){var l=i.deletions;if(l!==null)for(var c=0;c<l.length;c++){var g=l[c],v=n,B=i,X=B;e:for(;X!==null;){switch(X.tag){case 27:if(Fi(X.type)){xa=X.stateNode,Sn=!1;break e}break;case 5:xa=X.stateNode,Sn=!1;break e;case 3:case 4:xa=X.stateNode.containerInfo,Sn=!0;break e}X=X.return}if(xa===null)throw Error(s(160));H0(v,B,g),xa=null,Sn=!1,v=g.alternate,v!==null&&(v.return=null),g.return=null}if(i.subtreeFlags&13886)for(i=i.child;i!==null;)G0(i,n),i=i.sibling}var xr=null;function G0(n,i){var l=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:wn(i,n),kn(n),c&4&&(ki(3,n,n.return),lo(3,n),ki(5,n,n.return));break;case 1:wn(i,n),kn(n),c&512&&(Oa||l===null||Ar(l,l.return)),c&64&&Gr&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var g=xr;if(wn(i,n),kn(n),c&512&&(Oa||l===null||Ar(l,l.return)),c&4){var v=l!==null?l.memoizedState:null;if(c=n.memoizedState,l===null)if(c===null)if(n.stateNode===null){e:{c=n.type,l=n.memoizedProps,g=g.ownerDocument||g;t:switch(c){case"title":v=g.getElementsByTagName("title")[0],(!v||v[K]||v[ae]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=g.createElement(c),g.head.insertBefore(v,g.querySelector("head > title"))),Xa(v,c,l),v[ae]=n,$e(v),c=v;break e;case"link":var B=Gx("link","href",g).get(c+(l.href||""));if(B){for(var X=0;X<B.length;X++)if(v=B[X],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){B.splice(X,1);break t}}v=g.createElement(c),Xa(v,c,l),g.head.appendChild(v);break;case"meta":if(B=Gx("meta","content",g).get(c+(l.content||""))){for(X=0;X<B.length;X++)if(v=B[X],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){B.splice(X,1);break t}}v=g.createElement(c),Xa(v,c,l),g.head.appendChild(v);break;default:throw Error(s(468,c))}v[ae]=n,$e(v),c=v}n.stateNode=c}else Kx(g,n.type,n.stateNode);else n.stateNode=Zx(g,c,n.memoizedProps);else v!==c?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,c===null?Kx(g,n.type,n.stateNode):Zx(g,c,n.memoizedProps)):c===null&&n.stateNode!==null&&lh(n,n.memoizedProps,l.memoizedProps)}break;case 27:wn(i,n),kn(n),c&512&&(Oa||l===null||Ar(l,l.return)),l!==null&&c&4&&lh(n,n.memoizedProps,l.memoizedProps);break;case 5:if(wn(i,n),kn(n),c&512&&(Oa||l===null||Ar(l,l.return)),n.flags&32){g=n.stateNode;try{hr(g,"")}catch(ot){Yt(n,n.return,ot)}}c&4&&n.stateNode!=null&&(g=n.memoizedProps,lh(n,g,l!==null?l.memoizedProps:g)),c&1024&&(dh=!0);break;case 6:if(wn(i,n),kn(n),c&4){if(n.stateNode===null)throw Error(s(162));c=n.memoizedProps,l=n.stateNode;try{l.nodeValue=c}catch(ot){Yt(n,n.return,ot)}}break;case 3:if(_d=null,g=xr,xr=jd(i.containerInfo),wn(i,n),xr=g,kn(n),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ll(i.containerInfo)}catch(ot){Yt(n,n.return,ot)}dh&&(dh=!1,K0(n));break;case 4:c=xr,xr=jd(n.stateNode.containerInfo),wn(i,n),kn(n),xr=c;break;case 12:wn(i,n),kn(n);break;case 31:wn(i,n),kn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sd(n,c)));break;case 13:wn(i,n),kn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(od=qe()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sd(n,c)));break;case 22:g=n.memoizedState!==null;var pe=l!==null&&l.memoizedState!==null,Ee=Gr,We=Oa;if(Gr=Ee||g,Oa=We||pe,wn(i,n),Oa=We,Gr=Ee,kn(n),c&8192)e:for(i=n.stateNode,i._visibility=g?i._visibility&-2:i._visibility|1,g&&(l===null||pe||Gr||Oa||us(n)),l=null,i=n;;){if(i.tag===5||i.tag===26){if(l===null){pe=l=i;try{if(v=pe.stateNode,g)B=v.style,typeof B.setProperty=="function"?B.setProperty("display","none","important"):B.display="none";else{X=pe.stateNode;var Ze=pe.memoizedProps.style,Re=Ze!=null&&Ze.hasOwnProperty("display")?Ze.display:null;X.style.display=Re==null||typeof Re=="boolean"?"":(""+Re).trim()}}catch(ot){Yt(pe,pe.return,ot)}}}else if(i.tag===6){if(l===null){pe=i;try{pe.stateNode.nodeValue=g?"":pe.memoizedProps}catch(ot){Yt(pe,pe.return,ot)}}}else if(i.tag===18){if(l===null){pe=i;try{var Le=pe.stateNode;g?Lx(Le,!0):Lx(pe.stateNode,!1)}catch(ot){Yt(pe,pe.return,ot)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;l===i&&(l=null),i=i.return}l===i&&(l=null),i.sibling.return=i.return,i=i.sibling}c&4&&(c=n.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,sd(n,l))));break;case 19:wn(i,n),kn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,sd(n,c)));break;case 30:break;case 21:break;default:wn(i,n),kn(n)}}function kn(n){var i=n.flags;if(i&2){try{for(var l,c=n.return;c!==null;){if(I0(c)){l=c;break}c=c.return}if(l==null)throw Error(s(160));switch(l.tag){case 27:var g=l.stateNode,v=oh(n);id(n,v,g);break;case 5:var B=l.stateNode;l.flags&32&&(hr(B,""),l.flags&=-33);var X=oh(n);id(n,X,B);break;case 3:case 4:var pe=l.stateNode.containerInfo,Ee=oh(n);ch(n,Ee,pe);break;default:throw Error(s(161))}}catch(We){Yt(n,n.return,We)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function K0(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;K0(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function qr(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)U0(n,i.alternate,i),i=i.sibling}function us(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:ki(4,i,i.return),us(i);break;case 1:Ar(i,i.return);var l=i.stateNode;typeof l.componentWillUnmount=="function"&&L0(i,i.return,l),us(i);break;case 27:yo(i.stateNode);case 26:case 5:Ar(i,i.return),us(i);break;case 22:i.memoizedState===null&&us(i);break;case 30:us(i);break;default:us(i)}n=n.sibling}}function Yr(n,i,l){for(l=l&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var c=i.alternate,g=n,v=i,B=v.flags;switch(v.tag){case 0:case 11:case 15:Yr(g,v,l),lo(4,v);break;case 1:if(Yr(g,v,l),c=v,g=c.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Ee){Yt(c,c.return,Ee)}if(c=v,g=c.updateQueue,g!==null){var X=c.stateNode;try{var pe=g.shared.hiddenCallbacks;if(pe!==null)for(g.shared.hiddenCallbacks=null,g=0;g<pe.length;g++)kg(pe[g],X)}catch(Ee){Yt(c,c.return,Ee)}}l&&B&64&&D0(v),oo(v,v.return);break;case 27:P0(v);case 26:case 5:Yr(g,v,l),l&&c===null&&B&4&&M0(v),oo(v,v.return);break;case 12:Yr(g,v,l);break;case 31:Yr(g,v,l),l&&B&4&&V0(g,v);break;case 13:Yr(g,v,l),l&&B&4&&Z0(g,v);break;case 22:v.memoizedState===null&&Yr(g,v,l),oo(v,v.return);break;case 30:break;default:Yr(g,v,l)}i=i.sibling}}function uh(n,i){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&Kl(l))}function fh(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Kl(n))}function yr(n,i,l,c){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)q0(n,i,l,c),i=i.sibling}function q0(n,i,l,c){var g=i.flags;switch(i.tag){case 0:case 11:case 15:yr(n,i,l,c),g&2048&&lo(9,i);break;case 1:yr(n,i,l,c);break;case 3:yr(n,i,l,c),g&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&Kl(n)));break;case 12:if(g&2048){yr(n,i,l,c),n=i.stateNode;try{var v=i.memoizedProps,B=v.id,X=v.onPostCommit;typeof X=="function"&&X(B,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(pe){Yt(i,i.return,pe)}}else yr(n,i,l,c);break;case 31:yr(n,i,l,c);break;case 13:yr(n,i,l,c);break;case 23:break;case 22:v=i.stateNode,B=i.alternate,i.memoizedState!==null?v._visibility&2?yr(n,i,l,c):co(n,i):v._visibility&2?yr(n,i,l,c):(v._visibility|=2,Ys(n,i,l,c,(i.subtreeFlags&10256)!==0||!1)),g&2048&&uh(B,i);break;case 24:yr(n,i,l,c),g&2048&&fh(i.alternate,i);break;default:yr(n,i,l,c)}}function Ys(n,i,l,c,g){for(g=g&&((i.subtreeFlags&10256)!==0||!1),i=i.child;i!==null;){var v=n,B=i,X=l,pe=c,Ee=B.flags;switch(B.tag){case 0:case 11:case 15:Ys(v,B,X,pe,g),lo(8,B);break;case 23:break;case 22:var We=B.stateNode;B.memoizedState!==null?We._visibility&2?Ys(v,B,X,pe,g):co(v,B):(We._visibility|=2,Ys(v,B,X,pe,g)),g&&Ee&2048&&uh(B.alternate,B);break;case 24:Ys(v,B,X,pe,g),g&&Ee&2048&&fh(B.alternate,B);break;default:Ys(v,B,X,pe,g)}i=i.sibling}}function co(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var l=n,c=i,g=c.flags;switch(c.tag){case 22:co(l,c),g&2048&&uh(c.alternate,c);break;case 24:co(l,c),g&2048&&fh(c.alternate,c);break;default:co(l,c)}i=i.sibling}}var uo=8192;function Js(n,i,l){if(n.subtreeFlags&uo)for(n=n.child;n!==null;)Y0(n,i,l),n=n.sibling}function Y0(n,i,l){switch(n.tag){case 26:Js(n,i,l),n.flags&uo&&n.memoizedState!==null&&yS(l,xr,n.memoizedState,n.memoizedProps);break;case 5:Js(n,i,l);break;case 3:case 4:var c=xr;xr=jd(n.stateNode.containerInfo),Js(n,i,l),xr=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=uo,uo=16777216,Js(n,i,l),uo=c):Js(n,i,l));break;default:Js(n,i,l)}}function J0(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function fo(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var c=i[l];Va=c,Q0(c,n)}J0(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)X0(n),n=n.sibling}function X0(n){switch(n.tag){case 0:case 11:case 15:fo(n),n.flags&2048&&ki(9,n,n.return);break;case 3:fo(n);break;case 12:fo(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,ld(n)):fo(n);break;default:fo(n)}}function ld(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var l=0;l<i.length;l++){var c=i[l];Va=c,Q0(c,n)}J0(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:ki(8,i,i.return),ld(i);break;case 22:l=i.stateNode,l._visibility&2&&(l._visibility&=-3,ld(i));break;default:ld(i)}n=n.sibling}}function Q0(n,i){for(;Va!==null;){var l=Va;switch(l.tag){case 0:case 11:case 15:ki(8,l,i);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Kl(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Va=c;else e:for(l=n;Va!==null;){c=Va;var g=c.sibling,v=c.return;if($0(c),c===l){Va=null;break e}if(g!==null){g.return=v,Va=g;break e}Va=v}}}var R_={getCacheForType:function(n){var i=Ya(Fa),l=i.data.get(n);return l===void 0&&(l=n(),i.data.set(n,l)),l},cacheSignal:function(){return Ya(Fa).controller.signal}},B_=typeof WeakMap=="function"?WeakMap:Map,Ht=0,la=null,Rt=null,Dt=0,qt=0,Dn=null,zi=!1,Xs=!1,hh=!1,Jr=0,_a=0,Ci=0,fs=0,mh=0,Ln=0,Qs=0,ho=null,zn=null,ph=!1,od=0,ex=0,cd=1/0,dd=null,Ti=null,Wa=0,Ni=null,el=null,Xr=0,gh=0,xh=null,tx=null,mo=0,yh=null;function Mn(){return(Ht&2)!==0&&Dt!==0?Dt&-Dt:W.T!==null?wh():Y()}function ax(){if(Ln===0)if((Dt&536870912)===0||Mt){var n=ta;ta<<=1,(ta&3932160)===0&&(ta=262144),Ln=n}else Ln=536870912;return n=Bn.current,n!==null&&(n.flags|=32),Ln}function Cn(n,i,l){(n===la&&(qt===2||qt===9)||n.cancelPendingCommit!==null)&&(tl(n,0),Ai(n,Dt,Ln,!1)),At(n,l),((Ht&2)===0||n!==la)&&(n===la&&((Ht&2)===0&&(fs|=l),_a===4&&Ai(n,Dt,Ln,!1)),Er(n))}function nx(n,i,l){if((Ht&6)!==0)throw Error(s(327));var c=!l&&(i&127)===0&&(i&n.expiredLanes)===0||Ie(n,i),g=c?L_(n,i):jh(n,i,!0),v=c;do{if(g===0){Xs&&!c&&Ai(n,i,0,!1);break}else{if(l=n.current.alternate,v&&!O_(l)){g=jh(n,i,!1),v=!1;continue}if(g===2){if(v=i,n.errorRecoveryDisabledLanes&v)var B=0;else B=n.pendingLanes&-536870913,B=B!==0?B:B&536870912?536870912:0;if(B!==0){i=B;e:{var X=n;g=ho;var pe=X.current.memoizedState.isDehydrated;if(pe&&(tl(X,B).flags|=256),B=jh(X,B,!1),B!==2){if(hh&&!pe){X.errorRecoveryDisabledLanes|=v,fs|=v,g=4;break e}v=zn,zn=g,v!==null&&(zn===null?zn=v:zn.push.apply(zn,v))}g=B}if(v=!1,g!==2)continue}}if(g===1){tl(n,0),Ai(n,i,0,!0);break}e:{switch(c=n,v=g,v){case 0:case 1:throw Error(s(345));case 4:if((i&4194048)!==i)break;case 6:Ai(c,i,Ln,!zi);break e;case 2:zn=null;break;case 3:case 5:break;default:throw Error(s(329))}if((i&62914560)===i&&(g=od+300-qe(),10<g)){if(Ai(c,i,Ln,!zi),xe(c,0,!0)!==0)break e;Xr=i,c.timeoutHandle=Bx(rx.bind(null,c,l,zn,dd,ph,i,Ln,fs,Qs,zi,v,"Throttled",-0,0),g);break e}rx(c,l,zn,dd,ph,i,Ln,fs,Qs,zi,v,null,-0,0)}}break}while(!0);Er(n)}function rx(n,i,l,c,g,v,B,X,pe,Ee,We,Ze,Re,Le){if(n.timeoutHandle=-1,Ze=i.subtreeFlags,Ze&8192||(Ze&16785408)===16785408){Ze={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:mr},Y0(i,v,Ze);var ot=(v&62914560)===v?od-qe():(v&4194048)===v?ex-qe():0;if(ot=vS(Ze,ot),ot!==null){Xr=v,n.cancelPendingCommit=ot(fx.bind(null,n,i,v,l,c,g,B,X,pe,We,Ze,null,Re,Le)),Ai(n,v,B,!Ee);return}}fx(n,i,v,l,c,g,B,X,pe)}function O_(n){for(var i=n;;){var l=i.tag;if((l===0||l===11||l===15)&&i.flags&16384&&(l=i.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var g=l[c],v=g.getSnapshot;g=g.value;try{if(!Fn(v(),g))return!1}catch{return!1}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ai(n,i,l,c){i&=~mh,i&=~fs,n.suspendedLanes|=i,n.pingedLanes&=~i,c&&(n.warmLanes|=i),c=n.expirationTimes;for(var g=i;0<g;){var v=31-it(g),B=1<<v;c[v]=-1,g&=~B}l!==0&&ja(n,l,i)}function ud(){return(Ht&6)===0?(po(0),!1):!0}function vh(){if(Rt!==null){if(qt===0)var n=Rt.return;else n=Rt,Wr=ns=null,Of(n),Vs=null,Yl=0,n=Rt;for(;n!==null;)O0(n.alternate,n),n=n.return;Rt=null}}function tl(n,i){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,tS(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Xr=0,vh(),la=n,Rt=l=Ir(n.current,null),Dt=i,qt=0,Dn=null,zi=!1,Xs=Ie(n,i),hh=!1,Qs=Ln=mh=fs=Ci=_a=0,zn=ho=null,ph=!1,(i&8)!==0&&(i|=i&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=i;0<c;){var g=31-it(c),v=1<<g;i|=n[g],c&=~v}return Jr=i,Fc(),l}function ix(n,i){wt=null,W.H=ro,i===Hs||i===Pc?(i=bg(),qt=3):i===Sf?(i=bg(),qt=4):qt=i===Jf?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Dn=i,Rt===null&&(_a=1,ed(n,Jn(i,n.current)))}function sx(){var n=Bn.current;return n===null?!0:(Dt&4194048)===Dt?tr===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?n===tr:!1}function lx(){var n=W.H;return W.H=ro,n===null?ro:n}function ox(){var n=W.A;return W.A=R_,n}function fd(){_a=4,zi||(Dt&4194048)!==Dt&&Bn.current!==null||(Xs=!0),(Ci&134217727)===0&&(fs&134217727)===0||la===null||Ai(la,Dt,Ln,!1)}function jh(n,i,l){var c=Ht;Ht|=2;var g=lx(),v=ox();(la!==n||Dt!==i)&&(dd=null,tl(n,i)),i=!1;var B=_a;e:do try{if(qt!==0&&Rt!==null){var X=Rt,pe=Dn;switch(qt){case 8:vh(),B=6;break e;case 3:case 2:case 9:case 6:Bn.current===null&&(i=!0);var Ee=qt;if(qt=0,Dn=null,al(n,X,pe,Ee),l&&Xs){B=0;break e}break;default:Ee=qt,qt=0,Dn=null,al(n,X,pe,Ee)}}D_(),B=_a;break}catch(We){ix(n,We)}while(!0);return i&&n.shellSuspendCounter++,Wr=ns=null,Ht=c,W.H=g,W.A=v,Rt===null&&(la=null,Dt=0,Fc()),B}function D_(){for(;Rt!==null;)cx(Rt)}function L_(n,i){var l=Ht;Ht|=2;var c=lx(),g=ox();la!==n||Dt!==i?(dd=null,cd=qe()+500,tl(n,i)):Xs=Ie(n,i);e:do try{if(qt!==0&&Rt!==null){i=Rt;var v=Dn;t:switch(qt){case 1:qt=0,Dn=null,al(n,i,v,1);break;case 2:case 9:if(vg(v)){qt=0,Dn=null,dx(i);break}i=function(){qt!==2&&qt!==9||la!==n||(qt=7),Er(n)},v.then(i,i);break e;case 3:qt=7;break e;case 4:qt=5;break e;case 7:vg(v)?(qt=0,Dn=null,dx(i)):(qt=0,Dn=null,al(n,i,v,7));break;case 5:var B=null;switch(Rt.tag){case 26:B=Rt.memoizedState;case 5:case 27:var X=Rt;if(B?qx(B):X.stateNode.complete){qt=0,Dn=null;var pe=X.sibling;if(pe!==null)Rt=pe;else{var Ee=X.return;Ee!==null?(Rt=Ee,hd(Ee)):Rt=null}break t}}qt=0,Dn=null,al(n,i,v,5);break;case 6:qt=0,Dn=null,al(n,i,v,6);break;case 8:vh(),_a=6;break e;default:throw Error(s(462))}}M_();break}catch(We){ix(n,We)}while(!0);return Wr=ns=null,W.H=c,W.A=g,Ht=l,Rt!==null?0:(la=null,Dt=0,Fc(),_a)}function M_(){for(;Rt!==null&&!ht();)cx(Rt)}function cx(n){var i=R0(n.alternate,n,Jr);n.memoizedProps=n.pendingProps,i===null?hd(n):Rt=i}function dx(n){var i=n,l=i.alternate;switch(i.tag){case 15:case 0:i=C0(l,i,i.pendingProps,i.type,void 0,Dt);break;case 11:i=C0(l,i,i.pendingProps,i.type.render,i.ref,Dt);break;case 5:Of(i);default:O0(l,i),i=Rt=og(i,Jr),i=R0(l,i,Jr)}n.memoizedProps=n.pendingProps,i===null?hd(n):Rt=i}function al(n,i,l,c){Wr=ns=null,Of(i),Vs=null,Yl=0;var g=i.return;try{if(z_(n,g,i,l,Dt)){_a=1,ed(n,Jn(l,n.current)),Rt=null;return}}catch(v){if(g!==null)throw Rt=g,v;_a=1,ed(n,Jn(l,n.current)),Rt=null;return}i.flags&32768?(Mt||c===1?n=!0:Xs||(Dt&536870912)!==0?n=!1:(zi=n=!0,(c===2||c===9||c===3||c===6)&&(c=Bn.current,c!==null&&c.tag===13&&(c.flags|=16384))),ux(i,n)):hd(i)}function hd(n){var i=n;do{if((i.flags&32768)!==0){ux(i,zi);return}n=i.return;var l=N_(i.alternate,i,Jr);if(l!==null){Rt=l;return}if(i=i.sibling,i!==null){Rt=i;return}Rt=i=n}while(i!==null);_a===0&&(_a=5)}function ux(n,i){do{var l=A_(n.alternate,n);if(l!==null){l.flags&=32767,Rt=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!i&&(n=n.sibling,n!==null)){Rt=n;return}Rt=n=l}while(n!==null);_a=6,Rt=null}function fx(n,i,l,c,g,v,B,X,pe){n.cancelPendingCommit=null;do md();while(Wa!==0);if((Ht&6)!==0)throw Error(s(327));if(i!==null){if(i===n.current)throw Error(s(177));if(v=i.lanes|i.childLanes,v|=of,za(n,l,v,B,X,pe),n===la&&(Rt=la=null,Dt=0),el=i,Ni=n,Xr=l,gh=v,xh=g,tx=c,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,U_(zt,function(){return xx(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||c){c=W.T,W.T=null,g=J.p,J.p=2,B=Ht,Ht|=4;try{E_(n,i,l)}finally{Ht=B,J.p=g,W.T=c}}Wa=1,hx(),mx(),px()}}function hx(){if(Wa===1){Wa=0;var n=Ni,i=el,l=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||l){l=W.T,W.T=null;var c=J.p;J.p=2;var g=Ht;Ht|=4;try{G0(i,n);var v=Fh,B=Qp(n.containerInfo),X=v.focusedElem,pe=v.selectionRange;if(B!==X&&X&&X.ownerDocument&&Xp(X.ownerDocument.documentElement,X)){if(pe!==null&&af(X)){var Ee=pe.start,We=pe.end;if(We===void 0&&(We=Ee),"selectionStart"in X)X.selectionStart=Ee,X.selectionEnd=Math.min(We,X.value.length);else{var Ze=X.ownerDocument||document,Re=Ze&&Ze.defaultView||window;if(Re.getSelection){var Le=Re.getSelection(),ot=X.textContent.length,pt=Math.min(pe.start,ot),ra=pe.end===void 0?pt:Math.min(pe.end,ot);!Le.extend&&pt>ra&&(B=ra,ra=pt,pt=B);var we=Jp(X,pt),ye=Jp(X,ra);if(we&&ye&&(Le.rangeCount!==1||Le.anchorNode!==we.node||Le.anchorOffset!==we.offset||Le.focusNode!==ye.node||Le.focusOffset!==ye.offset)){var Ae=Ze.createRange();Ae.setStart(we.node,we.offset),Le.removeAllRanges(),pt>ra?(Le.addRange(Ae),Le.extend(ye.node,ye.offset)):(Ae.setEnd(ye.node,ye.offset),Le.addRange(Ae))}}}}for(Ze=[],Le=X;Le=Le.parentNode;)Le.nodeType===1&&Ze.push({element:Le,left:Le.scrollLeft,top:Le.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Ze.length;X++){var He=Ze[X];He.element.scrollLeft=He.left,He.element.scrollTop=He.top}}zd=!!Eh,Fh=Eh=null}finally{Ht=g,J.p=c,W.T=l}}n.current=i,Wa=2}}function mx(){if(Wa===2){Wa=0;var n=Ni,i=el,l=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||l){l=W.T,W.T=null;var c=J.p;J.p=2;var g=Ht;Ht|=4;try{U0(n,i.alternate,i)}finally{Ht=g,J.p=c,W.T=l}}Wa=3}}function px(){if(Wa===4||Wa===3){Wa=0,xt();var n=Ni,i=el,l=Xr,c=tx;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?Wa=5:(Wa=0,el=Ni=null,gx(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(Ti=null),ga(l),i=i.stateNode,ze&&typeof ze.onCommitFiberRoot=="function")try{ze.onCommitFiberRoot(ca,i,void 0,(i.current.flags&128)===128)}catch{}if(c!==null){i=W.T,g=J.p,J.p=2,W.T=null;try{for(var v=n.onRecoverableError,B=0;B<c.length;B++){var X=c[B];v(X.value,{componentStack:X.stack})}}finally{W.T=i,J.p=g}}(Xr&3)!==0&&md(),Er(n),g=n.pendingLanes,(l&261930)!==0&&(g&42)!==0?n===yh?mo++:(mo=0,yh=n):mo=0,po(0)}}function gx(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,Kl(i)))}function md(){return hx(),mx(),px(),xx()}function xx(){if(Wa!==5)return!1;var n=Ni,i=gh;gh=0;var l=ga(Xr),c=W.T,g=J.p;try{J.p=32>l?32:l,W.T=null,l=xh,xh=null;var v=Ni,B=Xr;if(Wa=0,el=Ni=null,Xr=0,(Ht&6)!==0)throw Error(s(331));var X=Ht;if(Ht|=4,X0(v.current),q0(v,v.current,B,l),Ht=X,po(0,!1),ze&&typeof ze.onPostCommitFiberRoot=="function")try{ze.onPostCommitFiberRoot(ca,v)}catch{}return!0}finally{J.p=g,W.T=c,gx(n,i)}}function yx(n,i,l){i=Jn(l,i),i=Yf(n.stateNode,i,2),n=_i(n,i,2),n!==null&&(At(n,2),Er(n))}function Yt(n,i,l){if(n.tag===3)yx(n,n,l);else for(;i!==null;){if(i.tag===3){yx(i,n,l);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ti===null||!Ti.has(c))){n=Jn(l,n),l=v0(2),c=_i(i,l,2),c!==null&&(j0(l,c,i,n),At(c,2),Er(c));break}}i=i.return}}function bh(n,i,l){var c=n.pingCache;if(c===null){c=n.pingCache=new B_;var g=new Set;c.set(i,g)}else g=c.get(i),g===void 0&&(g=new Set,c.set(i,g));g.has(l)||(hh=!0,g.add(l),n=I_.bind(null,n,i,l),i.then(n,n))}function I_(n,i,l){var c=n.pingCache;c!==null&&c.delete(i),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,la===n&&(Dt&l)===l&&(_a===4||_a===3&&(Dt&62914560)===Dt&&300>qe()-od?(Ht&2)===0&&tl(n,0):mh|=l,Qs===Dt&&(Qs=0)),Er(n)}function vx(n,i){i===0&&(i=Oe()),n=es(n,i),n!==null&&(At(n,i),Er(n))}function P_(n){var i=n.memoizedState,l=0;i!==null&&(l=i.retryLane),vx(n,l)}function W_(n,i){var l=0;switch(n.tag){case 31:case 13:var c=n.stateNode,g=n.memoizedState;g!==null&&(l=g.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(s(314))}c!==null&&c.delete(i),vx(n,l)}function U_(n,i){return lt(n,i)}var pd=null,nl=null,_h=!1,gd=!1,Sh=!1,Ei=0;function Er(n){n!==nl&&n.next===null&&(nl===null?pd=nl=n:nl=nl.next=n),gd=!0,_h||(_h=!0,H_())}function po(n,i){if(!Sh&&gd){Sh=!0;do for(var l=!1,c=pd;c!==null;){if(n!==0){var g=c.pendingLanes;if(g===0)var v=0;else{var B=c.suspendedLanes,X=c.pingedLanes;v=(1<<31-it(42|n)+1)-1,v&=g&~(B&~X),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,Sx(c,v))}else v=Dt,v=xe(c,c===la?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||Ie(c,v)||(l=!0,Sx(c,v));c=c.next}while(l);Sh=!1}}function $_(){jx()}function jx(){gd=_h=!1;var n=0;Ei!==0&&eS()&&(n=Ei);for(var i=qe(),l=null,c=pd;c!==null;){var g=c.next,v=bx(c,i);v===0?(c.next=null,l===null?pd=g:l.next=g,g===null&&(nl=l)):(l=c,(n!==0||(v&3)!==0)&&(gd=!0)),c=g}Wa!==0&&Wa!==5||po(n),Ei!==0&&(Ei=0)}function bx(n,i){for(var l=n.suspendedLanes,c=n.pingedLanes,g=n.expirationTimes,v=n.pendingLanes&-62914561;0<v;){var B=31-it(v),X=1<<B,pe=g[B];pe===-1?((X&l)===0||(X&c)!==0)&&(g[B]=mt(X,i)):pe<=i&&(n.expiredLanes|=X),v&=~X}if(i=la,l=Dt,l=xe(n,n===i?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,l===0||n===i&&(qt===2||qt===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&tt(c),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Ie(n,l)){if(i=l&-l,i===n.callbackPriority)return i;switch(c!==null&&tt(c),ga(l)){case 2:case 8:l=_t;break;case 32:l=zt;break;case 268435456:l=va;break;default:l=zt}return c=_x.bind(null,n),l=lt(l,c),n.callbackPriority=i,n.callbackNode=l,i}return c!==null&&c!==null&&tt(c),n.callbackPriority=2,n.callbackNode=null,2}function _x(n,i){if(Wa!==0&&Wa!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(md()&&n.callbackNode!==l)return null;var c=Dt;return c=xe(n,n===la?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(nx(n,c,i),bx(n,qe()),n.callbackNode!=null&&n.callbackNode===l?_x.bind(null,n):null)}function Sx(n,i){if(md())return null;nx(n,i,!0)}function H_(){aS(function(){(Ht&6)!==0?lt(st,$_):jx()})}function wh(){if(Ei===0){var n=Us;n===0&&(n=ut,ut<<=1,(ut&261888)===0&&(ut=256)),Ei=n}return Ei}function wx(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:As(""+n)}function kx(n,i){var l=i.ownerDocument.createElement("input");return l.name=i.name,l.value=i.value,n.id&&l.setAttribute("form",n.id),i.parentNode.insertBefore(l,i),n=new FormData(n),l.parentNode.removeChild(l),n}function V_(n,i,l,c,g){if(i==="submit"&&l&&l.stateNode===g){var v=wx((g[re]||null).action),B=c.submitter;B&&(i=(i=B[re]||null)?wx(i.formAction):B.getAttribute("formAction"),i!==null&&(v=i,B=null));var X=new Tc("action","action",null,c,g);n.push({event:X,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ei!==0){var pe=B?kx(g,B):new FormData(g);Hf(l,{pending:!0,data:pe,method:g.method,action:v},null,pe)}}else typeof v=="function"&&(X.preventDefault(),pe=B?kx(g,B):new FormData(g),Hf(l,{pending:!0,data:pe,method:g.method,action:v},v,pe))},currentTarget:g}]})}}for(var kh=0;kh<lf.length;kh++){var zh=lf[kh],Z_=zh.toLowerCase(),G_=zh[0].toUpperCase()+zh.slice(1);gr(Z_,"on"+G_)}gr(ag,"onAnimationEnd"),gr(ng,"onAnimationIteration"),gr(rg,"onAnimationStart"),gr("dblclick","onDoubleClick"),gr("focusin","onFocus"),gr("focusout","onBlur"),gr(c_,"onTransitionRun"),gr(d_,"onTransitionStart"),gr(u_,"onTransitionCancel"),gr(ig,"onTransitionEnd"),cn("onMouseEnter",["mouseout","mouseover"]),cn("onMouseLeave",["mouseout","mouseover"]),cn("onPointerEnter",["pointerout","pointerover"]),cn("onPointerLeave",["pointerout","pointerover"]),Kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K_=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(go));function zx(n,i){i=(i&4)!==0;for(var l=0;l<n.length;l++){var c=n[l],g=c.event;c=c.listeners;e:{var v=void 0;if(i)for(var B=c.length-1;0<=B;B--){var X=c[B],pe=X.instance,Ee=X.currentTarget;if(X=X.listener,pe!==v&&g.isPropagationStopped())break e;v=X,g.currentTarget=Ee;try{v(g)}catch(We){Ec(We)}g.currentTarget=null,v=pe}else for(B=0;B<c.length;B++){if(X=c[B],pe=X.instance,Ee=X.currentTarget,X=X.listener,pe!==v&&g.isPropagationStopped())break e;v=X,g.currentTarget=Ee;try{v(g)}catch(We){Ec(We)}g.currentTarget=null,v=pe}}}}function Bt(n,i){var l=i[Ce];l===void 0&&(l=i[Ce]=new Set);var c=n+"__bubble";l.has(c)||(Cx(i,n,2,!1),l.add(c))}function Ch(n,i,l){var c=0;i&&(c|=4),Cx(l,n,c,i)}var xd="_reactListening"+Math.random().toString(36).slice(2);function Th(n){if(!n[xd]){n[xd]=!0,yt.forEach(function(l){l!=="selectionchange"&&(K_.has(l)||Ch(l,!1,n),Ch(l,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[xd]||(i[xd]=!0,Ch("selectionchange",!1,i))}}function Cx(n,i,l,c){switch(ay(i)){case 2:var g=_S;break;case 8:g=SS;break;default:g=$h}l=g.bind(null,i,l,n),g=void 0,!Ge||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(g=!0),c?g!==void 0?n.addEventListener(i,l,{capture:!0,passive:g}):n.addEventListener(i,l,!0):g!==void 0?n.addEventListener(i,l,{passive:g}):n.addEventListener(i,l,!1)}function Nh(n,i,l,c,g){var v=c;if((i&1)===0&&(i&2)===0&&c!==null)e:for(;;){if(c===null)return;var B=c.tag;if(B===3||B===4){var X=c.stateNode.containerInfo;if(X===g)break;if(B===4)for(B=c.return;B!==null;){var pe=B.tag;if((pe===3||pe===4)&&B.stateNode.containerInfo===g)return;B=B.return}for(;X!==null;){if(B=ke(X),B===null)return;if(pe=B.tag,pe===5||pe===6||pe===26||pe===27){c=v=B;continue e}X=X.parentNode}}c=c.return}kc(function(){var Ee=v,We=Ll(l),Ze=[];e:{var Re=sg.get(n);if(Re!==void 0){var Le=Tc,ot=n;switch(n){case"keypress":if(Es(l)===0)break e;case"keydown":case"keyup":Le=Wb;break;case"focusin":ot="focus",Le=Ju;break;case"focusout":ot="blur",Le=Ju;break;case"beforeblur":case"afterblur":Le=Ju;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=Op;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=Nb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=Hb;break;case ag:case ng:case rg:Le=Fb;break;case ig:Le=Zb;break;case"scroll":case"scrollend":Le=Cb;break;case"wheel":Le=Kb;break;case"copy":case"cut":case"paste":Le=Bb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=Lp;break;case"toggle":case"beforetoggle":Le=Yb}var pt=(i&4)!==0,ra=!pt&&(n==="scroll"||n==="scrollend"),we=pt?Re!==null?Re+"Capture":null:Re;pt=[];for(var ye=Ee,Ae;ye!==null;){var He=ye;if(Ae=He.stateNode,He=He.tag,He!==5&&He!==26&&He!==27||Ae===null||we===null||(He=Ji(ye,we),He!=null&&pt.push(xo(ye,He,Ae))),ra)break;ye=ye.return}0<pt.length&&(Re=new Le(Re,ot,null,l,We),Ze.push({event:Re,listeners:pt}))}}if((i&7)===0){e:{if(Re=n==="mouseover"||n==="pointerover",Le=n==="mouseout"||n==="pointerout",Re&&l!==Dl&&(ot=l.relatedTarget||l.fromElement)&&(ke(ot)||ot[ce]))break e;if((Le||Re)&&(Re=We.window===We?We:(Re=We.ownerDocument)?Re.defaultView||Re.parentWindow:window,Le?(ot=l.relatedTarget||l.toElement,Le=Ee,ot=ot?ke(ot):null,ot!==null&&(ra=d(ot),pt=ot.tag,ot!==ra||pt!==5&&pt!==27&&pt!==6)&&(ot=null)):(Le=null,ot=Ee),Le!==ot)){if(pt=Op,He="onMouseLeave",we="onMouseEnter",ye="mouse",(n==="pointerout"||n==="pointerover")&&(pt=Lp,He="onPointerLeave",we="onPointerEnter",ye="pointer"),ra=Le==null?Re:Me(Le),Ae=ot==null?Re:Me(ot),Re=new pt(He,ye+"leave",Le,l,We),Re.target=ra,Re.relatedTarget=Ae,He=null,ke(We)===Ee&&(pt=new pt(we,ye+"enter",ot,l,We),pt.target=Ae,pt.relatedTarget=ra,He=pt),ra=He,Le&&ot)t:{for(pt=q_,we=Le,ye=ot,Ae=0,He=we;He;He=pt(He))Ae++;He=0;for(var ft=ye;ft;ft=pt(ft))He++;for(;0<Ae-He;)we=pt(we),Ae--;for(;0<He-Ae;)ye=pt(ye),He--;for(;Ae--;){if(we===ye||ye!==null&&we===ye.alternate){pt=we;break t}we=pt(we),ye=pt(ye)}pt=null}else pt=null;Le!==null&&Tx(Ze,Re,Le,pt,!1),ot!==null&&ra!==null&&Tx(Ze,ra,ot,pt,!0)}}e:{if(Re=Ee?Me(Ee):window,Le=Re.nodeName&&Re.nodeName.toLowerCase(),Le==="select"||Le==="input"&&Re.type==="file")var Wt=Vp;else if($p(Re))if(Zp)Wt=s_;else{Wt=r_;var dt=n_}else Le=Re.nodeName,!Le||Le.toLowerCase()!=="input"||Re.type!=="checkbox"&&Re.type!=="radio"?Ee&&Ol(Ee.elementType)&&(Wt=Vp):Wt=i_;if(Wt&&(Wt=Wt(n,Ee))){Hp(Ze,Wt,l,We);break e}dt&&dt(n,Re,Ee),n==="focusout"&&Ee&&Re.type==="number"&&Ee.memoizedProps.value!=null&&Bl(Re,"number",Re.value)}switch(dt=Ee?Me(Ee):window,n){case"focusin":($p(dt)||dt.contentEditable==="true")&&(Bs=dt,nf=Ee,Vl=null);break;case"focusout":Vl=nf=Bs=null;break;case"mousedown":rf=!0;break;case"contextmenu":case"mouseup":case"dragend":rf=!1,eg(Ze,l,We);break;case"selectionchange":if(o_)break;case"keydown":case"keyup":eg(Ze,l,We)}var kt;if(Qu)e:{switch(n){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else Rs?Wp(n,l)&&(Lt="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(Lt="onCompositionStart");Lt&&(Mp&&l.locale!=="ko"&&(Rs||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&Rs&&(kt=zc()):(ua=We,Ha="value"in ua?ua.value:ua.textContent,Rs=!0)),dt=yd(Ee,Lt),0<dt.length&&(Lt=new Dp(Lt,n,null,l,We),Ze.push({event:Lt,listeners:dt}),kt?Lt.data=kt:(kt=Up(l),kt!==null&&(Lt.data=kt)))),(kt=Xb?Qb(n,l):e_(n,l))&&(Lt=yd(Ee,"onBeforeInput"),0<Lt.length&&(dt=new Dp("onBeforeInput","beforeinput",null,l,We),Ze.push({event:dt,listeners:Lt}),dt.data=kt)),V_(Ze,n,Ee,l,We)}zx(Ze,i)})}function xo(n,i,l){return{instance:n,listener:i,currentTarget:l}}function yd(n,i){for(var l=i+"Capture",c=[];n!==null;){var g=n,v=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||v===null||(g=Ji(n,l),g!=null&&c.unshift(xo(n,g,v)),g=Ji(n,i),g!=null&&c.push(xo(n,g,v))),n.tag===3)return c;n=n.return}return[]}function q_(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Tx(n,i,l,c,g){for(var v=i._reactName,B=[];l!==null&&l!==c;){var X=l,pe=X.alternate,Ee=X.stateNode;if(X=X.tag,pe!==null&&pe===c)break;X!==5&&X!==26&&X!==27||Ee===null||(pe=Ee,g?(Ee=Ji(l,v),Ee!=null&&B.unshift(xo(l,Ee,pe))):g||(Ee=Ji(l,v),Ee!=null&&B.push(xo(l,Ee,pe)))),l=l.return}B.length!==0&&n.push({event:i,listeners:B})}var Y_=/\r\n?/g,J_=/\u0000|\uFFFD/g;function Nx(n){return(typeof n=="string"?n:""+n).replace(Y_,`
`).replace(J_,"")}function Ax(n,i){return i=Nx(i),Nx(n)===i}function na(n,i,l,c,g,v){switch(l){case"children":typeof c=="string"?i==="body"||i==="textarea"&&c===""||hr(n,c):(typeof c=="number"||typeof c=="bigint")&&i!=="body"&&hr(n,""+c);break;case"className":ur(n,"class",c);break;case"tabIndex":ur(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ur(n,l,c);break;case"style":Sc(n,c,v);break;case"data":if(i!=="object"){ur(n,"data",c);break}case"src":case"href":if(c===""&&(i!=="a"||l!=="href")){n.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=As(""+c),n.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(i!=="input"&&na(n,i,"name",g.name,g,null),na(n,i,"formEncType",g.formEncType,g,null),na(n,i,"formMethod",g.formMethod,g,null),na(n,i,"formTarget",g.formTarget,g,null)):(na(n,i,"encType",g.encType,g,null),na(n,i,"method",g.method,g,null),na(n,i,"target",g.target,g,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=As(""+c),n.setAttribute(l,c);break;case"onClick":c!=null&&(n.onclick=mr);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(g.children!=null)throw Error(s(60));n.innerHTML=l}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}l=As(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""+c):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":c===!0?n.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,c):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(l,c):n.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(l):n.setAttribute(l,c);break;case"popover":Bt("beforetoggle",n),Bt("toggle",n),Zt(n,"popover",c);break;case"xlinkActuate":fr(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":fr(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":fr(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":fr(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":fr(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":fr(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":fr(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":fr(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":fr(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Zt(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Gu.get(l)||l,Zt(n,l,c))}}function Ah(n,i,l,c,g,v){switch(l){case"style":Sc(n,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(s(61));if(l=c.__html,l!=null){if(g.children!=null)throw Error(s(60));n.innerHTML=l}}break;case"children":typeof c=="string"?hr(n,c):(typeof c=="number"||typeof c=="bigint")&&hr(n,""+c);break;case"onScroll":c!=null&&Bt("scroll",n);break;case"onScrollEnd":c!=null&&Bt("scrollend",n);break;case"onClick":c!=null&&(n.onclick=mr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jt.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),i=l.slice(2,g?l.length-7:void 0),v=n[re]||null,v=v!=null?v[l]:null,typeof v=="function"&&n.removeEventListener(i,v,g),typeof c=="function")){typeof v!="function"&&v!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(i,c,g);break e}l in n?n[l]=c:c===!0?n.setAttribute(l,""):Zt(n,l,c)}}}function Xa(n,i,l){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Bt("error",n),Bt("load",n);var c=!1,g=!1,v;for(v in l)if(l.hasOwnProperty(v)){var B=l[v];if(B!=null)switch(v){case"src":c=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:na(n,i,v,B,l,null)}}g&&na(n,i,"srcSet",l.srcSet,l,null),c&&na(n,i,"src",l.src,l,null);return;case"input":Bt("invalid",n);var X=v=B=g=null,pe=null,Ee=null;for(c in l)if(l.hasOwnProperty(c)){var We=l[c];if(We!=null)switch(c){case"name":g=We;break;case"type":B=We;break;case"checked":pe=We;break;case"defaultChecked":Ee=We;break;case"value":v=We;break;case"defaultValue":X=We;break;case"children":case"dangerouslySetInnerHTML":if(We!=null)throw Error(s(137,i));break;default:na(n,i,c,We,l,null)}}bc(n,v,X,pe,Ee,B,g,!1);return;case"select":Bt("invalid",n),c=B=v=null;for(g in l)if(l.hasOwnProperty(g)&&(X=l[g],X!=null))switch(g){case"value":v=X;break;case"defaultValue":B=X;break;case"multiple":c=X;default:na(n,i,g,X,l,null)}i=v,l=B,n.multiple=!!c,i!=null?fi(n,!!c,i,!1):l!=null&&fi(n,!!c,l,!0);return;case"textarea":Bt("invalid",n),v=g=c=null;for(B in l)if(l.hasOwnProperty(B)&&(X=l[B],X!=null))switch(B){case"value":c=X;break;case"defaultValue":g=X;break;case"children":v=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(s(91));break;default:na(n,i,B,X,l,null)}Yi(n,c,g,v);return;case"option":for(pe in l)l.hasOwnProperty(pe)&&(c=l[pe],c!=null)&&(pe==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":na(n,i,pe,c,l,null));return;case"dialog":Bt("beforetoggle",n),Bt("toggle",n),Bt("cancel",n),Bt("close",n);break;case"iframe":case"object":Bt("load",n);break;case"video":case"audio":for(c=0;c<go.length;c++)Bt(go[c],n);break;case"image":Bt("error",n),Bt("load",n);break;case"details":Bt("toggle",n);break;case"embed":case"source":case"link":Bt("error",n),Bt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in l)if(l.hasOwnProperty(Ee)&&(c=l[Ee],c!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,i));default:na(n,i,Ee,c,l,null)}return;default:if(Ol(i)){for(We in l)l.hasOwnProperty(We)&&(c=l[We],c!==void 0&&Ah(n,i,We,c,l,void 0));return}}for(X in l)l.hasOwnProperty(X)&&(c=l[X],c!=null&&na(n,i,X,c,l,null))}function X_(n,i,l,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,v=null,B=null,X=null,pe=null,Ee=null,We=null;for(Le in l){var Ze=l[Le];if(l.hasOwnProperty(Le)&&Ze!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":pe=Ze;default:c.hasOwnProperty(Le)||na(n,i,Le,null,c,Ze)}}for(var Re in c){var Le=c[Re];if(Ze=l[Re],c.hasOwnProperty(Re)&&(Le!=null||Ze!=null))switch(Re){case"type":v=Le;break;case"name":g=Le;break;case"checked":Ee=Le;break;case"defaultChecked":We=Le;break;case"value":B=Le;break;case"defaultValue":X=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(s(137,i));break;default:Le!==Ze&&na(n,i,Re,Le,c,Ze)}}Rl(n,B,X,pe,Ee,We,v,g);return;case"select":Le=B=X=Re=null;for(v in l)if(pe=l[v],l.hasOwnProperty(v)&&pe!=null)switch(v){case"value":break;case"multiple":Le=pe;default:c.hasOwnProperty(v)||na(n,i,v,null,c,pe)}for(g in c)if(v=c[g],pe=l[g],c.hasOwnProperty(g)&&(v!=null||pe!=null))switch(g){case"value":Re=v;break;case"defaultValue":X=v;break;case"multiple":B=v;default:v!==pe&&na(n,i,g,v,c,pe)}i=X,l=B,c=Le,Re!=null?fi(n,!!l,Re,!1):!!c!=!!l&&(i!=null?fi(n,!!l,i,!0):fi(n,!!l,l?[]:"",!1));return;case"textarea":Le=Re=null;for(X in l)if(g=l[X],l.hasOwnProperty(X)&&g!=null&&!c.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:na(n,i,X,null,c,g)}for(B in c)if(g=c[B],v=l[B],c.hasOwnProperty(B)&&(g!=null||v!=null))switch(B){case"value":Re=g;break;case"defaultValue":Le=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(s(91));break;default:g!==v&&na(n,i,B,g,c,v)}_c(n,Re,Le);return;case"option":for(var ot in l)Re=l[ot],l.hasOwnProperty(ot)&&Re!=null&&!c.hasOwnProperty(ot)&&(ot==="selected"?n.selected=!1:na(n,i,ot,null,c,Re));for(pe in c)Re=c[pe],Le=l[pe],c.hasOwnProperty(pe)&&Re!==Le&&(Re!=null||Le!=null)&&(pe==="selected"?n.selected=Re&&typeof Re!="function"&&typeof Re!="symbol":na(n,i,pe,Re,c,Le));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in l)Re=l[pt],l.hasOwnProperty(pt)&&Re!=null&&!c.hasOwnProperty(pt)&&na(n,i,pt,null,c,Re);for(Ee in c)if(Re=c[Ee],Le=l[Ee],c.hasOwnProperty(Ee)&&Re!==Le&&(Re!=null||Le!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Re!=null)throw Error(s(137,i));break;default:na(n,i,Ee,Re,c,Le)}return;default:if(Ol(i)){for(var ra in l)Re=l[ra],l.hasOwnProperty(ra)&&Re!==void 0&&!c.hasOwnProperty(ra)&&Ah(n,i,ra,void 0,c,Re);for(We in c)Re=c[We],Le=l[We],!c.hasOwnProperty(We)||Re===Le||Re===void 0&&Le===void 0||Ah(n,i,We,Re,c,Le);return}}for(var we in l)Re=l[we],l.hasOwnProperty(we)&&Re!=null&&!c.hasOwnProperty(we)&&na(n,i,we,null,c,Re);for(Ze in c)Re=c[Ze],Le=l[Ze],!c.hasOwnProperty(Ze)||Re===Le||Re==null&&Le==null||na(n,i,Ze,Re,c,Le)}function Ex(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Q_(){if(typeof performance.getEntriesByType=="function"){for(var n=0,i=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var g=l[c],v=g.transferSize,B=g.initiatorType,X=g.duration;if(v&&X&&Ex(B)){for(B=0,X=g.responseEnd,c+=1;c<l.length;c++){var pe=l[c],Ee=pe.startTime;if(Ee>X)break;var We=pe.transferSize,Ze=pe.initiatorType;We&&Ex(Ze)&&(pe=pe.responseEnd,B+=We*(pe<X?1:(X-Ee)/(pe-Ee)))}if(--c,i+=8*(v+B)/(g.duration/1e3),n++,10<n)break}}if(0<n)return i/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Eh=null,Fh=null;function vd(n){return n.nodeType===9?n:n.ownerDocument}function Fx(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Rx(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Rh(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Bh=null;function eS(){var n=window.event;return n&&n.type==="popstate"?n===Bh?!1:(Bh=n,!0):(Bh=null,!1)}var Bx=typeof setTimeout=="function"?setTimeout:void 0,tS=typeof clearTimeout=="function"?clearTimeout:void 0,Ox=typeof Promise=="function"?Promise:void 0,aS=typeof queueMicrotask=="function"?queueMicrotask:typeof Ox<"u"?function(n){return Ox.resolve(null).then(n).catch(nS)}:Bx;function nS(n){setTimeout(function(){throw n})}function Fi(n){return n==="head"}function Dx(n,i){var l=i,c=0;do{var g=l.nextSibling;if(n.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(c===0){n.removeChild(g),ll(i);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")yo(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,yo(l);for(var v=l.firstChild;v;){var B=v.nextSibling,X=v.nodeName;v[K]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&v.rel.toLowerCase()==="stylesheet"||l.removeChild(v),v=B}}else l==="body"&&yo(n.ownerDocument.body);l=g}while(l);ll(i)}function Lx(n,i){var l=n;n=0;do{var c=l.nextSibling;if(l.nodeType===1?i?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(i?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=c}while(l)}function Oh(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var l=i;switch(i=i.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Oh(l),ue(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function rS(n,i,l,c){for(;n.nodeType===1;){var g=l;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[K])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(v=n.getAttribute("rel"),v==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(v!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(v=n.getAttribute("src"),(v!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&v&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var v=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===v)return n}else return n;if(n=ar(n.nextSibling),n===null)break}return null}function iS(n,i,l){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=ar(n.nextSibling),n===null))return null;return n}function Mx(n,i){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=ar(n.nextSibling),n===null))return null;return n}function Dh(n){return n.data==="$?"||n.data==="$~"}function Lh(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function sS(n,i){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=i;else if(n.data!=="$?"||l.readyState!=="loading")i();else{var c=function(){i(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function ar(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"||i==="F!"||i==="F")break;if(i==="/$"||i==="/&")return null}}return n}var Mh=null;function Ix(n){n=n.nextSibling;for(var i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(i===0)return ar(n.nextSibling);i--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||i++}n=n.nextSibling}return null}function Px(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(i===0)return n;i--}else l!=="/$"&&l!=="/&"||i++}n=n.previousSibling}return null}function Wx(n,i,l){switch(i=vd(l),n){case"html":if(n=i.documentElement,!n)throw Error(s(452));return n;case"head":if(n=i.head,!n)throw Error(s(453));return n;case"body":if(n=i.body,!n)throw Error(s(454));return n;default:throw Error(s(451))}}function yo(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);ue(n)}var nr=new Map,Ux=new Set;function jd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Qr=J.d;J.d={f:lS,r:oS,D:cS,C:dS,L:uS,m:fS,X:mS,S:hS,M:pS};function lS(){var n=Qr.f(),i=ud();return n||i}function oS(n){var i=Te(n);i!==null&&i.tag===5&&i.type==="form"?i0(i):Qr.r(n)}var rl=typeof document>"u"?null:document;function $x(n,i,l){var c=rl;if(c&&typeof i=="string"&&i){var g=_n(i);g='link[rel="'+n+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Ux.has(g)||(Ux.add(g),n={rel:n,crossOrigin:l,href:i},c.querySelector(g)===null&&(i=c.createElement("link"),Xa(i,"link",n),$e(i),c.head.appendChild(i)))}}function cS(n){Qr.D(n),$x("dns-prefetch",n,null)}function dS(n,i){Qr.C(n,i),$x("preconnect",n,i)}function uS(n,i,l){Qr.L(n,i,l);var c=rl;if(c&&n&&i){var g='link[rel="preload"][as="'+_n(i)+'"]';i==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+_n(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+_n(l.imageSizes)+'"]')):g+='[href="'+_n(n)+'"]';var v=g;switch(i){case"style":v=il(n);break;case"script":v=sl(n)}nr.has(v)||(n=j({rel:"preload",href:i==="image"&&l&&l.imageSrcSet?void 0:n,as:i},l),nr.set(v,n),c.querySelector(g)!==null||i==="style"&&c.querySelector(vo(v))||i==="script"&&c.querySelector(jo(v))||(i=c.createElement("link"),Xa(i,"link",n),$e(i),c.head.appendChild(i)))}}function fS(n,i){Qr.m(n,i);var l=rl;if(l&&n){var c=i&&typeof i.as=="string"?i.as:"script",g='link[rel="modulepreload"][as="'+_n(c)+'"][href="'+_n(n)+'"]',v=g;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=sl(n)}if(!nr.has(v)&&(n=j({rel:"modulepreload",href:n},i),nr.set(v,n),l.querySelector(g)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(jo(v)))return}c=l.createElement("link"),Xa(c,"link",n),$e(c),l.head.appendChild(c)}}}function hS(n,i,l){Qr.S(n,i,l);var c=rl;if(c&&n){var g=Ye(c).hoistableStyles,v=il(n);i=i||"default";var B=g.get(v);if(!B){var X={loading:0,preload:null};if(B=c.querySelector(vo(v)))X.loading=5;else{n=j({rel:"stylesheet",href:n,"data-precedence":i},l),(l=nr.get(v))&&Ih(n,l);var pe=B=c.createElement("link");$e(pe),Xa(pe,"link",n),pe._p=new Promise(function(Ee,We){pe.onload=Ee,pe.onerror=We}),pe.addEventListener("load",function(){X.loading|=1}),pe.addEventListener("error",function(){X.loading|=2}),X.loading|=4,bd(B,i,c)}B={type:"stylesheet",instance:B,count:1,state:X},g.set(v,B)}}}function mS(n,i){Qr.X(n,i);var l=rl;if(l&&n){var c=Ye(l).hoistableScripts,g=sl(n),v=c.get(g);v||(v=l.querySelector(jo(g)),v||(n=j({src:n,async:!0},i),(i=nr.get(g))&&Ph(n,i),v=l.createElement("script"),$e(v),Xa(v,"link",n),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(g,v))}}function pS(n,i){Qr.M(n,i);var l=rl;if(l&&n){var c=Ye(l).hoistableScripts,g=sl(n),v=c.get(g);v||(v=l.querySelector(jo(g)),v||(n=j({src:n,async:!0,type:"module"},i),(i=nr.get(g))&&Ph(n,i),v=l.createElement("script"),$e(v),Xa(v,"link",n),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(g,v))}}function Hx(n,i,l,c){var g=(g=D.current)?jd(g):null;if(!g)throw Error(s(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(i=il(l.href),l=Ye(g).hoistableStyles,c=l.get(i),c||(c={type:"style",instance:null,count:0,state:null},l.set(i,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=il(l.href);var v=Ye(g).hoistableStyles,B=v.get(n);if(B||(g=g.ownerDocument||g,B={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(n,B),(v=g.querySelector(vo(n)))&&!v._p&&(B.instance=v,B.state.loading=5),nr.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},nr.set(n,l),v||gS(g,n,l,B.state))),i&&c===null)throw Error(s(528,""));return B}if(i&&c!==null)throw Error(s(529,""));return null;case"script":return i=l.async,l=l.src,typeof l=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=sl(l),l=Ye(g).hoistableScripts,c=l.get(i),c||(c={type:"script",instance:null,count:0,state:null},l.set(i,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,n))}}function il(n){return'href="'+_n(n)+'"'}function vo(n){return'link[rel="stylesheet"]['+n+"]"}function Vx(n){return j({},n,{"data-precedence":n.precedence,precedence:null})}function gS(n,i,l,c){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?c.loading=1:(i=n.createElement("link"),c.preload=i,i.addEventListener("load",function(){return c.loading|=1}),i.addEventListener("error",function(){return c.loading|=2}),Xa(i,"link",l),$e(i),n.head.appendChild(i))}function sl(n){return'[src="'+_n(n)+'"]'}function jo(n){return"script[async]"+n}function Zx(n,i,l){if(i.count++,i.instance===null)switch(i.type){case"style":var c=n.querySelector('style[data-href~="'+_n(l.href)+'"]');if(c)return i.instance=c,$e(c),c;var g=j({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),$e(c),Xa(c,"style",g),bd(c,l.precedence,n),i.instance=c;case"stylesheet":g=il(l.href);var v=n.querySelector(vo(g));if(v)return i.state.loading|=4,i.instance=v,$e(v),v;c=Vx(l),(g=nr.get(g))&&Ih(c,g),v=(n.ownerDocument||n).createElement("link"),$e(v);var B=v;return B._p=new Promise(function(X,pe){B.onload=X,B.onerror=pe}),Xa(v,"link",c),i.state.loading|=4,bd(v,l.precedence,n),i.instance=v;case"script":return v=sl(l.src),(g=n.querySelector(jo(v)))?(i.instance=g,$e(g),g):(c=l,(g=nr.get(v))&&(c=j({},l),Ph(c,g)),n=n.ownerDocument||n,g=n.createElement("script"),$e(g),Xa(g,"link",c),n.head.appendChild(g),i.instance=g);case"void":return null;default:throw Error(s(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(c=i.instance,i.state.loading|=4,bd(c,l.precedence,n));return i.instance}function bd(n,i,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=c.length?c[c.length-1]:null,v=g,B=0;B<c.length;B++){var X=c[B];if(X.dataset.precedence===i)v=X;else if(v!==g)break}v?v.parentNode.insertBefore(n,v.nextSibling):(i=l.nodeType===9?l.head:l,i.insertBefore(n,i.firstChild))}function Ih(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function Ph(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var _d=null;function Gx(n,i,l){if(_d===null){var c=new Map,g=_d=new Map;g.set(l,c)}else g=_d,c=g.get(l),c||(c=new Map,g.set(l,c));if(c.has(n))return c;for(c.set(n,null),l=l.getElementsByTagName(n),g=0;g<l.length;g++){var v=l[g];if(!(v[K]||v[ae]||n==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var B=v.getAttribute(i)||"";B=n+B;var X=c.get(B);X?X.push(v):c.set(B,[v])}}return c}function Kx(n,i,l){n=n.ownerDocument||n,n.head.insertBefore(l,i==="title"?n.querySelector("head > title"):null)}function xS(n,i,l){if(l===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;return i.rel==="stylesheet"?(n=i.disabled,typeof i.precedence=="string"&&n==null):!0;case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function qx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function yS(n,i,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=il(c.href),v=i.querySelector(vo(g));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(n.count++,n=Sd.bind(n),i.then(n,n)),l.state.loading|=4,l.instance=v,$e(v);return}v=i.ownerDocument||i,c=Vx(c),(g=nr.get(g))&&Ih(c,g),v=v.createElement("link"),$e(v);var B=v;B._p=new Promise(function(X,pe){B.onload=X,B.onerror=pe}),Xa(v,"link",c),l.instance=v}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=Sd.bind(n),i.addEventListener("load",l),i.addEventListener("error",l))}}var Wh=0;function vS(n,i){return n.stylesheets&&n.count===0&&kd(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var c=setTimeout(function(){if(n.stylesheets&&kd(n,n.stylesheets),n.unsuspend){var v=n.unsuspend;n.unsuspend=null,v()}},6e4+i);0<n.imgBytes&&Wh===0&&(Wh=62500*Q_());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&kd(n,n.stylesheets),n.unsuspend)){var v=n.unsuspend;n.unsuspend=null,v()}},(n.imgBytes>Wh?50:800)+i);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(g)}}:null}function Sd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)kd(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var wd=null;function kd(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,wd=new Map,i.forEach(jS,n),wd=null,Sd.call(n))}function jS(n,i){if(!(i.state.loading&4)){var l=wd.get(n);if(l)var c=l.get(null);else{l=new Map,wd.set(n,l);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<g.length;v++){var B=g[v];(B.nodeName==="LINK"||B.getAttribute("media")!=="not all")&&(l.set(B.dataset.precedence,B),c=B)}c&&l.set(null,c)}g=i.instance,B=g.getAttribute("data-precedence"),v=l.get(B)||c,v===c&&l.set(null,g),l.set(B,g),this.count++,c=Sd.bind(this),g.addEventListener("load",c),g.addEventListener("error",c),v?v.parentNode.insertBefore(g,v.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),i.state.loading|=4}}var bo={$$typeof:N,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function bS(n,i,l,c,g,v,B,X,pe){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ct(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ct(0),this.hiddenUpdates=ct(null),this.identifierPrefix=c,this.onUncaughtError=g,this.onCaughtError=v,this.onRecoverableError=B,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pe,this.incompleteTransitions=new Map}function Yx(n,i,l,c,g,v,B,X,pe,Ee,We,Ze){return n=new bS(n,i,l,B,pe,Ee,We,Ze,X),i=1,v===!0&&(i|=24),v=Rn(3,null,null,i),n.current=v,v.stateNode=n,i=jf(),i.refCount++,n.pooledCache=i,i.refCount++,v.memoizedState={element:c,isDehydrated:l,cache:i},wf(v),n}function Jx(n){return n?(n=Ls,n):Ls}function Xx(n,i,l,c,g,v){g=Jx(g),c.context===null?c.context=g:c.pendingContext=g,c=bi(i),c.payload={element:l},v=v===void 0?null:v,v!==null&&(c.callback=v),l=_i(n,c,i),l!==null&&(Cn(l,n,i),Xl(l,n,i))}function Qx(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<i?l:i}}function Uh(n,i){Qx(n,i),(n=n.alternate)&&Qx(n,i)}function ey(n){if(n.tag===13||n.tag===31){var i=es(n,67108864);i!==null&&Cn(i,n,67108864),Uh(n,67108864)}}function ty(n){if(n.tag===13||n.tag===31){var i=Mn();i=Ft(i);var l=es(n,i);l!==null&&Cn(l,n,i),Uh(n,i)}}var zd=!0;function _S(n,i,l,c){var g=W.T;W.T=null;var v=J.p;try{J.p=2,$h(n,i,l,c)}finally{J.p=v,W.T=g}}function SS(n,i,l,c){var g=W.T;W.T=null;var v=J.p;try{J.p=8,$h(n,i,l,c)}finally{J.p=v,W.T=g}}function $h(n,i,l,c){if(zd){var g=Hh(c);if(g===null)Nh(n,i,c,Cd,l),ny(n,c);else if(kS(g,n,i,l,c))c.stopPropagation();else if(ny(n,c),i&4&&-1<wS.indexOf(n)){for(;g!==null;){var v=Te(g);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var B=Tt(v.pendingLanes);if(B!==0){var X=v;for(X.pendingLanes|=2,X.entangledLanes|=2;B;){var pe=1<<31-it(B);X.entanglements[1]|=pe,B&=~pe}Er(v),(Ht&6)===0&&(cd=qe()+500,po(0))}}break;case 31:case 13:X=es(v,2),X!==null&&Cn(X,v,2),ud(),Uh(v,2)}if(v=Hh(c),v===null&&Nh(n,i,c,Cd,l),v===g)break;g=v}g!==null&&c.stopPropagation()}else Nh(n,i,c,null,l)}}function Hh(n){return n=Ll(n),Vh(n)}var Cd=null;function Vh(n){if(Cd=null,n=ke(n),n!==null){var i=d(n);if(i===null)n=null;else{var l=i.tag;if(l===13){if(n=u(i),n!==null)return n;n=null}else if(l===31){if(n=h(i),n!==null)return n;n=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Cd=n,null}function ay(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Nt()){case st:return 2;case _t:return 8;case zt:case It:return 32;case va:return 268435456;default:return 32}default:return 32}}var Zh=!1,Ri=null,Bi=null,Oi=null,_o=new Map,So=new Map,Di=[],wS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ny(n,i){switch(n){case"focusin":case"focusout":Ri=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Oi=null;break;case"pointerover":case"pointerout":_o.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":So.delete(i.pointerId)}}function wo(n,i,l,c,g,v){return n===null||n.nativeEvent!==v?(n={blockedOn:i,domEventName:l,eventSystemFlags:c,nativeEvent:v,targetContainers:[g]},i!==null&&(i=Te(i),i!==null&&ey(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,g!==null&&i.indexOf(g)===-1&&i.push(g),n)}function kS(n,i,l,c,g){switch(i){case"focusin":return Ri=wo(Ri,n,i,l,c,g),!0;case"dragenter":return Bi=wo(Bi,n,i,l,c,g),!0;case"mouseover":return Oi=wo(Oi,n,i,l,c,g),!0;case"pointerover":var v=g.pointerId;return _o.set(v,wo(_o.get(v)||null,n,i,l,c,g)),!0;case"gotpointercapture":return v=g.pointerId,So.set(v,wo(So.get(v)||null,n,i,l,c,g)),!0}return!1}function ry(n){var i=ke(n.target);if(i!==null){var l=d(i);if(l!==null){if(i=l.tag,i===13){if(i=u(l),i!==null){n.blockedOn=i,se(n.priority,function(){ty(l)});return}}else if(i===31){if(i=h(l),i!==null){n.blockedOn=i,se(n.priority,function(){ty(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Td(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var l=Hh(n.nativeEvent);if(l===null){l=n.nativeEvent;var c=new l.constructor(l.type,l);Dl=c,l.target.dispatchEvent(c),Dl=null}else return i=Te(l),i!==null&&ey(i),n.blockedOn=l,!1;i.shift()}return!0}function iy(n,i,l){Td(n)&&l.delete(i)}function zS(){Zh=!1,Ri!==null&&Td(Ri)&&(Ri=null),Bi!==null&&Td(Bi)&&(Bi=null),Oi!==null&&Td(Oi)&&(Oi=null),_o.forEach(iy),So.forEach(iy)}function Nd(n,i){n.blockedOn===i&&(n.blockedOn=null,Zh||(Zh=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,zS)))}var Ad=null;function sy(n){Ad!==n&&(Ad=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Ad===n&&(Ad=null);for(var i=0;i<n.length;i+=3){var l=n[i],c=n[i+1],g=n[i+2];if(typeof c!="function"){if(Vh(c||l)===null)continue;break}var v=Te(l);v!==null&&(n.splice(i,3),i-=3,Hf(v,{pending:!0,data:g,method:l.method,action:c},c,g))}}))}function ll(n){function i(pe){return Nd(pe,n)}Ri!==null&&Nd(Ri,n),Bi!==null&&Nd(Bi,n),Oi!==null&&Nd(Oi,n),_o.forEach(i),So.forEach(i);for(var l=0;l<Di.length;l++){var c=Di[l];c.blockedOn===n&&(c.blockedOn=null)}for(;0<Di.length&&(l=Di[0],l.blockedOn===null);)ry(l),l.blockedOn===null&&Di.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var g=l[c],v=l[c+1],B=g[re]||null;if(typeof v=="function")B||sy(l);else if(B){var X=null;if(v&&v.hasAttribute("formAction")){if(g=v,B=v[re]||null)X=B.formAction;else if(Vh(g)!==null)continue}else X=B.action;typeof X=="function"?l[c+1]=X:(l.splice(c,3),c-=3),sy(l)}}}function ly(){function n(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(B){return g=B})},focusReset:"manual",scroll:"manual"})}function i(){g!==null&&(g(),g=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",i),navigation.addEventListener("navigateerror",i),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",i),navigation.removeEventListener("navigateerror",i),g!==null&&(g(),g=null)}}}function Gh(n){this._internalRoot=n}Ed.prototype.render=Gh.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(s(409));var l=i.current,c=Mn();Xx(l,c,n,i,null,null)},Ed.prototype.unmount=Gh.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;Xx(n.current,2,null,n,null,null),ud(),i[ce]=null}};function Ed(n){this._internalRoot=n}Ed.prototype.unstable_scheduleHydration=function(n){if(n){var i=Y();n={blockedOn:null,target:n,priority:i};for(var l=0;l<Di.length&&i!==0&&i<Di[l].priority;l++);Di.splice(l,0,n),l===0&&ry(n)}};var oy=r.version;if(oy!=="19.2.4")throw Error(s(527,oy,"19.2.4"));J.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(s(188)):(n=Object.keys(n).join(","),Error(s(268,n)));return n=p(i),n=n!==null?x(n):null,n=n===null?null:n.stateNode,n};var CS={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fd.isDisabled&&Fd.supportsFiber)try{ca=Fd.inject(CS),ze=Fd}catch{}}return zo.createRoot=function(n,i){if(!o(n))throw Error(s(299));var l=!1,c="",g=p0,v=g0,B=x0;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(v=i.onCaughtError),i.onRecoverableError!==void 0&&(B=i.onRecoverableError)),i=Yx(n,1,!1,null,null,l,c,null,g,v,B,ly),n[ce]=i.current,Th(n),new Gh(i)},zo.hydrateRoot=function(n,i,l){if(!o(n))throw Error(s(299));var c=!1,g="",v=p0,B=g0,X=x0,pe=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(B=l.onCaughtError),l.onRecoverableError!==void 0&&(X=l.onRecoverableError),l.formState!==void 0&&(pe=l.formState)),i=Yx(n,1,!0,i,l??null,c,g,pe,v,B,X,ly),i.context=Jx(null),l=i.current,c=Mn(),c=Ft(c),g=bi(c),g.callback=null,_i(l,g,c),l=c,i.current.lanes=l,At(i,l),Er(i),n[ce]=i.current,Th(n),new Ed(i)},zo.version="19.2.4",zo}var yy;function LS(){if(yy)return Yh.exports;yy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(r){console.error(r)}}return t(),Yh.exports=DS(),Yh.exports}var MS=LS();var vy="popstate";function IS(t={}){function r(s,o){let{pathname:d,search:u,hash:h}=s.location;return $m("",{pathname:d,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(s,o){return typeof o=="string"?o:Qo(o)}return WS(r,a,null,t)}function ya(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function or(t,r){if(!t){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function PS(){return Math.random().toString(36).substring(2,10)}function jy(t,r){return{usr:t.state,key:t.key,idx:r}}function $m(t,r,a=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof r=="string"?wl(r):r,state:a,key:r&&r.key||s||PS()}}function Qo({pathname:t="/",search:r="",hash:a=""}){return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function wl(t){let r={};if(t){let a=t.indexOf("#");a>=0&&(r.hash=t.substring(a),t=t.substring(0,a));let s=t.indexOf("?");s>=0&&(r.search=t.substring(s),t=t.substring(0,s)),t&&(r.pathname=t)}return r}function WS(t,r,a,s={}){let{window:o=document.defaultView,v5Compat:d=!1}=s,u=o.history,h="POP",f=null,p=x();p==null&&(p=0,u.replaceState({...u.state,idx:p},""));function x(){return(u.state||{idx:null}).idx}function j(){h="POP";let _=x(),E=_==null?null:_-p;p=_,f&&f({action:h,location:b.location,delta:E})}function y(_,E){h="PUSH";let C=$m(b.location,_,E);p=x()+1;let N=jy(C,p),O=b.createHref(C);try{u.pushState(N,"",O)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;o.location.assign(O)}d&&f&&f({action:h,location:b.location,delta:1})}function S(_,E){h="REPLACE";let C=$m(b.location,_,E);p=x();let N=jy(C,p),O=b.createHref(C);u.replaceState(N,"",O),d&&f&&f({action:h,location:b.location,delta:0})}function w(_){return US(_)}let b={get action(){return h},get location(){return t(o,u)},listen(_){if(f)throw new Error("A history only accepts one active listener");return o.addEventListener(vy,j),f=_,()=>{o.removeEventListener(vy,j),f=null}},createHref(_){return r(o,_)},createURL:w,encodeLocation(_){let E=w(_);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:y,replace:S,go(_){return u.go(_)}};return b}function US(t,r=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),ya(a,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Qo(t);return s=s.replace(/ $/,"%20"),!r&&s.startsWith("//")&&(s=a+s),new URL(s,a)}function o1(t,r,a="/"){return $S(t,r,a,!1)}function $S(t,r,a,s){let o=typeof r=="string"?wl(r):r,d=li(o.pathname||"/",a);if(d==null)return null;let u=c1(t);HS(u);let h=null;for(let f=0;h==null&&f<u.length;++f){let p=tw(d);h=QS(u[f],p,s)}return h}function c1(t,r=[],a=[],s="",o=!1){let d=(u,h,f=o,p)=>{let x={relativePath:p===void 0?u.path||"":p,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(s)&&f)return;ya(x.relativePath.startsWith(s),`Absolute route path "${x.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(s.length)}let j=ni([s,x.relativePath]),y=a.concat(x);u.children&&u.children.length>0&&(ya(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${j}".`),c1(u.children,r,y,j,f)),!(u.path==null&&!u.index)&&r.push({path:j,score:JS(j,u.index),routesMeta:y})};return t.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))d(u,h);else for(let f of d1(u.path))d(u,h,!0,f)}),r}function d1(t){let r=t.split("/");if(r.length===0)return[];let[a,...s]=r,o=a.endsWith("?"),d=a.replace(/\?$/,"");if(s.length===0)return o?[d,""]:[d];let u=d1(s.join("/")),h=[];return h.push(...u.map(f=>f===""?d:[d,f].join("/"))),o&&h.push(...u),h.map(f=>t.startsWith("/")&&f===""?"/":f)}function HS(t){t.sort((r,a)=>r.score!==a.score?a.score-r.score:XS(r.routesMeta.map(s=>s.childrenIndex),a.routesMeta.map(s=>s.childrenIndex)))}var VS=/^:[\w-]+$/,ZS=3,GS=2,KS=1,qS=10,YS=-2,by=t=>t==="*";function JS(t,r){let a=t.split("/"),s=a.length;return a.some(by)&&(s+=YS),r&&(s+=GS),a.filter(o=>!by(o)).reduce((o,d)=>o+(VS.test(d)?ZS:d===""?KS:qS),s)}function XS(t,r){return t.length===r.length&&t.slice(0,-1).every((s,o)=>s===r[o])?t[t.length-1]-r[r.length-1]:0}function QS(t,r,a=!1){let{routesMeta:s}=t,o={},d="/",u=[];for(let h=0;h<s.length;++h){let f=s[h],p=h===s.length-1,x=d==="/"?r:r.slice(d.length)||"/",j=pu({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},x),y=f.route;if(!j&&p&&a&&!s[s.length-1].route.index&&(j=pu({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},x)),!j)return null;Object.assign(o,j.params),u.push({params:o,pathname:ni([d,j.pathname]),pathnameBase:iw(ni([d,j.pathnameBase])),route:y}),j.pathnameBase!=="/"&&(d=ni([d,j.pathnameBase]))}return u}function pu(t,r){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,s]=ew(t.path,t.caseSensitive,t.end),o=r.match(a);if(!o)return null;let d=o[0],u=d.replace(/(.)\/+$/,"$1"),h=o.slice(1);return{params:s.reduce((p,{paramName:x,isOptional:j},y)=>{if(x==="*"){let w=h[y]||"";u=d.slice(0,d.length-w.length).replace(/(.)\/+$/,"$1")}const S=h[y];return j&&!S?p[x]=void 0:p[x]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:d,pathnameBase:u,pattern:t}}function ew(t,r=!1,a=!0){or(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,f)=>(s.push({paramName:h,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,r?void 0:"i"),s]}function tw(t){try{return t.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return or(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),t}}function li(t,r){if(r==="/")return t;if(!t.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,s=t.charAt(a);return s&&s!=="/"?null:t.slice(a)||"/"}var aw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function nw(t,r="/"){let{pathname:a,search:s="",hash:o=""}=typeof t=="string"?wl(t):t,d;return a?(a=a.replace(/\/\/+/g,"/"),a.startsWith("/")?d=_y(a.substring(1),"/"):d=_y(a,r)):d=r,{pathname:d,search:sw(s),hash:lw(o)}}function _y(t,r){let a=r.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function em(t,r,a,s){return`Cannot include a '${t}' character in a manually specified \`to.${r}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rw(t){return t.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function np(t){let r=rw(t);return r.map((a,s)=>s===r.length-1?a.pathname:a.pathnameBase)}function rp(t,r,a,s=!1){let o;typeof t=="string"?o=wl(t):(o={...t},ya(!o.pathname||!o.pathname.includes("?"),em("?","pathname","search",o)),ya(!o.pathname||!o.pathname.includes("#"),em("#","pathname","hash",o)),ya(!o.search||!o.search.includes("#"),em("#","search","hash",o)));let d=t===""||o.pathname==="",u=d?"/":o.pathname,h;if(u==null)h=a;else{let j=r.length-1;if(!s&&u.startsWith("..")){let y=u.split("/");for(;y[0]==="..";)y.shift(),j-=1;o.pathname=y.join("/")}h=j>=0?r[j]:"/"}let f=nw(o,h),p=u&&u!=="/"&&u.endsWith("/"),x=(d||u===".")&&a.endsWith("/");return!f.pathname.endsWith("/")&&(p||x)&&(f.pathname+="/"),f}var ni=t=>t.join("/").replace(/\/\/+/g,"/"),iw=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),sw=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,lw=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,ow=class{constructor(t,r,a,s=!1){this.status=t,this.statusText=r||"",this.internal=s,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}};function cw(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function dw(t){return t.map(r=>r.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var u1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function f1(t,r){let a=t;if(typeof a!="string"||!aw.test(a))return{absoluteURL:void 0,isExternal:!1,to:a};let s=a,o=!1;if(u1)try{let d=new URL(window.location.href),u=a.startsWith("//")?new URL(d.protocol+a):new URL(a),h=li(u.pathname,r);u.origin===d.origin&&h!=null?a=h+u.search+u.hash:o=!0}catch{or(!1,`<Link to="${a}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:o,to:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var h1=["POST","PUT","PATCH","DELETE"];new Set(h1);var uw=["GET",...h1];new Set(uw);var kl=m.createContext(null);kl.displayName="DataRouter";var Bu=m.createContext(null);Bu.displayName="DataRouterState";var fw=m.createContext(!1),m1=m.createContext({isTransitioning:!1});m1.displayName="ViewTransition";var hw=m.createContext(new Map);hw.displayName="Fetchers";var mw=m.createContext(null);mw.displayName="Await";var Kn=m.createContext(null);Kn.displayName="Navigation";var dc=m.createContext(null);dc.displayName="Location";var cr=m.createContext({outlet:null,matches:[],isDataRoute:!1});cr.displayName="Route";var ip=m.createContext(null);ip.displayName="RouteError";var p1="REACT_ROUTER_ERROR",pw="REDIRECT",gw="ROUTE_ERROR_RESPONSE";function xw(t){if(t.startsWith(`${p1}:${pw}:{`))try{let r=JSON.parse(t.slice(28));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.location=="string"&&typeof r.reloadDocument=="boolean"&&typeof r.replace=="boolean")return r}catch{}}function yw(t){if(t.startsWith(`${p1}:${gw}:{`))try{let r=JSON.parse(t.slice(40));if(typeof r=="object"&&r&&typeof r.status=="number"&&typeof r.statusText=="string")return new ow(r.status,r.statusText,r.data)}catch{}}function vw(t,{relative:r}={}){ya(zl(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:s}=m.useContext(Kn),{hash:o,pathname:d,search:u}=uc(t,{relative:r}),h=d;return a!=="/"&&(h=d==="/"?a:ni([a,d])),s.createHref({pathname:h,search:u,hash:o})}function zl(){return m.useContext(dc)!=null}function Mr(){return ya(zl(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(dc).location}var g1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function x1(t){m.useContext(Kn).static||m.useLayoutEffect(t)}function on(){let{isDataRoute:t}=m.useContext(cr);return t?Bw():jw()}function jw(){ya(zl(),"useNavigate() may be used only in the context of a <Router> component.");let t=m.useContext(kl),{basename:r,navigator:a}=m.useContext(Kn),{matches:s}=m.useContext(cr),{pathname:o}=Mr(),d=JSON.stringify(np(s)),u=m.useRef(!1);return x1(()=>{u.current=!0}),m.useCallback((f,p={})=>{if(or(u.current,g1),!u.current)return;if(typeof f=="number"){a.go(f);return}let x=rp(f,JSON.parse(d),o,p.relative==="path");t==null&&r!=="/"&&(x.pathname=x.pathname==="/"?r:ni([r,x.pathname])),(p.replace?a.replace:a.push)(x,p.state,p)},[r,a,d,o,t])}var bw=m.createContext(null);function _w(t){let r=m.useContext(cr).outlet;return m.useMemo(()=>r&&m.createElement(bw.Provider,{value:t},r),[r,t])}function Ou(){let{matches:t}=m.useContext(cr),r=t[t.length-1];return r?r.params:{}}function uc(t,{relative:r}={}){let{matches:a}=m.useContext(cr),{pathname:s}=Mr(),o=JSON.stringify(np(a));return m.useMemo(()=>rp(t,JSON.parse(o),s,r==="path"),[t,o,s,r])}function Sw(t,r){return y1(t,r)}function y1(t,r,a,s,o){ya(zl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:d}=m.useContext(Kn),{matches:u}=m.useContext(cr),h=u[u.length-1],f=h?h.params:{},p=h?h.pathname:"/",x=h?h.pathnameBase:"/",j=h&&h.route;{let C=j&&j.path||"";j1(p,!j||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let y=Mr(),S;if(r){let C=typeof r=="string"?wl(r):r;ya(x==="/"||C.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${C.pathname}" was given in the \`location\` prop.`),S=C}else S=y;let w=S.pathname||"/",b=w;if(x!=="/"){let C=x.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(C.length).join("/")}let _=o1(t,{pathname:b});or(j||_!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),or(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Tw(_&&_.map(C=>Object.assign({},C,{params:Object.assign({},f,C.params),pathname:ni([x,d.encodeLocation?d.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?x:ni([x,d.encodeLocation?d.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),u,a,s,o);return r&&E?m.createElement(dc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},E):E}function ww(){let t=Rw(),r=cw(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:s},d={padding:"2px 4px",backgroundColor:s},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:d},"ErrorBoundary")," or"," ",m.createElement("code",{style:d},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},r),a?m.createElement("pre",{style:o},a):null,u)}var kw=m.createElement(ww,null),v1=class extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){this.props.onError?this.props.onError(t,r):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const a=yw(t.digest);a&&(t=a)}let r=t!==void 0?m.createElement(cr.Provider,{value:this.props.routeContext},m.createElement(ip.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?m.createElement(zw,{error:t},r):r}};v1.contextType=fw;var tm=new WeakMap;function zw({children:t,error:r}){let{basename:a}=m.useContext(Kn);if(typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){let s=xw(r.digest);if(s){let o=tm.get(r);if(o)throw o;let d=f1(s.location,a);if(u1&&!tm.get(r))if(d.isExternal||s.reloadDocument)window.location.href=d.absoluteURL||d.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(d.to,{replace:s.replace}));throw tm.set(r,u),u}return m.createElement("meta",{httpEquiv:"refresh",content:`0;url=${d.absoluteURL||d.to}`})}}return t}function Cw({routeContext:t,match:r,children:a}){let s=m.useContext(kl);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),m.createElement(cr.Provider,{value:t},a)}function Tw(t,r=[],a=null,s=null,o=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(r.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let d=t,u=a?.errors;if(u!=null){let x=d.findIndex(j=>j.route.id&&u?.[j.route.id]!==void 0);ya(x>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),d=d.slice(0,Math.min(d.length,x+1))}let h=!1,f=-1;if(a)for(let x=0;x<d.length;x++){let j=d[x];if((j.route.HydrateFallback||j.route.hydrateFallbackElement)&&(f=x),j.route.id){let{loaderData:y,errors:S}=a,w=j.route.loader&&!y.hasOwnProperty(j.route.id)&&(!S||S[j.route.id]===void 0);if(j.route.lazy||w){h=!0,f>=0?d=d.slice(0,f+1):d=[d[0]];break}}}let p=a&&s?(x,j)=>{s(x,{location:a.location,params:a.matches?.[0]?.params??{},unstable_pattern:dw(a.matches),errorInfo:j})}:void 0;return d.reduceRight((x,j,y)=>{let S,w=!1,b=null,_=null;a&&(S=u&&j.route.id?u[j.route.id]:void 0,b=j.route.errorElement||kw,h&&(f<0&&y===0?(j1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,_=null):f===y&&(w=!0,_=j.route.hydrateFallbackElement||null)));let E=r.concat(d.slice(0,y+1)),C=()=>{let N;return S?N=b:w?N=_:j.route.Component?N=m.createElement(j.route.Component,null):j.route.element?N=j.route.element:N=x,m.createElement(Cw,{match:j,routeContext:{outlet:x,matches:E,isDataRoute:a!=null},children:N})};return a&&(j.route.ErrorBoundary||j.route.errorElement||y===0)?m.createElement(v1,{location:a.location,revalidation:a.revalidation,component:b,error:S,children:C(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:p}):C()},null)}function sp(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Nw(t){let r=m.useContext(kl);return ya(r,sp(t)),r}function Aw(t){let r=m.useContext(Bu);return ya(r,sp(t)),r}function Ew(t){let r=m.useContext(cr);return ya(r,sp(t)),r}function lp(t){let r=Ew(t),a=r.matches[r.matches.length-1];return ya(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function Fw(){return lp("useRouteId")}function Rw(){let t=m.useContext(ip),r=Aw("useRouteError"),a=lp("useRouteError");return t!==void 0?t:r.errors?.[a]}function Bw(){let{router:t}=Nw("useNavigate"),r=lp("useNavigate"),a=m.useRef(!1);return x1(()=>{a.current=!0}),m.useCallback(async(o,d={})=>{or(a.current,g1),a.current&&(typeof o=="number"?await t.navigate(o):await t.navigate(o,{fromRouteId:r,...d}))},[t,r])}var Sy={};function j1(t,r,a){!r&&!Sy[t]&&(Sy[t]=!0,or(!1,a))}m.memo(Ow);function Ow({routes:t,future:r,state:a,onError:s}){return y1(t,void 0,a,s,r)}function ol({to:t,replace:r,state:a,relative:s}){ya(zl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=m.useContext(Kn);or(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:d}=m.useContext(cr),{pathname:u}=Mr(),h=on(),f=rp(t,np(d),u,s==="path"),p=JSON.stringify(f);return m.useEffect(()=>{h(JSON.parse(p),{replace:r,state:a,relative:s})},[h,p,s,r,a]),null}function Dw(t){return _w(t.context)}function vt(t){ya(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Lw({basename:t="/",children:r=null,location:a,navigationType:s="POP",navigator:o,static:d=!1,unstable_useTransitions:u}){ya(!zl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),f=m.useMemo(()=>({basename:h,navigator:o,static:d,unstable_useTransitions:u,future:{}}),[h,o,d,u]);typeof a=="string"&&(a=wl(a));let{pathname:p="/",search:x="",hash:j="",state:y=null,key:S="default"}=a,w=m.useMemo(()=>{let b=li(p,h);return b==null?null:{location:{pathname:b,search:x,hash:j,state:y,key:S},navigationType:s}},[h,p,x,j,y,S,s]);return or(w!=null,`<Router basename="${h}"> is not able to match the URL "${p}${x}${j}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:m.createElement(Kn.Provider,{value:f},m.createElement(dc.Provider,{children:r,value:w}))}function Mw({children:t,location:r}){return Sw(Hm(t),r)}function Hm(t,r=[]){let a=[];return m.Children.forEach(t,(s,o)=>{if(!m.isValidElement(s))return;let d=[...r,o];if(s.type===m.Fragment){a.push.apply(a,Hm(s.props.children,d));return}ya(s.type===vt,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ya(!s.props.index||!s.props.children,"An index route cannot have child routes.");let u={id:s.props.id||d.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Hm(s.props.children,d)),a.push(u)}),a}var ou="get",cu="application/x-www-form-urlencoded";function Du(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function Iw(t){return Du(t)&&t.tagName.toLowerCase()==="button"}function Pw(t){return Du(t)&&t.tagName.toLowerCase()==="form"}function Ww(t){return Du(t)&&t.tagName.toLowerCase()==="input"}function Uw(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function $w(t,r){return t.button===0&&(!r||r==="_self")&&!Uw(t)}function Vm(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((r,a)=>{let s=t[a];return r.concat(Array.isArray(s)?s.map(o=>[a,o]):[[a,s]])},[]))}function Hw(t,r){let a=Vm(t);return r&&r.forEach((s,o)=>{a.has(o)||r.getAll(o).forEach(d=>{a.append(o,d)})}),a}var Rd=null;function Vw(){if(Rd===null)try{new FormData(document.createElement("form"),0),Rd=!1}catch{Rd=!0}return Rd}var Zw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function am(t){return t!=null&&!Zw.has(t)?(or(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cu}"`),null):t}function Gw(t,r){let a,s,o,d,u;if(Pw(t)){let h=t.getAttribute("action");s=h?li(h,r):null,a=t.getAttribute("method")||ou,o=am(t.getAttribute("enctype"))||cu,d=new FormData(t)}else if(Iw(t)||Ww(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||h.getAttribute("action");if(s=f?li(f,r):null,a=t.getAttribute("formmethod")||h.getAttribute("method")||ou,o=am(t.getAttribute("formenctype"))||am(h.getAttribute("enctype"))||cu,d=new FormData(h,t),!Vw()){let{name:p,type:x,value:j}=t;if(x==="image"){let y=p?`${p}.`:"";d.append(`${y}x`,"0"),d.append(`${y}y`,"0")}else p&&d.append(p,j)}}else{if(Du(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=ou,s=null,o=cu,u=t}return d&&o==="text/plain"&&(u=d,d=void 0),{action:s,method:a.toLowerCase(),encType:o,formData:d,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function op(t,r){if(t===!1||t===null||typeof t>"u")throw new Error(r)}function Kw(t,r,a,s){let o=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return a?o.pathname.endsWith("/")?o.pathname=`${o.pathname}_.${s}`:o.pathname=`${o.pathname}.${s}`:o.pathname==="/"?o.pathname=`_root.${s}`:r&&li(o.pathname,r)==="/"?o.pathname=`${r.replace(/\/$/,"")}/_root.${s}`:o.pathname=`${o.pathname.replace(/\/$/,"")}.${s}`,o}async function qw(t,r){if(t.id in r)return r[t.id];try{let a=await import(t.module);return r[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Yw(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Jw(t,r,a){let s=await Promise.all(t.map(async o=>{let d=r.routes[o.route.id];if(d){let u=await qw(d,a);return u.links?u.links():[]}return[]}));return t2(s.flat(1).filter(Yw).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function wy(t,r,a,s,o,d){let u=(f,p)=>a[p]?f.route.id!==a[p].route.id:!0,h=(f,p)=>a[p].pathname!==f.pathname||a[p].route.path?.endsWith("*")&&a[p].params["*"]!==f.params["*"];return d==="assets"?r.filter((f,p)=>u(f,p)||h(f,p)):d==="data"?r.filter((f,p)=>{let x=s.routes[f.route.id];if(!x||!x.hasLoader)return!1;if(u(f,p)||h(f,p))return!0;if(f.route.shouldRevalidate){let j=f.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof j=="boolean")return j}return!0}):[]}function Xw(t,r,{includeHydrateFallback:a}={}){return Qw(t.map(s=>{let o=r.routes[s.route.id];if(!o)return[];let d=[o.module];return o.clientActionModule&&(d=d.concat(o.clientActionModule)),o.clientLoaderModule&&(d=d.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(d=d.concat(o.hydrateFallbackModule)),o.imports&&(d=d.concat(o.imports)),d}).flat(1))}function Qw(t){return[...new Set(t)]}function e2(t){let r={},a=Object.keys(t).sort();for(let s of a)r[s]=t[s];return r}function t2(t,r){let a=new Set;return new Set(r),t.reduce((s,o)=>{let d=JSON.stringify(e2(o));return a.has(d)||(a.add(d),s.push({key:d,link:o})),s},[])}function b1(){let t=m.useContext(kl);return op(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function a2(){let t=m.useContext(Bu);return op(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var cp=m.createContext(void 0);cp.displayName="FrameworkContext";function _1(){let t=m.useContext(cp);return op(t,"You must render this element inside a <HydratedRouter> element"),t}function n2(t,r){let a=m.useContext(cp),[s,o]=m.useState(!1),[d,u]=m.useState(!1),{onFocus:h,onBlur:f,onMouseEnter:p,onMouseLeave:x,onTouchStart:j}=r,y=m.useRef(null);m.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let b=E=>{E.forEach(C=>{u(C.isIntersecting)})},_=new IntersectionObserver(b,{threshold:.5});return y.current&&_.observe(y.current),()=>{_.disconnect()}}},[t]),m.useEffect(()=>{if(s){let b=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(b)}}},[s]);let S=()=>{o(!0)},w=()=>{o(!1),u(!1)};return a?t!=="intent"?[d,y,{}]:[d,y,{onFocus:Co(h,S),onBlur:Co(f,w),onMouseEnter:Co(p,S),onMouseLeave:Co(x,w),onTouchStart:Co(j,S)}]:[!1,y,{}]}function Co(t,r){return a=>{t&&t(a),a.defaultPrevented||r(a)}}function r2({page:t,...r}){let{router:a}=b1(),s=m.useMemo(()=>o1(a.routes,t,a.basename),[a.routes,t,a.basename]);return s?m.createElement(s2,{page:t,matches:s,...r}):null}function i2(t){let{manifest:r,routeModules:a}=_1(),[s,o]=m.useState([]);return m.useEffect(()=>{let d=!1;return Jw(t,r,a).then(u=>{d||o(u)}),()=>{d=!0}},[t,r,a]),s}function s2({page:t,matches:r,...a}){let s=Mr(),{future:o,manifest:d,routeModules:u}=_1(),{basename:h}=b1(),{loaderData:f,matches:p}=a2(),x=m.useMemo(()=>wy(t,r,p,d,s,"data"),[t,r,p,d,s]),j=m.useMemo(()=>wy(t,r,p,d,s,"assets"),[t,r,p,d,s]),y=m.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let b=new Set,_=!1;if(r.forEach(C=>{let N=d.routes[C.route.id];!N||!N.hasLoader||(!x.some(O=>O.route.id===C.route.id)&&C.route.id in f&&u[C.route.id]?.shouldRevalidate||N.hasClientLoader?_=!0:b.add(C.route.id))}),b.size===0)return[];let E=Kw(t,h,o.unstable_trailingSlashAwareDataRequests,"data");return _&&b.size>0&&E.searchParams.set("_routes",r.filter(C=>b.has(C.route.id)).map(C=>C.route.id).join(",")),[E.pathname+E.search]},[h,o.unstable_trailingSlashAwareDataRequests,f,s,d,x,r,t,u]),S=m.useMemo(()=>Xw(j,d),[j,d]),w=i2(j);return m.createElement(m.Fragment,null,y.map(b=>m.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...a})),S.map(b=>m.createElement("link",{key:b,rel:"modulepreload",href:b,...a})),w.map(({key:b,link:_})=>m.createElement("link",{key:b,nonce:a.nonce,..._,crossOrigin:_.crossOrigin??a.crossOrigin})))}function l2(...t){return r=>{t.forEach(a=>{typeof a=="function"?a(r):a!=null&&(a.current=r)})}}var o2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{o2&&(window.__reactRouterVersion="7.13.0")}catch{}function c2({basename:t,children:r,unstable_useTransitions:a,window:s}){let o=m.useRef();o.current==null&&(o.current=IS({window:s,v5Compat:!0}));let d=o.current,[u,h]=m.useState({action:d.action,location:d.location}),f=m.useCallback(p=>{a===!1?h(p):m.startTransition(()=>h(p))},[a]);return m.useLayoutEffect(()=>d.listen(f),[d,f]),m.createElement(Lw,{basename:t,children:r,location:u.location,navigationType:u.action,navigator:d,unstable_useTransitions:a})}var S1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,w1=m.forwardRef(function({onClick:r,discover:a="render",prefetch:s="none",relative:o,reloadDocument:d,replace:u,state:h,target:f,to:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y,...S},w){let{basename:b,unstable_useTransitions:_}=m.useContext(Kn),E=typeof p=="string"&&S1.test(p),C=f1(p,b);p=C.to;let N=vw(p,{relative:o}),[O,Q,G]=n2(s,S),M=f2(p,{replace:u,state:h,target:f,preventScrollReset:x,relative:o,viewTransition:j,unstable_defaultShouldRevalidate:y,unstable_useTransitions:_});function U(R){r&&r(R),R.defaultPrevented||M(R)}let A=m.createElement("a",{...S,...G,href:C.absoluteURL||N,onClick:C.isExternal||d?r:U,ref:l2(w,Q),target:f,"data-discover":!E&&a==="render"?"true":void 0});return O&&!E?m.createElement(m.Fragment,null,A,m.createElement(r2,{page:N})):A});w1.displayName="Link";var k1=m.forwardRef(function({"aria-current":r="page",caseSensitive:a=!1,className:s="",end:o=!1,style:d,to:u,viewTransition:h,children:f,...p},x){let j=uc(u,{relative:p.relative}),y=Mr(),S=m.useContext(Bu),{navigator:w,basename:b}=m.useContext(Kn),_=S!=null&&x2(j)&&h===!0,E=w.encodeLocation?w.encodeLocation(j).pathname:j.pathname,C=y.pathname,N=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;a||(C=C.toLowerCase(),N=N?N.toLowerCase():null,E=E.toLowerCase()),N&&b&&(N=li(N,b)||N);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let Q=C===E||!o&&C.startsWith(E)&&C.charAt(O)==="/",G=N!=null&&(N===E||!o&&N.startsWith(E)&&N.charAt(E.length)==="/"),M={isActive:Q,isPending:G,isTransitioning:_},U=Q?r:void 0,A;typeof s=="function"?A=s(M):A=[s,Q?"active":null,G?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let R=typeof d=="function"?d(M):d;return m.createElement(w1,{...p,"aria-current":U,className:A,ref:x,style:R,to:u,viewTransition:h},typeof f=="function"?f(M):f)});k1.displayName="NavLink";var d2=m.forwardRef(({discover:t="render",fetcherKey:r,navigate:a,reloadDocument:s,replace:o,state:d,method:u=ou,action:h,onSubmit:f,relative:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y,...S},w)=>{let{unstable_useTransitions:b}=m.useContext(Kn),_=p2(),E=g2(h,{relative:p}),C=u.toLowerCase()==="get"?"get":"post",N=typeof h=="string"&&S1.test(h),O=Q=>{if(f&&f(Q),Q.defaultPrevented)return;Q.preventDefault();let G=Q.nativeEvent.submitter,M=G?.getAttribute("formmethod")||u,U=()=>_(G||Q.currentTarget,{fetcherKey:r,method:M,navigate:a,replace:o,state:d,relative:p,preventScrollReset:x,viewTransition:j,unstable_defaultShouldRevalidate:y});b&&a!==!1?m.startTransition(()=>U()):U()};return m.createElement("form",{ref:w,method:C,action:E,onSubmit:s?f:O,...S,"data-discover":!N&&t==="render"?"true":void 0})});d2.displayName="Form";function u2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function z1(t){let r=m.useContext(kl);return ya(r,u2(t)),r}function f2(t,{target:r,replace:a,state:s,preventScrollReset:o,relative:d,viewTransition:u,unstable_defaultShouldRevalidate:h,unstable_useTransitions:f}={}){let p=on(),x=Mr(),j=uc(t,{relative:d});return m.useCallback(y=>{if($w(y,r)){y.preventDefault();let S=a!==void 0?a:Qo(x)===Qo(j),w=()=>p(t,{replace:S,state:s,preventScrollReset:o,relative:d,viewTransition:u,unstable_defaultShouldRevalidate:h});f?m.startTransition(()=>w()):w()}},[x,p,j,a,s,r,t,o,d,u,h,f])}function fc(t){or(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=m.useRef(Vm(t)),a=m.useRef(!1),s=Mr(),o=m.useMemo(()=>Hw(s.search,a.current?null:r.current),[s.search]),d=on(),u=m.useCallback((h,f)=>{const p=Vm(typeof h=="function"?h(new URLSearchParams(o)):h);a.current=!0,d("?"+p,f)},[d,o]);return[o,u]}var h2=0,m2=()=>`__${String(++h2)}__`;function p2(){let{router:t}=z1("useSubmit"),{basename:r}=m.useContext(Kn),a=Fw(),s=t.fetch,o=t.navigate;return m.useCallback(async(d,u={})=>{let{action:h,method:f,encType:p,formData:x,body:j}=Gw(d,r);if(u.navigate===!1){let y=u.fetcherKey||m2();await s(y,a,u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:x,body:j,formMethod:u.method||f,formEncType:u.encType||p,flushSync:u.flushSync})}else await o(u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:x,body:j,formMethod:u.method||f,formEncType:u.encType||p,replace:u.replace,state:u.state,fromRouteId:a,flushSync:u.flushSync,viewTransition:u.viewTransition})},[s,o,r,a])}function g2(t,{relative:r}={}){let{basename:a}=m.useContext(Kn),s=m.useContext(cr);ya(s,"useFormAction must be used inside a RouteContext");let[o]=s.matches.slice(-1),d={...uc(t||".",{relative:r})},u=Mr();if(t==null){d.search=u.search;let h=new URLSearchParams(d.search),f=h.getAll("index");if(f.some(x=>x==="")){h.delete("index"),f.filter(j=>j).forEach(j=>h.append("index",j));let x=h.toString();d.search=x?`?${x}`:""}}return(!t||t===".")&&o.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(d.pathname=d.pathname==="/"?a:ni([a,d.pathname])),Qo(d)}function x2(t,{relative:r}={}){let a=m.useContext(m1);ya(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=z1("useViewTransitionState"),o=uc(t,{relative:r});if(!a.isTransitioning)return!1;let d=li(a.currentLocation.pathname,s)||a.currentLocation.pathname,u=li(a.nextLocation.pathname,s)||a.nextLocation.pathname;return pu(o.pathname,u)!=null||pu(o.pathname,d)!=null}const y2=[{title:"Dashboardy",items:[{to:"/",icon:"",label:"Executive Summary"},{to:"/security-score",icon:"",label:"Security Score"},{to:"/domains",icon:"",label:"Domeny Bezpieczenstwa"}]},{title:"Kontekst Organizacyjny",items:[{to:"/org-context",icon:"",label:"Kontekst Organizacyjny"}]},{title:"Katalogi Bezpieczenstwa",items:[{to:"/smart-catalog",icon:"",label:"Zagrozenia i Zabezpieczenia"},{to:"/control-effectiveness",icon:"",label:"Skuteczno Zabezpiecze"}]},{title:"Zarzdzanie Ryzykiem",items:[{to:"/assets",icon:"",label:"Aktywa (CMDB)"},{to:"/risks",icon:"",label:"Rejestr Ryzyk"},{to:"/reviews",icon:"",label:"Przegldy"},{to:"/actions",icon:"",label:"Dziaania"}]},{title:"Operacje Bezpieczestwa",items:[{to:"/vulnerabilities",icon:"",label:"Podatnoci"},{to:"/incidents",icon:"",label:"Incydenty"}]},{title:"Governance",items:[{to:"/exceptions",icon:"",label:"Wyjtki"},{to:"/audits",icon:"",label:"Audyty"}]},{title:"Dostawcy & Awareness",items:[{to:"/vendors",icon:"",label:"Dostawcy (TPRM)"},{to:"/awareness",icon:"",label:"Awareness"}]},{title:"Compliance & Audit",items:[{to:"/compliance",icon:"",label:"Dashboard Zgodnoci"},{to:"/frameworks",icon:"",label:"Repozytorium Wymaga"},{to:"/compliance/assessments",icon:"",label:"Oceny Zgodnoci"},{to:"/framework-mappings",icon:"",label:"Mapowanie Frameworkw"},{to:"/audit-programs",icon:"",label:"Program Audytw"},{to:"/audit-engagements",icon:"",label:"Zadania Audytowe"},{to:"/test-templates",icon:"",label:"Katalog Testw"},{to:"/audit-findings",icon:"",label:"Ustalenia Audytowe"}]},{title:"Raporty",items:[{to:"/reports",icon:"",label:"Generuj raporty"}]},{title:"Konfiguracja",items:[{to:"/assets/admin",icon:"",label:"CMDB Admin"},{to:"/ai-config",icon:"",label:"Integracja AI"},{to:"/db-admin",icon:"",label:"Baza danych"},{to:"/dictionaries",icon:"",label:"Sowniki"},{to:"/audit",icon:"",label:"Audit Trail"}]}];function v2(){return e.jsxs("nav",{className:"sidebar",children:[e.jsxs("div",{className:"sidebar-brand",children:[e.jsx("div",{className:"shield",children:""}),e.jsxs("div",{className:"brand-text",children:[e.jsx("h1",{children:"SecurePosture"}),e.jsx("span",{children:"CISO Platform"})]})]}),y2.map(t=>e.jsxs("div",{className:"sidebar-section",children:[e.jsx("div",{className:"sidebar-section-label",children:t.title}),t.items.map(r=>e.jsxs(k1,{to:r.to,end:r.to==="/",className:({isActive:a})=>`sidebar-item${a?" active":""}`,children:[e.jsx("span",{className:"icon",children:r.icon}),e.jsx("span",{children:r.label}),r.badge&&e.jsx("span",{className:`badge ${r.badge.cls}`,children:r.badge.count})]},r.to))]},t.title))]})}const C1=m.createContext({theme:"dark",setTheme:()=>{}});function j2(){return m.useContext(C1)}const b2={dark:{"--bg-primary":"#0a0e1a","--bg-secondary":"#111827","--bg-card":"#1a2035","--bg-card-hover":"#1f2847","--bg-sidebar":"#0d1220","--bg-subtle":"rgba(255,255,255,0.04)","--bg-inset":"rgba(255,255,255,0.02)","--border":"#2a3554","--border-light":"#374167","--text-primary":"#e8ecf4","--text-secondary":"#8896b3","--text-muted":"#5a6a8a","--green":"#22c55e","--green-dim":"rgba(34,197,94,0.15)","--yellow":"#eab308","--yellow-dim":"rgba(234,179,8,0.15)","--orange":"#f97316","--orange-dim":"rgba(249,115,22,0.15)","--red":"#ef4444","--red-dim":"rgba(239,68,68,0.15)","--blue":"#3b82f6","--blue-dim":"rgba(59,130,246,0.12)","--purple":"#8b5cf6","--purple-dim":"rgba(139,92,246,0.12)","--cyan":"#06b6d4","--shadow":"0 4px 24px rgba(0,0,0,0.3)"},light:{"--bg-primary":"#f0f2f5","--bg-secondary":"#ffffff","--bg-card":"#ffffff","--bg-card-hover":"#f5f7fa","--bg-sidebar":"#1e293b","--bg-subtle":"rgba(0,0,0,0.04)","--bg-inset":"rgba(0,0,0,0.02)","--border":"#e2e8f0","--border-light":"#cbd5e1","--text-primary":"#1e293b","--text-secondary":"#475569","--text-muted":"#94a3b8","--green":"#16a34a","--green-dim":"rgba(22,163,74,0.10)","--yellow":"#ca8a04","--yellow-dim":"rgba(202,138,4,0.10)","--orange":"#ea580c","--orange-dim":"rgba(234,88,12,0.10)","--red":"#dc2626","--red-dim":"rgba(220,38,38,0.10)","--blue":"#2563eb","--blue-dim":"rgba(37,99,235,0.08)","--purple":"#7c3aed","--purple-dim":"rgba(124,58,237,0.08)","--cyan":"#0891b2","--shadow":"0 4px 24px rgba(0,0,0,0.08)"},material:{"--bg-primary":"#fafafa","--bg-secondary":"#ffffff","--bg-card":"#ffffff","--bg-card-hover":"#f5f5f5","--bg-sidebar":"#1a237e","--bg-subtle":"rgba(0,0,0,0.05)","--bg-inset":"rgba(0,0,0,0.03)","--border":"#e0e0e0","--border-light":"#bdbdbd","--text-primary":"#212121","--text-secondary":"#616161","--text-muted":"#9e9e9e","--green":"#2e7d32","--green-dim":"rgba(46,125,50,0.10)","--yellow":"#f9a825","--yellow-dim":"rgba(249,168,37,0.10)","--orange":"#ef6c00","--orange-dim":"rgba(239,108,0,0.10)","--red":"#c62828","--red-dim":"rgba(198,40,40,0.10)","--blue":"#1565c0","--blue-dim":"rgba(21,101,192,0.08)","--purple":"#6a1b9a","--purple-dim":"rgba(106,27,154,0.08)","--cyan":"#00838f","--shadow":"0 2px 12px rgba(0,0,0,0.12)"}};function _2({children:t}){const[r,a]=m.useState(()=>localStorage.getItem("sp-theme")||"dark"),s=o=>{a(o),localStorage.setItem("sp-theme",o)};return m.useEffect(()=>{const o=b2[r],d=document.documentElement;for(const[u,h]of Object.entries(o))d.style.setProperty(u,h);d.setAttribute("data-theme",r)},[r]),e.jsx(C1.Provider,{value:{theme:r,setTheme:s},children:t})}const S2={"/":"Executive Summary","/assets":"Rejestr Aktywow","/assets/graph":"Graf Relacji Aktywow","/risks":"Rejestr Ryzyk","/reviews":"Przeglady Ryzyk","/cis":"Frameworki (przekierowanie)","/cis/assess":"Oceny (przekierowanie)","/org-structure":"Struktura Organizacyjna","/catalogs":"Katalogi","/smart-catalog":"Katalog Zagrozen, Podatnosci i Zabezpieczen","/dictionaries":"Slowniki","/actions":"Dzialania","/audit":"Audit Trail","/frameworks":"Biblioteka Frameworkow","/framework-mappings":"Mapowanie Frameworkow","/assessments":"Oceny Frameworkow","/vulnerabilities":"Podatnosci","/incidents":"Incydenty","/policies":"Polityki","/exceptions":"Rejestr Wyjatkow","/audits":"Audyty","/vendors":"Dostawcy (TPRM)","/awareness":"Awareness","/security-score":"Security Score","/domains":"Domeny Bezpieczenstwa"},w2=[{value:"dark",label:"Ciemny",icon:""},{value:"light",label:"Jasny",icon:""},{value:"material",label:"Material",icon:""}];function k2(){const{pathname:t}=Mr(),{theme:r,setTheme:a}=j2(),s=S2[t]??"SecurePosture",o=new Date,d=o.toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}),u=o.toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"topbar",children:[e.jsx("h2",{children:s}),e.jsxs("div",{className:"meta",children:[e.jsx("div",{className:"theme-switcher",children:w2.map(h=>e.jsx("button",{className:`theme-btn${r===h.value?" active":""}`,onClick:()=>a(h.value),title:h.label,children:h.icon},h.value))}),e.jsxs("span",{children:[e.jsx("span",{className:"live-dot"}),"Dane aktualne"]}),e.jsxs("span",{children:[d,", ",u]})]})]})}function z2(){return e.jsxs(e.Fragment,{children:[e.jsx(v2,{}),e.jsxs("div",{className:"main-wrapper",children:[e.jsx(k2,{}),e.jsx("div",{className:"content",children:e.jsx("div",{className:"view-enter",children:e.jsx(Dw,{})})})]})]})}class C2 extends m.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("ErrorBoundary caught:",r,a)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs("div",{style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"var(--red, #ef4444)",marginBottom:12},children:"Wystapil blad w aplikacji"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-muted, #888)",marginBottom:16,maxWidth:500,margin:"0 auto 16px"},children:this.state.error?.message||"Nieznany blad"}),e.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},style:{padding:"8px 20px",fontSize:13,cursor:"pointer",background:"var(--blue, #3b82f6)",color:"#fff",border:"none",borderRadius:6},children:"Odswierz strone"})]}):this.props.children}}const T1="";async function To(t,r){const a=await fetch(`${T1}${t}`,{...r,headers:{"Content-Type":"application/json",...r?.headers}});if(!a.ok){const s=await a.text().catch(()=>"");throw new Error(`API ${a.status}: ${s}`)}return a.json()}const le={get:t=>To(t),post:(t,r)=>To(t,{method:"POST",body:JSON.stringify(r)}),put:(t,r)=>To(t,{method:"PUT",body:JSON.stringify(r)}),patch:(t,r)=>To(t,{method:"PATCH",body:JSON.stringify(r)}),delete:t=>To(t,{method:"DELETE"}),postFormData:async(t,r)=>{const a=await fetch(`${T1}${t}`,{method:"POST",body:r});if(!a.ok){const s=await a.text().catch(()=>"");throw new Error(`API ${a.status}: ${s}`)}return a.json()}};function ky(t){return t.toLowerCase().replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"e").replace(/[l]/g,"l").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"s").replace(/[]/g,"z").replace(/[^\w\s]/g,"")}function zy(t){const r=new Set;for(let a=0;a<t.length-1;a++)r.add(t.slice(a,a+2));return r}function Cy(t,r){const a=ky(t),s=ky(r);if(s.includes(a))return 1;const o=s.split(/\s+/);for(const f of o)if(f.startsWith(a))return .95;if(a.length<2||s.length<2)return 0;const d=zy(a),u=zy(s);let h=0;for(const f of d)u.has(f)&&h++;return 2*h/(d.size+u.size)}function Ty(t,r){if(!t)return!0;const a=Cy(t,r.name),s=Cy(t,r.symbol);return a>.35||s>.35}function N1(t,r){if(!r)return t;const a=[];for(const s of t){const o=N1(s.children,r);(Ty(r,s)||o.length>0)&&a.push({...s,children:o.length>0?o:Ty(r,s)?s.children:[]})}return a}function A1({node:t,depth:r,onSelect:a,expandedIds:s,toggleExpand:o,highlightId:d,query:u}){const h=t.children.length>0,f=s.has(t.id),p=d===t.id,x=["","","",""],j=x[Math.min(r,x.length-1)];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,padding:"5px 8px",paddingLeft:r*18+8,cursor:"pointer",background:p?"var(--blue-dim)":"transparent",fontSize:13,transition:"background 0.1s",borderLeft:p?"2px solid var(--blue)":"2px solid transparent",whiteSpace:"nowrap"},onMouseEnter:y=>{p||(y.currentTarget.style.background="var(--bg-card-hover)")},onMouseLeave:y=>{p||(y.currentTarget.style.background="transparent")},onClick:y=>{y.stopPropagation(),a(t)},children:[h?e.jsx("span",{onClick:y=>{y.stopPropagation(),o(t.id)},style:{cursor:"pointer",fontSize:9,width:14,textAlign:"center",color:"var(--text-muted)",userSelect:"none",flexShrink:0},children:f?"":""}):e.jsx("span",{style:{width:14,flexShrink:0}}),e.jsx("span",{style:{flexShrink:0},children:j}),e.jsx("span",{style:{fontWeight:r===0?600:400,overflow:"hidden",textOverflow:"ellipsis"},children:t.name}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",marginLeft:4,flexShrink:0},children:t.symbol})]}),f&&h&&t.children.map(y=>e.jsx(A1,{node:y,depth:r+1,onSelect:a,expandedIds:s,toggleExpand:o,highlightId:d,query:u},y.id))]})}function Zm(t,r,a=[]){for(const s of t){const o=[...a,s.name];if(s.id===r)return o;const d=Zm(s.children,r,o);if(d)return d}return null}function E1(t){const r=new Set;for(const a of t){r.add(a.id);for(const s of E1(a.children))r.add(s)}return r}function jn({tree:t,value:r,onChange:a,placeholder:s="Wybierz jednostk...",allowClear:o=!0,className:d,style:u,disabled:h}){const[f,p]=m.useState(!1),[x,j]=m.useState(""),[y,S]=m.useState(()=>new Set(t.map(G=>G.id))),w=m.useRef(null),b=m.useRef(null);m.useEffect(()=>{S(new Set(t.map(G=>G.id)))},[t]),m.useEffect(()=>{if(!f)return;const G=M=>{w.current&&!w.current.contains(M.target)&&p(!1)};return document.addEventListener("mousedown",G),()=>document.removeEventListener("mousedown",G)},[f]),m.useEffect(()=>{f&&b.current&&b.current.focus()},[f]);const _=m.useMemo(()=>{if(!r)return null;const G=Zm(t,r);return G?G.join("  "):null},[t,r]),E=m.useMemo(()=>{if(!r)return null;const G=Zm(t,r);return G?G[G.length-1]:null},[t,r]),C=m.useMemo(()=>N1(t,x),[t,x]);m.useEffect(()=>{x&&S(E1(C))},[x,C]);const N=m.useCallback(G=>{S(M=>{const U=new Set(M);return U.has(G)?U.delete(G):U.add(G),U})},[]),O=m.useCallback(G=>{a(G.id),p(!1),j("")},[a]),Q=m.useCallback(G=>{G.stopPropagation(),a(null),j("")},[a]);return e.jsxs("div",{ref:w,className:d,style:{position:"relative",...u},children:[e.jsxs("div",{onClick:()=>{h||p(!f)},style:{display:"flex",alignItems:"center",gap:6,padding:"6px 10px",background:"var(--bg-input, var(--bg-card))",border:"1px solid var(--border)",borderRadius:6,cursor:h?"not-allowed":"pointer",fontSize:13,minHeight:34,opacity:h?.5:1},className:"form-control",children:[E?e.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:_??void 0,children:_}):e.jsx("span",{style:{flex:1,color:"var(--text-muted)"},children:s}),o&&r&&!h&&e.jsx("span",{onClick:Q,style:{cursor:"pointer",fontSize:14,color:"var(--text-muted)",padding:"0 2px",lineHeight:1},title:"Wyczy",children:""}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",flexShrink:0},children:f?"":""})]}),f&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,marginTop:2,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,0.3)",maxHeight:360,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:320},children:[e.jsx("div",{style:{padding:8,borderBottom:"1px solid var(--border)"},children:e.jsx("input",{ref:b,type:"text",value:x,onChange:G=>j(G.target.value),placeholder:"Szukaj jednostki... (fuzzy)",style:{width:"100%",padding:"6px 10px",background:"var(--bg-input, var(--bg-main))",border:"1px solid var(--border)",borderRadius:5,fontSize:13,color:"var(--text-primary, inherit)",outline:"none"},onClick:G=>G.stopPropagation()})}),e.jsxs("div",{style:{overflowY:"auto",flex:1,padding:"4px 0"},children:[o&&e.jsx("div",{onClick:()=>{a(null),p(!1),j("")},style:{padding:"5px 8px",cursor:"pointer",fontSize:13,color:"var(--text-muted)",fontStyle:"italic",borderBottom:"1px solid var(--border)"},onMouseEnter:G=>G.currentTarget.style.background="var(--bg-card-hover)",onMouseLeave:G=>G.currentTarget.style.background="transparent",children:s}),C.length===0?e.jsxs("div",{style:{padding:"16px 8px",textAlign:"center",color:"var(--text-muted)",fontSize:13},children:["Brak wynikw dla ",x,'"']}):C.map(G=>e.jsx(A1,{node:G,depth:0,onSelect:O,expandedIds:y,toggleExpand:N,highlightId:r,query:x},G.id))]})]})]})}function Mi(t){return t?t==="A"?"var(--green)":t==="B"?"var(--cyan)":t==="C"?"var(--yellow)":t==="D"?"var(--orange)":"var(--red)":"var(--text-muted)"}function Ny(t){return t==="high"?"var(--red)":t==="medium"?"var(--orange)":"var(--green)"}function Ay(t){return t==="high"?"var(--red-dim)":t==="medium"?"var(--orange-dim)":"var(--green-dim)"}function rr(t){return t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function T2(t,r){const a=t*r;return a>=6?"var(--red)":a>=3?"var(--orange)":"var(--green)"}function N2(t,r,a){return t.find(s=>s.impact===r&&s.probability===a)?.count??0}function A2(t){switch(t){case"A":return"DOSKONAY";case"B":return"DOBRY";case"C":return"UMIARKOWANY";case"D":return"SABY";case"F":return"KRYTYCZNY";default:return""}}function Ey(t){switch(t){case"A":return"Doskonaa postawa bezpieczestwa. Wszystkie wymiary powyej progu akceptacji. Utrzymuj obecny standard.";case"B":return"Dobra postawa z obszarami wymagajcymi wzmocnienia. Skoncentruj si na najsabszych wymiarach.";case"C":return"Umiarkowana postawa bezpieczestwa. Wymagane s dziaania korygujce w wielu obszarach.";case"D":return"Saba postawa bezpieczestwa. Konieczne natychmiastowe dziaania naprawcze i eskalacja.";case"F":return"Krytycznie niski poziom bezpieczestwa. Wymaga natychmiastowej interwencji zarzdu.";default:return"Brak wystarczajcych danych do penej oceny."}}function Bd(t,r){const a=t.find(s=>s.label===r);return typeof a?.value=="number"?a.value:parseFloat(String(a?.value??"0"))||0}function No(t,r,a,s){if(t===1)return r;const o=t%10,d=t%100;return o>=2&&o<=4&&(d<10||d>=20)?a:s}function Ao(t,r){const a=[];for(const[s,o]of Object.entries(r))o!=null&&o!==""&&a.push(`${s}=${encodeURIComponent(o)}`);return a.length?`${t}?${a.join("&")}`:t}function E2(){const[t,r]=m.useState(null),[a,s]=m.useState(null),[o,d]=m.useState(null),[u,h]=m.useState(!0),[f,p]=m.useState([]),[x,j]=m.useState(""),y=on(),S=L=>{h(!0);const H=L?`?org_unit_id=${L}`:"";Promise.all([le.get(`/api/v1/dashboard/executive-summary${H}`).catch(()=>null),le.get(`/api/v1/dashboard/risks${H}`).catch(()=>null),le.get(`/api/v1/dashboard/posture-score${H}`).catch(()=>null)]).then(([ne,P,T])=>{r(ne),s(P),d(T)}).finally(()=>h(!1))};m.useEffect(()=>{le.get("/api/v1/org-units/tree").then(p).catch(()=>{}),S()},[]);const w=L=>{j(L),S(L||void 0)};if(u&&!t)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"adowanie dashboardu..."})});const b=o?.score??t?.posture_score??0,_=o?.grade??t?.posture_grade??null,E=2*Math.PI*54,C=E-b/100*E,N=t?.risk_counts??a?.risk_counts??{high:0,medium:0,low:0,total:0},O=t?.org_unit?.name??null,Q=O??"Caa organizacja",G=Bd(t?.kpis??[],"Otwarte podatnoci"),M=Bd(t?.kpis??[],"Otwarte incydenty"),U=Bd(t?.kpis??[],"Aktywa (CMDB)"),A=Bd(t?.kpis??[],"CMDB Coverage"),R=(()=>{if(!a?.trend||a.trend.length<2)return null;const L=a.trend,H=L[L.length-1],ne=L[L.length-2];return{delta:H.high-ne.high,totalDelta:H.total-ne.total}})(),Z=[];if(N.high>0&&Z.push({text:`${N.high} ${No(N.high,"ryzyko krytyczne wymaga","ryzyka krytyczne wymagaj","ryzyk krytycznych wymaga")} natychmiastowej uwagi`,color:"var(--red)",bg:"var(--red-dim)"}),M>0&&Z.push({text:`${M} ${No(M,"otwarty incydent","otwarte incydenty","otwartych incydentw")} bezpieczestwa`,color:"var(--red)",bg:"var(--red-dim)"}),(t?.overdue_reviews_count??0)>0&&Z.push({text:`${t.overdue_reviews_count} ${No(t.overdue_reviews_count,"przegld ryzyka przeterminowany","przegldy ryzyk przeterminowane","przegldw ryzyk przeterminowanych")}`,color:"var(--orange)",bg:"var(--orange-dim)"}),G>0&&Z.push({text:`${G} ${No(G,"otwarta podatno","otwarte podatnoci","otwartych podatnoci")} do remediacji`,color:G>5?"var(--orange)":"var(--yellow)",bg:G>5?"var(--orange-dim)":"var(--yellow-dim)"}),t?.maturity_score!=null){const L=t.maturity_score,H=t.maturity_framework_name??"Control Maturity";L<40?Z.push({text:`${H}: ${L.toFixed(1)}/100  znacznie poniej oczekiwa`,color:"var(--red)",bg:"var(--red-dim)"}):L<60?Z.push({text:`${H}: ${L.toFixed(1)}/100  wymaga poprawy`,color:"var(--orange)",bg:"var(--orange-dim)"}):L<80?Z.push({text:`${H}: ${L.toFixed(1)}/100  dobry poziom, dalszy rozwj`,color:"var(--yellow)",bg:"var(--yellow-dim)"}):Z.push({text:`${H}: ${L.toFixed(1)}/100  wysoki poziom dojrzaoci`,color:"var(--green)",bg:"var(--green-dim)"})}else if(t?.cis_maturity_rating!=null){const L=t.cis_maturity_rating;L<2?Z.push({text:`CIS Maturity ${L.toFixed(2)}/5.0  znacznie poniej oczekiwa`,color:"var(--red)",bg:"var(--red-dim)"}):L<3?Z.push({text:`CIS Maturity ${L.toFixed(2)}/5.0  wymaga poprawy`,color:"var(--orange)",bg:"var(--orange-dim)"}):L<4?Z.push({text:`CIS Maturity ${L.toFixed(2)}/5.0  dobry poziom, dalszy rozwj`,color:"var(--yellow)",bg:"var(--yellow-dim)"}):Z.push({text:`CIS Maturity ${L.toFixed(2)}/5.0  wysoki poziom dojrzaoci`,color:"var(--green)",bg:"var(--green-dim)"})}Z.length===0&&Z.push({text:"Brak krytycznych zagroe. Postawa bezpieczestwa stabilna.",color:"var(--green)",bg:"var(--green-dim)"});const F=[];N.high>0&&F.push({text:"Przegld ryzyk krytycznych",link:Ao("/risks",{level:"high",org_unit_id:x||null})}),(t?.overdue_reviews_count??0)>0&&F.push({text:"Uzupenienie zalegych przegldw",link:"/reviews"}),t?.maturity_score!=null&&t.maturity_score<60?F.push({text:"Rozwj dojrzaoci kontroli",link:"/frameworks"}):t?.cis_maturity_rating!=null&&t.cis_maturity_rating<3&&F.push({text:"Rozwj kontroli",link:"/frameworks"}),G>3&&F.push({text:"Plan remediacji podatnoci",link:"/vulnerabilities"});const q=o?.dimensions?.length?[...o.dimensions].sort((L,H)=>L.score-H.score)[0]:null;q&&q.score<70&&F.push({text:`Wzmocnienie: ${q.name}`,link:"#"});const ee=N.high>5||_==="F"?"var(--red)":N.high>0||_==="D"?"var(--orange)":_==="C"?"var(--yellow)":"var(--green)",me=Math.max(N.total,1),W=N.high/me*100,J=N.medium/me*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx(jn,{tree:f,value:x?Number(x):null,onChange:L=>w(L?String(L):""),placeholder:"Caa organizacja",allowClear:!0,style:{width:300}}),u&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odwieanie..."})]}),e.jsxs("div",{className:"toolbar-right",children:[e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:["Zakres: ",e.jsx("strong",{style:{color:"var(--text-secondary)"},children:Q})]}),o?.benchmark_avg!=null&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)",marginLeft:12},children:["Benchmark: ",e.jsxs("strong",{style:{color:rr(o.benchmark_avg)},children:[Math.round(o.benchmark_avg),"%"]})]})]})]}),e.jsx("div",{className:"card",style:{borderLeft:`4px solid ${ee}`,padding:"24px 28px",marginBottom:16,background:"linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%)"},children:e.jsxs("div",{style:{display:"flex",gap:28,alignItems:"flex-start",flexWrap:"wrap"},children:[e.jsxs("div",{style:{textAlign:"center",flexShrink:0},children:[e.jsxs("div",{style:{position:"relative",width:130,height:130},children:[e.jsxs("svg",{width:"130",height:"130",viewBox:"0 0 130 130",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"65",cy:"65",r:"54",fill:"none",stroke:"var(--border)",strokeWidth:"8"}),e.jsx("circle",{cx:"65",cy:"65",r:"54",fill:"none",stroke:Mi(_),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:E,strokeDashoffset:C,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.4,0,0.2,1)"}})]}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:32,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Mi(_),lineHeight:1},children:b?Math.round(b):""}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"/ 100"})]})]}),e.jsxs("div",{style:{display:"inline-block",marginTop:8,padding:"4px 16px",borderRadius:20,background:`${Mi(_)}18`,border:`1px solid ${Mi(_)}40`,fontSize:12,fontWeight:700,letterSpacing:"0.08em",color:Mi(_)},children:[_??"","  ",A2(_)]})]}),e.jsxs("div",{style:{flex:1,minWidth:280},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:6},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.08em",color:"var(--text-muted)"},children:"Executive Briefing"}),O&&e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:4,background:"var(--blue-dim)",color:"var(--blue)"},children:O})]}),e.jsx("div",{style:{fontSize:14,color:"var(--text-primary)",lineHeight:1.5,marginBottom:14},children:Ey(_)}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Z.map((L,H)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12},children:[e.jsx("div",{style:{width:6,height:6,borderRadius:"50%",background:L.color,flexShrink:0}}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:L.text})]},H))}),R&&e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,fontSize:11},children:[e.jsxs("span",{style:{padding:"3px 10px",borderRadius:4,background:R.delta>0?"var(--red-dim)":R.delta<0?"var(--green-dim)":"var(--blue-dim)",color:R.delta>0?"var(--red)":R.delta<0?"var(--green)":"var(--blue)",fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:[R.delta>0?`+${R.delta}`:R.delta<0?String(R.delta):"0"," ryzyk wysokich m/m",R.delta>0?" ":R.delta<0?" ":" "]}),R.totalDelta!==0&&e.jsxs("span",{style:{padding:"3px 10px",borderRadius:4,background:"var(--bg-subtle)",color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:[R.totalDelta>0?"+":"",R.totalDelta," ogem m/m"]})]})]}),F.length>0&&e.jsxs("div",{style:{flexShrink:0,minWidth:200,maxWidth:260},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Rekomendowane Dziaania"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:F.slice(0,4).map((L,H)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"7px 12px",borderRadius:6,background:"var(--bg-subtle)",border:"1px solid var(--border)",cursor:"pointer",transition:"var(--transition)",fontSize:12,color:"var(--text-secondary)"},onClick:()=>L.link!=="#"&&y(L.link),onMouseEnter:ne=>{ne.currentTarget.style.background="var(--bg-card-hover)",ne.currentTarget.style.borderColor="var(--border-light)"},onMouseLeave:ne=>{ne.currentTarget.style.background="var(--bg-subtle)",ne.currentTarget.style.borderColor="var(--border)"},children:[e.jsx("span",{style:{color:"var(--blue)",fontSize:11,flexShrink:0},children:""}),e.jsx("span",{children:L.text})]},H))})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:14,marginBottom:16},children:[e.jsxs("div",{className:"card clickable",onClick:()=>y(Ao("/risks",{org_unit_id:x||null})),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Ekspozycja na Ryzyko"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-primary)",lineHeight:1},children:N.total}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:[No(N.total,"ryzyko","ryzyka","ryzyk")," ogem"]}),e.jsxs("div",{style:{display:"flex",height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:[N.high>0&&e.jsx("div",{style:{width:`${W}%`,background:"var(--red)"}}),N.medium>0&&e.jsx("div",{style:{width:`${J}%`,background:"var(--orange)"}}),N.low>0&&e.jsx("div",{style:{flex:1,background:"var(--green)"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginTop:5,fontSize:10,fontFamily:"'JetBrains Mono',monospace"},children:[e.jsxs("span",{style:{color:"var(--red)"},children:[N.high," wys."]}),e.jsxs("span",{style:{color:"var(--orange)"},children:[N.medium," r."]}),e.jsxs("span",{style:{color:"var(--green)"},children:[N.low," nis."]})]})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/frameworks"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:t?.maturity_framework_name??"Control Maturity"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:rr(t?.maturity_score??0),lineHeight:1},children:t?.maturity_score!=null?t.maturity_score.toFixed(1):t?.cis_maturity_rating!=null?t.cis_maturity_rating.toFixed(1):""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:t?.maturity_score!=null?"maturity / 100":t?.cis_maturity_rating!=null?"maturity / 5.0":"brak oceny"}),t?.maturity_completion_pct!=null&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Kompletno oceny"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(t.maturity_completion_pct)},children:[Math.round(t.maturity_completion_pct),"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${t.maturity_completion_pct}%`,height:"100%",borderRadius:3,background:rr(t.maturity_completion_pct),transition:"width 1s ease"}})})]})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/assets"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Aktywa CMDB"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)",lineHeight:1},children:U||""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"zarejestrowanych aktyww"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Pokrycie kategorii"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(A)},children:[A,"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${A}%`,height:"100%",borderRadius:3,background:"var(--purple)",transition:"width 1s ease"}})})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/vulnerabilities"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Incydenty & Podatnoci"}),e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"baseline"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:M>0?"var(--red)":"var(--green)",lineHeight:1},children:M}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"incydentw"})]}),e.jsx("div",{style:{width:1,height:30,background:"var(--border)"}}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:G>5?"var(--orange)":G>0?"var(--yellow)":"var(--green)",lineHeight:1},children:G}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"podatnoci"})]})]}),(M>0||G>0)&&e.jsx("div",{style:{marginTop:8,padding:"3px 8px",borderRadius:4,background:M>0?"var(--red-dim)":"var(--yellow-dim)",color:M>0?"var(--red)":"var(--yellow)",fontSize:10,display:"inline-block"},children:M>0?"Wymaga natychmiastowej reakcji":"Zaplanuj remediacj"})]}),e.jsxs("div",{className:"card clickable",onClick:()=>y("/reviews"),style:{padding:"16px 18px"},children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Dyscyplina Przegldw"}),e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:(t?.overdue_reviews_count??0)>0?"var(--orange)":"var(--green)",lineHeight:1},children:t?.overdue_reviews_count??0}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"przeterminowanych"}),N.total>0&&(()=>{const L=N.total-(t?.overdue_reviews_count??0),H=Math.round(L/N.total*100);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginBottom:3},children:[e.jsx("span",{children:"Terminowo"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(H)},children:[H,"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,overflow:"hidden",background:"var(--bg-subtle)"},children:e.jsx("div",{style:{width:`${H}%`,height:"100%",borderRadius:3,background:rr(H),transition:"width 1s ease"}})})]})})()]})]}),e.jsxs("div",{className:"grid-2-1",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Macierz Ryzyka (Wpyw x Prawdopodobiestwo)"}),e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(3, 1fr)",gap:6,maxWidth:400},children:[e.jsx("div",{}),["W=1 Niski","W=2 redni","W=3 Wysoki"].map(L=>e.jsx("div",{className:"heatmap-header",children:L},L)),[3,2,1].map(L=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{className:"heatmap-label",style:{lineHeight:"40px"},children:["P=",L]}),[1,2,3].map(H=>{const ne=a?N2(a.matrix,H,L):0;return e.jsx("div",{className:"heatmap-cell",style:{background:ne>0?T2(H,L):"var(--bg-subtle)",color:ne>0?"#fff":"var(--text-muted)",height:40,opacity:ne>0?1:.5,cursor:ne>0?"pointer":"default"},onClick:()=>ne>0&&y(Ao("/risks",{impact:H,prob:L,org_unit_id:x||null})),children:ne>0?ne:""},`${H}-${L}`)})]},`row-${L}`))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:8,textAlign:"center"},children:"R = EXP(W)  P / Z | Wysoki 221  redni 31220  Niski <31"})]}),a&&a.by_area.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{className:"card-title",style:{marginBottom:10},children:"Ryzyka wg Obszarw"}),a.by_area.map(L=>e.jsxs("div",{className:"bar-row",children:[e.jsx("div",{className:"bar-label",children:L.area_name}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill",style:{width:`${Math.min(100,L.total/Math.max(1,N.total)*100)}%`,background:`linear-gradient(90deg, var(--red) ${L.high/Math.max(1,L.total)*100}%, var(--orange) ${L.high/Math.max(1,L.total)*100}%, var(--orange) ${(L.high+L.medium)/Math.max(1,L.total)*100}%, var(--green) ${(L.high+L.medium)/Math.max(1,L.total)*100}%)`},"data-value":String(L.total)})}),e.jsx("div",{className:"bar-score",style:{color:L.high>0?"var(--red)":"var(--text-secondary)"},children:L.total})]},L.area_id))]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",style:{textAlign:"center",paddingBottom:16},children:[e.jsx("div",{className:"card-title",children:"Security Score"}),e.jsx("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"},children:e.jsxs("div",{className:"score-ring",style:{width:140,height:140},children:[e.jsxs("svg",{width:"140",height:"140",viewBox:"0 0 140 140",style:{transform:"rotate(-90deg)"},children:[e.jsx("circle",{cx:"70",cy:"70",r:"58",fill:"none",stroke:"var(--border)",strokeWidth:"8"}),e.jsx("circle",{cx:"70",cy:"70",r:"58",fill:"none",stroke:Mi(_),strokeWidth:"8",strokeLinecap:"round",strokeDasharray:2*Math.PI*58,strokeDashoffset:2*Math.PI*58-b/100*2*Math.PI*58,style:{transition:"stroke-dashoffset 1.5s cubic-bezier(0.4,0,0.2,1)"}})]}),e.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:34,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Mi(_),lineHeight:1},children:b?Math.round(b):""}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:"/ 100"})]})]})}),_&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:Mi(_)},children:_}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",marginTop:2,lineHeight:1.4,padding:"0 8px"},children:Ey(_)})]}),o?.benchmark_avg!=null&&e.jsxs("div",{style:{marginTop:10,padding:"6px 12px",borderRadius:6,background:"var(--bg-subtle)",display:"inline-flex",alignItems:"center",gap:6,fontSize:11},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"vs. rednia org:"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:b>=o.benchmark_avg?"var(--green)":"var(--orange)"},children:[b>=o.benchmark_avg?"+":"",(b-o.benchmark_avg).toFixed(0)," pkt"]})]})]}),o&&o.dimensions.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Filary Security Score"}),o.dimensions.map(L=>{const H=q?.name===L.name&&L.score<70;return e.jsxs("div",{style:{marginBottom:12,padding:H?"8px 10px":0,borderRadius:6,background:H?"rgba(239,68,68,0.05)":"transparent",border:H?"1px solid rgba(239,68,68,0.15)":"1px solid transparent"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:3},children:[e.jsxs("span",{style:{color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:4},children:[L.name,H&&e.jsx("span",{style:{fontSize:9,color:"var(--red)",fontWeight:600},children:"WYMAGA UWAGI"})]}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(L.score)},children:[Math.round(L.score),"%",e.jsxs("span",{style:{fontSize:9,color:"var(--text-muted)",marginLeft:4},children:["(",Math.round(L.weight*100),"%)"]})]})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${L.score}%`,background:L.color??rr(L.score),height:8}})}),e.jsx("div",{style:{position:"absolute",left:"70%",top:-2,width:1,height:12,background:"var(--text-muted)",opacity:.4}})]})]},L.name)}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginTop:6,fontSize:10,color:"var(--text-muted)"},children:[e.jsx("div",{style:{width:1,height:10,background:"var(--text-muted)",opacity:.4}}),e.jsx("span",{children:"Prg akceptacji: 70%"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:t?.maturity_framework_name??"Control Maturity"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:14},children:[e.jsx("div",{style:{fontSize:28,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:rr(t?.maturity_score??t?.cis_maturity_rating?t.cis_maturity_rating/5*100:0)},children:t?.maturity_score!=null?t.maturity_score.toFixed(1):t?.cis_maturity_rating?.toFixed(2)??""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12},children:"Maturity Score"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:t?.maturity_score!=null?"Skala 0100":"Skala 05"})]})]}),t?.maturity_completion_pct!=null&&e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:3},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:"Kompletno oceny"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:rr(t.maturity_completion_pct)},children:[Math.round(t.maturity_completion_pct),"%"]})]}),e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${t.maturity_completion_pct}%`,background:rr(t.maturity_completion_pct),height:8}})})]})]})]})]}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Top 5 Ryzyk Krytycznych"}),t?.top_risks&&t.top_risks.length>0?e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ocena"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.top_risks.slice(0,5).map(L=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>y(Ao("/risks",{highlight:L.id})),children:[e.jsx("td",{style:{fontWeight:500},children:L.asset_name}),e.jsx("td",{style:{fontSize:12},children:L.org_unit}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:Ay(L.risk_level),color:Ny(L.risk_level)},children:Number(L.risk_score).toFixed(1)})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)"},children:L.status??""})]},L.id))})]}):e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Brak danych o ryzykach."})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Rozkad Ryzyk"}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:16},children:[{label:"Wysokie",count:N.high,color:"var(--red)",bg:"var(--red-dim)",level:"high"},{label:"rednie",count:N.medium,color:"var(--orange)",bg:"var(--orange-dim)",level:"medium"},{label:"Niskie",count:N.low,color:"var(--green)",bg:"var(--green-dim)",level:"low"}].map(L=>e.jsxs("div",{style:{flex:1,textAlign:"center",background:L.bg,borderRadius:8,padding:"12px 8px",cursor:"pointer"},onClick:()=>y(Ao("/risks",{level:L.level,org_unit_id:x||null})),children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:L.color},children:L.count}),e.jsx("div",{style:{fontSize:11,color:L.color},children:L.label})]},L.label))}),a&&a.by_org_unit.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Ryzyka wg Pionw"}),a.by_org_unit.map(L=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:12},children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:L.org_unit_name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[L.high>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:L.high}),L.medium>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--orange-dim)",color:"var(--orange)"},children:L.medium}),L.low>0&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:L.low})]})]},L.org_unit_id))]})]})]}),a&&a.by_status.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Status Ryzyk"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.by_status.map(L=>e.jsxs("div",{style:{background:L.status_color?`${L.status_color}20`:"var(--bg-card)",border:`1px solid ${L.status_color??"var(--border)"}`,borderRadius:8,padding:"10px 16px",textAlign:"center",minWidth:100},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:L.status_color??"var(--text)"},children:L.count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:L.status})]},L.status))})]}),a&&a.trend.length>1&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Trend Ryzyk (12 mies.)"}),e.jsx("div",{style:{display:"flex",gap:2,alignItems:"flex-end",height:120},children:a.trend.map(L=>{const H=Math.max(...a.trend.map(z=>z.total),1),ne=L.total/H*100,P=L.high/Math.max(L.total,1)*100,T=L.medium/Math.max(L.total,1)*100;return e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("div",{style:{fontSize:9,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-muted)"},children:L.total}),e.jsxs("div",{style:{width:"100%",maxWidth:40,height:`${ne}%`,minHeight:2,borderRadius:"4px 4px 0 0",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:"100%",background:"var(--green)"}}),e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:`${P+T}%`,background:"var(--orange)"}}),e.jsx("div",{style:{position:"absolute",bottom:0,width:"100%",height:`${P}%`,background:"var(--red)"}})]}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",whiteSpace:"nowrap"},children:L.period})]},L.period)})}),e.jsx("div",{style:{display:"flex",gap:16,justifyContent:"center",marginTop:10},children:[{label:"Wysokie",color:"var(--red)"},{label:"rednie",color:"var(--orange)"},{label:"Niskie",color:"var(--green)"}].map(L=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:10,color:"var(--text-muted)"},children:[e.jsx("div",{style:{width:8,height:8,borderRadius:2,background:L.color}})," ",L.label]},L.label))})]}),a&&a.overdue_reviews.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-title",children:["Przeterminowane Przegldy",e.jsxs("span",{style:{fontSize:11,color:"var(--red)",marginLeft:8},children:["(",a.overdue_reviews.length,")"]})]}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ocena"}),e.jsx("th",{children:"Dni od przegldu"}),e.jsx("th",{children:"Waciciel"})]})}),e.jsx("tbody",{children:a.overdue_reviews.slice(0,10).map(L=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:L.asset_name}),e.jsx("td",{style:{fontSize:12},children:L.org_unit}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:Ay(L.risk_level),color:Ny(L.risk_level)},children:Number(L.risk_score).toFixed(1)})}),e.jsx("td",{children:e.jsxs("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:[L.days_since_review," dni"]})}),e.jsx("td",{style:{fontSize:12,color:"var(--text-secondary)"},children:L.owner??""})]},L.id))})]})]})]})}function F1(t,r=0){const a=[];for(const s of t)a.push({id:s.id,name:s.name,depth:r}),a.push(...F1(s.children,r+1));return a}function Cl(t,r=""){const a=new Map;for(const s of t){const o=r?`${r}\\${s.name}`:s.name;a.set(s.id,o),Cl(s.children,o).forEach((u,h)=>a.set(h,u))}return a}function gt({open:t,onClose:r,title:a,children:s,wide:o}){const d=m.useRef(null);return m.useEffect(()=>{const u=h=>{h.key==="Escape"&&r()};return t&&document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[t,r]),t?e.jsx("div",{ref:d,className:"modal-overlay active",onClick:u=>{u.target===d.current&&r()},children:e.jsxs("div",{className:"modal",style:o?{maxWidth:900}:void 0,children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:a}),e.jsx("button",{className:"modal-close",onClick:r,children:""})]}),e.jsx("div",{className:"modal-body",children:s})]})}):null}var gu={};gu.version="0.18.5";var R1=1252,F2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],B1=function(t){F2.indexOf(t)!=-1&&(R1=t)};function R2(){B1(1252)}var ec=function(t){B1(t)};function B2(){ec(1200),R2()}var Od=function(r){return String.fromCharCode(r)},Fy=function(r){return String.fromCharCode(r)},xu,$i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tc(t){for(var r="",a=0,s=0,o=0,d=0,u=0,h=0,f=0,p=0;p<t.length;)a=t.charCodeAt(p++),d=a>>2,s=t.charCodeAt(p++),u=(a&3)<<4|s>>4,o=t.charCodeAt(p++),h=(s&15)<<2|o>>6,f=o&63,isNaN(s)?h=f=64:isNaN(o)&&(f=64),r+=$i.charAt(d)+$i.charAt(u)+$i.charAt(h)+$i.charAt(f);return r}function oi(t){var r="",a=0,s=0,o=0,d=0,u=0,h=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<t.length;)d=$i.indexOf(t.charAt(p++)),u=$i.indexOf(t.charAt(p++)),a=d<<2|u>>4,r+=String.fromCharCode(a),h=$i.indexOf(t.charAt(p++)),s=(u&15)<<4|h>>2,h!==64&&(r+=String.fromCharCode(s)),f=$i.indexOf(t.charAt(p++)),o=(h&3)<<6|f,f!==64&&(r+=String.fromCharCode(o));return r}var Vt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),di=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,a){return a?new Buffer(r,a):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function js(t){return Vt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ry(t){return Vt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var wr=function(r){return Vt?di(r,"binary"):r.split("").map(function(a){return a.charCodeAt(0)&255})};function Lu(t){if(typeof ArrayBuffer>"u")return wr(t);for(var r=new ArrayBuffer(t.length),a=new Uint8Array(r),s=0;s!=t.length;++s)a[s]=t.charCodeAt(s)&255;return r}function hc(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],a=0;a<t.length;++a)r[a]=String.fromCharCode(t[a]);return r.join("")}function O2(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var nn=Vt?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:di(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,a=0;for(r=0;r<t.length;++r)a+=t[r].length;var s=new Uint8Array(a),o=0;for(r=0,a=0;r<t.length;a+=o,++r)if(o=t[r].length,t[r]instanceof Uint8Array)s.set(t[r],a);else{if(typeof t[r]=="string")throw"wtf";s.set(new Uint8Array(t[r]),a)}return s}return[].concat.apply([],t.map(function(d){return Array.isArray(d)?d:[].slice.call(d)}))};function D2(t){for(var r=[],a=0,s=t.length+250,o=js(t.length+255),d=0;d<t.length;++d){var u=t.charCodeAt(d);if(u<128)o[a++]=u;else if(u<2048)o[a++]=192|u>>6&31,o[a++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var h=t.charCodeAt(++d)&1023;o[a++]=240|u>>8&7,o[a++]=128|u>>2&63,o[a++]=128|h>>6&15|(u&3)<<4,o[a++]=128|h&63}else o[a++]=224|u>>12&15,o[a++]=128|u>>6&63,o[a++]=128|u&63;a>s&&(r.push(o.slice(0,a)),a=0,o=js(65535),s=65530)}return r.push(o.slice(0,a)),nn(r)}var Ho=/\u0000/g,Dd=/[\u0001-\u0006]/g;function yl(t){for(var r="",a=t.length-1;a>=0;)r+=t.charAt(a--);return r}function kr(t,r){var a=""+t;return a.length>=r?a:wa("0",r-a.length)+a}function dp(t,r){var a=""+t;return a.length>=r?a:wa(" ",r-a.length)+a}function yu(t,r){var a=""+t;return a.length>=r?a:a+wa(" ",r-a.length)}function L2(t,r){var a=""+Math.round(t);return a.length>=r?a:wa("0",r-a.length)+a}function M2(t,r){var a=""+t;return a.length>=r?a:wa("0",r-a.length)+a}var By=Math.pow(2,32);function cl(t,r){if(t>By||t<-By)return L2(t,r);var a=Math.round(t);return M2(a,r)}function vu(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Oy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function I2(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ka={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Dy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},P2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ju(t,r,a){for(var s=t<0?-1:1,o=t*s,d=0,u=1,h=0,f=1,p=0,x=0,j=Math.floor(o);p<r&&(j=Math.floor(o),h=j*u+d,x=j*p+f,!(o-j<5e-8));)o=1/(o-j),d=u,u=h,f=p,p=x;if(x>r&&(p>r?(x=f,h=d):(x=p,h=u)),!a)return[0,s*h,x];var y=Math.floor(s*h/x);return[y,s*h-y*x,x]}function Ld(t,r,a){if(t>2958465||t<0)return null;var s=t|0,o=Math.floor(86400*(t-s)),d=0,u=[],h={D:s,T:o,u:86400*(t-s)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),r&&r.date1904&&(s+=1462),h.u>.9999&&(h.u=0,++o==86400&&(h.T=o=0,++s,++h.D)),s===60)u=a?[1317,10,29]:[1900,2,29],d=3;else if(s===0)u=a?[1317,8,29]:[1900,1,0],d=6;else{s>60&&--s;var f=new Date(1900,0,1);f.setDate(f.getDate()+s-1),u=[f.getFullYear(),f.getMonth()+1,f.getDate()],d=f.getDay(),s<60&&(d=(d+6)%7),a&&(d=G2(f,u))}return h.y=u[0],h.m=u[1],h.d=u[2],h.S=o%60,o=Math.floor(o/60),h.M=o%60,o=Math.floor(o/60),h.H=o,h.q=d,h}var O1=new Date(1899,11,31,0,0,0),W2=O1.getTime(),U2=new Date(1900,2,1,0,0,0);function D1(t,r){var a=t.getTime();return r?a-=1461*24*60*60*1e3:t>=U2&&(a+=1440*60*1e3),(a-(W2+(t.getTimezoneOffset()-O1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function up(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $2(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H2(t){var r=t<0?12:11,a=up(t.toFixed(12));return a.length<=r||(a=t.toPrecision(10),a.length<=r)?a:t.toExponential(5)}function V2(t){var r=up(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Z2(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),a;return r>=-4&&r<=-1?a=t.toPrecision(10+r):Math.abs(r)<=9?a=H2(t):r===10?a=t.toFixed(10).substr(0,12):a=V2(t),up($2(a.toUpperCase()))}function Gm(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Z2(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Zi(14,D1(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function G2(t,r){r[0]-=581;var a=t.getDay();return t<60&&(a=(a+6)%7),a}function K2(t,r,a,s){var o="",d=0,u=0,h=a.y,f,p=0;switch(t){case 98:h=a.y+543;case 121:switch(r.length){case 1:case 2:f=h%100,p=2;break;default:f=h%1e4,p=4;break}break;case 109:switch(r.length){case 1:case 2:f=a.m,p=r.length;break;case 3:return nm[a.m-1][1];case 5:return nm[a.m-1][0];default:return nm[a.m-1][2]}break;case 100:switch(r.length){case 1:case 2:f=a.d,p=r.length;break;case 3:return Oy[a.q][0];default:return Oy[a.q][1]}break;case 104:switch(r.length){case 1:case 2:f=1+(a.H+11)%12,p=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:f=a.H,p=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:f=a.M,p=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return a.u===0&&(r=="s"||r=="ss")?kr(a.S,r.length):(s>=2?u=s===3?1e3:100:u=s===1?10:1,d=Math.round(u*(a.S+a.u)),d>=60*u&&(d=0),r==="s"?d===0?"0":""+d/u:(o=kr(d,2+s),r==="ss"?o.substr(0,2):"."+o.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":f=a.D*24+a.H;break;case"[m]":case"[mm]":f=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":f=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+r}p=r.length===3?1:2;break;case 101:f=h,p=1;break}var x=p>0?kr(f,p):"";return x}function Hi(t){var r=3;if(t.length<=r)return t;for(var a=t.length%r,s=t.substr(0,a);a!=t.length;a+=r)s+=(s.length>0?",":"")+t.substr(a,r);return s}var L1=/%/g;function q2(t,r,a){var s=r.replace(L1,""),o=r.length-s.length;return ri(t,s,a*Math.pow(10,2*o))+wa("%",o)}function Y2(t,r,a){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return ri(t,r.substr(0,s),a/Math.pow(10,3*(r.length-s)))}function M1(t,r){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+M1(t,-r);var o=t.indexOf(".");o===-1&&(o=t.indexOf("E"));var d=Math.floor(Math.log(r)*Math.LOG10E)%o;if(d<0&&(d+=o),a=(r/Math.pow(10,d)).toPrecision(s+1+(o+d)%o),a.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+d):a+="E+"+(u-d);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,o)+"."+a.substr(2+o),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,p,x){return f+p+x.substr(0,(o+d)%o)+"."+x.substr(d)+"E"})}else a=r.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var I1=/# (\?+)( ?)\/( ?)(\d+)/;function J2(t,r,a){var s=parseInt(t[4],10),o=Math.round(r*s),d=Math.floor(o/s),u=o-d*s,h=s;return a+(d===0?"":""+d)+" "+(u===0?wa(" ",t[1].length+1+t[4].length):dp(u,t[1].length)+t[2]+"/"+t[3]+kr(h,t[4].length))}function X2(t,r,a){return a+(r===0?"":""+r)+wa(" ",t[1].length+2+t[4].length)}var P1=/^#*0*\.([0#]+)/,W1=/\).*[0#]/,U1=/\(###\) ###\\?-####/;function xn(t){for(var r="",a,s=0;s!=t.length;++s)switch(a=t.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(a)}return r}function Ly(t,r){var a=Math.pow(10,r);return""+Math.round(t*a)/a}function My(t,r){var a=t-Math.floor(t),s=Math.pow(10,r);return r<(""+Math.round(a*s)).length?0:Math.round(a*s)}function Q2(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function ek(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function sr(t,r,a){if(t.charCodeAt(0)===40&&!r.match(W1)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?sr("n",s,a):"("+sr("n",s,-a)+")"}if(r.charCodeAt(r.length-1)===44)return Y2(t,r,a);if(r.indexOf("%")!==-1)return q2(t,r,a);if(r.indexOf("E")!==-1)return M1(r,a);if(r.charCodeAt(0)===36)return"$"+sr(t,r.substr(r.charAt(1)==" "?2:1),a);var o,d,u,h,f=Math.abs(a),p=a<0?"-":"";if(r.match(/^00+$/))return p+cl(f,r.length);if(r.match(/^[#?]+$/))return o=cl(a,0),o==="0"&&(o=""),o.length>r.length?o:xn(r.substr(0,r.length-o.length))+o;if(d=r.match(I1))return J2(d,f,p);if(r.match(/^#+0+$/))return p+cl(f,r.length-r.indexOf("0"));if(d=r.match(P1))return o=Ly(a,d[1].length).replace(/^([^\.]+)$/,"$1."+xn(d[1])).replace(/\.$/,"."+xn(d[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+wa("0",xn(d[1]).length-b.length)}),r.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),d=r.match(/^(0*)\.(#*)$/))return p+Ly(f,d[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=r.match(/^#{1,3},##0(\.?)$/))return p+Hi(cl(f,0));if(d=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+sr(t,r,-a):Hi(""+(Math.floor(a)+Q2(a,d[1].length)))+"."+kr(My(a,d[1].length),d[1].length);if(d=r.match(/^#,#*,#0/))return sr(t,r.replace(/^#,#*,/,""),a);if(d=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=yl(sr(t,r.replace(/[\\-]/g,""),a)),u=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<o.length?o.charAt(u++):w==="0"?"0":""}));if(r.match(U1))return o=sr(t,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(d=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(d[4].length,7),h=ju(f,Math.pow(10,u)-1,!1),o=""+p,x=ri("n",d[1],h[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+d[2]+"/"+d[3],x=yu(h[2],u),x.length<d[4].length&&(x=xn(d[4].substr(d[4].length-x.length))+x),o+=x,o;if(d=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(d[1].length,d[4].length),7),h=ju(f,Math.pow(10,u)-1,!0),p+(h[0]||(h[1]?"":"0"))+" "+(h[1]?dp(h[1],u)+d[2]+"/"+d[3]+yu(h[2],u):wa(" ",2*u+1+d[2].length+d[3].length));if(d=r.match(/^[#0?]+$/))return o=cl(a,0),r.length<=o.length?o:xn(r.substr(0,r.length-o.length))+o;if(d=r.match(/^([#0?]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var j=r.indexOf(".")-u,y=r.length-o.length-j;return xn(r.substr(0,j)+o+r.substr(r.length-y))}if(d=r.match(/^00,000\.([#0]*0)$/))return u=My(a,d[1].length),a<0?"-"+sr(t,r,-a):Hi(ek(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kr(0,3-w.length):"")+w})+"."+kr(u,d[1].length);switch(r){case"###,##0.00":return sr(t,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var S=Hi(cl(f,0));return S!=="0"?p+S:"";case"###,###.00":return sr(t,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return sr(t,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function tk(t,r,a){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return ri(t,r.substr(0,s),a/Math.pow(10,3*(r.length-s)))}function ak(t,r,a){var s=r.replace(L1,""),o=r.length-s.length;return ri(t,s,a*Math.pow(10,2*o))+wa("%",o)}function $1(t,r){var a,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+$1(t,-r);var o=t.indexOf(".");o===-1&&(o=t.indexOf("E"));var d=Math.floor(Math.log(r)*Math.LOG10E)%o;if(d<0&&(d+=o),a=(r/Math.pow(10,d)).toPrecision(s+1+(o+d)%o),!a.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+d):a+="E+"+(u-d),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,f,p,x){return f+p+x.substr(0,(o+d)%o)+"."+x.substr(d)+"E"})}else a=r.toExponential(s);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function Rr(t,r,a){if(t.charCodeAt(0)===40&&!r.match(W1)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Rr("n",s,a):"("+Rr("n",s,-a)+")"}if(r.charCodeAt(r.length-1)===44)return tk(t,r,a);if(r.indexOf("%")!==-1)return ak(t,r,a);if(r.indexOf("E")!==-1)return $1(r,a);if(r.charCodeAt(0)===36)return"$"+Rr(t,r.substr(r.charAt(1)==" "?2:1),a);var o,d,u,h,f=Math.abs(a),p=a<0?"-":"";if(r.match(/^00+$/))return p+kr(f,r.length);if(r.match(/^[#?]+$/))return o=""+a,a===0&&(o=""),o.length>r.length?o:xn(r.substr(0,r.length-o.length))+o;if(d=r.match(I1))return X2(d,f,p);if(r.match(/^#+0+$/))return p+kr(f,r.length-r.indexOf("0"));if(d=r.match(P1))return o=(""+a).replace(/^([^\.]+)$/,"$1."+xn(d[1])).replace(/\.$/,"."+xn(d[1])),o=o.replace(/\.(\d*)$/,function(w,b){return"."+b+wa("0",xn(d[1]).length-b.length)}),r.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),d=r.match(/^(0*)\.(#*)$/))return p+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,d[1].length?"0.":".");if(d=r.match(/^#{1,3},##0(\.?)$/))return p+Hi(""+f);if(d=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Rr(t,r,-a):Hi(""+a)+"."+wa("0",d[1].length);if(d=r.match(/^#,#*,#0/))return Rr(t,r.replace(/^#,#*,/,""),a);if(d=r.match(/^([0#]+)(\\?-([0#]+))+$/))return o=yl(Rr(t,r.replace(/[\\-]/g,""),a)),u=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<o.length?o.charAt(u++):w==="0"?"0":""}));if(r.match(U1))return o=Rr(t,"##########",a),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(d=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(d[4].length,7),h=ju(f,Math.pow(10,u)-1,!1),o=""+p,x=ri("n",d[1],h[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+d[2]+"/"+d[3],x=yu(h[2],u),x.length<d[4].length&&(x=xn(d[4].substr(d[4].length-x.length))+x),o+=x,o;if(d=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(d[1].length,d[4].length),7),h=ju(f,Math.pow(10,u)-1,!0),p+(h[0]||(h[1]?"":"0"))+" "+(h[1]?dp(h[1],u)+d[2]+"/"+d[3]+yu(h[2],u):wa(" ",2*u+1+d[2].length+d[3].length));if(d=r.match(/^[#0?]+$/))return o=""+a,r.length<=o.length?o:xn(r.substr(0,r.length-o.length))+o;if(d=r.match(/^([#0]+)\.([#0]+)$/)){o=""+a.toFixed(Math.min(d[2].length,10)).replace(/([^0])0+$/,"$1"),u=o.indexOf(".");var j=r.indexOf(".")-u,y=r.length-o.length-j;return xn(r.substr(0,j)+o+r.substr(r.length-y))}if(d=r.match(/^00,000\.([#0]*0)$/))return a<0?"-"+Rr(t,r,-a):Hi(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?kr(0,3-w.length):"")+w})+"."+kr(0,d[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=Hi(""+f);return S!=="0"?p+S:"";default:if(r.match(/\.[0#?]*$/))return Rr(t,r.slice(0,r.lastIndexOf(".")),a)+xn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ri(t,r,a){return(a|0)===a?Rr(t,r,a):sr(t,r,a)}function nk(t){for(var r=[],a=!1,s=0,o=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:a=!a;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=t.substr(o,s-o),o=s+1}if(r[r.length]=t.substr(o),a===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var H1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function V1(t){for(var r=0,a="",s="";r<t.length;)switch(a=t.charAt(r)){case"G":vu(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(s=a;t.charAt(r++)!=="]"&&r<t.length;)s+=t.charAt(r);if(s.match(H1))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(a=t.charAt(++r))>-1||a=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===a;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function rk(t,r,a,s){for(var o=[],d="",u=0,h="",f="t",p,x,j,y="H";u<t.length;)switch(h=t.charAt(u)){case"G":if(!vu(t,u))throw new Error("unrecognized character "+h+" in "+t);o[o.length]={t:"G",v:"General"},u+=7;break;case'"':for(d="";(j=t.charCodeAt(++u))!==34&&u<t.length;)d+=String.fromCharCode(j);o[o.length]={t:"t",v:d},++u;break;case"\\":var S=t.charAt(++u),w=S==="("||S===")"?S:"t";o[o.length]={t:w,v:S},++u;break;case"_":o[o.length]={t:"t",v:" "},u+=2;break;case"@":o[o.length]={t:"T",v:r},++u;break;case"B":case"b":if(t.charAt(u+1)==="1"||t.charAt(u+1)==="2"){if(p==null&&(p=Ld(r,a,t.charAt(u+1)==="2"),p==null))return"";o[o.length]={t:"X",v:t.substr(u,2)},f=h,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||p==null&&(p=Ld(r,a),p==null))return"";for(d=h;++u<t.length&&t.charAt(u).toLowerCase()===h;)d+=h;h==="m"&&f.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),o[o.length]={t:h,v:d},f=h;break;case"A":case"a":case"":var b={t:h,v:h};if(p==null&&(p=Ld(r,a)),t.substr(u,3).toUpperCase()==="A/P"?(p!=null&&(b.v=p.H>=12?"P":"A"),b.t="T",y="h",u+=3):t.substr(u,5).toUpperCase()==="AM/PM"?(p!=null&&(b.v=p.H>=12?"PM":"AM"),b.t="T",u+=5,y="h"):t.substr(u,5).toUpperCase()==="/"?(p!=null&&(b.v=p.H>=12?"":""),b.t="T",u+=5,y="h"):(b.t="t",++u),p==null&&b.t==="T")return"";o[o.length]=b,f=h;break;case"[":for(d=h;t.charAt(u++)!=="]"&&u<t.length;)d+=t.charAt(u);if(d.slice(-1)!=="]")throw'unterminated "[" block: |'+d+"|";if(d.match(H1)){if(p==null&&(p=Ld(r,a),p==null))return"";o[o.length]={t:"Z",v:d.toLowerCase()},f=d.charAt(1)}else d.indexOf("$")>-1&&(d=(d.match(/\$([^-\[\]]*)/)||[])[1]||"$",V1(t)||(o[o.length]={t:"t",v:d}));break;case".":if(p!=null){for(d=h;++u<t.length&&(h=t.charAt(u))==="0";)d+=h;o[o.length]={t:"s",v:d};break}case"0":case"#":for(d=h;++u<t.length&&"0#?.,E+-%".indexOf(h=t.charAt(u))>-1;)d+=h;o[o.length]={t:"n",v:d};break;case"?":for(d=h;t.charAt(++u)===h;)d+=h;o[o.length]={t:h,v:d},f=h;break;case"*":++u,(t.charAt(u)==" "||t.charAt(u)=="*")&&++u;break;case"(":case")":o[o.length]={t:s===1?"t":h,v:h},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(d=h;u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1;)d+=t.charAt(u);o[o.length]={t:"D",v:d};break;case" ":o[o.length]={t:h,v:h},++u;break;case"$":o[o.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+t);o[o.length]={t:"t",v:h},++u;break}var _=0,E=0,C;for(u=o.length-1,f="t";u>=0;--u)switch(o[u].t){case"h":case"H":o[u].t=y,f="h",_<1&&(_=1);break;case"s":(C=o[u].v.match(/\.0+$/))&&(E=Math.max(E,C[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=o[u].t;break;case"m":f==="s"&&(o[u].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&o[u].v.match(/[Hh]/)&&(_=1),_<2&&o[u].v.match(/[Mm]/)&&(_=2),_<3&&o[u].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var N="",O;for(u=0;u<o.length;++u)switch(o[u].t){case"t":case"T":case" ":case"D":break;case"X":o[u].v="",o[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[u].v=K2(o[u].t.charCodeAt(0),o[u].v,p,E),o[u].t="t";break;case"n":case"?":for(O=u+1;o[O]!=null&&((h=o[O].t)==="?"||h==="D"||(h===" "||h==="t")&&o[O+1]!=null&&(o[O+1].t==="?"||o[O+1].t==="t"&&o[O+1].v==="/")||o[u].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(o[O].v==="/"||o[O].v===" "&&o[O+1]!=null&&o[O+1].t=="?"));)o[u].v+=o[O].v,o[O]={v:"",t:";"},++O;N+=o[u].v,u=O-1;break;case"G":o[u].t="t",o[u].v=Gm(r,a);break}var Q="",G,M;if(N.length>0){N.charCodeAt(0)==40?(G=r<0&&N.charCodeAt(0)===45?-r:r,M=ri("n",N,G)):(G=r<0&&s>1?-r:r,M=ri("n",N,G),G<0&&o[0]&&o[0].t=="t"&&(M=M.substr(1),o[0].v="-"+o[0].v)),O=M.length-1;var U=o.length;for(u=0;u<o.length;++u)if(o[u]!=null&&o[u].t!="t"&&o[u].v.indexOf(".")>-1){U=u;break}var A=o.length;if(U===o.length&&M.indexOf("E")===-1){for(u=o.length-1;u>=0;--u)o[u]==null||"n?".indexOf(o[u].t)===-1||(O>=o[u].v.length-1?(O-=o[u].v.length,o[u].v=M.substr(O+1,o[u].v.length)):O<0?o[u].v="":(o[u].v=M.substr(0,O+1),O=-1),o[u].t="t",A=u);O>=0&&A<o.length&&(o[A].v=M.substr(0,O+1)+o[A].v)}else if(U!==o.length&&M.indexOf("E")===-1){for(O=M.indexOf(".")-1,u=U;u>=0;--u)if(!(o[u]==null||"n?".indexOf(o[u].t)===-1)){for(x=o[u].v.indexOf(".")>-1&&u===U?o[u].v.indexOf(".")-1:o[u].v.length-1,Q=o[u].v.substr(x+1);x>=0;--x)O>=0&&(o[u].v.charAt(x)==="0"||o[u].v.charAt(x)==="#")&&(Q=M.charAt(O--)+Q);o[u].v=Q,o[u].t="t",A=u}for(O>=0&&A<o.length&&(o[A].v=M.substr(0,O+1)+o[A].v),O=M.indexOf(".")+1,u=U;u<o.length;++u)if(!(o[u]==null||"n?(".indexOf(o[u].t)===-1&&u!==U)){for(x=o[u].v.indexOf(".")>-1&&u===U?o[u].v.indexOf(".")+1:0,Q=o[u].v.substr(0,x);x<o[u].v.length;++x)O<M.length&&(Q+=M.charAt(O++));o[u].v=Q,o[u].t="t",A=u}}}for(u=0;u<o.length;++u)o[u]!=null&&"n?".indexOf(o[u].t)>-1&&(G=s>1&&r<0&&u>0&&o[u-1].v==="-"?-r:r,o[u].v=ri(o[u].t,o[u].v,G),o[u].t="t");var R="";for(u=0;u!==o.length;++u)o[u]!=null&&(R+=o[u].v);return R}var Iy=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Py(t,r){if(r==null)return!1;var a=parseFloat(r[2]);switch(r[1]){case"=":if(t==a)return!0;break;case">":if(t>a)return!0;break;case"<":if(t<a)return!0;break;case"<>":if(t!=a)return!0;break;case">=":if(t>=a)return!0;break;case"<=":if(t<=a)return!0;break}return!1}function ik(t,r){var a=nk(t),s=a.length,o=a[s-1].indexOf("@");if(s<4&&o>-1&&--s,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof r!="number")return[4,a.length===4||o>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=o>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=o>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=o>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var d=r>0?a[0]:r<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[s,d];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var u=a[0].match(Iy),h=a[1].match(Iy);return Py(r,u)?[s,a[0]]:Py(r,h)?[s,a[1]]:[s,a[u!=null&&h!=null?2:1]]}return[s,d]}function Zi(t,r,a){a==null&&(a={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&a.dateNF?s=a.dateNF:s=t;break;case"number":t==14&&a.dateNF?s=a.dateNF:s=(a.table!=null?a.table:ka)[t],s==null&&(s=a.table&&a.table[Dy[t]]||ka[Dy[t]]),s==null&&(s=P2[t]||"General");break}if(vu(s,0))return Gm(r,a);r instanceof Date&&(r=D1(r,a.date1904));var o=ik(s,r);if(vu(o[1]))return Gm(r,a);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return rk(o[1],r,a,o[0])}function Z1(t,r){if(typeof r!="number"){r=+r||-1;for(var a=0;a<392;++a){if(ka[a]==null){r<0&&(r=a);continue}if(ka[a]==t){r=a;break}}r<0&&(r=391)}return ka[r]=t,r}function Mu(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Z1(t[r],r)}function Iu(){ka=I2()}var G1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function sk(t){var r=typeof t=="number"?ka[t]:t;return r=r.replace(G1,"(\\d+)"),new RegExp("^"+r+"$")}function lk(t,r,a){var s=-1,o=-1,d=-1,u=-1,h=-1,f=-1;(r.match(G1)||[]).forEach(function(j,y){var S=parseInt(a[y+1],10);switch(j.toLowerCase().charAt(0)){case"y":s=S;break;case"d":d=S;break;case"h":u=S;break;case"s":f=S;break;case"m":u>=0?h=S:o=S;break}}),f>=0&&h==-1&&o>=0&&(h=o,o=-1);var p=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(d>=1?d:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var x=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return u==-1&&h==-1&&f==-1?p:s==-1&&o==-1&&d==-1?x:p+"T"+x}var ok=(function(){var t={};t.version="1.2.0";function r(){for(var M=0,U=new Array(256),A=0;A!=256;++A)M=A,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,U[A]=M;return typeof Int32Array<"u"?new Int32Array(U):U}var a=r();function s(M){var U=0,A=0,R=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)Z[R]=M[R];for(R=0;R!=256;++R)for(A=M[R],U=256+R;U<4096;U+=256)A=Z[U]=A>>>8^M[A&255];var F=[];for(R=1;R!=16;++R)F[R-1]=typeof Int32Array<"u"?Z.subarray(R*256,R*256+256):Z.slice(R*256,R*256+256);return F}var o=s(a),d=o[0],u=o[1],h=o[2],f=o[3],p=o[4],x=o[5],j=o[6],y=o[7],S=o[8],w=o[9],b=o[10],_=o[11],E=o[12],C=o[13],N=o[14];function O(M,U){for(var A=U^-1,R=0,Z=M.length;R<Z;)A=A>>>8^a[(A^M.charCodeAt(R++))&255];return~A}function Q(M,U){for(var A=U^-1,R=M.length-15,Z=0;Z<R;)A=N[M[Z++]^A&255]^C[M[Z++]^A>>8&255]^E[M[Z++]^A>>16&255]^_[M[Z++]^A>>>24]^b[M[Z++]]^w[M[Z++]]^S[M[Z++]]^y[M[Z++]]^j[M[Z++]]^x[M[Z++]]^p[M[Z++]]^f[M[Z++]]^h[M[Z++]]^u[M[Z++]]^d[M[Z++]]^a[M[Z++]];for(R+=15;Z<R;)A=A>>>8^a[(A^M[Z++])&255];return~A}function G(M,U){for(var A=U^-1,R=0,Z=M.length,F=0,q=0;R<Z;)F=M.charCodeAt(R++),F<128?A=A>>>8^a[(A^F)&255]:F<2048?(A=A>>>8^a[(A^(192|F>>6&31))&255],A=A>>>8^a[(A^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,q=M.charCodeAt(R++)&1023,A=A>>>8^a[(A^(240|F>>8&7))&255],A=A>>>8^a[(A^(128|F>>2&63))&255],A=A>>>8^a[(A^(128|q>>6&15|(F&3)<<4))&255],A=A>>>8^a[(A^(128|q&63))&255]):(A=A>>>8^a[(A^(224|F>>12&15))&255],A=A>>>8^a[(A^(128|F>>6&63))&255],A=A>>>8^a[(A^(128|F&63))&255]);return~A}return t.table=a,t.bstr=O,t.buf=Q,t.str=G,t})(),ia=(function(){var r={};r.version="1.2.1";function a(Y,se){for(var te=Y.split("/"),ae=se.split("/"),re=0,ce=0,Ce=Math.min(te.length,ae.length);re<Ce;++re){if(ce=te[re].length-ae[re].length)return ce;if(te[re]!=ae[re])return te[re]<ae[re]?-1:1}return te.length-ae.length}function s(Y){if(Y.charAt(Y.length-1)=="/")return Y.slice(0,-1).indexOf("/")===-1?Y:s(Y.slice(0,-1));var se=Y.lastIndexOf("/");return se===-1?Y:Y.slice(0,se+1)}function o(Y){if(Y.charAt(Y.length-1)=="/")return o(Y.slice(0,-1));var se=Y.lastIndexOf("/");return se===-1?Y:Y.slice(se+1)}function d(Y,se){typeof se=="string"&&(se=new Date(se));var te=se.getHours();te=te<<6|se.getMinutes(),te=te<<5|se.getSeconds()>>>1,Y.write_shift(2,te);var ae=se.getFullYear()-1980;ae=ae<<4|se.getMonth()+1,ae=ae<<5|se.getDate(),Y.write_shift(2,ae)}function u(Y){var se=Y.read_shift(2)&65535,te=Y.read_shift(2)&65535,ae=new Date,re=te&31;te>>>=5;var ce=te&15;te>>>=4,ae.setMilliseconds(0),ae.setFullYear(te+1980),ae.setMonth(ce-1),ae.setDate(re);var Ce=se&31;se>>>=5;var De=se&63;return se>>>=6,ae.setHours(se),ae.setMinutes(De),ae.setSeconds(Ce<<1),ae}function h(Y){Hn(Y,0);for(var se={},te=0;Y.l<=Y.length-4;){var ae=Y.read_shift(2),re=Y.read_shift(2),ce=Y.l+re,Ce={};ae===21589&&(te=Y.read_shift(1),te&1&&(Ce.mtime=Y.read_shift(4)),re>5&&(te&2&&(Ce.atime=Y.read_shift(4)),te&4&&(Ce.ctime=Y.read_shift(4))),Ce.mtime&&(Ce.mt=new Date(Ce.mtime*1e3))),Y.l=ce,se[ae]=Ce}return se}var f;function p(){return f||(f={})}function x(Y,se){if(Y[0]==80&&Y[1]==75)return ut(Y,se);if((Y[0]|32)==109&&(Y[1]|32)==105)return At(Y,se);if(Y.length<512)throw new Error("CFB file size "+Y.length+" < 512");var te=3,ae=512,re=0,ce=0,Ce=0,De=0,Ne=0,Fe=[],K=Y.slice(0,512);Hn(K,0);var ue=j(K);switch(te=ue[0],te){case 3:ae=512;break;case 4:ae=4096;break;case 0:if(ue[1]==0)return ut(Y,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ae!==512&&(K=Y.slice(0,ae),Hn(K,28));var ke=Y.slice(0,ae);y(K,te);var Te=K.read_shift(4,"i");if(te===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);K.l+=4,Ce=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),De=K.read_shift(4,"i"),re=K.read_shift(4,"i"),Ne=K.read_shift(4,"i"),ce=K.read_shift(4,"i");for(var Me=-1,Ye=0;Ye<109&&(Me=K.read_shift(4,"i"),!(Me<0));++Ye)Fe[Ye]=Me;var $e=S(Y,ae);_(Ne,ce,$e,ae,Fe);var yt=C($e,Ce,Fe,ae);yt[Ce].name="!Directory",re>0&&De!==q&&(yt[De].name="!MiniFAT"),yt[Fe[0]].name="!FAT",yt.fat_addrs=Fe,yt.ssz=ae;var jt={},Kt=[],cn=[],sa=[];N(Ce,yt,$e,Kt,re,jt,cn,De),w(cn,sa,Kt),Kt.shift();var Pa={FileIndex:cn,FullPaths:sa};return se&&se.raw&&(Pa.raw={header:ke,sectors:$e}),Pa}function j(Y){if(Y[Y.l]==80&&Y[Y.l+1]==75)return[0,0];Y.chk(ee,"Header Signature: "),Y.l+=16;var se=Y.read_shift(2,"u");return[Y.read_shift(2,"u"),se]}function y(Y,se){var te=9;switch(Y.l+=2,te=Y.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}Y.chk("0600","Mini Sector Shift: "),Y.chk("000000000000","Reserved: ")}function S(Y,se){for(var te=Math.ceil(Y.length/se)-1,ae=[],re=1;re<te;++re)ae[re-1]=Y.slice(re*se,(re+1)*se);return ae[te-1]=Y.slice(te*se),ae}function w(Y,se,te){for(var ae=0,re=0,ce=0,Ce=0,De=0,Ne=te.length,Fe=[],K=[];ae<Ne;++ae)Fe[ae]=K[ae]=ae,se[ae]=te[ae];for(;De<K.length;++De)ae=K[De],re=Y[ae].L,ce=Y[ae].R,Ce=Y[ae].C,Fe[ae]===ae&&(re!==-1&&Fe[re]!==re&&(Fe[ae]=Fe[re]),ce!==-1&&Fe[ce]!==ce&&(Fe[ae]=Fe[ce])),Ce!==-1&&(Fe[Ce]=ae),re!==-1&&ae!=Fe[ae]&&(Fe[re]=Fe[ae],K.lastIndexOf(re)<De&&K.push(re)),ce!==-1&&ae!=Fe[ae]&&(Fe[ce]=Fe[ae],K.lastIndexOf(ce)<De&&K.push(ce));for(ae=1;ae<Ne;++ae)Fe[ae]===ae&&(ce!==-1&&Fe[ce]!==ce?Fe[ae]=Fe[ce]:re!==-1&&Fe[re]!==re&&(Fe[ae]=Fe[re]));for(ae=1;ae<Ne;++ae)if(Y[ae].type!==0){if(De=ae,De!=Fe[De])do De=Fe[De],se[ae]=se[De]+"/"+se[ae];while(De!==0&&Fe[De]!==-1&&De!=Fe[De]);Fe[ae]=-1}for(se[0]+="/",ae=1;ae<Ne;++ae)Y[ae].type!==2&&(se[ae]+="/")}function b(Y,se,te){for(var ae=Y.start,re=Y.size,ce=[],Ce=ae;te&&re>0&&Ce>=0;)ce.push(se.slice(Ce*F,Ce*F+F)),re-=F,Ce=ys(te,Ce*4);return ce.length===0?Pe(0):nn(ce).slice(0,Y.size)}function _(Y,se,te,ae,re){var ce=q;if(Y===q){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(Y!==-1){var Ce=te[Y],De=(ae>>>2)-1;if(!Ce)return;for(var Ne=0;Ne<De&&(ce=ys(Ce,Ne*4))!==q;++Ne)re.push(ce);_(ys(Ce,ae-4),se-1,te,ae,re)}}function E(Y,se,te,ae,re){var ce=[],Ce=[];re||(re=[]);var De=ae-1,Ne=0,Fe=0;for(Ne=se;Ne>=0;){re[Ne]=!0,ce[ce.length]=Ne,Ce.push(Y[Ne]);var K=te[Math.floor(Ne*4/ae)];if(Fe=Ne*4&De,ae<4+Fe)throw new Error("FAT boundary crossed: "+Ne+" 4 "+ae);if(!Y[K])break;Ne=ys(Y[K],Fe)}return{nodes:ce,data:Ky([Ce])}}function C(Y,se,te,ae){var re=Y.length,ce=[],Ce=[],De=[],Ne=[],Fe=ae-1,K=0,ue=0,ke=0,Te=0;for(K=0;K<re;++K)if(De=[],ke=K+se,ke>=re&&(ke-=re),!Ce[ke]){Ne=[];var Me=[];for(ue=ke;ue>=0;){Me[ue]=!0,Ce[ue]=!0,De[De.length]=ue,Ne.push(Y[ue]);var Ye=te[Math.floor(ue*4/ae)];if(Te=ue*4&Fe,ae<4+Te)throw new Error("FAT boundary crossed: "+ue+" 4 "+ae);if(!Y[Ye]||(ue=ys(Y[Ye],Te),Me[ue]))break}ce[ke]={nodes:De,data:Ky([Ne])}}return ce}function N(Y,se,te,ae,re,ce,Ce,De){for(var Ne=0,Fe=ae.length?2:0,K=se[Y].data,ue=0,ke=0,Te;ue<K.length;ue+=128){var Me=K.slice(ue,ue+128);Hn(Me,64),ke=Me.read_shift(2),Te=gp(Me,0,ke-Fe),ae.push(Te);var Ye={name:Te,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},$e=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);$e!==0&&(Ye.ct=O(Me,Me.l-8));var yt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);yt!==0&&(Ye.mt=O(Me,Me.l-8)),Ye.start=Me.read_shift(4,"i"),Ye.size=Me.read_shift(4,"i"),Ye.size<0&&Ye.start<0&&(Ye.size=Ye.type=0,Ye.start=q,Ye.name=""),Ye.type===5?(Ne=Ye.start,re>0&&Ne!==q&&(se[Ne].name="!StreamData")):Ye.size>=4096?(Ye.storage="fat",se[Ye.start]===void 0&&(se[Ye.start]=E(te,Ye.start,se.fat_addrs,se.ssz)),se[Ye.start].name=Ye.name,Ye.content=se[Ye.start].data.slice(0,Ye.size)):(Ye.storage="minifat",Ye.size<0?Ye.size=0:Ne!==q&&Ye.start!==q&&se[Ne]&&(Ye.content=b(Ye,se[Ne].data,(se[De]||{}).data))),Ye.content&&Hn(Ye.content,0),ce[Te]=Ye,Ce.push(Ye)}}function O(Y,se){return new Date((Zn(Y,se+4)/1e7*Math.pow(2,32)+Zn(Y,se)/1e7-11644473600)*1e3)}function Q(Y,se){return p(),x(f.readFileSync(Y),se)}function G(Y,se){var te=se&&se.type;switch(te||Vt&&Buffer.isBuffer(Y)&&(te="buffer"),te||"base64"){case"file":return Q(Y,se);case"base64":return x(wr(oi(Y)),se);case"binary":return x(wr(Y),se)}return x(Y,se)}function M(Y,se){var te=se||{},ae=te.root||"Root Entry";if(Y.FullPaths||(Y.FullPaths=[]),Y.FileIndex||(Y.FileIndex=[]),Y.FullPaths.length!==Y.FileIndex.length)throw new Error("inconsistent CFB structure");Y.FullPaths.length===0&&(Y.FullPaths[0]=ae+"/",Y.FileIndex[0]={name:ae,type:5}),te.CLSID&&(Y.FileIndex[0].clsid=te.CLSID),U(Y)}function U(Y){var se="Sh33tJ5";if(!ia.find(Y,"/"+se)){var te=Pe(4);te[0]=55,te[1]=te[3]=50,te[2]=54,Y.FileIndex.push({name:se,type:2,content:te,size:4,L:69,R:69,C:69}),Y.FullPaths.push(Y.FullPaths[0]+se),A(Y)}}function A(Y,se){M(Y);for(var te=!1,ae=!1,re=Y.FullPaths.length-1;re>=0;--re){var ce=Y.FileIndex[re];switch(ce.type){case 0:ae?te=!0:(Y.FileIndex.pop(),Y.FullPaths.pop());break;case 1:case 2:case 5:ae=!0,isNaN(ce.R*ce.L*ce.C)&&(te=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!se)){var Ce=new Date(1987,1,19),De=0,Ne=Object.create?Object.create(null):{},Fe=[];for(re=0;re<Y.FullPaths.length;++re)Ne[Y.FullPaths[re]]=!0,Y.FileIndex[re].type!==0&&Fe.push([Y.FullPaths[re],Y.FileIndex[re]]);for(re=0;re<Fe.length;++re){var K=s(Fe[re][0]);ae=Ne[K],ae||(Fe.push([K,{name:o(K).replace("/",""),type:1,clsid:W,ct:Ce,mt:Ce,content:null}]),Ne[K]=!0)}for(Fe.sort(function(Te,Me){return a(Te[0],Me[0])}),Y.FullPaths=[],Y.FileIndex=[],re=0;re<Fe.length;++re)Y.FullPaths[re]=Fe[re][0],Y.FileIndex[re]=Fe[re][1];for(re=0;re<Fe.length;++re){var ue=Y.FileIndex[re],ke=Y.FullPaths[re];if(ue.name=o(ke).replace("/",""),ue.L=ue.R=ue.C=-(ue.color=1),ue.size=ue.content?ue.content.length:0,ue.start=0,ue.clsid=ue.clsid||W,re===0)ue.C=Fe.length>1?1:-1,ue.size=0,ue.type=5;else if(ke.slice(-1)=="/"){for(De=re+1;De<Fe.length&&s(Y.FullPaths[De])!=ke;++De);for(ue.C=De>=Fe.length?-1:De,De=re+1;De<Fe.length&&s(Y.FullPaths[De])!=s(ke);++De);ue.R=De>=Fe.length?-1:De,ue.type=1}else s(Y.FullPaths[re+1]||"")==s(ke)&&(ue.R=re+1),ue.type=2}}}function R(Y,se){var te=se||{};if(te.fileType=="mad")return za(Y,te);if(A(Y),te.fileType==="zip")return Pt(Y,te);var ae=(function(Te){for(var Me=0,Ye=0,$e=0;$e<Te.FileIndex.length;++$e){var yt=Te.FileIndex[$e];if(yt.content){var jt=yt.content.length;jt>0&&(jt<4096?Me+=jt+63>>6:Ye+=jt+511>>9)}}for(var Kt=Te.FullPaths.length+3>>2,cn=Me+7>>3,sa=Me+127>>7,Pa=cn+Ye+Kt+sa,qn=Pa+127>>7,ui=qn<=109?0:Math.ceil((qn-109)/127);Pa+qn+ui+127>>7>qn;)ui=++qn<=109?0:Math.ceil((qn-109)/127);var Zt=[1,ui,qn,sa,Kt,Ye,Me,0];return Te.FileIndex[0].size=Me<<6,Zt[7]=(Te.FileIndex[0].start=Zt[0]+Zt[1]+Zt[2]+Zt[3]+Zt[4]+Zt[5])+(Zt[6]+7>>3),Zt})(Y),re=Pe(ae[7]<<9),ce=0,Ce=0;{for(ce=0;ce<8;++ce)re.write_shift(1,me[ce]);for(ce=0;ce<8;++ce)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ce=0;ce<3;++ce)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ae[2]),re.write_shift(4,ae[0]+ae[1]+ae[2]+ae[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,ae[3]?ae[0]+ae[1]+ae[2]-1:q),re.write_shift(4,ae[3]),re.write_shift(-4,ae[1]?ae[0]-1:q),re.write_shift(4,ae[1]),ce=0;ce<109;++ce)re.write_shift(-4,ce<ae[2]?ae[1]+ce:-1)}if(ae[1])for(Ce=0;Ce<ae[1];++Ce){for(;ce<236+Ce*127;++ce)re.write_shift(-4,ce<ae[2]?ae[1]+ce:-1);re.write_shift(-4,Ce===ae[1]-1?q:Ce+1)}var De=function(Te){for(Ce+=Te;ce<Ce-1;++ce)re.write_shift(-4,ce+1);Te&&(++ce,re.write_shift(-4,q))};for(Ce=ce=0,Ce+=ae[1];ce<Ce;++ce)re.write_shift(-4,J.DIFSECT);for(Ce+=ae[2];ce<Ce;++ce)re.write_shift(-4,J.FATSECT);De(ae[3]),De(ae[4]);for(var Ne=0,Fe=0,K=Y.FileIndex[0];Ne<Y.FileIndex.length;++Ne)K=Y.FileIndex[Ne],K.content&&(Fe=K.content.length,!(Fe<4096)&&(K.start=Ce,De(Fe+511>>9)));for(De(ae[6]+7>>3);re.l&511;)re.write_shift(-4,J.ENDOFCHAIN);for(Ce=ce=0,Ne=0;Ne<Y.FileIndex.length;++Ne)K=Y.FileIndex[Ne],K.content&&(Fe=K.content.length,!(!Fe||Fe>=4096)&&(K.start=Ce,De(Fe+63>>6)));for(;re.l&511;)re.write_shift(-4,J.ENDOFCHAIN);for(ce=0;ce<ae[4]<<2;++ce){var ue=Y.FullPaths[ce];if(!ue||ue.length===0){for(Ne=0;Ne<17;++Ne)re.write_shift(4,0);for(Ne=0;Ne<3;++Ne)re.write_shift(4,-1);for(Ne=0;Ne<12;++Ne)re.write_shift(4,0);continue}K=Y.FileIndex[ce],ce===0&&(K.start=K.size?K.start-1:q);var ke=ce===0&&te.root||K.name;if(Fe=2*(ke.length+1),re.write_shift(64,ke,"utf16le"),re.write_shift(2,Fe),re.write_shift(1,K.type),re.write_shift(1,K.color),re.write_shift(-4,K.L),re.write_shift(-4,K.R),re.write_shift(-4,K.C),K.clsid)re.write_shift(16,K.clsid,"hex");else for(Ne=0;Ne<4;++Ne)re.write_shift(4,0);re.write_shift(4,K.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,K.start),re.write_shift(4,K.size),re.write_shift(4,0)}for(ce=1;ce<Y.FileIndex.length;++ce)if(K=Y.FileIndex[ce],K.size>=4096)if(re.l=K.start+1<<9,Vt&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+511&-512;else{for(Ne=0;Ne<K.size;++Ne)re.write_shift(1,K.content[Ne]);for(;Ne&511;++Ne)re.write_shift(1,0)}for(ce=1;ce<Y.FileIndex.length;++ce)if(K=Y.FileIndex[ce],K.size>0&&K.size<4096)if(Vt&&Buffer.isBuffer(K.content))K.content.copy(re,re.l,0,K.size),re.l+=K.size+63&-64;else{for(Ne=0;Ne<K.size;++Ne)re.write_shift(1,K.content[Ne]);for(;Ne&63;++Ne)re.write_shift(1,0)}if(Vt)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function Z(Y,se){var te=Y.FullPaths.map(function(Ne){return Ne.toUpperCase()}),ae=te.map(function(Ne){var Fe=Ne.split("/");return Fe[Fe.length-(Ne.slice(-1)=="/"?2:1)]}),re=!1;se.charCodeAt(0)===47?(re=!0,se=te[0].slice(0,-1)+se):re=se.indexOf("/")!==-1;var ce=se.toUpperCase(),Ce=re===!0?te.indexOf(ce):ae.indexOf(ce);if(Ce!==-1)return Y.FileIndex[Ce];var De=!ce.match(Dd);for(ce=ce.replace(Ho,""),De&&(ce=ce.replace(Dd,"!")),Ce=0;Ce<te.length;++Ce)if((De?te[Ce].replace(Dd,"!"):te[Ce]).replace(Ho,"")==ce||(De?ae[Ce].replace(Dd,"!"):ae[Ce]).replace(Ho,"")==ce)return Y.FileIndex[Ce];return null}var F=64,q=-2,ee="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function L(Y,se,te){p();var ae=R(Y,te);f.writeFileSync(se,ae)}function H(Y){for(var se=new Array(Y.length),te=0;te<Y.length;++te)se[te]=String.fromCharCode(Y[te]);return se.join("")}function ne(Y,se){var te=R(Y,se);switch(se&&se.type||"buffer"){case"file":return p(),f.writeFileSync(se.filename,te),te;case"binary":return typeof te=="string"?te:H(te);case"base64":return tc(typeof te=="string"?te:H(te));case"buffer":if(Vt)return Buffer.isBuffer(te)?te:di(te);case"array":return typeof te=="string"?wr(te):te}return te}var P;function T(Y){try{var se=Y.InflateRaw,te=new se;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)P=Y;else throw new Error("zlib does not expose bytesRead")}catch(ae){console.error("cannot use native zlib: "+(ae.message||ae))}}function z(Y,se){if(!P)return at(Y,se);var te=P.InflateRaw,ae=new te,re=ae._processChunk(Y.slice(Y.l),ae._finishFlushFlag);return Y.l+=ae.bytesRead,re}function k(Y){return P?P.deflateRawSync(Y):va(Y)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function he(Y){var se=(Y<<1|Y<<11)&139536|(Y<<5|Y<<15)&558144;return(se>>16|se>>8|se)&255}for(var ie=typeof Uint8Array<"u",ve=ie?new Uint8Array(256):[],je=0;je<256;++je)ve[je]=he(je);function fe(Y,se){var te=ve[Y&255];return se<=8?te>>>8-se:(te=te<<8|ve[Y>>8&255],se<=16?te>>>16-se:(te=te<<8|ve[Y>>16&255],te>>>24-se))}function _e(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=6?0:Y[ae+1]<<8))>>>te&3}function Se(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=5?0:Y[ae+1]<<8))>>>te&7}function Ve(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=4?0:Y[ae+1]<<8))>>>te&15}function be(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=3?0:Y[ae+1]<<8))>>>te&31}function oe(Y,se){var te=se&7,ae=se>>>3;return(Y[ae]|(te<=1?0:Y[ae+1]<<8))>>>te&127}function Ue(Y,se,te){var ae=se&7,re=se>>>3,ce=(1<<te)-1,Ce=Y[re]>>>ae;return te<8-ae||(Ce|=Y[re+1]<<8-ae,te<16-ae)||(Ce|=Y[re+2]<<16-ae,te<24-ae)||(Ce|=Y[re+3]<<24-ae),Ce&ce}function Qe(Y,se,te){var ae=se&7,re=se>>>3;return ae<=5?Y[re]|=(te&7)<<ae:(Y[re]|=te<<ae&255,Y[re+1]=(te&7)>>8-ae),se+3}function lt(Y,se,te){var ae=se&7,re=se>>>3;return te=(te&1)<<ae,Y[re]|=te,se+1}function tt(Y,se,te){var ae=se&7,re=se>>>3;return te<<=ae,Y[re]|=te&255,te>>>=8,Y[re+1]=te,se+8}function ht(Y,se,te){var ae=se&7,re=se>>>3;return te<<=ae,Y[re]|=te&255,te>>>=8,Y[re+1]=te&255,Y[re+2]=te>>>8,se+16}function xt(Y,se){var te=Y.length,ae=2*te>se?2*te:se+5,re=0;if(te>=se)return Y;if(Vt){var ce=Ry(ae);if(Y.copy)Y.copy(ce);else for(;re<Y.length;++re)ce[re]=Y[re];return ce}else if(ie){var Ce=new Uint8Array(ae);if(Ce.set)Ce.set(Y);else for(;re<te;++re)Ce[re]=Y[re];return Ce}return Y.length=ae,Y}function qe(Y){for(var se=new Array(Y),te=0;te<Y;++te)se[te]=0;return se}function Nt(Y,se,te){var ae=1,re=0,ce=0,Ce=0,De=0,Ne=Y.length,Fe=ie?new Uint16Array(32):qe(32);for(ce=0;ce<32;++ce)Fe[ce]=0;for(ce=Ne;ce<te;++ce)Y[ce]=0;Ne=Y.length;var K=ie?new Uint16Array(Ne):qe(Ne);for(ce=0;ce<Ne;++ce)Fe[re=Y[ce]]++,ae<re&&(ae=re),K[ce]=0;for(Fe[0]=0,ce=1;ce<=ae;++ce)Fe[ce+16]=De=De+Fe[ce-1]<<1;for(ce=0;ce<Ne;++ce)De=Y[ce],De!=0&&(K[ce]=Fe[De+16]++);var ue=0;for(ce=0;ce<Ne;++ce)if(ue=Y[ce],ue!=0)for(De=fe(K[ce],ae)>>ae-ue,Ce=(1<<ae+4-ue)-1;Ce>=0;--Ce)se[De|Ce<<ue]=ue&15|ce<<4;return ae}var st=ie?new Uint16Array(512):qe(512),_t=ie?new Uint16Array(32):qe(32);if(!ie){for(var zt=0;zt<512;++zt)st[zt]=0;for(zt=0;zt<32;++zt)_t[zt]=0}(function(){for(var Y=[],se=0;se<32;se++)Y.push(5);Nt(Y,_t,32);var te=[];for(se=0;se<=143;se++)te.push(8);for(;se<=255;se++)te.push(9);for(;se<=279;se++)te.push(7);for(;se<=287;se++)te.push(8);Nt(te,st,288)})();var It=(function(){for(var se=ie?new Uint8Array(32768):[],te=0,ae=0;te<de.length-1;++te)for(;ae<de[te+1];++ae)se[ae]=te;for(;ae<32768;++ae)se[ae]=29;var re=ie?new Uint8Array(259):[];for(te=0,ae=0;te<D.length-1;++te)for(;ae<D[te+1];++ae)re[ae]=te;function ce(De,Ne){for(var Fe=0;Fe<De.length;){var K=Math.min(65535,De.length-Fe),ue=Fe+K==De.length;for(Ne.write_shift(1,+ue),Ne.write_shift(2,K),Ne.write_shift(2,~K&65535);K-- >0;)Ne[Ne.l++]=De[Fe++]}return Ne.l}function Ce(De,Ne){for(var Fe=0,K=0,ue=ie?new Uint16Array(32768):[];K<De.length;){var ke=Math.min(65535,De.length-K);if(ke<10){for(Fe=Qe(Ne,Fe,+(K+ke==De.length)),Fe&7&&(Fe+=8-(Fe&7)),Ne.l=Fe/8|0,Ne.write_shift(2,ke),Ne.write_shift(2,~ke&65535);ke-- >0;)Ne[Ne.l++]=De[K++];Fe=Ne.l*8;continue}Fe=Qe(Ne,Fe,+(K+ke==De.length)+2);for(var Te=0;ke-- >0;){var Me=De[K];Te=(Te<<5^Me)&32767;var Ye=-1,$e=0;if((Ye=ue[Te])&&(Ye|=K&-32768,Ye>K&&(Ye-=32768),Ye<K))for(;De[Ye+$e]==De[K+$e]&&$e<250;)++$e;if($e>2){Me=re[$e],Me<=22?Fe=tt(Ne,Fe,ve[Me+1]>>1)-1:(tt(Ne,Fe,3),Fe+=5,tt(Ne,Fe,ve[Me-23]>>5),Fe+=3);var yt=Me<8?0:Me-4>>2;yt>0&&(ht(Ne,Fe,$e-D[Me]),Fe+=yt),Me=se[K-Ye],Fe=tt(Ne,Fe,ve[Me]>>3),Fe-=3;var jt=Me<4?0:Me-2>>1;jt>0&&(ht(Ne,Fe,K-Ye-de[Me]),Fe+=jt);for(var Kt=0;Kt<$e;++Kt)ue[Te]=K&32767,Te=(Te<<5^De[K])&32767,++K;ke-=$e-1}else Me<=143?Me=Me+48:Fe=lt(Ne,Fe,1),Fe=tt(Ne,Fe,ve[Me]),ue[Te]=K&32767,++K}Fe=tt(Ne,Fe,0)-1}return Ne.l=(Fe+7)/8|0,Ne.l}return function(Ne,Fe){return Ne.length<8?ce(Ne,Fe):Ce(Ne,Fe)}})();function va(Y){var se=Pe(50+Math.floor(Y.length*1.1)),te=It(Y,se);return se.slice(0,te)}var rt=ie?new Uint16Array(32768):qe(32768),oa=ie?new Uint16Array(32768):qe(32768),ca=ie?new Uint16Array(128):qe(128),ze=1,et=1;function it(Y,se){var te=be(Y,se)+257;se+=5;var ae=be(Y,se)+1;se+=5;var re=Ve(Y,se)+4;se+=4;for(var ce=0,Ce=ie?new Uint8Array(19):qe(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ne=1,Fe=ie?new Uint8Array(8):qe(8),K=ie?new Uint8Array(8):qe(8),ue=Ce.length,ke=0;ke<re;++ke)Ce[I[ke]]=ce=Se(Y,se),Ne<ce&&(Ne=ce),Fe[ce]++,se+=3;var Te=0;for(Fe[0]=0,ke=1;ke<=Ne;++ke)K[ke]=Te=Te+Fe[ke-1]<<1;for(ke=0;ke<ue;++ke)(Te=Ce[ke])!=0&&(De[ke]=K[Te]++);var Me=0;for(ke=0;ke<ue;++ke)if(Me=Ce[ke],Me!=0){Te=ve[De[ke]]>>8-Me;for(var Ye=(1<<7-Me)-1;Ye>=0;--Ye)ca[Te|Ye<<Me]=Me&7|ke<<3}var $e=[];for(Ne=1;$e.length<te+ae;)switch(Te=ca[oe(Y,se)],se+=Te&7,Te>>>=3){case 16:for(ce=3+_e(Y,se),se+=2,Te=$e[$e.length-1];ce-- >0;)$e.push(Te);break;case 17:for(ce=3+Se(Y,se),se+=3;ce-- >0;)$e.push(0);break;case 18:for(ce=11+oe(Y,se),se+=7;ce-- >0;)$e.push(0);break;default:$e.push(Te),Ne<Te&&(Ne=Te);break}var yt=$e.slice(0,te),jt=$e.slice(te);for(ke=te;ke<286;++ke)yt[ke]=0;for(ke=ae;ke<30;++ke)jt[ke]=0;return ze=Nt(yt,rt,286),et=Nt(jt,oa,30),se}function Be(Y,se){if(Y[0]==3&&!(Y[1]&3))return[js(se),2];for(var te=0,ae=0,re=Ry(se||1<<18),ce=0,Ce=re.length>>>0,De=0,Ne=0;(ae&1)==0;){if(ae=Se(Y,te),te+=3,ae>>>1)ae>>1==1?(De=9,Ne=5):(te=it(Y,te),De=ze,Ne=et);else{te&7&&(te+=8-(te&7));var Fe=Y[te>>>3]|Y[(te>>>3)+1]<<8;if(te+=32,Fe>0)for(!se&&Ce<ce+Fe&&(re=xt(re,ce+Fe),Ce=re.length);Fe-- >0;)re[ce++]=Y[te>>>3],te+=8;continue}for(;;){!se&&Ce<ce+32767&&(re=xt(re,ce+32767),Ce=re.length);var K=Ue(Y,te,De),ue=ae>>>1==1?st[K]:rt[K];if(te+=ue&15,ue>>>=4,(ue>>>8&255)===0)re[ce++]=ue;else{if(ue==256)break;ue-=257;var ke=ue<8?0:ue-4>>2;ke>5&&(ke=0);var Te=ce+D[ue];ke>0&&(Te+=Ue(Y,te,ke),te+=ke),K=Ue(Y,te,Ne),ue=ae>>>1==1?_t[K]:oa[K],te+=ue&15,ue>>>=4;var Me=ue<4?0:ue-2>>1,Ye=de[ue];for(Me>0&&(Ye+=Ue(Y,te,Me),te+=Me),!se&&Ce<Te&&(re=xt(re,Te+100),Ce=re.length);ce<Te;)re[ce]=re[ce-Ye],++ce}}}return se?[re,te+7>>>3]:[re.slice(0,ce),te+7>>>3]}function at(Y,se){var te=Y.slice(Y.l||0),ae=Be(te,se);return Y.l+=ae[1],ae[0]}function nt(Y,se){if(Y)typeof console<"u"&&console.error(se);else throw new Error(se)}function ut(Y,se){var te=Y;Hn(te,0);var ae=[],re=[],ce={FileIndex:ae,FullPaths:re};M(ce,{root:se.root});for(var Ce=te.length-4;(te[Ce]!=80||te[Ce+1]!=75||te[Ce+2]!=5||te[Ce+3]!=6)&&Ce>=0;)--Ce;te.l=Ce+4,te.l+=4;var De=te.read_shift(2);te.l+=6;var Ne=te.read_shift(4);for(te.l=Ne,Ce=0;Ce<De;++Ce){te.l+=20;var Fe=te.read_shift(4),K=te.read_shift(4),ue=te.read_shift(2),ke=te.read_shift(2),Te=te.read_shift(2);te.l+=8;var Me=te.read_shift(4),Ye=h(te.slice(te.l+ue,te.l+ue+ke));te.l+=ue+ke+Te;var $e=te.l;te.l=Me+4,ta(te,Fe,K,ce,Ye),te.l=$e}return ce}function ta(Y,se,te,ae,re){Y.l+=2;var ce=Y.read_shift(2),Ce=Y.read_shift(2),De=u(Y);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ne=Y.read_shift(4),Fe=Y.read_shift(4),K=Y.read_shift(4),ue=Y.read_shift(2),ke=Y.read_shift(2),Te="",Me=0;Me<ue;++Me)Te+=String.fromCharCode(Y[Y.l++]);if(ke){var Ye=h(Y.slice(Y.l,Y.l+ke));(Ye[21589]||{}).mt&&(De=Ye[21589].mt),((re||{})[21589]||{}).mt&&(De=re[21589].mt)}Y.l+=ke;var $e=Y.slice(Y.l,Y.l+Fe);switch(Ce){case 8:$e=z(Y,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ce)}var yt=!1;ce&8&&(Ne=Y.read_shift(4),Ne==134695760&&(Ne=Y.read_shift(4),yt=!0),Fe=Y.read_shift(4),K=Y.read_shift(4)),Fe!=se&&nt(yt,"Bad compressed size: "+se+" != "+Fe),K!=te&&nt(yt,"Bad uncompressed size: "+te+" != "+K),Et(ae,Te,$e,{unsafe:!0,mt:De})}function Pt(Y,se){var te=se||{},ae=[],re=[],ce=Pe(1),Ce=te.compression?8:0,De=0,Ne=0,Fe=0,K=0,ue=0,ke=Y.FullPaths[0],Te=ke,Me=Y.FileIndex[0],Ye=[],$e=0;for(Ne=1;Ne<Y.FullPaths.length;++Ne)if(Te=Y.FullPaths[Ne].slice(ke.length),Me=Y.FileIndex[Ne],!(!Me.size||!Me.content||Te=="Sh33tJ5")){var yt=K,jt=Pe(Te.length);for(Fe=0;Fe<Te.length;++Fe)jt.write_shift(1,Te.charCodeAt(Fe)&127);jt=jt.slice(0,jt.l),Ye[ue]=ok.buf(Me.content,0);var Kt=Me.content;Ce==8&&(Kt=k(Kt)),ce=Pe(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,De),ce.write_shift(2,Ce),Me.mt?d(ce,Me.mt):ce.write_shift(4,0),ce.write_shift(-4,Ye[ue]),ce.write_shift(4,Kt.length),ce.write_shift(4,Me.content.length),ce.write_shift(2,jt.length),ce.write_shift(2,0),K+=ce.length,ae.push(ce),K+=jt.length,ae.push(jt),K+=Kt.length,ae.push(Kt),ce=Pe(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,De),ce.write_shift(2,Ce),ce.write_shift(4,0),ce.write_shift(-4,Ye[ue]),ce.write_shift(4,Kt.length),ce.write_shift(4,Me.content.length),ce.write_shift(2,jt.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,yt),$e+=ce.l,re.push(ce),$e+=jt.length,re.push(jt),++ue}return ce=Pe(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,ue),ce.write_shift(2,ue),ce.write_shift(4,$e),ce.write_shift(4,K),ce.write_shift(2,0),nn([nn(ae),nn(re),ce])}var Tt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xe(Y,se){if(Y.ctype)return Y.ctype;var te=Y.name||"",ae=te.match(/\.([^\.]+)$/);return ae&&Tt[ae[1]]||se&&(ae=(te=se).match(/[\.\\]([^\.\\])+$/),ae&&Tt[ae[1]])?Tt[ae[1]]:"application/octet-stream"}function Ie(Y){for(var se=tc(Y),te=[],ae=0;ae<se.length;ae+=76)te.push(se.slice(ae,ae+76));return te.join(`\r
`)+`\r
`}function mt(Y){var se=Y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Fe){var K=Fe.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ae=se.split(`\r
`),re=0;re<ae.length;++re){var ce=ae[re];if(ce.length==0){te.push("");continue}for(var Ce=0;Ce<ce.length;){var De=76,Ne=ce.slice(Ce,Ce+De);Ne.charAt(De-1)=="="?De--:Ne.charAt(De-2)=="="?De-=2:Ne.charAt(De-3)=="="&&(De-=3),Ne=ce.slice(Ce,Ce+De),Ce+=De,Ce<ce.length&&(Ne+="="),te.push(Ne)}}return te.join(`\r
`)}function Oe(Y){for(var se=[],te=0;te<Y.length;++te){for(var ae=Y[te];te<=Y.length&&ae.charAt(ae.length-1)=="=";)ae=ae.slice(0,ae.length-1)+Y[++te];se.push(ae)}for(var re=0;re<se.length;++re)se[re]=se[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return wr(se.join(`\r
`))}function ct(Y,se,te){for(var ae="",re="",ce="",Ce,De=0;De<10;++De){var Ne=se[De];if(!Ne||Ne.match(/^\s*$/))break;var Fe=Ne.match(/^(.*?):\s*([^\s].*)$/);if(Fe)switch(Fe[1].toLowerCase()){case"content-location":ae=Fe[2].trim();break;case"content-type":ce=Fe[2].trim();break;case"content-transfer-encoding":re=Fe[2].trim();break}}switch(++De,re.toLowerCase()){case"base64":Ce=wr(oi(se.slice(De).join("")));break;case"quoted-printable":Ce=Oe(se.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var K=Et(Y,ae.slice(te.length),Ce,{unsafe:!0});ce&&(K.ctype=ce)}function At(Y,se){if(H(Y.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=se&&se.root||"",ae=(Vt&&Buffer.isBuffer(Y)?Y.toString("binary"):H(Y)).split(`\r
`),re=0,ce="";for(re=0;re<ae.length;++re)if(ce=ae[re],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),te||(te=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),ce.slice(0,te.length)!=te););var Ce=(ae[1]||"").match(/boundary="(.*?)"/);if(!Ce)throw new Error("MAD cannot find boundary");var De="--"+(Ce[1]||""),Ne=[],Fe=[],K={FileIndex:Ne,FullPaths:Fe};M(K);var ue,ke=0;for(re=0;re<ae.length;++re){var Te=ae[re];Te!==De&&Te!==De+"--"||(ke++&&ct(K,ae.slice(ue,re),te),ue=re)}return K}function za(Y,se){var te=se||{},ae=te.boundary||"SheetJS";ae="------="+ae;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ae.slice(2)+'"',"","",""],ce=Y.FullPaths[0],Ce=ce,De=Y.FileIndex[0],Ne=1;Ne<Y.FullPaths.length;++Ne)if(Ce=Y.FullPaths[Ne].slice(ce.length),De=Y.FileIndex[Ne],!(!De.size||!De.content||Ce=="Sh33tJ5")){Ce=Ce.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var Fe=De.content,K=Vt&&Buffer.isBuffer(Fe)?Fe.toString("binary"):H(Fe),ue=0,ke=Math.min(1024,K.length),Te=0,Me=0;Me<=ke;++Me)(Te=K.charCodeAt(Me))>=32&&Te<128&&++ue;var Ye=ue>=ke*4/5;re.push(ae),re.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+Ce),re.push("Content-Transfer-Encoding: "+(Ye?"quoted-printable":"base64")),re.push("Content-Type: "+xe(De,Ce)),re.push(""),re.push(Ye?mt(K):Ie(K))}return re.push(ae+`--\r
`),re.join(`\r
`)}function ja(Y){var se={};return M(se,Y),se}function Et(Y,se,te,ae){var re=ae&&ae.unsafe;re||M(Y);var ce=!re&&ia.find(Y,se);if(!ce){var Ce=Y.FullPaths[0];se.slice(0,Ce.length)==Ce?Ce=se:(Ce.slice(-1)!="/"&&(Ce+="/"),Ce=(Ce+se).replace("//","/")),ce={name:o(se),type:2},Y.FileIndex.push(ce),Y.FullPaths.push(Ce),re||ia.utils.cfb_gc(Y)}return ce.content=te,ce.size=te?te.length:0,ae&&(ae.CLSID&&(ce.clsid=ae.CLSID),ae.mt&&(ce.mt=ae.mt),ae.ct&&(ce.ct=ae.ct)),ce}function ge(Y,se){M(Y);var te=ia.find(Y,se);if(te){for(var ae=0;ae<Y.FileIndex.length;++ae)if(Y.FileIndex[ae]==te)return Y.FileIndex.splice(ae,1),Y.FullPaths.splice(ae,1),!0}return!1}function Ft(Y,se,te){M(Y);var ae=ia.find(Y,se);if(ae){for(var re=0;re<Y.FileIndex.length;++re)if(Y.FileIndex[re]==ae)return Y.FileIndex[re].name=o(te),Y.FullPaths[re]=te,!0}return!1}function ga(Y){A(Y,!0)}return r.find=Z,r.read=G,r.parse=x,r.write=ne,r.writeFile=L,r.utils={cfb_new:ja,cfb_add:Et,cfb_del:ge,cfb_mov:Ft,cfb_gc:ga,ReadShift:Zo,CheckField:uj,prep_blob:Hn,bconcat:nn,use_zlib:T,_deflateRaw:va,_inflateRaw:at,consts:J},r})();function ck(t){return typeof t=="string"?Lu(t):Array.isArray(t)?O2(t):t}function mc(t,r,a){if(typeof Deno<"u"){if(a&&typeof r=="string")switch(a){case"utf8":r=new TextEncoder(a).encode(r);break;case"binary":r=Lu(r);break;default:throw new Error("Unsupported encoding "+a)}return Deno.writeFileSync(t,r)}var s=a=="utf8"?nc(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var o=new Blob([ck(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,t);if(typeof saveAs<"u")return saveAs(o,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var d=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),chrome.downloads.download({url:d,filename:t,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=t,u.href=d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(d)},6e4),d}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(t);return h.open("w"),h.encoding="binary",Array.isArray(r)&&(r=hc(r)),h.write(r),h.close(),r}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function ln(t){for(var r=Object.keys(t),a=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(t,r[s])&&a.push(r[s]);return a}function Wy(t,r){for(var a=[],s=ln(t),o=0;o!==s.length;++o)a[t[s[o]][r]]==null&&(a[t[s[o]][r]]=s[o]);return a}function fp(t){for(var r=[],a=ln(t),s=0;s!==a.length;++s)r[t[a[s]]]=a[s];return r}function Pu(t){for(var r=[],a=ln(t),s=0;s!==a.length;++s)r[t[a[s]]]=parseInt(a[s],10);return r}function dk(t){for(var r=[],a=ln(t),s=0;s!==a.length;++s)r[t[a[s]]]==null&&(r[t[a[s]]]=[]),r[t[a[s]]].push(a[s]);return r}var bu=new Date(1899,11,30,0,0,0);function An(t,r){var a=t.getTime(),s=bu.getTime()+(t.getTimezoneOffset()-bu.getTimezoneOffset())*6e4;return(a-s)/(1440*60*1e3)}var K1=new Date,uk=bu.getTime()+(K1.getTimezoneOffset()-bu.getTimezoneOffset())*6e4,Uy=K1.getTimezoneOffset();function q1(t){var r=new Date;return r.setTime(t*24*60*60*1e3+uk),r.getTimezoneOffset()!==Uy&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Uy)*6e4),r}var $y=new Date("2017-02-19T19:06:09.000Z"),Y1=isNaN($y.getFullYear())?new Date("2/19/17"):$y,fk=Y1.getFullYear()==2017;function vn(t,r){var a=new Date(t);if(fk)return r>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):r<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(t instanceof Date)return t;if(Y1.getFullYear()==1917&&!isNaN(a.getFullYear())){var s=a.getFullYear();return t.indexOf(""+s)>-1||a.setFullYear(a.getFullYear()+100),a}var o=t.match(/\d+/g)||["2017","2","19","0","0","0"],d=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return t.indexOf("Z")>-1&&(d=new Date(d.getTime()-d.getTimezoneOffset()*60*1e3)),d}function Wu(t,r){if(Vt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(d){return a[d]||d})}catch{}for(var s=[],o=0;o!=t.length;++o)s.push(String.fromCharCode(t[o]));return s.join("")}function En(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(r[a]=En(t[a]));return r}function wa(t,r){for(var a="";a.length<r;)a+=t;return a}function ii(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var a=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(o,d){return a=-a,d}),!isNaN(r=Number(s)))?r/a:r}var hk=["january","february","march","april","may","june","july","august","september","october","november","december"];function ac(t){var r=new Date(t),a=new Date(NaN),s=r.getYear(),o=r.getMonth(),d=r.getDate();if(isNaN(d))return a;var u=t.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&hk.indexOf(u)==-1)return a}else if(u.match(/[a-z]/))return a;return s<0||s>8099?a:(o>0||d>1)&&s!=101?r:t.match(/[^-0-9:,\/\\]/)?a:r}function Ct(t,r,a){if(t.FullPaths){if(typeof a=="string"){var s;return Vt?s=di(a):s=D2(a),ia.utils.cfb_add(t,r,s)}ia.utils.cfb_add(t,r,a)}else t.file(r,a)}function hp(){return ia.utils.cfb_new()}var Ma=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},mp=fp(mk),pp=/[&<>'"]/g,pk=/[\u0000-\u0008\u000b-\u001f]/g;function Qt(t){var r=t+"";return r.replace(pp,function(a){return mp[a]}).replace(pk,function(a){return"_x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Hy(t){return Qt(t).replace(/ /g,"_x0020_")}var J1=/[\u0000-\u001f]/g;function gk(t){var r=t+"";return r.replace(pp,function(a){return mp[a]}).replace(/\n/g,"<br/>").replace(J1,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}function xk(t){var r=t+"";return r.replace(pp,function(a){return mp[a]}).replace(J1,function(a){return"&#x"+a.charCodeAt(0).toString(16).toUpperCase()+";"})}function yk(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function vk(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function rm(t){for(var r="",a=0,s=0,o=0,d=0,u=0,h=0;a<t.length;){if(s=t.charCodeAt(a++),s<128){r+=String.fromCharCode(s);continue}if(o=t.charCodeAt(a++),s>191&&s<224){u=(s&31)<<6,u|=o&63,r+=String.fromCharCode(u);continue}if(d=t.charCodeAt(a++),s<240){r+=String.fromCharCode((s&15)<<12|(o&63)<<6|d&63);continue}u=t.charCodeAt(a++),h=((s&7)<<18|(o&63)<<12|(d&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(h>>>10&1023)),r+=String.fromCharCode(56320+(h&1023))}return r}function Vy(t){var r=js(2*t.length),a,s,o=1,d=0,u=0,h;for(s=0;s<t.length;s+=o)o=1,(h=t.charCodeAt(s))<128?a=h:h<224?(a=(h&31)*64+(t.charCodeAt(s+1)&63),o=2):h<240?(a=(h&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),o=3):(o=4,a=(h&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),a-=65536,u=55296+(a>>>10&1023),a=56320+(a&1023)),u!==0&&(r[d++]=u&255,r[d++]=u>>>8,u=0),r[d++]=a%256,r[d++]=a>>>8;return r.slice(0,d).toString("ucs2")}function Zy(t){return di(t,"binary").toString("utf8")}var Md="foo bar baz",Vo=Vt&&(Zy(Md)==rm(Md)&&Zy||Vy(Md)==rm(Md)&&Vy)||rm,nc=Vt?function(t){return di(t,"utf8").toString("binary")}:function(t){for(var r=[],a=0,s=0,o=0;a<t.length;)switch(s=t.charCodeAt(a++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,o=t.charCodeAt(a++)-56320+(s<<10),r.push(String.fromCharCode(240+(o>>18&7))),r.push(String.fromCharCode(144+(o>>12&63))),r.push(String.fromCharCode(128+(o>>6&63))),r.push(String.fromCharCode(128+(o&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},jk=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(a){for(var s=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<t.length;++o)s=s.replace(t[o][0],t[o][1]);return s}})(),X1=/(^\s|\s$|\n)/;function rn(t,r){return"<"+t+(r.match(X1)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function rc(t){return ln(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function Je(t,r,a){return"<"+t+(a!=null?rc(a):"")+(r!=null?(r.match(X1)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Km(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(a){if(r)throw a}return""}function bk(t,r){switch(typeof t){case"string":var a=Je("vt:lpwstr",Qt(t));return a=a.replace(/&quot;/g,"_x0022_"),a;case"number":return Je((t|0)==t?"vt:i4":"vt:r8",Qt(String(t)));case"boolean":return Je("vt:bool",t?"true":"false")}if(t instanceof Date)return Je("vt:filetime",Km(t));throw new Error("Unable to serialize "+t)}var Za={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Tl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _k(t,r){for(var a=1-2*(t[r+7]>>>7),s=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),o=t[r+6]&15,d=5;d>=0;--d)o=o*256+t[r+d];return s==2047?o==0?a*(1/0):NaN:(s==0?s=-1022:(s-=1023,o+=Math.pow(2,52)),a*Math.pow(2,s-52)*o)}function Sk(t,r,a){var s=(r<0||1/r==-1/0?1:0)<<7,o=0,d=0,u=s?-r:r;isFinite(u)?u==0?o=d=0:(o=Math.floor(Math.log(u)/Math.LN2),d=u*Math.pow(2,52-o),o<=-1023&&(!isFinite(d)||d<Math.pow(2,52))?o=-1022:(d-=Math.pow(2,52),o+=1023)):(o=2047,d=isNaN(r)?26985:0);for(var h=0;h<=5;++h,d/=256)t[a+h]=d&255;t[a+6]=(o&15)<<4|d&15,t[a+7]=o>>4|s}var Gy=function(t){for(var r=[],a=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var o=0,d=t[0][s].length;o<d;o+=a)r.push.apply(r,t[0][s].slice(o,o+a));return r},Ky=Vt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:di(r)})):Gy(t)}:Gy,qy=function(t,r,a){for(var s=[],o=r;o<a;o+=2)s.push(String.fromCharCode(Wo(t,o)));return s.join("").replace(Ho,"")},gp=Vt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf16le",r,a).replace(Ho,""):qy(t,r,a)}:qy,Yy=function(t,r,a){for(var s=[],o=r;o<r+a;++o)s.push(("0"+t[o].toString(16)).slice(-2));return s.join("")},Q1=Vt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("hex",r,r+a):Yy(t,r,a)}:Yy,Jy=function(t,r,a){for(var s=[],o=r;o<a;o++)s.push(String.fromCharCode(gl(t,o)));return s.join("")},pc=Vt?function(r,a,s){return Buffer.isBuffer(r)?r.toString("utf8",a,s):Jy(r,a,s)}:Jy,ej=function(t,r){var a=Zn(t,r);return a>0?pc(t,r+4,r+4+a-1):""},tj=ej,aj=function(t,r){var a=Zn(t,r);return a>0?pc(t,r+4,r+4+a-1):""},nj=aj,rj=function(t,r){var a=2*Zn(t,r);return a>0?pc(t,r+4,r+4+a-1):""},ij=rj,sj=function(r,a){var s=Zn(r,a);return s>0?gp(r,a+4,a+4+s):""},lj=sj,oj=function(t,r){var a=Zn(t,r);return a>0?pc(t,r+4,r+4+a):""},cj=oj,dj=function(t,r){return _k(t,r)},_u=dj,xp=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Vt&&(tj=function(r,a){if(!Buffer.isBuffer(r))return ej(r,a);var s=r.readUInt32LE(a);return s>0?r.toString("utf8",a+4,a+4+s-1):""},nj=function(r,a){if(!Buffer.isBuffer(r))return aj(r,a);var s=r.readUInt32LE(a);return s>0?r.toString("utf8",a+4,a+4+s-1):""},ij=function(r,a){if(!Buffer.isBuffer(r))return rj(r,a);var s=2*r.readUInt32LE(a);return r.toString("utf16le",a+4,a+4+s-1)},lj=function(r,a){if(!Buffer.isBuffer(r))return sj(r,a);var s=r.readUInt32LE(a);return r.toString("utf16le",a+4,a+4+s)},cj=function(r,a){if(!Buffer.isBuffer(r))return oj(r,a);var s=r.readUInt32LE(a);return r.toString("utf8",a+4,a+4+s)},_u=function(r,a){return Buffer.isBuffer(r)?r.readDoubleLE(a):dj(r,a)},xp=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var gl=function(t,r){return t[r]},Wo=function(t,r){return t[r+1]*256+t[r]},wk=function(t,r){var a=t[r+1]*256+t[r];return a<32768?a:(65535-a+1)*-1},Zn=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},ys=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},kk=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function Zo(t,r){var a="",s,o,d=[],u,h,f,p;switch(r){case"dbcs":if(p=this.l,Vt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)a+=String.fromCharCode(Wo(this,p)),p+=2;t*=2;break;case"utf8":a=pc(this,this.l,this.l+t);break;case"utf16le":t*=2,a=gp(this,this.l,this.l+t);break;case"wstr":return Zo.call(this,t,"dbcs");case"lpstr-ansi":a=tj(this,this.l),t=4+Zn(this,this.l);break;case"lpstr-cp":a=nj(this,this.l),t=4+Zn(this,this.l);break;case"lpwstr":a=ij(this,this.l),t=4+2*Zn(this,this.l);break;case"lpp4":t=4+Zn(this,this.l),a=lj(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Zn(this,this.l),a=cj(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,a="";(u=gl(this,this.l+t++))!==0;)d.push(Od(u));a=d.join("");break;case"_wstr":for(t=0,a="";(u=Wo(this,this.l+t))!==0;)d.push(Od(u)),t+=2;t+=2,a=d.join("");break;case"dbcs-cont":for(a="",p=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return u=gl(this,p),this.l=p+1,h=Zo.call(this,t-f,u?"dbcs-cont":"sbcs-cont"),d.join("")+h;d.push(Od(Wo(this,p))),p+=2}a=d.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(a="",p=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(p)!==-1)return u=gl(this,p),this.l=p+1,h=Zo.call(this,t-f,u?"dbcs-cont":"sbcs-cont"),d.join("")+h;d.push(Od(gl(this,p))),p+=1}a=d.join("");break;default:switch(t){case 1:return s=gl(this,this.l),this.l++,s;case 2:return s=(r==="i"?wk:Wo)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(s=(t>0?ys:kk)(this,this.l),this.l+=4,s):(o=Zn(this,this.l),this.l+=4,o);case 8:case-8:if(r==="f")return t==8?o=_u(this,this.l):o=_u([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;t=8;case 16:a=Q1(this,this.l,t);break}}return this.l+=t,a}var zk=function(t,r,a){t[a]=r&255,t[a+1]=r>>>8&255,t[a+2]=r>>>16&255,t[a+3]=r>>>24&255},Ck=function(t,r,a){t[a]=r&255,t[a+1]=r>>8&255,t[a+2]=r>>16&255,t[a+3]=r>>24&255},Tk=function(t,r,a){t[a]=r&255,t[a+1]=r>>>8&255};function Nk(t,r,a){var s=0,o=0;if(a==="dbcs"){for(o=0;o!=r.length;++o)Tk(this,r.charCodeAt(o),this.l+2*o);s=2*r.length}else if(a==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=r.length;++o)this[this.l+o]=r.charCodeAt(o)&255;s=r.length}else if(a==="hex"){for(;o<t;++o)this[this.l++]=parseInt(r.slice(2*o,2*o+2),16)||0;return this}else if(a==="utf16le"){var d=Math.min(this.l+t,this.length);for(o=0;o<Math.min(r.length,t);++o){var u=r.charCodeAt(o);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<d;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,zk(this,r,this.l);break;case 8:if(s=8,a==="f"){Sk(this,r,this.l);break}case 16:break;case-4:s=4,Ck(this,r,this.l);break}return this.l+=s,this}function uj(t,r){var a=Q1(this,this.l,t.length>>1);if(a!==t)throw new Error(r+"Expected "+t+" saw "+a);this.l+=t.length>>1}function Hn(t,r){t.l=r,t.read_shift=Zo,t.chk=uj,t.write_shift=Nk}function Lr(t,r){t.l+=r}function Pe(t){var r=js(t);return Hn(r,0),r}function Nn(){var t=[],r=Vt?256:2048,a=function(p){var x=Pe(p);return Hn(x,0),x},s=a(r),o=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},d=function(p){return s&&p<s.length-s.l?s:(o(),s=a(Math.max(p+1,r)))},u=function(){return o(),nn(t)},h=function(p){o(),s=p,s.l==null&&(s.l=s.length),d(r)};return{next:d,push:h,end:u,_bufs:t}}function Ke(t,r,a,s){var o=+r,d;if(!isNaN(o)){s||(s=_6[o].p||(a||[]).length||0),d=1+(o>=128?1:0)+1,s>=128&&++d,s>=16384&&++d,s>=2097152&&++d;var u=t.next(d);o<=127?u.write_shift(1,o):(u.write_shift(1,(o&127)+128),u.write_shift(1,o>>7));for(var h=0;h!=4;++h)if(s>=128)u.write_shift(1,(s&127)+128),s>>=7;else{u.write_shift(1,s);break}s>0&&xp(a)&&t.push(a)}}function Go(t,r,a){var s=En(t);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!a||a.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Xy(t,r,a){var s=En(t);return s.s=Go(s.s,r.s,a),s.e=Go(s.e,r.s,a),s}function Ko(t,r){if(t.cRel&&t.c<0)for(t=En(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=En(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var a=ea(t);return!t.cRel&&t.cRel!=null&&(a=Fk(a)),!t.rRel&&t.rRel!=null&&(a=Ak(a)),a}function im(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+fn(t.s.c)+":"+(t.e.cRel?"":"$")+fn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+sn(t.s.r)+":"+(t.e.rRel?"":"$")+sn(t.e.r):Ko(t.s,r.biff)+":"+Ko(t.e,r.biff)}function yp(t){return parseInt(Ek(t),10)-1}function sn(t){return""+(t+1)}function Ak(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ek(t){return t.replace(/\$(\d+)$/,"$1")}function vp(t){for(var r=Rk(t),a=0,s=0;s!==r.length;++s)a=26*a+r.charCodeAt(s)-64;return a-1}function fn(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function Fk(t){return t.replace(/^([A-Z])/,"$$$1")}function Rk(t){return t.replace(/^\$([A-Z])/,"$1")}function Bk(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ga(t){for(var r=0,a=0,s=0;s<t.length;++s){var o=t.charCodeAt(s);o>=48&&o<=57?r=10*r+(o-48):o>=65&&o<=90&&(a=26*a+(o-64))}return{c:a-1,r:r-1}}function ea(t){for(var r=t.c+1,a="";r;r=(r-1)/26|0)a=String.fromCharCode((r-1)%26+65)+a;return a+(t.r+1)}function Gn(t){var r=t.indexOf(":");return r==-1?{s:Ga(t),e:Ga(t)}:{s:Ga(t.slice(0,r)),e:Ga(t.slice(r+1))}}function La(t,r){return typeof r>"u"||typeof r=="number"?La(t.s,t.e):(typeof t!="string"&&(t=ea(t)),typeof r!="string"&&(r=ea(r)),t==r?t:t+":"+r)}function pa(t){var r={s:{c:0,r:0},e:{c:0,r:0}},a=0,s=0,o=0,d=t.length;for(a=0;s<d&&!((o=t.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(r.s.c=--a,a=0;s<d&&!((o=t.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;if(r.s.r=--a,s===d||o!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,a=0;s!=d&&!((o=t.charCodeAt(s)-64)<1||o>26);++s)a=26*a+o;for(r.e.c=--a,a=0;s!=d&&!((o=t.charCodeAt(s)-48)<0||o>9);++s)a=10*a+o;return r.e.r=--a,r}function Qy(t,r){var a=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=Zi(t.z,a?An(r):r)}catch{}try{return t.w=Zi((t.XF||{}).numFmtId||(a?14:0),a?An(r):r)}catch{return""+r}}function ci(t,r,a){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&a&&a.dateNF&&(t.z=a.dateNF),t.t=="e"?gc[t.v]||t.v:r==null?Qy(t,t.v):Qy(t,r))}function Ss(t,r){var a=r&&r.sheet?r.sheet:"Sheet1",s={};return s[a]=t,{SheetNames:[a],Sheets:s}}function fj(t,r,a){var s=a||{},o=t?Array.isArray(t):s.dense,d=t||(o?[]:{}),u=0,h=0;if(d&&s.origin!=null){if(typeof s.origin=="number")u=s.origin;else{var f=typeof s.origin=="string"?Ga(s.origin):s.origin;u=f.r,h=f.c}d["!ref"]||(d["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(d["!ref"]){var x=pa(d["!ref"]);p.s.c=x.s.c,p.s.r=x.s.r,p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),u==-1&&(p.e.r=u=x.e.r+1)}for(var j=0;j!=r.length;++j)if(r[j]){if(!Array.isArray(r[j]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[j].length;++y)if(!(typeof r[j][y]>"u")){var S={v:r[j][y]},w=u+j,b=h+y;if(p.s.r>w&&(p.s.r=w),p.s.c>b&&(p.s.c=b),p.e.r<w&&(p.e.r=w),p.e.c<b&&(p.e.c=b),r[j][y]&&typeof r[j][y]=="object"&&!Array.isArray(r[j][y])&&!(r[j][y]instanceof Date))S=r[j][y];else if(Array.isArray(S.v)&&(S.f=r[j][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(s.nullError)S.t="e",S.v=0;else if(s.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=s.dateNF||ka[14],s.cellDates?(S.t="d",S.w=Zi(S.z,An(S.v))):(S.t="n",S.v=An(S.v),S.w=Zi(S.z,S.v))):S.t="s";if(o)d[w]||(d[w]=[]),d[w][b]&&d[w][b].z&&(S.z=d[w][b].z),d[w][b]=S;else{var _=ea({c:b,r:w});d[_]&&d[_].z&&(S.z=d[_].z),d[_]=S}}}return p.s.c<1e7&&(d["!ref"]=La(p)),d}function Nl(t,r){return fj(null,t,r)}function Ok(t){return t.read_shift(4,"i")}function zr(t,r){return r||(r=Pe(4)),r.write_shift(4,t),r}function hn(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function Ka(t,r){var a=!1;return r==null&&(a=!0,r=Pe(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),a?r.slice(0,r.l):r}function Dk(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Lk(t,r){return r||(r=Pe(4)),r.write_shift(2,0),r.write_shift(2,0),r}function jp(t,r){var a=t.l,s=t.read_shift(1),o=hn(t),d=[],u={t:o,h:o};if((s&1)!==0){for(var h=t.read_shift(4),f=0;f!=h;++f)d.push(Dk(t));u.r=d}else u.r=[{ich:0,ifnt:0}];return t.l=a+r,u}function Mk(t,r){var a=!1;return r==null&&(a=!0,r=Pe(15+4*t.t.length)),r.write_shift(1,0),Ka(t.t,r),a?r.slice(0,r.l):r}var Ik=jp;function Pk(t,r){var a=!1;return r==null&&(a=!0,r=Pe(23+4*t.t.length)),r.write_shift(1,1),Ka(t.t,r),r.write_shift(4,1),Lk({},r),a?r.slice(0,r.l):r}function dr(t){var r=t.read_shift(4),a=t.read_shift(2);return a+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:a}}function ws(t,r){return r==null&&(r=Pe(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function ks(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function zs(t,r){return r==null&&(r=Pe(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var Wk=hn,hj=Ka;function bp(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function Su(t,r){var a=!1;return r==null&&(a=!0,r=Pe(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),a?r.slice(0,r.l):r}var Uk=hn,qm=bp,_p=Su;function mj(t){var r=t.slice(t.l,t.l+4),a=r[0]&1,s=r[0]&2;t.l+=4;var o=s===0?_u([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ys(r,0)>>2;return a?o/100:o}function pj(t,r){r==null&&(r=Pe(4));var a=0,s=0,o=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:o==(o|0)&&o>=-536870912&&o<1<<29&&(s=1,a=1),s)r.write_shift(-4,((a?o:t)<<2)+(a+2));else throw new Error("unsupported RkNumber "+t)}function gj(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function $k(t,r){return r||(r=Pe(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var Cs=gj,Al=$k;function El(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function bs(t,r){return(r||Pe(8)).write_shift(8,t,"f")}function Hk(t){var r={},a=t.read_shift(1),s=a>>>1,o=t.read_shift(1),d=t.read_shift(2,"i"),u=t.read_shift(1),h=t.read_shift(1),f=t.read_shift(1);switch(t.l++,s){case 0:r.auto=1;break;case 1:r.index=o;var p=Qk[o];p&&(r.rgb=dv(p));break;case 2:r.rgb=dv([u,h,f]);break;case 3:r.theme=o;break}return d!=0&&(r.tint=d>0?d/32767:d/32768),r}function wu(t,r){if(r||(r=Pe(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var a=t.tint||0;if(a>0?a*=32767:a<0&&(a*=32768),r.write_shift(2,a),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function Vk(t){var r=t.read_shift(1);t.l++;var a={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return a}function Zk(t,r){r||(r=Pe(2));var a=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,a),r.write_shift(1,0),r}var xj=2,$n=3,Id=11,ku=19,Pd=64,Gk=65,Kk=71,qk=4108,Yk=4126,an=80,ev={1:{n:"CodePage",t:xj},2:{n:"Category",t:an},3:{n:"PresentationFormat",t:an},4:{n:"ByteCount",t:$n},5:{n:"LineCount",t:$n},6:{n:"ParagraphCount",t:$n},7:{n:"SlideCount",t:$n},8:{n:"NoteCount",t:$n},9:{n:"HiddenCount",t:$n},10:{n:"MultimediaClipCount",t:$n},11:{n:"ScaleCrop",t:Id},12:{n:"HeadingPairs",t:qk},13:{n:"TitlesOfParts",t:Yk},14:{n:"Manager",t:an},15:{n:"Company",t:an},16:{n:"LinksUpToDate",t:Id},17:{n:"CharacterCount",t:$n},19:{n:"SharedDoc",t:Id},22:{n:"HyperlinksChanged",t:Id},23:{n:"AppVersion",t:$n,p:"version"},24:{n:"DigSig",t:Gk},26:{n:"ContentType",t:an},27:{n:"ContentStatus",t:an},28:{n:"Language",t:an},29:{n:"Version",t:an},255:{},2147483648:{n:"Locale",t:ku},2147483651:{n:"Behavior",t:ku},1919054434:{}},tv={1:{n:"CodePage",t:xj},2:{n:"Title",t:an},3:{n:"Subject",t:an},4:{n:"Author",t:an},5:{n:"Keywords",t:an},6:{n:"Comments",t:an},7:{n:"Template",t:an},8:{n:"LastAuthor",t:an},9:{n:"RevNumber",t:an},10:{n:"EditTime",t:Pd},11:{n:"LastPrinted",t:Pd},12:{n:"CreatedDate",t:Pd},13:{n:"ModifiedDate",t:Pd},14:{n:"PageCount",t:$n},15:{n:"WordCount",t:$n},16:{n:"CharCount",t:$n},17:{n:"Thumbnail",t:Kk},18:{n:"Application",t:an},19:{n:"DocSecurity",t:$n},255:{},2147483648:{n:"Locale",t:ku},2147483651:{n:"Behavior",t:ku},1919054434:{}};function Jk(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var Xk=Jk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Qk=En(Xk),gc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ez={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Wd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function yj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function vj(t,r){var a=dk(ez),s=[],o;s[s.length]=Ma,s[s.length]=Je("Types",null,{xmlns:Za.CT,"xmlns:xsd":Za.xsd,"xmlns:xsi":Za.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Je("Default",null,{Extension:f[0],ContentType:f[1]})}));var d=function(f){t[f]&&t[f].length>0&&(o=t[f][0],s[s.length]=Je("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:Wd[f][r.bookType]||Wd[f].xlsx}))},u=function(f){(t[f]||[]).forEach(function(p){s[s.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:Wd[f][r.bookType]||Wd[f].xlsx})})},h=function(f){(t[f]||[]).forEach(function(p){s[s.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:a[f][0]})})};return d("workbooks"),u("sheets"),u("charts"),h("themes"),["strs","styles"].forEach(d),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),u("metadata"),h("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var $t={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jj(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function vl(t){var r=[Ma,Je("Relationships",null,{xmlns:Za.RELS})];return ln(t["!id"]).forEach(function(a){r[r.length]=Je("Relationship",null,t["!id"][a])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Xt(t,r,a,s,o,d){if(o||(o={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,o.Id="rId"+r,o.Type=s,o.Target=a,[$t.HLINK,$t.XPATH,$t.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),t["!id"][o.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][o.Id]=o,t[("/"+o.Target).replace("//","/")]=o,r}function tz(t){var r=[Ma];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var a=0;a<t.length;++a)r.push('  <manifest:file-entry manifest:full-path="'+t[a][0]+'" manifest:media-type="'+t[a][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function av(t,r,a){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(a||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function az(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function nz(t){var r=[Ma];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var a=0;a!=t.length;++a)r.push(av(t[a][0],t[a][1])),r.push(az("",t[a][0]));return r.push(av("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function bj(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gu.version+"</meta:generator></office:meta></office:document-meta>"}var vs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function sm(t,r,a,s,o){o[t]!=null||r==null||r===""||(o[t]=r,r=Qt(r),s[s.length]=a?Je(t,r,a):rn(t,r))}function _j(t,r){var a=r||{},s=[Ma,Je("cp:coreProperties",null,{"xmlns:cp":Za.CORE_PROPS,"xmlns:dc":Za.dc,"xmlns:dcterms":Za.dcterms,"xmlns:dcmitype":Za.dcmitype,"xmlns:xsi":Za.xsi})],o={};if(!t&&!a.Props)return s.join("");t&&(t.CreatedDate!=null&&sm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Km(t.CreatedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o),t.ModifiedDate!=null&&sm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Km(t.ModifiedDate,a.WTF),{"xsi:type":"dcterms:W3CDTF"},s,o));for(var d=0;d!=vs.length;++d){var u=vs[d],h=a.Props&&a.Props[u[1]]!=null?a.Props[u[1]]:t?t[u[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&sm(u[0],h,null,s,o)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var jl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Sj=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wj(t){var r=[],a=Je;return t||(t={}),t.Application="SheetJS",r[r.length]=Ma,r[r.length]=Je("Properties",null,{xmlns:Za.EXT_PROPS,"xmlns:vt":Za.vt}),jl.forEach(function(s){if(t[s[1]]!==void 0){var o;switch(s[2]){case"string":o=Qt(String(t[s[1]]));break;case"bool":o=t[s[1]]?"true":"false";break}o!==void 0&&(r[r.length]=a(s[0],o))}}),r[r.length]=a("HeadingPairs",a("vt:vector",a("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+a("vt:variant",a("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=a("TitlesOfParts",a("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Qt(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function kj(t){var r=[Ma,Je("Properties",null,{xmlns:Za.CUST_PROPS,"xmlns:vt":Za.vt})];if(!t)return r.join("");var a=1;return ln(t).forEach(function(o){++a,r[r.length]=Je("property",bk(t[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:a,name:Qt(o)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var nv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rz(t,r){var a=[];return ln(nv).map(function(s){for(var o=0;o<vs.length;++o)if(vs[o][1]==s)return vs[o];for(o=0;o<jl.length;++o)if(jl[o][1]==s)return jl[o];throw s}).forEach(function(s){if(t[s[1]]!=null){var o=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t[s[1]];s[2]==="date"&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"Z")),typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),a.push(rn(nv[s[1]]||s[1],o))}}),Je("DocumentProperties",a.join(""),{xmlns:Vn.o})}function iz(t,r){var a=["Worksheets","SheetNames"],s="CustomDocumentProperties",o=[];return t&&ln(t).forEach(function(d){if(Object.prototype.hasOwnProperty.call(t,d)){for(var u=0;u<vs.length;++u)if(d==vs[u][1])return;for(u=0;u<jl.length;++u)if(d==jl[u][1])return;for(u=0;u<a.length;++u)if(d==a[u])return;var h=t[d],f="string";typeof h=="number"?(f="float",h=String(h)):h===!0||h===!1?(f="boolean",h=h?"1":"0"):h=String(h),o.push(Je(Hy(d),h,{"dt:dt":f}))}}),r&&ln(r).forEach(function(d){if(Object.prototype.hasOwnProperty.call(r,d)&&!(t&&Object.prototype.hasOwnProperty.call(t,d))){var u=r[d],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u instanceof Date?(h="dateTime.tz",u=u.toISOString()):u=String(u),o.push(Je(Hy(d),u,{"dt:dt":h}))}}),"<"+s+' xmlns="'+Vn.o+'">'+o.join("")+"</"+s+">"}function sz(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,a=r.getTime()/1e3+11644473600,s=a%Math.pow(2,32),o=(a-s)/Math.pow(2,32);s*=1e7,o*=1e7;var d=s/Math.pow(2,32)|0;d>0&&(s=s%Math.pow(2,32),o+=d);var u=Pe(8);return u.write_shift(4,s),u.write_shift(4,o),u}function rv(t,r){var a=Pe(4),s=Pe(4);switch(a.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,r);break;case 5:s=Pe(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=sz(r);break;case 31:case 80:for(s=Pe(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return nn([a,s])}var zj=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function lz(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function iv(t,r,a){var s=Pe(8),o=[],d=[],u=8,h=0,f=Pe(8),p=Pe(8);if(f.write_shift(4,2),f.write_shift(4,1200),p.write_shift(4,1),d.push(f),o.push(p),u+=8+f.length,!r){p=Pe(8),p.write_shift(4,0),o.unshift(p);var x=[Pe(4)];for(x[0].write_shift(4,t.length),h=0;h<t.length;++h){var j=t[h][0];for(f=Pe(8+2*(j.length+1)+(j.length%2?0:2)),f.write_shift(4,h+2),f.write_shift(4,j.length+1),f.write_shift(0,j,"dbcs");f.l!=f.length;)f.write_shift(1,0);x.push(f)}f=nn(x),d.unshift(f),u+=8+f.length}for(h=0;h<t.length;++h)if(!(r&&!r[t[h][0]])&&!(zj.indexOf(t[h][0])>-1||Sj.indexOf(t[h][0])>-1)&&t[h][1]!=null){var y=t[h][1],S=0;if(r){S=+r[t[h][0]];var w=a[S];if(w.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=rv(w.t,y)}else{var _=lz(y);_==-1&&(_=31,y=String(y)),f=rv(_,y)}d.push(f),p=Pe(8),p.write_shift(4,r?S:2+h),o.push(p),u+=8+f.length}var E=8*(d.length+1);for(h=0;h<d.length;++h)o[h].write_shift(4,E),E+=d[h].length;return s.write_shift(4,u),s.write_shift(4,d.length),nn([s].concat(o).concat(d))}function sv(t,r,a,s,o,d){var u=Pe(o?68:48),h=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,ia.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,o?2:1),u.write_shift(16,r,"hex"),u.write_shift(4,o?68:48);var f=iv(t,a,s);if(h.push(f),o){var p=iv(o,null,null);u.write_shift(16,d,"hex"),u.write_shift(4,68+f.length),h.push(p)}return nn(h)}function oz(t,r){r||(r=Pe(t));for(var a=0;a<t;++a)r.write_shift(1,0);return r}function cz(t,r){return t.read_shift(r)===1}function yn(t,r){return r||(r=Pe(2)),r.write_shift(2,+!!t),r}function Cj(t){return t.read_shift(2,"u")}function lr(t,r){return r||(r=Pe(2)),r.write_shift(2,t),r}function Tj(t,r,a){return a||(a=Pe(2)),a.write_shift(1,r=="e"?+t:+!!t),a.write_shift(1,r=="e"?1:0),a}function Nj(t,r,a){var s=t.read_shift(a&&a.biff>=12?2:1),o="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var d=t.read_shift(1);d&&(o="dbcs-cont")}else a.biff==12&&(o="wstr");a.biff>=2&&a.biff<=5&&(o="cpstr");var u=s?t.read_shift(s,o):"";return u}function dz(t){var r=t.t||"",a=Pe(3);a.write_shift(2,r.length),a.write_shift(1,1);var s=Pe(2*r.length);s.write_shift(2*r.length,r,"utf16le");var o=[a,s];return nn(o)}function uz(t,r,a){var s;if(a){if(a.biff>=2&&a.biff<=5)return t.read_shift(r,"cpstr");if(a.biff>=12)return t.read_shift(r,"dbcs-cont")}var o=t.read_shift(1);return o===0?s=t.read_shift(r,"sbcs-cont"):s=t.read_shift(r,"dbcs-cont"),s}function fz(t,r,a){var s=t.read_shift(a&&a.biff==2?1:2);return s===0?(t.l++,""):uz(t,s,a)}function hz(t,r,a){if(a.biff>5)return fz(t,r,a);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,a.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Aj(t,r,a){return a||(a=Pe(3+2*t.length)),a.write_shift(2,t.length),a.write_shift(1,1),a.write_shift(31,t,"utf16le"),a}function lv(t,r){r||(r=Pe(6+t.length*2)),r.write_shift(4,1+t.length);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function mz(t){var r=Pe(512),a=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var o=s.indexOf("#"),d=o>-1?31:23;switch(s.charAt(0)){case"#":d=28;break;case".":d&=-3;break}r.write_shift(4,2),r.write_shift(4,d);var u=[8,6815827,6619237,4849780,83];for(a=0;a<u.length;++a)r.write_shift(4,u[a]);if(d==28)s=s.slice(1),lv(s,r);else if(d&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<u.length;++a)r.write_shift(1,parseInt(u[a],16));var h=o>-1?s.slice(0,o):s;for(r.write_shift(4,2*(h.length+1)),a=0;a<h.length;++a)r.write_shift(2,h.charCodeAt(a));r.write_shift(2,0),d&8&&lv(o>-1?s.slice(o+1):"",r)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),a=0;a<u.length;++a)r.write_shift(1,parseInt(u[a],16));for(var f=0;s.slice(f*3,f*3+3)=="../"||s.slice(f*3,f*3+3)=="..\\";)++f;for(r.write_shift(2,f),r.write_shift(4,s.length-3*f+1),a=0;a<s.length-3*f;++a)r.write_shift(1,s.charCodeAt(a+3*f)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),a=0;a<6;++a)r.write_shift(4,0)}return r.slice(0,r.l)}function _s(t,r,a,s){return s||(s=Pe(6)),s.write_shift(2,t),s.write_shift(2,r),s.write_shift(2,a||0),s}function pz(t,r,a){var s=a.biff>8?4:2,o=t.read_shift(s),d=t.read_shift(s,"i"),u=t.read_shift(s,"i");return[o,d,u]}function gz(t){var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(2),o=t.read_shift(2);return{s:{c:s,r},e:{c:o,r:a}}}function Ej(t,r){return r||(r=Pe(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Sp(t,r,a){var s=1536,o=16;switch(a.bookType){case"biff8":break;case"biff5":s=1280,o=8;break;case"biff4":s=4,o=6;break;case"biff3":s=3,o=6;break;case"biff2":s=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var d=Pe(o);return d.write_shift(2,s),d.write_shift(2,r),o>4&&d.write_shift(2,29282),o>6&&d.write_shift(2,1997),o>8&&(d.write_shift(2,49161),d.write_shift(2,1),d.write_shift(2,1798),d.write_shift(2,0)),d}function xz(t,r){var a=!r||r.biff==8,s=Pe(a?112:54);for(s.write_shift(r.biff==8?2:1,7),a&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(a?0:536870912));s.l<s.length;)s.write_shift(1,a?0:32);return s}function yz(t,r){var a=!r||r.biff>=8?2:1,s=Pe(8+a*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(a*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var o=s.slice(0,s.l);return o.l=s.l,o}function vz(t,r){var a=Pe(8);a.write_shift(4,t.Count),a.write_shift(4,t.Unique);for(var s=[],o=0;o<t.length;++o)s[o]=dz(t[o]);var d=nn([a].concat(s));return d.parts=[a.length].concat(s.map(function(u){return u.length})),d}function jz(){var t=Pe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function bz(t){var r=Pe(18),a=1718;return t&&t.RTL&&(a|=64),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function _z(t,r){var a=t.name||"Arial",s=r&&r.biff==5,o=s?15+a.length:16+2*a.length,d=Pe(o);return d.write_shift(2,t.sz*20),d.write_shift(4,0),d.write_shift(2,400),d.write_shift(4,0),d.write_shift(2,0),d.write_shift(1,a.length),s||d.write_shift(1,1),d.write_shift((s?1:2)*a.length,a,s?"sbcs":"utf16le"),d}function Sz(t,r,a,s){var o=Pe(10);return _s(t,r,s,o),o.write_shift(4,a),o}function wz(t,r,a,s,o){var d=!o||o.biff==8,u=Pe(8+ +d+(1+d)*a.length);return _s(t,r,s,u),u.write_shift(2,a.length),d&&u.write_shift(1,1),u.write_shift((1+d)*a.length,a,d?"utf16le":"sbcs"),u}function kz(t,r,a,s){var o=a&&a.biff==5;s||(s=Pe(o?3+r.length:5+2*r.length)),s.write_shift(2,t),s.write_shift(o?1:2,r.length),o||s.write_shift(1,1),s.write_shift((o?1:2)*r.length,r,o?"sbcs":"utf16le");var d=s.length>s.l?s.slice(0,s.l):s;return d.l==null&&(d.l=d.length),d}function zz(t,r){var a=r.biff==8||!r.biff?4:2,s=Pe(2*a+6);return s.write_shift(a,t.s.r),s.write_shift(a,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function ov(t,r,a,s){var o=a&&a.biff==5;s||(s=Pe(o?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,r<<4));var d=0;return t.numFmtId>0&&o&&(d|=1024),s.write_shift(4,d),s.write_shift(4,0),o||s.write_shift(4,0),s.write_shift(2,0),s}function Cz(t){var r=Pe(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Tz(t,r,a,s,o,d){var u=Pe(8);return _s(t,r,s,u),Tj(a,d,u),u}function Nz(t,r,a,s){var o=Pe(14);return _s(t,r,s,o),bs(a,o),o}function Az(t,r,a){if(a.biff<8)return Ez(t,r,a);for(var s=[],o=t.l+r,d=t.read_shift(a.biff>8?4:2);d--!==0;)s.push(pz(t,a.biff>8?12:6,a));if(t.l!=o)throw new Error("Bad ExternSheet: "+t.l+" != "+o);return s}function Ez(t,r,a){t[t.l+1]==3&&t[t.l]++;var s=Nj(t,r,a);return s.charCodeAt(0)==3?s.slice(1):s}function Fz(t){var r=Pe(2+t.length*8);r.write_shift(2,t.length);for(var a=0;a<t.length;++a)Ej(t[a],r);return r}function Rz(t){var r=Pe(24),a=Ga(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)r.write_shift(1,parseInt(s[o],16));return nn([r,mz(t[1])])}function Bz(t){var r=t[1].Tooltip,a=Pe(10+2*(r.length+1));a.write_shift(2,2048);var s=Ga(t[0]);a.write_shift(2,s.r),a.write_shift(2,s.r),a.write_shift(2,s.c),a.write_shift(2,s.c);for(var o=0;o<r.length;++o)a.write_shift(2,r.charCodeAt(o));return a.write_shift(2,0),a}function Oz(t){return t||(t=Pe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Dz(t,r,a){if(!a.cellStyles)return Lr(t,r);var s=a&&a.biff>=12?4:2,o=t.read_shift(s),d=t.read_shift(s),u=t.read_shift(s),h=t.read_shift(s),f=t.read_shift(2);s==2&&(t.l+=2);var p={s:o,e:d,w:u,ixfe:h,flags:f};return(a.biff>=5||!a.biff)&&(p.level=f>>8&7),p}function Lz(t,r){var a=Pe(12);a.write_shift(2,r),a.write_shift(2,r),a.write_shift(2,t.width*256),a.write_shift(2,0);var s=0;return t.hidden&&(s|=1),a.write_shift(1,s),s=t.level||0,a.write_shift(1,s),a.write_shift(2,0),a}function Mz(t){for(var r=Pe(2*t),a=0;a<t;++a)r.write_shift(2,a+1);return r}function Iz(t,r,a){var s=Pe(15);return yc(s,t,r),s.write_shift(8,a,"f"),s}function Pz(t,r,a){var s=Pe(9);return yc(s,t,r),s.write_shift(2,a),s}var Wz=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=fp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(h,f){var p=[],x=js(1);switch(f.type){case"base64":x=wr(oi(h));break;case"binary":x=wr(h);break;case"buffer":case"array":x=h;break}Hn(x,0);var j=x.read_shift(1),y=!!(j&136),S=!1,w=!1;switch(j){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+j.toString(16))}var b=0,_=521;j==2&&(b=x.read_shift(2)),x.l+=3,j!=2&&(b=x.read_shift(4)),b>1048576&&(b=1e6),j!=2&&(_=x.read_shift(2));var E=x.read_shift(2),C=f.codepage||1252;j!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(C=t[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var N=[],O={},Q=Math.min(x.length,j==2?521:_-10-(S?264:0)),G=w?32:11;x.l<Q&&x[x.l]!=13;)switch(O={},O.name=xu.utils.decode(C,x.slice(x.l,x.l+G)).replace(/[\u0000\r\n].*$/g,""),x.l+=G,O.type=String.fromCharCode(x.read_shift(1)),j!=2&&!w&&(O.offset=x.read_shift(4)),O.len=x.read_shift(1),j==2&&(O.offset=x.read_shift(2)),O.dec=x.read_shift(1),O.name.length&&N.push(O),j!=2&&(x.l+=w?13:14),O.type){case"B":(!S||O.len!=8)&&f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(x[x.l]!==13&&(x.l=_-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=_;var M=0,U=0;for(p[0]=[],U=0;U!=N.length;++U)p[0][U]=N[U].name;for(;b-- >0;){if(x[x.l]===42){x.l+=E;continue}for(++x.l,p[++M]=[],U=0,U=0;U!=N.length;++U){var A=x.slice(x.l,x.l+N[U].len);x.l+=N[U].len,Hn(A,0);var R=xu.utils.decode(C,A);switch(N[U].type){case"C":R.trim().length&&(p[M][U]=R.replace(/\s+$/,""));break;case"D":R.length===8?p[M][U]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):p[M][U]=R;break;case"F":p[M][U]=parseFloat(R.trim());break;case"+":case"I":p[M][U]=w?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":p[M][U]=!0;break;case"N":case"F":p[M][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+j.toString(16));p[M][U]="##MEMO##"+(w?parseInt(R.trim(),10):A.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(p[M][U]=+R||0);break;case"@":p[M][U]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":p[M][U]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":p[M][U]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[M][U]=-A.read_shift(-8,"f");break;case"B":if(S&&N[U].len==8){p[M][U]=A.read_shift(8,"f");break}case"G":case"P":A.l+=N[U].len;break;case"0":if(N[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[U].type)}}}if(j!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return f&&f.sheetRows&&(p=p.slice(0,f.sheetRows)),f.DBF=N,p}function s(h,f){var p=f||{};p.dateNF||(p.dateNF="yyyymmdd");var x=Nl(a(h,p),p);return x["!cols"]=p.DBF.map(function(j){return{wch:j.len,DBF:j}}),delete p.DBF,x}function o(h,f){try{return Ss(s(h,f),f)}catch(p){if(f&&f.WTF)throw p}return{SheetNames:[],Sheets:{}}}var d={B:8,C:250,L:1,D:8,"?":0,"":0};function u(h,f){var p=f||{};if(+p.codepage>=0&&ec(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var x=Nn(),j=Au(h,{header:1,raw:!0,cellDates:!0}),y=j[0],S=j.slice(1),w=h["!cols"]||[],b=0,_=0,E=0,C=1;for(b=0;b<y.length;++b){if(((w[b]||{}).DBF||{}).name){y[b]=w[b].DBF.name,++E;continue}if(y[b]!=null){if(++E,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(_=0;_<1024;++_)if(y.indexOf(y[b]+"_"+_)==-1){y[b]+="_"+_;break}}}}var N=pa(h["!ref"]),O=[],Q=[],G=[];for(b=0;b<=N.e.c-N.s.c;++b){var M="",U="",A=0,R=[];for(_=0;_<S.length;++_)S[_][b]!=null&&R.push(S[_][b]);if(R.length==0||y[b]==null){O[b]="?";continue}for(_=0;_<R.length;++_){switch(typeof R[_]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=R[_]instanceof Date?"D":"C";break;default:U="C"}A=Math.max(A,String(R[_]).length),M=M&&M!=U?"C":U}A>250&&(A=250),U=((w[b]||{}).DBF||{}).type,U=="C"&&w[b].DBF.len>A&&(A=w[b].DBF.len),M=="B"&&U=="N"&&(M="N",G[b]=w[b].DBF.dec,A=w[b].DBF.len),Q[b]=M=="C"||U=="N"?A:d[M]||0,C+=Q[b],O[b]=M}var Z=x.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,S.length),Z.write_shift(2,296+32*E),Z.write_shift(2,C),b=0;b<4;++b)Z.write_shift(4,0);for(Z.write_shift(4,0|(+r[R1]||3)<<8),b=0,_=0;b<y.length;++b)if(y[b]!=null){var F=x.next(32),q=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,q,"sbcs"),F.write_shift(1,O[b]=="?"?"C":O[b],"sbcs"),F.write_shift(4,_),F.write_shift(1,Q[b]||d[O[b]]||0),F.write_shift(1,G[b]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),_+=Q[b]||d[O[b]]||0}var ee=x.next(264);for(ee.write_shift(4,13),b=0;b<65;++b)ee.write_shift(4,0);for(b=0;b<S.length;++b){var me=x.next(C);for(me.write_shift(1,0),_=0;_<y.length;++_)if(y[_]!=null)switch(O[_]){case"L":me.write_shift(1,S[b][_]==null?63:S[b][_]?84:70);break;case"B":me.write_shift(8,S[b][_]||0,"f");break;case"N":var W="0";for(typeof S[b][_]=="number"&&(W=S[b][_].toFixed(G[_]||0)),E=0;E<Q[_]-W.length;++E)me.write_shift(1,32);me.write_shift(1,W,"sbcs");break;case"D":S[b][_]?(me.write_shift(4,("0000"+S[b][_].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(S[b][_].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+S[b][_].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var J=String(S[b][_]!=null?S[b][_]:"").slice(0,Q[_]);for(me.write_shift(1,J,"sbcs"),E=0;E<Q[_]-J.length;++E)me.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:o,to_sheet:s,from_sheet:u}})(),Uz=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ln(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(y,S){var w=t[S];return typeof w=="number"?Fy(w):w},s=function(y,S,w){var b=S.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?y:Fy(b)};t["|"]=254;function o(y,S){switch(S.type){case"base64":return d(oi(y),S);case"binary":return d(y,S);case"buffer":return d(Vt&&Buffer.isBuffer(y)?y.toString("binary"):hc(y),S);case"array":return d(Wu(y),S)}throw new Error("Unrecognized type "+S.type)}function d(y,S){var w=y.split(/[\n\r]+/),b=-1,_=-1,E=0,C=0,N=[],O=[],Q=null,G={},M=[],U=[],A=[],R=0,Z;for(+S.codepage>=0&&ec(+S.codepage);E!==w.length;++E){R=0;var F=w[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,a),q=F.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),ee=q[0],me;if(F.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&O.push(F.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,J=!1,L=!1,H=!1,ne=-1,P=-1;for(C=1;C<q.length;++C)switch(q[C].charAt(0)){case"A":break;case"X":_=parseInt(q[C].slice(1))-1,J=!0;break;case"Y":for(b=parseInt(q[C].slice(1))-1,J||(_=0),Z=N.length;Z<=b;++Z)N[Z]=[];break;case"K":me=q[C].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(ii(me))?isNaN(ac(me).getDate())||(me=vn(me)):(me=ii(me),Q!==null&&V1(Q)&&(me=q1(me))),W=!0;break;case"E":H=!0;var T=PC(q[C].slice(1),{r:b,c:_});N[b][_]=[N[b][_],T];break;case"S":L=!0,N[b][_]=[N[b][_],"S5S"];break;case"G":break;case"R":ne=parseInt(q[C].slice(1))-1;break;case"C":P=parseInt(q[C].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}if(W&&(N[b][_]&&N[b][_].length==2?N[b][_][0]=me:N[b][_]=me,Q=null),L){if(H)throw new Error("SYLK shared formula cannot have own formula");var z=ne>-1&&N[ne][P];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");N[b][_][1]=WC(z[1],{r:b-ne,c:_-P})}break;case"F":var k=0;for(C=1;C<q.length;++C)switch(q[C].charAt(0)){case"X":_=parseInt(q[C].slice(1))-1,++k;break;case"Y":for(b=parseInt(q[C].slice(1))-1,Z=N.length;Z<=b;++Z)N[Z]=[];break;case"M":R=parseInt(q[C].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=O[parseInt(q[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=q[C].slice(1).split(" "),Z=parseInt(A[0],10);Z<=parseInt(A[1],10);++Z)R=parseInt(A[2],10),U[Z-1]=R===0?{hidden:!0}:{wch:R},wp(U[Z-1]);break;case"C":_=parseInt(q[C].slice(1))-1,U[_]||(U[_]={});break;case"R":b=parseInt(q[C].slice(1))-1,M[b]||(M[b]={}),R>0?(M[b].hpt=R,M[b].hpx=Dj(R)):R===0&&(M[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}k<1&&(Q=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+F)}}return M.length>0&&(G["!rows"]=M),U.length>0&&(G["!cols"]=U),S&&S.sheetRows&&(N=N.slice(0,S.sheetRows)),[N,G]}function u(y,S){var w=o(y,S),b=w[0],_=w[1],E=Nl(b,S);return ln(_).forEach(function(C){E[C]=_[C]}),E}function h(y,S){return Ss(u(y,S),S)}function f(y,S,w,b){var _="C;Y"+(w+1)+";X"+(b+1)+";K";switch(y.t){case"n":_+=y.v||0,y.f&&!y.F&&(_+=";E"+zp(y.f,{r:w,c:b}));break;case"b":_+=y.v?"TRUE":"FALSE";break;case"e":_+=y.w||y.v;break;case"d":_+='"'+(y.w||y.v)+'"';break;case"s":_+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function p(y,S){S.forEach(function(w,b){var _="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?_+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=zu(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Cu(w.wpx)),typeof w.wch=="number"&&(_+=Math.round(w.wch))),_.charAt(_.length-1)!=" "&&y.push(_)})}function x(y,S){S.forEach(function(w,b){var _="F;";w.hidden?_+="M0;":w.hpt?_+="M"+20*w.hpt+";":w.hpx&&(_+="M"+20*Tu(w.hpx)+";"),_.length>2&&y.push(_+"R"+(b+1))})}function j(y,S){var w=["ID;PWXL;N;E"],b=[],_=pa(y["!ref"]),E,C=Array.isArray(y),N=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&p(w,y["!cols"]),y["!rows"]&&x(w,y["!rows"]),w.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var O=_.s.r;O<=_.e.r;++O)for(var Q=_.s.c;Q<=_.e.c;++Q){var G=ea({r:O,c:Q});E=C?(y[O]||[])[Q]:y[G],!(!E||E.v==null&&(!E.f||E.F))&&b.push(f(E,y,O,Q))}return w.join(N)+N+b.join(N)+N+"E"+N}return{to_workbook:h,to_sheet:u,from_sheet:j}})(),$z=(function(){function t(d,u){switch(u.type){case"base64":return r(oi(d),u);case"binary":return r(d,u);case"buffer":return r(Vt&&Buffer.isBuffer(d)?d.toString("binary"):hc(d),u);case"array":return r(Wu(d),u)}throw new Error("Unrecognized type "+u.type)}function r(d,u){for(var h=d.split(`
`),f=-1,p=-1,x=0,j=[];x!==h.length;++x){if(h[x].trim()==="BOT"){j[++f]=[],p=0;continue}if(!(f<0)){var y=h[x].trim().split(","),S=y[0],w=y[1];++x;for(var b=h[x]||"";(b.match(/["]/g)||[]).length&1&&x<h.length-1;)b+=`
`+h[++x];switch(b=b.trim(),+S){case-1:if(b==="BOT"){j[++f]=[],p=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?j[f][p]=!0:b==="FALSE"?j[f][p]=!1:isNaN(ii(w))?isNaN(ac(w).getDate())?j[f][p]=w:j[f][p]=vn(w):j[f][p]=ii(w),++p;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),j[f][p++]=b!==""?b:null;break}if(b==="EOD")break}}return u&&u.sheetRows&&(j=j.slice(0,u.sheetRows)),j}function a(d,u){return Nl(t(d,u),u)}function s(d,u){return Ss(a(d,u),u)}var o=(function(){var d=function(f,p,x,j,y){f.push(p),f.push(x+","+j),f.push('"'+y.replace(/"/g,'""')+'"')},u=function(f,p,x,j){f.push(p+","+x),f.push(p==1?'"'+j.replace(/"/g,'""')+'"':j)};return function(f){var p=[],x=pa(f["!ref"]),j,y=Array.isArray(f);d(p,"TABLE",0,1,"sheetjs"),d(p,"VECTORS",0,x.e.r-x.s.r+1,""),d(p,"TUPLES",0,x.e.c-x.s.c+1,""),d(p,"DATA",0,0,"");for(var S=x.s.r;S<=x.e.r;++S){u(p,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var b=ea({r:S,c:w});if(j=y?(f[S]||[])[w]:f[b],!j){u(p,1,0,"");continue}switch(j.t){case"n":var _=j.w;!_&&j.v!=null&&(_=j.v),_==null?j.f&&!j.F?u(p,1,0,"="+j.f):u(p,1,0,""):u(p,0,_,"V");break;case"b":u(p,0,j.v?1:0,j.v?"TRUE":"FALSE");break;case"s":u(p,1,0,isNaN(j.v)?j.v:'="'+j.v+'"');break;case"d":j.w||(j.w=Zi(j.z||ka[14],An(vn(j.v)))),u(p,0,j.w,"V");break;default:u(p,1,0,"")}}}u(p,-1,0,"EOD");var E=`\r
`,C=p.join(E);return C}})();return{to_workbook:s,to_sheet:a,from_sheet:o}})(),Fj=(function(){function t(j){return j.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(j){return j.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(j,y){for(var S=j.split(`
`),w=-1,b=-1,_=0,E=[];_!==S.length;++_){var C=S[_].trim().split(":");if(C[0]==="cell"){var N=Ga(C[1]);if(E.length<=N.r)for(w=E.length;w<=N.r;++w)E[w]||(E[w]=[]);switch(w=N.r,b=N.c,C[2]){case"t":E[w][b]=t(C[3]);break;case"v":E[w][b]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":C[3]==="nl"?E[w][b]=!!+C[4]:E[w][b]=+C[4],C[2]=="vtf"&&(E[w][b]=[E[w][b],O])}}}return y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}function s(j,y){return Nl(a(j,y),y)}function o(j,y){return Ss(s(j,y),y)}var d=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function p(j){if(!j||!j["!ref"])return"";for(var y=[],S=[],w,b="",_=Gn(j["!ref"]),E=Array.isArray(j),C=_.s.r;C<=_.e.r;++C)for(var N=_.s.c;N<=_.e.c;++N)if(b=ea({r:C,c:N}),w=E?(j[C]||[])[N]:j[b],!(!w||w.v==null||w.t==="z")){switch(S=["cell",b,"t"],w.t){case"s":case"str":S.push(r(w.v));break;case"n":w.f?(S[2]="vtf",S[3]="n",S[4]=w.v,S[5]=r(w.f)):(S[2]="v",S[3]=w.v);break;case"b":S[2]="vt"+(w.f?"f":"c"),S[3]="nl",S[4]=w.v?"1":"0",S[5]=r(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var O=An(vn(w.v));S[2]="vtc",S[3]="nd",S[4]=""+O,S[5]=w.w||Zi(w.z||ka[14],O);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function x(j){return[d,u,h,u,p(j),f].join(`
`)}return{to_workbook:o,to_sheet:s,from_sheet:x}})(),Hz=(function(){function t(x,j,y,S,w){w.raw?j[y][S]=x:x===""||(x==="TRUE"?j[y][S]=!0:x==="FALSE"?j[y][S]=!1:isNaN(ii(x))?isNaN(ac(x).getDate())?j[y][S]=x:j[y][S]=vn(x):j[y][S]=ii(x))}function r(x,j){var y=j||{},S=[];if(!x||x.length===0)return S;for(var w=x.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var _=10,E=0,C=0;C<=b;++C)E=w[C].indexOf(" "),E==-1?E=w[C].length:E++,_=Math.max(_,E);for(C=0;C<=b;++C){S[C]=[];var N=0;for(t(w[C].slice(0,_).trim(),S,C,N,y),N=1;N<=(w[C].length-_)/10+1;++N)t(w[C].slice(_+(N-1)*10,_+N*10).trim(),S,C,N,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var a={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function o(x){for(var j={},y=!1,S=0,w=0;S<x.length;++S)(w=x.charCodeAt(S))==34?y=!y:!y&&w in a&&(j[w]=(j[w]||0)+1);w=[];for(S in j)Object.prototype.hasOwnProperty.call(j,S)&&w.push([j[S],S]);if(!w.length){j=s;for(S in j)Object.prototype.hasOwnProperty.call(j,S)&&w.push([j[S],S])}return w.sort(function(b,_){return b[0]-_[0]||s[b[1]]-s[_[1]]}),a[w.pop()[1]]||44}function d(x,j){var y=j||{},S="",w=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(S=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(S=x.charAt(4),x=x.slice(6)):S=o(x.slice(0,1024)):y&&y.FS?S=y.FS:S=o(x.slice(0,1024));var _=0,E=0,C=0,N=0,O=0,Q=S.charCodeAt(0),G=!1,M=0,U=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var A=y.dateNF!=null?sk(y.dateNF):null;function R(){var Z=x.slice(N,O),F={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)F.t="z";else if(y.raw)F.t="s",F.v=Z;else if(Z.trim().length===0)F.t="s",F.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(F.t="s",F.v=Z.slice(2,-1).replace(/""/g,'"')):UC(Z)?(F.t="n",F.f=Z.slice(1)):(F.t="s",F.v=Z);else if(Z=="TRUE")F.t="b",F.v=!0;else if(Z=="FALSE")F.t="b",F.v=!1;else if(!isNaN(C=ii(Z)))F.t="n",y.cellText!==!1&&(F.w=Z),F.v=C;else if(!isNaN(ac(Z).getDate())||A&&Z.match(A)){F.z=y.dateNF||ka[14];var q=0;A&&Z.match(A)&&(Z=lk(Z,y.dateNF,Z.match(A)||[]),q=1),y.cellDates?(F.t="d",F.v=vn(Z,q)):(F.t="n",F.v=An(vn(Z,q))),y.cellText!==!1&&(F.w=Zi(F.z,F.v instanceof Date?An(F.v):F.v)),y.cellNF||delete F.z}else F.t="s",F.v=Z;if(F.t=="z"||(y.dense?(w[_]||(w[_]=[]),w[_][E]=F):w[ea({c:E,r:_})]=F),N=O+1,U=x.charCodeAt(N),b.e.c<E&&(b.e.c=E),b.e.r<_&&(b.e.r=_),M==Q)++E;else if(E=0,++_,y.sheetRows&&y.sheetRows<=_)return!0}e:for(;O<x.length;++O)switch(M=x.charCodeAt(O)){case 34:U===34&&(G=!G);break;case Q:case 10:case 13:if(!G&&R())break e;break}return O-N>0&&R(),w["!ref"]=La(b),w}function u(x,j){return!(j&&j.PRN)||j.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?d(x,j):Nl(r(x,j),j)}function h(x,j){var y="",S=j.type=="string"?[0,0,0,0]:aA(x,j);switch(j.type){case"base64":y=oi(x);break;case"binary":y=x;break;case"buffer":j.codepage==65001?y=x.toString("utf8"):j.codepage&&typeof xu<"u"||(y=Vt&&Buffer.isBuffer(x)?x.toString("binary"):hc(x));break;case"array":y=Wu(x);break;case"string":y=x;break;default:throw new Error("Unrecognized type "+j.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Vo(y.slice(3)):j.type!="string"&&j.type!="buffer"&&j.codepage==65001?y=Vo(y):j.type=="binary"&&typeof xu<"u",y.slice(0,19)=="socialcalc:version:"?Fj.to_sheet(j.type=="string"?y:Vo(y),j):u(y,j)}function f(x,j){return Ss(h(x,j),j)}function p(x){for(var j=[],y=pa(x["!ref"]),S,w=Array.isArray(x),b=y.s.r;b<=y.e.r;++b){for(var _=[],E=y.s.c;E<=y.e.c;++E){var C=ea({r:b,c:E});if(S=w?(x[b]||[])[E]:x[C],!S||S.v==null){_.push("          ");continue}for(var N=(S.w||(ci(S),S.w)||"").slice(0,10);N.length<10;)N+=" ";_.push(N+(E===0?" ":""))}j.push(_.join(""))}return j.join(`
`)}return{to_workbook:f,to_sheet:h,from_sheet:p}})(),cv=(function(){function t(T,z,k){if(T){Hn(T,T.l||0);for(var I=k.Enum||ne;T.l<T.length;){var D=T.read_shift(2),de=I[D]||I[65535],he=T.read_shift(2),ie=T.l+he,ve=de.f&&de.f(T,he,k);if(T.l=ie,z(ve,de,D))return}}}function r(T,z){switch(z.type){case"base64":return a(wr(oi(T)),z);case"binary":return a(wr(T),z);case"buffer":case"array":return a(T,z)}throw"Unsupported type "+z.type}function a(T,z){if(!T)return T;var k=z||{},I=k.dense?[]:{},D="Sheet1",de="",he=0,ie={},ve=[],je=[],fe={s:{r:0,c:0},e:{r:0,c:0}},_e=k.sheetRows||0;if(T[2]==0&&(T[3]==8||T[3]==9)&&T.length>=16&&T[14]==5&&T[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(T[2]==2)k.Enum=ne,t(T,function(oe,Ue,Qe){switch(Qe){case 0:k.vers=oe,oe>=4096&&(k.qpro=!0);break;case 6:fe=oe;break;case 204:oe&&(de=oe);break;case 222:de=oe;break;case 15:case 51:k.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=k.dateNF||ka[14],k.cellDates&&(oe[1].t="d",oe[1].v=q1(oe[1].v))),k.qpro&&oe[3]>he&&(I["!ref"]=La(fe),ie[D]=I,ve.push(D),I=k.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},he=oe[3],D=de||"Sheet"+(he+1),de="");var lt=k.dense?(I[oe[0].r]||[])[oe[0].c]:I[ea(oe[0])];if(lt){lt.t=oe[1].t,lt.v=oe[1].v,oe[1].z!=null&&(lt.z=oe[1].z),oe[1].f!=null&&(lt.f=oe[1].f);break}k.dense?(I[oe[0].r]||(I[oe[0].r]=[]),I[oe[0].r][oe[0].c]=oe[1]):I[ea(oe[0])]=oe[1];break}},k);else if(T[2]==26||T[2]==14)k.Enum=P,T[2]==14&&(k.qpro=!0,T.l=0),t(T,function(oe,Ue,Qe){switch(Qe){case 204:D=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>he&&(I["!ref"]=La(fe),ie[D]=I,ve.push(D),I=k.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},he=oe[3],D="Sheet"+(he+1)),_e>0&&oe[0].r>=_e)break;k.dense?(I[oe[0].r]||(I[oe[0].r]=[]),I[oe[0].r][oe[0].c]=oe[1]):I[ea(oe[0])]=oe[1],fe.e.c<oe[0].c&&(fe.e.c=oe[0].c),fe.e.r<oe[0].r&&(fe.e.r=oe[0].r);break;case 27:oe[14e3]&&(je[oe[14e3][0]]=oe[14e3][1]);break;case 1537:je[oe[0]]=oe[1],oe[0]==he&&(D=oe[1]);break}},k);else throw new Error("Unrecognized LOTUS BOF "+T[2]);if(I["!ref"]=La(fe),ie[de||D]=I,ve.push(de||D),!je.length)return{SheetNames:ve,Sheets:ie};for(var Se={},Ve=[],be=0;be<je.length;++be)ie[ve[be]]?(Ve.push(je[be]||ve[be]),Se[je[be]]=ie[je[be]]||ie[ve[be]]):(Ve.push(je[be]),Se[je[be]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Se}}function s(T,z){var k=z||{};if(+k.codepage>=0&&ec(+k.codepage),k.type=="string")throw new Error("Cannot write WK1 to JS string");var I=Nn(),D=pa(T["!ref"]),de=Array.isArray(T),he=[];Xe(I,0,d(1030)),Xe(I,6,f(D));for(var ie=Math.min(D.e.r,8191),ve=D.s.r;ve<=ie;++ve)for(var je=sn(ve),fe=D.s.c;fe<=D.e.c;++fe){ve===D.s.r&&(he[fe]=fn(fe));var _e=he[fe]+je,Se=de?(T[ve]||[])[fe]:T[_e];if(!(!Se||Se.t=="z"))if(Se.t=="n")(Se.v|0)==Se.v&&Se.v>=-32768&&Se.v<=32767?Xe(I,13,S(ve,fe,Se.v)):Xe(I,14,b(ve,fe,Se.v));else{var Ve=ci(Se);Xe(I,15,j(ve,fe,Ve.slice(0,239)))}}return Xe(I,1),I.end()}function o(T,z){var k=z||{};if(+k.codepage>=0&&ec(+k.codepage),k.type=="string")throw new Error("Cannot write WK3 to JS string");var I=Nn();Xe(I,0,u(T));for(var D=0,de=0;D<T.SheetNames.length;++D)(T.Sheets[T.SheetNames[D]]||{})["!ref"]&&Xe(I,27,H(T.SheetNames[D],de++));var he=0;for(D=0;D<T.SheetNames.length;++D){var ie=T.Sheets[T.SheetNames[D]];if(!(!ie||!ie["!ref"])){for(var ve=pa(ie["!ref"]),je=Array.isArray(ie),fe=[],_e=Math.min(ve.e.r,8191),Se=ve.s.r;Se<=_e;++Se)for(var Ve=sn(Se),be=ve.s.c;be<=ve.e.c;++be){Se===ve.s.r&&(fe[be]=fn(be));var oe=fe[be]+Ve,Ue=je?(ie[Se]||[])[be]:ie[oe];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Xe(I,23,R(Se,be,he,Ue.v));else{var Qe=ci(Ue);Xe(I,22,M(Se,be,he,Qe.slice(0,239)))}}++he}}return Xe(I,1),I.end()}function d(T){var z=Pe(2);return z.write_shift(2,T),z}function u(T){var z=Pe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var k=0,I=0,D=0,de=0;de<T.SheetNames.length;++de){var he=T.SheetNames[de],ie=T.Sheets[he];if(!(!ie||!ie["!ref"])){++D;var ve=Gn(ie["!ref"]);k<ve.e.r&&(k=ve.e.r),I<ve.e.c&&(I=ve.e.c)}}return k>8191&&(k=8191),z.write_shift(2,k),z.write_shift(1,D),z.write_shift(1,I),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function h(T,z,k){var I={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&k.qpro?(I.s.c=T.read_shift(1),T.l++,I.s.r=T.read_shift(2),I.e.c=T.read_shift(1),T.l++,I.e.r=T.read_shift(2),I):(I.s.c=T.read_shift(2),I.s.r=T.read_shift(2),z==12&&k.qpro&&(T.l+=2),I.e.c=T.read_shift(2),I.e.r=T.read_shift(2),z==12&&k.qpro&&(T.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function f(T){var z=Pe(8);return z.write_shift(2,T.s.c),z.write_shift(2,T.s.r),z.write_shift(2,T.e.c),z.write_shift(2,T.e.r),z}function p(T,z,k){var I=[{c:0,r:0},{t:"n",v:0},0,0];return k.qpro&&k.vers!=20768?(I[0].c=T.read_shift(1),I[3]=T.read_shift(1),I[0].r=T.read_shift(2),T.l+=2):(I[2]=T.read_shift(1),I[0].c=T.read_shift(2),I[0].r=T.read_shift(2)),I}function x(T,z,k){var I=T.l+z,D=p(T,z,k);if(D[1].t="s",k.vers==20768){T.l++;var de=T.read_shift(1);return D[1].v=T.read_shift(de,"utf8"),D}return k.qpro&&T.l++,D[1].v=T.read_shift(I-T.l,"cstr"),D}function j(T,z,k){var I=Pe(7+k.length);I.write_shift(1,255),I.write_shift(2,z),I.write_shift(2,T),I.write_shift(1,39);for(var D=0;D<I.length;++D){var de=k.charCodeAt(D);I.write_shift(1,de>=128?95:de)}return I.write_shift(1,0),I}function y(T,z,k){var I=p(T,z,k);return I[1].v=T.read_shift(2,"i"),I}function S(T,z,k){var I=Pe(7);return I.write_shift(1,255),I.write_shift(2,z),I.write_shift(2,T),I.write_shift(2,k,"i"),I}function w(T,z,k){var I=p(T,z,k);return I[1].v=T.read_shift(8,"f"),I}function b(T,z,k){var I=Pe(13);return I.write_shift(1,255),I.write_shift(2,z),I.write_shift(2,T),I.write_shift(8,k,"f"),I}function _(T,z,k){var I=T.l+z,D=p(T,z,k);if(D[1].v=T.read_shift(8,"f"),k.qpro)T.l=I;else{var de=T.read_shift(2);O(T.slice(T.l,T.l+de),D),T.l+=de}return D}function E(T,z,k){var I=z&32768;return z&=-32769,z=(I?T:0)+(z>=8192?z-16384:z),(I?"":"$")+(k?fn(z):sn(z))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(T,z){Hn(T,0);for(var k=[],I=0,D="",de="",he="",ie="";T.l<T.length;){var ve=T[T.l++];switch(ve){case 0:k.push(T.read_shift(8,"f"));break;case 1:de=E(z[0].c,T.read_shift(2),!0),D=E(z[0].r,T.read_shift(2),!1),k.push(de+D);break;case 2:{var je=E(z[0].c,T.read_shift(2),!0),fe=E(z[0].r,T.read_shift(2),!1);de=E(z[0].c,T.read_shift(2),!0),D=E(z[0].r,T.read_shift(2),!1),k.push(je+fe+":"+de+D)}break;case 3:if(T.l<T.length){console.error("WK1 premature formula end");return}break;case 4:k.push("("+k.pop()+")");break;case 5:k.push(T.read_shift(2));break;case 6:{for(var _e="";ve=T[T.l++];)_e+=String.fromCharCode(ve);k.push('"'+_e.replace(/"/g,'""')+'"')}break;case 8:k.push("-"+k.pop());break;case 23:k.push("+"+k.pop());break;case 22:k.push("NOT("+k.pop()+")");break;case 20:case 21:ie=k.pop(),he=k.pop(),k.push(["AND","OR"][ve-20]+"("+he+","+ie+")");break;default:if(ve<32&&N[ve])ie=k.pop(),he=k.pop(),k.push(he+N[ve]+ie);else if(C[ve]){if(I=C[ve][1],I==69&&(I=T[T.l++]),I>k.length){console.error("WK1 bad formula parse 0x"+ve.toString(16)+":|"+k.join("|")+"|");return}var Se=k.slice(-I);k.length-=I,k.push(C[ve][0]+"("+Se.join(",")+")")}else return ve<=7?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=24?console.error("WK1 unsupported op "+ve.toString(16)):ve<=30?console.error("WK1 invalid opcode "+ve.toString(16)):ve<=115?console.error("WK1 unsupported function opcode "+ve.toString(16)):console.error("WK1 unrecognized opcode "+ve.toString(16))}}k.length==1?z[1].f=""+k[0]:console.error("WK1 bad formula parse |"+k.join("|")+"|")}function Q(T){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=T.read_shift(2),z[3]=T[T.l++],z[0].c=T[T.l++],z}function G(T,z){var k=Q(T);return k[1].t="s",k[1].v=T.read_shift(z-4,"cstr"),k}function M(T,z,k,I){var D=Pe(6+I.length);D.write_shift(2,T),D.write_shift(1,k),D.write_shift(1,z),D.write_shift(1,39);for(var de=0;de<I.length;++de){var he=I.charCodeAt(de);D.write_shift(1,he>=128?95:he)}return D.write_shift(1,0),D}function U(T,z){var k=Q(T);k[1].v=T.read_shift(2);var I=k[1].v>>1;if(k[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return k[1].v=I,k}function A(T,z){var k=Q(T),I=T.read_shift(4),D=T.read_shift(4),de=T.read_shift(2);if(de==65535)return I===0&&D===3221225472?(k[1].t="e",k[1].v=15):I===0&&D===3489660928?(k[1].t="e",k[1].v=42):k[1].v=0,k;var he=de&32768;return de=(de&32767)-16446,k[1].v=(1-he*2)*(D*Math.pow(2,de+32)+I*Math.pow(2,de)),k}function R(T,z,k,I){var D=Pe(14);if(D.write_shift(2,T),D.write_shift(1,k),D.write_shift(1,z),I==0)return D.write_shift(4,0),D.write_shift(4,0),D.write_shift(2,65535),D;var de=0,he=0,ie=0,ve=0;return I<0&&(de=1,I=-I),he=Math.log2(I)|0,I/=Math.pow(2,he-31),ve=I>>>0,(ve&2147483648)==0&&(I/=2,++he,ve=I>>>0),I-=ve,ve|=2147483648,ve>>>=0,I*=Math.pow(2,32),ie=I>>>0,D.write_shift(4,ie),D.write_shift(4,ve),he+=16383+(de?32768:0),D.write_shift(2,he),D}function Z(T,z){var k=A(T);return T.l+=z-14,k}function F(T,z){var k=Q(T),I=T.read_shift(4);return k[1].v=I>>6,k}function q(T,z){var k=Q(T),I=T.read_shift(8,"f");return k[1].v=I,k}function ee(T,z){var k=q(T);return T.l+=z-10,k}function me(T,z){return T[T.l+z-1]==0?T.read_shift(z,"cstr"):""}function W(T,z){var k=T[T.l++];k>z-1&&(k=z-1);for(var I="";I.length<k;)I+=String.fromCharCode(T[T.l++]);return I}function J(T,z,k){if(!(!k.qpro||z<21)){var I=T.read_shift(1);T.l+=17,T.l+=1,T.l+=2;var D=T.read_shift(z-21,"cstr");return[I,D]}}function L(T,z){for(var k={},I=T.l+z;T.l<I;){var D=T.read_shift(2);if(D==14e3){for(k[D]=[0,""],k[D][0]=T.read_shift(2);T[T.l];)k[D][1]+=String.fromCharCode(T[T.l]),T.l++;T.l++}}return k}function H(T,z){var k=Pe(5+T.length);k.write_shift(2,14e3),k.write_shift(2,z);for(var I=0;I<T.length;++I){var D=T.charCodeAt(I);k[k.l++]=D>127?95:D}return k[k.l++]=0,k}var ne={0:{n:"BOF",f:Cj},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},P={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:G},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:L},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:o,to_workbook:r}})(),Vz=/^\s|\s$|[\t\n\r]/;function Rj(t,r){if(!r.bookSST)return"";var a=[Ma];a[a.length]=Je("sst",null,{xmlns:Tl[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var o=t[s],d="<si>";o.r?d+=o.r:(d+="<t",o.t||(o.t=""),o.t.match(Vz)&&(d+=' xml:space="preserve"'),d+=">"+Qt(o.t)+"</t>"),d+="</si>",a[a.length]=d}return a.length>2&&(a[a.length]="</sst>",a[1]=a[1].replace("/>",">")),a.join("")}function Zz(t){return[t.read_shift(4),t.read_shift(4)]}function Gz(t,r){return r||(r=Pe(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var Kz=Mk;function qz(t){var r=Nn();Ke(r,159,Gz(t));for(var a=0;a<t.length;++a)Ke(r,19,Kz(t[a]));return Ke(r,160),r.end()}function Yz(t){for(var r=[],a=t.split(""),s=0;s<a.length;++s)r[s]=a[s].charCodeAt(0);return r}function Bj(t){var r=0,a,s=Yz(t),o=s.length+1,d,u,h,f,p;for(a=js(o),a[0]=s.length,d=1;d!=o;++d)a[d]=s[d-1];for(d=o-1;d>=0;--d)u=a[d],h=(r&16384)===0?0:1,f=r<<1&32767,p=h|f,r=p^u;return r^52811}var Jz=(function(){function t(o,d){switch(d.type){case"base64":return r(oi(o),d);case"binary":return r(o,d);case"buffer":return r(Vt&&Buffer.isBuffer(o)?o.toString("binary"):hc(o),d);case"array":return r(Wu(o),d)}throw new Error("Unrecognized type "+d.type)}function r(o,d){var u=d||{},h=u.dense?[]:{},f=o.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(x,j){Array.isArray(h)&&(h[j]=[]);for(var y=/\\\w+\b/g,S=0,w,b=-1;w=y.exec(x);){switch(w[0]){case"\\cell":var _=x.slice(S,y.lastIndex-w[0].length);if(_[0]==" "&&(_=_.slice(1)),++b,_.length){var E={v:_,t:"s"};Array.isArray(h)?h[j][b]=E:h[ea({r:j,c:b})]=E}break}S=y.lastIndex}b>p.e.c&&(p.e.c=b)}),h["!ref"]=La(p),h}function a(o,d){return Ss(t(o,d),d)}function s(o){for(var d=["{\\rtf1\\ansi"],u=pa(o["!ref"]),h,f=Array.isArray(o),p=u.s.r;p<=u.e.r;++p){d.push("\\trowd\\trautofit1");for(var x=u.s.c;x<=u.e.c;++x)d.push("\\cellx"+(x+1));for(d.push("\\pard\\intbl"),x=u.s.c;x<=u.e.c;++x){var j=ea({r:p,c:x});h=f?(o[p]||[])[x]:o[j],!(!h||h.v==null&&(!h.f||h.F))&&(d.push(" "+(h.w||(ci(h),h.w))),d.push("\\cell"))}d.push("\\pard\\intbl\\row")}return d.join("")+"}"}return{to_workbook:a,to_sheet:t,from_sheet:s}})();function dv(t){for(var r=0,a=1;r!=3;++r)a=a*256+(t[r]>255?255:t[r]<0?0:t[r]);return a.toString(16).toUpperCase().slice(1)}var Xz=6,si=Xz;function zu(t){return Math.floor((t+Math.round(128/si)/256)*si)}function Cu(t){return Math.floor((t-5)/si*100+.5)/100}function Ym(t){return Math.round((t*si+5)/si*256)/256}function wp(t){t.width?(t.wpx=zu(t.width),t.wch=Cu(t.wpx),t.MDW=si):t.wpx?(t.wch=Cu(t.wpx),t.width=Ym(t.wch),t.MDW=si):typeof t.wch=="number"&&(t.width=Ym(t.wch),t.wpx=zu(t.width),t.MDW=si),t.customWidth&&delete t.customWidth}var Qz=96,Oj=Qz;function Tu(t){return t*96/Oj}function Dj(t){return t*Oj/96}function eC(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&(r[r.length]=Je("numFmt",null,{numFmtId:s,formatCode:Qt(t[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Je("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function tC(t){var r=[];return r[r.length]=Je("cellXfs",null),t.forEach(function(a){r[r.length]=Je("xf",null,a)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Je("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function Lj(t,r){var a=[Ma,Je("styleSheet",null,{xmlns:Tl[0],"xmlns:vt":Za.vt})],s;return t.SSF&&(s=eC(t.SSF))!=null&&(a[a.length]=s),a[a.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',a[a.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',a[a.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',a[a.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=tC(r.cellXfs))&&(a[a.length]=s),a[a.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',a[a.length]='<dxfs count="0"/>',a[a.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',a.length>2&&(a[a.length]="</styleSheet>",a[1]=a[1].replace("/>",">")),a.join("")}function aC(t,r){var a=t.read_shift(2),s=hn(t);return[a,s]}function nC(t,r,a){a||(a=Pe(6+4*r.length)),a.write_shift(2,t),Ka(r,a);var s=a.length>a.l?a.slice(0,a.l):a;return a.l==null&&(a.l=a.length),s}function rC(t,r,a){var s={};s.sz=t.read_shift(2)/20;var o=Vk(t);o.fItalic&&(s.italic=1),o.fCondense&&(s.condense=1),o.fExtend&&(s.extend=1),o.fShadow&&(s.shadow=1),o.fOutline&&(s.outline=1),o.fStrikeout&&(s.strike=1);var d=t.read_shift(2);switch(d===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var u=t.read_shift(1);u!=0&&(s.underline=u);var h=t.read_shift(1);h>0&&(s.family=h);var f=t.read_shift(1);switch(f>0&&(s.charset=f),t.l++,s.color=Hk(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=hn(t),s}function iC(t,r){r||(r=Pe(153)),r.write_shift(2,t.sz*20),Zk(t,r),r.write_shift(2,t.bold?700:400);var a=0;t.vertAlign=="superscript"?a=1:t.vertAlign=="subscript"&&(a=2),r.write_shift(2,a),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),wu(t.color,r);var s=0;return s=2,r.write_shift(1,s),Ka(t.name,r),r.length>r.l?r.slice(0,r.l):r}var sC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],lm,lC=Lr;function uv(t,r){r||(r=Pe(84)),lm||(lm=fp(sC));var a=lm[t.patternType];a==null&&(a=40),r.write_shift(4,a);var s=0;if(a!=40)for(wu({auto:1},r),wu({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function oC(t,r){var a=t.l+r,s=t.read_shift(2),o=t.read_shift(2);return t.l=a,{ixfe:s,numFmtId:o}}function Mj(t,r,a){a||(a=Pe(16)),a.write_shift(2,r||0),a.write_shift(2,t.numFmtId||0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(1,0),a.write_shift(1,0);var s=0;return a.write_shift(1,s),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(1,0),a}function Eo(t,r){return r||(r=Pe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var cC=Lr;function dC(t,r){return r||(r=Pe(51)),r.write_shift(1,0),Eo(null,r),Eo(null,r),Eo(null,r),Eo(null,r),Eo(null,r),r.length>r.l?r.slice(0,r.l):r}function uC(t,r){return r||(r=Pe(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),Su(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function fC(t,r,a){var s=Pe(2052);return s.write_shift(4,t),Su(r,s),Su(a,s),s.length>s.l?s.slice(0,s.l):s}function hC(t,r){if(r){var a=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)r[o]!=null&&++a}),a!=0&&(Ke(t,615,zr(a)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)r[o]!=null&&Ke(t,44,nC(o,r[o]))}),Ke(t,616))}}function mC(t){var r=1;Ke(t,611,zr(r)),Ke(t,43,iC({sz:12,color:{theme:1},name:"Calibri",family:2})),Ke(t,612)}function pC(t){var r=2;Ke(t,603,zr(r)),Ke(t,45,uv({patternType:"none"})),Ke(t,45,uv({patternType:"gray125"})),Ke(t,604)}function gC(t){var r=1;Ke(t,613,zr(r)),Ke(t,46,dC()),Ke(t,614)}function xC(t){var r=1;Ke(t,626,zr(r)),Ke(t,47,Mj({numFmtId:0},65535)),Ke(t,627)}function yC(t,r){Ke(t,617,zr(r.length)),r.forEach(function(a){Ke(t,47,Mj(a,0))}),Ke(t,618)}function vC(t){var r=1;Ke(t,619,zr(r)),Ke(t,48,uC({xfId:0,name:"Normal"})),Ke(t,620)}function jC(t){var r=0;Ke(t,505,zr(r)),Ke(t,506)}function bC(t){var r=0;Ke(t,508,fC(r,"TableStyleMedium9","PivotStyleMedium4")),Ke(t,509)}function _C(t,r){var a=Nn();return Ke(a,278),hC(a,t.SSF),mC(a),pC(a),gC(a),xC(a),yC(a,r.cellXfs),vC(a),jC(a),bC(a),Ke(a,279),a.end()}function Ij(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var a=[Ma];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function SC(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:hn(t)}}function wC(t){var r=Pe(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Ka(t.name,r),r.slice(0,r.l)}function kC(t){for(var r=[],a=t.read_shift(4);a-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function zC(t){var r=Pe(4+8*t.length);r.write_shift(4,t.length);for(var a=0;a<t.length;++a)r.write_shift(4,t[a][0]),r.write_shift(4,t[a][1]);return r}function CC(t,r){var a=Pe(8+2*r.length);return a.write_shift(4,t),Ka(r,a),a.slice(0,a.l)}function TC(t){return t.l+=4,t.read_shift(4)!=0}function NC(t,r){var a=Pe(8);return a.write_shift(4,t),a.write_shift(4,1),a}function AC(){var t=Nn();return Ke(t,332),Ke(t,334,zr(1)),Ke(t,335,wC({name:"XLDAPR",version:12e4,flags:3496657072})),Ke(t,336),Ke(t,339,CC(1,"XLDAPR")),Ke(t,52),Ke(t,35,zr(514)),Ke(t,4096,zr(0)),Ke(t,4097,lr(1)),Ke(t,36),Ke(t,53),Ke(t,340),Ke(t,337,NC(1)),Ke(t,51,zC([[1,0]])),Ke(t,338),Ke(t,333),t.end()}function Pj(){var t=[Ma];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function EC(t){var r={};r.i=t.read_shift(4);var a={};a.r=t.read_shift(4),a.c=t.read_shift(4),r.r=ea(a);var s=t.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var xl=1024;function Wj(t,r){for(var a=[21600,21600],s=["m0,0l0",a[1],a[0],a[1],a[0],"0xe"].join(","),o=[Je("xml",null,{"xmlns:v":Vn.v,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:mv":Vn.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:a.join(","),path:s})];xl<t*1e3;)xl+=1e3;return r.forEach(function(d){var u=Ga(d[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var f=h.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=Je("v:fill",f,h),x={on:"t",obscured:"t"};++xl,o=o.concat(["<v:shape"+rc({id:"_x0000_s"+xl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(d[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,Je("v:shadow",null,x),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rn("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),rn("x:AutoFill","False"),rn("x:Row",String(u.r)),rn("x:Column",String(u.c)),d[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function Uj(t){var r=[Ma,Je("comments",null,{xmlns:Tl[0]})],a=[];return r.push("<authors>"),t.forEach(function(s){s[1].forEach(function(o){var d=Qt(o.a);a.indexOf(d)==-1&&(a.push(d),r.push("<author>"+d+"</author>")),o.T&&o.ID&&a.indexOf("tc="+o.ID)==-1&&(a.push("tc="+o.ID),r.push("<author>tc="+o.ID+"</author>"))})}),a.length==0&&(a.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(s){var o=0,d=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?o=a.indexOf("tc="+s[1][0].ID):s[1].forEach(function(f){f.a&&(o=a.indexOf(Qt(f.a))),d.push(f.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+o+'"><text>'),d.length<=1)r.push(rn("t",Qt(d[0]||"")));else{for(var u=`Comment:
    `+d[0]+`
`,h=1;h<d.length;++h)u+=`Reply:
    `+d[h]+`
`;r.push(rn("t",Qt(u)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function FC(t,r,a){var s=[Ma,Je("ThreadedComments",null,{xmlns:Za.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(o){var d="";(o[1]||[]).forEach(function(u,h){if(!u.T){delete u.ID;return}u.a&&r.indexOf(u.a)==-1&&r.push(u.a);var f={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+a.tcid++).slice(-12)+"}"};h==0?d=f.id:f.parentId=d,u.ID=f.id,u.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(u.a)).slice(-12)+"}"),s.push(Je("threadedComment",rn("text",u.t||""),f))})}),s.push("</ThreadedComments>"),s.join("")}function RC(t){var r=[Ma,Je("personList",null,{xmlns:Za.TCMNT,"xmlns:x":Tl[0]}).replace(/[\/]>/,">")];return t.forEach(function(a,s){r.push(Je("person",null,{displayName:a,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:a,providerId:"None"}))}),r.push("</personList>"),r.join("")}function BC(t){var r={};r.iauthor=t.read_shift(4);var a=Cs(t);return r.rfx=a.s,r.ref=ea(a.s),t.l+=16,r}function OC(t,r){return r==null&&(r=Pe(36)),r.write_shift(4,t[1].iauthor),Al(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var DC=hn;function LC(t){return Ka(t.slice(0,54))}function MC(t){var r=Nn(),a=[];return Ke(r,628),Ke(r,630),t.forEach(function(s){s[1].forEach(function(o){a.indexOf(o.a)>-1||(a.push(o.a.slice(0,54)),Ke(r,632,LC(o.a)))})}),Ke(r,631),Ke(r,633),t.forEach(function(s){s[1].forEach(function(o){o.iauthor=a.indexOf(o.a);var d={s:Ga(s[0]),e:Ga(s[0])};Ke(r,635,OC([d,o])),o.t&&o.t.length>0&&Ke(r,637,Pk(o)),Ke(r,636),delete o.iauthor})}),Ke(r,634),Ke(r,629),r.end()}function IC(t,r){r.FullPaths.forEach(function(a,s){if(s!=0){var o=a.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&ia.utils.cfb_add(t,o,r.FileIndex[s].content)}})}var $j=["xlsb","xlsm","xlam","biff8","xla"],PC=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function a(s,o,d,u){var h=!1,f=!1;d.length==0?f=!0:d.charAt(0)=="["&&(f=!0,d=d.slice(1,-1)),u.length==0?h=!0:u.charAt(0)=="["&&(h=!0,u=u.slice(1,-1));var p=d.length>0?parseInt(d,10)|0:0,x=u.length>0?parseInt(u,10)|0:0;return h?x+=r.c:--x,f?p+=r.r:--p,o+(h?"":"$")+fn(x)+(f?"":"$")+sn(p)}return function(o,d){return r=d,o.replace(t,a)}})(),kp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zp=(function(){return function(r,a){return r.replace(kp,function(s,o,d,u,h,f){var p=vp(u)-(d?0:a.c),x=yp(f)-(h?0:a.r),j=x==0?"":h?x+1:"["+x+"]",y=p==0?"":d?p+1:"["+p+"]";return o+"R"+j+"C"+y})}})();function WC(t,r){return t.replace(kp,function(a,s,o,d,u,h){return s+(o=="$"?o+d:fn(vp(d)+r.c))+(u=="$"?u+h:sn(yp(h)+r.r))})}function UC(t){return t.length!=1}function Da(t){t.l+=1}function Gi(t,r){var a=t.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function Hj(t,r,a){var s=2;if(a){if(a.biff>=2&&a.biff<=5)return Vj(t);a.biff==12&&(s=4)}var o=t.read_shift(s),d=t.read_shift(s),u=Gi(t),h=Gi(t);return{s:{r:o,c:u[0],cRel:u[1],rRel:u[2]},e:{r:d,c:h[0],cRel:h[1],rRel:h[2]}}}function Vj(t){var r=Gi(t),a=Gi(t),s=t.read_shift(1),o=t.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:a[0],c:o,cRel:a[1],rRel:a[2]}}}function $C(t,r,a){if(a.biff<8)return Vj(t);var s=t.read_shift(a.biff==12?4:2),o=t.read_shift(a.biff==12?4:2),d=Gi(t),u=Gi(t);return{s:{r:s,c:d[0],cRel:d[1],rRel:d[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function Zj(t,r,a){if(a&&a.biff>=2&&a.biff<=5)return HC(t);var s=t.read_shift(a&&a.biff==12?4:2),o=Gi(t);return{r:s,c:o[0],cRel:o[1],rRel:o[2]}}function HC(t){var r=Gi(t),a=t.read_shift(1);return{r:r[0],c:a,cRel:r[1],rRel:r[2]}}function VC(t){var r=t.read_shift(2),a=t.read_shift(2);return{r,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function ZC(t,r,a){var s=a&&a.biff?a.biff:8;if(s>=2&&s<=5)return GC(t);var o=t.read_shift(s>=12?4:2),d=t.read_shift(2),u=(d&16384)>>14,h=(d&32768)>>15;if(d&=16383,h==1)for(;o>524287;)o-=1048576;if(u==1)for(;d>8191;)d=d-16384;return{r:o,c:d,cRel:u,rRel:h}}function GC(t){var r=t.read_shift(2),a=t.read_shift(1),s=(r&32768)>>15,o=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),o==1&&a>=128&&(a=a-256),{r,c:a,cRel:o,rRel:s}}function KC(t,r,a){var s=(t[t.l++]&96)>>5,o=Hj(t,a.biff>=2&&a.biff<=5?6:8,a);return[s,o]}function qC(t,r,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2,"i"),d=8;if(a)switch(a.biff){case 5:t.l+=12,d=6;break;case 12:d=12;break}var u=Hj(t,d,a);return[s,o,u]}function YC(t,r,a){var s=(t[t.l++]&96)>>5;return t.l+=a&&a.biff>8?12:a.biff<8?6:8,[s]}function JC(t,r,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2),d=8;if(a)switch(a.biff){case 5:t.l+=12,d=6;break;case 12:d=12;break}return t.l+=d,[s,o]}function XC(t,r,a){var s=(t[t.l++]&96)>>5,o=$C(t,r-1,a);return[s,o]}function QC(t,r,a){var s=(t[t.l++]&96)>>5;return t.l+=a.biff==2?6:a.biff==12?14:7,[s]}function fv(t){var r=t[t.l+1]&1,a=1;return t.l+=4,[r,a]}function eT(t,r,a){t.l+=2;for(var s=t.read_shift(a&&a.biff==2?1:2),o=[],d=0;d<=s;++d)o.push(t.read_shift(a&&a.biff==2?1:2));return o}function tT(t,r,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function aT(t,r,a){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(a&&a.biff==2?1:2)]}function nT(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function rT(t,r,a){var s=t[t.l+1]&255?1:0;return t.l+=a&&a.biff==2?3:4,[s]}function Gj(t){var r=t.read_shift(1),a=t.read_shift(1);return[r,a]}function iT(t){return t.read_shift(2),Gj(t)}function sT(t){return t.read_shift(2),Gj(t)}function lT(t,r,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=Zj(t,0,a);return[s,o]}function oT(t,r,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=ZC(t,0,a);return[s,o]}function cT(t,r,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=t.read_shift(2);a&&a.biff==5&&(t.l+=12);var d=Zj(t,0,a);return[s,o,d]}function dT(t,r,a){var s=(t[t.l]&96)>>5;t.l+=1;var o=t.read_shift(a&&a.biff<=3?1:2);return[d4[o],Yj[o],s]}function uT(t,r,a){var s=t[t.l++],o=t.read_shift(1),d=a&&a.biff<=3?[s==88?-1:0,t.read_shift(1)]:fT(t);return[o,(d[0]===0?Yj:c4)[d[1]]]}function fT(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function hT(t,r,a){t.l+=a&&a.biff==2?3:4}function mT(t,r,a){if(t.l++,a&&a.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function pT(t){return t.l++,gc[t.read_shift(1)]}function gT(t){return t.l++,t.read_shift(2)}function xT(t){return t.l++,t.read_shift(1)!==0}function yT(t){return t.l++,El(t)}function vT(t,r,a){return t.l++,Nj(t,r-1,a)}function jT(t,r){var a=[t.read_shift(1)];if(r==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=cz(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:a[1]=gc[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:a[1]=El(t);break;case 2:a[1]=hz(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function bT(t,r,a){for(var s=t.read_shift(a.biff==12?4:2),o=[],d=0;d!=s;++d)o.push((a.biff==12?Cs:gz)(t));return o}function _T(t,r,a){var s=0,o=0;a.biff==12?(s=t.read_shift(4),o=t.read_shift(4)):(o=1+t.read_shift(1),s=1+t.read_shift(2)),a.biff>=2&&a.biff<8&&(--s,--o==0&&(o=256));for(var d=0,u=[];d!=s&&(u[d]=[]);++d)for(var h=0;h!=o;++h)u[d][h]=jT(t,a.biff);return u}function ST(t,r,a){var s=t.read_shift(1)>>>5&3,o=!a||a.biff>=8?4:2,d=t.read_shift(o);switch(a.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,d]}function wT(t,r,a){if(a.biff==5)return kT(t);var s=t.read_shift(1)>>>5&3,o=t.read_shift(2),d=t.read_shift(4);return[s,o,d]}function kT(t){var r=t.read_shift(1)>>>5&3,a=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[r,a,s]}function zT(t,r,a){var s=t.read_shift(1)>>>5&3;t.l+=a&&a.biff==2?3:4;var o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function CT(t,r,a){var s=t.read_shift(1)>>>5&3,o=t.read_shift(a&&a.biff==2?1:2);return[s,o]}function TT(t,r,a){var s=t.read_shift(1)>>>5&3;return t.l+=4,a.biff<8&&t.l--,a.biff==12&&(t.l+=2),[s]}function NT(t,r,a){var s=(t[t.l++]&96)>>5,o=t.read_shift(2),d=4;if(a)switch(a.biff){case 5:d=15;break;case 12:d=6;break}return t.l+=d,[s,o]}var AT=Lr,ET=Lr,FT=Lr;function xc(t,r,a){return t.l+=2,[VC(t)]}function Cp(t){return t.l+=6,[]}var RT=xc,BT=Cp,OT=Cp,DT=xc;function Kj(t){return t.l+=2,[Cj(t),t.read_shift(2)&1]}var LT=xc,MT=Kj,IT=Cp,PT=xc,WT=xc,UT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $T(t){t.l+=2;var r=t.read_shift(2),a=t.read_shift(2),s=t.read_shift(4),o=t.read_shift(2),d=t.read_shift(2),u=UT[a>>2&31];return{ixti:r,coltype:a&3,rt:u,idx:s,c:o,C:d}}function HT(t){return t.l+=2,[t.read_shift(4)]}function VT(t,r,a){return t.l+=5,t.l+=2,t.l+=a.biff==2?1:4,["PTGSHEET"]}function ZT(t,r,a){return t.l+=a.biff==2?4:5,["PTGENDSHEET"]}function GT(t){var r=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[r,a]}function KT(t){var r=t.read_shift(1)>>>5&3,a=t.read_shift(2);return[r,a]}function qT(t){return t.l+=4,[0,0]}var hv={1:{n:"PtgExp",f:mT},2:{n:"PtgTbl",f:FT},3:{n:"PtgAdd",f:Da},4:{n:"PtgSub",f:Da},5:{n:"PtgMul",f:Da},6:{n:"PtgDiv",f:Da},7:{n:"PtgPower",f:Da},8:{n:"PtgConcat",f:Da},9:{n:"PtgLt",f:Da},10:{n:"PtgLe",f:Da},11:{n:"PtgEq",f:Da},12:{n:"PtgGe",f:Da},13:{n:"PtgGt",f:Da},14:{n:"PtgNe",f:Da},15:{n:"PtgIsect",f:Da},16:{n:"PtgUnion",f:Da},17:{n:"PtgRange",f:Da},18:{n:"PtgUplus",f:Da},19:{n:"PtgUminus",f:Da},20:{n:"PtgPercent",f:Da},21:{n:"PtgParen",f:Da},22:{n:"PtgMissArg",f:Da},23:{n:"PtgStr",f:vT},26:{n:"PtgSheet",f:VT},27:{n:"PtgEndSheet",f:ZT},28:{n:"PtgErr",f:pT},29:{n:"PtgBool",f:xT},30:{n:"PtgInt",f:gT},31:{n:"PtgNum",f:yT},32:{n:"PtgArray",f:QC},33:{n:"PtgFunc",f:dT},34:{n:"PtgFuncVar",f:uT},35:{n:"PtgName",f:ST},36:{n:"PtgRef",f:lT},37:{n:"PtgArea",f:KC},38:{n:"PtgMemArea",f:zT},39:{n:"PtgMemErr",f:AT},40:{n:"PtgMemNoMem",f:ET},41:{n:"PtgMemFunc",f:CT},42:{n:"PtgRefErr",f:TT},43:{n:"PtgAreaErr",f:YC},44:{n:"PtgRefN",f:oT},45:{n:"PtgAreaN",f:XC},46:{n:"PtgMemAreaN",f:GT},47:{n:"PtgMemNoMemN",f:KT},57:{n:"PtgNameX",f:wT},58:{n:"PtgRef3d",f:cT},59:{n:"PtgArea3d",f:qC},60:{n:"PtgRefErr3d",f:NT},61:{n:"PtgAreaErr3d",f:JC},255:{}},YT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JT={1:{n:"PtgElfLel",f:Kj},2:{n:"PtgElfRw",f:PT},3:{n:"PtgElfCol",f:RT},6:{n:"PtgElfRwV",f:WT},7:{n:"PtgElfColV",f:DT},10:{n:"PtgElfRadical",f:LT},11:{n:"PtgElfRadicalS",f:IT},13:{n:"PtgElfColS",f:BT},15:{n:"PtgElfColSV",f:OT},16:{n:"PtgElfRadicalLel",f:MT},25:{n:"PtgList",f:$T},29:{n:"PtgSxName",f:HT},255:{}},XT={0:{n:"PtgAttrNoop",f:qT},1:{n:"PtgAttrSemi",f:rT},2:{n:"PtgAttrIf",f:aT},4:{n:"PtgAttrChoose",f:eT},8:{n:"PtgAttrGoto",f:tT},16:{n:"PtgAttrSum",f:hT},32:{n:"PtgAttrBaxcel",f:fv},33:{n:"PtgAttrBaxcel",f:fv},64:{n:"PtgAttrSpace",f:iT},65:{n:"PtgAttrSpaceSemi",f:sT},128:{n:"PtgAttrIfError",f:nT},255:{}};function QT(t,r,a,s){if(s.biff<8)return Lr(t,r);for(var o=t.l+r,d=[],u=0;u!==a.length;++u)switch(a[u][0]){case"PtgArray":a[u][1]=_T(t,0,s),d.push(a[u][1]);break;case"PtgMemArea":a[u][2]=bT(t,a[u][1],s),d.push(a[u][2]);break;case"PtgExp":s&&s.biff==12&&(a[u][1][1]=t.read_shift(4),d.push(a[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[u][0]}return r=o-t.l,r!==0&&d.push(Lr(t,r)),d}function e4(t,r,a){for(var s=t.l+r,o,d,u=[];s!=t.l;)r=s-t.l,d=t[t.l],o=hv[d]||hv[YT[d]],(d===24||d===25)&&(o=(d===24?JT:XT)[t[t.l+1]]),!o||!o.f?Lr(t,r):u.push([o.n,o.f(t,r,a)]);return u}function t4(t){for(var r=[],a=0;a<t.length;++a){for(var s=t[a],o=[],d=0;d<s.length;++d){var u=s[d];u?u[0]===2?o.push('"'+u[1].replace(/"/g,'""')+'"'):o.push(u[1]):o.push("")}r.push(o.join(","))}return r.join(";")}var a4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function n4(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function qj(t,r,a){if(!t)return"SH33TJSERR0";if(a.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[r];if(a.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!s)return"SH33TJSERR1";var o="";if(a.biff>8)switch(t[s[0]][0]){case 357:return o=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?o:o+":"+t.SheetNames[s[2]];case 358:return a.SID!=null?t.SheetNames[a.SID]:"SH33TJSSAME"+t[s[0]][0];default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return o=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?o:o+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(d){return d.Name}).join(";;");default:return t[s[0]][0][3]?(o=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?o:o+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function mv(t,r,a){var s=qj(t,r,a);return s=="#REF"?s:n4(s,a)}function Sl(t,r,a,s,o){var d=o&&o.biff||8,u={s:{c:0,r:0}},h=[],f,p,x,j=0,y=0,S,w="";if(!t[0]||!t[0][0])return"";for(var b=-1,_="",E=0,C=t[0].length;E<C;++E){var N=t[0][E];switch(N[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=h.pop(),p=h.pop(),b>=0){switch(t[0][b][1][0]){case 0:_=wa(" ",t[0][b][1][1]);break;case 1:_=wa("\r",t[0][b][1][1]);break;default:if(_="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}p=p+_,b=-1}h.push(p+a4[N[0]]+f);break;case"PtgIsect":f=h.pop(),p=h.pop(),h.push(p+" "+f);break;case"PtgUnion":f=h.pop(),p=h.pop(),h.push(p+","+f);break;case"PtgRange":f=h.pop(),p=h.pop(),h.push(p+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Go(N[1][1],u,o),h.push(Ko(x,d));break;case"PtgRefN":x=a?Go(N[1][1],a,o):N[1][1],h.push(Ko(x,d));break;case"PtgRef3d":j=N[1][1],x=Go(N[1][2],u,o),w=mv(s,j,o),h.push(w+"!"+Ko(x,d));break;case"PtgFunc":case"PtgFuncVar":var O=N[1][0],Q=N[1][1];O||(O=0),O&=127;var G=O==0?[]:h.slice(-O);h.length-=O,Q==="User"&&(Q=G.shift()),h.push(Q+"("+G.join(",")+")");break;case"PtgBool":h.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(N[1]);break;case"PtgNum":h.push(String(N[1]));break;case"PtgStr":h.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(N[1]);break;case"PtgAreaN":S=Xy(N[1][1],a?{s:a}:u,o),h.push(im(S,o));break;case"PtgArea":S=Xy(N[1][1],u,o),h.push(im(S,o));break;case"PtgArea3d":j=N[1][1],S=N[1][2],w=mv(s,j,o),h.push(w+"!"+im(S,o));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var M=(s.names||[])[y-1]||(s[0]||[])[y],U=M?M.Name:"SH33TJSNAME"+String(y);U&&U.slice(0,6)=="_xlfn."&&!o.xlfn&&(U=U.slice(6)),h.push(U);break;case"PtgNameX":var A=N[1][1];y=N[1][2];var R;if(o.biff<=5)A<0&&(A=-A),s[A]&&(R=s[A][y]);else{var Z="";if(((s[A]||[])[0]||[])[0]==14849||(((s[A]||[])[0]||[])[0]==1025?s[A][y]&&s[A][y].itab>0&&(Z=s.SheetNames[s[A][y].itab-1]+"!"):Z=s.SheetNames[y-1]+"!"),s[A]&&s[A][y])Z+=s[A][y].Name;else if(s[0]&&s[0][y])Z+=s[0][y].Name;else{var F=(qj(s,A,o)||"").split(";;");F[y-1]?Z=F[y-1]:Z+="SH33TJSERRX"}h.push(Z);break}R||(R={Name:"SH33TJSERRY"}),h.push(R.Name);break;case"PtgParen":var q="(",ee=")";if(b>=0){switch(_="",t[0][b][1][0]){case 2:q=wa(" ",t[0][b][1][1])+q;break;case 3:q=wa("\r",t[0][b][1][1])+q;break;case 4:ee=wa(" ",t[0][b][1][1])+ee;break;case 5:ee=wa("\r",t[0][b][1][1])+ee;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}h.push(q+h.pop()+ee);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":x={c:N[1][1],r:N[1][0]};var me={c:a.c,r:a.r};if(s.sharedf[ea(x)]){var W=s.sharedf[ea(x)];h.push(Sl(W,u,me,s,o))}else{var J=!1;for(f=0;f!=s.arrayf.length;++f)if(p=s.arrayf[f],!(x.c<p[0].s.c||x.c>p[0].e.c)&&!(x.r<p[0].s.r||x.r>p[0].e.r)){h.push(Sl(p[1],u,me,s,o)),J=!0;break}J||h.push(N[1])}break;case"PtgArray":h.push("{"+t4(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var L=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&b>=0&&L.indexOf(t[0][E][0])==-1){N=t[0][b];var H=!0;switch(N[1][0]){case 4:H=!1;case 0:_=wa(" ",N[1][1]);break;case 5:H=!1;case 1:_=wa("\r",N[1][1]);break;default:if(_="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}h.push((H?_:"")+h.pop()+(H?"":_)),b=-1}}if(h.length>1&&o.WTF)throw new Error("bad formula stack");return h[0]}function r4(t){if(t==null){var r=Pe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return bs(t);return bs(0)}function i4(t,r,a,s,o){var d=_s(r,a,o),u=r4(t.v),h=Pe(6),f=33;h.write_shift(2,f),h.write_shift(4,0);for(var p=Pe(t.bf.length),x=0;x<t.bf.length;++x)p[x]=t.bf[x];var j=nn([d,u,h,p]);return j}function Uu(t,r,a){var s=t.read_shift(4),o=e4(t,s,a),d=t.read_shift(4),u=d>0?QT(t,d,o,a):null;return[o,u]}var s4=Uu,$u=Uu,l4=Uu,o4=Uu,c4={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Yj={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},d4={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function u4(t){var r="of:="+t.replace(kp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function f4(t){return t.replace(/\./,"!")}var qo=typeof Map<"u";function Tp(t,r,a){var s=0,o=t.length;if(a){if(qo?a.has(r):Object.prototype.hasOwnProperty.call(a,r)){for(var d=qo?a.get(r):a[r];s<d.length;++s)if(t[d[s]].t===r)return t.Count++,d[s]}}else for(;s<o;++s)if(t[s].t===r)return t.Count++,s;return t[o]={t:r},t.Count++,t.Unique++,a&&(qo?(a.has(r)||a.set(r,[]),a.get(r).push(o)):(Object.prototype.hasOwnProperty.call(a,r)||(a[r]=[]),a[r].push(o))),o}function Hu(t,r){var a={min:t+1,max:t+1},s=-1;return r.MDW&&(si=r.MDW),r.width!=null?a.customWidth=1:r.wpx!=null?s=Cu(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(a.width=Ym(s),a.customWidth=1):r.width!=null&&(a.width=r.width),r.hidden&&(a.hidden=!0),r.level!=null&&(a.outlineLevel=a.level=r.level),a}function Jj(t,r){if(t){var a=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=a[0]),t.right==null&&(t.right=a[1]),t.top==null&&(t.top=a[2]),t.bottom==null&&(t.bottom=a[3]),t.header==null&&(t.header=a[4]),t.footer==null&&(t.footer=a[5])}}function qi(t,r,a){var s=a.revssf[r.z!=null?r.z:"General"],o=60,d=t.length;if(s==null&&a.ssf){for(;o<392;++o)if(a.ssf[o]==null){Z1(r.z,o),a.ssf[o]=r.z,a.revssf[r.z]=s=o;break}}for(o=0;o!=d;++o)if(t[o].numFmtId===s)return o;return t[d]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},d}function h4(t,r,a){if(t&&t["!ref"]){var s=pa(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+a+"): "+t["!ref"])}}function m4(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',a=0;a!=t.length;++a)r+='<mergeCell ref="'+La(t[a])+'"/>';return r+"</mergeCells>"}function p4(t,r,a,s,o){var d=!1,u={},h=null;if(s.bookType!=="xlsx"&&r.vbaraw){var f=r.SheetNames[a];try{r.Workbook&&(f=r.Workbook.Sheets[a].CodeName||f)}catch{}d=!0,u.codeName=nc(Qt(f))}if(t&&t["!outline"]){var p={summaryBelow:1,summaryRight:1};t["!outline"].above&&(p.summaryBelow=0),t["!outline"].left&&(p.summaryRight=0),h=(h||"")+Je("outlinePr",null,p)}!d&&!h||(o[o.length]=Je("sheetPr",h,u))}var g4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],x4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function y4(t){var r={sheet:1};return g4.forEach(function(a){t[a]!=null&&t[a]&&(r[a]="1")}),x4.forEach(function(a){t[a]!=null&&!t[a]&&(r[a]="0")}),t.password&&(r.password=Bj(t.password).toString(16).toUpperCase()),Je("sheetProtection",null,r)}function v4(t){return Jj(t),Je("pageMargins",null,t)}function j4(t,r){for(var a=["<cols>"],s,o=0;o!=r.length;++o)(s=r[o])&&(a[a.length]=Je("col",null,Hu(o,s)));return a[a.length]="</cols>",a.join("")}function b4(t,r,a,s){var o=typeof t.ref=="string"?t.ref:La(t.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var d=a.Workbook.Names,u=Gn(o);u.s.r==u.e.r&&(u.e.r=Gn(r["!ref"]).e.r,o=La(u));for(var h=0;h<d.length;++h){var f=d[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==s){f.Ref="'"+a.SheetNames[s]+"'!"+o;break}}return h==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+o}),Je("autoFilter",null,{ref:o})}function _4(t,r,a,s){var o={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,o),{})}function S4(t,r,a,s){if(t.c&&a["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var o="",d=t.t,u=t.v;if(t.t!=="z")switch(t.t){case"b":o=t.v?"1":"0";break;case"n":o=""+t.v;break;case"e":o=gc[t.v];break;case"d":s&&s.cellDates?o=vn(t.v,-1).toISOString():(t=En(t),t.t="n",o=""+(t.v=An(vn(t.v)))),typeof t.z>"u"&&(t.z=ka[14]);break;default:o=t.v;break}var h=rn("v",Qt(o)),f={r},p=qi(s.cellXfs,t,s);switch(p!==0&&(f.s=p),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){h=rn("v",""+Tp(s.Strings,t.v,s.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=d&&(t.t=d,t.v=u),typeof t.f=="string"&&t.f){var x=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;h=Je("f",Qt(t.f),x)+(t.v!=null?h:"")}return t.l&&a["!links"].push([r,t.l]),t.D&&(f.cm=1),Je("c",h,f)}function w4(t,r,a,s){var o=[],d=[],u=pa(t["!ref"]),h="",f,p="",x=[],j=0,y=0,S=t["!rows"],w=Array.isArray(t),b={r:p},_,E=-1;for(y=u.s.c;y<=u.e.c;++y)x[y]=fn(y);for(j=u.s.r;j<=u.e.r;++j){for(d=[],p=sn(j),y=u.s.c;y<=u.e.c;++y){f=x[y]+p;var C=w?(t[j]||[])[y]:t[f];C!==void 0&&(h=S4(C,f,t,r))!=null&&d.push(h)}(d.length>0||S&&S[j])&&(b={r:p},S&&S[j]&&(_=S[j],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=Tu(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level)),o[o.length]=Je("row",d.join(""),b))}if(S)for(;j<S.length;++j)S&&S[j]&&(b={r:j+1},_=S[j],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=Tu(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level),o[o.length]=Je("row","",b));return o.join("")}function Xj(t,r,a,s){var o=[Ma,Je("worksheet",null,{xmlns:Tl[0],"xmlns:r":Za.r})],d=a.SheetNames[t],u=0,h="",f=a.Sheets[d];f==null&&(f={});var p=f["!ref"]||"A1",x=pa(p);if(x.e.c>16383||x.e.r>1048575){if(r.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),p=La(x)}s||(s={}),f["!comments"]=[];var j=[];p4(f,a,t,r,o),o[o.length]=Je("dimension",null,{ref:p}),o[o.length]=_4(f,r,t,a),r.sheetFormat&&(o[o.length]=Je("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(o[o.length]=j4(f,f["!cols"])),o[u=o.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(h=w4(f,r),h.length>0&&(o[o.length]=h)),o.length>u+1&&(o[o.length]="</sheetData>",o[u]=o[u].replace("/>",">")),f["!protect"]&&(o[o.length]=y4(f["!protect"])),f["!autofilter"]!=null&&(o[o.length]=b4(f["!autofilter"],f,a,t)),f["!merges"]!=null&&f["!merges"].length>0&&(o[o.length]=m4(f["!merges"]));var y=-1,S,w=-1;return f["!links"].length>0&&(o[o.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(S={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=Xt(s,-1,Qt(b[1].Target).replace(/#.*$/,""),$t.HLINK),S["r:id"]="rId"+w),(y=b[1].Target.indexOf("#"))>-1&&(S.location=Qt(b[1].Target.slice(y+1))),b[1].Tooltip&&(S.tooltip=Qt(b[1].Tooltip)),o[o.length]=Je("hyperlink",null,S))}),o[o.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(o[o.length]=v4(f["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(o[o.length]=rn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:p}))),j.length>0&&(w=Xt(s,-1,"../drawings/drawing"+(t+1)+".xml",$t.DRAW),o[o.length]=Je("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=j),f["!comments"].length>0&&(w=Xt(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",$t.VML),o[o.length]=Je("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function k4(t,r){var a={},s=t.l+r;a.r=t.read_shift(4),t.l+=4;var o=t.read_shift(2);t.l+=1;var d=t.read_shift(1);return t.l=s,d&7&&(a.level=d&7),d&16&&(a.hidden=!0),d&32&&(a.hpt=o/20),a}function z4(t,r,a){var s=Pe(145),o=(a["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var d=320;o.hpx?d=Tu(o.hpx)*20:o.hpt&&(d=o.hpt*20),s.write_shift(2,d),s.write_shift(1,0);var u=0;o.level&&(u|=o.level),o.hidden&&(u|=16),(o.hpx||o.hpt)&&(u|=32),s.write_shift(1,u),s.write_shift(1,0);var h=0,f=s.l;s.l+=4;for(var p={r:t,c:0},x=0;x<16;++x)if(!(r.s.c>x+1<<10||r.e.c<x<<10)){for(var j=-1,y=-1,S=x<<10;S<x+1<<10;++S){p.c=S;var w=Array.isArray(a)?(a[p.r]||[])[p.c]:a[ea(p)];w&&(j<0&&(j=S),y=S)}j<0||(++h,s.write_shift(4,j),s.write_shift(4,y))}var b=s.l;return s.l=f,s.write_shift(4,h),s.l=b,s.length>s.l?s.slice(0,s.l):s}function C4(t,r,a,s){var o=z4(s,a,r);(o.length>17||(r["!rows"]||[])[s])&&Ke(t,0,o)}var T4=Cs,N4=Al;function A4(){}function E4(t,r){var a={},s=t[t.l];return++t.l,a.above=!(s&64),a.left=!(s&128),t.l+=18,a.name=Wk(t),a}function F4(t,r,a){a==null&&(a=Pe(84+4*t.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),a.write_shift(1,s);for(var o=1;o<3;++o)a.write_shift(1,0);return wu({auto:1},a),a.write_shift(-4,-1),a.write_shift(-4,-1),hj(t,a),a.slice(0,a.l)}function R4(t){var r=dr(t);return[r]}function B4(t,r,a){return a==null&&(a=Pe(8)),ws(r,a)}function O4(t){var r=ks(t);return[r]}function D4(t,r,a){return a==null&&(a=Pe(4)),zs(r,a)}function L4(t){var r=dr(t),a=t.read_shift(1);return[r,a,"b"]}function M4(t,r,a){return a==null&&(a=Pe(9)),ws(r,a),a.write_shift(1,t.v?1:0),a}function I4(t){var r=ks(t),a=t.read_shift(1);return[r,a,"b"]}function P4(t,r,a){return a==null&&(a=Pe(5)),zs(r,a),a.write_shift(1,t.v?1:0),a}function W4(t){var r=dr(t),a=t.read_shift(1);return[r,a,"e"]}function U4(t,r,a){return a==null&&(a=Pe(9)),ws(r,a),a.write_shift(1,t.v),a}function $4(t){var r=ks(t),a=t.read_shift(1);return[r,a,"e"]}function H4(t,r,a){return a==null&&(a=Pe(8)),zs(r,a),a.write_shift(1,t.v),a.write_shift(2,0),a.write_shift(1,0),a}function V4(t){var r=dr(t),a=t.read_shift(4);return[r,a,"s"]}function Z4(t,r,a){return a==null&&(a=Pe(12)),ws(r,a),a.write_shift(4,r.v),a}function G4(t){var r=ks(t),a=t.read_shift(4);return[r,a,"s"]}function K4(t,r,a){return a==null&&(a=Pe(8)),zs(r,a),a.write_shift(4,r.v),a}function q4(t){var r=dr(t),a=El(t);return[r,a,"n"]}function Y4(t,r,a){return a==null&&(a=Pe(16)),ws(r,a),bs(t.v,a),a}function J4(t){var r=ks(t),a=El(t);return[r,a,"n"]}function X4(t,r,a){return a==null&&(a=Pe(12)),zs(r,a),bs(t.v,a),a}function Q4(t){var r=dr(t),a=mj(t);return[r,a,"n"]}function eN(t,r,a){return a==null&&(a=Pe(12)),ws(r,a),pj(t.v,a),a}function tN(t){var r=ks(t),a=mj(t);return[r,a,"n"]}function aN(t,r,a){return a==null&&(a=Pe(8)),zs(r,a),pj(t.v,a),a}function nN(t){var r=dr(t),a=jp(t);return[r,a,"is"]}function rN(t){var r=dr(t),a=hn(t);return[r,a,"str"]}function iN(t,r,a){return a==null&&(a=Pe(12+4*t.v.length)),ws(r,a),Ka(t.v,a),a.length>a.l?a.slice(0,a.l):a}function sN(t){var r=ks(t),a=hn(t);return[r,a,"str"]}function lN(t,r,a){return a==null&&(a=Pe(8+4*t.v.length)),zs(r,a),Ka(t.v,a),a.length>a.l?a.slice(0,a.l):a}function oN(t,r,a){var s=t.l+r,o=dr(t);o.r=a["!row"];var d=t.read_shift(1),u=[o,d,"b"];if(a.cellFormula){t.l+=2;var h=$u(t,s-t.l,a);u[3]=Sl(h,null,o,a.supbooks,a)}else t.l=s;return u}function cN(t,r,a){var s=t.l+r,o=dr(t);o.r=a["!row"];var d=t.read_shift(1),u=[o,d,"e"];if(a.cellFormula){t.l+=2;var h=$u(t,s-t.l,a);u[3]=Sl(h,null,o,a.supbooks,a)}else t.l=s;return u}function dN(t,r,a){var s=t.l+r,o=dr(t);o.r=a["!row"];var d=El(t),u=[o,d,"n"];if(a.cellFormula){t.l+=2;var h=$u(t,s-t.l,a);u[3]=Sl(h,null,o,a.supbooks,a)}else t.l=s;return u}function uN(t,r,a){var s=t.l+r,o=dr(t);o.r=a["!row"];var d=hn(t),u=[o,d,"str"];if(a.cellFormula){t.l+=2;var h=$u(t,s-t.l,a);u[3]=Sl(h,null,o,a.supbooks,a)}else t.l=s;return u}var fN=Cs,hN=Al;function mN(t,r){return r==null&&(r=Pe(4)),r.write_shift(4,t),r}function pN(t,r){var a=t.l+r,s=Cs(t),o=bp(t),d=hn(t),u=hn(t),h=hn(t);t.l=a;var f={rfx:s,relId:o,loc:d,display:h};return u&&(f.Tooltip=u),f}function gN(t,r){var a=Pe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Al({s:Ga(t[0]),e:Ga(t[0])},a),_p("rId"+r,a);var s=t[1].Target.indexOf("#"),o=s==-1?"":t[1].Target.slice(s+1);return Ka(o||"",a),Ka(t[1].Tooltip||"",a),Ka("",a),a.slice(0,a.l)}function xN(){}function yN(t,r,a){var s=t.l+r,o=gj(t),d=t.read_shift(1),u=[o];if(u[2]=d,a.cellFormula){var h=s4(t,s-t.l,a);u[1]=h}else t.l=s;return u}function vN(t,r,a){var s=t.l+r,o=Cs(t),d=[o];if(a.cellFormula){var u=o4(t,s-t.l,a);d[1]=u,t.l=s}else t.l=s;return d}function jN(t,r,a){a==null&&(a=Pe(18));var s=Hu(t,r);a.write_shift(-4,t),a.write_shift(-4,t),a.write_shift(4,(s.width||10)*256),a.write_shift(4,0);var o=0;return r.hidden&&(o|=1),typeof s.width=="number"&&(o|=2),r.level&&(o|=r.level<<8),a.write_shift(2,o),a}var Qj=["left","right","top","bottom","header","footer"];function bN(t){var r={};return Qj.forEach(function(a){r[a]=El(t)}),r}function _N(t,r){return r==null&&(r=Pe(48)),Jj(t),Qj.forEach(function(a){bs(t[a],r)}),r}function SN(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function wN(t,r,a){a==null&&(a=Pe(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(1,0),a.write_shift(1,0),a.write_shift(2,0),a.write_shift(2,100),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a}function kN(t){var r=Pe(24);return r.write_shift(4,4),r.write_shift(4,1),Al(t,r),r}function zN(t,r){return r==null&&(r=Pe(66)),r.write_shift(2,t.password?Bj(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(a){a[1]?r.write_shift(4,t[a[0]]!=null&&!t[a[0]]?1:0):r.write_shift(4,t[a[0]]!=null&&t[a[0]]?0:1)}),r}function CN(){}function TN(){}function NN(t,r,a,s,o,d,u){if(r.v===void 0)return!1;var h="";switch(r.t){case"b":h=r.v?"1":"0";break;case"d":r=En(r),r.z=r.z||ka[14],r.v=An(vn(r.v)),r.t="n";break;case"n":case"e":h=""+r.v;break;default:h=r.v;break}var f={r:a,c:s};switch(f.s=qi(o.cellXfs,r,o),r.l&&d["!links"].push([ea(f),r.l]),r.c&&d["!comments"].push([ea(f),r.c]),r.t){case"s":case"str":return o.bookSST?(h=Tp(o.Strings,r.v,o.revStrings),f.t="s",f.v=h,u?Ke(t,18,K4(r,f)):Ke(t,7,Z4(r,f))):(f.t="str",u?Ke(t,17,lN(r,f)):Ke(t,6,iN(r,f))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?u?Ke(t,13,aN(r,f)):Ke(t,2,eN(r,f)):u?Ke(t,16,X4(r,f)):Ke(t,5,Y4(r,f)),!0;case"b":return f.t="b",u?Ke(t,15,P4(r,f)):Ke(t,4,M4(r,f)),!0;case"e":return f.t="e",u?Ke(t,14,H4(r,f)):Ke(t,3,U4(r,f)),!0}return u?Ke(t,12,D4(r,f)):Ke(t,1,B4(r,f)),!0}function AN(t,r,a,s){var o=pa(r["!ref"]||"A1"),d,u="",h=[];Ke(t,145);var f=Array.isArray(r),p=o.e.r;r["!rows"]&&(p=Math.max(o.e.r,r["!rows"].length-1));for(var x=o.s.r;x<=p;++x){u=sn(x),C4(t,r,o,x);var j=!1;if(x<=o.e.r)for(var y=o.s.c;y<=o.e.c;++y){x===o.s.r&&(h[y]=fn(y)),d=h[y]+u;var S=f?(r[x]||[])[y]:r[d];if(!S){j=!1;continue}j=NN(t,S,x,y,s,r,j)}}Ke(t,146)}function EN(t,r){!r||!r["!merges"]||(Ke(t,177,mN(r["!merges"].length)),r["!merges"].forEach(function(a){Ke(t,176,hN(a))}),Ke(t,178))}function FN(t,r){!r||!r["!cols"]||(Ke(t,390),r["!cols"].forEach(function(a,s){a&&Ke(t,60,jN(s,a))}),Ke(t,391))}function RN(t,r){!r||!r["!ref"]||(Ke(t,648),Ke(t,649,kN(pa(r["!ref"]))),Ke(t,650))}function BN(t,r,a){r["!links"].forEach(function(s){if(s[1].Target){var o=Xt(a,-1,s[1].Target.replace(/#.*$/,""),$t.HLINK);Ke(t,494,gN(s,o))}}),delete r["!links"]}function ON(t,r,a,s){if(r["!comments"].length>0){var o=Xt(s,-1,"../drawings/vmlDrawing"+(a+1)+".vml",$t.VML);Ke(t,551,_p("rId"+o)),r["!legacy"]=o}}function DN(t,r,a,s){if(r["!autofilter"]){var o=r["!autofilter"],d=typeof o.ref=="string"?o.ref:La(o.ref);a.Workbook||(a.Workbook={Sheets:[]}),a.Workbook.Names||(a.Workbook.Names=[]);var u=a.Workbook.Names,h=Gn(d);h.s.r==h.e.r&&(h.e.r=Gn(r["!ref"]).e.r,d=La(h));for(var f=0;f<u.length;++f){var p=u[f];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==s){p.Ref="'"+a.SheetNames[s]+"'!"+d;break}}f==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+a.SheetNames[s]+"'!"+d}),Ke(t,161,Al(pa(d))),Ke(t,162)}}function LN(t,r,a){Ke(t,133),Ke(t,137,wN(r,a)),Ke(t,138),Ke(t,134)}function MN(t,r){r["!protect"]&&Ke(t,535,zN(r["!protect"]))}function IN(t,r,a,s){var o=Nn(),d=a.SheetNames[t],u=a.Sheets[d]||{},h=d;try{a&&a.Workbook&&(h=a.Workbook.Sheets[t].CodeName||h)}catch{}var f=pa(u["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(r.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Ke(o,129),(a.vbaraw||u["!outline"])&&Ke(o,147,F4(h,u["!outline"])),Ke(o,148,N4(f)),LN(o,u,a.Workbook),FN(o,u),AN(o,u,t,r),MN(o,u),DN(o,u,a,t),EN(o,u),BN(o,u,s),u["!margins"]&&Ke(o,476,_N(u["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&RN(o,u),ON(o,u,t,s),Ke(o,130),o.end()}function PN(t,r){t.l+=10;var a=hn(t);return{name:a}}var WN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function UN(t){return!t.Workbook||!t.Workbook.WBProps?"false":vk(t.Workbook.WBProps.date1904)?"true":"false"}var $N="][*?/\\".split("");function eb(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return $N.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}function HN(t,r,a){t.forEach(function(s,o){eb(s);for(var d=0;d<o;++d)if(s==t[d])throw new Error("Duplicate Sheet Name: "+s);if(a){var u=r&&r[o]&&r[o].CodeName||s;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function VN(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];HN(t.SheetNames,r,!!t.vbaraw);for(var a=0;a<t.SheetNames.length;++a)h4(t.Sheets[t.SheetNames[a]],t.SheetNames[a],a)}function tb(t){var r=[Ma];r[r.length]=Je("workbook",null,{xmlns:Tl[0],"xmlns:r":Za.r});var a=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(WN.forEach(function(h){t.Workbook.WBProps[h[0]]!=null&&t.Workbook.WBProps[h[0]]!=h[1]&&(s[h[0]]=t.Workbook.WBProps[h[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=Je("workbookPr",null,s);var o=t.Workbook&&t.Workbook.Sheets||[],d=0;if(o&&o[0]&&o[0].Hidden){for(r[r.length]="<bookViews>",d=0;d!=t.SheetNames.length&&!(!o[d]||!o[d].Hidden);++d);d==t.SheetNames.length&&(d=0),r[r.length]='<workbookView firstSheet="'+d+'" activeTab="'+d+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",d=0;d!=t.SheetNames.length;++d){var u={name:Qt(t.SheetNames[d].slice(0,31))};if(u.sheetId=""+(d+1),u["r:id"]="rId"+(d+1),o[d])switch(o[d].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}r[r.length]=Je("sheet",null,u)}return r[r.length]="</sheets>",a&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(h){var f={name:h.Name};h.Comment&&(f.comment=h.Comment),h.Sheet!=null&&(f.localSheetId=""+h.Sheet),h.Hidden&&(f.hidden="1"),h.Ref&&(r[r.length]=Je("definedName",Qt(h.Ref),f))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function ZN(t,r){var a={};return a.Hidden=t.read_shift(4),a.iTabID=t.read_shift(4),a.strRelID=qm(t),a.name=hn(t),a}function GN(t,r){return r||(r=Pe(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),_p(t.strRelID,r),Ka(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function KN(t,r){var a={},s=t.read_shift(4);a.defaultThemeVersion=t.read_shift(4);var o=r>8?hn(t):"";return o.length>0&&(a.CodeName=o),a.autoCompressPictures=!!(s&65536),a.backupFile=!!(s&64),a.checkCompatibility=!!(s&4096),a.date1904=!!(s&1),a.filterPrivacy=!!(s&8),a.hidePivotFieldList=!!(s&1024),a.promptedSolutions=!!(s&16),a.publishItems=!!(s&2048),a.refreshAllConnections=!!(s&262144),a.saveExternalLinkValues=!!(s&128),a.showBorderUnselectedTables=!!(s&4),a.showInkAnnotation=!!(s&32),a.showObjects=["all","placeholders","none"][s>>13&3],a.showPivotChartFilter=!!(s&32768),a.updateLinks=["userSet","never","always"][s>>8&3],a}function qN(t,r){r||(r=Pe(72));var a=0;return t&&t.filterPrivacy&&(a|=8),r.write_shift(4,a),r.write_shift(4,0),hj(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function YN(t,r,a){var s=t.l+r;t.l+=4,t.l+=1;var o=t.read_shift(4),d=Uk(t),u=l4(t,0,a),h=bp(t);t.l=s;var f={Name:d,Ptg:u};return o<268435455&&(f.Sheet=o),h&&(f.Comment=h),f}function JN(t,r){Ke(t,143);for(var a=0;a!=r.SheetNames.length;++a){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[a]&&r.Workbook.Sheets[a].Hidden||0,o={Hidden:s,iTabID:a+1,strRelID:"rId"+(a+1),name:r.SheetNames[a]};Ke(t,156,GN(o))}Ke(t,144)}function XN(t,r){r||(r=Pe(127));for(var a=0;a!=4;++a)r.write_shift(4,0);return Ka("SheetJS",r),Ka(gu.version,r),Ka(gu.version,r),Ka("7262",r),r.length>r.l?r.slice(0,r.l):r}function QN(t,r){r||(r=Pe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var a=120;return r.write_shift(1,a),r.length>r.l?r.slice(0,r.l):r}function e6(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var a=r.Workbook.Sheets,s=0,o=-1,d=-1;s<a.length;++s)!a[s]||!a[s].Hidden&&o==-1?o=s:a[s].Hidden==1&&d==-1&&(d=s);d>o||(Ke(t,135),Ke(t,158,QN(o)),Ke(t,136))}}function t6(t,r){var a=Nn();return Ke(a,131),Ke(a,128,XN()),Ke(a,153,qN(t.Workbook&&t.Workbook.WBProps||null)),e6(a,t),JN(a,t),Ke(a,132),a.end()}function a6(t,r,a){return(r.slice(-4)===".bin"?t6:tb)(t)}function n6(t,r,a,s,o){return(r.slice(-4)===".bin"?IN:Xj)(t,a,s,o)}function r6(t,r,a){return(r.slice(-4)===".bin"?_C:Lj)(t,a)}function i6(t,r,a){return(r.slice(-4)===".bin"?qz:Rj)(t,a)}function s6(t,r,a){return(r.slice(-4)===".bin"?MC:Uj)(t)}function l6(t){return(t.slice(-4)===".bin"?AC:Pj)()}function o6(t,r){var a=[];return t.Props&&a.push(rz(t.Props,r)),t.Custprops&&a.push(iz(t.Props,t.Custprops)),a.join("")}function c6(){return""}function d6(t,r){var a=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,o){var d=[];d.push(Je("NumberFormat",null,{"ss:Format":Qt(ka[s.numFmtId])}));var u={"ss:ID":"s"+(21+o)};a.push(Je("Style",d.join(""),u))}),Je("Styles",a.join(""))}function ab(t){return Je("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+zp(t.Ref,{r:0,c:0})})}function u6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,a=[],s=0;s<r.length;++s){var o=r[s];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||a.push(ab(o)))}return Je("Names",a.join(""))}function f6(t,r,a,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var o=s.Workbook.Names,d=[],u=0;u<o.length;++u){var h=o[u];h.Sheet==a&&(h.Name.match(/^_xlfn\./)||d.push(ab(h)))}return d.join("")}function h6(t,r,a,s){if(!t)return"";var o=[];if(t["!margins"]&&(o.push("<PageSetup>"),t["!margins"].header&&o.push(Je("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&o.push(Je("Footer",null,{"x:Margin":t["!margins"].footer})),o.push(Je("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),o.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[a])if(s.Workbook.Sheets[a].Hidden)o.push(Je("Visible",s.Workbook.Sheets[a].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var d=0;d<a&&!(s.Workbook.Sheets[d]&&!s.Workbook.Sheets[d].Hidden);++d);d==a&&o.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),t["!protect"]&&(o.push(rn("ProtectContents","True")),t["!protect"].objects&&o.push(rn("ProtectObjects","True")),t["!protect"].scenarios&&o.push(rn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?o.push(rn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&o.push(rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){t["!protect"][u[0]]&&o.push("<"+u[1]+"/>")})),o.length==0?"":Je("WorksheetOptions",o.join(""),{xmlns:Vn.x})}function m6(t){return t.map(function(r){var a=yk(r.t||""),s=Je("ss:Data",a,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",s,{"ss:Author":r.a})}).join("")}function p6(t,r,a,s,o,d,u){if(!t||t.v==null&&t.f==null)return"";var h={};if(t.f&&(h["ss:Formula"]="="+Qt(zp(t.f,u))),t.F&&t.F.slice(0,r.length)==r){var f=Ga(t.F.slice(r.length+1));h["ss:ArrayRange"]="RC:R"+(f.r==u.r?"":"["+(f.r-u.r)+"]")+"C"+(f.c==u.c?"":"["+(f.c-u.c)+"]")}if(t.l&&t.l.Target&&(h["ss:HRef"]=Qt(t.l.Target),t.l.Tooltip&&(h["x:HRefScreenTip"]=Qt(t.l.Tooltip))),a["!merges"])for(var p=a["!merges"],x=0;x!=p.length;++x)p[x].s.c!=u.c||p[x].s.r!=u.r||(p[x].e.c>p[x].s.c&&(h["ss:MergeAcross"]=p[x].e.c-p[x].s.c),p[x].e.r>p[x].s.r&&(h["ss:MergeDown"]=p[x].e.r-p[x].s.r));var j="",y="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":j="Number",y=String(t.v);break;case"b":j="Boolean",y=t.v?"1":"0";break;case"e":j="Error",y=gc[t.v];break;case"d":j="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ka[14]);break;case"s":j="String",y=xk(t.v||"");break}var S=qi(s.cellXfs,t,s);h["ss:StyleID"]="s"+(21+S),h["ss:Index"]=u.c+1;var w=t.v!=null?y:"",b=t.t=="z"?"":'<Data ss:Type="'+j+'">'+w+"</Data>";return(t.c||[]).length>0&&(b+=m6(t.c)),Je("Cell",b,h)}function g6(t,r){var a='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Dj(r.hpt)),r.hpx&&(a+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(a+=' ss:Hidden="1"')),a+">"}function x6(t,r,a,s){if(!t["!ref"])return"";var o=pa(t["!ref"]),d=t["!merges"]||[],u=0,h=[];t["!cols"]&&t["!cols"].forEach(function(_,E){wp(_);var C=!!_.width,N=Hu(E,_),O={"ss:Index":E+1};C&&(O["ss:Width"]=zu(N.width)),_.hidden&&(O["ss:Hidden"]="1"),h.push(Je("Column",null,O))});for(var f=Array.isArray(t),p=o.s.r;p<=o.e.r;++p){for(var x=[g6(p,(t["!rows"]||[])[p])],j=o.s.c;j<=o.e.c;++j){var y=!1;for(u=0;u!=d.length;++u)if(!(d[u].s.c>j)&&!(d[u].s.r>p)&&!(d[u].e.c<j)&&!(d[u].e.r<p)){(d[u].s.c!=j||d[u].s.r!=p)&&(y=!0);break}if(!y){var S={r:p,c:j},w=ea(S),b=f?(t[p]||[])[j]:t[w];x.push(p6(b,w,t,r,a,s,S))}}x.push("</Row>"),x.length>2&&h.push(x.join(""))}return h.join("")}function y6(t,r,a){var s=[],o=a.SheetNames[t],d=a.Sheets[o],u=d?f6(d,r,t,a):"";return u.length>0&&s.push("<Names>"+u+"</Names>"),u=d?x6(d,r,t,a):"",u.length>0&&s.push("<Table>"+u+"</Table>"),s.push(h6(d,r,t,a)),s.join("")}function v6(t,r){r||(r={}),t.SSF||(t.SSF=En(ka)),t.SSF&&(Iu(),Mu(t.SSF),r.revssf=Pu(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],qi(r.cellXfs,{},{revssf:{General:0}}));var a=[];a.push(o6(t,r)),a.push(c6()),a.push(""),a.push("");for(var s=0;s<t.SheetNames.length;++s)a.push(Je("Worksheet",y6(s,r,t),{"ss:Name":Qt(t.SheetNames[s])}));return a[2]=d6(t,r),a[3]=u6(t),Ma+Je("Workbook",a.join(""),{xmlns:Vn.ss,"xmlns:o":Vn.o,"xmlns:x":Vn.x,"xmlns:ss":Vn.ss,"xmlns:dt":Vn.dt,"xmlns:html":Vn.html})}var om={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function j6(t,r){var a=[],s=[],o=[],d=0,u,h=Wy(ev,"n"),f=Wy(tv,"n");if(t.Props)for(u=ln(t.Props),d=0;d<u.length;++d)(Object.prototype.hasOwnProperty.call(h,u[d])?a:Object.prototype.hasOwnProperty.call(f,u[d])?s:o).push([u[d],t.Props[u[d]]]);if(t.Custprops)for(u=ln(t.Custprops),d=0;d<u.length;++d)Object.prototype.hasOwnProperty.call(t.Props||{},u[d])||(Object.prototype.hasOwnProperty.call(h,u[d])?a:Object.prototype.hasOwnProperty.call(f,u[d])?s:o).push([u[d],t.Custprops[u[d]]]);var p=[];for(d=0;d<o.length;++d)zj.indexOf(o[d][0])>-1||Sj.indexOf(o[d][0])>-1||o[d][1]!=null&&p.push(o[d]);s.length&&ia.utils.cfb_add(r,"/SummaryInformation",sv(s,om.SI,f,tv)),(a.length||p.length)&&ia.utils.cfb_add(r,"/DocumentSummaryInformation",sv(a,om.DSI,h,ev,p.length?p:null,om.UDI))}function b6(t,r){var a=r||{},s=ia.utils.cfb_new({root:"R"}),o="/Workbook";switch(a.bookType||"xls"){case"xls":a.bookType="biff8";case"xla":a.bookType||(a.bookType="xla");case"biff8":o="/Workbook",a.biff=8;break;case"biff5":o="/Book",a.biff=5;break;default:throw new Error("invalid type "+a.bookType+" for XLS CFB")}return ia.utils.cfb_add(s,o,nb(t,a)),a.biff==8&&(t.Props||t.Custprops)&&j6(t,s),a.biff==8&&t.vbaraw&&IC(s,ia.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var _6={0:{f:k4},1:{f:R4},2:{f:Q4},3:{f:W4},4:{f:L4},5:{f:q4},6:{f:rN},7:{f:V4},8:{f:uN},9:{f:dN},10:{f:oN},11:{f:cN},12:{f:O4},13:{f:tN},14:{f:$4},15:{f:I4},16:{f:J4},17:{f:sN},18:{f:G4},19:{f:jp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:YN},40:{},42:{},43:{f:rC},44:{f:aC},45:{f:lC},46:{f:cC},47:{f:oC},48:{},49:{f:Ok},50:{},51:{f:kC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Dz},62:{f:nN},63:{f:EC},64:{f:CN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Lr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:SN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:E4},148:{f:T4,p:16},151:{f:xN},152:{},153:{f:KN},154:{},155:{},156:{f:ZN},157:{},158:{},159:{T:1,f:Zz},160:{T:-1},161:{T:1,f:Cs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:SC},336:{T:-1},337:{f:TC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Az},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yN},427:{f:vN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A4},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:pN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DC},633:{T:1},634:{T:-1},635:{T:1,f:BC},636:{T:-1},637:{f:Ik},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:TN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Xe(t,r,a,s){var o=r;if(!isNaN(o)){var d=s||(a||[]).length||0,u=t.next(4);u.write_shift(2,o),u.write_shift(2,d),d>0&&xp(a)&&t.push(a)}}function S6(t,r,a,s){var o=(a||[]).length||0;if(o<=8224)return Xe(t,r,a,o);var d=r;if(!isNaN(d)){for(var u=a.parts||[],h=0,f=0,p=0;p+(u[h]||8224)<=8224;)p+=u[h]||8224,h++;var x=t.next(4);for(x.write_shift(2,d),x.write_shift(2,p),t.push(a.slice(f,f+p)),f+=p;f<o;){for(x=t.next(4),x.write_shift(2,60),p=0;p+(u[h]||8224)<=8224;)p+=u[h]||8224,h++;x.write_shift(2,p),t.push(a.slice(f,f+p)),f+=p}}}function yc(t,r,a){return t||(t=Pe(7)),t.write_shift(2,r),t.write_shift(2,a),t.write_shift(2,0),t.write_shift(1,0),t}function w6(t,r,a,s){var o=Pe(9);return yc(o,t,r),Tj(a,s||"b",o),o}function k6(t,r,a){var s=Pe(8+2*a.length);return yc(s,t,r),s.write_shift(1,a.length),s.write_shift(a.length,a,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function z6(t,r,a,s){if(r.v!=null)switch(r.t){case"d":case"n":var o=r.t=="d"?An(vn(r.v)):r.v;o==(o|0)&&o>=0&&o<65536?Xe(t,2,Pz(a,s,o)):Xe(t,3,Iz(a,s,o));return;case"b":case"e":Xe(t,5,w6(a,s,r.v,r.t));return;case"s":case"str":Xe(t,4,k6(a,s,(r.v||"").slice(0,255)));return}Xe(t,1,yc(null,a,s))}function C6(t,r,a,s){var o=Array.isArray(r),d=pa(r["!ref"]||"A1"),u,h="",f=[];if(d.e.c>255||d.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,16383),u=La(d)}for(var p=d.s.r;p<=d.e.r;++p){h=sn(p);for(var x=d.s.c;x<=d.e.c;++x){p===d.s.r&&(f[x]=fn(x)),u=f[x]+h;var j=o?(r[p]||[])[x]:r[u];j&&z6(t,j,p,x)}}}function T6(t,r){for(var a=r||{},s=Nn(),o=0,d=0;d<t.SheetNames.length;++d)t.SheetNames[d]==a.sheet&&(o=d);if(o==0&&a.sheet&&t.SheetNames[0]!=a.sheet)throw new Error("Sheet not found: "+a.sheet);return Xe(s,a.biff==4?1033:a.biff==3?521:9,Sp(t,16,a)),C6(s,t.Sheets[t.SheetNames[o]],o,a),Xe(s,10),s.end()}function N6(t,r,a){Xe(t,49,_z({sz:12,name:"Arial"},a))}function A6(t,r,a){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var o=s[0];o<=s[1];++o)r[o]!=null&&Xe(t,1054,kz(o,r[o],a))})}function E6(t,r){var a=Pe(19);a.write_shift(4,2151),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,1),a.write_shift(4,0),Xe(t,2151,a),a=Pe(39),a.write_shift(4,2152),a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,3),a.write_shift(1,0),a.write_shift(4,0),a.write_shift(2,1),a.write_shift(4,4),a.write_shift(2,0),Ej(pa(r["!ref"]||"A1"),a),a.write_shift(4,4),Xe(t,2152,a)}function F6(t,r){for(var a=0;a<16;++a)Xe(t,224,ov({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){Xe(t,224,ov(s,0,r))})}function R6(t,r){for(var a=0;a<r["!links"].length;++a){var s=r["!links"][a];Xe(t,440,Rz(s)),s[1].Tooltip&&Xe(t,2048,Bz(s))}delete r["!links"]}function B6(t,r){if(r){var a=0;r.forEach(function(s,o){++a<=256&&s&&Xe(t,125,Lz(Hu(o,s),o))})}}function O6(t,r,a,s,o){var d=16+qi(o.cellXfs,r,o);if(r.v==null&&!r.bf){Xe(t,513,_s(a,s,d));return}if(r.bf)Xe(t,6,i4(r,a,s,o,d));else switch(r.t){case"d":case"n":var u=r.t=="d"?An(vn(r.v)):r.v;Xe(t,515,Nz(a,s,u,d));break;case"b":case"e":Xe(t,517,Tz(a,s,r.v,d,o,r.t));break;case"s":case"str":if(o.bookSST){var h=Tp(o.Strings,r.v,o.revStrings);Xe(t,253,Sz(a,s,h,d))}else Xe(t,516,wz(a,s,(r.v||"").slice(0,255),d,o));break;default:Xe(t,513,_s(a,s,d))}}function D6(t,r,a){var s=Nn(),o=a.SheetNames[t],d=a.Sheets[o]||{},u=(a||{}).Workbook||{},h=(u.Sheets||[])[t]||{},f=Array.isArray(d),p=r.biff==8,x,j="",y=[],S=pa(d["!ref"]||"A1"),w=p?65536:16384;if(S.e.c>255||S.e.r>=w){if(r.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:IV16384");S.e.c=Math.min(S.e.c,255),S.e.r=Math.min(S.e.c,w-1)}Xe(s,2057,Sp(a,16,r)),Xe(s,13,lr(1)),Xe(s,12,lr(100)),Xe(s,15,yn(!0)),Xe(s,17,yn(!1)),Xe(s,16,bs(.001)),Xe(s,95,yn(!0)),Xe(s,42,yn(!1)),Xe(s,43,yn(!1)),Xe(s,130,lr(1)),Xe(s,128,Cz()),Xe(s,131,yn(!1)),Xe(s,132,yn(!1)),p&&B6(s,d["!cols"]),Xe(s,512,zz(S,r)),p&&(d["!links"]=[]);for(var b=S.s.r;b<=S.e.r;++b){j=sn(b);for(var _=S.s.c;_<=S.e.c;++_){b===S.s.r&&(y[_]=fn(_)),x=y[_]+j;var E=f?(d[b]||[])[_]:d[x];E&&(O6(s,E,b,_,r),p&&E.l&&d["!links"].push([x,E.l]))}}var C=h.CodeName||h.name||o;return p&&Xe(s,574,bz((u.Views||[])[0])),p&&(d["!merges"]||[]).length&&Xe(s,229,Fz(d["!merges"])),p&&R6(s,d),Xe(s,442,Aj(C)),p&&E6(s,d),Xe(s,10),s.end()}function L6(t,r,a){var s=Nn(),o=(t||{}).Workbook||{},d=o.Sheets||[],u=o.WBProps||{},h=a.biff==8,f=a.biff==5;if(Xe(s,2057,Sp(t,5,a)),a.bookType=="xla"&&Xe(s,135),Xe(s,225,h?lr(1200):null),Xe(s,193,oz(2)),f&&Xe(s,191),f&&Xe(s,192),Xe(s,226),Xe(s,92,xz("SheetJS",a)),Xe(s,66,lr(h?1200:1252)),h&&Xe(s,353,lr(0)),h&&Xe(s,448),Xe(s,317,Mz(t.SheetNames.length)),h&&t.vbaraw&&Xe(s,211),h&&t.vbaraw){var p=u.CodeName||"ThisWorkbook";Xe(s,442,Aj(p))}Xe(s,156,lr(17)),Xe(s,25,yn(!1)),Xe(s,18,yn(!1)),Xe(s,19,lr(0)),h&&Xe(s,431,yn(!1)),h&&Xe(s,444,lr(0)),Xe(s,61,jz()),Xe(s,64,yn(!1)),Xe(s,141,lr(0)),Xe(s,34,yn(UN(t)=="true")),Xe(s,14,yn(!0)),h&&Xe(s,439,yn(!1)),Xe(s,218,lr(0)),N6(s,t,a),A6(s,t.SSF,a),F6(s,a),h&&Xe(s,352,yn(!1));var x=s.end(),j=Nn();h&&Xe(j,140,Oz()),h&&a.Strings&&S6(j,252,vz(a.Strings)),Xe(j,10);var y=j.end(),S=Nn(),w=0,b=0;for(b=0;b<t.SheetNames.length;++b)w+=(h?12:11)+(h?2:1)*t.SheetNames[b].length;var _=x.length+w+y.length;for(b=0;b<t.SheetNames.length;++b){var E=d[b]||{};Xe(S,133,yz({pos:_,hs:E.Hidden||0,dt:0,name:t.SheetNames[b]},a)),_+=r[b].length}var C=S.end();if(w!=C.length)throw new Error("BS8 "+w+" != "+C.length);var N=[];return x.length&&N.push(x),C.length&&N.push(C),y.length&&N.push(y),nn(N)}function M6(t,r){var a=r||{},s=[];t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Iu(),Mu(t.SSF),a.revssf=Pu(t.SSF),a.revssf[t.SSF[65535]]=0,a.ssf=t.SSF),a.Strings=[],a.Strings.Count=0,a.Strings.Unique=0,Np(a),a.cellXfs=[],qi(a.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var o=0;o<t.SheetNames.length;++o)s[s.length]=D6(o,a,t);return s.unshift(L6(t,s,a)),nn(s)}function nb(t,r){for(var a=0;a<=t.SheetNames.length;++a){var s=t.Sheets[t.SheetNames[a]];if(!(!s||!s["!ref"])){var o=Gn(s["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[a]+"' extends beyond column IV (255).  Data may be lost.")}}var d=r||{};switch(d.biff||2){case 8:case 5:return M6(t,r);case 4:case 3:case 2:return T6(t,r)}throw new Error("invalid type "+d.bookType+" for BIFF")}function I6(t,r,a,s){for(var o=t["!merges"]||[],d=[],u=r.s.c;u<=r.e.c;++u){for(var h=0,f=0,p=0;p<o.length;++p)if(!(o[p].s.r>a||o[p].s.c>u)&&!(o[p].e.r<a||o[p].e.c<u)){if(o[p].s.r<a||o[p].s.c<u){h=-1;break}h=o[p].e.r-o[p].s.r+1,f=o[p].e.c-o[p].s.c+1;break}if(!(h<0)){var x=ea({r:a,c:u}),j=s.dense?(t[a]||[])[u]:t[x],y=j&&j.v!=null&&(j.h||gk(j.w||(ci(j),j.w)||""))||"",S={};h>1&&(S.rowspan=h),f>1&&(S.colspan=f),s.editable?y='<span contenteditable="true">'+y+"</span>":j&&(S["data-t"]=j&&j.t||"z",j.v!=null&&(S["data-v"]=j.v),j.z!=null&&(S["data-z"]=j.z),j.l&&(j.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+j.l.Target+'">'+y+"</a>")),S.id=(s.id||"sjs")+"-"+x,d.push(Je("td",y,S))}}var w="<tr>";return w+d.join("")+"</tr>"}var P6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',W6="</body></html>";function U6(t,r,a){var s=[];return s.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function rb(t,r){var a=r||{},s=a.header!=null?a.header:P6,o=a.footer!=null?a.footer:W6,d=[s],u=Gn(t["!ref"]);a.dense=Array.isArray(t),d.push(U6(t,u,a));for(var h=u.s.r;h<=u.e.r;++h)d.push(I6(t,u,h,a));return d.push("</table>"+o),d.join("")}function ib(t,r,a){var s=a||{},o=0,d=0;if(s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var u=typeof s.origin=="string"?Ga(s.origin):s.origin;o=u.r,d=u.c}var h=r.getElementsByTagName("tr"),f=Math.min(s.sheetRows||1e7,h.length),p={s:{r:0,c:0},e:{r:o,c:d}};if(t["!ref"]){var x=Gn(t["!ref"]);p.s.r=Math.min(p.s.r,x.s.r),p.s.c=Math.min(p.s.c,x.s.c),p.e.r=Math.max(p.e.r,x.e.r),p.e.c=Math.max(p.e.c,x.e.c),o==-1&&(p.e.r=o=x.e.r+1)}var j=[],y=0,S=t["!rows"]||(t["!rows"]=[]),w=0,b=0,_=0,E=0,C=0,N=0;for(t["!cols"]||(t["!cols"]=[]);w<h.length&&b<f;++w){var O=h[w];if(pv(O)){if(s.display)continue;S[b]={hidden:!0}}var Q=O.children;for(_=E=0;_<Q.length;++_){var G=Q[_];if(!(s.display&&pv(G))){var M=G.hasAttribute("data-v")?G.getAttribute("data-v"):G.hasAttribute("v")?G.getAttribute("v"):jk(G.innerHTML),U=G.getAttribute("data-z")||G.getAttribute("z");for(y=0;y<j.length;++y){var A=j[y];A.s.c==E+d&&A.s.r<b+o&&b+o<=A.e.r&&(E=A.e.c+1-d,y=-1)}N=+G.getAttribute("colspan")||1,((C=+G.getAttribute("rowspan")||1)>1||N>1)&&j.push({s:{r:b+o,c:E+d},e:{r:b+o+(C||1)-1,c:E+d+(N||1)-1}});var R={t:"s",v:M},Z=G.getAttribute("data-t")||G.getAttribute("t")||"";M!=null&&(M.length==0?R.t=Z||"z":s.raw||M.trim().length==0||Z=="s"||(M==="TRUE"?R={t:"b",v:!0}:M==="FALSE"?R={t:"b",v:!1}:isNaN(ii(M))?isNaN(ac(M).getDate())||(R={t:"d",v:vn(M)},s.cellDates||(R={t:"n",v:An(R.v)}),R.z=s.dateNF||ka[14]):R={t:"n",v:ii(M)})),R.z===void 0&&U!=null&&(R.z=U);var F="",q=G.getElementsByTagName("A");if(q&&q.length)for(var ee=0;ee<q.length&&!(q[ee].hasAttribute("href")&&(F=q[ee].getAttribute("href"),F.charAt(0)!="#"));++ee);F&&F.charAt(0)!="#"&&(R.l={Target:F}),s.dense?(t[b+o]||(t[b+o]=[]),t[b+o][E+d]=R):t[ea({c:E+d,r:b+o})]=R,p.e.c<E+d&&(p.e.c=E+d),E+=N}}++b}return j.length&&(t["!merges"]=(t["!merges"]||[]).concat(j)),p.e.r=Math.max(p.e.r,b-1+o),t["!ref"]=La(p),b>=f&&(t["!fullref"]=La((p.e.r=h.length-w+b-1+o,p))),t}function sb(t,r){var a=r||{},s=a.dense?[]:{};return ib(s,t,r)}function $6(t,r){return Ss(sb(t,r),r)}function pv(t){var r="",a=H6(t);return a&&(r=a(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function H6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var V6=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ma+r}})(),gv=(function(){var t=function(d){return Qt(d).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,a=`          <table:covered-table-cell/>
`,s=function(d,u,h){var f=[];f.push('      <table:table table:name="'+Qt(u.SheetNames[h])+`" table:style-name="ta1">
`);var p=0,x=0,j=Gn(d["!ref"]||"A1"),y=d["!merges"]||[],S=0,w=Array.isArray(d);if(d["!cols"])for(x=0;x<=j.e.c;++x)f.push("        <table:table-column"+(d["!cols"][x]?' table:style-name="co'+d["!cols"][x].ods+'"':"")+`></table:table-column>
`);var b="",_=d["!rows"]||[];for(p=0;p<j.s.r;++p)b=_[p]?' table:style-name="ro'+_[p].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;p<=j.e.r;++p){for(b=_[p]?' table:style-name="ro'+_[p].ods+'"':"",f.push("        <table:table-row"+b+`>
`),x=0;x<j.s.c;++x)f.push(r);for(;x<=j.e.c;++x){var E=!1,C={},N="";for(S=0;S!=y.length;++S)if(!(y[S].s.c>x)&&!(y[S].s.r>p)&&!(y[S].e.c<x)&&!(y[S].e.r<p)){(y[S].s.c!=x||y[S].s.r!=p)&&(E=!0),C["table:number-columns-spanned"]=y[S].e.c-y[S].s.c+1,C["table:number-rows-spanned"]=y[S].e.r-y[S].s.r+1;break}if(E){f.push(a);continue}var O=ea({r:p,c:x}),Q=w?(d[p]||[])[x]:d[O];if(Q&&Q.f&&(C["table:formula"]=Qt(u4(Q.f)),Q.F&&Q.F.slice(0,O.length)==O)){var G=Gn(Q.F);C["table:number-matrix-columns-spanned"]=G.e.c-G.s.c+1,C["table:number-matrix-rows-spanned"]=G.e.r-G.s.r+1}if(!Q){f.push(r);continue}switch(Q.t){case"b":N=Q.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=Q.v?"true":"false";break;case"n":N=Q.w||String(Q.v||0),C["office:value-type"]="float",C["office:value"]=Q.v||0;break;case"s":case"str":N=Q.v==null?"":Q.v,C["office:value-type"]="string";break;case"d":N=Q.w||vn(Q.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=vn(Q.v).toISOString(),C["table:style-name"]="ce1";break;default:f.push(r);continue}var M=t(N);if(Q.l&&Q.l.Target){var U=Q.l.Target;U=U.charAt(0)=="#"?"#"+f4(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),M=Je("text:a",M,{"xlink:href":U.replace(/&/g,"&amp;")})}f.push("          "+Je("table:table-cell",Je("text:p",M,{}),C)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},o=function(d,u){d.push(` <office:automatic-styles>
`),d.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),d.push(`   <number:month number:style="long"/>
`),d.push(`   <number:text>/</number:text>
`),d.push(`   <number:day number:style="long"/>
`),d.push(`   <number:text>/</number:text>
`),d.push(`   <number:year/>
`),d.push(`  </number:date-style>
`);var h=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var x=0;x<p["!cols"].length;++x)if(p["!cols"][x]){var j=p["!cols"][x];if(j.width==null&&j.wpx==null&&j.wch==null)continue;wp(j),j.ods=h;var y=p["!cols"][x].wpx+"px";d.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),d.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),d.push(`  </style:style>
`),++h}}});var f=0;u.SheetNames.map(function(p){return u.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var x=0;x<p["!rows"].length;++x)if(p["!rows"][x]){p["!rows"][x].ods=f;var j=p["!rows"][x].hpx+"px";d.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),d.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+j+`"/>
`),d.push(`  </style:style>
`),++f}}}),d.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),d.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),d.push(`  </style:style>
`),d.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),d.push(` </office:automatic-styles>
`)};return function(u,h){var f=[Ma],p=rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(f.push("<office:document"+p+x+`>
`),f.push(bj().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+p+`>
`),o(f,u),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var j=0;j!=u.SheetNames.length;++j)f.push(s(u.Sheets[u.SheetNames[j]],u,j));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),h.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function lb(t,r){if(r.bookType=="fods")return gv(t,r);var a=hp(),s="",o=[],d=[];return s="mimetype",Ct(a,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ct(a,s,gv(t,r)),o.push([s,"text/xml"]),d.push([s,"ContentFile"]),s="styles.xml",Ct(a,s,V6(t,r)),o.push([s,"text/xml"]),d.push([s,"StylesFile"]),s="meta.xml",Ct(a,s,Ma+bj()),o.push([s,"text/xml"]),d.push([s,"MetadataFile"]),s="manifest.rdf",Ct(a,s,nz(d)),o.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ct(a,s,tz(o)),a}function Nu(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Z6(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):wr(nc(t))}function G6(t,r){e:for(var a=0;a<=t.length-r.length;++a){for(var s=0;s<r.length;++s)if(t[a+s]!=r[s])continue e;return!0}return!1}function Ki(t){var r=t.reduce(function(o,d){return o+d.length},0),a=new Uint8Array(r),s=0;return t.forEach(function(o){a.set(o,s),s+=o.length}),a}function K6(t,r,a){var s=Math.floor(a==0?0:Math.LOG10E*Math.log(Math.abs(a)))+6176-20,o=a/Math.pow(10,s-6176);t[r+15]|=s>>7,t[r+14]|=(s&127)<<1;for(var d=0;o>=1;++d,o/=256)t[r+d]=o&255;t[r+15]|=a>=0?0:128}function ic(t,r){var a=r?r[0]:0,s=t[a]&127;e:if(t[a++]>=128&&(s|=(t[a]&127)<<7,t[a++]<128||(s|=(t[a]&127)<<14,t[a++]<128)||(s|=(t[a]&127)<<21,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,28),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,35),++a,t[a++]<128)||(s+=(t[a]&127)*Math.pow(2,42),++a,t[a++]<128)))break e;return r&&(r[0]=a),s}function Jt(t){var r=new Uint8Array(7);r[0]=t&127;var a=1;e:if(t>127){if(r[a-1]|=128,r[a]=t>>7&127,++a,t<=16383||(r[a-1]|=128,r[a]=t>>14&127,++a,t<=2097151)||(r[a-1]|=128,r[a]=t>>21&127,++a,t<=268435455)||(r[a-1]|=128,r[a]=t/256>>>21&127,++a,t<=34359738367)||(r[a-1]|=128,r[a]=t/65536>>>21&127,++a,t<=4398046511103))break e;r[a-1]|=128,r[a]=t/16777216>>>21&127,++a}return r.slice(0,a)}function bl(t){var r=0,a=t[r]&127;e:if(t[r++]>=128){if(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128))break e;a|=(t[r]&127)<<28}return a}function $a(t){for(var r=[],a=[0];a[0]<t.length;){var s=a[0],o=ic(t,a),d=o&7;o=Math.floor(o/8);var u=0,h;if(o==0)break;switch(d){case 0:{for(var f=a[0];t[a[0]++]>=128;);h=t.slice(f,a[0])}break;case 5:u=4,h=t.slice(a[0],a[0]+u),a[0]+=u;break;case 1:u=8,h=t.slice(a[0],a[0]+u),a[0]+=u;break;case 2:u=ic(t,a),h=t.slice(a[0],a[0]+u),a[0]+=u;break;default:throw new Error("PB Type ".concat(d," for Field ").concat(o," at offset ").concat(s))}var p={data:h,type:d};r[o]==null?r[o]=[p]:r[o].push(p)}return r}function en(t){var r=[];return t.forEach(function(a,s){a.forEach(function(o){o.data&&(r.push(Jt(s*8+o.type)),o.type==2&&r.push(Jt(o.data.length)),r.push(o.data))})}),Ki(r)}function vr(t){for(var r,a=[],s=[0];s[0]<t.length;){var o=ic(t,s),d=$a(t.slice(s[0],s[0]+o));s[0]+=o;var u={id:bl(d[1][0].data),messages:[]};d[2].forEach(function(h){var f=$a(h.data),p=bl(f[3][0].data);u.messages.push({meta:f,data:t.slice(s[0],s[0]+p)}),s[0]+=p}),(r=d[3])!=null&&r[0]&&(u.merge=bl(d[3][0].data)>>>0>0),a.push(u)}return a}function dl(t){var r=[];return t.forEach(function(a){var s=[];s[1]=[{data:Jt(a.id),type:0}],s[2]=[],a.merge!=null&&(s[3]=[{data:Jt(+!!a.merge),type:0}]);var o=[];a.messages.forEach(function(u){o.push(u.data),u.meta[3]=[{type:0,data:Jt(u.data.length)}],s[2].push({data:en(u.meta),type:2})});var d=en(s);r.push(Jt(d.length)),r.push(d),o.forEach(function(u){return r.push(u)})}),Ki(r)}function q6(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var a=[0],s=ic(r,a),o=[];a[0]<r.length;){var d=r[a[0]]&3;if(d==0){var u=r[a[0]++]>>2;if(u<60)++u;else{var h=u-59;u=r[a[0]],h>1&&(u|=r[a[0]+1]<<8),h>2&&(u|=r[a[0]+2]<<16),h>3&&(u|=r[a[0]+3]<<24),u>>>=0,u++,a[0]+=h}o.push(r.slice(a[0],a[0]+u)),a[0]+=u;continue}else{var f=0,p=0;if(d==1?(p=(r[a[0]]>>2&7)+4,f=(r[a[0]++]&224)<<3,f|=r[a[0]++]):(p=(r[a[0]++]>>2)+1,d==2?(f=r[a[0]]|r[a[0]+1]<<8,a[0]+=2):(f=(r[a[0]]|r[a[0]+1]<<8|r[a[0]+2]<<16|r[a[0]+3]<<24)>>>0,a[0]+=4)),o=[Ki(o)],f==0)throw new Error("Invalid offset 0");if(f>o[0].length)throw new Error("Invalid offset beyond length");if(p>=f)for(o.push(o[0].slice(-f)),p-=f;p>=o[o.length-1].length;)o.push(o[o.length-1]),p-=o[o.length-1].length;o.push(o[0].slice(-f,-f+p))}}var x=Ki(o);if(x.length!=s)throw new Error("Unexpected length: ".concat(x.length," != ").concat(s));return x}function jr(t){for(var r=[],a=0;a<t.length;){var s=t[a++],o=t[a]|t[a+1]<<8|t[a+2]<<16;a+=3,r.push(q6(s,t.slice(a,a+o))),a+=o}if(a!==t.length)throw new Error("data is not a valid framed stream!");return Ki(r)}function ul(t){for(var r=[],a=0;a<t.length;){var s=Math.min(t.length-a,268435455),o=new Uint8Array(4);r.push(o);var d=Jt(s),u=d.length;r.push(d),s<=60?(u++,r.push(new Uint8Array([s-1<<2]))):s<=256?(u+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(u+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(u+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(u+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(t.slice(a,a+s)),u+=s,o[0]=0,o[1]=u&255,o[2]=u>>8&255,o[3]=u>>16&255,a+=s}return Ki(r)}function cm(t,r){var a=new Uint8Array(32),s=Nu(a),o=12,d=0;switch(a[0]=5,t.t){case"n":a[1]=2,K6(a,o,t.v),d|=1,o+=16;break;case"b":a[1]=6,s.setFloat64(o,t.v?1:0,!0),d|=2,o+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));a[1]=3,s.setUint32(o,r.indexOf(t.v),!0),d|=8,o+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,d,!0),a.slice(0,o)}function dm(t,r){var a=new Uint8Array(32),s=Nu(a),o=12,d=0;switch(a[0]=3,t.t){case"n":a[2]=2,s.setFloat64(o,t.v,!0),d|=32,o+=8;break;case"b":a[2]=6,s.setFloat64(o,t.v?1:0,!0),d|=32,o+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));a[2]=3,s.setUint32(o,r.indexOf(t.v),!0),d|=16,o+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,d,!0),a.slice(0,o)}function Ii(t){var r=$a(t);return ic(r[1][0].data)}function Y6(t,r,a){var s,o,d,u;if(!((s=t[6])!=null&&s[0])||!((o=t[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var h=((u=(d=t[8])==null?void 0:d[0])==null?void 0:u.data)&&bl(t[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var f=0,p=Nu(t[7][0].data),x=0,j=[],y=Nu(t[4][0].data),S=0,w=[],b=0;b<r.length;++b){if(r[b]==null){p.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}p.setUint16(b*2,x,!0),y.setUint16(b*2,S,!0);var _,E;switch(typeof r[b]){case"string":_=cm({t:"s",v:r[b]},a),E=dm({t:"s",v:r[b]},a);break;case"number":_=cm({t:"n",v:r[b]},a),E=dm({t:"n",v:r[b]},a);break;case"boolean":_=cm({t:"b",v:r[b]},a),E=dm({t:"b",v:r[b]},a);break;default:throw new Error("Unsupported value "+r[b])}j.push(_),x+=_.length,w.push(E),S+=E.length,++f}for(t[2][0].data=Jt(f);b<t[7][0].data.length/2;++b)p.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return t[6][0].data=Ki(j),t[3][0].data=Ki(w),f}function J6(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var a=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Gn(a["!ref"]);s.s.r=s.s.c=0;var o=!1;s.e.c>9&&(o=!0,s.e.c=9),s.e.r>49&&(o=!0,s.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(La(s)));var d=Au(a,{range:s,header:1}),u=["~Sh33tJ5~"];d.forEach(function(z){return z.forEach(function(k){typeof k=="string"&&u.push(k)})});var h={},f=[],p=ia.read(r.numbers,{type:"base64"});p.FileIndex.map(function(z,k){return[z,p.FullPaths[k]]}).forEach(function(z){var k=z[0],I=z[1];if(k.type==2&&k.name.match(/\.iwa/)){var D=k.content,de=jr(D),he=vr(de);he.forEach(function(ie){f.push(ie.id),h[ie.id]={deps:[],location:I,type:bl(ie.messages[0].meta[1][0].data)}})}}),f.sort(function(z,k){return z-k});var x=f.filter(function(z){return z>1}).map(function(z){return[z,Jt(z)]});p.FileIndex.map(function(z,k){return[z,p.FullPaths[k]]}).forEach(function(z){var k=z[0];if(z[1],!!k.name.match(/\.iwa/)){var I=vr(jr(k.content));I.forEach(function(D){D.messages.forEach(function(de){x.forEach(function(he){D.messages.some(function(ie){return bl(ie.meta[1][0].data)!=11006&&G6(ie.data,he[1])})&&h[he[0]].deps.push(D.id)})})})}});for(var j=ia.find(p,h[1].location),y=vr(jr(j.content)),S,w=0;w<y.length;++w){var b=y[w];b.id==1&&(S=b)}var _=Ii($a(S.messages[0].data)[1][0].data);for(j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Ii($a(S.messages[0].data)[2][0].data),j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);for(_=Ii($a(S.messages[0].data)[2][0].data),j=ia.find(p,h[_].location),y=vr(jr(j.content)),w=0;w<y.length;++w)b=y[w],b.id==_&&(S=b);var E=$a(S.messages[0].data);{E[6][0].data=Jt(s.e.r+1),E[7][0].data=Jt(s.e.c+1);var C=Ii(E[46][0].data),N=ia.find(p,h[C].location),O=vr(jr(N.content));{for(var Q=0;Q<O.length&&O[Q].id!=C;++Q);if(O[Q].id!=C)throw"Bad ColumnRowUIDMapArchive";var G=$a(O[Q].messages[0].data);G[1]=[],G[2]=[],G[3]=[];for(var M=0;M<=s.e.c;++M){var U=[];U[1]=U[2]=[{type:0,data:Jt(M+420690)}],G[1].push({type:2,data:en(U)}),G[2].push({type:0,data:Jt(M)}),G[3].push({type:0,data:Jt(M)})}G[4]=[],G[5]=[],G[6]=[];for(var A=0;A<=s.e.r;++A)U=[],U[1]=U[2]=[{type:0,data:Jt(A+726270)}],G[4].push({type:2,data:en(U)}),G[5].push({type:0,data:Jt(A)}),G[6].push({type:0,data:Jt(A)});O[Q].messages[0].data=en(G)}N.content=ul(dl(O)),N.size=N.content.length,delete E[46];var R=$a(E[4][0].data);{R[7][0].data=Jt(s.e.r+1);var Z=$a(R[1][0].data),F=Ii(Z[2][0].data);N=ia.find(p,h[F].location),O=vr(jr(N.content));{if(O[0].id!=F)throw"Bad HeaderStorageBucket";var q=$a(O[0].messages[0].data);for(A=0;A<d.length;++A){var ee=$a(q[2][0].data);ee[1][0].data=Jt(A),ee[4][0].data=Jt(d[A].length),q[2][A]={type:q[2][0].type,data:en(ee)}}O[0].messages[0].data=en(q)}N.content=ul(dl(O)),N.size=N.content.length;var me=Ii(R[2][0].data);N=ia.find(p,h[me].location),O=vr(jr(N.content));{if(O[0].id!=me)throw"Bad HeaderStorageBucket";for(q=$a(O[0].messages[0].data),M=0;M<=s.e.c;++M)ee=$a(q[2][0].data),ee[1][0].data=Jt(M),ee[4][0].data=Jt(s.e.r+1),q[2][M]={type:q[2][0].type,data:en(ee)};O[0].messages[0].data=en(q)}N.content=ul(dl(O)),N.size=N.content.length;var W=Ii(R[4][0].data);(function(){for(var z=ia.find(p,h[W].location),k=vr(jr(z.content)),I,D=0;D<k.length;++D){var de=k[D];de.id==W&&(I=de)}var he=$a(I.messages[0].data);{he[3]=[];var ie=[];u.forEach(function(fe,_e){ie[1]=[{type:0,data:Jt(_e)}],ie[2]=[{type:0,data:Jt(1)}],ie[3]=[{type:2,data:Z6(fe)}],he[3].push({type:2,data:en(ie)})})}I.messages[0].data=en(he);var ve=dl(k),je=ul(ve);z.content=je,z.size=z.content.length})();var J=$a(R[3][0].data);{var L=J[1][0];delete J[2];var H=$a(L.data);{var ne=Ii(H[2][0].data);(function(){for(var z=ia.find(p,h[ne].location),k=vr(jr(z.content)),I,D=0;D<k.length;++D){var de=k[D];de.id==ne&&(I=de)}var he=$a(I.messages[0].data);{delete he[6],delete J[7];var ie=new Uint8Array(he[5][0].data);he[5]=[];for(var ve=0,je=0;je<=s.e.r;++je){var fe=$a(ie);ve+=Y6(fe,d[je],u),fe[1][0].data=Jt(je),he[5].push({data:en(fe),type:2})}he[1]=[{type:0,data:Jt(s.e.c+1)}],he[2]=[{type:0,data:Jt(s.e.r+1)}],he[3]=[{type:0,data:Jt(ve)}],he[4]=[{type:0,data:Jt(s.e.r+1)}]}I.messages[0].data=en(he);var _e=dl(k),Se=ul(_e);z.content=Se,z.size=z.content.length})()}L.data=en(H)}R[3][0].data=en(J)}E[4][0].data=en(R)}S.messages[0].data=en(E);var P=dl(y),T=ul(P);return j.content=T,j.size=j.content.length,p}function X6(t){return function(a){for(var s=0;s!=t.length;++s){var o=t[s];a[o[0]]===void 0&&(a[o[0]]=o[1]),o[2]==="n"&&(a[o[0]]=Number(a[o[0]]))}}}function Np(t){X6([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Q6(t,r){return r.bookType=="ods"?lb(t,r):r.bookType=="numbers"?J6(t,r):r.bookType=="xlsb"?eA(t,r):tA(t,r)}function eA(t,r){xl=1024,t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Iu(),Mu(t.SSF),r.revssf=Pu(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var a=r.bookType=="xlsb"?"bin":"xml",s=$j.indexOf(r.bookType)>-1,o=yj();Np(r=r||{});var d=hp(),u="",h=0;if(r.cellXfs=[],qi(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",Ct(d,u,_j(t.Props,r)),o.coreprops.push(u),Xt(r.rels,2,u,$t.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],p=0;p<t.SheetNames.length;++p)(t.Workbook.Sheets[p]||{}).Hidden!=2&&f.push(t.SheetNames[p]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Ct(d,u,wj(t.Props)),o.extprops.push(u),Xt(r.rels,3,u,$t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(u="docProps/custom.xml",Ct(d,u,kj(t.Custprops)),o.custprops.push(u),Xt(r.rels,4,u,$t.CUST_PROPS)),h=1;h<=t.SheetNames.length;++h){var x={"!id":{}},j=t.Sheets[t.SheetNames[h-1]],y=(j||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+h+"."+a,Ct(d,u,n6(h-1,u,r,t,x)),o.sheets.push(u),Xt(r.wbrels,-1,"worksheets/sheet"+h+"."+a,$t.WS[0]),j){var S=j["!comments"],w=!1,b="";S&&S.length>0&&(b="xl/comments"+h+"."+a,Ct(d,b,s6(S,b)),o.comments.push(b),Xt(x,-1,"../comments"+h+"."+a,$t.CMNT),w=!0),j["!legacy"]&&w&&Ct(d,"xl/drawings/vmlDrawing"+h+".vml",Wj(h,j["!comments"])),delete j["!comments"],delete j["!legacy"]}x["!id"].rId1&&Ct(d,jj(u),vl(x))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+a,Ct(d,u,i6(r.Strings,u,r)),o.strs.push(u),Xt(r.wbrels,-1,"sharedStrings."+a,$t.SST)),u="xl/workbook."+a,Ct(d,u,a6(t,u)),o.workbooks.push(u),Xt(r.rels,1,u,$t.WB),u="xl/theme/theme1.xml",Ct(d,u,Ij(t.Themes,r)),o.themes.push(u),Xt(r.wbrels,-1,"theme/theme1.xml",$t.THEME),u="xl/styles."+a,Ct(d,u,r6(t,u,r)),o.styles.push(u),Xt(r.wbrels,-1,"styles."+a,$t.STY),t.vbaraw&&s&&(u="xl/vbaProject.bin",Ct(d,u,t.vbaraw),o.vba.push(u),Xt(r.wbrels,-1,"vbaProject.bin",$t.VBA)),u="xl/metadata."+a,Ct(d,u,l6(u)),o.metadata.push(u),Xt(r.wbrels,-1,"metadata."+a,$t.XLMETA),Ct(d,"[Content_Types].xml",vj(o,r)),Ct(d,"_rels/.rels",vl(r.rels)),Ct(d,"xl/_rels/workbook."+a+".rels",vl(r.wbrels)),delete r.revssf,delete r.ssf,d}function tA(t,r){xl=1024,t&&!t.SSF&&(t.SSF=En(ka)),t&&t.SSF&&(Iu(),Mu(t.SSF),r.revssf=Pu(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,qo?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var a="xml",s=$j.indexOf(r.bookType)>-1,o=yj();Np(r=r||{});var d=hp(),u="",h=0;if(r.cellXfs=[],qi(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",Ct(d,u,_j(t.Props,r)),o.coreprops.push(u),Xt(r.rels,2,u,$t.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],p=0;p<t.SheetNames.length;++p)(t.Workbook.Sheets[p]||{}).Hidden!=2&&f.push(t.SheetNames[p]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Ct(d,u,wj(t.Props)),o.extprops.push(u),Xt(r.rels,3,u,$t.EXT_PROPS),t.Custprops!==t.Props&&ln(t.Custprops||{}).length>0&&(u="docProps/custom.xml",Ct(d,u,kj(t.Custprops)),o.custprops.push(u),Xt(r.rels,4,u,$t.CUST_PROPS));var x=["SheetJ5"];for(r.tcid=0,h=1;h<=t.SheetNames.length;++h){var j={"!id":{}},y=t.Sheets[t.SheetNames[h-1]],S=(y||{})["!type"]||"sheet";if(u="xl/worksheets/sheet"+h+"."+a,Ct(d,u,Xj(h-1,r,t,j)),o.sheets.push(u),Xt(r.wbrels,-1,"worksheets/sheet"+h+"."+a,$t.WS[0]),y){var w=y["!comments"],b=!1,_="";if(w&&w.length>0){var E=!1;w.forEach(function(C){C[1].forEach(function(N){N.T==!0&&(E=!0)})}),E&&(_="xl/threadedComments/threadedComment"+h+"."+a,Ct(d,_,FC(w,x,r)),o.threadedcomments.push(_),Xt(j,-1,"../threadedComments/threadedComment"+h+"."+a,$t.TCMNT)),_="xl/comments"+h+"."+a,Ct(d,_,Uj(w)),o.comments.push(_),Xt(j,-1,"../comments"+h+"."+a,$t.CMNT),b=!0}y["!legacy"]&&b&&Ct(d,"xl/drawings/vmlDrawing"+h+".vml",Wj(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}j["!id"].rId1&&Ct(d,jj(u),vl(j))}return r.Strings!=null&&r.Strings.length>0&&(u="xl/sharedStrings."+a,Ct(d,u,Rj(r.Strings,r)),o.strs.push(u),Xt(r.wbrels,-1,"sharedStrings."+a,$t.SST)),u="xl/workbook."+a,Ct(d,u,tb(t)),o.workbooks.push(u),Xt(r.rels,1,u,$t.WB),u="xl/theme/theme1.xml",Ct(d,u,Ij(t.Themes,r)),o.themes.push(u),Xt(r.wbrels,-1,"theme/theme1.xml",$t.THEME),u="xl/styles."+a,Ct(d,u,Lj(t,r)),o.styles.push(u),Xt(r.wbrels,-1,"styles."+a,$t.STY),t.vbaraw&&s&&(u="xl/vbaProject.bin",Ct(d,u,t.vbaraw),o.vba.push(u),Xt(r.wbrels,-1,"vbaProject.bin",$t.VBA)),u="xl/metadata."+a,Ct(d,u,Pj()),o.metadata.push(u),Xt(r.wbrels,-1,"metadata."+a,$t.XLMETA),x.length>1&&(u="xl/persons/person.xml",Ct(d,u,RC(x)),o.people.push(u),Xt(r.wbrels,-1,"persons/person.xml",$t.PEOPLE)),Ct(d,"[Content_Types].xml",vj(o,r)),Ct(d,"_rels/.rels",vl(r.rels)),Ct(d,"xl/_rels/workbook."+a+".rels",vl(r.wbrels)),delete r.revssf,delete r.ssf,d}function aA(t,r){var a="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":a=oi(t.slice(0,12));break;case"binary":a=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function ob(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return mc(r.file,ia.write(t,{type:Vt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return ia.write(t,r)}function nA(t,r){var a=En(r||{}),s=Q6(t,a);return rA(s,a)}function rA(t,r){var a={},s=Vt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(a.compression="DEFLATE"),r.password)a.type=s;else switch(r.type){case"base64":a.type="base64";break;case"binary":a.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":a.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var o=t.FullPaths?ia.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[a.type]||a.type,compression:!!r.compression}):t.generate(a);if(typeof Deno<"u"&&typeof o=="string"){if(r.type=="binary"||r.type=="base64")return o;o=new Uint8Array(Lu(o))}return r.password&&typeof encrypt_agile<"u"?ob(encrypt_agile(o,r.password),r):r.type==="file"?mc(r.file,o):r.type=="string"?Vo(o):o}function iA(t,r){var a=r||{},s=b6(t,a);return ob(s,a)}function Br(t,r,a){a||(a="");var s=a+t;switch(r.type){case"base64":return tc(nc(s));case"binary":return nc(s);case"string":return t;case"file":return mc(r.file,s,"utf8");case"buffer":return Vt?di(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Br(s,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function sA(t,r){switch(r.type){case"base64":return tc(t);case"binary":return t;case"string":return t;case"file":return mc(r.file,t,"binary");case"buffer":return Vt?di(t,"binary"):t.split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Ud(t,r){switch(r.type){case"string":case"base64":case"binary":for(var a="",s=0;s<t.length;++s)a+=String.fromCharCode(t[s]);return r.type=="base64"?tc(a):r.type=="string"?Vo(a):a;case"file":return mc(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function cb(t,r){B2(),VN(t);var a=En(r||{});if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),a.type=="array"){a.type="binary";var s=cb(t,a);return a.type="array",Lu(s)}var o=0;if(a.sheet&&(typeof a.sheet=="number"?o=a.sheet:o=t.SheetNames.indexOf(a.sheet),!t.SheetNames[o]))throw new Error("Sheet not found: "+a.sheet+" : "+typeof a.sheet);switch(a.bookType||"xlsb"){case"xml":case"xlml":return Br(v6(t,a),a);case"slk":case"sylk":return Br(Uz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"htm":case"html":return Br(rb(t.Sheets[t.SheetNames[o]],a),a);case"txt":return sA(db(t.Sheets[t.SheetNames[o]],a),a);case"csv":return Br(Ap(t.Sheets[t.SheetNames[o]],a),a,"\uFEFF");case"dif":return Br($z.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"dbf":return Ud(Wz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"prn":return Br(Hz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"rtf":return Br(Jz.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"eth":return Br(Fj.from_sheet(t.Sheets[t.SheetNames[o]],a),a);case"fods":return Br(lb(t,a),a);case"wk1":return Ud(cv.sheet_to_wk1(t.Sheets[t.SheetNames[o]],a),a);case"wk3":return Ud(cv.book_to_wk3(t,a),a);case"biff2":a.biff||(a.biff=2);case"biff3":a.biff||(a.biff=3);case"biff4":return a.biff||(a.biff=4),Ud(nb(t,a),a);case"biff5":a.biff||(a.biff=5);case"biff8":case"xla":case"xls":return a.biff||(a.biff=8),iA(t,a);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nA(t,a);default:throw new Error("Unrecognized bookType |"+a.bookType+"|")}}function lA(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},a=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();a.match(/^\.[a-z]+$/)&&(t.bookType=a.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function oA(t,r,a){var s={};return s.type="file",s.file=r,lA(s),cb(t,s)}function cA(t,r,a,s,o,d,u,h){var f=sn(a),p=h.defval,x=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),j=!0,y=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:a,enumerable:!1})}catch{y.__rowNum__=a}else y.__rowNum__=a;if(!u||t[a])for(var S=r.s.c;S<=r.e.c;++S){var w=u?t[a][S]:t[s[S]+f];if(w===void 0||w.t===void 0){if(p===void 0)continue;d[S]!=null&&(y[d[S]]=p);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(d[S]!=null){if(b==null)if(w.t=="e"&&b===null)y[d[S]]=null;else if(p!==void 0)y[d[S]]=p;else if(x&&b===null)y[d[S]]=null;else continue;else y[d[S]]=x&&(w.t!=="n"||w.t==="n"&&h.rawNumbers!==!1)?b:ci(w,b,h);b!=null&&(j=!1)}}return{row:y,isempty:j}}function Au(t,r){if(t==null||t["!ref"]==null)return[];var a={t:"n",v:0},s=0,o=1,d=[],u=0,h="",f={s:{r:0,c:0},e:{r:0,c:0}},p=r||{},x=p.range!=null?p.range:t["!ref"];switch(p.header===1?s=1:p.header==="A"?s=2:Array.isArray(p.header)?s=3:p.header==null&&(s=0),typeof x){case"string":f=pa(x);break;case"number":f=pa(t["!ref"]),f.s.r=x;break;default:f=x}s>0&&(o=0);var j=sn(f.s.r),y=[],S=[],w=0,b=0,_=Array.isArray(t),E=f.s.r,C=0,N={};_&&!t[E]&&(t[E]=[]);var O=p.skipHidden&&t["!cols"]||[],Q=p.skipHidden&&t["!rows"]||[];for(C=f.s.c;C<=f.e.c;++C)if(!(O[C]||{}).hidden)switch(y[C]=fn(C),a=_?t[E][C]:t[y[C]+j],s){case 1:d[C]=C-f.s.c;break;case 2:d[C]=y[C];break;case 3:d[C]=p.header[C-f.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),h=u=ci(a,null,p),b=N[u]||0,!b)N[u]=1;else{do h=u+"_"+b++;while(N[h]);N[u]=b,N[h]=1}d[C]=h}for(E=f.s.r+o;E<=f.e.r;++E)if(!(Q[E]||{}).hidden){var G=cA(t,f,E,y,s,d,_,p);(G.isempty===!1||(s===1?p.blankrows!==!1:p.blankrows))&&(S[w++]=G.row)}return S.length=w,S}var xv=/"/g;function dA(t,r,a,s,o,d,u,h){for(var f=!0,p=[],x="",j=sn(a),y=r.s.c;y<=r.e.c;++y)if(s[y]){var S=h.dense?(t[a]||[])[y]:t[s[y]+j];if(S==null)x="";else if(S.v!=null){f=!1,x=""+(h.rawNumbers&&S.t=="n"?S.v:ci(S,null,h));for(var w=0,b=0;w!==x.length;++w)if((b=x.charCodeAt(w))===o||b===d||b===34||h.forceQuotes){x='"'+x.replace(xv,'""')+'"';break}x=="ID"&&(x='"ID"')}else S.f!=null&&!S.F?(f=!1,x="="+S.f,x.indexOf(",")>=0&&(x='"'+x.replace(xv,'""')+'"')):x="";p.push(x)}return h.blankrows===!1&&f?null:p.join(u)}function Ap(t,r){var a=[],s=r??{};if(t==null||t["!ref"]==null)return"";var o=pa(t["!ref"]),d=s.FS!==void 0?s.FS:",",u=d.charCodeAt(0),h=s.RS!==void 0?s.RS:`
`,f=h.charCodeAt(0),p=new RegExp((d=="|"?"\\|":d)+"+$"),x="",j=[];s.dense=Array.isArray(t);for(var y=s.skipHidden&&t["!cols"]||[],S=s.skipHidden&&t["!rows"]||[],w=o.s.c;w<=o.e.c;++w)(y[w]||{}).hidden||(j[w]=fn(w));for(var b=0,_=o.s.r;_<=o.e.r;++_)(S[_]||{}).hidden||(x=dA(t,o,_,j,u,f,d,s),x!=null&&(s.strip&&(x=x.replace(p,"")),(x||s.blankrows!==!1)&&a.push((b++?h:"")+x)));return delete s.dense,a.join("")}function db(t,r){r||(r={}),r.FS="	",r.RS=`
`;var a=Ap(t,r);return a}function uA(t){var r="",a,s="";if(t==null||t["!ref"]==null)return[];var o=pa(t["!ref"]),d="",u=[],h,f=[],p=Array.isArray(t);for(h=o.s.c;h<=o.e.c;++h)u[h]=fn(h);for(var x=o.s.r;x<=o.e.r;++x)for(d=sn(x),h=o.s.c;h<=o.e.c;++h)if(r=u[h]+d,a=p?(t[x]||[])[h]:t[r],s="",a!==void 0){if(a.F!=null){if(r=a.F,!a.f)continue;s=a.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(a.f!=null)s=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)s=""+a.v;else if(a.t=="b")s=a.v?"TRUE":"FALSE";else if(a.w!==void 0)s="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?s="'"+a.v:s=""+a.v}}f[f.length]=r+"="+s}return f}function ub(t,r,a){var s=a||{},o=+!s.skipHeader,d=t||{},u=0,h=0;if(d&&s.origin!=null)if(typeof s.origin=="number")u=s.origin;else{var f=typeof s.origin=="string"?Ga(s.origin):s.origin;u=f.r,h=f.c}var p,x={s:{c:0,r:0},e:{c:h,r:u+r.length-1+o}};if(d["!ref"]){var j=pa(d["!ref"]);x.e.c=Math.max(x.e.c,j.e.c),x.e.r=Math.max(x.e.r,j.e.r),u==-1&&(u=j.e.r+1,x.e.r=u+r.length-1+o)}else u==-1&&(u=0,x.e.r=r.length-1+o);var y=s.header||[],S=0;r.forEach(function(b,_){ln(b).forEach(function(E){(S=y.indexOf(E))==-1&&(y[S=y.length]=E);var C=b[E],N="z",O="",Q=ea({c:h+S,r:u+_+o});p=sc(d,Q),C&&typeof C=="object"&&!(C instanceof Date)?d[Q]=C:(typeof C=="number"?N="n":typeof C=="boolean"?N="b":typeof C=="string"?N="s":C instanceof Date?(N="d",s.cellDates||(N="n",C=An(C)),O=s.dateNF||ka[14]):C===null&&s.nullError&&(N="e",C=0),p?(p.t=N,p.v=C,delete p.w,delete p.R,O&&(p.z=O)):d[Q]=p={t:N,v:C},O&&(p.z=O))})}),x.e.c=Math.max(x.e.c,h+y.length-1);var w=sn(u);if(o)for(S=0;S<y.length;++S)d[fn(S+h)+w]={t:"s",v:y[S]};return d["!ref"]=La(x),d}function fA(t,r){return ub(null,t,r)}function sc(t,r,a){if(typeof r=="string"){if(Array.isArray(t)){var s=Ga(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?sc(t,ea(r)):sc(t,ea({r,c:a||0}))}function hA(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var a=t.SheetNames.indexOf(r);if(a>-1)return a;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function mA(){return{SheetNames:[],Sheets:{}}}function pA(t,r,a,s){var o=1;if(!a)for(;o<=65535&&t.SheetNames.indexOf(a="Sheet"+o)!=-1;++o,a=void 0);if(!a||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(a)>=0){var d=a.match(/(^.*?)(\d+)$/);o=d&&+d[2]||0;var u=d&&d[1]||a;for(++o;o<=65535&&t.SheetNames.indexOf(a=u+o)!=-1;++o);}if(eb(a),t.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return t.SheetNames.push(a),t.Sheets[a]=r,a}function gA(t,r,a){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=hA(t,r);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}t.Workbook.Sheets[s].Hidden=a}function xA(t,r){return t.z=r,t}function fb(t,r,a){return r?(t.l={Target:r},a&&(t.l.Tooltip=a)):delete t.l,t}function yA(t,r,a){return fb(t,"#"+r,a)}function vA(t,r,a){t.c||(t.c=[]),t.c.push({t:r,a:a||"SheetJS"})}function jA(t,r,a,s){for(var o=typeof r!="string"?r:pa(r),d=typeof r=="string"?r:La(r),u=o.s.r;u<=o.e.r;++u)for(var h=o.s.c;h<=o.e.c;++h){var f=sc(t,u,h);f.t="n",f.F=d,delete f.v,u==o.s.r&&h==o.s.c&&(f.f=a,s&&(f.D=!0))}return t}var um={encode_col:fn,encode_row:sn,encode_cell:ea,encode_range:La,decode_col:vp,decode_row:yp,split_cell:Bk,decode_cell:Ga,decode_range:Gn,format_cell:ci,sheet_add_aoa:fj,sheet_add_json:ub,sheet_add_dom:ib,aoa_to_sheet:Nl,json_to_sheet:fA,table_to_sheet:sb,table_to_book:$6,sheet_to_csv:Ap,sheet_to_txt:db,sheet_to_json:Au,sheet_to_html:rb,sheet_to_formulae:uA,sheet_to_row_object_array:Au,sheet_get_cell:sc,book_new:mA,book_append_sheet:pA,book_set_sheet_visibility:gA,cell_set_number_format:xA,cell_set_hyperlink:fb,cell_set_internal_link:yA,cell_add_comment:vA,sheet_set_array_formula:jA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function hb(t,r){if(r.format)return r.format(t);const a=t[r.key];return a==null?"":a instanceof Date?a.toISOString().slice(0,10):String(a)}function bA(t,r,a){const s=h=>{const f=String(h);return f.includes(",")||f.includes('"')||f.includes(`
`)?`"${f.replace(/"/g,'""')}"`:f},o=r.map(h=>s(h.header)).join(","),d=t.map(h=>r.map(f=>s(hb(h,f))).join(",")).join(`
`),u=new Blob(["\uFEFF"+o+`
`+d],{type:"text/csv;charset=utf-8;"});SA(u,`${a}.csv`)}function _A(t,r,a){const s=[r.map(u=>u.header),...t.map(u=>r.map(h=>hb(u,h)))],o=um.aoa_to_sheet(s),d=um.book_new();um.book_append_sheet(d,o,"Dane"),oA(d,`${a}.xlsx`)}function SA(t,r){const a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=r,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)}function ma(t){const{filteredCount:r,totalCount:a,unitLabel:s="rekordow",search:o,onSearchChange:d,searchPlaceholder:u="Szukaj...",showFilters:h,onToggleFilters:f,hasActiveFilters:p,onClearFilters:x,columns:j,visibleColumns:y,onToggleColumn:S,data:w,exportFilename:b="export",primaryLabel:_,onPrimaryAction:E,secondaryActions:C}=t,[N,O]=m.useState(!1),[Q,G]=m.useState(!1),M=m.useRef(null),U=m.useRef(null);m.useEffect(()=>{const R=Z=>{M.current&&!M.current.contains(Z.target)&&O(!1),U.current&&!U.current.contains(Z.target)&&G(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const A=j.filter(R=>y.has(R.key)).map(R=>({key:R.key,header:R.header,format:R.format}));return e.jsxs("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8},children:[e.jsxs("div",{className:"toolbar-left",style:{alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",whiteSpace:"nowrap"},children:[r!==a?`${r} / ${a}`:a," ",s]}),e.jsx("input",{className:"form-control",style:{width:200,padding:"5px 10px",fontSize:12},placeholder:u,value:o,onChange:R=>d(R.target.value)}),f&&e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:h||p?"var(--blue)":void 0,fontWeight:p?600:void 0},onClick:f,children:["Filtry kolumn ",h?"":"",p&&e.jsx("span",{style:{display:"inline-block",width:6,height:6,borderRadius:"50%",background:"var(--blue)",marginLeft:4,verticalAlign:"middle"}})]}),p&&x&&e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:"var(--red)"},onClick:x,children:"Wyczysc filtry"})]}),e.jsxs("div",{className:"toolbar-right",style:{alignItems:"center"},children:[e.jsxs("div",{ref:M,style:{position:"relative"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>O(R=>!R),title:"Kolumny",children:"Kolumny"}),N&&e.jsx("div",{style:{position:"absolute",right:0,top:"100%",marginTop:4,zIndex:100,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:8,minWidth:220,maxHeight:400,overflowY:"auto",boxShadow:"var(--shadow)"},children:j.map(R=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",fontSize:12,cursor:"pointer",borderRadius:4},children:[e.jsx("input",{type:"checkbox",checked:y.has(R.key),onChange:()=>S(R.key)}),R.header]},R.key))})]}),e.jsxs("div",{ref:U,style:{position:"relative"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>G(R=>!R),title:"Eksport",children:"Eksport"}),Q&&e.jsxs("div",{style:{position:"absolute",right:0,top:"100%",marginTop:4,zIndex:100,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:4,minWidth:130,boxShadow:"var(--shadow)"},children:[e.jsx("button",{className:"btn btn-sm",style:{width:"100%",justifyContent:"flex-start",border:"none"},onClick:()=>{bA(w,A,b),G(!1)},children:"CSV"}),e.jsx("button",{className:"btn btn-sm",style:{width:"100%",justifyContent:"flex-start",border:"none"},onClick:()=>{_A(w,A,b),G(!1)},children:"Excel (XLSX)"})]})]}),C?.map(R=>e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:R.onClick,children:R.label},R.label)),_&&E&&e.jsxs("button",{className:"btn btn-primary btn-sm",onClick:E,children:["+ ",_]})]})]})}function da(t,r){const[a,s]=m.useState(()=>{try{const d=localStorage.getItem(`cols:${r}`);if(d)return new Set(JSON.parse(d))}catch{}return new Set(t.filter(d=>d.defaultVisible!==!1).map(d=>d.key))}),o=m.useCallback(d=>{s(u=>{const h=new Set(u);return h.has(d)?h.delete(d):h.add(d),localStorage.setItem(`cols:${r}`,JSON.stringify([...h])),h})},[r]);return{visible:a,toggle:o}}function Aa(t){const{data:r,storageKey:a,defaultSort:s,defaultSortDir:o="asc",defaultPageSize:d=100,getValue:u}=t,[h,f]=m.useState({}),p=m.useCallback((ee,me)=>{f(W=>{const J={...W};return me?J[ee]=me:delete J[ee],J})},[]),x=m.useCallback(()=>{f({}),S("")},[]),j=Object.keys(h).length>0,[y,S]=m.useState(""),[w,b]=m.useState(s),[_,E]=m.useState(o),C=m.useCallback(ee=>{b(me=>me===ee?(E(W=>W==="asc"?"desc":"asc"),me):(E("asc"),ee))},[]),[N,O]=m.useState(1),[Q,G]=m.useState(()=>{try{const ee=localStorage.getItem(`pageSize:${a}`);if(ee)return Number(ee)}catch{}return d}),M=m.useCallback(ee=>{G(ee),O(1);try{localStorage.setItem(`pageSize:${a}`,String(ee))}catch{}},[a]),U=m.useCallback(ee=>O(ee),[]),A=m.useCallback((ee,me)=>u?u(ee,me):ee[me],[u]),R=m.useMemo(()=>{let ee=[...r];const me=Object.entries(h);if(me.length>0&&(ee=ee.filter(W=>me.every(([J,L])=>{const H=A(W,J);return H==null?!1:String(H).toLowerCase().includes(L.toLowerCase())}))),y){const W=y.toLowerCase();ee=ee.filter(J=>Object.values(J).some(H=>H!=null&&String(H).toLowerCase().includes(W)))}return ee.sort((W,J)=>{const L=A(W,w),H=A(J,w);let ne=0;return L==null&&H==null?ne=0:L==null?ne=1:H==null?ne=-1:typeof L=="number"&&typeof H=="number"?ne=L-H:typeof L=="boolean"&&typeof H=="boolean"?ne=L===H?0:L?-1:1:ne=String(L).localeCompare(String(H),"pl",{sensitivity:"base"}),_==="asc"?ne:-ne}),ee},[r,h,y,w,_,A]),Z=Math.max(1,Math.ceil(R.length/Q)),F=Math.min(N,Z);m.useEffect(()=>{F!==N&&O(F)},[F,N]);const q=m.useMemo(()=>R.slice((F-1)*Q,F*Q),[R,F,Q]);return{columnFilters:h,setColumnFilter:p,clearAllFilters:x,hasActiveFilters:j,search:y,setSearch:S,sortField:w,sortDir:_,toggleSort:C,page:F,pageSize:Q,setPage:U,setPageSize:M,totalPages:Z,filtered:R,pageData:q,filteredCount:R.length,totalCount:r.length}}const wA=[25,50,100,200,500];function kA({page:t,totalPages:r,pageSize:a,totalItems:s,filteredItems:o,onPageChange:d,onPageSizeChange:u}){const h=o===0?0:(t-1)*a+1,f=Math.min(t*a,o),p=[];if(r<=7)for(let x=1;x<=r;x++)p.push(x);else{p.push(1),t>3&&p.push("...");for(let x=Math.max(2,t-1);x<=Math.min(r-1,t+1);x++)p.push(x);t<r-2&&p.push("..."),p.push(r)}return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 14px",fontSize:12,color:"var(--text-muted)",borderTop:"1px solid var(--border)",flexWrap:"wrap",gap:8},children:[e.jsx("span",{children:o===0?"Brak wynikw":e.jsxs(e.Fragment,{children:[h,"",f," z ",o,o!==s&&e.jsxs("span",{style:{opacity:.6},children:[" (filtr. z ",s,")"]})]})}),e.jsxs("div",{style:{display:"flex",gap:2,alignItems:"center"},children:[e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 6px",fontSize:11,minWidth:28},disabled:t<=1,onClick:()=>d(t-1),title:"Poprzednia strona",children:""}),p.map((x,j)=>x==="..."?e.jsx("span",{style:{padding:"0 4px"},children:""},`e${j}`):e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 8px",fontSize:11,minWidth:28,background:x===t?"var(--blue)":void 0,color:x===t?"#fff":void 0,fontWeight:x===t?600:void 0},onClick:()=>d(x),children:x},x)),e.jsx("button",{className:"btn btn-sm",style:{padding:"2px 6px",fontSize:11,minWidth:28},disabled:t>=r,onClick:()=>d(t+1),title:"Nastpna strona",children:""})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{children:"Poka"}),e.jsx("select",{className:"form-control",style:{width:64,padding:"2px 4px",fontSize:11},value:a,onChange:x=>u(Number(x.target.value)),children:wA.map(x=>e.jsx("option",{value:x,children:x},x))}),e.jsx("span",{children:"na str."})]})]})}function Ea(t){const{columns:r,visibleColumns:a,data:s,renderCell:o,renderHeaderExtra:d,onRowClick:u,rowKey:h,selectedKey:f,rowBorderColor:p,sortField:x,sortDir:j,onSort:y,columnFilters:S,onColumnFilter:w,showFilters:b,page:_,totalPages:E,pageSize:C,totalItems:N,filteredItems:O,onPageChange:Q,onPageSizeChange:G,loading:M,emptyMessage:U="Brak danych.",emptyFilteredMessage:A="Brak wynikw dla wybranych filtrw."}=t,R=r.filter(ee=>a.has(ee.key)),[Z,F]=m.useState(null),q=m.useRef(null);return m.useEffect(()=>{if(!Z)return;const ee=me=>{q.current&&!q.current.contains(me.target)&&F(null)};return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[Z]),M?e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie danych..."})}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:s.length===0&&!M?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:O===0&&N>0?A:U}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsxs("thead",{children:[e.jsx("tr",{children:R.map(ee=>{const me=x===ee.key,W=!!S[ee.key];return e.jsxs("th",{style:{position:"relative",userSelect:"none",whiteSpace:"nowrap"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[d?.(ee.key),e.jsx("span",{style:{cursor:"pointer",flex:1,color:W?"var(--blue)":void 0,textDecoration:W?"underline":void 0,textDecorationStyle:W?"dotted":void 0},onClick:J=>{J.stopPropagation(),F(L=>L===ee.key?null:ee.key)},title:`Filtruj: ${ee.header}`,children:ee.header}),e.jsxs("span",{style:{display:"inline-flex",flexDirection:"column",cursor:"pointer",lineHeight:0,marginLeft:2},onClick:J=>{J.stopPropagation(),y(ee.key)},title:"Sortuj",children:[e.jsx("span",{style:{fontSize:8,lineHeight:"9px",color:me&&j==="asc"?"var(--blue)":"var(--text-muted)",opacity:me&&j==="asc"?1:.4},children:""}),e.jsx("span",{style:{fontSize:8,lineHeight:"9px",color:me&&j==="desc"?"var(--blue)":"var(--text-muted)",opacity:me&&j==="desc"?1:.4},children:""})]})]}),Z===ee.key&&e.jsxs("div",{ref:q,style:{position:"absolute",left:0,top:"100%",zIndex:120,background:"var(--bg-secondary)",border:"1px solid var(--border)",borderRadius:"var(--radius-sm)",padding:6,minWidth:160,boxShadow:"var(--shadow)"},onClick:J=>J.stopPropagation(),children:[e.jsx("input",{className:"form-control",style:{width:"100%",padding:"4px 8px",fontSize:11},placeholder:`Filtruj ${ee.header}...`,value:S[ee.key]??"",onChange:J=>w(ee.key,J.target.value),autoFocus:!0,onKeyDown:J=>{J.key==="Escape"&&F(null),J.key==="Enter"&&F(null)}}),S[ee.key]&&e.jsx("button",{className:"btn btn-sm",style:{marginTop:4,fontSize:10,width:"100%",color:"var(--red)"},onClick:()=>{w(ee.key,""),F(null)},children:"Wyczy"})]})]},ee.key)})}),b&&e.jsx("tr",{children:R.map(ee=>e.jsx("th",{style:{padding:"4px 6px",background:"var(--bg-tertiary, var(--bg-secondary))"},children:e.jsx("input",{className:"form-control",style:{width:"100%",padding:"3px 6px",fontSize:10,minWidth:60},placeholder:"...",value:S[ee.key]??"",onChange:me=>w(ee.key,me.target.value)})},`f-${ee.key}`))})]}),e.jsx("tbody",{children:s.map(ee=>{const me=h(ee),W=p?.(ee);return e.jsx("tr",{style:{cursor:u?"pointer":void 0,background:f===me?"var(--bg-card-hover)":void 0,borderLeft:W?`3px solid ${W}`:void 0},onClick:()=>u?.(ee),children:R.map(J=>{const L=o?.(ee,J.key);if(L!==void 0)return e.jsx("td",{children:L},J.key);const H=J.format?J.format(ee):ee[J.key];return e.jsx("td",{children:H??""},J.key)})},me)})})]})}),e.jsx(kA,{page:_,totalPages:E,pageSize:C,totalItems:N,filteredItems:O,onPageChange:Q,onPageSizeChange:G})]})})}const zA={fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace"};function Ia({cards:t,isFiltered:r}){return e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:t.map((a,s)=>{const o=a.formatValue?a.formatValue(a.value):a.value,d=a.total!=null&&a.formatValue?a.formatValue(a.total):a.total,u=r&&a.total!=null&&String(a.value)!==String(a.total);return e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{...zA,color:a.color},children:u?e.jsxs(e.Fragment,{children:[o,e.jsxs("span",{style:{fontSize:16,opacity:.5,fontWeight:400},children:[" / ",d]})]}):o}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:a.label})]},s)})})}function Or(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function _l(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function Eu(t){return t>=221?"Wysokie":t>=31?"Srednie":"Niskie"}const CA={"":1,"":2,"":3,"":4,"":5};function Sr({number:t,label:r}){const a=CA[t]??t;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:a}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:r})]})}function Gt({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function TA(){const[t]=fc(),[r,a]=m.useState([]),[s,o]=m.useState(!0),[d,u]=m.useState(null),[h,f]=m.useState(!1),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(null),[b,_]=m.useState(null),[E,C]=m.useState(!1),[N,O]=m.useState([]),[Q,G]=m.useState(!1),M=()=>{u(null),le.get("/api/v1/risks").then(D=>{a(D);const de=t.get("highlight");if(de){const he=D.find(ie=>ie.id===Number(de));he&&_(he)}}).catch(D=>{u(String(D)),console.error("loadRisks failed:",D)}).finally(()=>o(!1))};m.useEffect(()=>{M(),le.get("/api/v1/org-units/tree").then(O).catch(()=>{})},[]);const U=m.useMemo(()=>Cl(N),[N]),A=[{key:"id",header:"ID",format:D=>`R-${D.id}`},{key:"code",header:"Kod",format:D=>D.code??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo"},{key:"org_unit_name",header:"Pion",format:D=>D.org_unit_name??""},{key:"risk_category_name",header:"Kategoria",format:D=>D.risk_category_name??""},{key:"security_area_name",header:"Domena",format:D=>D.security_area_name??""},{key:"risk_score",header:"Ocena (R)",format:D=>(D.risk_score??0).toFixed(1)},{key:"risk_level",header:"Poziom",format:D=>D.risk_level??"",defaultVisible:!1},{key:"status_name",header:"Status",format:D=>D.status_name??""},{key:"strategy_name",header:"Strategia",format:D=>D.strategy_name??"",defaultVisible:!1},{key:"owner",header:"Wlasciciel",format:D=>D.owner??""},{key:"identification_source_name",header:"rdo ident.",format:D=>D.identification_source_name??"",defaultVisible:!1},{key:"asset_category_name",header:"Kat. aktywa",format:D=>D.asset_category_name??"",defaultVisible:!1},{key:"sensitivity_name",header:"Wraliwo",format:D=>D.sensitivity_name??"",defaultVisible:!1},{key:"criticality_name",header:"Krytyczno",format:D=>D.criticality_name??"",defaultVisible:!1},{key:"impact_level",header:"Wpyw (W)",format:D=>String(D.impact_level),defaultVisible:!1},{key:"probability_level",header:"Prawd. (P)",format:D=>String(D.probability_level),defaultVisible:!1},{key:"safeguard_rating",header:"Zabezp. (Z)",format:D=>String(D.safeguard_rating),defaultVisible:!1},{key:"residual_risk",header:"Ryzyko rezyd.",format:D=>D.residual_risk!=null?D.residual_risk.toFixed(1):"",defaultVisible:!1},{key:"treatment_deadline",header:"Termin real.",format:D=>D.treatment_deadline?.slice(0,10)??"",defaultVisible:!1},{key:"accepted_by",header:"Akceptowa",format:D=>D.accepted_by??"",defaultVisible:!1},{key:"next_review_date",header:"Nastpny przegld",format:D=>D.next_review_date?.slice(0,10)??"",defaultVisible:!1},{key:"identified_at",header:"Zidentyfikowano",format:D=>D.identified_at?.slice(0,10)??"",defaultVisible:!1},{key:"last_review_at",header:"Ostatni przegld",format:D=>D.last_review_at?.slice(0,10)??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:D=>D.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:R,toggle:Z}=da(A,"risks"),F=t.get("org_unit_id"),q=m.useMemo(()=>F?r.filter(D=>D.org_unit_id===Number(F)):r,[r,F]),ee=Aa({data:q,storageKey:"risks",defaultSort:"risk_score",defaultSortDir:"desc"}),[me,W]=m.useState(!1);m.useEffect(()=>{if(me||r.length===0)return;const D=t.get("level"),de=t.get("impact"),he=t.get("prob");D&&ee.setColumnFilter("risk_level",D),de&&ee.setColumnFilter("impact_level",de),he&&ee.setColumnFilter("probability_level",he),(D||de||he)&&G(!0),W(!0)},[r,me]);const J=async()=>{if(S)return S;const[D,de,he,ie,ve,je]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/domains").catch(()=>[]),le.get("/api/v1/threat-catalog").catch(()=>[]),le.get("/api/v1/weakness-catalog").catch(()=>[]),le.get("/api/v1/control-catalog").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),fe=async ht=>{try{return(await le.get(`/api/v1/dictionaries/${ht}/entries`)).entries.filter(qe=>qe.is_active).map(qe=>({id:qe.id,label:qe.label}))}catch{return[]}},[_e,Se,Ve,be,oe,Ue,Qe,lt]=await Promise.all([fe("asset_category"),fe("sensitivity"),fe("criticality"),fe("risk_status"),fe("risk_strategy"),fe("risk_category"),fe("risk_identification_source"),fe("asset_type")]),tt={orgUnits:D,areas:de,threats:he,vulns:ie,safeguards:ve,assets:je,categories:_e,sensitivities:Se,criticalities:Ve,statuses:be,strategies:oe,risk_categories:Ue,identification_sources:Qe,asset_types:lt};return w(tt),tt},L=async()=>{await J(),x(null),f(!0)},H=async D=>{await J(),x(D),f(!0)},ne=async D=>{y(!0);try{if(p){const de=await le.put(`/api/v1/risks/${p.id}`,D);_(de)}else await le.post("/api/v1/risks",D);f(!1),x(null),o(!0),M()}catch(de){alert("Blad zapisu: "+de)}finally{y(!1)}},P=async D=>{if(confirm(`Zamknac ryzyko R-${D.id}? Status zostanie zmieniony na "Zamkniete".`))try{await le.delete(`/api/v1/risks/${D.id}`),_(null),o(!0),M()}catch(de){alert("Blad: "+de)}},T=async D=>{const de=prompt("Kto akceptuje ryzyko? (imie i nazwisko)");if(de){C(!0);try{const he=await le.post(`/api/v1/risks/${D.id}/accept`,{accepted_by:de});_(he),o(!0),M()}catch(he){alert("Blad akceptacji: "+he)}finally{C(!1)}}},z=ee.filteredCount!==ee.totalCount,k=m.useMemo(()=>{const D=ee.filtered,de=D.filter(_e=>(_e.risk_score??0)>=221).length,he=D.filter(_e=>{const Se=_e.risk_score??0;return Se>=31&&Se<221}).length,ie=D.length>0?D.reduce((_e,Se)=>_e+(Se.risk_score??0),0)/D.length:0,ve=r.filter(_e=>(_e.risk_score??0)>=221).length,je=r.filter(_e=>{const Se=_e.risk_score??0;return Se>=31&&Se<221}).length,fe=r.length>0?r.reduce((_e,Se)=>_e+(Se.risk_score??0),0)/r.length:0;return[{label:"Wszystkich ryzyk",value:D.length,total:r.length,color:"var(--blue)"},{label:"Wysokich",value:de,total:ve,color:"var(--red)"},{label:"rednich",value:he,total:je,color:"var(--orange)"},{label:"rednia ocena",value:ie.toFixed(1),total:fe.toFixed(1),color:"var(--purple)"}]},[ee.filtered,r]),I=D=>D?new Date(D)<new Date:!1;return e.jsxs("div",{children:[d&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad ladowania ryzyk:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:d})]}),(t.get("level")||t.get("impact")||t.get("prob")||F)&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 14px",marginBottom:12,borderRadius:8,background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.25)",fontSize:12,color:"var(--blue)"},children:[e.jsx("span",{style:{fontWeight:600},children:"Widok filtrowany z dashboardu:"}),t.get("level")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Poziom: ",t.get("level")]}),t.get("impact")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Wpyw: ",t.get("impact")]}),t.get("prob")&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Prawd.: ",t.get("prob")]}),F&&e.jsxs("span",{className:"score-badge",style:{background:"var(--bg-card)",fontSize:11},children:["Pion ID: ",F]}),e.jsx("button",{className:"btn btn-sm",style:{marginLeft:"auto",padding:"3px 10px"},onClick:()=>{window.location.href="/risks"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:k,isFiltered:z}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"ryzyk",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj ryzyk...",showFilters:Q,onToggleFilters:()=>G(D=>!D),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:A,visibleColumns:R,onToggleColumn:Z,data:ee.filtered,exportFilename:"ryzyka",primaryLabel:"Dodaj ryzyko",onPrimaryAction:L}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:b?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:A,visibleColumns:R,data:ee.pageData,rowKey:D=>D.id,selectedKey:b?.id??null,onRowClick:D=>_(b?.id===D.id?null:D),rowBorderColor:D=>Or(D.risk_score??0),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,showFilters:Q,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,loading:s,emptyMessage:"Brak ryzyk w systemie.",emptyFilteredMessage:"Brak ryzyk pasujcych do filtrw.",renderCell:(D,de)=>{if(de==="id")return e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["R-",D.id]});if(de==="asset_name")return e.jsx("span",{style:{fontWeight:500},children:D.asset_name});if(de==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:U.get(D.org_unit_id)??D.org_unit_name});if(de==="risk_score")return e.jsxs("span",{className:"score-badge",style:{background:_l(D.risk_score??0),color:Or(D.risk_score??0)},children:[(D.risk_score??0).toFixed(1)," ",Eu(D.risk_score??0)]});if(de==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:D.status_name??""})}}),b&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Ryzyka"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>H(b),title:"Edytuj",children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>_(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Or(b.risk_score??0)},children:(b.risk_score??0).toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:_l(b.risk_score??0),color:Or(b.risk_score??0),fontSize:13,padding:"4px 12px"},children:Eu(b.risk_score??0)}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:["R = EXP(",b.impact_level,")  ",b.probability_level," / ",b.safeguard_rating]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Sr,{number:"\\u2460",label:"Kontekst"}),e.jsx(Gt,{label:"ID",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["R-",b.id]})}),e.jsx(Gt,{label:"Pion",value:e.jsx("span",{style:{fontSize:11},children:U.get(b.org_unit_id)??b.org_unit_name})}),e.jsx(Gt,{label:"Kategoria ryzyka",value:b.risk_category_name}),e.jsx(Gt,{label:"Zrodlo identyfikacji",value:b.identification_source_name}),b.risk_source&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Zrodlo ryzyka"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.risk_source})]}),e.jsx(Sr,{number:"\\u2461",label:"Identyfikacja aktywa"}),e.jsx(Gt,{label:"Aktywo",value:e.jsx("span",{style:{fontWeight:500},children:b.asset_name})}),b.asset_id_name&&e.jsx(Gt,{label:"Z rejestru",value:e.jsx("span",{style:{color:"var(--cyan)"},children:b.asset_id_name})}),e.jsx(Gt,{label:"Kategoria aktywa",value:b.asset_category_name}),e.jsx(Gt,{label:"Wrazliwosc",value:b.sensitivity_name}),e.jsx(Gt,{label:"Krytycznosc",value:b.criticality_name}),e.jsx(Sr,{number:"\\u2462",label:"Scenariusz ryzyka"}),e.jsx(Gt,{label:"Domena",value:b.security_area_name}),b.threats&&b.threats.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Zagrozenia"}),e.jsx("div",{className:"tag-list",children:b.threats.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--red-dim)",color:"var(--red)"},children:D.threat_name},D.threat_id))})]}),b.vulnerabilities&&b.vulnerabilities.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Podatnosci"}),e.jsx("div",{className:"tag-list",children:b.vulnerabilities.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--orange-dim)",color:"var(--orange)"},children:D.vulnerability_name},D.vulnerability_id))})]}),b.safeguards&&b.safeguards.length>0&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Zabezpieczenia"}),e.jsx("div",{className:"tag-list",children:b.safeguards.map(D=>e.jsx("span",{className:"tag",style:{background:"var(--green-dim)",color:"var(--green)"},children:D.safeguard_name},D.safeguard_id))})]}),b.existing_controls&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Istniejace kontrole"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.existing_controls})]}),b.consequence_description&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Opis konsekwencji"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.consequence_description})]}),e.jsx(Sr,{number:"\\u2463",label:"Analiza ryzyka"}),e.jsx(Gt,{label:"Wplyw (W)",value:b.impact_level}),e.jsx(Gt,{label:"Prawdopodobienstwo (P)",value:b.probability_level}),e.jsx(Gt,{label:"Zabezpieczenia (Z)",value:b.safeguard_rating}),e.jsx(Gt,{label:"Ocena (R)",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Or(b.risk_score??0)},children:(b.risk_score??0).toFixed(1)})}),e.jsx(Sr,{number:"\\u2464",label:"Postepowanie z ryzykiem"}),e.jsx(Gt,{label:"Strategia",value:b.strategy_name}),b.treatment_plan&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Plan postepowania"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.treatment_plan})]}),b.planned_safeguard_name&&e.jsx(Gt,{label:"Planowane zabezpieczenie",value:e.jsx("span",{style:{color:"var(--green)",fontWeight:500},children:b.planned_safeguard_name})}),e.jsx(Gt,{label:"Termin realizacji",value:b.treatment_deadline?e.jsxs("span",{style:{color:I(b.treatment_deadline)?"var(--red)":void 0},children:[b.treatment_deadline.slice(0,10),I(b.treatment_deadline)&&" (po terminie!)"]}):""}),b.treatment_resources&&e.jsxs("div",{style:{marginTop:4},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2},children:"Zasoby"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.treatment_resources})]}),b.residual_risk!=null&&e.jsxs("div",{style:{marginTop:8,padding:8,background:_l(b.residual_risk),borderRadius:6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:11},children:"Ryzyko rezydualne"}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Or(b.residual_risk)},children:b.residual_risk.toFixed(1)})]}),b.target_impact!=null&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Docelowe: W=",b.target_impact," P=",b.target_probability," Z=",b.target_safeguard,b.risk_score>0&&e.jsxs("span",{style:{marginLeft:6,color:"var(--green)"},children:["(-",((1-Number(b.residual_risk)/Number(b.risk_score))*100).toFixed(0),"%)"]})]})]}),e.jsx(Sr,{number:"\\u2465",label:"Akceptacja i monitorowanie"}),e.jsx(Gt,{label:"Status",value:b.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:b.status_name}):""}),e.jsx(Gt,{label:"Wlasciciel",value:b.owner}),b.accepted_by?e.jsxs("div",{style:{marginTop:4,padding:8,background:"rgba(34,197,94,0.08)",border:"1px solid rgba(34,197,94,0.25)",borderRadius:6},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:e.jsx("span",{className:"score-badge",style:{background:"rgba(34,197,94,0.15)",color:"var(--green)",fontSize:11},children:"Zaakceptowane"})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:["Przez: ",e.jsx("strong",{children:b.accepted_by}),b.accepted_at&&e.jsxs("span",{children:[" (",b.accepted_at.slice(0,10),")"]})]}),b.acceptance_justification&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Uzasadnienie: ",b.acceptance_justification]})]}):e.jsx(Gt,{label:"Akceptacja",value:e.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"Nie zaakceptowano"})}),e.jsx(Gt,{label:"Nastepny przeglad",value:b.next_review_date?e.jsxs("span",{style:{color:I(b.next_review_date)?"var(--red)":void 0,fontWeight:I(b.next_review_date)?600:void 0},children:[b.next_review_date.slice(0,10),I(b.next_review_date)&&" (zalegly!)"]}):""}),e.jsx(Gt,{label:"Zidentyfikowano",value:b.identified_at?.slice(0,10)}),e.jsx(Gt,{label:"Ostatni przeglad",value:b.last_review_at?.slice(0,10)??"Nigdy"}),b.planned_actions&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Planowane dzialania"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:b.planned_actions})]}),b.linked_actions&&b.linked_actions.length>0&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx(Sr,{number:"",label:"Powiazane dzialania"}),b.linked_actions.map(D=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 8px",borderRadius:6,marginBottom:4,background:D.is_overdue?"rgba(239,68,68,0.06)":"var(--bg-inset)",border:D.is_overdue?"1px solid rgba(239,68,68,0.2)":"1px solid var(--border)"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:12,fontWeight:500},children:D.title}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[D.owner&&e.jsx("span",{children:D.owner}),D.due_date&&e.jsxs("span",{children:[" | ",D.due_date.slice(0,10),D.is_overdue&&" (po terminie!)"]})]})]}),D.status_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:D.status_name})]},D.action_id))]})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>H(b),children:"Edytuj"}),!b.accepted_by&&e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--green)",borderColor:"rgba(34,197,94,0.3)"},onClick:()=>T(b),disabled:E,children:E?"Akceptowanie...":"Akceptuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>P(b),children:"Zamknij"})]})]})]}),e.jsx(gt,{open:h,onClose:()=>{f(!1),x(null)},title:p?`Edytuj ryzyko: R-${p.id}`:"Dodaj ryzyko",wide:!0,children:S?e.jsx(OA,{editRisk:p,lookups:S,setLookups:w,orgTree:S.orgUnits,saving:j,onSubmit:ne,onCancel:()=>{f(!1),x(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})})]})}function NA({lookups:t,setLookups:r,assetId:a,plannedSafeguardId:s,setPlannedSafeguardId:o}){const[d,u]=m.useState(""),[h,f]=m.useState(!1),x=(a?t.assets.find(b=>b.id===a):null)?.category_id??null,j=x?t.safeguards.filter(b=>b.asset_category_ids?.includes(x)||b.asset_category_ids?.length===0):t.safeguards,y=d.length>=1?j.filter(b=>b.name.toLowerCase().includes(d.toLowerCase())).slice(0,8):[],S=s?t.safeguards.find(b=>b.id===s):null,w=async()=>{if(d.trim()){f(!0);try{const b=await le.post("/api/v1/control-catalog",{name:d.trim()});r(_=>_&&{..._,safeguards:[..._.safeguards,b]}),o(b.id),u("")}catch(b){alert("Blad: "+b)}finally{f(!1)}}};return e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsxs("label",{children:["Planowane zabezpieczenie ",e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:"(wdrazane w ramach planu postepowania)"})]}),S?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 12px",background:"rgba(34,197,94,0.06)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:6},children:[e.jsx("span",{style:{flex:1,fontSize:13,fontWeight:500,color:"var(--green)"},children:S.name}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10,color:"var(--red)",padding:"0 6px"},onClick:()=>o(null),children:""})]}):e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj zabezpieczenia lub wpisz nowe...",value:d,onChange:b=>u(b.target.value)}),d.length>=1&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:[y.map(b=>e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)"},onClick:()=>{o(b.id),u("")},onMouseEnter:_=>_.currentTarget.style.background="rgba(34,197,94,0.08)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:b.name},b.id)),e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,color:"var(--green)",fontWeight:500},onClick:w,onMouseEnter:b=>b.currentTarget.style.background="rgba(34,197,94,0.08)",onMouseLeave:b=>b.currentTarget.style.background="transparent",children:h?"Dodawanie...":`+ Dodaj "${d}" do katalogu zabezpieczen`})]})]})]})}function AA({riskId:t,existingLinks:r,lookups:a,orgTree:s,strategyId:o}){const[d,u]=m.useState(""),[h,f]=m.useState([]),[p,x]=m.useState(!1),[j,y]=m.useState(r),[S,w]=m.useState(!1),[b,_]=m.useState(!1),[E,C]=m.useState(""),[N,O]=m.useState(""),[Q,G]=m.useState(""),[M,U]=m.useState(""),[A,R]=m.useState(""),[Z,F]=m.useState(null),q=o?a.strategies.find(L=>L.id===o)?.label:null,ee=q&&(q.toLowerCase().includes("modyfikacja")||q.toLowerCase().includes("transfer")||q.toLowerCase().includes("unikanie"));m.useEffect(()=>{if(d.length<2){f([]);return}const L=setTimeout(()=>{x(!0),le.get("/api/v1/actions").then(H=>{const ne=d.toLowerCase();f(H.filter(P=>P.title.toLowerCase().includes(ne)||(P.owner??"").toLowerCase().includes(ne)||(P.description??"").toLowerCase().includes(ne)).slice(0,10))}).catch(()=>{}).finally(()=>x(!1))},300);return()=>clearTimeout(L)},[d]);const me=async L=>{if(t&&!j.some(H=>H.action_id===L.id))try{const ne=((await le.get(`/api/v1/actions/${L.id}`)).links??[]).map(P=>({entity_type:P.entity_type,entity_id:P.entity_id}));ne.push({entity_type:"risk",entity_id:t}),await le.put(`/api/v1/actions/${L.id}`,{links:ne}),y([...j,{action_id:L.id,title:L.title}]),u(""),f([])}catch(H){alert("Blad wiazania: "+H)}},W=async L=>{if(t)try{const ne=((await le.get(`/api/v1/actions/${L}`)).links??[]).filter(P=>!(P.entity_type==="risk"&&P.entity_id===t)).map(P=>({entity_type:P.entity_type,entity_id:P.entity_id}));await le.put(`/api/v1/actions/${L}`,{links:ne}),y(j.filter(P=>P.action_id!==L))}catch(H){alert("Blad odlaczania: "+H)}},J=async()=>{if(!(!E||!t)){_(!0);try{const L=[{entity_type:"risk",entity_id:t}],H=await le.post("/api/v1/actions",{title:E,description:N||null,owner:Q||null,responsible:M||null,due_date:A||null,org_unit_id:Z,links:L});y([...j,{action_id:H.id,title:H.title}]),w(!1),C(""),O(""),G(""),U(""),R(""),F(null)}catch(L){alert("Blad tworzenia: "+L)}finally{_(!1)}}};return e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:e.jsxs("label",{style:{fontSize:12,color:"var(--text-muted)"},children:["Powiazane dzialania (",j.length,")",ee&&j.length===0&&e.jsxs("span",{style:{color:"var(--orange)",marginLeft:8,fontWeight:600},children:['Strategia "',q,'" wymaga zaplanowania dzialania']})]})}),j.map(L=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:4,fontSize:12},children:[e.jsx("span",{children:L.title}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"0 6px",fontSize:10,color:"var(--red)"},onClick:()=>W(L.action_id),children:""})]},L.action_id)),t&&!S&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj istniejacego dzialania po tytule, wlascicielu...",value:d,onChange:L=>u(L.target.value)}),p&&e.jsx("span",{style:{position:"absolute",right:8,top:8,fontSize:10,color:"var(--text-muted)"},children:"..."}),h.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:h.map(L=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",opacity:j.some(H=>H.action_id===L.id)?.4:1},onClick:()=>me(L),onMouseEnter:H=>H.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:H=>H.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500},children:L.title}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[L.owner&&e.jsx("span",{children:L.owner}),L.status_name&&e.jsxs("span",{children:[" | ",L.status_name]}),L.due_date&&e.jsxs("span",{children:[" | ",L.due_date.slice(0,10)]})]})]},L.id))})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{w(!0),u(""),f([])},children:"+ Nowe dzialanie"})]}),!t&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:"Zapisz ryzyko najpierw, aby moc wiazac dzialania"}),S&&t&&e.jsxs("div",{style:{background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:14,marginTop:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13,color:"var(--blue)"},children:"Nowe dzialanie"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:11},onClick:()=>w(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul dzialania *"}),e.jsx("input",{className:"form-control",value:E,onChange:L=>C(L.target.value),placeholder:"np. Wdrozenie MFA dla kont administracyjnych"}),!E&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:Q,onChange:L=>G(L.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny"}),e.jsx("input",{className:"form-control",value:M,onChange:L=>U(L.target.value),placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:s,value:Z,onChange:F,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:A,onChange:L=>R(L.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:N,onChange:L=>O(L.target.value),placeholder:"Opisz dzialanie, cele, kroki..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>w(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:b||!E,onClick:J,children:b?"Tworzenie...":"Utworz i powiaz dzialanie"})]})]})]})}function fm({label:t,items:r,selectedIds:a,onChange:s,onAdd:o,color:d,icon:u,compact:h,allItems:f}){const[p,x]=m.useState(""),[j,y]=m.useState(!1),S=r.filter(_=>!a.includes(_.id)),w=p.length>=1?S.filter(_=>_.name.toLowerCase().includes(p.toLowerCase())).slice(0,8):[],b=async()=>{if(p.trim()){y(!0);try{const _=await o(p.trim());s([...a,_.id]),x("")}catch(_){alert("Blad: "+_)}finally{y(!1)}}};return e.jsxs("div",{style:{borderRadius:8,padding:h?"10px 12px":"12px 14px",background:`${d}06`,border:`1px solid ${d}20`,borderLeft:`3px solid ${d}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[u&&e.jsx("span",{style:{fontSize:14},children:u}),e.jsx("span",{style:{fontSize:12,fontWeight:600,color:d},children:t}),e.jsx("span",{style:{fontSize:10,background:`${d}20`,color:d,borderRadius:10,padding:"1px 7px",fontWeight:600,marginLeft:4},children:a.length})]}),a.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:5,marginBottom:8},children:a.map(_=>{const E=(f??r).find(C=>C.id===_);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:d+"18",color:d,border:`1px solid ${d}35`,borderRadius:12,padding:"2px 8px 2px 8px",fontSize:11,fontWeight:500},children:[E?.name??`#${_}`,e.jsx("span",{style:{cursor:"pointer",marginLeft:2,opacity:.7,fontWeight:700,fontSize:13,lineHeight:1},onClick:()=>s(a.filter(C=>C!==_)),children:""})]},_)})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12,background:"var(--bg-card)",borderColor:`${d}30`},placeholder:"Szukaj lub wpisz nowe...",value:p,onChange:_=>x(_.target.value)}),p.length>=1&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:200,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:[w.map(_=>e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)"},onClick:()=>{s([...a,_.id]),x("")},onMouseEnter:E=>E.currentTarget.style.background=d+"12",onMouseLeave:E=>E.currentTarget.style.background="transparent",children:_.name},_.id)),e.jsx("div",{style:{padding:"7px 12px",cursor:"pointer",fontSize:12,color:d,fontWeight:500,borderTop:w.length>0?`1px solid ${d}30`:"none"},onClick:b,onMouseEnter:_=>_.currentTarget.style.background=d+"12",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:j?"Dodawanie...":`+ Dodaj "${p}" do slownika`})]})]})]})}function EA({lookups:t,setLookups:r,assetId:a,securityAreaId:s,setSecurityAreaId:o,threatIds:d,setThreatIds:u,vulnerabilityIds:h,setVulnerabilityIds:f,safeguardIds:p,setSafeguardIds:x,existingControls:j,setExistingControls:y,consequenceDescription:S,setConsequenceDescription:w}){const b=a?t.assets.find(Z=>Z.id===a):null,_=b?.category_id??null,[E,C]=m.useState(!1),[N,O]=m.useState(!1),[Q,G]=m.useState(!1),M=_&&!E?t.threats.filter(Z=>Z.asset_category_ids?.includes(_)||Z.asset_category_ids?.length===0):t.threats,U=_&&!N?t.vulns.filter(Z=>Z.asset_category_ids?.includes(_)||Z.asset_category_ids?.length===0):t.vulns,A=_&&!Q?t.safeguards.filter(Z=>Z.asset_category_ids?.includes(_)||Z.asset_category_ids?.length===0):t.safeguards,R=!!_;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff"},children:"3"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:"Scenariusz ryzyka"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zdefiniuj zagrozenia, podatnosci i zabezpieczenia"})]}),b?.category_name&&e.jsxs("div",{style:{marginLeft:"auto",fontSize:11,color:"var(--blue)",padding:"3px 10px",background:"rgba(59,130,246,0.08)",borderRadius:12,fontWeight:500},children:["Kategoria: ",e.jsx("strong",{children:b.category_name}),e.jsx("span",{style:{color:"var(--text-muted)",marginLeft:6},children:"(filtr aktywny  sugestie dopasowane do kategorii)"})]})]}),e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",marginBottom:14,background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.15)",display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",margin:0,whiteSpace:"nowrap"},children:"Domena bezpieczenstwa"}),e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:12,maxWidth:320},value:s??"",onChange:Z=>o(Z.target.value?Number(Z.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz domene..."}),t.areas.map(Z=>e.jsx("option",{value:Z.id,children:Z.name},Z.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:14},children:[e.jsxs("div",{children:[e.jsx(fm,{label:"Zagrozenia",icon:"",compact:!0,items:M,allItems:t.threats,selectedIds:d,onChange:u,color:"var(--red)",onAdd:async Z=>{const F=await le.post("/api/v1/threat-catalog",{name:Z});return r(q=>q&&{...q,threats:[...q.threats,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:Z=>C(Z.target.checked)}),"Pokaz wszystkie (",t.threats.length,") zamiast filtrowanych (",M.length,")"]})]}),e.jsxs("div",{children:[e.jsx(fm,{label:"Podatnosci",icon:"",compact:!0,items:U,allItems:t.vulns,selectedIds:h,onChange:f,color:"var(--orange)",onAdd:async Z=>{const F=await le.post("/api/v1/weakness-catalog",{name:Z});return r(q=>q&&{...q,vulns:[...q.vulns,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N,onChange:Z=>O(Z.target.checked)}),"Pokaz wszystkie (",t.vulns.length,") zamiast filtrowanych (",U.length,")"]})]}),e.jsxs("div",{children:[e.jsx(fm,{label:"Zabezpieczenia",icon:"",compact:!0,items:A,allItems:t.safeguards,selectedIds:p,onChange:x,color:"var(--green)",onAdd:async Z=>{const F=await le.post("/api/v1/control-catalog",{name:Z});return r(q=>q&&{...q,safeguards:[...q.safeguards,F]}),F}}),R&&e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:10,color:"var(--text-muted)",marginTop:4,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:Q,onChange:Z=>G(Z.target.checked)}),"Pokaz wszystkie (",t.safeguards.length,") zamiast filtrowanych (",A.length,")"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:14},children:[e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",background:"rgba(107,114,128,0.04)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",margin:0},children:"Istniejace kontrole"})]}),e.jsx("textarea",{className:"form-control",rows:2,style:{fontSize:12},value:j,onChange:Z=>y(Z.target.value),placeholder:"Opisz istniejace kontrole i zabezpieczenia..."})]}),e.jsxs("div",{style:{borderRadius:8,padding:"10px 14px",background:"rgba(107,114,128,0.04)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",margin:0},children:"Opis konsekwencji"})]}),e.jsx("textarea",{className:"form-control",rows:2,style:{fontSize:12},value:S,onChange:Z=>w(Z.target.value),placeholder:"Opisz potencjalne konsekwencje materializacji ryzyka..."})]})]}),e.jsx(FA,{assetId:a,lookups:t,setLookups:r,threatIds:d,setThreatIds:u,vulnerabilityIds:h,setVulnerabilityIds:f,safeguardIds:p,setSafeguardIds:x})]})}function FA({assetId:t,lookups:r,setLookups:a,threatIds:s,setThreatIds:o,vulnerabilityIds:d,setVulnerabilityIds:u,safeguardIds:h,setSafeguardIds:f}){const[p,x]=m.useState(!1),[j,y]=m.useState([]),[S,w]=m.useState(!1),[b,_]=m.useState(""),[E,C]=m.useState(null),[N,O]=m.useState([]),[Q,G]=m.useState([]),[M,U]=m.useState(!1),R=(t?r.assets.find(z=>z.id===t):null)?.asset_category_id??null,Z=async()=>{w(!0);try{const z=R?`/api/v1/threat-catalog?asset_category_id=${R}`:"/api/v1/threat-catalog",k=await le.get(z);y(k)}catch{y([])}finally{w(!1)}},F=async z=>{U(!0);const[k,I]=await Promise.all([le.get(`/api/v1/suggestions/weaknesses?threat_id=${z}`).catch(D=>(console.warn("Suggestions/weaknesses error:",D),[])),le.get(`/api/v1/suggestions/controls?threat_id=${z}`).catch(D=>(console.warn("Suggestions/controls error:",D),[]))]);O(k),G(I),U(!1)},q=async z=>{const k=r.threats.find(I=>I.name.toLowerCase()===z.name.toLowerCase());if(k){s.includes(k.id)||o([...s,k.id]);return}try{const I=await le.post("/api/v1/threat-catalog",{name:z.name});a(D=>D&&{...D,threats:[...D.threats,I]}),o([...s,I.id])}catch{}},ee=async z=>{const k=r.vulns.find(I=>I.name.toLowerCase()===z.name.toLowerCase());if(k){d.includes(k.id)||u([...d,k.id]);return}try{const I=await le.post("/api/v1/weakness-catalog",{name:z.name});a(D=>D&&{...D,vulns:[...D.vulns,I]}),u([...d,I.id])}catch{}},me=async z=>{const k=r.safeguards.find(I=>I.name.toLowerCase()===z.name.toLowerCase());if(k){h.includes(k.id)||f([...h,k.id]);return}try{const I=await le.post("/api/v1/control-catalog",{name:z.name});a(D=>D&&{...D,safeguards:[...D.safeguards,I]}),f([...h,I.id])}catch{}},W=async()=>{await Promise.all(H.map(z=>ee(z))),await Promise.all(ne.map(z=>me(z)))},J=new Set(d.map(z=>r.vulns.find(k=>k.id===z)?.name?.toLowerCase()).filter(Boolean)),L=new Set(h.map(z=>r.safeguards.find(k=>k.id===z)?.name?.toLowerCase()).filter(Boolean)),H=N.filter(z=>!J.has(z.name.toLowerCase())),ne=Q.filter(z=>!L.has(z.name.toLowerCase())),P=b.length>=2?j.filter(z=>z.ref_id.toLowerCase().includes(b.toLowerCase())||z.name.toLowerCase().includes(b.toLowerCase())).slice(0,10):j.slice(0,10),T={HIGH:"#dc2626",MEDIUM:"#f59e0b",LOW:"#16a34a"};return e.jsxs("div",{style:{marginTop:2},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer",padding:"10px 14px",borderRadius:p?"8px 8px 0 0":8,background:p?"rgba(139,92,246,0.08)":"rgba(139,92,246,0.03)",border:`1px solid ${p?"rgba(139,92,246,0.3)":"rgba(139,92,246,0.12)"}`,borderBottom:p?"1px solid rgba(139,92,246,0.15)":void 0,transition:"all 0.2s"},onClick:()=>{x(!p),!p&&j.length===0&&Z()},children:[e.jsx("div",{style:{width:24,height:24,borderRadius:6,background:"rgba(139,92,246,0.15)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:13},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#8b5cf6"},children:"Katalog Zagrozen"}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Sugestie zagrozen i zabezpieczen z katalogu ISO"})]}),e.jsx("span",{style:{marginLeft:"auto",fontSize:18,color:"var(--text-muted)",lineHeight:1,transform:p?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""})]}),p&&e.jsx("div",{style:{border:"1px solid rgba(139,92,246,0.2)",borderTop:"none",borderRadius:"0 0 8px 8px",padding:16},children:S?e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie Katalog Zagrozen..."}):e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#8b5cf6",marginBottom:8},children:["Wybierz zagrozenie z katalogu",R&&e.jsx("span",{style:{fontWeight:400,color:"var(--text-muted)"},children:" (filtr wg aktywa)"})]}),e.jsx("input",{className:"form-control",style:{fontSize:12,marginBottom:8},placeholder:"Szukaj w Katalog Zagrozen (ref_id lub nazwa)...",value:b,onChange:z=>_(z.target.value)}),e.jsxs("div",{style:{maxHeight:240,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:[P.map(z=>e.jsxs("div",{style:{padding:"7px 10px",fontSize:12,cursor:"pointer",borderBottom:"1px solid var(--border)",background:E?.id===z.id?"rgba(139,92,246,0.1)":"transparent"},onClick:()=>{C(z),F(z.id)},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#8b5cf6",marginRight:6},children:z.ref_id}),z.name]},z.id)),P.length===0&&e.jsx("div",{style:{padding:12,textAlign:"center",fontSize:12,color:"var(--text-muted)"},children:"Brak wynikow"})]}),E&&e.jsxs("button",{type:"button",className:"btn btn-sm",style:{marginTop:8,background:"#dc262620",color:"#dc2626",border:"1px solid #dc262640",fontSize:11},onClick:()=>q(E),children:["+ Zastosuj zagrozenie: ",E.ref_id]})]}),e.jsxs("div",{children:[!E&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",fontSize:12,padding:32},children:"Wybierz zagrozenie z katalogu aby zobaczyc sugestie slabosci i zabezpieczen"}),E&&M&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie sugestii..."}),E&&!M&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"#8b5cf6"},children:["Sugestie dla: ",E.ref_id]}),(H.length>0||ne.length>0)&&e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10,background:"#16a34a20",color:"#16a34a",border:"1px solid #16a34a40"},onClick:W,children:"Zastosuj wszystkie"})]}),e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"#f59e0b",marginBottom:4,marginTop:8},children:["Slabosci (",H.length,")"]}),H.length===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Brak sugestii"}),H.map(z=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:11},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:z.ref_id})," ",z.name]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:10,padding:"1px 5px",borderRadius:3,background:(T[z.relevance??""]??"#666")+"22",color:T[z.relevance??""]??"#666"},children:z.relevance}),e.jsx("button",{type:"button",style:{fontSize:10,cursor:"pointer",color:"#16a34a",background:"none",border:"none",fontWeight:600},onClick:()=>ee(z),children:"+Dodaj"})]})]},z.weakness_id)),e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"#16a34a",marginBottom:4,marginTop:12},children:["Zabezpieczenia (",ne.length,")"]}),ne.length===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Brak sugestii"}),ne.map(z=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:11},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:z.ref_id})," ",z.name]}),e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:10,padding:"1px 5px",borderRadius:3,background:(T[z.effectiveness??""]??"#666")+"22",color:T[z.effectiveness??""]??"#666"},children:z.effectiveness}),e.jsx("button",{type:"button",style:{fontSize:10,cursor:"pointer",color:"#16a34a",background:"none",border:"none",fontWeight:600},onClick:()=>me(z),children:"+Dodaj"})]})]},z.control_id))]})]})]})})]})}function RA({assetId:t,assetName:r,lookups:a,orgTree:s,onSelectAsset:o,onClearAsset:d,onAssetCreated:u}){const[h,f]=m.useState(""),[p,x]=m.useState(""),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b,_]=m.useState(""),[E,C]=m.useState(null),[N,O]=m.useState(null),[Q,G]=m.useState(null),[M,U]=m.useState(""),[A,R]=m.useState(""),[Z,F]=m.useState(null),[q,ee]=m.useState(null),[me,W]=m.useState(""),J=t?a.assets.find(P=>P.id===t):null,L=m.useMemo(()=>{const P=new Map;for(const T of a.assets){const z=T.asset_category_name||T.category_name;z&&P.set(z,(P.get(z)||0)+1)}return[...P.entries()].sort((T,z)=>z[1]-T[1])},[a.assets]),H=h.length>=1||p?a.assets.filter(P=>{if(p&&(P.asset_category_name||P.category_name)!==p)return!1;if(h.length>=1){const T=h.toLowerCase();return P.name.toLowerCase().includes(T)||(P.org_unit_name??"").toLowerCase().includes(T)||(P.owner??"").toLowerCase().includes(T)||(P.category_name??"").toLowerCase().includes(T)||(P.asset_category_name??"").toLowerCase().includes(T)}return!0}).slice(0,20):[],ne=async()=>{if(b){w(!0);try{const P=await le.post("/api/v1/assets",{name:b,asset_type_id:E,category_id:N,org_unit_id:Q,owner:M||null,location:A||null,sensitivity_id:Z,criticality_id:q,description:me||null});u(P),y(!1),f(""),_(""),C(null),O(null),G(null),U(""),R(""),F(null),ee(null),W("")}catch(P){alert("Blad tworzenia aktywa: "+P)}finally{w(!1)}}};return e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2461",label:"Identyfikacja aktywa (ISO 27005 \\u00A78.2)"}),J?e.jsxs("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:14,marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:11},children:"Powiazane aktywo"}),e.jsx("span",{style:{fontWeight:600,fontSize:14},children:J.name})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{color:"var(--red)",fontSize:11},onClick:d,children:"Odlacz"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px 20px",fontSize:12},children:[e.jsx(Gt,{label:"Typ",value:J.asset_type_name}),e.jsx(Gt,{label:"Kategoria",value:J.category_name}),e.jsx(Gt,{label:"Jednostka org.",value:J.org_unit_name}),e.jsx(Gt,{label:"Wlasciciel",value:J.owner}),e.jsx(Gt,{label:"Wrazliwosc",value:J.sensitivity_name}),e.jsx(Gt,{label:"Krytycznosc",value:J.criticality_name}),J.location&&e.jsx(Gt,{label:"Lokalizacja",value:J.location}),J.description&&e.jsxs("div",{style:{gridColumn:"span 2",marginTop:4},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Opis: "}),e.jsx("span",{style:{color:"var(--text-secondary)"},children:J.description})]})]})]}):e.jsxs("div",{children:[!j&&e.jsxs("div",{style:{position:"relative",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[L.length>0&&e.jsxs("select",{className:"form-control",style:{fontSize:11,width:180,padding:"5px 8px"},value:p,onChange:P=>x(P.target.value),children:[e.jsx("option",{value:"",children:"Kategoria CMDB..."}),L.map(([P,T])=>e.jsxs("option",{value:P,children:[P," (",T,")"]},P))]}),e.jsx("div",{style:{flex:1,position:"relative"},children:e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj aktywa po nazwie, jednostce, wlascicielu...",value:h,onChange:P=>f(P.target.value)})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{y(!0),f("")},children:"+ Dodaj nowe"})]}),H.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:260,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:H.map(P=>e.jsxs("div",{style:{padding:"8px 14px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",transition:"background 0.1s"},onClick:()=>{o(P),f("")},onMouseEnter:T=>T.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:T=>T.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500,marginBottom:2},children:P.name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:10},children:[P.asset_category_name&&e.jsx("span",{className:"score-badge",style:{background:(P.asset_category_color||"var(--purple)")+"20",color:P.asset_category_color||"var(--purple)",fontSize:9,padding:"1px 5px"},children:P.asset_category_name}),!P.asset_category_name&&P.category_name&&e.jsx("span",{children:P.category_name}),P.org_unit_name&&e.jsx("span",{children:P.org_unit_name}),P.owner&&e.jsx("span",{children:P.owner}),P.sensitivity_name&&e.jsxs("span",{children:["W: ",P.sensitivity_name]}),P.criticality_name&&e.jsxs("span",{children:["K: ",P.criticality_name]})]})]},P.id))}),h.length>=1&&H.length===0&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,padding:"12px 14px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2,fontSize:12,color:"var(--text-muted)",textAlign:"center"},children:["Brak wynikow. ",e.jsx("span",{style:{color:"var(--blue)",cursor:"pointer",textDecoration:"underline"},onClick:()=>{y(!0),_(h),f("")},children:"Dodaj nowe aktywo"})]})]}),!j&&!r&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Wyszukaj i wybierz aktywo z rejestru lub dodaj nowe"})]}),j&&!J&&e.jsxs("div",{style:{background:"rgba(34,197,94,0.04)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:8,padding:16,marginBottom:14},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13,color:"var(--green)"},children:"Nowe aktywo"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:11},onClick:()=>y(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{className:"form-control",value:b,onChange:P=>_(P.target.value),placeholder:"np. Serwer bazodanowy DB-01"}),!b&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ aktywa"}),e.jsxs("select",{className:"form-control",value:E??"",onChange:P=>C(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.asset_types.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:N??"",onChange:P=>O(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.categories.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:s,value:Q,onChange:G,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:M,onChange:P=>U(P.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{className:"form-control",value:A,onChange:P=>R(P.target.value),placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wrazliwosc"}),e.jsxs("select",{className:"form-control",value:Z??"",onChange:P=>F(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.sensitivities.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{className:"form-control",value:q??"",onChange:P=>ee(P.target.value?Number(P.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),a.criticalities.map(P=>e.jsx("option",{value:P.id,children:P.label},P.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:me,onChange:P=>W(P.target.value),placeholder:"Opcjonalny opis aktywa..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:S||!b,onClick:ne,children:S?"Tworzenie...":"Utworz i powiaz aktywo"})]})]})]})}const BA=[{key:"context",label:"Kontekst",num:""},{key:"asset",label:"Aktywo",num:""},{key:"scenario",label:"Scenariusz",num:""},{key:"treatment",label:"Postepowanie",num:""},{key:"acceptance",label:"Akceptacja",num:""}];function OA({editRisk:t,lookups:r,setLookups:a,orgTree:s,saving:o,onSubmit:d,onCancel:u}){const[h,f]=m.useState("context"),[p,x]=m.useState(t?.org_unit_id??null),[j,y]=m.useState(t?.risk_category_id??null),[S,w]=m.useState(t?.risk_source??""),[b,_]=m.useState(t?.identification_source_id??null),[E,C]=m.useState(t?.asset_id??null),[N,O]=m.useState(t?.asset_category_id??null),[Q,G]=m.useState(t?.asset_name??""),[M,U]=m.useState(t?.sensitivity_id??null),[A,R]=m.useState(t?.criticality_id??null),[Z,F]=m.useState(t?.security_area_id??null),[q,ee]=m.useState(t?.threats?.map(Oe=>Oe.threat_id)??[]),[me,W]=m.useState(t?.vulnerabilities?.map(Oe=>Oe.vulnerability_id)??[]),[J,L]=m.useState(t?.existing_controls??""),[H,ne]=m.useState(t?.consequence_description??""),[P,T]=m.useState(t?.impact_level??2),[z,k]=m.useState(t?.probability_level??2),[I,D]=m.useState(t?.safeguard_rating??.25),[de,he]=m.useState(t?.strategy_id??null),[ie,ve]=m.useState(t?.treatment_plan??""),[je,fe]=m.useState(t?.planned_safeguard_id??null),[_e,Se]=m.useState(t?.treatment_deadline?.slice(0,10)??""),[Ve,be]=m.useState(t?.treatment_resources??""),[oe,Ue]=m.useState(t?.safeguards?.map(Oe=>Oe.safeguard_id)??[]),[Qe]=m.useState(t?.planned_actions??""),[lt,tt]=m.useState(t?.target_impact??t?.impact_level??1),[ht,xt]=m.useState(t?.target_probability??t?.probability_level??1),[qe,Nt]=m.useState(t?.target_safeguard??.95),[st,_t]=m.useState(t?.status_id??null),[zt,It]=m.useState(t?.owner??""),[va,rt]=m.useState(t?.accepted_by??""),[oa,ca]=m.useState(t?.acceptance_justification??""),[ze,et]=m.useState(t?.next_review_date?.slice(0,10)??""),it=Math.exp(P)*z/I,Be=Or(it),at=_l(it),nt=Eu(it),ut=Math.exp(lt)*ht/qe,ta=Or(ut),Pt=_l(ut),Tt=Eu(ut),xe=it>0?(1-ut/it)*100:0,Ie=p&&Q,mt=()=>{Ie&&d({org_unit_id:p,risk_category_id:j,risk_source:S||null,identification_source_id:b,asset_id:E,asset_category_id:N,asset_name:Q,sensitivity_id:M,criticality_id:A,security_area_id:Z,existing_controls:J||null,consequence_description:H||null,impact_level:P,probability_level:z,safeguard_rating:I,strategy_id:de,treatment_plan:ie||null,planned_safeguard_id:je,treatment_deadline:_e||null,treatment_resources:Ve||null,threat_ids:q,vulnerability_ids:me,safeguard_ids:oe,planned_actions:Qe||null,target_impact:lt,target_probability:ht,target_safeguard:qe,residual_risk:Math.round(ut*100)/100,status_id:st,owner:zt||null,accepted_by:va||null,acceptance_justification:oa||null,next_review_date:ze||null})};return e.jsxs("div",{children:[e.jsxs("div",{style:{background:at,border:`1px solid ${Be}`,borderRadius:10,padding:"10px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Be,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Kalkulacja na biezaco"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",P,")  ",z," / ",I," = ",e.jsx("strong",{style:{color:Be},children:it.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Be},children:it.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Be}30`,color:Be,fontSize:12},children:nt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:20},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(Oe=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:Oe},Oe)),[3,2,1].map(Oe=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",Oe]}),[1,2,3].map(ct=>{const At=Math.exp(Oe)*ct/I,za=Oe===P&&ct===z;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:za?700:400,background:_l(At),color:Or(At),border:za?`2px solid ${Or(At)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{T(Oe),k(ct)},children:At.toFixed(0)},`${Oe}-${ct}`)})]},`row-${Oe}`))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginTop:4},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}].map(Oe=>{const ct=Math.abs(I-Oe.value)<.01;return e.jsxs("div",{style:{padding:"6px 10px",borderRadius:6,fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",gap:8,background:ct?`${Oe.color}18`:"transparent",border:ct?`2px solid ${Oe.color}`:"2px solid var(--border)",color:ct?Oe.color:"var(--text-muted)",fontWeight:ct?600:400,transition:"all 0.15s"},onClick:()=>D(Oe.value),children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:ct?Oe.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:30},children:Oe.value.toFixed(2)}),e.jsx("span",{children:Oe.label})]},Oe.value)})]})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20,overflowX:"auto"},children:BA.map(Oe=>e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"8px 6px",minWidth:100,background:h===Oe.key?"var(--blue-dim)":"transparent",borderBottom:h===Oe.key?"2px solid var(--blue)":"2px solid var(--border)",color:h===Oe.key?"var(--blue)":"var(--text-muted)",fontWeight:h===Oe.key?600:400,fontSize:12,cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onClick:()=>f(Oe.key),children:[e.jsx("span",{style:{marginRight:4},children:Oe.num}),Oe.label]},Oe.key))}),h==="context"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2460",label:"Kontekst (ISO 31000 \\u00A75.3)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:s,value:p,onChange:x,placeholder:"Wybierz...",allowClear:!1}),!p&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria ryzyka"}),e.jsxs("select",{className:"form-control",value:j??"",onChange:Oe=>y(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.risk_categories.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zrodlo identyfikacji"}),e.jsxs("select",{className:"form-control",value:b??"",onChange:Oe=>_(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.identification_sources.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Zrodlo ryzyka"}),e.jsx("textarea",{className:"form-control",rows:2,value:S,onChange:Oe=>w(Oe.target.value),placeholder:"Opisz zrodlo lub kontekst ryzyka..."})]})]})]}),h==="asset"&&e.jsx(RA,{assetId:E,assetName:Q,lookups:r,orgTree:s,onSelectAsset:Oe=>{C(Oe.id),G(Oe.name),O(Oe.category_id),U(Oe.sensitivity_id),R(Oe.criticality_id)},onClearAsset:()=>{C(null),G(""),O(null),U(null),R(null)},onAssetCreated:Oe=>{C(Oe.id),G(Oe.name),O(Oe.category_id),U(Oe.sensitivity_id),R(Oe.criticality_id),le.get("/api/v1/assets").then(ct=>{a(At=>At&&{...At,assets:ct})}).catch(ct=>console.error("Asset refresh failed:",ct))}}),h==="scenario"&&e.jsx(EA,{lookups:r,setLookups:a,assetId:E,securityAreaId:Z,setSecurityAreaId:F,threatIds:q,setThreatIds:ee,vulnerabilityIds:me,setVulnerabilityIds:W,safeguardIds:oe,setSafeguardIds:Ue,existingControls:J,setExistingControls:L,consequenceDescription:H,setConsequenceDescription:ne}),h==="treatment"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2463",label:"Postepowanie z ryzykiem (ISO 27005 \\u00A78.5)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Strategia"}),e.jsxs("select",{className:"form-control",value:de??"",onChange:Oe=>he(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.strategies.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:_e,onChange:Oe=>Se(Oe.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Plan postepowania z ryzykiem"}),e.jsx("textarea",{className:"form-control",rows:3,value:ie,onChange:Oe=>ve(Oe.target.value),placeholder:"Opisz plan postepowania z ryzykiem..."})]}),e.jsx(NA,{lookups:r,setLookups:a,assetId:E,plannedSafeguardId:je,setPlannedSafeguardId:fe}),oe.length>0&&e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{color:"var(--text-muted)"},children:"Zabezpieczenia przypisane do ryzyka (z sekcji Scenariusz)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,padding:"8px 0"},children:oe.map(Oe=>{const ct=r.safeguards.find(At=>At.id===Oe);return e.jsx("span",{style:{background:"var(--green-dim)",color:"var(--green)",borderRadius:14,padding:"3px 10px",fontSize:12,fontWeight:500,border:"1px solid rgba(34,197,94,0.3)"},children:ct?.name??`#${Oe}`},Oe)})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Zasoby wymagane"}),e.jsx("textarea",{className:"form-control",rows:2,value:Ve,onChange:Oe=>be(Oe.target.value),placeholder:"Opisz wymagane zasoby (budzet, ludzie, narzedzia)..."})]})]}),e.jsx(AA,{riskId:t?.id??null,existingLinks:(t?.linked_actions??[]).map(Oe=>({action_id:Oe.action_id,title:Oe.title})),lookups:r,orgTree:s,strategyId:de}),e.jsxs("div",{style:{background:Pt,border:`1px solid ${ta}`,borderRadius:10,padding:"12px 20px",marginTop:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:ta,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ryzyko rezydualne (docelowe)"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R",e.jsx("sub",{children:"res"})," = EXP(",lt,")  ",ht," / ",qe," = ",e.jsx("strong",{style:{color:ta},children:ut.toFixed(1)}),xe>0&&e.jsxs("span",{style:{marginLeft:8,color:"var(--green)"},children:["(-",xe.toFixed(0),"%)"]})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:ta},children:ut.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${ta}30`,color:ta,fontSize:11},children:Tt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:10},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowy W"}),e.jsxs("select",{className:"form-control",value:lt,onChange:Oe=>tt(Number(Oe.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niski"}),e.jsx("option",{value:"2",children:"2 -- Sredni"}),e.jsx("option",{value:"3",children:"3 -- Wysoki"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowe P"}),e.jsxs("select",{className:"form-control",value:ht,onChange:Oe=>xt(Number(Oe.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niskie"}),e.jsx("option",{value:"2",children:"2 -- Srednie"}),e.jsx("option",{value:"3",children:"3 -- Wysokie"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{style:{fontSize:11},children:"Docelowe Z"}),e.jsxs("select",{className:"form-control",value:qe,onChange:Oe=>Nt(Number(Oe.target.value)),children:[e.jsx("option",{value:"0.10",children:"0,10 -- Brak"}),e.jsx("option",{value:"0.25",children:"0,25 -- Czesciowe"}),e.jsx("option",{value:"0.70",children:"0,70 -- Dobre"}),e.jsx("option",{value:"0.95",children:"0,95 -- Skuteczne"})]})]})]})]})]}),h==="acceptance"&&e.jsxs("div",{children:[e.jsx(Sr,{number:"\\u2464",label:"Akceptacja i monitorowanie (ISO 27005 \\u00A78.6/\\u00A79)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:st??"",onChange:Oe=>_t(Oe.target.value?Number(Oe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.statuses.map(Oe=>e.jsx("option",{value:Oe.id,children:Oe.label},Oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel ryzyka"}),e.jsx("input",{className:"form-control",value:zt,onChange:Oe=>It(Oe.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zaakceptowane przez"}),e.jsx("input",{className:"form-control",value:va,onChange:Oe=>rt(Oe.target.value),placeholder:"Imie i nazwisko akceptujacego"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data nastepnego przegladu"}),e.jsx("input",{type:"date",className:"form-control",value:ze,onChange:Oe=>et(Oe.target.value)})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Uzasadnienie akceptacji"}),e.jsx("textarea",{className:"form-control",rows:2,value:oa,onChange:Oe=>ca(Oe.target.value),placeholder:"Uzasadnienie akceptacji poziomu ryzyka..."})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:o||!Ie,onClick:mt,children:o?"Zapisywanie...":t?"Zapisz zmiany":"Zapisz ryzyko"})]})]})}function DA(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(!1),[u,h]=m.useState(null),[f,p]=m.useState(!1),x=()=>{le.get("/api/v1/risk-reviews/overdue").then(r).catch(()=>{}).finally(()=>s(!1))};m.useEffect(()=>{x()},[]);const j=S=>{h(S),d(!0)},y=async S=>{if(S.preventDefault(),!u)return;p(!0);const w=new FormData(S.currentTarget),b={risk_id:u.risk_id,notes:w.get("notes")||null};try{await le.post("/api/v1/risk-reviews",b),d(!1),s(!0),x()}catch(_){alert("Bd zapisu: "+_)}finally{p(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-3",children:[e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--red)"},children:t.length||""}),e.jsx("div",{className:"label",children:"Przeterminowane przegldy"})]}),e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--yellow)"},children:""}),e.jsx("div",{className:"label",children:"Do przegldu w tym miesicu"})]}),e.jsxs("div",{className:"card kpi",children:[e.jsx("div",{className:"value",style:{color:"var(--green)"},children:""}),e.jsx("div",{className:"label",children:"Aktualne"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-title",children:["Ryzyka Wymagajce Przegldu ",e.jsx("span",{style:{color:"var(--red)"},children:"(przeterminowane >90 dni)"})]}),a?e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"adowanie..."}):t.length===0?e.jsx("p",{style:{fontSize:13,color:"var(--text-muted)"},children:"Brak przeterminowanych przegldw lub brak poczenia z API."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Aktywo"}),e.jsx("th",{children:"Pion"}),e.jsx("th",{children:"Ostatni przegld"}),e.jsx("th",{children:"Dni od przegldu"}),e.jsx("th",{children:"Akcja"})]})}),e.jsx("tbody",{children:t.map(S=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:S.code}),e.jsx("td",{children:S.asset_name}),e.jsx("td",{children:S.org_unit_name}),e.jsx("td",{children:S.last_review_at??"Nigdy"}),e.jsx("td",{children:e.jsxs("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:[S.days_since_review," dni"]})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",onClick:()=>j(S),children:" Przejrzyj"})})]},S.risk_id))})]})]}),e.jsx(gt,{open:o,onClose:()=>d(!1),title:`Przegld: ${u?.asset_name??""}`,children:u&&e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{style:{marginBottom:16,fontSize:13,color:"var(--text-secondary)"},children:[e.jsxs("p",{children:["Ryzyko: ",e.jsx("strong",{children:u.code}),"  ",u.asset_name]}),e.jsxs("p",{children:["Pion: ",u.org_unit_name]}),e.jsxs("p",{children:["Ostatni przegld: ",u.last_review_at??"Nigdy"," (",u.days_since_review," dni temu)"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki z przegldu"}),e.jsx("textarea",{name:"notes",className:"form-control",rows:4,placeholder:"Opisz wynik przegldu ryzyka..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>d(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:f,children:f?"Zapisywanie...":"Zarejestruj przegld"})]})]})})]})}function LA(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(null),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(!1),[_,E]=m.useState(null),[C,N]=m.useState(null),[O,Q]=m.useState(!1),[G,M]=m.useState(null),[U,A]=m.useState(!1),R=async()=>{try{const T=await le.get("/api/v1/dictionaries");r(T),d(null)}catch(T){d(String(T))}finally{s(!1)}};m.useEffect(()=>{R()},[]);const Z=async T=>{p(!0),j(!1),S(null);try{const z=await le.get(`/api/v1/dictionaries/${T.code}/entries?include_archived=true`);h(z)}catch{h({id:T.id,code:T.code,name:T.name,description:T.description,is_system:T.is_system,entries:[]})}finally{p(!1)}},F=async T=>{try{const z=await le.get(`/api/v1/dictionaries/${T}/entries?include_archived=true`);h(z),R()}catch{}},q=async T=>{if(T.preventDefault(),!u)return;b(!0);const z=new FormData(T.currentTarget),k={label:z.get("label"),code:z.get("code")||void 0,description:z.get("description")||void 0,numeric_value:z.get("numeric_value")?Number(z.get("numeric_value")):void 0,color:z.get("color")||void 0,sort_order:z.get("sort_order")?Number(z.get("sort_order")):0};try{await le.post(`/api/v1/dictionaries/${u.code}/entries`,k),j(!1),await F(u.code)}catch(I){alert("Blad zapisu: "+I)}finally{b(!1)}},ee=async T=>{if(T.preventDefault(),!u||!y)return;b(!0);const z=new FormData(T.currentTarget),k={label:z.get("label"),code:z.get("code")||null,description:z.get("description")||null,numeric_value:z.get("numeric_value")?Number(z.get("numeric_value")):null,color:z.get("color")||null,sort_order:z.get("sort_order")?Number(z.get("sort_order")):0};try{await le.put(`/api/v1/dictionaries/entries/${y.id}`,k),S(null),await F(u.code)}catch(I){alert("Blad zapisu: "+I)}finally{b(!1)}},me=async T=>{E(T),M(null),Q(!0);try{const z=await le.get(`/api/v1/dictionaries/entries/${T.id}/usage`);N(z)}catch{N({entry_id:T.id,entry_label:T.label,total_references:0,details:[]})}finally{Q(!1)}},W=async()=>{if(!(!u||!_)){A(!0);try{C&&C.total_references>0&&G?await le.post(`/api/v1/dictionaries/entries/${_.id}/reassign`,{target_id:G}):await le.patch(`/api/v1/dictionaries/entries/${_.id}/archive`,{}),E(null),N(null),await F(u.code)}catch(T){alert("Blad: "+T)}finally{A(!1)}}},J=async T=>{if(u)try{await le.put(`/api/v1/dictionaries/entries/${T.id}`,{is_active:!0}),await F(u.code)}catch(z){alert("Blad: "+z)}},L=async(T,z)=>{if(!u)return;const k=u.entries.filter(he=>he.is_active).sort((he,ie)=>he.sort_order-ie.sort_order),I=k.findIndex(he=>he.id===T.id);if(I<0)return;const D=z==="up"?I-1:I+1;if(D<0||D>=k.length)return;const de=k.map((he,ie)=>ie===I?{id:he.id,sort_order:k[D].sort_order}:ie===D?{id:he.id,sort_order:k[I].sort_order}:{id:he.id,sort_order:he.sort_order});try{await le.put("/api/v1/dictionaries/entries/reorder",{items:de}),await F(u.code)}catch(he){alert("Blad: "+he)}};if(a)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:256},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Ladowanie slownikow..."})});if(o)return e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{color:"var(--red)",fontSize:13,marginBottom:8},children:"Nie udalo sie zaladowac slownikow"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace",wordBreak:"break-all"},children:o})]});const H=u?.entries.filter(T=>T.is_active).sort((T,z)=>T.sort_order-z.sort_order)??[],ne=u?.entries.filter(T=>!T.is_active)??[],P=H.filter(T=>T.id!==_?.id);return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-3",children:[t.map(T=>e.jsxs("div",{className:"card clickable",onClick:()=>Z(T),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:T.name}),e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:T.entry_count})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Kod: ",e.jsx("code",{style:{color:"var(--text-muted)"},children:T.code})]}),T.is_system&&e.jsx("div",{style:{marginTop:8,fontSize:10,color:"var(--text-muted)"},children:"Slownik systemowy"})]},T.id)),t.length===0&&e.jsx("div",{style:{gridColumn:"span 3",textAlign:"center",color:"var(--text-muted)",fontSize:13,padding:"48px 0"},children:"Brak slownikow w systemie."})]}),e.jsx(gt,{open:!!u,onClose:()=>{h(null),S(null)},title:u?.name??"Slownik",wide:!0,children:f?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie pozycji..."}):u&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["Kod: ",e.jsx("code",{style:{color:"var(--blue)"},children:u.code}),"  ",H.length," aktywnych",ne.length>0&&e.jsxs("span",{children:["  ",ne.length," archiwalnych"]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{j(!x),S(null)},children:x?"Anuluj":"+ Dodaj pozycje"})]}),x&&e.jsx(yv,{onSubmit:q,saving:w,onCancel:()=>j(!1)}),y&&e.jsx(yv,{entry:y,onSubmit:ee,saving:w,onCancel:()=>S(null)}),e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:60},children:"Kol."}),e.jsx("th",{children:"Etykieta"}),e.jsx("th",{children:"Kod"}),e.jsx("th",{children:"Wartosc"}),e.jsx("th",{children:"Kolor"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{width:200},children:"Akcje"})]})}),e.jsx("tbody",{children:H.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",color:"var(--text-muted)",fontSize:13,padding:24},children:"Brak pozycji w slowniku"})}):H.map((T,z)=>e.jsxs("tr",{style:{background:y?.id===T.id?"rgba(59,130,246,0.08)":void 0},children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:2},children:[e.jsx("button",{className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},disabled:z===0,onClick:()=>L(T,"up"),title:"W gore",children:""}),e.jsx("button",{className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},disabled:z===H.length-1,onClick:()=>L(T,"down"),title:"W dol",children:""}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)",marginLeft:4},children:T.sort_order})]})}),e.jsx("td",{style:{fontWeight:500},children:T.label}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.code??""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:T.numeric_value??""}),e.jsx("td",{children:T.color?e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:14,height:14,borderRadius:3,background:T.color,display:"inline-block",border:"1px solid rgba(255,255,255,0.1)"}}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace"},children:T.color})]}):""}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:"Aktywny"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{S(T),j(!1)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>me(T),children:"Archiwizuj"})]})})]},T.id))})]}),ne.length>0&&e.jsxs("div",{style:{marginTop:20},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:"Archiwalne pozycje"}),e.jsx("table",{className:"data-table",children:e.jsx("tbody",{children:ne.map(T=>e.jsxs("tr",{style:{opacity:.5},children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.id}),e.jsx("td",{children:T.label}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.code??""}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)"},children:"Archiwalny"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",onClick:()=>J(T),children:"Przywroc"})})]},T.id))})})]})]})}),e.jsx(gt,{open:!!_,onClose:()=>{E(null),N(null)},title:`Archiwizacja: ${_?.label??""}`,children:O?e.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:"Sprawdzanie powiazanych rekordow..."}):C&&C.total_references===0?e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:13,marginBottom:16},children:["Pozycja ",e.jsxs("strong",{children:['"',_?.label,'"']})," nie jest uzywana w zadnych rekordach. Mozna ja bezpiecznie zarchiwizowac."]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>{E(null),N(null)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:U,children:U?"Archiwizowanie...":"Archiwizuj"})]})]}):C?e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(245,158,11,0.08)",border:"1px solid rgba(245,158,11,0.3)",borderRadius:8,padding:14,marginBottom:16},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--orange)",marginBottom:6},children:["Pozycja jest uzywana w ",C.total_references," rekordach"]}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:"Przed archiwizacja musisz przepiac referencje na inna pozycje tego samego slownika. Wszystkie powiazane rekordy zostana automatycznie zaktualizowane."})]}),e.jsxs("table",{className:"data-table",style:{marginBottom:16},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Modul"}),e.jsx("th",{children:"Pole"}),e.jsx("th",{style:{textAlign:"right"},children:"Liczba rekordow"})]})}),e.jsx("tbody",{children:C.details.map((T,z)=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:13},children:T.table}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.column}),e.jsx("td",{style:{textAlign:"right",fontWeight:600},children:T.count})]},z))})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:4,display:"block"},children:"Przepnij wszystkie referencje na:"}),e.jsxs("select",{className:"form-control",value:G??"",onChange:T=>M(T.target.value?Number(T.target.value):null),children:[e.jsx("option",{value:"",children:" wybierz docelowa pozycje "}),P.map(T=>e.jsxs("option",{value:T.id,children:[T.label,T.code?` (${T.code})`:""]},T.id))]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>{E(null),N(null)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:U||!G,title:G?void 0:"Wybierz docelowa pozycje",children:U?"Przenoszenie...":`Przepnij (${C.total_references}) i archiwizuj`})]})]}):null})]})}function yv({entry:t,onSubmit:r,saving:a,onCancel:s}){return e.jsxs("form",{onSubmit:r,style:{background:"var(--bg-inset)",borderRadius:8,padding:16,marginBottom:16,border:"1px solid var(--border)"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"var(--text-secondary)",marginBottom:10},children:t?`Edycja: ${t.label}`:"Nowa pozycja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta *"}),e.jsx("input",{name:"label",className:"form-control",required:!0,defaultValue:t?.label??"",placeholder:"np. Wysoki"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod"}),e.jsx("input",{name:"code",className:"form-control",defaultValue:t?.code??"",placeholder:"np. high"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wartosc numeryczna"}),e.jsx("input",{name:"numeric_value",type:"number",step:"any",className:"form-control",defaultValue:t?.numeric_value??"",placeholder:"np. 3"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("input",{name:"color",className:"form-control",defaultValue:t?.color??"",placeholder:"np. #ff0000"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc sortowania"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:t?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("input",{name:"description",className:"form-control",defaultValue:t?.description??"",placeholder:"Opcjonalny opis"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:s,children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:a,children:a?"Zapisywanie...":t?"Zapisz zmiany":"Dodaj"})]})]})}function vv(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function MA(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function $d(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("wysok")||r.includes("high")||r.includes("krytycz")?"var(--red)":r.includes("redni")||r.includes("medium")?"var(--orange)":"var(--green)"}function IA(){const t=on(),[r,a]=m.useState([]),[s,o]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(null),[b,_]=m.useState("info"),[E,C]=m.useState([]),[N,O]=m.useState(!1),[Q,G]=m.useState(!1),M=[{key:"id",header:"ID"},{key:"name",header:"Nazwa"},{key:"asset_type_name",header:"Typ",format:z=>z.asset_type_name??""},{key:"category_name",header:"Kategoria",format:z=>z.category_name??""},{key:"org_unit_name",header:"Jednostka org.",format:z=>z.org_unit_name??""},{key:"owner",header:"Waciciel",format:z=>z.owner??""},{key:"criticality_name",header:"Krytyczno",format:z=>z.criticality_name??""},{key:"risk_count",header:"Ryzyka",format:z=>String(z.risk_count)},{key:"sensitivity_name",header:"Wraliwo",format:z=>z.sensitivity_name??"",defaultVisible:!1},{key:"parent_name",header:"Nadrzdne aktywo",format:z=>z.parent_name??"",defaultVisible:!1},{key:"location",header:"Lokalizacja",format:z=>z.location??"",defaultVisible:!1},{key:"description",header:"Opis",format:z=>z.description??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:z=>z.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:z=>z.updated_at?.slice(0,10)??"",defaultVisible:!1}],{visible:U,toggle:A}=da(M,"assets"),R=Aa({data:r,storageKey:"assets",defaultSort:"name"}),[Z,F]=m.useState([]),q=()=>{le.get("/api/v1/assets").then(z=>{a(z)}).catch(()=>{}).finally(()=>o(!1))};m.useEffect(()=>{q(),le.get("/api/v1/org-units/tree").then(F).catch(()=>{})},[]);const ee=m.useMemo(()=>Cl(Z),[Z]),me=m.useCallback(z=>{O(!0),le.get(`/api/v1/exceptions?asset_id=${z}`).then(C).catch(()=>C([])).finally(()=>O(!1))},[]);m.useEffect(()=>{S?(me(S.id),_("info")):C([])},[S?.id]);const W=async()=>{if(j)return j;const[z,k]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),I=async je=>{try{return(await le.get(`/api/v1/dictionaries/${je}/entries`)).entries.filter(_e=>_e.is_active).map(_e=>({id:_e.id,label:_e.label}))}catch{return[]}},[D,de,he,ie]=await Promise.all([I("asset_type"),I("asset_category"),I("sensitivity"),I("criticality")]),ve={orgUnits:z,assets:k,assetTypes:D,categories:de,sensitivities:he,criticalities:ie};return y(ve),ve},J=async()=>{await W(),f(null),u(!0)},L=async z=>{await W(),f(z),u(!0)},H=async z=>{z.preventDefault(),x(!0);const k=new FormData(z.currentTarget),I={name:k.get("name"),asset_type_id:k.get("asset_type_id")?Number(k.get("asset_type_id")):null,category_id:k.get("category_id")?Number(k.get("category_id")):null,org_unit_id:k.get("org_unit_id")?Number(k.get("org_unit_id")):null,parent_id:k.get("parent_id")?Number(k.get("parent_id")):null,owner:k.get("owner")||null,description:k.get("description")||null,location:k.get("location")||null,sensitivity_id:k.get("sensitivity_id")?Number(k.get("sensitivity_id")):null,criticality_id:k.get("criticality_id")?Number(k.get("criticality_id")):null};try{if(h){const D=await le.put(`/api/v1/assets/${h.id}`,I);w(D)}else await le.post("/api/v1/assets",I);u(!1),f(null),y(null),o(!0),q()}catch(D){alert("Bd zapisu: "+D)}finally{x(!1)}},ne=async z=>{if(confirm(`Archiwizowa aktyw "${z.name}"?`))try{await le.delete(`/api/v1/assets/${z.id}`),w(null),o(!0),q()}catch(k){alert("Bd: "+k)}},P=[...new Map(r.filter(z=>z.asset_type_id).map(z=>[z.asset_type_id,{id:z.asset_type_id,name:z.asset_type_name}])).values()],T=[...new Map(r.filter(z=>z.org_unit_id).map(z=>[z.org_unit_id,{id:z.org_unit_id,name:z.org_unit_name}])).values()];return e.jsxs("div",{children:[e.jsx(Ia,{cards:[{label:"Aktywnych aktyww",value:R.filtered.filter(z=>z.is_active).length,total:r.filter(z=>z.is_active).length,color:"var(--blue)"},{label:"Z przypisanymi ryzykami",value:R.filtered.filter(z=>z.risk_count>0).length,total:r.filter(z=>z.risk_count>0).length,color:"var(--orange)"},{label:"Typw aktyww",value:new Set(R.filtered.filter(z=>z.asset_type_id).map(z=>z.asset_type_id)).size,total:P.length,color:"var(--purple)"},{label:"Jednostek organizacyjnych",value:new Set(R.filtered.filter(z=>z.org_unit_id).map(z=>z.org_unit_id)).size,total:T.length,color:"var(--cyan)"}],isFiltered:R.filteredCount!==R.totalCount}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"aktyww",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj aktyww...",showFilters:Q,onToggleFilters:()=>G(z=>!z),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:M,visibleColumns:U,onToggleColumn:A,data:R.filtered,exportFilename:"aktywa",primaryLabel:"Dodaj aktyw",onPrimaryAction:J}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:S?"1fr 380px":"1fr",gap:14},children:[e.jsx(Ea,{columns:M,visibleColumns:U,data:R.pageData,rowKey:z=>z.id,selectedKey:S?.id??null,onRowClick:z=>w(S?.id===z.id?null:z),sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:Q,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:s,emptyMessage:"Brak aktyww w systemie.",emptyFilteredMessage:"Brak aktyww pasujcych do filtrw.",renderCell:(z,k)=>{if(k==="id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:z.id});if(k==="name")return e.jsx("span",{style:{fontWeight:500},children:z.name});if(k==="asset_type_name")return z.asset_type_name?e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)"},children:z.asset_type_name}):"";if(k==="category_name")return z.category_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:z.category_name}):"";if(k==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:(z.org_unit_id?ee.get(z.org_unit_id):null)??z.org_unit_name??""});if(k==="criticality_name")return z.criticality_name?e.jsx("span",{className:"score-badge",style:{background:$d(z.criticality_name)==="var(--red)"?"var(--red-dim)":$d(z.criticality_name)==="var(--orange)"?"var(--orange-dim)":"var(--green-dim)",color:$d(z.criticality_name)},children:z.criticality_name}):""}}),S&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy aktywa"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>w(null),children:""})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--text-primary)"},children:S.name}),S.asset_type_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)",fontSize:12,marginTop:6},children:S.asset_type_name})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"info",label:"Informacje"},{key:"exceptions",label:`Wyjatki (${E.length})`}].map(z=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"6px 10px",background:b===z.key?"var(--blue-dim)":"transparent",borderBottom:b===z.key?"2px solid var(--blue)":"2px solid var(--border)",color:b===z.key?"var(--blue)":"var(--text-muted)",fontWeight:b===z.key?600:400,fontSize:12,cursor:"pointer",transition:"all 0.2s"},onClick:()=>_(z.key),children:z.label},z.key))}),b==="info"&&e.jsx(e.Fragment,{children:e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"ID"}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["A-",S.id]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Kategoria"}),e.jsx("span",{children:S.category_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Jednostka org."}),e.jsx("span",{style:{fontSize:11},children:(S.org_unit_id?ee.get(S.org_unit_id):null)??S.org_unit_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Wlasciciel"}),e.jsx("span",{children:S.owner??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Lokalizacja"}),e.jsx("span",{children:S.location??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Wrazliwosc"}),e.jsx("span",{children:S.sensitivity_name??""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Krytycznosc"}),e.jsx("span",{style:{fontWeight:500,color:$d(S.criticality_name)},children:S.criticality_name??""})]}),S.parent_name&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Nadrzedny aktyw"}),e.jsx("span",{children:S.parent_name})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Powiazane ryzyka"}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:S.risk_count>0?"var(--red)":"var(--text-muted)",cursor:S.risk_count>0?"pointer":"default"},onClick:()=>{S.risk_count>0&&t(`/risks?asset=${S.id}`)},children:S.risk_count})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Utworzono"}),e.jsx("span",{children:S.created_at?.slice(0,10)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Zaktualizowano"}),e.jsx("span",{children:S.updated_at?.slice(0,10)})]}),S.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:S.description})]})]})}),b==="exceptions"&&e.jsx("div",{children:N?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie wyjatkow..."}):E.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zarejestrowanych wyjatkow dla tego aktywa."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:E.map(z=>{const k=z.risk_score??0,I=z.expiry_date?new Date(z.expiry_date)<new Date:!1;return e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,background:"var(--bg-inset)",border:"1px solid var(--border)",borderLeft:z.risk_score!=null?`3px solid ${vv(k)}`:"3px solid var(--border)",cursor:"pointer"},onClick:()=>t(`/exceptions?highlight=${z.id}`),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:z.ref_id}),z.status_name&&e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:z.status_name})]}),e.jsx("div",{style:{fontSize:12,fontWeight:500,marginBottom:4},children:z.title}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11},children:[z.risk_score!=null?e.jsxs("span",{className:"score-badge",style:{background:MA(k),color:vv(k),fontSize:10},children:["R: ",k.toFixed(1)]}):e.jsx("span",{}),e.jsx("span",{style:{color:I?"var(--red)":"var(--text-muted)",fontWeight:I?600:400},children:I?"WYGASLY":`do ${z.expiry_date}`})]})]},z.id)})})}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>L(S),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>ne(S),children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:d,onClose:()=>{u(!1),f(null)},title:h?`Edytuj aktyw: ${h.name}`:"Dodaj aktyw",wide:!0,children:j?e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:h?.name??"",placeholder:"np. Serwer bazodanowy DB-01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ aktywa"}),e.jsxs("select",{name:"asset_type_id",className:"form-control",defaultValue:h?.asset_type_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.assetTypes.map(z=>e.jsx("option",{value:z.id,children:z.label},z.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{name:"category_id",className:"form-control",defaultValue:h?.category_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.categories.map(z=>e.jsx("option",{value:z.id,children:z.label},z.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:j.orgUnits,value:h?.org_unit_id??null,onChange:z=>{const k=document.querySelector('input[name="org_unit_id"]');k&&(k.value=z?String(z):"")},placeholder:"Wybierz...",allowClear:!0}),e.jsx("input",{type:"hidden",name:"org_unit_id",defaultValue:h?.org_unit_id??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nadrzdny aktyw"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:h?.parent_id??"",children:[e.jsx("option",{value:"",children:"Brak (gwny)"}),j.assets.filter(z=>!h||z.id!==h.id).map(z=>e.jsx("option",{value:z.id,children:z.name},z.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:h?.owner??"",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{name:"location",className:"form-control",defaultValue:h?.location??"",placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wraliwo"}),e.jsxs("select",{name:"sensitivity_id",className:"form-control",defaultValue:h?.sensitivity_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.sensitivities.map(z=>e.jsx("option",{value:z.id,children:z.label},z.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytyczno"}),e.jsxs("select",{name:"criticality_id",className:"form-control",defaultValue:h?.criticality_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),j.criticalities.map(z=>e.jsx("option",{value:z.id,children:z.label},z.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:3,defaultValue:h?.description??"",placeholder:"Opcjonalny opis aktywa..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{u(!1),f(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Zapisywanie...":h?"Zapisz zmiany":"Dodaj aktyw"})]})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie danych formularza..."})})]})}const PA={HardDrive:"",Server:"",Monitor:"",Laptop:"",Smartphone:"",Printer:"",Database:"",Network:"",Globe:"",Router:"",Shield:"",Code:"",Layers:"",AppWindow:"",Cloud:"",Settings:"",Users:"",User:"",UsersGroup:"",Briefcase:"",FileText:"",File:"",Table:"",Key:"",Building:"",MapPin:"",Door:"",Workflow:"",GitBranch:"",Headphones:""};function WA(t){return t?PA[t]??"":""}function mb({node:t,depth:r,selectedId:a,onSelect:s,expandedIds:o,toggleExpand:d}){const u=t.children.length>0,h=o.has(t.id),f=a===t.id,p=t.is_abstract;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>{u&&d(t.id),s(t)},style:{display:"flex",alignItems:"center",gap:6,padding:"5px 8px",paddingLeft:r*16+8,cursor:"pointer",background:f?"var(--blue-dim)":"transparent",borderLeft:f?"3px solid var(--blue)":"3px solid transparent",fontSize:12,transition:"all 0.15s",color:f?"var(--blue)":"var(--text-primary)",fontWeight:f||p?600:400,whiteSpace:"nowrap",overflow:"hidden"},onMouseEnter:x=>{f||(x.currentTarget.style.background="rgba(255,255,255,0.03)")},onMouseLeave:x=>{f||(x.currentTarget.style.background="transparent")},children:[u?e.jsx("span",{style:{fontSize:8,width:12,textAlign:"center",color:"var(--text-muted)",userSelect:"none",flexShrink:0,transition:"transform 0.15s",transform:h?"rotate(90deg)":"rotate(0deg)"},children:""}):e.jsx("span",{style:{width:12,flexShrink:0}}),e.jsx("span",{style:{flexShrink:0,fontSize:13},children:WA(t.icon)}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",flex:1},children:t.name}),t.asset_count>0&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",background:"rgba(255,255,255,0.05)",borderRadius:8,padding:"1px 6px",flexShrink:0,fontFamily:"'JetBrains Mono',monospace"},children:t.asset_count})]}),h&&u&&t.children.map(x=>e.jsx(mb,{node:x,depth:r+1,selectedId:a,onSelect:s,expandedIds:o,toggleExpand:d},x.id))]})}function pb({tree:t,selectedId:r,onSelect:a,loading:s}){const[o,d]=m.useState(()=>new Set(t.map(j=>j.id))),[u,h]=m.useState("");m.useEffect(()=>{d(new Set(t.map(j=>j.id)))},[t]);const f=j=>{d(y=>{const S=new Set(y);return S.has(j)?S.delete(j):S.add(j),S})},p=u?gb(t,u.toLowerCase()):t,x=xb(t);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",borderRight:"1px solid var(--border)",background:"var(--bg-card)",minWidth:220,maxWidth:280,width:250},children:[e.jsxs("div",{style:{padding:"12px 12px 8px",borderBottom:"1px solid var(--border)"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:1,color:"var(--text-muted)",marginBottom:8},children:"Kategorie Aktywow"}),e.jsx("input",{type:"text",value:u,onChange:j=>h(j.target.value),placeholder:"Szukaj kategorii...",style:{width:"100%",padding:"5px 8px",fontSize:11,background:"var(--bg-input, var(--bg-main))",border:"1px solid var(--border)",borderRadius:5,color:"var(--text-primary)",outline:"none"}})]}),e.jsxs("div",{onClick:()=>a(null),style:{display:"flex",alignItems:"center",gap:6,padding:"7px 12px",cursor:"pointer",fontSize:12,background:r===null?"var(--blue-dim)":"transparent",borderLeft:r===null?"3px solid var(--blue)":"3px solid transparent",color:r===null?"var(--blue)":"var(--text-primary)",fontWeight:r===null?600:500,borderBottom:"1px solid var(--border)"},onMouseEnter:j=>{r!==null&&(j.currentTarget.style.background="rgba(255,255,255,0.03)")},onMouseLeave:j=>{r!==null&&(j.currentTarget.style.background="transparent")},children:[e.jsx("span",{style:{fontSize:13},children:""}),e.jsx("span",{style:{flex:1},children:"Wszystkie aktywa"}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:x})]}),e.jsx("div",{style:{flex:1,overflowY:"auto",padding:"4px 0"},children:s?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie kategorii..."}):p.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:u?`Brak wynikow dla "${u}"`:"Brak kategorii"}):p.map(j=>e.jsx(mb,{node:j,depth:0,selectedId:r,onSelect:y=>a(y),expandedIds:o,toggleExpand:f},j.id))})]})}function gb(t,r){const a=[];for(const s of t){const o=gb(s.children,r);(s.name.toLowerCase().includes(r)||o.length>0)&&a.push({...s,children:o.length>0?o:s.children})}return a}function xb(t){let r=0;for(const a of t)r+=a.asset_count,r+=xb(a.children);return r}function yb({fields:t,values:r,onChange:a,readOnly:s=!1}){const o=m.useMemo(()=>{const x=new Map;for(const j of t){const y=j.tab_name||"Informacje";x.has(y)||x.set(y,[]),x.get(y).push(j)}for(const[,j]of x)j.sort((y,S)=>y.sort_order-S.sort_order);return x},[t]),d=m.useMemo(()=>[...o.keys()],[o]),[u,h]=m.useState(d[0]||"Informacje"),f=d.includes(u)?u:d[0]||"Informacje",p=o.get(f)||[];return t.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych pol dla tej kategorii."}):e.jsxs("div",{children:[d.length>1&&e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14,borderBottom:"1px solid var(--border)"},children:d.map(x=>e.jsx("div",{onClick:()=>h(x),style:{padding:"6px 14px",fontSize:12,cursor:"pointer",borderBottom:f===x?"2px solid var(--blue)":"2px solid transparent",color:f===x?"var(--blue)":"var(--text-muted)",fontWeight:f===x?600:400,transition:"all 0.15s"},children:x},x))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:p.map(x=>e.jsx(UA,{field:x,value:r[x.field_key]??x.default_value??"",onChange:j=>a(x.field_key,j),readOnly:s},x.field_key))})]})}function UA({field:t,value:r,onChange:a,readOnly:s}){const d=t.field_type==="textarea"?{gridColumn:"span 2"}:{},u=e.jsxs("label",{style:{display:"block",marginBottom:4,fontSize:12,color:"var(--text-muted)"},children:[t.label,t.is_required&&e.jsx("span",{style:{color:"var(--red)",marginLeft:2},children:"*"}),t.inherited_from_id&&e.jsx("span",{style:{fontSize:9,color:"var(--purple)",marginLeft:4},title:"Odziedziczone z kategorii nadrzednej",children:"(dziedz.)"})]}),h={width:"100%",padding:"6px 10px",fontSize:13,background:s?"transparent":"var(--bg-input, var(--bg-card))",border:s?"none":"1px solid var(--border)",borderRadius:6,color:"var(--text-primary)",outline:"none"};switch(t.field_type){case"text":case"email":case"url":return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(r||"")||""}):e.jsx("input",{type:t.field_type==="email"?"email":t.field_type==="url"?"url":"text",value:String(r||""),onChange:f=>a(f.target.value||null),placeholder:t.placeholder||void 0,required:t.is_required,maxLength:t.max_length||void 0,className:"form-control",style:h})]});case"number":return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0",fontFamily:"'JetBrains Mono',monospace"},children:r!=null&&r!==""?String(r):""}):e.jsx("input",{type:"number",value:r!=null&&r!==""?String(r):"",onChange:f=>a(f.target.value?Number(f.target.value):null),placeholder:t.placeholder||void 0,required:t.is_required,min:t.min_value??void 0,max:t.max_value??void 0,className:"form-control",style:h})]});case"date":return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(r||"")||""}):e.jsx("input",{type:"date",value:String(r||""),onChange:f=>a(f.target.value||null),required:t.is_required,className:"form-control",style:h})]});case"boolean":return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:r===!0?"Tak":r===!1?"Nie":""}):e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:!!r,onChange:f=>a(f.target.checked),style:{width:16,height:16}}),e.jsx("span",{children:r?"Tak":"Nie"})]})]});case"select":{const f=jv(t.options_json);return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:String(r||"")||""}):e.jsxs("select",{value:String(r||""),onChange:p=>a(p.target.value||null),required:t.is_required,className:"form-control",style:h,children:[e.jsx("option",{value:"",children:"Wybierz..."}),f.map(p=>e.jsx("option",{value:p.value,children:p.label},p.value))]})]})}case"multiselect":{const f=jv(t.options_json),p=Array.isArray(r)?r:[];return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:p.join(", ")||""}):e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:f.map(x=>{const j=p.includes(x.value);return e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:4,fontSize:12,padding:"3px 8px",borderRadius:12,cursor:"pointer",background:j?"var(--blue-dim)":"rgba(255,255,255,0.03)",border:j?"1px solid var(--blue)":"1px solid var(--border)",color:j?"var(--blue)":"var(--text-secondary)"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:()=>{const y=j?p.filter(S=>S!==x.value):[...p,x.value];a(y.length>0?y:null)},style:{display:"none"}}),x.label]},x.value)})})]})}case"reference":return e.jsxs("div",{className:"form-group",style:d,children:[u,e.jsx($A,{field:t,value:r,onChange:a,readOnly:s,inputStyle:h})]});case"textarea":return e.jsxs("div",{className:"form-group",style:d,children:[u,s?e.jsx("div",{style:{fontSize:13,padding:"4px 0",whiteSpace:"pre-wrap"},children:String(r||"")||""}):e.jsx("textarea",{value:String(r||""),onChange:f=>a(f.target.value||null),placeholder:t.placeholder||void 0,required:t.is_required,rows:3,className:"form-control",style:{...h,resize:"vertical"}})]});default:return e.jsxs("div",{className:"form-group",style:d,children:[u,e.jsx("input",{type:"text",value:String(r||""),onChange:f=>a(f.target.value||null),className:"form-control",style:h})]})}}function $A({field:t,value:r,onChange:a,readOnly:s,inputStyle:o}){const[d,u]=m.useState([]),[h,f]=m.useState(!1);m.useEffect(()=>{t.reference_category_id&&(f(!0),le.get(`/api/v1/assets?asset_category_id=${t.reference_category_id}`).then(u).catch(()=>u([])).finally(()=>f(!1)))},[t.reference_category_id]);const p=m.useMemo(()=>r?d.find(j=>j.id===Number(r))?.name||`Asset #${r}`:null,[r,d]);return s?e.jsx("div",{style:{fontSize:13,padding:"4px 0"},children:p||""}):e.jsxs("select",{value:r!=null?String(r):"",onChange:x=>a(x.target.value?Number(x.target.value):null),required:t.is_required,className:"form-control",style:o,disabled:h,children:[e.jsx("option",{value:"",children:h?"Ladowanie...":"Wybierz aktyw..."}),d.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})}function jv(t){if(!t)return[];let r=t;if(typeof t=="string")try{r=JSON.parse(t)}catch{return[]}return Array.isArray(r)?r.map(a=>typeof a=="string"?{value:a,label:a}:typeof a=="object"&&a!==null&&"value"in a&&"label"in a?{value:String(a.value),label:String(a.label)}:{value:String(a),label:String(a)}):[]}const HA={HardDrive:"",Server:"",Monitor:"",Laptop:"",Smartphone:"",Printer:"",Database:"",Network:"",Globe:"",Router:"",Shield:"",Code:"",Layers:"",AppWindow:"",Cloud:"",Settings:"",Users:"",User:"",UsersGroup:"",Briefcase:"",FileText:"",File:"",Table:"",Key:"",Building:"",MapPin:"",Door:"",Workflow:"",GitBranch:"",Headphones:""};function VA(t){return t?HA[t]??"":""}function Hd(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("wysok")||r.includes("high")||r.includes("krytycz")?"var(--red)":r.includes("redni")||r.includes("medium")?"var(--orange)":"var(--green)"}function ZA(){const[t,r]=m.useState([]),[a,s]=m.useState(null),[o,d]=m.useState(!0),[u,h]=m.useState([]),[f,p]=m.useState(!0),[x,j]=m.useState(null),[y,S]=m.useState("info"),[w,b]=m.useState([]),[_,E]=m.useState([]),[C,N]=m.useState([]),[O,Q]=m.useState([]),[G,M]=m.useState(!1),[U,A]=m.useState(!1),[R,Z]=m.useState(!1),[F,q]=m.useState(null),[ee,me]=m.useState(!1),[W,J]=m.useState(null),[L,H]=m.useState({}),[ne,P]=m.useState([]),[T,z]=m.useState(null),[k,I]=m.useState("data"),[D,de]=m.useState(!1),[he,ie]=m.useState(null),[ve,je]=m.useState(!1),[fe,_e]=m.useState(!1),[Se,Ve]=m.useState(null),[be,oe]=m.useState(new Set),[Ue,Qe]=m.useState(!1),[lt,tt]=m.useState([]),ht=m.useMemo(()=>Cl(lt),[lt]),xt=m.useMemo(()=>{const xe=[{key:"id",header:"ID"},{key:"name",header:"Nazwa"},{key:"asset_category_name",header:"Kategoria",format:Ie=>Ie.asset_category_name??Ie.asset_type_name??""},{key:"org_unit_name",header:"Jednostka org.",format:Ie=>Ie.org_unit_name??""},{key:"owner",header:"Wlasciciel",format:Ie=>Ie.owner??""},{key:"criticality_name",header:"Krytycznosc",format:Ie=>Ie.criticality_name??""},{key:"risk_count",header:"Ryzyka",format:Ie=>String(Ie.risk_count)},{key:"sensitivity_name",header:"Wrazliwosc",format:Ie=>Ie.sensitivity_name??"",defaultVisible:!1},{key:"location",header:"Lokalizacja",format:Ie=>Ie.location??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:Ie=>Ie.created_at?.slice(0,10)??"",defaultVisible:!1}];for(const Ie of w.filter(mt=>mt.show_in_list))xe.push({key:`ca_${Ie.field_key}`,header:Ie.label,format:mt=>{const Oe=mt.custom_attributes?.[Ie.field_key];return Oe==null?"":Array.isArray(Oe)?Oe.join(", "):String(Oe)}});return xe},[w]),{visible:qe,toggle:Nt}=da(xt,"assets-cmdb"),st=Aa({data:u,storageKey:"assets-cmdb",defaultSort:"name"});m.useEffect(()=>{d(!0),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{}).finally(()=>d(!1)),le.get("/api/v1/org-units/tree").then(tt).catch(()=>{}),le.get("/api/v1/asset-categories/relationship-types/all").then(Q).catch(()=>{})},[]);const _t=m.useCallback(()=>{p(!0);const xe=a?`?asset_category_id=${a.id}`:"";le.get(`/api/v1/assets${xe}`).then(Ie=>{h(Ie),x&&!Ie.find(mt=>mt.id===x.id)&&j(null)}).catch(()=>{}).finally(()=>p(!1))},[a?.id]);m.useEffect(()=>{_t()},[_t]),m.useEffect(()=>{a&&!a.is_abstract?le.get(`/api/v1/asset-categories/${a.id}/fields`).then(b).catch(()=>b([])):b([])},[a?.id]),m.useEffect(()=>{x?(S("info"),le.get(`/api/v1/assets/${x.id}/relationships`).then(E).catch(()=>E([])),le.get(`/api/v1/audit?entity_type=Asset&entity_id=${x.id}&per_page=50`).then(xe=>N(xe.items)).catch(()=>N([]))):(E([]),N([]))},[x?.id]);const zt=xe=>{s(xe),j(null)},It=async()=>{if(W)return W;const[xe,Ie]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),mt=async za=>{try{return(await le.get(`/api/v1/dictionaries/${za}/entries`)).entries.filter(Et=>Et.is_active).map(Et=>({id:Et.id,label:Et.label}))}catch{return[]}},[Oe,ct]=await Promise.all([mt("sensitivity"),mt("criticality")]),At={orgUnits:xe,assets:Ie,sensitivities:Oe,criticalities:ct};return J(At),At},va=async()=>{await It(),q(null);const xe=a&&!a.is_abstract?a.id:null;if(z(xe),H({}),xe){const Ie=await le.get(`/api/v1/asset-categories/${xe}/fields`).catch(()=>[]);P(Ie)}else P([]);Z(!0)},rt=async xe=>{if(await It(),q(xe),I("data"),z(xe.asset_category_id),H(xe.custom_attributes||{}),xe.asset_category_id){const Ie=await le.get(`/api/v1/asset-categories/${xe.asset_category_id}/fields`).catch(()=>[]);P(Ie)}else P([]);Z(!0)},oa=async xe=>{if(z(xe),xe){const Ie=await le.get(`/api/v1/asset-categories/${xe}/fields`).catch(()=>[]);P(Ie)}else P([])},ca=async xe=>{xe.preventDefault(),me(!0);const Ie=new FormData(xe.currentTarget),mt={name:Ie.get("name"),org_unit_id:Ie.get("org_unit_id")?Number(Ie.get("org_unit_id")):null,parent_id:Ie.get("parent_id")?Number(Ie.get("parent_id")):null,owner:Ie.get("owner")||null,description:Ie.get("description")||null,location:Ie.get("location")||null,sensitivity_id:Ie.get("sensitivity_id")?Number(Ie.get("sensitivity_id")):null,criticality_id:Ie.get("criticality_id")?Number(Ie.get("criticality_id")):null,asset_category_id:T,custom_attributes:Object.keys(L).length>0?L:null};try{if(F){const Oe=await le.put(`/api/v1/assets/${F.id}`,mt);j(Oe)}else await le.post("/api/v1/assets",mt);Z(!1),q(null),J(null),_t(),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{})}catch(Oe){alert("Blad zapisu: "+Oe)}finally{me(!1)}},ze=async xe=>{if(confirm(`Archiwizowac aktyw "${xe.name}"?`))try{await le.delete(`/api/v1/assets/${xe.id}`),j(null),_t(),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{})}catch(Ie){alert("Blad: "+Ie)}},et=xe=>{ie(xe),de(!0)},it=async xe=>{if(xe.preventDefault(),!x)return;A(!0);const Ie=new FormData(xe.currentTarget),mt={source_asset_id:x.id,target_asset_id:Number(Ie.get("target_asset_id")),relationship_type:Ie.get("relationship_type"),description:Ie.get("rel_description")||null};try{await le.post("/api/v1/assets/relationships",mt),M(!1);const Oe=await le.get(`/api/v1/assets/${x.id}/relationships`);E(Oe)}catch(Oe){alert("Blad dodawania relacji: "+Oe)}finally{A(!1)}},Be=async xe=>{if(!(!x||!confirm("Usunac te relacje?")))try{await le.delete(`/api/v1/assets/relationships/${xe}`),E(Ie=>Ie.filter(mt=>mt.id!==xe))}catch(Ie){alert("Blad usuwania relacji: "+Ie)}},at=async xe=>{xe.preventDefault();const mt=new FormData(xe.currentTarget).get("csv_file");if(!mt||mt.size===0)return;_e(!0),Ve(null);const Oe=new FormData;Oe.append("file",mt);const ct=a&&!a.is_abstract?a.id:null,At=`/api/v1/assets/import/csv${ct?`?asset_category_id=${ct}`:""}`;try{const za=await le.postFormData(At,Oe);Ve(za),_t(),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{})}catch(za){alert("Blad importu: "+za)}finally{_e(!1)}},nt=xe=>{oe(Ie=>{const mt=new Set(Ie);return mt.has(xe)?mt.delete(xe):mt.add(xe),mt})},ut=async()=>{if(!(be.size===0||!confirm(`Archiwizowac ${be.size} aktywow?`)))try{await le.post("/api/v1/assets/bulk/archive",{asset_ids:[...be]}),oe(new Set),j(null),_t(),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{})}catch(xe){alert("Blad: "+xe)}},ta=async xe=>{if(be.size!==0)try{await le.post("/api/v1/assets/bulk/assign-category",{asset_ids:[...be],asset_category_id:xe}),oe(new Set),_t(),le.get("/api/v1/asset-categories/tree").then(r).catch(()=>{})}catch(Ie){alert("Blad: "+Ie)}},Pt=m.useMemo(()=>{const xe=[],Ie=(mt,Oe)=>{for(const ct of mt)xe.push({cat:ct,depth:Oe}),Ie(ct.children,Oe+1)};return Ie(t,0),xe},[t]),Tt=m.useMemo(()=>Pt.filter(xe=>!xe.cat.is_abstract),[Pt]);return e.jsxs("div",{style:{display:"flex",height:"calc(100vh - 56px)",overflow:"hidden"},children:[e.jsx(pb,{tree:t,selectedId:a?.id??null,onSelect:zt,loading:o}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"0 16px 16px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 0 8px"},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a?a.name_plural||a.name:"Wszystkie Aktywa"}),a&&e.jsx("span",{className:"score-badge",style:{background:(a.color||"var(--blue)")+"20",color:a.color||"var(--blue)",fontSize:11},children:a.is_abstract?"Grupa":"Kategoria"})]}),e.jsx(Ia,{cards:[{label:"Aktywow",value:st.filtered.filter(xe=>xe.is_active).length,total:u.filter(xe=>xe.is_active).length,color:"var(--blue)"},{label:"Z ryzykami",value:st.filtered.filter(xe=>xe.risk_count>0).length,total:u.filter(xe=>xe.risk_count>0).length,color:"var(--orange)"},{label:"Krytycznych",value:st.filtered.filter(xe=>xe.criticality_name?.toLowerCase().includes("wysok")||xe.criticality_name?.toLowerCase().includes("krytycz")).length,color:"var(--red)"},{label:"Jednostek org.",value:new Set(st.filtered.filter(xe=>xe.org_unit_id).map(xe=>xe.org_unit_id)).size,color:"var(--cyan)"}],isFiltered:st.filteredCount!==st.totalCount}),e.jsx(ma,{filteredCount:st.filteredCount,totalCount:st.totalCount,unitLabel:"aktywow",search:st.search,onSearchChange:st.setSearch,searchPlaceholder:"Szukaj aktywow...",showFilters:Ue,onToggleFilters:()=>Qe(xe=>!xe),hasActiveFilters:st.hasActiveFilters,onClearFilters:st.clearAllFilters,columns:xt,visibleColumns:qe,onToggleColumn:Nt,data:st.filtered,exportFilename:"aktywa-cmdb",primaryLabel:"Dodaj aktyw",onPrimaryAction:va,secondaryActions:[{label:"Import CSV",onClick:()=>{je(!0),Ve(null)}}]}),be.size>0&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",marginBottom:8,background:"var(--blue-dim)",borderRadius:8,fontSize:12},children:[e.jsxs("span",{style:{fontWeight:600,color:"var(--blue)"},children:["Zaznaczono: ",be.size]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:()=>oe(new Set),children:"Odznacz"}),e.jsx("div",{style:{flex:1}}),e.jsxs("select",{className:"form-control",style:{width:"auto",fontSize:11,padding:"3px 8px"},value:"",onChange:xe=>{xe.target.value&&ta(Number(xe.target.value))},children:[e.jsx("option",{value:"",children:"Przypisz kategorie..."}),Tt.map(({cat:xe,depth:Ie})=>e.jsxs("option",{value:xe.id,children:["".repeat(Ie),xe.name]},xe.id))]}),e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:"var(--red)"},onClick:ut,children:["Archiwizuj (",be.size,")"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:x?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:xt,visibleColumns:qe,data:st.pageData,rowKey:xe=>xe.id,selectedKey:x?.id??null,onRowClick:xe=>j(x?.id===xe.id?null:xe),sortField:st.sortField,sortDir:st.sortDir,onSort:st.toggleSort,columnFilters:st.columnFilters,onColumnFilter:st.setColumnFilter,showFilters:Ue,page:st.page,totalPages:st.totalPages,pageSize:st.pageSize,totalItems:st.totalCount,filteredItems:st.filteredCount,onPageChange:st.setPage,onPageSizeChange:st.setPageSize,loading:f,emptyMessage:"Brak aktywow w tej kategorii.",emptyFilteredMessage:"Brak aktywow pasujacych do filtrow.",renderCell:(xe,Ie)=>{if(Ie==="id")return e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("input",{type:"checkbox",checked:be.has(xe.id),onChange:mt=>{mt.stopPropagation(),nt(xe.id)},onClick:mt=>mt.stopPropagation(),style:{width:14,height:14,cursor:"pointer"}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:xe.ref_id||xe.id})]});if(Ie==="name")return e.jsx("span",{style:{fontWeight:500},children:xe.name});if(Ie==="asset_category_name"){const mt=xe.asset_category_name||xe.asset_type_name,Oe=xe.asset_category_color||"var(--purple)";return mt?e.jsx("span",{className:"score-badge",style:{background:Oe+"20",color:Oe},children:mt}):""}if(Ie==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:(xe.org_unit_id?ht.get(xe.org_unit_id):null)??xe.org_unit_name??""});if(Ie==="criticality_name")return xe.criticality_name?e.jsx("span",{className:"score-badge",style:{background:Hd(xe.criticality_name)==="var(--red)"?"var(--red-dim)":Hd(xe.criticality_name)==="var(--orange)"?"var(--orange-dim)":"var(--green-dim)",color:Hd(xe.criticality_name)},children:xe.criticality_name}):"";if(typeof Ie=="string"&&Ie.startsWith("ca_")){const mt=Ie.slice(3),Oe=xe.custom_attributes?.[mt];return Oe==null?"":Array.isArray(Oe)?e.jsx("span",{children:Oe.join(", ")}):e.jsx("span",{children:String(Oe)})}}}),x&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly aktywa"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",title:"Graf relacji",onClick:()=>et(x),style:{fontSize:14,padding:"4px 8px"},children:""}),e.jsx("button",{className:"btn btn-sm",onClick:()=>j(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--text-primary)"},children:x.name}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:6,marginTop:6},children:[x.asset_category_name&&e.jsx("span",{className:"score-badge",style:{background:(x.asset_category_color||"var(--purple)")+"20",color:x.asset_category_color||"var(--purple)",fontSize:11},children:x.asset_category_name}),x.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:x.ref_id})]})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"info",label:"Informacje"},{key:"custom",label:"Atrybuty"},{key:"relations",label:`Relacje (${_.length})`},{key:"risks",label:`Ryzyka (${x.risk_count})`},{key:"history",label:"Historia"}].map(xe=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"5px 4px",background:y===xe.key?"var(--blue-dim)":"transparent",borderBottom:y===xe.key?"2px solid var(--blue)":"2px solid var(--border)",color:y===xe.key?"var(--blue)":"var(--text-muted)",fontWeight:y===xe.key?600:400,fontSize:11,cursor:"pointer",transition:"all 0.2s"},onClick:()=>S(xe.key),children:xe.label},xe.key))}),y==="info"&&e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[[["Kategoria",x.asset_category_name??x.category_name??""],["Jednostka org.",(x.org_unit_id?ht.get(x.org_unit_id):null)??x.org_unit_name??""],["Wlasciciel",x.owner??""],["Lokalizacja",x.location??""],["Wrazliwosc",x.sensitivity_name??""],["Krytycznosc",x.criticality_name??""],["Nadrzedny aktyw",x.parent_name??""],["Utworzono",x.created_at?.slice(0,10)],["Zaktualizowano",x.updated_at?.slice(0,10)]].map(([xe,Ie])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:xe}),e.jsx("span",{style:xe==="Krytycznosc"?{fontWeight:500,color:Hd(x.criticality_name)}:{},children:Ie})]},xe)),x.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:x.description})]})]}),y==="custom"&&e.jsx(GA,{assetCategoryId:x.asset_category_id,customAttributes:x.custom_attributes||{}}),y==="relations"&&e.jsxs("div",{children:[_.length===0&&!G?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych relacji."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:_.map(xe=>{const Ie=xe.source_asset_id===x.id,mt=O.find(ct=>ct.code===xe.relationship_type),Oe=mt?.color||"var(--text-muted)";return e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[e.jsx("span",{className:"score-badge",style:{background:Oe+"20",color:Oe,fontSize:10},children:Ie?mt?.name||xe.relationship_type:mt?.name_reverse||xe.relationship_type}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:Ie?"":""}),e.jsx("button",{onClick:()=>Be(xe.id),style:{background:"none",border:"none",cursor:"pointer",color:"var(--red)",fontSize:12,padding:"0 2px",opacity:.5},title:"Usun relacje",children:""})]})]}),e.jsx("div",{style:{fontWeight:500},children:Ie?xe.target_asset_name:xe.source_asset_name}),xe.description&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:xe.description})]},xe.id)})}),G?e.jsxs("form",{onSubmit:it,style:{marginTop:10,padding:10,borderRadius:6,border:"1px solid var(--border)",background:"var(--bg-inset)"},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:8,color:"var(--text-primary)"},children:"Nowa relacja"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("select",{name:"relationship_type",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Typ relacji..."}),O.map(xe=>e.jsx("option",{value:xe.code,children:xe.name},xe.code))]}),e.jsxs("select",{name:"target_asset_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Docelowy aktyw..."}),u.filter(xe=>xe.id!==x.id).map(xe=>e.jsxs("option",{value:xe.id,children:[xe.name,xe.asset_category_name?` (${xe.asset_category_name})`:""]},xe.id))]}),e.jsx("input",{name:"rel_description",className:"form-control",placeholder:"Opis (opcjonalnie)",style:{fontSize:12}}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:U,style:{flex:1},children:U?"Dodawanie...":"Dodaj"}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>M(!1),children:"Anuluj"})]})]})]}):e.jsx("button",{className:"btn btn-sm btn-primary",style:{marginTop:10,width:"100%"},onClick:()=>M(!0),children:"+ Dodaj relacje"}),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,width:"100%"},onClick:()=>et(x),children:"Pokaz graf relacji"})]}),y==="risks"&&e.jsx(bv,{asset:x,orgTree:lt,onRiskCountChange:xe=>{j(Ie=>Ie&&{...Ie,risk_count:xe})}}),y==="history"&&e.jsx("div",{children:C.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak historii zmian."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:C.map(xe=>e.jsxs("div",{style:{padding:"6px 8px",borderRadius:4,fontSize:11,background:"var(--bg-inset)",borderLeft:"2px solid var(--blue)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontWeight:500},children:xe.action}),e.jsx("span",{style:{color:"var(--text-muted)",fontSize:10},children:xe.created_at?.slice(0,16).replace("T"," ")})]}),xe.field_name&&e.jsxs("div",{style:{color:"var(--text-muted)"},children:[xe.field_name,": ",xe.old_value??"","  ",xe.new_value??""]})]},xe.id))})}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>rt(x),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},title:"Graf relacji",onClick:()=>et(x),children:"Graf"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ze(x),children:"Archiwizuj"})]})]})]})]}),e.jsx(gt,{open:R,onClose:()=>{Z(!1),q(null)},title:F?`Edytuj aktyw: ${F.name}`:"Dodaj aktyw",wide:!0,children:W?e.jsxs("div",{children:[F&&e.jsx("div",{style:{display:"flex",gap:0,marginBottom:16,borderBottom:"2px solid var(--border)"},children:[{key:"data",label:"Dane aktywa"},{key:"risks",label:"Ryzyka"}].map(xe=>e.jsx("div",{style:{padding:"8px 20px",cursor:"pointer",fontSize:13,fontWeight:k===xe.key?600:400,color:k===xe.key?"var(--blue)":"var(--text-muted)",borderBottom:k===xe.key?"2px solid var(--blue)":"2px solid transparent",marginBottom:-2,transition:"all 0.2s"},onClick:()=>I(xe.key),children:xe.label},xe.key))}),(k==="data"||!F)&&e.jsxs("form",{onSubmit:ca,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Nazwa aktywa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:F?.name??"",placeholder:"np. Serwer bazodanowy DB-01"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria CMDB"}),e.jsxs("select",{className:"form-control",value:T??"",onChange:xe=>oa(xe.target.value?Number(xe.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz kategorie..."}),Pt.map(({cat:xe,depth:Ie})=>e.jsxs("option",{value:xe.id,disabled:xe.is_abstract,children:[Ie>0?"".repeat(Ie):"",xe.is_abstract?` ${xe.name}`:`${VA(xe.icon)} ${xe.name}`]},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:W.orgUnits,value:F?.org_unit_id??null,onChange:xe=>{const Ie=document.querySelector('input[name="org_unit_id"]');Ie&&(Ie.value=xe?String(xe):"")},placeholder:"Wybierz...",allowClear:!0}),e.jsx("input",{type:"hidden",name:"org_unit_id",defaultValue:F?.org_unit_id??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nadrzedny aktyw"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:F?.parent_id??"",children:[e.jsx("option",{value:"",children:"Brak (glowny)"}),W.assets.filter(xe=>!F||xe.id!==F.id).map(xe=>e.jsx("option",{value:xe.id,children:xe.name},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:F?.owner??"",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Lokalizacja"}),e.jsx("input",{name:"location",className:"form-control",defaultValue:F?.location??"",placeholder:"np. Serwerownia DC-1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wrazliwosc"}),e.jsxs("select",{name:"sensitivity_id",className:"form-control",defaultValue:F?.sensitivity_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),W.sensitivities.map(xe=>e.jsx("option",{value:xe.id,children:xe.label},xe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{name:"criticality_id",className:"form-control",defaultValue:F?.criticality_id??"",children:[e.jsx("option",{value:"",children:"Wybierz..."}),W.criticalities.map(xe=>e.jsx("option",{value:xe.id,children:xe.label},xe.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:F?.description??""})]})]}),ne.length>0&&e.jsxs("div",{style:{marginTop:16,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"var(--text-primary)"},children:"Atrybuty kategorii"}),e.jsx(yb,{fields:ne,values:L,onChange:(xe,Ie)=>H(mt=>({...mt,[xe]:Ie}))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{Z(!1),q(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:ee,children:ee?"Zapisywanie...":F?"Zapisz zmiany":"Dodaj aktyw"})]})]}),F&&k==="risks"&&e.jsx(bv,{asset:F,orgTree:lt,onRiskCountChange:xe=>{j(Ie=>Ie&&Ie.id===F.id?{...Ie,risk_count:xe}:Ie)}})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})}),e.jsx(gt,{open:D,onClose:()=>{de(!1),ie(null)},title:he?`Graf relacji: ${he.name}`:"Graf relacji",wide:!0,children:he&&e.jsx(KA,{assetId:he.id,assetName:he.name})}),e.jsx(gt,{open:ve,onClose:()=>{je(!1),Ve(null)},title:"Import aktywow z CSV",children:Se?e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",padding:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,color:"var(--green)",marginBottom:8},children:Se.created}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:12},children:"aktywow zaimportowano pomyslnie"})]}),Se.total_errors>0&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--red)",marginBottom:6},children:["Bledy (",Se.total_errors,"):"]}),e.jsxs("div",{style:{maxHeight:150,overflowY:"auto",fontSize:11,color:"var(--text-muted)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:[Se.errors.map((xe,Ie)=>e.jsx("div",{children:xe},Ie)),Se.total_errors>Se.errors.length&&e.jsxs("div",{style:{fontStyle:"italic"},children:["...i ",Se.total_errors-Se.errors.length," wiecej"]})]})]}),e.jsx("button",{className:"btn btn-primary",style:{width:"100%"},onClick:()=>{je(!1),Ve(null)},children:"Zamknij"})]}):e.jsxs("form",{onSubmit:at,children:[e.jsxs("div",{style:{fontSize:13,color:"var(--text-muted)",marginBottom:16},children:["Zaladuj plik CSV z aktywami. Wymagana kolumna: ",e.jsx("code",{children:"name"}),". Opcjonalne: ",e.jsx("code",{children:"owner"}),", ",e.jsx("code",{children:"description"}),", ",e.jsx("code",{children:"location"}),". Pozostale kolumny beda zapisane jako atrybuty niestandardowe.",e.jsx("br",{}),e.jsx("br",{}),"Separator: ",e.jsx("code",{children:";"})," (srednik) lub ",e.jsx("code",{children:","})," (przecinek).",a&&!a.is_abstract&&e.jsxs("div",{style:{marginTop:8,padding:"6px 10px",background:"var(--blue-dim)",borderRadius:6,color:"var(--blue)",fontSize:12},children:["Importowane aktywa zostana przypisane do kategorii: ",e.jsx("strong",{children:a.name})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Plik CSV"}),e.jsx("input",{name:"csv_file",type:"file",accept:".csv",required:!0,className:"form-control",style:{padding:8}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>je(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:fe,children:fe?"Importowanie...":"Importuj"})]})]})})]})}function GA({assetCategoryId:t,customAttributes:r}){const[a,s]=m.useState([]);return m.useEffect(()=>{t?le.get(`/api/v1/asset-categories/${t}/fields`).then(s).catch(()=>s([])):s([])},[t]),t?a.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zdefiniowanych atrybutow."}):e.jsx(yb,{fields:a,values:r,onChange:()=>{},readOnly:!0}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Aktyw nie ma przypisanej kategorii CMDB."})}function bv({asset:t,orgTree:r,onRiskCountChange:a}){const[s,o]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState("list"),[p,x]=m.useState(null),[j,y]=m.useState([]),[S,w]=m.useState(""),[b,_]=m.useState(""),[E,C]=m.useState(!1),[N,O]=m.useState(!1),[Q,G]=m.useState([]),[M,U]=m.useState([]),[A,R]=m.useState([]),[Z,F]=m.useState([]),[q,ee]=m.useState(2),[me,W]=m.useState(2),[J,L]=m.useState(.25),[H,ne]=m.useState([]),[P,T]=m.useState([]),[z,k]=m.useState([]),[I,D]=m.useState(null),[de,he]=m.useState(""),[ie,ve]=m.useState([]),[je,fe]=m.useState(!1),[_e,Se]=m.useState([]),[Ve,be]=m.useState(!1),[oe,Ue]=m.useState(!1),Qe=m.useRef(a);Qe.current=a;const lt=m.useCallback(()=>{u(!0),le.get("/api/v1/risks?include_archived=false").then(ze=>{const et=ze.filter(it=>it.asset_id===t.id);o(et),Qe.current(et.length)}).catch(()=>o([])).finally(()=>u(!1))},[t.id]);m.useEffect(()=>{lt()},[lt]);const tt=m.useCallback(()=>{j.length>0||(C(!0),le.get("/api/v1/risks?include_archived=false").then(y).catch(()=>{}).finally(()=>C(!1)))},[j.length]),ht=m.useMemo(()=>{const ze=new Set(s.map(it=>it.id));let et=j.filter(it=>!ze.has(it.id));if(S){const it=S.toLowerCase();et=et.filter(Be=>Be.asset_name.toLowerCase().includes(it)||Be.code?.toLowerCase().includes(it)||Be.owner?.toLowerCase().includes(it)||Be.security_area_name?.toLowerCase().includes(it))}return b&&(et=et.filter(it=>it.risk_level===b)),et.slice(0,20)},[j,s,S,b]),xt=async ze=>{try{await le.put(`/api/v1/risks/${ze.id}`,{asset_id:t.id,asset_name:t.name}),f("list"),w(""),_(""),lt(),y([])}catch(et){alert("Blad linkowania: "+et)}},qe=async ze=>{if(confirm(`Odlacz ryzyko R-${ze.id} od tego aktywa?`))try{await le.put(`/api/v1/risks/${ze.id}`,{asset_id:null}),lt(),y([])}catch(et){alert("Blad: "+et)}},Nt=async ze=>{ze.preventDefault(),O(!0);const et=new FormData(ze.currentTarget),it={org_unit_id:t.org_unit_id||Number(et.get("org_unit_id"))||null,asset_id:t.id,asset_name:t.name,security_area_id:Number(et.get("security_area_id")),impact_level:q,probability_level:me,safeguard_rating:J,consequence_description:et.get("consequence_description")||null,existing_controls:et.get("existing_controls")||null,owner:et.get("owner")||t.owner||null,threat_ids:H,vulnerability_ids:P,safeguard_ids:z};try{const Be=await le.post("/api/v1/risks",it);D(Be.id),f("link_action"),lt(),y([])}catch(Be){alert("Blad tworzenia ryzyka: "+Be)}finally{O(!1)}};m.useEffect(()=>{if(h!=="link_action"||de.length<2){ve([]);return}const ze=setTimeout(()=>{fe(!0),le.get("/api/v1/actions").then(et=>{const it=de.toLowerCase();ve((et??[]).filter(Be=>Be.title.toLowerCase().includes(it)||(Be.owner??"").toLowerCase().includes(it)).slice(0,8))}).catch(()=>{}).finally(()=>fe(!1))},300);return()=>clearTimeout(ze)},[de,h]);const st=async ze=>{if(I)try{const it=((await le.get(`/api/v1/actions/${ze.id}`)).links??[]).map(Be=>({entity_type:Be.entity_type,entity_id:Be.entity_id}));it.push({entity_type:"risk",entity_id:I}),await le.put(`/api/v1/actions/${ze.id}`,{links:it}),Se(Be=>[...Be,ze.id]),he(""),ve([])}catch(et){alert("Blad: "+et)}},_t=async ze=>{if(ze.preventDefault(),!I)return;Ue(!0);const et=new FormData(ze.currentTarget);try{const it=await le.post("/api/v1/actions",{title:et.get("title"),description:et.get("description")||null,owner:et.get("action_owner")||null,due_date:et.get("due_date")||null,org_unit_id:t.org_unit_id||null,links:[{entity_type:"risk",entity_id:I}]});Se(Be=>[...Be,it.id]),be(!1)}catch(it){alert("Blad: "+it)}finally{Ue(!1)}},zt=ze=>ze==="high"?"var(--red)":ze==="medium"?"var(--orange)":"var(--green)",It=ze=>ze==="high"?"var(--red-dim, rgba(239,68,68,0.15))":ze==="medium"?"var(--orange-dim, rgba(249,115,22,0.15))":"var(--green-dim, rgba(34,197,94,0.15))",va=async()=>{if(f("create"),ee(2),W(2),L(.25),ne([]),T([]),k([]),D(null),Se([]),be(!1),Q.length===0)try{const ze=await le.get("/api/v1/security-areas");G(ze)}catch{}M.length===0&&le.get("/api/v1/threat-catalog").then(U).catch(()=>{}),A.length===0&&le.get("/api/v1/weakness-catalog").then(R).catch(()=>{}),Z.length===0&&le.get("/api/v1/control-catalog").then(F).catch(()=>{})},rt=(ze,et,it)=>Math.exp(ze)*et/it,oa=ze=>ze>=221?"var(--red)":ze>=31?"var(--orange)":"var(--green)",ca=ze=>ze>=221?"var(--red-dim, rgba(239,68,68,0.15))":ze>=31?"var(--orange-dim, rgba(249,115,22,0.15))":"var(--green-dim, rgba(34,197,94,0.15))";if(d)return e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie ryzyk..."});if(p){const ze=p,et=ze.risk_level==="high"?"WYSOKI":ze.risk_level==="medium"?"SREDNI":"NISKI",it=[["Kod",ze.code],["Domena bezp.",ze.security_area_name],["Kategoria ryzyka",ze.risk_category_name],["Jednostka org.",ze.org_unit_name],["Wlasciciel",ze.owner],["Status",ze.status_name],["Strategia",ze.strategy_name],["Wplyw (W)",String(ze.impact_level)],["Prawdopodobienstwo (P)",String(ze.probability_level)],["Zabezpieczenia (Z)",String(ze.safeguard_rating)],["Wynik ryzyka",ze.risk_score?.toFixed(1)],["Poziom ryzyka",et],["Wrazliwosc aktywa",ze.sensitivity_name],["Krytycznosc aktywa",ze.criticality_name],["Termin postepowania",ze.treatment_deadline?.slice(0,10)],["Ryzyko rezydualne",ze.residual_risk!=null?String(ze.residual_risk):null],["Zaakceptowane przez",ze.accepted_by],["Data akceptacji",ze.accepted_at?.slice(0,10)],["Zidentyfikowano",ze.identified_at?.slice(0,10)],["Nastepny przeglad",ze.next_review_date?.slice(0,10)]];return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>x(null),children:" Wstecz do listy"})}),e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsxs("span",{className:"score-badge",style:{marginLeft:8,background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:11},children:[et," ",ze.risk_score?.toFixed(0)]})]}),e.jsx("div",{style:{fontSize:12,lineHeight:2},children:it.map(([Be,at])=>at?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid rgba(42,53,84,0.08)"},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:11},children:Be}),e.jsx("span",{style:{fontWeight:500,fontSize:11,textAlign:"right",maxWidth:"60%"},children:at})]},Be):null)}),ze.consequence_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Opis konsekwencji"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.consequence_description})]}),ze.existing_controls&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Istniejace zabezpieczenia"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.existing_controls})]}),ze.planned_actions&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Planowane dzialania"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.planned_actions})]}),ze.acceptance_justification&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Uzasadnienie akceptacji"}),e.jsx("div",{style:{fontSize:11,background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:ze.acceptance_justification})]}),ze.threats.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Zagrozenia (",ze.threats.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.threats.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--red-dim, rgba(239,68,68,0.1))",color:"var(--red)"},children:Be.threat_name},Be.threat_id))})]}),ze.vulnerabilities.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Podatnosci (",ze.vulnerabilities.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.vulnerabilities.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--orange-dim, rgba(249,115,22,0.1))",color:"var(--orange)"},children:Be.vulnerability_name},Be.vulnerability_id))})]}),ze.safeguards.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Zabezpieczenia (",ze.safeguards.length,")"]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:ze.safeguards.map(Be=>e.jsx("span",{className:"score-badge",style:{fontSize:10,background:"var(--green-dim, rgba(34,197,94,0.1))",color:"var(--green)"},children:Be.safeguard_name},Be.safeguard_id))})]}),e.jsx("div",{style:{display:"flex",gap:6,marginTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{x(null),qe(ze)},children:"Odlacz ryzyko"})})]})}return e.jsxs("div",{children:[h==="list"&&e.jsxs(e.Fragment,{children:[s.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak powiazanych ryzyk dla tego aktywa."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,marginBottom:10},children:s.map(ze=>e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,cursor:"pointer",background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12,transition:"border-color 0.2s"},onClick:()=>x(ze),onMouseEnter:et=>et.currentTarget.style.borderColor="var(--blue)",onMouseLeave:et=>et.currentTarget.style.borderColor="var(--border)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsx("span",{className:"score-badge",style:{background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:10},children:ze.risk_level==="high"?"WYSOKI":ze.risk_level==="medium"?"SREDNI":"NISKI"}),e.jsx("span",{style:{fontWeight:600,fontSize:11,color:zt(ze.risk_level)},children:ze.risk_score?.toFixed(0)})]}),e.jsx("button",{onClick:et=>{et.stopPropagation(),qe(ze)},style:{background:"none",border:"none",cursor:"pointer",color:"var(--red)",fontSize:12,padding:"0 2px",opacity:.5},title:"Odlacz ryzyko",children:""})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:ze.security_area_name}),ze.status_name&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)"},children:["Status: ",ze.status_name]})]}),e.jsxs("div",{style:{textAlign:"right",fontSize:10,color:"var(--text-muted)"},children:[ze.owner&&e.jsx("div",{children:ze.owner}),e.jsxs("div",{children:["W=",ze.impact_level," P=",ze.probability_level]})]})]}),ze.consequence_description&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4,fontStyle:"italic"},children:ze.consequence_description.length>80?ze.consequence_description.slice(0,80)+"...":ze.consequence_description})]},ze.id))}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>{f("search"),tt()},children:"Polacz istniejace ryzyko"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:va,children:"+ Nowe ryzyko"})]})]}),h==="search"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600},children:"Wyszukaj ryzyko do polaczenia"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>{f("list"),w(""),_("")},children:"Wstecz"})]}),e.jsxs("div",{style:{display:"flex",gap:6,marginBottom:10},children:[e.jsx("input",{className:"form-control",placeholder:"Szukaj po nazwie, kodzie, wlascicielu...",value:S,onChange:ze=>w(ze.target.value),style:{fontSize:12,flex:1},autoFocus:!0}),e.jsxs("select",{className:"form-control",value:b,onChange:ze=>_(ze.target.value),style:{fontSize:12,width:100},children:[e.jsx("option",{value:"",children:"Poziom"}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"medium",children:"Sredni"}),e.jsx("option",{value:"low",children:"Niski"})]})]}),E?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Ladowanie ryzyk..."}):ht.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:S||b?"Brak ryzyk pasujacych do filtrow.":"Wpisz fraze aby wyszukac..."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4,maxHeight:300,overflowY:"auto"},children:ht.map(ze=>e.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,cursor:"pointer",background:"var(--bg-inset)",border:"1px solid var(--border)",fontSize:12,transition:"border-color 0.2s"},onClick:()=>xt(ze),onMouseEnter:et=>et.currentTarget.style.borderColor="var(--blue)",onMouseLeave:et=>et.currentTarget.style.borderColor="var(--border)",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:["R-",ze.id]}),e.jsxs("span",{className:"score-badge",style:{background:It(ze.risk_level),color:zt(ze.risk_level),fontSize:9},children:[ze.risk_level==="high"?"WYS":ze.risk_level==="medium"?"SRE":"NIS"," ",ze.risk_score?.toFixed(0)]})]}),e.jsx("span",{style:{fontSize:10,color:"var(--blue)"},children:"+ Polacz"})]}),e.jsx("div",{style:{fontWeight:500,fontSize:11,marginTop:2},children:ze.asset_name}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,color:"var(--text-muted)",marginTop:2},children:[e.jsx("span",{children:ze.security_area_name}),e.jsx("span",{children:ze.owner||"brak wlasciciela"})]}),ze.asset_id_name&&ze.asset_id!==t.id&&e.jsxs("div",{style:{fontSize:10,color:"var(--orange)",marginTop:2},children:["Aktualnie powiazane z: ",ze.asset_id_name]})]},ze.id))})]}),h==="create"&&(()=>{const ze=rt(q,me,J),et=oa(ze),it=ze>=221?"WYSOKI":ze>=31?"SREDNI":"NISKI";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600},children:["Nowe ryzyko dla: ",t.name]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>f("list"),children:"Wstecz"})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:22,fontWeight:700,color:et},children:ze.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${et}30`,color:et,fontSize:11,marginLeft:8},children:it})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:16,marginBottom:14},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginBottom:6,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:220},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(Be=>e.jsx("div",{style:{textAlign:"center",fontSize:9,color:"var(--text-muted)",padding:3},children:Be},Be)),[3,2,1].map(Be=>e.jsxs("div",{style:{display:"contents"},children:[e.jsxs("div",{style:{fontSize:9,color:"var(--text-muted)",padding:3,display:"flex",alignItems:"center"},children:["W=",Be]}),[1,2,3].map(at=>{const nt=rt(Be,at,J),ut=Be===q&&at===me;return e.jsx("div",{style:{textAlign:"center",padding:5,borderRadius:4,fontSize:9,fontFamily:"'JetBrains Mono',monospace",fontWeight:ut?700:400,background:ca(nt),color:oa(nt),border:ut?`2px solid ${oa(nt)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{ee(Be),W(at)},children:nt.toFixed(0)},`${Be}-${at}`)})]},`row-${Be}`))]}),e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",textAlign:"center",marginTop:3},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx("div",{style:{fontSize:9,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}].map(Be=>{const at=Math.abs(J-Be.value)<.01;return e.jsxs("div",{style:{padding:"4px 8px",borderRadius:5,fontSize:10,cursor:"pointer",display:"flex",alignItems:"center",gap:6,background:at?`${Be.color}18`:"transparent",border:at?`2px solid ${Be.color}`:"2px solid var(--border)",color:at?Be.color:"var(--text-muted)",fontWeight:at?600:400,transition:"all 0.15s"},onClick:()=>L(Be.value),children:[e.jsx("span",{style:{width:7,height:7,borderRadius:"50%",background:at?Be.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:28,fontSize:10},children:Be.value.toFixed(2)}),e.jsx("span",{style:{fontSize:10},children:Be.label})]},Be.value)})]})]}),e.jsx("form",{onSubmit:Nt,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Domena bezpieczenstwa *"}),e.jsxs("select",{name:"security_area_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Wybierz..."}),Q.map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),!t.org_unit_id&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Jednostka organizacyjna *"}),e.jsxs("select",{name:"org_unit_id",className:"form-control",required:!0,style:{fontSize:12},children:[e.jsx("option",{value:"",children:"Wybierz..."}),(()=>{const Be=[],at=(nt,ut)=>{for(const ta of nt)Be.push({id:ta.id,name:ta.name,depth:ut}),at(ta.children,ut+1)};return at(r,0),Be.map(nt=>e.jsxs("option",{value:nt.id,children:["".repeat(nt.depth),nt.name]},nt.id))})()]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Wlasciciel ryzyka"}),e.jsx("input",{name:"owner",className:"form-control",defaultValue:t.owner||"",style:{fontSize:12},placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Zagrozenia"}),H.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:H.map(Be=>{const at=M.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--red-dim, rgba(239,68,68,0.1))",color:"var(--red)",border:"1px solid rgba(239,68,68,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>ne(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!H.includes(at)&&ne(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj zagrozenie..."}),M.filter(Be=>!H.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Podatnosci"}),P.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:P.map(Be=>{const at=A.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--orange-dim, rgba(249,115,22,0.1))",color:"var(--orange)",border:"1px solid rgba(249,115,22,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>T(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!P.includes(at)&&T(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj podatnosc..."}),A.filter(Be=>!P.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Zabezpieczenia (katalog)"}),z.length>0&&e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:6},children:z.map(Be=>{const at=Z.find(nt=>nt.id===Be);return e.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:3,background:"var(--green-dim, rgba(34,197,94,0.1))",color:"var(--green)",border:"1px solid rgba(34,197,94,0.3)",borderRadius:12,padding:"2px 8px",fontSize:10,fontWeight:500},children:[at?.name??`#${Be}`,e.jsx("span",{style:{cursor:"pointer",fontWeight:700,fontSize:12},onClick:()=>k(nt=>nt.filter(ut=>ut!==Be)),children:""})]},Be)})}),e.jsxs("select",{className:"form-control",style:{fontSize:11},value:"",onChange:Be=>{const at=Number(Be.target.value);at&&!z.includes(at)&&k(nt=>[...nt,at])},children:[e.jsx("option",{value:"",children:"+ Dodaj zabezpieczenie..."}),Z.filter(Be=>!z.includes(Be.id)).map(Be=>e.jsx("option",{value:Be.id,children:Be.name},Be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Opis konsekwencji"}),e.jsx("textarea",{name:"consequence_description",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Co moze sie stac w przypadku materializacji ryzyka?"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Istniejace zabezpieczenia (opis)"}),e.jsx("textarea",{name:"existing_controls",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Jakie zabezpieczenia juz istnieja?"})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",style:{flex:1},disabled:N,children:N?"Tworzenie...":"Utworz ryzyko i polacz"}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f("list"),children:"Anuluj"})]})]})})]})})(),h==="link_action"&&I&&e.jsxs("div",{children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:14},children:[e.jsx("div",{style:{fontSize:28,marginBottom:4},children:""}),e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--green)"},children:["Ryzyko R-",I," utworzone!"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:"Dodaj dzialanie mitygujace lub wroc do listy ryzyk."})]}),_e.length>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:["Powiazane dzialania (",_e.length,")"]}),_e.map(ze=>e.jsxs("div",{style:{padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:3,fontSize:11,display:"flex",alignItems:"center",gap:6},children:[e.jsxs("span",{style:{color:"var(--blue)"},children:["A-",ze]}),e.jsx("span",{style:{color:"var(--green)",fontSize:10},children:" powiazane"})]},ze))]}),!Ve&&e.jsx("div",{style:{marginBottom:10},children:e.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj istniejacego dzialania po tytule...",value:de,onChange:ze=>he(ze.target.value)}),je&&e.jsx("span",{style:{position:"absolute",right:8,top:8,fontSize:10,color:"var(--text-muted)"},children:"..."}),ie.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:180,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:ie.map(ze=>e.jsxs("div",{style:{padding:"7px 10px",cursor:"pointer",fontSize:11,borderBottom:"1px solid var(--border)",opacity:_e.includes(ze.id)?.4:1},onClick:()=>!_e.includes(ze.id)&&st(ze),onMouseEnter:et=>et.currentTarget.style.background="rgba(59,130,246,0.08)",onMouseLeave:et=>et.currentTarget.style.background="transparent",children:[e.jsx("div",{style:{fontWeight:500},children:ze.title}),e.jsxs("div",{style:{fontSize:9,color:"var(--text-muted)"},children:[ze.owner&&e.jsx("span",{children:ze.owner}),ze.status_name&&e.jsxs("span",{children:[" | ",ze.status_name]})]})]},ze.id))})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",style:{fontSize:11,whiteSpace:"nowrap"},onClick:()=>{be(!0),he(""),ve([])},children:"+ Nowe"})]})}),Ve&&e.jsxs("form",{onSubmit:_t,style:{background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:8,padding:12,marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600,fontSize:12,color:"var(--blue)"},children:"Nowe dzialanie"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10},onClick:()=>be(!1),children:"Anuluj"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Tytul dzialania *"}),e.jsx("input",{name:"title",className:"form-control",required:!0,style:{fontSize:12},placeholder:"np. Wdrozenie MFA"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Wlasciciel"}),e.jsx("input",{name:"action_owner",className:"form-control",style:{fontSize:12},placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Termin"}),e.jsx("input",{type:"date",name:"due_date",className:"form-control",style:{fontSize:12}})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:11},children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,style:{fontSize:12},placeholder:"Opis dzialania..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:6,marginTop:8},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>be(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",disabled:oe,children:oe?"Tworzenie...":"Utworz i powiaz"})]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{width:"100%",marginTop:6},onClick:()=>{f("list"),D(null)},children:"Zakoncz  wroc do listy ryzyk"})]})]})}function KA({assetId:t,assetName:r}){const[a,s]=m.useState([]),[o,d]=m.useState(!0);if(m.useEffect(()=>{d(!0),le.get(`/api/v1/assets/${t}/relationships`).then(s).catch(()=>s([])).finally(()=>d(!1))},[t]),o)return e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie grafu..."});if(a.length===0)return e.jsxs("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{children:"Ten aktyw nie ma zdefiniowanych relacji."})]});const u=new Map;for(const y of a){const S=y.source_asset_id===t,w=S?y.target_asset_id:y.source_asset_id,b=S?y.target_asset_name||`Asset #${w}`:y.source_asset_name||`Asset #${w}`;u.has(w)||u.set(w,{name:b,relations:[]}),u.get(w).relations.push({type:y.relationship_type,direction:S?"out":"in",description:y.description})}const h={depends_on:"#F59E0B",supports:"#3B82F6",connects_to:"#8B5CF6",contains:"#10B981",backup_of:"#06B6D4",replaces:"#EF4444",runs_on:"#F97316",managed_by:"#6366F1",used_by:"#EC4899",hosted_on:"#14B8A6"},f=[...u.entries()],p=300,x=200,j=150;return e.jsxs("div",{children:[e.jsxs("svg",{width:"100%",viewBox:"0 0 600 400",style:{background:"rgba(0,0,0,0.1)",borderRadius:8},children:[e.jsx("circle",{cx:p,cy:x,r:32,fill:"var(--blue)",opacity:.9}),e.jsx("text",{x:p,y:x+4,textAnchor:"middle",fill:"white",fontSize:11,fontWeight:600,children:r.length>12?r.slice(0,12)+"...":r}),f.map(([y,S],w)=>{const b=2*Math.PI*w/f.length-Math.PI/2,_=p+j*Math.cos(b),E=x+j*Math.sin(b),C=h[S.relations[0]?.type]||"#666";return e.jsxs("g",{children:[e.jsx("line",{x1:p,y1:x,x2:_,y2:E,stroke:C,strokeWidth:2,opacity:.6}),e.jsx("text",{x:(p+_)/2,y:(x+E)/2-6,textAnchor:"middle",fill:C,fontSize:9,fontWeight:500,children:S.relations[0]?.type}),S.relations[0]?.direction==="out"&&e.jsx("circle",{cx:_-(_-p)*.15,cy:E-(E-x)*.15,r:3,fill:C}),e.jsx("circle",{cx:_,cy:E,r:26,fill:"var(--bg-card)",stroke:C,strokeWidth:2}),e.jsx("text",{x:_,y:E+4,textAnchor:"middle",fill:"var(--text-primary)",fontSize:10,children:S.name.length>14?S.name.slice(0,14)+"...":S.name})]},y)})]}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginTop:12,justifyContent:"center"},children:[...new Set(a.map(y=>y.relationship_type))].map(y=>e.jsx("span",{style:{fontSize:10,padding:"2px 8px",borderRadius:8,background:(h[y]||"#666")+"20",color:h[y]||"#666"},children:y},y))}),e.jsx("div",{style:{marginTop:16,maxHeight:200,overflowY:"auto"},children:a.map(y=>{const S=y.source_asset_id===t;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"6px 10px",fontSize:12,borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",flexShrink:0,background:h[y.relationship_type]||"#666"}}),e.jsx("span",{style:{color:"var(--text-muted)",minWidth:80},children:y.relationship_type}),e.jsx("span",{children:S?"":""}),e.jsx("span",{style:{fontWeight:500},children:S?y.target_asset_name:y.source_asset_name})]},y.id)})})]})}const Ep={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function Jm(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("krytycz")||r.includes("critical")?"var(--red)":r.includes("wysok")||r.includes("high")?"var(--orange)":r.includes("redni")||r.includes("medium")?"var(--blue)":"var(--green)"}function Uo(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("zamkn")||r.includes("complet")||r.includes("wykonan")?"var(--green)":r.includes("w trakcie")||r.includes("progress")||r.includes("realizac")?"var(--blue)":r.includes("anulowa")||r.includes("cancel")?"var(--text-muted)":r.includes("przetermin")||r.includes("overdue")?"var(--red)":"var(--orange)"}function qA(t){return t?Math.ceil((new Date(t).getTime()-Date.now())/864e5):null}function du(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function YA(t){return t<1024?`${t} B`:t<1048576?`${(t/1024).toFixed(1)} KB`:`${(t/1048576).toFixed(1)} MB`}const vb={title:"Tytu",description:"Opis",org_unit_id:"Jednostka org.",owner:"Waciciel",responsible:"Odpowiedzialny",priority_id:"Priorytet",status_id:"Status",source_id:"rdo",due_date:"Termin realizacji",completed_at:"Zamknito",effectiveness_rating:"Ocena skutecznoci",effectiveness_notes:"Notatki skutecznoci",implementation_notes:"Notatki wdroenia"},hm=[{key:"id",header:"ID",format:t=>`D-${t.id}`},{key:"title",header:"Tytu"},{key:"org_unit_name",header:"Pion",format:t=>t.org_unit_name??""},{key:"priority_name",header:"Priorytet",format:t=>t.priority_name??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"due_date",header:"Termin",format:t=>t.due_date?.slice(0,10)??""},{key:"responsible",header:"Odpowiedzialny",format:t=>t.responsible??t.owner??""},{key:"links",header:"Powizania",format:t=>String(t.links?.length??0)},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1},{key:"owner",header:"Waciciel",format:t=>t.owner??"",defaultVisible:!1},{key:"source_name",header:"rdo",format:t=>t.source_name??"",defaultVisible:!1},{key:"completed_at",header:"Ukoczono",format:t=>t.completed_at?.slice(0,10)??"",defaultVisible:!1},{key:"effectiveness_rating",header:"Ocena skut.",format:t=>t.effectiveness_rating!=null?`${t.effectiveness_rating}/5`:"",defaultVisible:!1},{key:"is_overdue",header:"Przeterminowane",format:t=>t.is_overdue?"TAK":"NIE",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:t=>t.updated_at?.slice(0,10)??"",defaultVisible:!1}];function JA({data:t,color1:r,color2:a,label1:s,label2:o}){const d=Math.max(...t.map(u=>Math.max(u.v1,u.v2)),1);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:12,fontSize:10,color:"var(--text-muted)",marginBottom:6},children:[e.jsxs("span",{children:[e.jsx("span",{style:{display:"inline-block",width:8,height:8,borderRadius:2,background:r,marginRight:4}}),s]}),e.jsxs("span",{children:[e.jsx("span",{style:{display:"inline-block",width:8,height:8,borderRadius:2,background:a,marginRight:4}}),o]})]}),e.jsx("div",{style:{display:"flex",gap:2,alignItems:"flex-end",height:60},children:t.map((u,h)=>e.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:1},children:[e.jsxs("div",{style:{display:"flex",gap:1,alignItems:"flex-end",height:50},children:[e.jsx("div",{style:{width:6,height:Math.max(2,u.v1/d*50),background:r,borderRadius:1},title:`${s}: ${u.v1}`}),e.jsx("div",{style:{width:6,height:Math.max(2,u.v2/d*50),background:a,borderRadius:1},title:`${o}: ${u.v2}`})]}),e.jsx("div",{style:{fontSize:8,color:"var(--text-muted)",whiteSpace:"nowrap"},children:u.label.slice(5)})]},h))})]})}function XA({stats:t}){return t?e.jsxs("div",{className:"card",style:{marginBottom:16,padding:16},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:e.jsx("div",{className:"card-title",style:{margin:0,fontSize:13},children:"Dashboard KPI"})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Podzia wg statusu"}),t.by_status.map((r,a)=>{const s=t.total>0?r.count/t.total*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx("span",{style:{fontSize:11,width:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.status_name}),e.jsx("div",{style:{flex:1,height:6,borderRadius:3,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s}%`,height:"100%",borderRadius:3,background:Uo(r.status_name)}})}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace",width:24,textAlign:"right"},children:r.count})]},a)})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Podzia wg priorytetu"}),t.by_priority.map((r,a)=>{const s=t.total>0?r.count/t.total*100:0;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsx("span",{style:{fontSize:11,width:100,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.priority_name}),e.jsx("div",{style:{flex:1,height:6,borderRadius:3,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s}%`,height:"100%",borderRadius:3,background:Jm(r.priority_name)}})}),e.jsx("span",{style:{fontSize:10,fontFamily:"'JetBrains Mono',monospace",width:24,textAlign:"right"},children:r.count})]},a)}),t.avg_completion_days!=null&&e.jsxs("div",{style:{marginTop:8,fontSize:11,color:"var(--text-muted)"},children:["r. czas realizacji: ",e.jsxs("span",{style:{fontWeight:600,color:"var(--blue)",fontFamily:"'JetBrains Mono',monospace"},children:[t.avg_completion_days," dni"]})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:"Trend miesiczny (12 mies.)"}),e.jsx(JA,{data:t.monthly_trend.map(r=>({label:r.month,v1:r.created,v2:r.completed})),color1:"var(--blue)",color2:"var(--green)",label1:"Utworzone",label2:"Ukoczone"})]})]})]}):null}function QA({selectedIds:t,lookups:r,onBulkDone:a}){const[s,o]=m.useState("status"),[d,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(!1),j=async()=>{if(!d){alert("Wybierz warto");return}x(!0);const y={action_ids:t};s==="status"?y.status_id=Number(d):s==="priority"?y.priority_id=Number(d):y.responsible=d,h&&(y.change_reason=h);try{await le.post("/api/v1/actions/bulk",y),a()}catch(S){alert("Bd: "+S)}x(!1)};return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 14px",marginBottom:8,background:"rgba(59,130,246,0.08)",borderRadius:8,border:"1px solid rgba(59,130,246,0.2)"},children:[e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"var(--blue)"},children:["Zaznaczono: ",t.length]}),e.jsxs("select",{className:"form-control",style:{width:130,fontSize:11,padding:"4px 8px"},value:s,onChange:y=>{o(y.target.value),u("")},children:[e.jsx("option",{value:"status",children:"Status"}),e.jsx("option",{value:"priority",children:"Priorytet"}),e.jsx("option",{value:"responsible",children:"Odpowiedzialny"})]}),s==="responsible"?e.jsx("input",{className:"form-control",style:{width:160,fontSize:11,padding:"4px 8px"},placeholder:"Nowy odpowiedzialny...",value:d,onChange:y=>u(y.target.value)}):e.jsxs("select",{className:"form-control",style:{width:160,fontSize:11,padding:"4px 8px"},value:d,onChange:y=>u(y.target.value),children:[e.jsx("option",{value:"",children:"Wybierz..."}),(s==="status"?r?.statuses:r?.priorities)?.map(y=>e.jsx("option",{value:y.id,children:y.label},y.id))]}),e.jsx("input",{className:"form-control",style:{width:200,fontSize:11,padding:"4px 8px"},placeholder:"Powd zmiany (opcjonalnie)...",value:h,onChange:y=>f(y.target.value)}),e.jsx("button",{className:"btn btn-sm btn-primary",disabled:p||!d,onClick:j,style:{fontSize:11},children:p?"...":"Zastosuj"})]})}function eE(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(null),[_,E]=m.useState(!1),[C,N]=m.useState(null),[O,Q]=m.useState(!1),[G,M]=m.useState(new Set),{visible:U,toggle:A}=da(hm,"actions"),R=Aa({data:t,storageKey:"actions",defaultSort:"due_date",defaultSortDir:"asc"}),[Z,F]=m.useState([]),q=m.useCallback(()=>{s(!0),d(null),le.get("/api/v1/actions").then(je=>{const fe=(je??[]).map(_e=>({..._e,links:_e.links??[],history:_e.history??[],attachments:_e.attachments??[]}));r(fe),d(null)}).catch(je=>{console.error("Failed to load actions:",je),d(String(je))}).finally(()=>s(!1))},[]),ee=m.useCallback(()=>{le.get("/api/v1/actions/stats").then(N).catch(()=>{})},[]);m.useEffect(()=>{le.post("/api/v1/actions/auto-overdue",{}).catch(()=>{}).finally(()=>{q(),ee()}),le.get("/api/v1/org-units/tree").then(F).catch(()=>{})},[q,ee]);const me=m.useMemo(()=>Cl(Z),[Z]),W=async()=>{if(y)return y;const je=await le.get("/api/v1/org-units/tree").catch(()=>[]),fe=async Ue=>{try{return(await le.get(`/api/v1/dictionaries/${Ue}/entries`)).entries.filter(lt=>lt.is_active).map(lt=>({id:lt.id,label:lt.label}))}catch{return[]}},[_e,Se,Ve]=await Promise.all([fe("action_priority"),fe("action_status"),fe("action_source")]),be=await le.get("/api/v1/risks").catch(()=>[]),oe={orgUnits:je,priorities:_e,statuses:Se,sources:Ve,allRisks:be};return S(oe),oe},J=async()=>{await W(),p(null),h(!0)},L=async je=>{await W(),p(je),h(!0)},H=async je=>{if(confirm(`Archiwizowac dzialanie "${je.title}"?`))try{await le.delete(`/api/v1/actions/${je.id}`),b(null),s(!0),q(),ee()}catch(fe){alert("Blad: "+fe)}},ne=()=>{const je=Ep?.VITE_API_BASE??"";window.open(`${je}/api/v1/actions/export`,"_blank")},P=je=>{M(fe=>{const _e=new Set(fe);return _e.has(je)?_e.delete(je):_e.add(je),_e})},T=()=>{G.size===R.pageData.length?M(new Set):M(new Set(R.pageData.map(je=>je.id)))},z=R.filtered.filter(je=>je.is_overdue).length,k=t.filter(je=>je.is_overdue).length,I=R.filtered.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("trakcie")||fe.includes("progress")}).length,D=t.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("trakcie")||fe.includes("progress")}).length,de=R.filtered.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("zamkn")||fe.includes("complet")||fe.includes("wykonan")}).length,he=t.filter(je=>{const fe=(je.status_name??"").toLowerCase();return fe.includes("zamkn")||fe.includes("complet")||fe.includes("wykonan")}).length,ie=[{label:"Wszystkich dziaa",value:R.filteredCount,total:R.totalCount,color:"var(--blue)"},{label:"Przeterminowanych",value:z,total:k,color:"var(--red)"},{label:"W trakcie",value:I,total:D,color:"var(--orange)"},{label:"Ukoczonych",value:de,total:he,color:"var(--green)"}],ve=R.hasActiveFilters||!!R.search;return e.jsxs("div",{children:[o&&e.jsx("div",{className:"card",style:{marginBottom:12,padding:16,border:"1px solid var(--red)",background:"rgba(239,68,68,0.06)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{color:"var(--red)",fontSize:13},children:["Blad ladowania dzialan: ",o]}),e.jsx("button",{className:"btn btn-sm",onClick:q,children:"Ponow"})]})}),e.jsx(Ia,{cards:ie,isFiltered:ve}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8},children:[e.jsxs("button",{className:"btn btn-sm",style:{fontSize:11,color:O?"var(--blue)":void 0},onClick:()=>Q(je=>!je),children:[O?"Ukryj":"Poka"," Dashboard KPI"]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11},onClick:ne,title:"Eksport do Excel z ryzykami i histori",children:"Eksport szczegowy (XLSX)"})]}),O&&e.jsx(XA,{stats:C}),G.size>0&&e.jsx(QA,{selectedIds:Array.from(G),lookups:y,onBulkDone:()=>{M(new Set),s(!0),q(),ee(),S(null)}}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"dziaa",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj dziaa...",showFilters:_,onToggleFilters:()=>E(je=>!je),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:hm,visibleColumns:U,onToggleColumn:A,data:R.filtered,exportFilename:"dzialania",primaryLabel:"Dodaj dziaanie",onPrimaryAction:J}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:w?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:hm,visibleColumns:U,data:R.pageData,rowKey:je=>je.id,selectedKey:w?.id??null,onRowClick:je=>b(w?.id===je.id?null:je),rowBorderColor:je=>je.is_overdue?"var(--red)":je.completed_at?"var(--green)":void 0,sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:_,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:a,emptyMessage:"Brak dziaa w systemie.",emptyFilteredMessage:"Brak dziaa pasujcych do filtrw.",renderCell:(je,fe)=>{if(fe==="id")return e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:G.has(je.id),onChange:()=>P(je.id),onClick:_e=>_e.stopPropagation(),style:{cursor:"pointer"}}),e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:["D-",je.id]})]});if(fe==="title")return e.jsx("span",{style:{fontWeight:500,maxWidth:260,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"inline-block"},children:je.title});if(fe==="priority_name")return je.priority_name?e.jsx("span",{style:{fontSize:12,fontWeight:500,color:Jm(je.priority_name)},children:je.priority_name}):e.jsx("span",{children:""});if(fe==="status_name")return je.status_name?e.jsx("span",{className:"score-badge",style:{background:`${Uo(je.status_name)}20`,color:Uo(je.status_name)},children:je.status_name}):e.jsx("span",{children:""});if(fe==="due_date"){if(!je.due_date)return e.jsx("span",{children:""});const _e=qA(je.due_date);return e.jsxs("span",{style:{fontSize:11,fontFamily:"'JetBrains Mono',monospace",color:je.is_overdue?"var(--red)":_e!=null&&_e<=7?"var(--orange)":"var(--text-secondary)"},children:[je.due_date.slice(0,10),je.is_overdue&&e.jsx("span",{style:{marginLeft:4,fontSize:10,color:"var(--red)"},children:"!"})]})}if(fe==="links")return(je.links?.length??0)>0?e.jsx("span",{className:"score-badge",style:{background:"var(--cyan-dim)",color:"var(--cyan)"},children:je.links.length}):e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"0"})},renderHeaderExtra:je=>{if(je==="id")return e.jsx("input",{type:"checkbox",checked:G.size>0&&G.size===R.pageData.length,onChange:T,onClick:fe=>fe.stopPropagation(),style:{cursor:"pointer",marginRight:4}})}}),w&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 80px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy dziaania"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>b(null),children:""})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"var(--text-primary)",lineHeight:1.3},children:w.title}),e.jsxs("div",{style:{display:"flex",gap:6,justifyContent:"center",marginTop:6},children:[w.is_overdue&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)",fontSize:11},children:"Przeterminowane"}),w.completed_at&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)",fontSize:11},children:"Zamknite"}),w.status_name&&e.jsx("span",{className:"score-badge",style:{background:`${Uo(w.status_name)}20`,color:Uo(w.status_name),fontSize:11},children:w.status_name})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Fr,{label:"ID",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:["D-",w.id]})}),e.jsx(Fr,{label:"Jednostka org.",value:e.jsx("span",{style:{fontSize:11},children:(w.org_unit_id?me.get(w.org_unit_id):null)??w.org_unit_name??""})}),e.jsx(Fr,{label:"Waciciel",value:w.owner}),e.jsx(Fr,{label:"Odpowiedzialny",value:w.responsible}),e.jsx(Fr,{label:"Priorytet",value:w.priority_name?e.jsx("span",{style:{fontWeight:500,color:Jm(w.priority_name)},children:w.priority_name}):""}),e.jsx(Fr,{label:"rdo",value:w.source_name}),e.jsx(Fr,{label:"Termin",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:w.is_overdue?"var(--red)":"var(--text-secondary)"},children:w.due_date?.slice(0,10)??""})}),w.completed_at&&e.jsx(Fr,{label:"Zamknite",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--green)"},children:w.completed_at.slice(0,10)})}),w.effectiveness_rating!=null&&e.jsx(Fr,{label:"Skuteczno",value:e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)"},children:[w.effectiveness_rating,"/5 ",["","Minimalna","Niska","rednia","Wysoka","Pena"][w.effectiveness_rating]]})}),e.jsx(Fr,{label:"Utworzono",value:w.created_at?.slice(0,10)}),w.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,whiteSpace:"pre-wrap"},children:w.description})]}),(w.links?.length??0)>0&&e.jsxs("div",{style:{marginTop:10},children:[e.jsxs("div",{style:{color:"var(--text-muted)",marginBottom:4},children:["Powizane obiekty (",w.links.length,")"]}),(w.links??[]).map(je=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"5px 8px",borderRadius:6,marginBottom:3,background:je.entity_type==="risk"?"rgba(239,68,68,0.06)":"rgba(59,130,246,0.06)",border:`1px solid ${je.entity_type==="risk"?"rgba(239,68,68,0.15)":"rgba(59,130,246,0.15)"}`},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)",textTransform:"uppercase",marginRight:4},children:je.entity_type==="risk"?"Ryzyko":je.entity_type==="asset"?"Aktyw":je.entity_type}),e.jsx("span",{style:{fontSize:12,fontWeight:500},children:je.entity_name??`#${je.entity_id}`})]}),je.entity_extra?.risk_score!=null&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600,color:du(Number(je.entity_extra.risk_score))},children:Number(je.entity_extra.risk_score).toFixed(1)})]},je.id))]}),(w.history?.length??0)>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Ostatnie zmiany"}),e.jsxs("div",{style:{maxHeight:160,overflowY:"auto"},children:[(w.history??[]).slice(0,5).map(je=>e.jsxs("div",{style:{fontSize:11,padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:je.created_at?.slice(0,16).replace("T"," ")})," ",e.jsx("span",{style:{color:"var(--blue)"},children:vb[je.field_name]??je.field_name}),je.old_value&&e.jsx("span",{style:{color:"var(--red)",textDecoration:"line-through",marginLeft:4,fontSize:10},children:je.old_value.length>40?je.old_value.slice(0,40)+"...":je.old_value}),e.jsx("span",{style:{color:"var(--green)",marginLeft:4,fontSize:10},children:je.new_value&&(je.new_value.length>40?je.new_value.slice(0,40)+"...":je.new_value)}),je.change_reason&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",fontStyle:"italic",marginLeft:8},children:["Powd: ",je.change_reason]})]},je.id)),(w.history?.length??0)>5&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:"4px 0",textAlign:"center"},children:["...i ",w.history.length-5," wicej"]})]})]})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>L(w),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>H(w),children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:u,onClose:()=>{h(!1),p(null)},title:f?`Edytuj: D-${f.id} ${f.title}`:"Nowe dziaanie",wide:!0,children:y?e.jsx(tE,{editAction:f,lookups:y,orgTree:y.orgUnits,saving:x,setSaving:j,onSaved:je=>{je&&b(je),h(!1),p(null),S(null),s(!0),q(),ee()},onCancel:()=>{h(!1),p(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie danych formularza..."})})]})}function Fr({label:t,value:r}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:t}),e.jsx("span",{children:r??""})]})}function tE({editAction:t,lookups:r,orgTree:a,saving:s,setSaving:o,onSaved:d,onCancel:u}){const[h,f]=m.useState("description"),p=!!t,[x,j]=m.useState(t?.title??""),[y,S]=m.useState(t?.description??""),[w,b]=m.useState(t?.org_unit_id??null),[_,E]=m.useState(t?.priority_id??null),[C,N]=m.useState(t?.status_id??null),[O,Q]=m.useState(t?.source_id??null),[G,M]=m.useState(t?.owner??""),[U,A]=m.useState(t?.responsible??""),[R,Z]=m.useState(t?.due_date?.slice(0,10)??""),[F,q]=m.useState(()=>(t?.links??[]).filter(Ve=>Ve.entity_type==="risk").map(Ve=>Ve.entity_id)),[ee,me]=m.useState(t?.implementation_notes??""),[W,J]=m.useState(t?.effectiveness_rating??null),[L,H]=m.useState(t?.effectiveness_notes??""),[ne,P]=m.useState(()=>t?.attachments??[]),[T,z]=m.useState(!1),[k,I]=m.useState(""),D=m.useRef(null),de=m.useMemo(()=>(t?.links??[]).filter(Ve=>Ve.entity_type!=="risk"),[t]),he=m.useCallback(()=>t?x!==t.title||y!==(t.description??"")||G!==(t.owner??"")||U!==(t.responsible??"")||R!==(t.due_date?.slice(0,10)??"")||C!==t.status_id||_!==t.priority_id:!1,[t,x,y,G,U,R,C,_]),ie=async Ve=>{if(!x.trim()){alert("Tytu jest wymagany");return}o(!0);const be=[...F.map(Ue=>({entity_type:"risk",entity_id:Ue})),...de.map(Ue=>({entity_type:Ue.entity_type,entity_id:Ue.entity_id}))],oe={title:x.trim(),description:y||null,org_unit_id:w,owner:G||null,responsible:U||null,priority_id:_,status_id:C,source_id:O,due_date:R||null,links:be};p&&(oe.implementation_notes=ee||null,oe.effectiveness_rating=W,oe.effectiveness_notes=L||null,Ve&&(oe.change_reason=Ve));try{if(p){const Ue=await le.put(`/api/v1/actions/${t.id}`,oe);d(Ue)}else await le.post("/api/v1/actions",oe),d()}catch(Ue){alert("Bd zapisu: "+Ue)}finally{o(!1)}},ve=()=>{p&&he()?(D.current=()=>ie(k),I(""),z(!0)):ie()},je=()=>{z(!1),ie(k||void 0)},fe=Ve=>({padding:"8px 16px",fontSize:12,fontWeight:h===Ve?600:400,cursor:"pointer",borderBottom:h===Ve?"2px solid var(--blue)":"2px solid transparent",color:h===Ve?"var(--blue)":"var(--text-muted)"}),_e=async Ve=>{if(!t||!Ve.target.files?.length)return;const be=Ve.target.files[0],oe=new FormData;oe.append("file",be);try{const Ue=await fetch(`${Ep?.VITE_API_URL??""}/api/v1/actions/${t.id}/attachments`,{method:"POST",body:oe});if(!Ue.ok)throw new Error(await Ue.text());const Qe=await Ue.json();P(lt=>[Qe,...lt])}catch(Ue){alert("Bd uploadu: "+Ue)}Ve.target.value=""},Se=async Ve=>{if(t&&confirm("Usun zacznik?"))try{await le.delete(`/api/v1/actions/${t.id}/attachments/${Ve}`),P(be=>be.filter(oe=>oe.id!==Ve))}catch(be){alert("Bd: "+be)}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:0,borderBottom:"1px solid var(--border)",marginBottom:16},children:[e.jsx("span",{style:fe("description"),onClick:()=>f("description"),children:"Opis dziaania"}),e.jsxs("span",{style:fe("links"),onClick:()=>f("links"),children:["Powizania",F.length>0&&e.jsxs("span",{style:{marginLeft:4,fontSize:10,color:"var(--cyan)",fontWeight:700},children:["(",F.length,")"]})]}),p&&e.jsx("span",{style:fe("effectiveness"),onClick:()=>f("effectiveness"),children:"Skuteczno"}),p&&e.jsx("span",{style:fe("comments"),onClick:()=>f("comments"),children:"Komentarze"}),p&&e.jsxs("span",{style:fe("history"),onClick:()=>f("history"),children:["Historia",t?.history?.length?e.jsxs("span",{style:{marginLeft:4,fontSize:10,color:"var(--text-muted)"},children:["(",t.history.length,")"]}):null]})]}),h==="description"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytu dziaania *"}),e.jsx("input",{className:"form-control",value:x,onChange:Ve=>j(Ve.target.value),placeholder:"np. Wdroenie MFA dla kont administracyjnych"}),!x.trim()&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:y,onChange:Ve=>S(Ve.target.value),placeholder:"Opisz dziaanie, cele, kroki..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx(jn,{tree:a,value:w,onChange:b,placeholder:"Wybierz...",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priorytet"}),e.jsxs("select",{className:"form-control",value:_??"",onChange:Ve=>E(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.priorities.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:C??"",onChange:Ve=>N(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.statuses.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"rdo"}),e.jsxs("select",{className:"form-control",value:O??"",onChange:Ve=>Q(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),r.sources.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.label},Ve.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel"}),e.jsx("input",{className:"form-control",value:G,onChange:Ve=>M(Ve.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny za realizacj"}),e.jsx("input",{className:"form-control",value:U,onChange:Ve=>A(Ve.target.value),placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin realizacji"}),e.jsx("input",{type:"date",className:"form-control",value:R,onChange:Ve=>Z(Ve.target.value)})]})]}),h==="links"&&e.jsx(aE,{allRisks:r.allRisks,linkedRiskIds:F,setLinkedRiskIds:q,otherLinks:de}),h==="effectiveness"&&t&&e.jsx(nE,{editAction:t,implementationNotes:ee,setImplementationNotes:me,effectivenessRating:W,setEffectivenessRating:J,effectivenessNotes:L,setEffectivenessNotes:H,attachments:ne,onFileUpload:_e,onDeleteAttachment:Se}),h==="comments"&&t&&e.jsx(rE,{actionId:t.id}),h==="history"&&t&&e.jsx(iE,{history:t.history??[]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:14},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!x.trim(),onClick:ve,children:s?"Zapisywanie...":p?"Zapisz zmiany":"Dodaj dziaanie"})]}),T&&e.jsx("div",{style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,0.5)"},onClick:()=>z(!1),children:e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:12,padding:24,maxWidth:480,width:"90%",boxShadow:"0 8px 32px rgba(0,0,0,0.4)"},onClick:Ve=>Ve.stopPropagation(),children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"var(--blue)"},children:"Powd zmiany"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:12},children:"Wykryto zmiany w ledzonych polach (tytu, opis, termin, waciciel, status, priorytet, odpowiedzialny). Podaj uzasadnienie zmian  zostanie zapisane w historii."}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:Ve=>I(Ve.target.value),placeholder:"np. Przesunicie terminu ze wzgldu na brak zasobw...",autoFocus:!0}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>z(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{color:"var(--text-muted)"},onClick:()=>{z(!1),ie()},children:"Zapisz bez powodu"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:je,disabled:!k.trim(),children:"Zapisz ze zmianami"})]})]})})]})}function aE({allRisks:t,linkedRiskIds:r,setLinkedRiskIds:a,otherLinks:s}){const[o,d]=m.useState(""),u=t.filter(j=>r.includes(j.id)),h=t.filter(j=>!r.includes(j.id)),f=o.length>=1?h.filter(j=>{const y=o.toLowerCase();return j.asset_name.toLowerCase().includes(y)||(j.code??`R-${j.id}`).toLowerCase().includes(y)||(j.org_unit_name??"").toLowerCase().includes(y)||(j.owner??"").toLowerCase().includes(y)||(j.risk_category_name??"").toLowerCase().includes(y)}).slice(0,10):[],p=j=>{a([...r,j]),d("")},x=j=>a(r.filter(y=>y!==j));return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:14},children:[e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:["Powizane ryzyka (",u.length,")"]}),u.length===0&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak powizanych ryzyk. Wyszukaj i dodaj ryzyko poniej."}),u.map(j=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",borderRadius:8,marginBottom:6,background:"rgba(239,68,68,0.05)",border:"1px solid rgba(239,68,68,0.15)"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:2},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:j.code||`R-${j.id}`}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:j.asset_name}),j.risk_score!=null&&e.jsx("span",{className:"score-badge",style:{background:`${du(Number(j.risk_score))}20`,color:du(Number(j.risk_score)),fontSize:10,padding:"1px 6px"},children:Number(j.risk_score).toFixed(1)})]}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:10,flexWrap:"wrap"},children:[j.org_unit_name&&e.jsx("span",{children:j.org_unit_name}),j.risk_category_name&&e.jsx("span",{children:j.risk_category_name}),j.security_area_name&&e.jsx("span",{children:j.security_area_name}),j.status_name&&e.jsxs("span",{children:["Status: ",j.status_name]}),j.owner&&e.jsxs("span",{children:["Wac.: ",j.owner]})]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"2px 8px",fontSize:11,color:"var(--red)"},onClick:()=>x(j.id),children:""})]},j.id))]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{className:"form-control",style:{fontSize:12},placeholder:"Szukaj ryzyka po aktywie, kodzie, jednostce, wacicielu, kategorii...",value:o,onChange:j=>d(j.target.value)}),f.length>0&&e.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,maxHeight:300,overflowY:"auto",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2},children:f.map(j=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid var(--border)"},onClick:()=>p(j.id),onMouseEnter:y=>y.currentTarget.style.background="rgba(239,68,68,0.06)",onMouseLeave:y=>y.currentTarget.style.background="transparent",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:j.code||`R-${j.id}`}),e.jsx("span",{style:{fontWeight:500,fontSize:12},children:j.asset_name}),j.risk_score!=null&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600,color:du(Number(j.risk_score))},children:Number(j.risk_score).toFixed(1)})]}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",display:"flex",gap:8,marginTop:2},children:[j.org_unit_name&&e.jsx("span",{children:j.org_unit_name}),j.risk_category_name&&e.jsx("span",{children:j.risk_category_name}),j.status_name&&e.jsx("span",{children:j.status_name}),j.owner&&e.jsx("span",{children:j.owner})]})]},j.id))}),o.length>=1&&f.length===0&&e.jsxs("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:10,background:"var(--bg-card)",border:"1px solid var(--border)",borderRadius:6,padding:"12px 14px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",marginTop:2,fontSize:12,color:"var(--text-muted)",textAlign:"center"},children:['Brak wynikw dla "',o,'"']})]}),s.length>0&&e.jsxs("div",{style:{marginTop:16,padding:10,background:"rgba(59,130,246,0.04)",borderRadius:8,border:"1px solid rgba(59,130,246,0.15)"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:6},children:"Inne powizania (informacyjnie)"}),s.map(j=>e.jsxs("div",{style:{fontSize:12,padding:"3px 0",display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:9,color:"var(--blue)",textTransform:"uppercase",fontWeight:600},children:j.entity_type==="asset"?"Aktyw":j.entity_type==="incident"?"Incydent":j.entity_type==="audit"?"Audyt":j.entity_type==="policy_exception"?"Wyjtek":j.entity_type}),e.jsx("span",{children:j.entity_name??`#${j.entity_id}`})]},j.id))]})]})}function nE({editAction:t,implementationNotes:r,setImplementationNotes:a,effectivenessRating:s,setEffectivenessRating:o,effectivenessNotes:d,setEffectivenessNotes:u,attachments:h,onFileUpload:f,onDeleteAttachment:p}){const x=m.useRef(null),j=Ep?.VITE_API_URL??"",y=["","1  Minimalna","2  Niska","3  rednia","4  Wysoka","5  Pena"];return e.jsxs("div",{children:[t.completed_at&&e.jsx("div",{style:{marginBottom:14,padding:12,background:"rgba(52,211,153,0.08)",borderRadius:8,border:"1px solid rgba(52,211,153,0.2)"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"score-badge",style:{background:"rgba(34,197,94,0.15)",color:"var(--green)",fontSize:11},children:"Zamknite"}),e.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)"},children:t.completed_at.slice(0,10)})]})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis zrealizowanych dziaa"}),e.jsx("textarea",{className:"form-control",rows:4,value:r,onChange:S=>a(S.target.value),placeholder:"Opisz co zostao wykonane, jakie kroki podjto, jakie wyniki osignito..."})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ocena skutecznoci mitygacji ryzyka (1-5)"}),e.jsxs("select",{className:"form-control",value:s??"",onChange:S=>o(S.target.value?Number(S.target.value):null),children:[e.jsx("option",{value:"",children:"Brak oceny"}),e.jsx("option",{value:"1",children:"1  Minimalna (dziaanie niemal bez efektu)"}),e.jsx("option",{value:"2",children:"2  Niska (czciowo zrealizowane)"}),e.jsx("option",{value:"3",children:"3  rednia (zrealizowane, umiarkowany efekt)"}),e.jsx("option",{value:"4",children:"4  Wysoka (dobrze zrealizowane)"}),e.jsx("option",{value:"5",children:"5  Pena (w peni skuteczne)"})]})]}),s!=null&&e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("div",{style:{width:"100%",height:8,borderRadius:4,background:"var(--bg-subtle)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${s*20}%`,height:"100%",borderRadius:4,background:s>=4?"var(--green)":s>=3?"var(--blue)":s>=2?"var(--orange)":"var(--red)",transition:"width 0.3s"}})}),e.jsx("span",{style:{marginLeft:8,fontSize:12,fontWeight:600,fontFamily:"'JetBrains Mono',monospace"},children:y[s]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki dot. skutecznoci"}),e.jsx("textarea",{className:"form-control",rows:2,value:d,onChange:S=>u(S.target.value),placeholder:"Opisz rezultaty, co si udao, co mona poprawi..."})]}),e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsxs("label",{style:{fontSize:12,color:"var(--text-muted)"},children:["Zaczniki (",h.length,")"]}),e.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>x.current?.click(),children:"+ Dodaj zacznik"}),e.jsx("input",{type:"file",ref:x,style:{display:"none"},onChange:f})]}),h.length===0&&e.jsx("div",{style:{padding:16,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak zacznikw. Dodaj pliki jako dowody realizacji dziaania."}),h.map(S=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",borderRadius:6,marginBottom:4,background:"rgba(59,130,246,0.04)",border:"1px solid rgba(59,130,246,0.12)"},children:[e.jsxs("div",{children:[e.jsx("a",{href:`${j}/api/v1/actions/${t.id}/attachments/${S.id}/download`,target:"_blank",rel:"noopener noreferrer",style:{fontSize:12,fontWeight:500,color:"var(--blue)",textDecoration:"none"},children:S.original_name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:[YA(S.file_size)," | ",S.created_at.slice(0,16).replace("T"," ")]})]}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"2px 6px",fontSize:10,color:"var(--red)"},onClick:()=>p(S.id),children:""})]},S.id))]})]})}function rE({actionId:t}){const[r,a]=m.useState([]),[s,o]=m.useState(!0),[d,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(""),b=m.useCallback(()=>{le.get(`/api/v1/actions/${t}/comments`).then(a).catch(()=>{}).finally(()=>o(!1))},[t]);m.useEffect(()=>{b()},[b]);const _=async()=>{if(d.trim()){x(!0);try{const N=await le.post(`/api/v1/actions/${t}/comments`,{content:d.trim(),author:h.trim()||null});a(O=>[...O,N]),u("")}catch(N){alert("Bd: "+N)}x(!1)}},E=async N=>{if(S.trim())try{const O=await le.put(`/api/v1/actions/${t}/comments/${N}`,{content:S.trim()});a(Q=>Q.map(G=>G.id===N?O:G)),y(null)}catch(O){alert("Bd: "+O)}},C=async N=>{if(confirm("Usun komentarz?"))try{await le.delete(`/api/v1/actions/${t}/comments/${N}`),a(O=>O.filter(Q=>Q.id!==N))}catch(O){alert("Bd: "+O)}};return s?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"adowanie komentarzy..."}):e.jsxs("div",{children:[e.jsxs("div",{style:{maxHeight:350,overflowY:"auto",marginBottom:16},children:[r.length===0&&e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)",fontSize:12,background:"var(--bg-inset)",borderRadius:8,border:"1px dashed var(--border)"},children:"Brak komentarzy. Dodaj pierwszy komentarz poniej."}),r.map(N=>e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,marginBottom:6,background:"var(--bg-inset)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:"var(--blue)"},children:N.author||"Anonim"}),e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:N.created_at.slice(0,16).replace("T"," ")}),N.updated_at!==N.created_at&&e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)",fontStyle:"italic"},children:"(edytowany)"})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10},onClick:()=>{y(N.id),w(N.content)},children:"Edytuj"}),e.jsx("button",{type:"button",className:"btn btn-sm",style:{padding:"1px 6px",fontSize:10,color:"var(--red)"},onClick:()=>C(N.id),children:"Usu"})]})]}),j===N.id?e.jsxs("div",{children:[e.jsx("textarea",{className:"form-control",rows:2,value:S,onChange:O=>w(O.target.value),style:{fontSize:12}}),e.jsxs("div",{style:{display:"flex",gap:6,marginTop:6,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-sm",style:{fontSize:10},onClick:()=>y(null),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",style:{fontSize:10},onClick:()=>E(N.id),disabled:!S.trim(),children:"Zapisz"})]})]}):e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",whiteSpace:"pre-wrap",lineHeight:1.5},children:N.content})]},N.id))]}),e.jsxs("div",{style:{borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:6},children:"Nowy komentarz"}),e.jsx("div",{style:{display:"flex",gap:8,marginBottom:8},children:e.jsx("input",{className:"form-control",style:{width:180,fontSize:11},placeholder:"Autor (opcjonalnie)",value:h,onChange:N=>f(N.target.value)})}),e.jsx("textarea",{className:"form-control",rows:3,style:{fontSize:12},value:d,onChange:N=>u(N.target.value),placeholder:"Wpisz komentarz, uwag, pytanie..."}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",disabled:p||!d.trim(),onClick:_,children:p?"...":"Dodaj komentarz"})})]})]})}function iE({history:t}){if(t.length===0)return e.jsx("div",{style:{padding:30,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak historii zmian. Zmiany bd rejestrowane automatycznie po pierwszej edycji."});const r=[];let a="";for(const s of t){const o=s.created_at.slice(0,19);o!==a?(r.push({timestamp:o,reason:s.change_reason,entries:[s]}),a=o):(r[r.length-1].entries.push(s),s.change_reason&&!r[r.length-1].reason&&(r[r.length-1].reason=s.change_reason))}return e.jsx("div",{style:{maxHeight:450,overflowY:"auto"},children:r.map((s,o)=>e.jsxs("div",{style:{marginBottom:12,padding:10,borderRadius:8,background:"var(--bg-inset)",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontSize:11,fontFamily:"'JetBrains Mono',monospace",color:"var(--text-muted)"},children:s.timestamp.replace("T"," ")}),s.entries[0].changed_by&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:s.entries[0].changed_by})]}),s.reason&&e.jsxs("div",{style:{fontSize:11,color:"var(--blue)",padding:"4px 8px",background:"rgba(59,130,246,0.06)",borderRadius:4,marginBottom:6,fontStyle:"italic"},children:["Powd: ",s.reason]}),s.entries.map(d=>e.jsxs("div",{style:{fontSize:12,padding:"4px 0",display:"grid",gridTemplateColumns:"120px 1fr",gap:8},children:[e.jsx("span",{style:{color:"var(--blue)",fontWeight:500,fontSize:11},children:vb[d.field_name]??d.field_name}),e.jsxs("div",{children:[d.old_value&&e.jsx("div",{style:{color:"var(--red)",fontSize:11,textDecoration:"line-through",opacity:.8,wordBreak:"break-word"},children:d.old_value}),d.new_value&&e.jsx("div",{style:{color:"var(--green)",fontSize:11,wordBreak:"break-word"},children:d.new_value})]})]},d.id))]},o))})}const sE=["","risks","cis","org_units","dictionaries","security_areas","threats","vulnerabilities","safeguards"],lE={"":"Wszystkie moduy",risks:"Analiza Ryzyka",cis:"CIS Benchmark",org_units:"Struktura Org.",dictionaries:"Sowniki",security_areas:"Obszary bezp.",threats:"Zagroenia",vulnerabilities:"Podatnoci",safeguards:"Zabezpieczenia"},oE={create:{bg:"var(--green-dim)",fg:"var(--green)"},update:{bg:"var(--blue-dim)",fg:"var(--blue)"},delete:{bg:"var(--red-dim)",fg:"var(--red)"},review:{bg:"var(--yellow-dim)",fg:"var(--yellow)"},approve:{bg:"var(--purple-dim)",fg:"var(--purple)"}};function cE(){const[t,r]=m.useState(null),[a,s]=m.useState(!0),[o,d]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(1),x=(y,S,w)=>{s(!0);const b=new URLSearchParams;y&&b.set("module",y),S&&b.set("action",S),b.set("page",String(w)),b.set("per_page","50");const _=b.toString();le.get(`/api/v1/audit-log?${_}`).then(r).catch(()=>r(null)).finally(()=>s(!1))};m.useEffect(()=>{x(o,u,f)},[o,u,f]);const j=t?Math.ceil(t.total/t.per_page):0;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx("select",{className:"form-control",style:{width:180},value:o,onChange:y=>{d(y.target.value),p(1)},children:sE.map(y=>e.jsx("option",{value:y,children:lE[y]??y},y))}),e.jsxs("select",{className:"form-control",style:{width:140},value:u,onChange:y=>{h(y.target.value),p(1)},children:[e.jsx("option",{value:"",children:"Wszystkie akcje"}),e.jsx("option",{value:"create",children:"Utworzenie"}),e.jsx("option",{value:"update",children:"Zmiana"}),e.jsx("option",{value:"delete",children:"Usunicie"}),e.jsx("option",{value:"review",children:"Przegld"}),e.jsx("option",{value:"approve",children:"Zatwierdzenie"})]}),(o||u)&&e.jsx("button",{className:"btn btn-sm",onClick:()=>{d(""),h(""),p(1)},children:"Wyczy filtry"})]}),e.jsx("div",{className:"toolbar-right",children:t&&e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[t.total," wpisw  Strona ",t.page," / ",j||1]})})]}),e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:a?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie..."}):!t||t.items.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak wpisw w audit trail."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Timestamp"}),e.jsx("th",{children:"Akcja"}),e.jsx("th",{children:"Modu"}),e.jsx("th",{children:"Obiekt"}),e.jsx("th",{children:"Pole"}),e.jsx("th",{children:"Stara warto"}),e.jsx("th",{children:"Nowa warto"}),e.jsx("th",{children:"Uytkownik"})]})}),e.jsx("tbody",{children:t.items.map(y=>{const S=oE[y.action]??{bg:"var(--blue-dim)",fg:"var(--blue)"};return e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)",whiteSpace:"nowrap"},children:y.created_at?.replace("T"," ").slice(0,19)}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:S.bg,color:S.fg},children:y.action})}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim)",color:"var(--purple)"},children:y.module})}),e.jsxs("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:[y.entity_type,"#",y.entity_id]}),e.jsx("td",{style:{fontSize:12},children:y.field_name??""}),e.jsx("td",{style:{color:"var(--red)",fontSize:12,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.old_value??""}),e.jsx("td",{style:{color:"var(--green)",fontSize:12,maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:y.new_value??""}),e.jsx("td",{style:{fontSize:12},children:y.user_name??"system"})]},y.id)})})]})}),j>1&&e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm",disabled:f<=1,onClick:()=>p(f-1),children:"Poprzednia"}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)",alignSelf:"center"},children:[f," / ",j]}),e.jsx("button",{className:"btn btn-sm",disabled:f>=j,onClick:()=>p(f+1),children:"Nastpna"})]})]})}function Xm(t){return t==="A"?"var(--green)":t==="B"?"var(--cyan)":t==="C"?"var(--yellow)":t==="D"?"var(--orange)":"var(--red)"}function dE(t){return t==="high"?"var(--red)":t==="medium"?"var(--orange)":"var(--green)"}function uE(t){return t==="high"?"var(--red-dim)":t==="medium"?"var(--orange-dim)":"var(--green-dim)"}function _v(t){return t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function fE(){const[t,r]=m.useState(null),[a,s]=m.useState(!0),[o,d]=m.useState([]),[u,h]=m.useState(""),f=on(),p=b=>{s(!0);const _=b?`?org_unit_id=${b}`:"";le.get(`/api/v1/domains/dashboard/scores${_}`).then(r).catch(()=>{}).finally(()=>s(!1))};m.useEffect(()=>{le.get("/api/v1/org-units/tree").then(d).catch(()=>{}),p()},[]);const x=b=>{h(b),p(b||void 0)};if(a&&!t)return e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:300},children:e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Ladowanie dashboardu domen..."})});const j=t?.overall_score??0,y=t?.overall_grade??"F",S=t?.domains??[],w=[...S].sort((b,_)=>b.score-_.score);return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx(jn,{tree:o,value:u?Number(u):null,onChange:b=>x(b?String(b):""),placeholder:"Cala organizacja",allowClear:!0,style:{width:300}}),a&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odswiezanie..."})]}),e.jsx("div",{className:"toolbar-right",children:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:"Ogolny wynik"}),e.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:6},children:[e.jsx("span",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Xm(y)},children:Math.round(j)}),e.jsx("span",{style:{fontSize:16,fontWeight:600,color:Xm(y)},children:y})]})]})})]}),S.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Brak zdefiniowanych domen bezpieczenstwa. Dodaj domeny w Konfiguracji."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:14},children:w.map(b=>e.jsx(hE,{domain:b,navigate:f},b.domain_id))})]})}function hE({domain:t,navigate:r}){const a=Xm(t.grade),s=2*Math.PI*24,o=s-t.score/100*s;return e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden",cursor:"default"},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:`2px solid ${t.color??"var(--border)"}`,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:8,background:`${t.color??"var(--blue)"}20`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:16,color:t.color??"var(--blue)"},children:t.icon?mE(t.icon):"?"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:t.domain_name}),t.owner&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:t.owner})]})]}),e.jsxs("div",{style:{position:"relative",width:56,height:56},children:[e.jsxs("svg",{width:"56",height:"56",viewBox:"0 0 56 56",children:[e.jsx("circle",{cx:"28",cy:"28",r:"24",fill:"none",stroke:"var(--bg-subtle)",strokeWidth:"4"}),e.jsx("circle",{cx:"28",cy:"28",r:"24",fill:"none",stroke:a,strokeWidth:"4",strokeDasharray:s,strokeDashoffset:o,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"28px 28px"}})]}),e.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a,lineHeight:1},children:Math.round(t.score)}),e.jsx("div",{style:{fontSize:9,color:a},children:t.grade})]})]})]}),e.jsxs("div",{style:{padding:"12px 16px"},children:[e.jsx("div",{style:{display:"flex",gap:6,marginBottom:10},children:[{label:"Wysokie",count:t.risk_high,color:"var(--red)",bg:"var(--red-dim)"},{label:"Srednie",count:t.risk_medium,color:"var(--orange)",bg:"var(--orange-dim)"},{label:"Niskie",count:t.risk_low,color:"var(--green)",bg:"var(--green-dim)"}].map(d=>e.jsxs("div",{style:{flex:1,textAlign:"center",background:d.bg,borderRadius:6,padding:"6px 4px"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:d.color},children:d.count}),e.jsx("div",{style:{fontSize:9,color:d.color},children:d.label})]},d.label))}),t.cis_control_count>0&&e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:10,marginBottom:3},children:[e.jsxs("span",{style:{color:"var(--text-muted)"},children:["CIS (",t.cis_control_count," kontroli)"]}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:t.cis_pct!=null?_v(t.cis_pct):"var(--text-muted)"},children:t.cis_pct!=null?`${Math.round(t.cis_pct)}%`:""})]}),e.jsx("div",{className:"bar-track",style:{height:6},children:e.jsx("div",{className:"bar-fill",style:{width:`${t.cis_pct??0}%`,background:t.cis_pct!=null?_v(t.cis_pct):"var(--text-muted)",height:6}})})]}),t.top_risks.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em",color:"var(--text-muted)",marginBottom:4},children:"Top ryzyka"}),t.top_risks.map(d=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11,cursor:"pointer"},onClick:()=>r(`/risks?highlight=${d.id}`),children:[e.jsx("span",{style:{color:"var(--text-secondary)"},children:d.asset_name}),e.jsx("span",{className:"score-badge",style:{background:uE(d.risk_level),color:dE(d.risk_level),fontSize:10},children:Number(d.risk_score).toFixed(0)})]},d.id))]}),t.risk_count===0&&t.cis_control_count===0&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",padding:8},children:"Brak ryzyk i kontroli CIS"})]})]})}function mE(t){return{monitor:"",database:"",settings:"",users:"","shield-alert":"","file-text":"",mail:"",bug:"",wifi:"","hard-drive":"",building:"",scale:"",activity:"","graduation-cap":"","alert-triangle":""}[t]??""}const uu=[{filename:"mapping-adobe-ccf-v5-and-bsi-c5-2020.yaml",source:"Adobe CCF v5",target:"BSI C5 2020",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-cyber_essentials_requirements_for_it_infrastructure.yaml",source:"Adobe CCF v5",target:"Cyber Essentials",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-fedramp-rev5.yaml",source:"Adobe CCF v5",target:"FedRAMP Rev5",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-iso27001-2022.yaml",source:"Adobe CCF v5",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-nist-csf-1.1.yaml",source:"Adobe CCF v5",target:"NIST CSF 1.1",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-pcidss-4_0.yaml",source:"Adobe CCF v5",target:"PCI DSS 4.0",direction:"and"},{filename:"mapping-adobe-ccf-v5-and-soc2-2017-rev-2022.yaml",source:"Adobe CCF v5",target:"SOC2 2017",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-ccb-cff-2023-03-01.yaml",source:"NIS2 Annex",target:"CCB CFF 2023",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-iso27001-2022.yaml",source:"NIS2 Annex",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-annex-technical-and-methodological-requirements-nis2-and-nist-csf-2.0.yaml",source:"NIS2 Annex",target:"NIST CSF 2.0",direction:"and"},{filename:"mapping-ccb-cff-2023-03-01-and-ccb-cyfun2025.yaml",source:"CCB CFF 2023",target:"CCB CyFun 2025",direction:"and"},{filename:"mapping-ccb-cff-2023-03-01-to-iso27001-2022.yaml",source:"CCB CFF 2023",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-cis-controls-v8-and-iso27001-2022.yaml",source:"CIS Controls v8",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-cis-controls-v8-and-scf-2025.2.2.yaml",source:"CIS Controls v8",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-bsi-c5-2020.yaml",source:"Cisco CCF v3.0",target:"BSI C5 2020",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-esquema-nacional-de-seguridad.yaml",source:"Cisco CCF v3.0",target:"ENS",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-fedramp-rev5.yaml",source:"Cisco CCF v3.0",target:"FedRAMP Rev5",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-iso27001-2022.yaml",source:"Cisco CCF v3.0",target:"ISO 27001:2022",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-ncsc-caf-3.2.yaml",source:"Cisco CCF v3.0",target:"NCSC CAF 3.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-800-171-rev2.yaml",source:"Cisco CCF v3.0",target:"NIST 800-171 Rev2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-800-171-rev3.yaml",source:"Cisco CCF v3.0",target:"NIST 800-171 Rev3",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-nist-ssdf-1.1.yaml",source:"Cisco CCF v3.0",target:"NIST SSDF 1.1",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-pcidss-4_0.yaml",source:"Cisco CCF v3.0",target:"PCI DSS 4.0",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-secnumcloud-3.2.yaml",source:"Cisco CCF v3.0",target:"SecNumCloud 3.2",direction:"and"},{filename:"mapping-cisco-ccf-v3.0-and-soc2-2017-rev-2022.yaml",source:"Cisco CCF v3.0",target:"SOC2 2017",direction:"and"},{filename:"mapping-cjis-policy-5.9.4-to-cjis-policy-5.9.yaml",source:"CJIS 5.9.4",target:"CJIS 5.9",direction:"to"},{filename:"mapping-dora-and-finma-2023-01.yaml",source:"DORA",target:"FINMA 2023-01",direction:"and"},{filename:"mapping-india-dpdpa-2023-and-scf-2025.2.2.yaml",source:"India DPDPA 2023",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-iso27001-2013-to-iso27001-2022.yaml",source:"ISO 27001:2013",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-iso27001-2022-and-scf-2025.2.2.yaml",source:"ISO 27001:2022",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-iso27001-2022-to-secnumcloud-3.2.yaml",source:"ISO 27001:2022",target:"SecNumCloud 3.2",direction:"to"},{filename:"mapping-iso42001-2023-and-scf-2025.2.2.yaml",source:"ISO 42001:2023",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-nist-csf-2.0-and-scf-2025.2.2.yaml",source:"NIST CSF 2.0",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-nist-csf-2.0-to-iso27001-2022.yaml",source:"NIST CSF 2.0",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml",source:"NIST SP 800-53 Rev5",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-csf-1.1.yaml",source:"NIST SP 800-66 Rev2",target:"NIST CSF 1.1",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-csf-2.0.yaml",source:"NIST SP 800-66 Rev2",target:"NIST CSF 2.0",direction:"to"},{filename:"mapping-nist-sp-800-66-rev2-to-nist-sp-800-53-rev5.yaml",source:"NIST SP 800-66 Rev2",target:"NIST SP 800-53 Rev5",direction:"to"},{filename:"mapping-pcidss-4_0-and-scf-2025.2.2.yaml",source:"PCI DSS 4.0",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-scf-2025.2.2-and-swift-cscf-v2025.yaml",source:"SCF 2025.2.2",target:"SWIFT CSCF v2025",direction:"and"},{filename:"mapping-secnumcloud-3.2-to-iso27001-2022.yaml",source:"SecNumCloud 3.2",target:"ISO 27001:2022",direction:"to"},{filename:"mapping-soc2-2017-rev-2022-and-scf-2025.2.2.yaml",source:"SOC2 2017",target:"SCF 2025.2.2",direction:"and"},{filename:"mapping-soc2-2017-rev-2022-to-iso27001-2022.yaml",source:"SOC2 2017",target:"ISO 27001:2022",direction:"to"}],Sv={nist:"NIST",iso:"ISO",cis:"CIS",pci:"PCI",soc:"SOC",gdpr:"GDPR/Privacy",eu:"EU/NIS2/DORA",cloud:"Cloud",ccf:"CCF",other:"Inne"},wv={nist:"#6366f1",iso:"#10b981",cis:"#f59e0b",pci:"#ef4444",soc:"#8b5cf6",gdpr:"#ec4899",eu:"#3b82f6",cloud:"#06b6d4",ccf:"#14b8a6",other:"#94a3b8"},Vd=[{filename:"nist-sp-800-53-rev5.yaml",name:"NIST SP 800-53 Rev5",provider:"NIST",category:"nist"},{filename:"nist-csf-2.0.yaml",name:"NIST CSF 2.0",provider:"NIST",category:"nist"},{filename:"nist-csf-1.1.yaml",name:"NIST CSF 1.1",provider:"NIST",category:"nist"},{filename:"nist-800-171-rev2.yaml",name:"NIST 800-171 Rev2",provider:"NIST",category:"nist"},{filename:"nist-800-171-rev3.yaml",name:"NIST 800-171 Rev3",provider:"NIST",category:"nist"},{filename:"nist-sp-800-66-rev2.yaml",name:"NIST SP 800-66 Rev2 (HIPAA)",provider:"NIST",category:"nist"},{filename:"nist-ssdf-1.1.yaml",name:"NIST SSDF 1.1",provider:"NIST",category:"nist"},{filename:"nist-ai-rmf-1.0.yaml",name:"NIST AI RMF 1.0",provider:"NIST",category:"nist"},{filename:"nist-privacy-1.0.yaml",name:"NIST Privacy Framework 1.0",provider:"NIST",category:"nist"},{filename:"nist-sp-800-82-annex-f.yaml",name:"NIST SP 800-82 Annex F",provider:"NIST",category:"nist"},{filename:"fedramp-rev5.yaml",name:"FedRAMP Rev5",provider:"NIST/GSA",category:"nist"},{filename:"iso27001-2022.yaml",name:"ISO 27001:2022",provider:"ISO",category:"iso"},{filename:"iso27001-2013.yaml",name:"ISO 27001:2013",provider:"ISO",category:"iso"},{filename:"iso22301-2019.yaml",name:"ISO 22301:2019 (BCM)",provider:"ISO",category:"iso"},{filename:"iso42001-2023.yaml",name:"ISO 42001:2023 (AI)",provider:"ISO",category:"iso"},{filename:"cis-controls-v8.xlsx",name:"CIS Controls v8",provider:"CIS",category:"cis"},{filename:"cis-benchmark-kubernetes.yaml",name:"CIS Benchmark Kubernetes",provider:"CIS",category:"cis"},{filename:"pcidss-4_0.yaml",name:"PCI DSS 4.0",provider:"PCI SSC",category:"pci"},{filename:"soc2-2017-rev-2022.yaml",name:"SOC2 2017 Rev 2022",provider:"AICPA",category:"soc"},{filename:"gdpr.yaml",name:"GDPR",provider:"EU",category:"gdpr"},{filename:"gdpr-checklist.yaml",name:"GDPR Checklist",provider:"EU",category:"gdpr"},{filename:"ccpa_act.yaml",name:"CCPA Act",provider:"California",category:"gdpr"},{filename:"ccpa_regulations.yaml",name:"CCPA Regulations",provider:"California",category:"gdpr"},{filename:"india-dpdpa-2023.yaml",name:"India DPDPA 2023",provider:"India",category:"gdpr"},{filename:"dora.yaml",name:"DORA",provider:"EU",category:"eu"},{filename:"annex-nis2-regulation--2024-2690-with-technical-implementation-guidance-by-enisa.yaml",name:"NIS2 Annex (ENISA Technical Guide)",provider:"ENISA",category:"eu"},{filename:"ai-act.yaml",name:"EU AI Act",provider:"EU",category:"eu"},{filename:"ens-decreto.yaml",name:"ENS (Esquema Nacional de Seguridad)",provider:"Spain",category:"eu"},{filename:"esrs-p1.yaml",name:"ESRS Part 1",provider:"EFRAG",category:"eu"},{filename:"esrs-p2.yaml",name:"ESRS Part 2",provider:"EFRAG",category:"eu"},{filename:"cra-regulation-annexes.yaml",name:"Cyber Resilience Act Annexes",provider:"EU",category:"eu"},{filename:"ccb-cff-2023-03-01.yaml",name:"CCB CFF 2023",provider:"CCB Belgium",category:"eu"},{filename:"ccb-cyfun2025.yaml",name:"CCB CyFun 2025",provider:"CCB Belgium",category:"eu"},{filename:"finma-2023-01.yaml",name:"FINMA 2023-01",provider:"Switzerland",category:"eu"},{filename:"secnumcloud-3.2.yaml",name:"SecNumCloud 3.2",provider:"ANSSI",category:"cloud"},{filename:"bsi-c5-2020.yaml",name:"BSI C5 2020",provider:"BSI Germany",category:"cloud"},{filename:"adobe-ccf-v5.yaml",name:"Adobe CCF v5",provider:"Adobe",category:"ccf"},{filename:"cisco-ccf-v3.0.yaml",name:"Cisco CCF v3.0",provider:"Cisco",category:"ccf"},{filename:"scf-2025.2.2.yaml",name:"SCF 2025.2.2",provider:"Secure Controls Framework",category:"ccf"},{filename:"cmmc-2.0.yaml",name:"CMMC 2.0",provider:"DoD",category:"other"},{filename:"owasp-asvs-4.0.3.yaml",name:"OWASP ASVS 4.0.3",provider:"OWASP",category:"other"},{filename:"owasp-asvs-5.0.0.yaml",name:"OWASP ASVS 5.0.0",provider:"OWASP",category:"other"},{filename:"essential-eight.yaml",name:"Essential Eight",provider:"Australia ASD",category:"other"},{filename:"cyber_essentials.yaml",name:"Cyber Essentials",provider:"NCSC UK",category:"other"},{filename:"ncsc-caf-3.2.yaml",name:"NCSC CAF 3.2",provider:"NCSC UK",category:"other"},{filename:"swift-cscf-v2025.yaml",name:"SWIFT CSCF v2025",provider:"SWIFT",category:"other"},{filename:"cjis-version-5.9.5.yaml",name:"CJIS v5.9.5",provider:"FBI",category:"other"},{filename:"3cf-v2.yaml",name:"3CF v2",provider:"3CF",category:"other"},{filename:"aircyber-v1.5.2.yaml",name:"AirCyber v1.5.2",provider:"GIFAS",category:"other"},{filename:"dfs-500-2023-11.yaml",name:"DFS 500 (2023-11)",provider:"NY DFS",category:"other"}],Fp={draft:{label:"Szkic",cls:"badge-gray",color:"var(--text-muted)",bg:"var(--bg-inset)"},review:{label:"Przegld",cls:"badge-yellow",color:"var(--orange)",bg:"var(--orange-dim)"},published:{label:"Zatwierdzony",cls:"badge-green",color:"var(--green)",bg:"var(--green-dim)"},deprecated:{label:"Wycofany",cls:"badge-red",color:"var(--red)",bg:"var(--red-dim)"},archived:{label:"Zarchiwizowany",cls:"badge-gray",color:"var(--text-muted)",bg:"var(--bg-inset)"}};function Zd(t){return Fp[t]?.color??"var(--text-muted)"}function kv(t){return Fp[t]?.bg??"var(--bg-inset)"}function mm(t){return Fp[t]?.label??t}function pE(t){return t?t==="manual"?"Rczny":t==="ciso_assistant_yaml"?"YAML":t==="ciso_assistant_excel"?"Excel":t==="copy"?"Kopia":t==="custom_import"?"AI Import":t:""}const Gd={internal:"Wewntrzny",external:"Zewntrzny"};function pm({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text)"},children:r})]})}function br({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function gE(){const t=on(),[r]=fc(),[a,s]=m.useState([]),[o,d]=m.useState(!0),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(null),[y,S]=m.useState(!1),[w,b]=m.useState(!1),[_,E]=m.useState(!1),[C,N]=m.useState(null),[O,Q]=m.useState(null),[G,M]=m.useState(!1),[U,A]=m.useState(!1),[R,Z]=m.useState([]),[F,q]=m.useState(r.get("type")),[ee,me]=m.useState(r.get("origin")),W=m.useRef(null),J=m.useRef(null),[L,H]=m.useState(!1),[ne,P]=m.useState(null),T=m.useRef(!1),z=m.useCallback(((oe,Ue)=>{T.current&&!confirm(`Import AI jest w toku. Przejcie na inn stron przerwie proces importu.

Czy na pewno chcesz przerwa?`)||t(oe,Ue)}),[t]);m.useEffect(()=>{const oe=Ue=>{T.current&&(confirm(`Import AI jest w toku. Cofnicie przerwie proces importu.

Czy na pewno chcesz przerwa?`)||(Ue.preventDefault(),window.history.pushState(null,"",window.location.href)))};return window.addEventListener("popstate",oe),()=>window.removeEventListener("popstate",oe)},[]),m.useEffect(()=>{le.get("/api/v1/dictionaries/entries?type_code=document_type").then(Z).catch(()=>Z([]))},[]);const k=()=>{d(!0);const oe=new URLSearchParams;if(y||oe.set("is_active","true"),F){const Qe=R.find(lt=>lt.code===F);Qe&&oe.set("document_type_id",String(Qe.id))}ee&&oe.set("document_origin",ee);const Ue=oe.toString()?`?${oe.toString()}`:"";le.get(`/api/v1/frameworks${Ue}`).then(s).catch(()=>s([])).finally(()=>d(!1))};m.useEffect(()=>{k()},[y,F,ee,R]);const I=async oe=>{h(!0),p(null),j(null);const Ue=new FormData;Ue.append("file",oe);const lt=oe.name.endsWith(".yaml")||oe.name.endsWith(".yml")?"/api/v1/frameworks/import/yaml":"/api/v1/frameworks/import/excel";try{const tt=await le.postFormData(lt,Ue);p(tt),N(tt.framework_id),E(!0),k()}catch(tt){j(tt instanceof Error?tt.message:"Bd importu"),k()}finally{h(!1),W.current&&(W.current.value="")}},D=async oe=>{H(!0),T.current=!0,p(null),j(null),P({percent:0,message:"Wysyanie pliku...",nodes_found:0});const Ue=xt=>(xt.preventDefault(),xt.returnValue="Import AI jest w toku. Przeadowanie strony przerwie proces. Kontynuowa?",xt.returnValue);window.addEventListener("beforeunload",Ue);const Qe=new FormData;Qe.append("file",oe);const lt="",tt=new AbortController;let ht=null;try{const xt=fetch(`${lt}/api/v1/frameworks/import/ai`,{method:"POST",body:Qe,signal:tt.signal});let qe=null;ht=setInterval(async()=>{if(qe)try{const _t=await fetch(`${lt}/api/v1/frameworks/import/ai/progress/${qe}`);if(_t.ok){const zt=await _t.json();P({percent:zt.percent??0,message:zt.message??"",nodes_found:zt.nodes_found??0})}}catch{}},2e3);const Nt=await xt;if(qe=Nt.headers.get("x-import-task-id"),!Nt.ok){const _t=await Nt.text().catch(()=>"");throw new Error(`API ${Nt.status}: ${_t}`)}const st=await Nt.json();p(st),N(st.framework_id),E(!0),P({percent:100,message:`Import zakoczony  ${st.total_nodes} wzw`,nodes_found:st.total_nodes??0}),k()}catch(xt){const qe=xt instanceof Error?xt.message:"Bd importu AI";qe.includes("Failed to fetch")?j("Nie mona poczy si z backendem. Sprawd czy serwer dziaa i czy zainstalowane s: pdfplumber, python-docx (pip install pdfplumber python-docx)."):j(qe),k()}finally{window.removeEventListener("beforeunload",Ue),ht&&clearInterval(ht),H(!1),T.current=!1,setTimeout(()=>P(null),5e3),J.current&&(J.current.value="")}},de=async oe=>{const Ue=oe.lifecycle_status==="draft"||oe.lifecycle_status==="review";if(confirm(`Czy na pewno chcesz ${Ue?"usun":"zarchiwizowa"} wskazany dokument "${oe.name}"?`))try{await le.delete(`/api/v1/frameworks/${oe.id}`),Q(null),k()}catch(tt){alert(tt instanceof Error?tt.message:"Bd usuwania")}},he=async oe=>{try{const Ue=await le.post(`/api/v1/frameworks/${oe.id}/copy`,{copy_org_unit_links:!0});z(`/frameworks/${Ue.id}`)}catch(Ue){alert(Ue instanceof Error?Ue.message:"Bd kopiowania")}},ie=async oe=>{try{const Ue=await le.post("/api/v1/frameworks",oe);b(!1),z(`/frameworks/${Ue.id}`)}catch(Ue){alert(Ue instanceof Error?Ue.message:"Bd tworzenia")}},ve=m.useMemo(()=>{const oe=[{code:null,label:"Wszystkie",count:a.length}];for(const Ue of R){const Qe=a.filter(lt=>lt.document_type_id===Ue.id).length;oe.push({code:Ue.code,label:Ue.label,count:Qe})}return oe},[R,a]),je=[{key:"name",header:"Nazwa"},{key:"document_type_name",header:"Typ dokumentu",format:oe=>oe.document_type_name||""},{key:"document_origin",header:"Pochodzenie",format:oe=>Gd[oe.document_origin]||oe.document_origin},{key:"owner",header:"Waciciel",format:oe=>oe.owner||""},{key:"display_version",header:"Wersja",format:oe=>oe.display_version||oe.published_version||oe.version||""},{key:"provider",header:"Dostawca",format:oe=>oe.provider??""},{key:"total_nodes",header:"Wzy",format:oe=>String(oe.total_nodes)},{key:"total_assessable",header:"Ocenialne",format:oe=>String(oe.total_assessable)},{key:"lifecycle_status",header:"Status",format:oe=>mm(oe.lifecycle_status)},{key:"next_review_date",header:"Nastpny przegld",format:oe=>oe.next_review_date||"",defaultVisible:!1},{key:"ref_id",header:"Ref ID",defaultVisible:!1},{key:"source_format",header:"rdo",format:oe=>pE(oe.source_format),defaultVisible:!1}],{visible:fe,toggle:_e}=da(je,"frameworks"),Se=Aa({data:a,storageKey:"frameworks",defaultSort:"name",defaultSortDir:"asc"}),Ve=Se.filteredCount!==Se.totalCount,be=m.useMemo(()=>{const oe=Se.filtered,Ue=oe.filter(qe=>qe.lifecycle_status==="published").length,Qe=oe.filter(qe=>qe.lifecycle_status==="draft").length,lt=oe.filter(qe=>qe.requires_review&&qe.next_review_date&&new Date(qe.next_review_date)<new Date).length,tt=a.filter(qe=>qe.lifecycle_status==="published").length,ht=a.filter(qe=>qe.lifecycle_status==="draft").length,xt=a.filter(qe=>qe.requires_review&&qe.next_review_date&&new Date(qe.next_review_date)<new Date).length;return[{label:"Dokumentw",value:oe.length,total:a.length,color:"var(--blue)"},{label:"Zatwierdzonych",value:Ue,total:tt,color:"var(--green)"},{label:"Szkicw",value:Qe,total:ht,color:"var(--orange)"},{label:"Zalegy przegld",value:lt,total:xt,color:"var(--red)"}]},[Se.filtered,a]);return e.jsxs("div",{children:[f&&!_&&e.jsxs("div",{className:"card",style:{background:"var(--green-dim)",borderLeft:"3px solid var(--green)",marginBottom:12,padding:"10px 14px",fontSize:12},children:[e.jsx("strong",{children:"Import zakoczony:"})," ",f.name,"  ",f.total_nodes," wzw, ",f.total_assessable," ocenialnych, ",f.dimensions_created," wymiarw",e.jsx("button",{className:"btn btn-sm",style:{marginLeft:12,fontSize:10},onClick:()=>p(null),children:""})]}),x&&e.jsxs("div",{className:"card",style:{background:"var(--red-dim)",borderLeft:"3px solid var(--red)",marginBottom:12,padding:"10px 14px",fontSize:12},children:[e.jsx("strong",{children:"Bd importu:"})," ",x,e.jsx("button",{className:"btn btn-sm",style:{marginLeft:12,fontSize:10},onClick:()=>j(null),children:""})]}),ne&&e.jsxs("div",{className:"card",style:{marginBottom:12,padding:"14px 16px",borderLeft:`3px solid ${ne.percent>=100?"var(--green)":"var(--blue)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:ne.percent>=100?"Import AI zakoczony":"AI analizuje dokument..."}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[ne.nodes_found>0&&e.jsxs("span",{style:{color:"var(--blue)",fontWeight:600},children:[ne.nodes_found," wzw"]})," ",ne.percent,"%"]})]}),e.jsx("div",{className:"bar-track",style:{height:8,marginBottom:6},children:e.jsx("div",{className:"bar-fill",style:{width:`${ne.percent}%`,background:ne.percent>=100?"var(--green)":"var(--blue)",transition:"width 0.5s ease"}})}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:ne.message}),ne.percent<100&&e.jsx("div",{style:{fontSize:11,color:"var(--orange)",marginTop:6,fontWeight:500},children:"Nie zamykaj ani nie przeadowuj strony  import zostanie przerwany."})]}),e.jsx(Ia,{cards:be,isFiltered:Ve}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:6,marginBottom:12},children:[ve.map(oe=>e.jsxs("button",{className:"btn btn-sm",style:{background:F===oe.code?"var(--blue)":"var(--bg-inset)",color:F===oe.code?"#fff":"var(--text-muted)",border:F===oe.code?"1px solid var(--blue)":"1px solid var(--border)",borderRadius:16,padding:"3px 12px",fontSize:11},onClick:()=>{q(F===oe.code?null:oe.code)},children:[oe.label," (",oe.count,")"]},oe.code??"all")),e.jsx("span",{style:{borderLeft:"1px solid var(--border)",margin:"0 4px"}}),["internal","external"].map(oe=>e.jsx("button",{className:"btn btn-sm",style:{background:ee===oe?"var(--purple)":"var(--bg-inset)",color:ee===oe?"#fff":"var(--text-muted)",border:ee===oe?"1px solid var(--purple)":"1px solid var(--border)",borderRadius:16,padding:"3px 12px",fontSize:11},onClick:()=>me(ee===oe?null:oe),children:Gd[oe]},oe))]}),e.jsx("input",{ref:W,type:"file",accept:".xlsx,.xls,.yaml,.yml",style:{display:"none"},onChange:oe=>oe.target.files?.[0]&&I(oe.target.files[0])}),e.jsx("input",{ref:J,type:"file",accept:".pdf,.docx,.doc",style:{display:"none"},onChange:oe=>oe.target.files?.[0]&&D(oe.target.files[0])}),e.jsx(ma,{filteredCount:Se.filteredCount,totalCount:Se.totalCount,unitLabel:"dokumentw",search:Se.search,onSearchChange:Se.setSearch,searchPlaceholder:"Szukaj dokumentw...",showFilters:G,onToggleFilters:()=>M(oe=>!oe),hasActiveFilters:Se.hasActiveFilters,onClearFilters:Se.clearAllFilters,columns:je,visibleColumns:fe,onToggleColumn:_e,data:Se.filtered,exportFilename:"repozytorium_wymagan",primaryLabel:"Nowy dokument",onPrimaryAction:()=>b(!0),secondaryActions:[{label:"Import z CISO Assistant",onClick:()=>A(!0)},{label:u?"Importowanie...":"Import z pliku",onClick:()=>W.current?.click()},{label:L?" AI analizuje...":" AI Import (PDF/DOCX)",onClick:()=>J.current?.click()},{label:y?"Ukryj archiwalne":"Poka archiwalne",onClick:()=>S(oe=>!oe)}]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:je,visibleColumns:fe,data:Se.pageData,rowKey:oe=>oe.id,selectedKey:O?.id??null,onRowClick:oe=>Q(O?.id===oe.id?null:oe),rowBorderColor:oe=>Zd(oe.lifecycle_status),sortField:Se.sortField,sortDir:Se.sortDir,onSort:Se.toggleSort,columnFilters:Se.columnFilters,onColumnFilter:Se.setColumnFilter,showFilters:G,page:Se.page,totalPages:Se.totalPages,pageSize:Se.pageSize,totalItems:Se.totalCount,filteredItems:Se.filteredCount,onPageChange:Se.setPage,onPageSizeChange:Se.setPageSize,loading:o,emptyMessage:"Brak dokumentw referencyjnych. Zaimportuj z pliku lub utwrz rcznie.",emptyFilteredMessage:"Brak dokumentw pasujcych do filtrw.",renderCell:(oe,Ue)=>{if(Ue==="name")return e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600},children:oe.name}),oe.updates_document_id&&e.jsx("span",{style:{fontSize:9,color:"var(--orange)",marginLeft:6},children:"AKTUALIZACJA"})]});if(Ue==="document_type_name")return e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:oe.document_type_name||""});if(Ue==="document_origin")return e.jsx("span",{className:"score-badge",style:{background:oe.document_origin==="internal"?"var(--blue-dim)":"var(--bg-inset)",color:oe.document_origin==="internal"?"var(--blue)":"var(--text-muted)",fontSize:10},children:Gd[oe.document_origin]||oe.document_origin});if(Ue==="total_nodes")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.total_nodes});if(Ue==="total_assessable")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.total_assessable});if(Ue==="lifecycle_status")return e.jsx("span",{className:"score-badge",style:{background:kv(oe.lifecycle_status),color:Zd(oe.lifecycle_status)},children:mm(oe.lifecycle_status)});if(Ue==="display_version")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:oe.display_version||oe.published_version||""});if(Ue==="next_review_date"){if(!oe.next_review_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const Qe=new Date(oe.next_review_date)<new Date;return e.jsxs("span",{style:{color:Qe?"var(--red)":"var(--text-muted)",fontWeight:Qe?600:400},children:[oe.next_review_date,Qe&&" !"]})}}}),O&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy dokumentu"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>z(`/frameworks/${O.id}`),title:"Otwrz",children:"Otwrz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>Q(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Zd(O.lifecycle_status)},children:O.display_version||`v${O.edit_version}`}),e.jsx("span",{className:"score-badge",style:{background:kv(O.lifecycle_status),color:Zd(O.lifecycle_status),fontSize:13,padding:"4px 12px"},children:mm(O.lifecycle_status)}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:[O.total_nodes," wzw | ",O.total_assessable," ocenialnych"]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(pm,{number:1,label:"Informacje"}),e.jsx(br,{label:"Nazwa",value:e.jsx("span",{style:{fontWeight:500},children:O.name})}),e.jsx(br,{label:"Typ dokumentu",value:O.document_type_name||""}),e.jsx(br,{label:"Pochodzenie",value:Gd[O.document_origin]||O.document_origin}),e.jsx(br,{label:"Waciciel",value:O.owner}),e.jsx(br,{label:"Dostawca",value:O.provider}),e.jsx(br,{label:"Wersja",value:O.display_version||O.published_version||O.version}),e.jsx(br,{label:"Ref ID",value:O.ref_id}),e.jsx(pm,{number:2,label:"Przegldy"}),e.jsx(br,{label:"Wymaga przegldu",value:O.requires_review?"Tak":"Nie",color:O.requires_review?"var(--blue)":void 0}),O.requires_review&&e.jsx(e.Fragment,{children:e.jsx(br,{label:"Nastpny przegld",value:O.next_review_date||"Nie ustalono",color:O.next_review_date&&new Date(O.next_review_date)<new Date?"var(--red)":void 0})}),e.jsx(pm,{number:3,label:"Struktura"}),e.jsx(br,{label:"Wzy",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700},children:O.total_nodes})}),e.jsx(br,{label:"Ocenialne",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:700},children:O.total_assessable})})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>z(`/frameworks/${O.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:()=>he(O),children:"Kopiuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>de(O),children:O.lifecycle_status==="published"?"Archiwizuj":"Usu"})]})]})]}),e.jsx(gt,{open:w,onClose:()=>b(!1),title:"Nowy dokument referencyjny",children:e.jsx(xE,{onClose:()=>b(!1),onCreate:ie,documentTypes:R})}),e.jsx(gt,{open:_,onClose:()=>{E(!1),N(null)},title:"Formularz adopcji dokumentu",children:C&&e.jsx(yE,{frameworkId:C,documentTypes:R,importResult:f,onClose:()=>{E(!1),N(null),k()},onAdoptAndOpen:oe=>{E(!1),z(`/frameworks/${oe}`)}})}),e.jsx(gt,{open:U,onClose:()=>A(!1),title:"Katalog CISO Assistant Community",wide:!0,children:e.jsx(vE,{existingFrameworks:a,onImportDone:oe=>{N(oe.framework_id),A(!1),E(!0),k()}})})]})}function xE({onClose:t,onCreate:r,documentTypes:a}){const[s,o]=m.useState(""),[d,u]=m.useState(""),[h,f]=m.useState(""),[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState(""),[b,_]=m.useState(null),[E,C]=m.useState("external"),[N,O]=m.useState(!1),[Q,G]=m.useState(12);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa dokumentu *"}),e.jsx("input",{className:"form-control",value:s,onChange:M=>o(M.target.value),placeholder:"np. ISO 27001:2022, Polityka Bezpieczestwa IT",autoFocus:!0})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ dokumentu"}),e.jsxs("select",{className:"form-control",value:b??"",onChange:M=>_(M.target.value?Number(M.target.value):null),children:[e.jsx("option",{value:"",children:" Wybierz typ "}),a.map(M=>e.jsx("option",{value:M.id,children:M.label},M.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pochodzenie"}),e.jsxs("select",{className:"form-control",value:E,onChange:M=>C(M.target.value),children:[e.jsx("option",{value:"external",children:"Zewntrzny"}),e.jsx("option",{value:"internal",children:"Wewntrzny"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:d,onChange:M=>u(M.target.value),placeholder:"np. ISO-27001-2022"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja publikacji"}),e.jsx("input",{className:"form-control",value:p,onChange:M=>x(M.target.value),placeholder:"np. 2022"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dostawca / Wydawca"}),e.jsx("input",{className:"form-control",value:j,onChange:M=>y(M.target.value),placeholder:"np. ISO, NIST, CIS"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:S,onChange:M=>w(M.target.value),placeholder:"Osoba odpowiedzialna"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:h,onChange:M=>f(M.target.value),rows:3,placeholder:"Opis dokumentu..."})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:N,onChange:M=>O(M.target.checked)}),"Podlega przegldom okresowym"]}),N&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"co"}),e.jsx("input",{type:"number",className:"form-control",style:{width:60},value:Q,onChange:M=>G(Number(M.target.value)),min:1,max:60}),e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"mies."})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{className:"btn",onClick:t,children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!s.trim(),onClick:()=>r({name:s,ref_id:d,description:h,version:p,provider:j,owner:S,document_type_id:b,document_origin:E,requires_review:N,review_frequency_months:Q}),children:"Utwrz"})]})]})}function yE({frameworkId:t,documentTypes:r,importResult:a,onClose:s,onAdoptAndOpen:o}){const[d,u]=m.useState(""),[h,f]=m.useState(null),[p,x]=m.useState("external"),[j,y]=m.useState(""),[S,w]=m.useState(!1),[b,_]=m.useState(12),[E,C]=m.useState(!0),[N,O]=m.useState(!1),Q=a?.metrics_summary??[],G=a?.metrics_detected??!1,M=Q.filter(A=>A.detected).length;m.useEffect(()=>{le.get(`/api/v1/frameworks/${t}`).then(A=>{u(A.name),x(A.document_origin||"external"),O(!0)}).catch(()=>O(!0))},[t]);const U=async()=>{try{!E&&G&&await le.delete(`/api/v1/frameworks/${t}/metrics`).catch(()=>{}),await le.put(`/api/v1/frameworks/${t}/adopt`,{name:d||void 0,document_type_id:h,document_origin:p,owner:j||void 0,requires_review:S,review_frequency_months:b}),o(t)}catch(A){alert(A instanceof Error?A.message:"Bd adopcji")}};return N?e.jsxs("div",{children:[e.jsx("div",{style:{background:"var(--blue-dim)",borderLeft:"3px solid var(--blue)",padding:"10px 14px",marginBottom:16,fontSize:12},children:"Dokument zosta zaimportowany jako szkic. Uzupenij jego atrybuty i przejrzyj struktur przed zatwierdzeniem."}),e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa dokumentu"}),e.jsx("input",{className:"form-control",value:d,onChange:A=>u(A.target.value)})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ dokumentu"}),e.jsxs("select",{className:"form-control",value:h??"",onChange:A=>f(A.target.value?Number(A.target.value):null),children:[e.jsx("option",{value:"",children:" Wybierz typ "}),r.map(A=>e.jsx("option",{value:A.id,children:A.label},A.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pochodzenie"}),e.jsxs("select",{className:"form-control",value:p,onChange:A=>x(A.target.value),children:[e.jsx("option",{value:"external",children:"Zewntrzny"}),e.jsx("option",{value:"internal",children:"Wewntrzny"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:j,onChange:A=>y(A.target.value),placeholder:"Osoba odpowiedzialna za dokument"})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:S,onChange:A=>w(A.target.checked)}),"Podlega przegldom okresowym"]}),S&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"co"}),e.jsx("input",{type:"number",className:"form-control",style:{width:60},value:b,onChange:A=>_(Number(A.target.value)),min:1,max:60}),e.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"mies."})]})]}),Q.length>0&&e.jsxs("div",{style:{background:G?"var(--green-dim)":"var(--bg-inset)",border:`1px solid ${G?"var(--green)":"var(--border)"}`,borderRadius:8,padding:"12px 14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[e.jsxs("strong",{style:{fontSize:13},children:["Metryka dokumentu ",G?e.jsxs("span",{style:{color:"var(--green)",fontWeight:400,fontSize:12},children:["(",M,"/",Q.length," wykryto)"]}):e.jsx("span",{style:{color:"var(--text-muted)",fontWeight:400,fontSize:12},children:"(nie wykryto)"})]}),G&&e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer",fontSize:12},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:A=>C(A.target.checked)}),"Importuj metryki"]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"3px 16px",fontSize:12},children:Q.map(A=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"2px 0"},children:[e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:4,fontSize:11,fontWeight:700,background:A.detected?"var(--green)":"var(--bg-subtle)",color:A.detected?"#fff":"var(--text-muted)"},children:A.detected?"+":""}),e.jsx("span",{style:{color:A.detected?"var(--text)":"var(--text-muted)"},children:A.label})]},A.key))})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20},children:[e.jsx("button",{className:"btn",onClick:s,children:"Pomi (pozostaw szkic)"}),e.jsx("button",{className:"btn btn-primary",onClick:U,children:"Zapisz i otwrz dokument"})]})]}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"adowanie..."})}function vE({existingFrameworks:t,onImportDone:r}){const[a,s]=m.useState(""),[o,d]=m.useState(null),[u,h]=m.useState(null),[f,p]=m.useState(null),x=w=>{const b=w.name.toLowerCase();return t.some(_=>{const E=_.name.toLowerCase();return E.includes(b)||b.includes(E)||w.filename.replace(/\.yaml|\.xlsx/g,"").replace(/-/g," ").toLowerCase().split(" ").filter(C=>C.length>2).some(C=>E.includes(C))&&E.length>5})},j=m.useMemo(()=>{let w=Vd;if(o&&(w=w.filter(b=>b.category===o)),a.trim()){const b=a.toLowerCase();w=w.filter(_=>_.name.toLowerCase().includes(b)||_.provider.toLowerCase().includes(b)||_.filename.toLowerCase().includes(b))}return w},[a,o]),y=m.useMemo(()=>{const w={};for(const b of Vd)w[b.category]=(w[b.category]||0)+1;return Object.entries(Sv).map(([b,_])=>({key:b,label:_,count:w[b]||0,color:wv[b]})).filter(b=>b.count>0)},[]),S=async w=>{h(w.filename),p(null);try{const b=await le.post(`/api/v1/frameworks/import/github?framework_path=${encodeURIComponent(w.filename)}`,{});r(b)}catch(b){p(b instanceof Error?b.message:"Bd importu")}finally{h(null)}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Katalog CISO Assistant Community"}),e.jsx("div",{style:{color:"var(--text-muted)",lineHeight:1.6},children:"Przegldaj i importuj frameworki bezpieczestwa z repozytorium open-source CISO Assistant. Po imporcie uzupenij atrybuty dokumentu w formularzu adopcji."})]}),f&&e.jsxs("div",{style:{padding:"10px 14px",borderRadius:8,fontSize:12,background:"#7f1d1d",color:"#fca5a5"},children:[e.jsx("strong",{children:"Bd:"})," ",f,e.jsx("button",{className:"btn btn-sm",style:{marginLeft:8,fontSize:10},onClick:()=>p(null),children:""})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj frameworka...",value:a,onChange:w=>s(w.target.value),style:{flex:"1 1 200px",fontSize:12,padding:"6px 10px"},autoFocus:!0}),e.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[e.jsxs("button",{className:"btn btn-sm",style:{borderRadius:16,padding:"2px 10px",fontSize:10,background:o?"var(--bg-inset)":"var(--blue)",color:o?"var(--text-muted)":"#fff",border:o?"1px solid var(--border)":"1px solid var(--blue)"},onClick:()=>d(null),children:["Wszystkie (",Vd.length,")"]}),y.map(w=>e.jsxs("button",{className:"btn btn-sm",style:{borderRadius:16,padding:"2px 10px",fontSize:10,background:o===w.key?w.color:"var(--bg-inset)",color:o===w.key?"#fff":"var(--text-muted)",border:`1px solid ${o===w.key?w.color:"var(--border)"}`},onClick:()=>d(o===w.key?null:w.key),children:[w.label," (",w.count,")"]},w.key))]})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[j.length," z ",Vd.length," frameworkw"]}),e.jsx("div",{style:{maxHeight:400,overflowY:"auto",border:"1px solid var(--border)",borderRadius:8},children:j.length===0?e.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak frameworkw pasujcych do wyszukiwania"}):j.map(w=>{const b=x(w),_=u===w.filename,E=wv[w.category];return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderBottom:"1px solid var(--border)",opacity:_?.6:1},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{padding:"1px 8px",borderRadius:10,fontSize:9,fontWeight:600,background:`${E}18`,color:E,border:`1px solid ${E}40`,flexShrink:0},children:Sv[w.category]}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:w.name}),b&&e.jsx("span",{style:{padding:"1px 6px",borderRadius:10,fontSize:9,background:"#10b98118",color:"#10b981",border:"1px solid #10b98140"},children:"zaimportowany"})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:[w.provider,"  ",w.filename]})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginLeft:12,flexShrink:0,...b?{}:{background:"var(--blue)",color:"#fff",border:"1px solid var(--blue)"}},onClick:()=>S(w),disabled:_,children:_?"Importowanie...":b?"Reimportuj":"Importuj"})]},w.filename)})})]})}const jE="",bE={ai_enabled:!1,ai_features:{}};let Kd=null,zv=0;const _E=6e4;function Rp(){const[t,r]=m.useState(Kd??bE),[a,s]=m.useState(!Kd),o=m.useCallback(async()=>{try{const d=await fetch(`${jE}/api/v1/config/features`);if(d.ok){const u=await d.json();Kd=u,zv=Date.now(),r(u)}}catch{}finally{s(!1)}},[]);return m.useEffect(()=>{!Kd||Date.now()-zv>_E?o():s(!1)},[o]),{flags:t,loading:a,refresh:o,aiEnabled:t.ai_enabled,hasFeature:d=>t.ai_enabled&&!!t.ai_features[d]}}function Dr(t,r,a){return`${t}:${r}:${a||""}`}const Bp={draft:{label:"Szkic",color:"var(--text-muted)",bg:"var(--bg-inset)"},review:{label:"Przegld",color:"var(--orange)",bg:"var(--orange-dim)"},published:{label:"Zatwierdzony",color:"var(--green)",bg:"var(--green-dim)"},deprecated:{label:"Wycofany",color:"var(--red)",bg:"var(--red-dim)"},archived:{label:"Zarchiwizowany",color:"var(--text-muted)",bg:"var(--bg-inset)"}},SE={draft:["review","published"],review:["draft","published"],published:["deprecated","draft"],deprecated:["archived","draft"],archived:["draft"]},Cv={external:"Zewntrzny",internal:"Wewntrzny"};function jb(t){return Bp[t]?.color??"var(--text-muted)"}function bb(t){return Bp[t]?.bg??"var(--bg-inset)"}function fu(t){return Bp[t]?.label??t}function tn({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function wE(){const{fwId:t}=Ou(),r=on(),[a,s]=m.useState(null),[o,d]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState([]),[x,j]=m.useState([]),[y,S]=m.useState([]),[w,b]=m.useState(!0),[_,E]=m.useState("tree"),[C,N]=m.useState(new Set),[O,Q]=m.useState(null),[G,M]=m.useState(null),{aiEnabled:U}=Rp(),[A,R]=m.useState(new Map),[Z,F]=m.useState(null),q=m.useCallback(de=>{le.get(`/api/v1/ai/node-cache/${de}`).then(he=>{const ie=new Map;for(const ve of he)ie.set(Dr(ve.node_id,ve.action_type,ve.language),ve);R(ie)}).catch(()=>{})},[]),ee=()=>{t&&(b(!0),Promise.all([le.get(`/api/v1/frameworks/${t}`),le.get(`/api/v1/frameworks/${t}/tree`),le.get(`/api/v1/frameworks/${t}/versions`),le.get(`/api/v1/frameworks/${t}/org-units`).catch(()=>[]),le.get(`/api/v1/frameworks/${t}/reviews`).catch(()=>[])]).then(([de,he,ie,ve,je])=>{s(de),d(he),h(ie),p(ve),j(je);const fe=new Set;for(const _e of he){fe.add(_e.id);for(const Se of _e.children)fe.add(Se.id)}N(fe)}).catch(()=>{}).finally(()=>b(!1)))};m.useEffect(()=>{le.get("/api/v1/dictionaries/by-code/point_type").then(de=>S(de.entries?.filter(he=>he.is_active)??[])).catch(()=>{})},[]),m.useEffect(()=>{ee()},[t]),m.useEffect(()=>{a&&U&&q(a.id)},[a?.id,U,q]);const me=de=>{N(he=>{const ie=new Set(he);return ie.has(de)?ie.delete(de):ie.add(de),ie})},W=()=>{const de=new Set,he=ie=>{for(const ve of ie)de.add(ve.id),he(ve.children)};he(o),N(de)},J=()=>N(new Set),L=m.useMemo(()=>{let de=0,he=0,ie=0;const ve=je=>{for(const fe of je)de++,fe.assessable&&he++,fe.depth>ie&&(ie=fe.depth),ve(fe.children)};return ve(o),{total:de,assessable:he,maxDepth:ie}},[o]),H=async de=>{if(!a)return;const he=prompt("Opis zmiany statusu (opcjonalnie):");let ie;de==="published"&&(ie=confirm("Czy zachowa istniejce oceny? (OK = zachowaj, Anuluj = wymagaj ponownej oceny)"));try{await le.put(`/api/v1/frameworks/${a.id}/lifecycle`,{status:de,change_summary:he||void 0,keep_existing_assessments:ie}),ee()}catch(ve){alert(ve instanceof Error?ve.message:"Bd zmiany statusu")}},ne=async de=>{if(a)try{await le.post(`/api/v1/frameworks/${a.id}/nodes`,de),M(null),ee()}catch(he){alert(he instanceof Error?he.message:"Bd dodawania wza")}},P=async de=>{if(!(!a||!confirm("Usun ten wze? Elementy podrzdne zostan przeniesione poziom wyej.")))try{await le.delete(`/api/v1/frameworks/${a.id}/nodes/${de}`),Q(null),ee()}catch(he){alert(he instanceof Error?he.message:"Bd usuwania")}},T=async(de,he)=>{if(a)try{await le.put(`/api/v1/frameworks/${a.id}/nodes/${de}`,he),Q(null),ee()}catch(ie){alert(ie instanceof Error?ie.message:"Bd edycji")}},z=async()=>{if(!a)return;const he=a.lifecycle_status==="draft"?`Czy na pewno chcesz trwale usun dokument ${a.name}"? Operacja jest nieodwracalna.`:`Czy na pewno chcesz zarchiwizowa dokument ${a.name}"? Dokument zostanie przeniesiony do archiwum i nie bdzie widoczny na licie aktywnych dokumentw.`;if(confirm(he))try{await le.delete(`/api/v1/frameworks/${a.id}`),r("/frameworks")}catch(ie){alert(ie instanceof Error?ie.message:"Bd usuwania")}},k=async()=>{if(!a)return;const de=prompt("Nazwa kopii:",`${a.name}  kopia`);if(de)try{const he=await le.post(`/api/v1/frameworks/${a.id}/copy`,{new_name:de});r(`/frameworks/${he.id}`)}catch(he){alert(he instanceof Error?he.message:"Bd kopiowania")}},I=a?.next_review_date&&new Date(a.next_review_date)<new Date;if(w)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"adowanie dokumentu..."});if(!a)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Dokument nie znaleziony"});const D=SE[a.lifecycle_status]||[];return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8},children:[e.jsxs("div",{className:"toolbar-left",style:{alignItems:"center"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>r("/frameworks"),style:{marginRight:8},children:" Wstecz"}),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a.name}),e.jsx("span",{className:"score-badge",style:{background:bb(a.lifecycle_status),color:jb(a.lifecycle_status),fontSize:11},children:fu(a.lifecycle_status)}),I&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim)",color:"var(--red)",fontSize:10},children:"Przegld przeterminowany"})]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",marginTop:2},children:[a.document_type_name&&e.jsx("span",{children:a.document_type_name}),e.jsxs("span",{children:["| ",Cv[a.document_origin]??a.document_origin]}),a.provider&&e.jsxs("span",{children:["| ",a.provider]}),a.display_version&&e.jsxs("span",{children:["| v",a.display_version]}),e.jsxs("span",{children:["| ",a.total_nodes," wzw"]}),e.jsxs("span",{children:["| ",a.total_assessable," ocenialnych"]}),a.owner&&e.jsxs("span",{children:["| Waciciel: ",a.owner]})]})]})]}),e.jsxs("div",{className:"toolbar-right",style:{alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm",onClick:k,title:"Utwrz kopi dokumentu",children:"Kopiuj"}),D.map(de=>e.jsx("button",{className:"btn btn-sm",onClick:()=>H(de),title:`Zmie na: ${fu(de)}`,children:fu(de)},de)),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:z,children:a.lifecycle_status==="draft"?"Usu":"Archiwizuj"}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>r(`/compliance/assessments?framework_id=${a.id}`),children:"Nowa ocena"})]})]}),e.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"8px 24px",fontSize:12},children:[e.jsx(tn,{label:"Typ dokumentu",value:a.document_type_name??""}),e.jsx(tn,{label:"Pochodzenie",value:Cv[a.document_origin]??a.document_origin}),e.jsx(tn,{label:"Waciciel",value:a.owner}),e.jsx(tn,{label:"Wersja",value:a.display_version}),e.jsx(tn,{label:"Zatwierdzony przez",value:a.approved_by}),e.jsx(tn,{label:"Data zatwierdzenia",value:a.approved_at?new Date(a.approved_at).toLocaleDateString("pl-PL"):null}),e.jsx(tn,{label:"Wymaga przegldu",value:a.requires_review?"Tak":"Nie"}),a.requires_review&&e.jsxs(e.Fragment,{children:[e.jsx(tn,{label:"Czstotliwo przegldu",value:`co ${a.review_frequency_months} mies.`}),e.jsx(tn,{label:"Nastpny przegld",value:a.next_review_date?new Date(a.next_review_date).toLocaleDateString("pl-PL"):null,color:I?"var(--red)":void 0}),e.jsx(tn,{label:"Ostatni przegld",value:a.last_reviewed_at?new Date(a.last_reviewed_at).toLocaleDateString("pl-PL"):null}),e.jsx(tn,{label:"Przegldajcy",value:a.reviewed_by})]}),a.updates_document_name&&e.jsx(tn,{label:"Aktualizuje dokument",value:a.updates_document_name,color:"var(--blue)"})]})}),a.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:"8px 12px",marginBottom:12},children:a.description}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:16,flexWrap:"wrap"},children:[{key:"tree",label:`Struktura (${L.total})`},{key:"dimensions",label:`Wymiary (${a.dimensions.length})`},{key:"org-units",label:`Jedn. organizacyjne (${f.length})`},{key:"reviews",label:`Przegldy (${x.length})`},{key:"versions",label:`Historia wersji (${u.length})`},{key:"metrics",label:"Metryka dokumentu"},{key:"attachments",label:"Zaczniki"},{key:"edit",label:"Edycja metadanych"}].map(de=>e.jsx("button",{style:{padding:"8px 16px",fontSize:12,fontWeight:_===de.key?600:400,background:_===de.key?"var(--blue-dim)":"transparent",borderBottom:_===de.key?"2px solid var(--blue)":"2px solid transparent",color:_===de.key?"var(--blue)":"var(--text-muted)",border:"none",borderBottomWidth:2,borderBottomStyle:"solid",cursor:"pointer"},onClick:()=>E(de.key),children:de.label},de.key))}),_==="tree"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:O?"1fr 420px":"1fr",gap:14},children:[e.jsxs("div",{className:"card",style:{padding:0,overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)",display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm",onClick:W,children:"Rozwi wszystko"}),e.jsx("button",{className:"btn btn-sm",onClick:J,children:"Zwi wszystko"}),e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[L.total," wzw | ",L.assessable," ocenialnych | gb. ",L.maxDepth]}),e.jsx("div",{style:{flex:1}}),U&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>F("interpret"),style:{fontSize:10,background:"var(--blue-dim)",color:"var(--blue)",border:"1px solid var(--blue)"},children:" Interpretuj dokument"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>F("translate"),style:{fontSize:10,background:"rgba(139,92,246,0.1)",color:"var(--purple, #8b5cf6)",border:"1px solid var(--purple, #8b5cf6)"},children:" Tumacz dokument"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>F("evidence"),style:{fontSize:10,background:"var(--green-dim)",color:"var(--green)",border:"1px solid var(--green)"},children:" Generuj dowody"})]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>M({parentId:null}),children:"+ Dodaj wze gwny"})]}),o.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak wzw. Dodaj pierwszy wze lub zaimportuj dokument."}):e.jsx("div",{style:{padding:"4px 0",maxHeight:"calc(100vh - 320px)",overflowY:"auto"},children:o.map(de=>e.jsx(_b,{node:de,expanded:C,onToggle:me,selectedId:O?.id??null,onSelect:Q,onAddChild:he=>M({parentId:he}),pointTypes:y,aiCache:U?A:void 0},de.id))})]}),O&&e.jsx("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:e.jsx(kE,{node:O,pointTypes:y,onClose:()=>Q(null),onDelete:()=>P(O.id),onSave:de=>T(O.id,de),onAddChild:()=>M({parentId:O.id}),frameworkName:a.name,aiEnabled:U,aiCache:A,onCacheUpdate:()=>a&&q(a.id)})})]}),_==="dimensions"&&e.jsx(CE,{dimensions:a.dimensions}),_==="org-units"&&e.jsx(TE,{fwId:a.id,orgUnits:f,onReload:ee}),_==="reviews"&&e.jsx(NE,{fwId:a.id,reviews:x,onReload:ee}),_==="versions"&&e.jsx(AE,{versions:u}),_==="metrics"&&e.jsx(BE,{fwId:a.id}),_==="attachments"&&e.jsx(OE,{fwId:a.id}),_==="edit"&&e.jsx(EE,{fw:a,onSaved:ee}),e.jsx(gt,{open:!!G,onClose:()=>M(null),title:G?.parentId?"Dodaj podwze":"Dodaj wze gwny",children:G&&e.jsx(zE,{parentId:G.parentId,pointTypes:y,onClose:()=>M(null),onCreate:ne})}),Z&&a&&e.jsx(RE,{action:Z,tree:o,frameworkName:a.name,aiCache:A,onClose:()=>F(null),onDone:()=>{q(a.id),F(null)}})]})}function _b({node:t,expanded:r,onToggle:a,selectedId:s,onSelect:o,onAddChild:d,pointTypes:u,aiCache:h}){const f=t.children.length>0,p=r.has(t.id),x=s===t.id,j=(t.depth-1)*24,y=t.point_type_id?u.find(E=>E.id===t.point_type_id)?.label:null,S=h?.has(Dr(t.id,"interpret")),w=h?.has(Dr(t.id,"evidence")),b=h?Array.from(h.values()).find(E=>E.node_id===t.id&&E.action_type==="translate"):void 0,_=b?b.result_json.translated_name:void 0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:6,padding:"5px 12px",paddingLeft:j+12,fontSize:12,background:x?"var(--bg-card-hover)":void 0,borderLeft:x?"3px solid var(--blue)":"3px solid transparent",cursor:"pointer",transition:"background 0.1s"},onClick:E=>{E.stopPropagation(),o(t)},children:[e.jsx("span",{style:{width:18,textAlign:"center",fontSize:10,color:"var(--text-muted)",flexShrink:0,cursor:f?"pointer":"default",lineHeight:"18px",userSelect:"none"},onClick:E=>{E.stopPropagation(),f&&a(t.id)},children:f?p?"":"":""}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[y&&e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:8,padding:"1px 5px"},children:y}),t.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--blue)",fontWeight:600,flexShrink:0},children:t.ref_id}),e.jsx("span",{style:{fontWeight:t.depth<=2?600:400},children:t.name_pl||t.name}),t.assessable&&e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)",fontSize:8,padding:"1px 5px"},children:"ocenialny"}),t.implementation_groups&&e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:8,padding:"1px 5px"},children:t.implementation_groups}),S&&e.jsx("span",{title:"Zinterpretowany (AI)",style:{fontSize:10,color:"var(--blue)",fontWeight:700,cursor:"default"},children:"i"}),_&&e.jsx("span",{title:"Przetumaczony (AI)",style:{fontSize:10,color:"var(--purple, #8b5cf6)",fontWeight:700,cursor:"default"},children:"A"}),w&&e.jsx("span",{title:"Dowody audytowe (AI)",style:{fontSize:10,color:"var(--green)",fontWeight:700,cursor:"default"},children:"E"})]}),_&&_!==t.name&&e.jsx("div",{style:{fontSize:10,color:"var(--purple, #8b5cf6)",marginTop:1,fontStyle:"italic",lineHeight:1.3},children:_}),t.description&&(p||!f)&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2,lineHeight:1.3,maxHeight:40,overflow:"hidden"},children:t.description})]}),e.jsx("span",{style:{fontSize:14,color:"var(--text-muted)",cursor:"pointer",padding:"0 4px",flexShrink:0,lineHeight:"18px",opacity:.5},title:"Dodaj podwze",onClick:E=>{E.stopPropagation(),d(t.id)},children:"+"})]}),p&&t.children.map(E=>e.jsx(_b,{node:E,expanded:r,onToggle:a,selectedId:s,onSelect:o,onAddChild:d,pointTypes:u,aiCache:h},E.id))]})}const Sb=[{code:"pl",label:"Polski"},{code:"en",label:"English"},{code:"de",label:"Deutsch"},{code:"fr",label:"Franais"},{code:"es",label:"Espaol"},{code:"it",label:"Italiano"},{code:"uk",label:""}];function kE({node:t,pointTypes:r,onClose:a,onDelete:s,onSave:o,onAddChild:d,frameworkName:u,aiEnabled:h,aiCache:f,onCacheUpdate:p}){const[x,j]=m.useState(!1),[y,S]=m.useState(t.name),[w,b]=m.useState(t.ref_id||""),[_,E]=m.useState(t.description||""),[C,N]=m.useState(t.assessable),[O,Q]=m.useState(t.annotation||""),[G,M]=m.useState(t.point_type_id??null),[U,A]=m.useState("none"),[R,Z]=m.useState(!1),[F,q]=m.useState(null),[ee,me]=m.useState(null),[W,J]=m.useState(null),[L,H]=m.useState("pl"),[ne,P]=m.useState(null),T=t.point_type_id?r.find(D=>D.id===t.point_type_id)?.label:null;m.useEffect(()=>{S(t.name),b(t.ref_id||""),E(t.description||""),N(t.assessable),Q(t.annotation||""),M(t.point_type_id??null),j(!1),A("none"),q(null);const D=f?.get(Dr(t.id,"interpret"));if(D){const ie=D.result_json;me({interpretation:ie.interpretation||"",practical_examples:ie.practical_examples||[],common_pitfalls:ie.common_pitfalls||[],related_standards:ie.related_standards||[]})}else me(null);const de=f?.get(Dr(t.id,"translate",L));if(de){const ie=de.result_json;J({translated_name:ie.translated_name||"",translated_description:ie.translated_description??null,terminology_notes:ie.terminology_notes||[]})}else J(null);const he=f?.get(Dr(t.id,"evidence"));if(he){const ie=he.result_json;P({evidence_items:ie.evidence_items||[],audit_tips:ie.audit_tips||[]})}else P(null)},[t.id,f]);const z=async(D=!1)=>{Z(!0),q(null),D&&me(null);try{const de=await le.post("/api/v1/ai/interpret-node",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,node_id:t.id,force:D});me(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{Z(!1)}},k=async(D=!1)=>{Z(!0),q(null),D&&J(null);try{const de=await le.post("/api/v1/ai/translate-node",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,target_language:L,node_id:t.id,force:D});J(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{Z(!1)}},I=async(D=!1)=>{Z(!0),q(null),D&&P(null);try{const de=await le.post("/api/v1/ai/generate-evidence",{framework_name:u,node_ref_id:t.ref_id,node_name:t.name,node_description:t.description,node_id:t.id,force:D});P(de),p?.()}catch(de){q(de instanceof Error?de.message:"Bd AI")}finally{Z(!1)}};return e.jsxs("div",{style:{fontSize:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegy wza"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[!x&&e.jsx("button",{className:"btn btn-sm",onClick:()=>j(!0),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:a,children:""})]})]}),x?e.jsxs("div",{style:{display:"grid",gap:10},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa"}),e.jsx("input",{className:"form-control",value:y,onChange:D=>S(D.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:w,onChange:D=>b(D.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ punktu"}),e.jsxs("select",{className:"form-control",value:G??"",onChange:D=>M(D.target.value?Number(D.target.value):null),children:[e.jsx("option",{value:"",children:" brak "}),r.map(D=>e.jsx("option",{value:D.id,children:D.label},D.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:_,onChange:D=>E(D.target.value),rows:4})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Adnotacja"}),e.jsx("textarea",{className:"form-control",value:O,onChange:D=>Q(D.target.value),rows:2})]}),e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:C,onChange:D=>N(D.target.checked)}),"Ocenialny (li drzewa do oceny)"]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{o({name:y,ref_id:w||null,description:_||null,assessable:C,annotation:O||null,point_type_id:G})},children:"Zapisz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>j(!1),children:"Anuluj"})]})]}):e.jsxs(e.Fragment,{children:[T&&e.jsx("div",{style:{marginBottom:4},children:e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",color:"var(--text-muted)",fontSize:10},children:T})}),t.ref_id&&e.jsx("div",{style:{fontFamily:"'JetBrains Mono',monospace",color:"var(--blue)",fontWeight:600,marginBottom:4},children:t.ref_id}),e.jsx("div",{style:{fontWeight:600,marginBottom:4,fontSize:14},children:t.name_pl||t.name}),W&&W.translated_name!==t.name&&e.jsx("div",{style:{fontSize:12,color:"var(--purple, #8b5cf6)",fontStyle:"italic",marginBottom:4,lineHeight:1.4},children:W.translated_name}),t.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5},children:t.description}),W?.translated_description&&W.translated_description!==t.description&&e.jsx("div",{style:{fontSize:11,color:"var(--purple, #8b5cf6)",fontStyle:"italic",background:"rgba(139,92,246,0.05)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5},children:W.translated_description}),ee&&U!=="interpret"&&e.jsxs("div",{style:{fontSize:11,color:"var(--blue)",background:"var(--blue-dim)",borderRadius:6,padding:8,marginBottom:4,lineHeight:1.5,cursor:"pointer"},onClick:()=>A("interpret"),title:"Kliknij aby rozwin",children:[e.jsx("strong",{children:"Interpretacja:"})," ",ee.interpretation.slice(0,150),ee.interpretation.length>150?"...":""]}),t.content&&e.jsxs("div",{style:{marginBottom:8},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)",marginBottom:4},children:"Pena tre sekcji"}),e.jsx("div",{style:{fontSize:12,color:"var(--text)",background:"var(--bg-inset)",borderRadius:6,padding:10,lineHeight:1.6,maxHeight:300,overflowY:"auto",whiteSpace:"pre-wrap"},children:t.content})]}),t.annotation&&e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11},children:[e.jsx("strong",{children:"Adnotacja:"}),e.jsx("br",{}),t.annotation]}),t.typical_evidence&&e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11},children:[e.jsx("strong",{children:"Typowe dowody:"}),e.jsx("br",{}),t.typical_evidence]}),e.jsxs("div",{style:{lineHeight:2},children:[e.jsx(tn,{label:"Gboko",value:t.depth}),e.jsx(tn,{label:"Typ punktu",value:T??""}),e.jsx(tn,{label:"Ocenialny",value:t.assessable?e.jsx("span",{style:{color:"var(--green)",fontWeight:500},children:"Tak"}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"Nie"})}),t.implementation_groups&&e.jsx(tn,{label:"Gr. implementacji",value:t.implementation_groups}),t.importance&&e.jsx(tn,{label:"Wano",value:t.importance})]}),h&&e.jsxs("div",{style:{marginTop:12,borderTop:"1px solid var(--border)",paddingTop:10},children:[e.jsxs("div",{style:{display:"flex",gap:6,marginBottom:8},children:[e.jsxs("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:U==="interpret"?"var(--blue)":void 0,color:U==="interpret"?"#fff":void 0,border:U==="interpret"?"1px solid var(--blue)":void 0},onClick:()=>{U==="interpret"?A("none"):(A("interpret"),ee||z(!1))},disabled:R,title:"Interpretacja AI",children:[" Interpretacja",ee&&e.jsx("span",{style:{fontSize:9,marginLeft:2},children:""})]}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:U==="translate"?"var(--purple, #8b5cf6)":void 0,color:U==="translate"?"#fff":void 0,border:U==="translate"?"1px solid var(--purple, #8b5cf6)":void 0},onClick:()=>A(U==="translate"?"none":"translate"),disabled:R,title:"Tumaczenie AI",children:" Tumaczenie"}),e.jsxs("button",{className:"btn btn-sm",style:{flex:1,fontSize:11,display:"flex",alignItems:"center",justifyContent:"center",gap:4,background:U==="evidence"?"var(--green)":void 0,color:U==="evidence"?"#fff":void 0,border:U==="evidence"?"1px solid var(--green)":void 0},onClick:()=>{U==="evidence"?A("none"):(A("evidence"),ne||I(!1))},disabled:R,title:"Dowody audytowe",children:[" Dowody",ne&&e.jsx("span",{style:{fontSize:9,marginLeft:2},children:""})]})]}),R&&e.jsx("div",{style:{padding:12,textAlign:"center",fontSize:11,color:"var(--text-muted)"},children:"Przetwarzanie AI..."}),F&&e.jsx("div",{style:{padding:8,borderRadius:6,background:"#7f1d1d",color:"#fca5a5",fontSize:11,marginBottom:8},children:F}),U==="interpret"&&ee&&!R&&e.jsxs("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10,fontSize:11,lineHeight:1.6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--blue)"},children:"Interpretacja"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:9,padding:"1px 6px"},onClick:()=>z(!0),disabled:R,children:"Ponw"})]}),e.jsx("div",{style:{marginBottom:8},children:ee.interpretation}),ee.practical_examples.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--green)"},children:"Przykady praktyczne"}),e.jsx("ul",{style:{margin:"0 0 8px",paddingLeft:16},children:ee.practical_examples.map((D,de)=>e.jsx("li",{children:D},de))})]}),ee.common_pitfalls.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--orange)"},children:"Typowe bdy"}),e.jsx("ul",{style:{margin:"0 0 8px",paddingLeft:16},children:ee.common_pitfalls.map((D,de)=>e.jsx("li",{children:D},de))})]}),ee.related_standards.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"var(--text-muted)"},children:"Powizane standardy"}),e.jsx("div",{children:ee.related_standards.join(", ")})]})]}),U==="translate"&&e.jsxs("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10},children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:8,alignItems:"center"},children:[e.jsx("select",{className:"form-control",value:L,onChange:D=>{H(D.target.value),J(null)},style:{fontSize:11,flex:1},children:Sb.map(D=>e.jsx("option",{value:D.code,children:D.label},D.code))}),e.jsx("button",{className:"btn btn-sm",onClick:()=>k(!1),disabled:R,style:{fontSize:10,background:"var(--purple, #8b5cf6)",color:"#fff",border:"none"},children:"Tumacz"}),W&&e.jsx("button",{className:"btn btn-sm",onClick:()=>k(!0),disabled:R,style:{fontSize:9,padding:"2px 6px"},children:"Ponw"})]}),W&&!R&&e.jsxs("div",{style:{fontSize:11,lineHeight:1.6},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--purple, #8b5cf6)",marginBottom:4},children:"Tumaczenie"}),e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:W.translated_name}),W.translated_description&&e.jsx("div",{style:{marginBottom:6,color:"var(--text-secondary)"},children:W.translated_description}),W.terminology_notes.length>0&&e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",fontStyle:"italic"},children:W.terminology_notes.join(" | ")})]})]}),U==="evidence"&&e.jsx("div",{style:{background:"var(--bg-inset)",borderRadius:8,padding:10,fontSize:11,lineHeight:1.6},children:ne&&!R?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--green)"},children:"Dowody audytowe"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:9,padding:"1px 6px"},onClick:()=>I(!0),disabled:R,children:"Ponw"})]}),ne.evidence_items.map((D,de)=>e.jsxs("div",{style:{marginBottom:6,padding:"4px 6px",borderLeft:`2px solid ${D.priority==="required"?"var(--red)":D.priority==="recommended"?"var(--orange)":"var(--text-muted)"}`},children:[e.jsxs("div",{style:{fontWeight:600},children:[D.name,e.jsx("span",{className:"score-badge",style:{marginLeft:6,fontSize:8,padding:"1px 4px",background:D.type==="document"?"var(--blue-dim)":D.type==="record"?"var(--green-dim)":"var(--bg-inset)",color:D.type==="document"?"var(--blue)":D.type==="record"?"var(--green)":"var(--text-muted)"},children:D.type}),e.jsx("span",{className:"score-badge",style:{marginLeft:4,fontSize:8,padding:"1px 4px",background:D.priority==="required"?"var(--red-dim)":D.priority==="recommended"?"var(--orange-dim)":"var(--bg-inset)",color:D.priority==="required"?"var(--red)":D.priority==="recommended"?"var(--orange)":"var(--text-muted)"},children:D.priority==="required"?"wymagane":D.priority==="recommended"?"zalecane":"opcjonalne"})]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:D.description})]},de)),ne.audit_tips.length>0&&e.jsxs("div",{style:{marginTop:8,padding:6,background:"var(--bg-card-hover)",borderRadius:4,fontSize:10},children:[e.jsx("strong",{children:"Wskazwki:"}),e.jsx("ul",{style:{margin:"4px 0 0",paddingLeft:16},children:ne.audit_tips.map((D,de)=>e.jsx("li",{children:D},de))})]})]}):null})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",style:{flex:1},onClick:()=>j(!0),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:d,children:"+ Podwze"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:s,children:"Usu"})]})]})]})}function zE({parentId:t,pointTypes:r,onClose:a,onCreate:s}){const[o,d]=m.useState(""),[u,h]=m.useState(""),[f,p]=m.useState(""),[x,j]=m.useState(!1),[y,S]=m.useState(null);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{className:"form-control",value:o,onChange:w=>d(w.target.value),placeholder:"Nazwa wza",autoFocus:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:u,onChange:w=>h(w.target.value),placeholder:"np. A.5.1"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ punktu"}),e.jsxs("select",{className:"form-control",value:y??"",onChange:w=>S(w.target.value?Number(w.target.value):null),children:[e.jsx("option",{value:"",children:" brak "}),r.map(w=>e.jsx("option",{value:w.id,children:w.label},w.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:f,onChange:w=>p(w.target.value),rows:3})]}),e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6},children:[e.jsx("input",{type:"checkbox",checked:x,onChange:w=>j(w.target.checked)}),"Ocenialny (li drzewa do oceny)"]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:a,children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!o.trim(),onClick:()=>s({name:o,ref_id:u,description:f,assessable:x,parent_id:t,point_type_id:y}),children:"Dodaj"})]})]})}function CE({dimensions:t}){return t.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Ten dokument nie ma zdefiniowanych wymiarw oceny."}):e.jsx("div",{style:{display:"grid",gap:12},children:t.map(r=>e.jsxs("div",{className:"card",style:{padding:"12px 16px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:r.name_pl||r.name}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Klucz: ",r.dimension_key," | Waga: ",r.weight]})]})}),r.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:8},children:r.description}),r.levels.length>0&&e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:r.levels.map(a=>e.jsxs("div",{style:{padding:"4px 10px",borderRadius:6,fontSize:11,background:a.color?`${a.color}20`:"var(--bg-inset)",color:a.color??"var(--text)",border:`1px solid ${a.color??"var(--border)"}`},children:[e.jsx("strong",{children:a.value}),"  ",a.label_pl||a.label]},a.id))})]},r.id))})}function TE({fwId:t,orgUnits:r,onReload:a}){const[s,o]=m.useState(!1),[d,u]=m.useState(""),[h,f]=m.useState("not_assessed"),[p,x]=m.useState(""),[j,y]=m.useState(!1),S=async()=>{if(d){y(!0);try{await le.post(`/api/v1/frameworks/${t}/org-units`,{org_unit_id:Number(d),compliance_status:h,notes:p||null}),o(!1),u(""),x(""),a()}catch(_){alert(_ instanceof Error?_.message:"Bd dodawania")}finally{y(!1)}}},w=async _=>{if(confirm("Usun powizanie z jednostk organizacyjn?"))try{await le.delete(`/api/v1/frameworks/${t}/org-units/${_}`),a()}catch(E){alert(E instanceof Error?E.message:"Bd usuwania")}},b={not_assessed:{label:"Nieoceniony",color:"var(--text-muted)"},compliant:{label:"Zgodny",color:"var(--green)"},partially_compliant:{label:"Czciowo zgodny",color:"var(--orange)"},non_compliant:{label:"Niezgodny",color:"var(--red)"}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--text)"},children:["Powizane jednostki organizacyjne (",r.length,")"]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>o(!0),children:"+ Dodaj powizanie"})]}),r.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak powiza z jednostkami organizacyjnymi. Dodaj powizanie, aby ledzi zgodno."}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Jednostka organizacyjna"}),e.jsx("th",{children:"Status zgodnoci"}),e.jsx("th",{children:"Ostatnia ocena"}),e.jsx("th",{children:"Notatki"}),e.jsx("th",{style:{width:60}})]})}),e.jsx("tbody",{children:r.map(_=>{const E=b[_.compliance_status]??{label:_.compliance_status,color:"var(--text-muted)"};return e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:_.org_unit_name??`ID: ${_.org_unit_id}`}),e.jsx("td",{children:e.jsx("span",{style:{color:E.color,fontWeight:500,fontSize:11},children:E.label})}),e.jsx("td",{style:{fontSize:11},children:_.last_assessed_at?new Date(_.last_assessed_at).toLocaleDateString("pl-PL"):""}),e.jsx("td",{style:{fontSize:11,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:_.notes||""}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)",fontSize:10},onClick:()=>w(_.id),children:"Usu"})})]},_.id)})})]})}),e.jsx(gt,{open:s,onClose:()=>o(!1),title:"Dodaj powizanie z jednostk organizacyjn",children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID jednostki organizacyjnej *"}),e.jsx("input",{className:"form-control",type:"number",value:d,onChange:_=>u(_.target.value),placeholder:"ID jednostki",autoFocus:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status zgodnoci"}),e.jsxs("select",{className:"form-control",value:h,onChange:_=>f(_.target.value),children:[e.jsx("option",{value:"not_assessed",children:"Nieoceniony"}),e.jsx("option",{value:"compliant",children:"Zgodny"}),e.jsx("option",{value:"partially_compliant",children:"Czciowo zgodny"}),e.jsx("option",{value:"non_compliant",children:"Niezgodny"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Notatki"}),e.jsx("textarea",{className:"form-control",value:p,onChange:_=>x(_.target.value),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:!d||j,onClick:S,children:j?"Zapisywanie...":"Dodaj"})]})]})})]})}function NE({fwId:t,reviews:r,onReload:a}){const[s,o]=m.useState(!1),[d,u]=m.useState(""),[h,f]=m.useState("periodic"),[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState("completed"),[b,_]=m.useState(!1),E=async()=>{_(!0);try{await le.post(`/api/v1/frameworks/${t}/reviews`,{reviewer:d||null,review_type:h,findings:p||null,recommendations:j||null,status:S}),o(!1),u(""),x(""),y(""),a()}catch(N){alert(N instanceof Error?N.message:"Bd dodawania przegldu")}finally{_(!1)}},C={completed:{label:"Zakoczony",color:"var(--green)"},in_progress:{label:"W trakcie",color:"var(--orange)"},planned:{label:"Zaplanowany",color:"var(--blue)"}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--text)"},children:["Historia przegldw (",r.length,")"]}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>o(!0),children:"+ Nowy przegld"})]}),r.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak zarejestrowanych przegldw dla tego dokumentu."}):e.jsx("div",{style:{display:"grid",gap:10},children:r.map(N=>{const O=C[N.status]??{label:N.status,color:"var(--text-muted)"};return e.jsxs("div",{className:"card",style:{padding:"12px 16px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600,fontSize:13},children:N.review_date?new Date(N.review_date).toLocaleDateString("pl-PL"):""}),e.jsx("span",{style:{color:O.color,fontSize:11,fontWeight:500},children:O.label}),e.jsx("span",{className:"score-badge",style:{background:"var(--bg-inset)",fontSize:9},children:N.review_type==="periodic"?"Okresowy":N.review_type==="ad_hoc"?"Ad hoc":N.review_type})]}),N.reviewer&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:N.reviewer})]}),N.findings&&e.jsxs("div",{style:{fontSize:11,marginBottom:4},children:[e.jsx("strong",{children:"Ustalenia:"})," ",N.findings]}),N.recommendations&&e.jsxs("div",{style:{fontSize:11},children:[e.jsx("strong",{children:"Rekomendacje:"})," ",N.recommendations]}),N.next_review_date&&e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4},children:["Nastpny przegld: ",new Date(N.next_review_date).toLocaleDateString("pl-PL")]})]},N.id)})}),e.jsx(gt,{open:s,onClose:()=>o(!1),title:"Rejestruj przegld dokumentu",children:e.jsxs("div",{style:{display:"grid",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Przegldajcy"}),e.jsx("input",{className:"form-control",value:d,onChange:N=>u(N.target.value),placeholder:"Imi i nazwisko",autoFocus:!0})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ przegldu"}),e.jsxs("select",{className:"form-control",value:h,onChange:N=>f(N.target.value),children:[e.jsx("option",{value:"periodic",children:"Okresowy"}),e.jsx("option",{value:"ad_hoc",children:"Ad hoc"}),e.jsx("option",{value:"initial",children:"Wstpny"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:S,onChange:N=>w(N.target.value),children:[e.jsx("option",{value:"completed",children:"Zakoczony"}),e.jsx("option",{value:"in_progress",children:"W trakcie"}),e.jsx("option",{value:"planned",children:"Zaplanowany"})]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ustalenia"}),e.jsx("textarea",{className:"form-control",value:p,onChange:N=>x(N.target.value),rows:3,placeholder:"Wyniki przegldu..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Rekomendacje"}),e.jsx("textarea",{className:"form-control",value:j,onChange:N=>y(N.target.value),rows:3,placeholder:"Zalecenia..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",disabled:b,onClick:E,children:b?"Zapisywanie...":"Zarejestruj przegld"})]})]})})]})}function AE({versions:t}){return t.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak historii wersji."}):e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Wersja"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Opis zmian"}),e.jsx("th",{children:"Zmienione przez"}),e.jsx("th",{children:"Data"}),e.jsx("th",{style:{textAlign:"right"},children:"Wzy"}),e.jsx("th",{style:{textAlign:"right"},children:"Ocenialne"})]})}),e.jsx("tbody",{children:t.map(r=>e.jsxs("tr",{children:[e.jsxs("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:["v",r.edit_version]}),e.jsx("td",{children:e.jsx("span",{className:"score-badge",style:{background:bb(r.lifecycle_status),color:jb(r.lifecycle_status),fontSize:10},children:fu(r.lifecycle_status)})}),e.jsx("td",{style:{fontSize:11,maxWidth:300},children:r.change_summary||""}),e.jsx("td",{style:{fontSize:11},children:r.changed_by||""}),e.jsx("td",{style:{fontSize:11,whiteSpace:"nowrap"},children:r.changed_at?new Date(r.changed_at).toLocaleString("pl-PL"):""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:r.snapshot_nodes_count??""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:r.snapshot_assessable_count??""})]},r.id))})]})})})}function EE({fw:t,onSaved:r}){const[a,s]=m.useState(t.name),[o,d]=m.useState(t.ref_id||""),[u,h]=m.useState(t.description||""),[f,p]=m.useState(t.version||""),[x,j]=m.useState(t.provider||""),[y,S]=m.useState(t.published_version||""),[w,b]=m.useState(t.owner||""),[_,E]=m.useState(t.requires_review),[C,N]=m.useState(t.review_frequency_months),[O,Q]=m.useState(""),[G,M]=m.useState(!1),U=async()=>{M(!0);try{await le.put(`/api/v1/frameworks/${t.id}`,{name:a||void 0,ref_id:o||void 0,description:u||void 0,version:f||void 0,provider:x||void 0,published_version:y||void 0,owner:w||void 0,requires_review:_,review_frequency_months:C,change_summary:O||void 0}),Q(""),r()}catch(A){alert(A instanceof Error?A.message:"Bd zapisu")}finally{M(!1)}};return e.jsx("div",{className:"card",style:{padding:"16px 20px"},children:e.jsx("div",{style:{maxWidth:600},children:e.jsxs("div",{style:{display:"grid",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa"}),e.jsx("input",{className:"form-control",value:a,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ID referencyjny"}),e.jsx("input",{className:"form-control",value:o,onChange:A=>d(A.target.value)})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja rdowa"}),e.jsx("input",{className:"form-control",value:f,onChange:A=>p(A.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wersja publikacji"}),e.jsx("input",{className:"form-control",value:y,onChange:A=>S(A.target.value),placeholder:"np. 1.0"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Dostawca"}),e.jsx("input",{className:"form-control",value:x,onChange:A=>j(A.target.value)})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waciciel dokumentu"}),e.jsx("input",{className:"form-control",value:w,onChange:A=>b(A.target.value),placeholder:"Imi i nazwisko lub rola"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",value:u,onChange:A=>h(A.target.value),rows:4})]}),e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:12},children:[e.jsxs("label",{style:{fontSize:12,display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[e.jsx("input",{type:"checkbox",checked:_,onChange:A=>E(A.target.checked)}),"Wymaga okresowego przegldu"]}),_&&e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{children:"Czstotliwo przegldu (miesice)"}),e.jsx("input",{className:"form-control",type:"number",min:1,max:120,value:C,onChange:A=>N(Number(A.target.value))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis zmian (do historii wersji)"}),e.jsx("input",{className:"form-control",value:O,onChange:A=>Q(A.target.value),placeholder:"Co zostao zmienione?"})]}),e.jsx("div",{style:{display:"flex",gap:8},children:e.jsx("button",{className:"btn btn-primary",onClick:U,disabled:G,children:G?"Zapisywanie...":"Zapisz zmiany"})}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:4},children:["Kada edycja tworzy now wersj w historii. Wersja dokumentu: ",t.display_version??`${t.major_version}.${t.minor_version}`," (edycja v",t.edit_version,")."]})]})})})}function Tv(t){const r=[],a=s=>{for(const o of s)r.push(o),a(o.children)};return a(t),r}function FE(t,r){const a=[],s=(o,d)=>{for(const u of o){const h=d||r.has(u.id);h&&a.push(u),s(u.children,h)}};return s(t,!1),a}function RE({action:t,tree:r,frameworkName:a,aiCache:s,onClose:o,onDone:d}){const[u,h]=m.useState("all"),[f,p]=m.useState(new Set),[x,j]=m.useState("pl"),[y,S]=m.useState(!0),[w,b]=m.useState(!1),[_,E]=m.useState({done:0,total:0,errors:0,skipped:0}),[C,N]=m.useState(null),O=m.useRef(!1),Q=m.useMemo(()=>Tv(r),[r]),G=m.useMemo(()=>r,[r]),M=m.useMemo(()=>u==="all"?Q:u==="chapters"?FE(r,f):Q,[u,Q,r,f]),U=m.useMemo(()=>{let W=0;for(const J of M){const L=t==="translate"?Dr(J.id,"translate",x):Dr(J.id,t);s.has(L)&&W++}return W},[M,t,x,s]),A=W=>{p(J=>{const L=new Set(J);return L.has(W)?L.delete(W):L.add(W),L})},R=async()=>{O.current=!1,b(!0);const W=M,J=W.length;let L=0,H=0,ne=0;E({done:0,total:J,errors:0,skipped:0});for(const P of W){if(O.current)break;if(y){const T=t==="translate"?Dr(P.id,"translate",x):Dr(P.id,t);if(s.has(T)){ne++,L++,E({done:L,total:J,errors:H,skipped:ne});continue}}N(P.ref_id?`${P.ref_id}  ${P.name}`:P.name);try{t==="interpret"?await le.post("/api/v1/ai/interpret-node",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,node_id:P.id,force:!y}):t==="translate"?await le.post("/api/v1/ai/translate-node",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,target_language:x,node_id:P.id,force:!y}):await le.post("/api/v1/ai/generate-evidence",{framework_name:a,node_ref_id:P.ref_id,node_name:P.name,node_description:P.description,node_id:P.id,force:!y})}catch{H++}L++,E({done:L,total:J,errors:H,skipped:ne})}N(null),b(!1)},Z=()=>{O.current=!0},F=t==="interpret",q=t==="evidence",ee=F?"Interpretacja dokumentu (AI)":q?"Generowanie dowodw (AI)":"Tumaczenie dokumentu (AI)",me=_.total>0?Math.round(_.done/_.total*100):0;return e.jsx(gt,{open:!0,onClose:w?()=>{}:o,title:ee,children:e.jsx("div",{style:{minWidth:400,maxWidth:600},children:w?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[e.jsxs("span",{children:[F?"Interpretacja":q?"Generowanie dowodw":"Tumaczenie"," w toku..."]}),e.jsxs("span",{style:{fontWeight:600},children:[me,"%"]})]}),e.jsx("div",{style:{height:6,background:"var(--bg-inset)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${me}%`,background:F?"var(--blue)":"var(--purple, #8b5cf6)",borderRadius:3,transition:"width 0.3s"}})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:[_.done," / ",_.total,_.skipped>0&&e.jsxs(e.Fragment,{children:[" (pominite: ",_.skipped,")"]}),_.errors>0&&e.jsxs("span",{style:{color:"var(--red)"},children:[" | Bdy: ",_.errors]})]})]}),C&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)",padding:8,background:"var(--bg-inset)",borderRadius:6,marginBottom:12,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Przetwarzanie: ",C]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:_.done<_.total?e.jsx("button",{className:"btn",style:{color:"var(--red)"},onClick:Z,children:"Zatrzymaj"}):e.jsx("button",{className:"btn btn-primary",onClick:d,children:"Zamknij"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:6},children:"Zakres"}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:4,cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"scope",checked:u==="all",onChange:()=>h("all")}),"Cay dokument (",Q.length," wzw)"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:4,cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"scope",checked:u==="chapters",onChange:()=>h("chapters")}),"Wybrane rozdziay"]})]}),u==="chapters"&&e.jsx("div",{style:{maxHeight:200,overflowY:"auto",border:"1px solid var(--border)",borderRadius:6,padding:8,marginBottom:12},children:G.length===0?e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Brak rozdziaw."}):G.map(W=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:11,padding:"3px 0",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:f.has(W.id),onChange:()=>A(W.id)}),W.ref_id&&e.jsx("span",{style:{fontFamily:"monospace",color:"var(--blue)",fontSize:10},children:W.ref_id}),W.name,e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:10},children:["(",Tv([W]).length," wzw)"]})]},W.id))}),t==="translate"&&e.jsxs("div",{style:{marginBottom:12},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,marginBottom:4},children:"Jzyk docelowy"}),e.jsx("select",{className:"form-control",value:x,onChange:W=>j(W.target.value),style:{fontSize:12},children:Sb.map(W=>e.jsx("option",{value:W.code,children:W.label},W.code))})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,marginBottom:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:y,onChange:W=>S(W.target.checked)}),"Pomi ju przetworzone (",U," z ",M.length," w cache)"]}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:12,padding:8,background:"var(--bg-inset)",borderRadius:6},children:[F?"Interpretacja":q?"Generowanie dowodw":"Tumaczenie"," obejmie ",e.jsx("strong",{children:M.length})," wzw.",y&&U>0&&e.jsxs(e.Fragment,{children:[" Z tego ",e.jsx("strong",{children:U})," zostanie pominitych (cache)."]})," ","Szacowany czas: ~",Math.max(1,Math.ceil((M.length-(y?U:0))*3/60))," min."]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:o,children:"Anuluj"}),e.jsxs("button",{className:"btn btn-primary",disabled:u==="chapters"&&f.size===0,onClick:R,children:["Rozpocznij ",F?"interpretacj":q?"generowanie":"tumaczenie"]})]})]})})})}function BE({fwId:t}){const[r,a]=m.useState(null),[s,o]=m.useState(!0),[d,u]=m.useState(!1),[h,f]=m.useState(!1),[p,x]=m.useState([]),[j,y]=m.useState([]),[S,w]=m.useState({});m.useEffect(()=>{o(!0),le.get(`/api/v1/frameworks/${t}/metrics`).then(N=>{a(N),x(N.change_history||[]),y(N.responsibilities||[]),w({implementation_date:N.implementation_date||"",implementation_method:N.implementation_method||"",verification_date:N.verification_date||"",effective_date:N.effective_date||"",distribution_responsible:N.distribution_responsible||"",distribution_date:N.distribution_date||"",distribution_list:N.distribution_list||"",notification_method:N.notification_method||"",access_level:N.access_level||"",classification:N.classification||"",additional_permissions:N.additional_permissions||"",applicable_roles:N.applicable_roles||"",management_approved:N.management_approved||""})}).catch(()=>a(null)).finally(()=>o(!1))},[t]);const b=async()=>{f(!0);try{await le.put(`/api/v1/frameworks/${t}/metrics`,{change_history:p,responsibilities:j,...S}),u(!1);const N=await le.get(`/api/v1/frameworks/${t}/metrics`);a(N)}catch(N){alert(N instanceof Error?N.message:"Bd zapisu")}finally{f(!1)}};if(s)return e.jsx("div",{className:"card",style:{padding:40,textAlign:"center"},children:"adowanie metryki..."});const _={width:"100%",borderCollapse:"collapse",fontSize:12,marginBottom:16},E={textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11,color:"var(--text-muted)",fontWeight:600},C={padding:"6px 10px",borderBottom:"1px solid var(--border)"};return e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Metryka dokumentu"}),d?e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:b,disabled:h,children:h?"...":"Zapisz"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>u(!1),children:"Anuluj"})]}):e.jsx("button",{className:"btn btn-sm",onClick:()=>u(!0),children:"Edytuj"})]}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Historia zmian dokumentu"}),e.jsxs("table",{style:_,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:E,children:"Wersja"}),e.jsx("th",{style:E,children:"Data"}),e.jsx("th",{style:E,children:"Autor"}),e.jsx("th",{style:E,children:"Opis zmiany"}),d&&e.jsx("th",{style:E})]})}),e.jsxs("tbody",{children:[p.map((N,O)=>e.jsx("tr",{children:d?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:C,children:e.jsx("input",{style:{width:50,fontSize:12},value:N.version,onChange:Q=>{const G=[...p];G[O]={...N,version:Q.target.value},x(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:90,fontSize:12},value:N.date,onChange:Q=>{const G=[...p];G[O]={...N,date:Q.target.value},x(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:120,fontSize:12},value:N.author,onChange:Q=>{const G=[...p];G[O]={...N,author:Q.target.value},x(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.description,onChange:Q=>{const G=[...p];G[O]={...N,description:Q.target.value},x(G)}})}),e.jsx("td",{style:C,children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>x(p.filter((Q,G)=>G!==O)),children:"X"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{style:C,children:N.version}),e.jsx("td",{style:C,children:N.date}),e.jsx("td",{style:C,children:N.author}),e.jsx("td",{style:C,children:N.description})]})},O)),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:d?5:4,style:{...C,color:"var(--text-muted)",textAlign:"center"},children:"Brak wpisw"})})]})]}),d&&e.jsx("button",{className:"btn btn-sm",style:{marginBottom:16},onClick:()=>x([...p,{version:"",date:"",author:"",description:""}]),children:"+ Dodaj wiersz"}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Odpowiedzialnoci i akceptacje"}),e.jsxs("table",{style:_,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:E,children:"Rola"}),e.jsx("th",{style:E,children:"Imi i nazwisko"}),e.jsx("th",{style:E,children:"Stanowisko"}),e.jsx("th",{style:E,children:"Data"}),d&&e.jsx("th",{style:E})]})}),e.jsxs("tbody",{children:[j.map((N,O)=>e.jsx("tr",{children:d?e.jsxs(e.Fragment,{children:[e.jsx("td",{style:C,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.role,onChange:Q=>{const G=[...j];G[O]={...N,role:Q.target.value},y(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.name,onChange:Q=>{const G=[...j];G[O]={...N,name:Q.target.value},y(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:"100%",fontSize:12},value:N.title,onChange:Q=>{const G=[...j];G[O]={...N,title:Q.target.value},y(G)}})}),e.jsx("td",{style:C,children:e.jsx("input",{style:{width:90,fontSize:12},value:N.date,onChange:Q=>{const G=[...j];G[O]={...N,date:Q.target.value},y(G)}})}),e.jsx("td",{style:C,children:e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>y(j.filter((Q,G)=>G!==O)),children:"X"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{style:C,children:N.role}),e.jsx("td",{style:C,children:N.name}),e.jsx("td",{style:C,children:N.title}),e.jsx("td",{style:C,children:N.date})]})},O)),j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:d?5:4,style:{...C,color:"var(--text-muted)",textAlign:"center"},children:"Brak wpisw"})})]})]}),d&&e.jsx("button",{className:"btn btn-sm",style:{marginBottom:16},onClick:()=>y([...j,{role:"",name:"",title:"",date:""}]),children:"+ Dodaj wiersz"}),e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--blue)"},children:"Wdroenie dokumentu"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[{key:"applicable_roles",label:"Role i obszary obowizywania"},{key:"implementation_date",label:"Data zakoczenia wdroenia"},{key:"verification_date",label:"Data weryfikacji wdroenia"},{key:"effective_date",label:"Dokument obowizuje od"},{key:"distribution_responsible",label:"Odpowiedzialny za dystrybucj"},{key:"distribution_date",label:"Data dystrybucji"},{key:"distribution_list",label:"Dystrybucja do"},{key:"notification_method",label:"Forma poinformowania"},{key:"access_level",label:"Poziom uprawnie dostpu"},{key:"additional_permissions",label:"Uprawnienia dodatkowe"},{key:"management_approved",label:"Zasady zatwierdzane przez Zarzd"}].map(N=>e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:2},children:N.label}),d?e.jsx("input",{className:"form-input",style:{width:"100%",fontSize:12},value:S[N.key]||"",onChange:O=>w({...S,[N.key]:O.target.value})}):e.jsx("div",{style:{fontSize:12,padding:"4px 0"},children:S[N.key]||""})]},N.key))}),!r?.exists&&!d&&e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:'Brak metryki dokumentu. Metryka zostanie wyodrbniona automatycznie podczas importu AI lub moesz j doda rcznie klikajc "Edytuj".'})]})}function OE({fwId:t}){const[r,a]=m.useState([]),[s,o]=m.useState(!0),[d,u]=m.useState(!1),h=m.useRef(null),f=()=>{o(!0),le.get(`/api/v1/frameworks/${t}/attachments`).then(a).catch(()=>a([])).finally(()=>o(!1))};m.useEffect(()=>{f()},[t]);const p=async S=>{u(!0);try{const w=new FormData;w.append("file",S),await fetch(`/api/v1/frameworks/${t}/attachments`,{method:"POST",body:w}),f()}catch(w){alert(w instanceof Error?w.message:"Bd uploadu")}finally{u(!1),h.current&&(h.current.value="")}},x=S=>{window.open(`/api/v1/frameworks/${t}/attachments/${S.id}/download`,"_blank")},j=async S=>{if(confirm(`Usun zacznik "${S.original_name}"?`))try{await le.delete(`/api/v1/frameworks/${t}/attachments/${S.id}`),f()}catch(w){alert(w instanceof Error?w.message:"Bd usuwania")}},y=S=>S<1024?`${S} B`:S<1024*1024?`${(S/1024).toFixed(1)} KB`:`${(S/1024/1024).toFixed(1)} MB`;return s?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center"},children:"adowanie zacznikw..."}):e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Zaczniki dokumentu"}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("input",{ref:h,type:"file",style:{display:"none"},onChange:S=>S.target.files?.[0]&&p(S.target.files[0])}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>h.current?.click(),disabled:d,children:d?"Uploading...":"+ Dodaj zacznik"})]})]}),r.length===0?e.jsx("div",{style:{padding:30,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak zacznikw. Plik rdowy jest automatycznie doczany podczas importu AI."}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Nazwa pliku"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Rozmiar"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Dodano"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11},children:"Opis"}),e.jsx("th",{style:{textAlign:"right",padding:"6px 10px",background:"var(--bg-inset)",borderBottom:"1px solid var(--border)",fontSize:11}})]})}),e.jsx("tbody",{children:r.map(S=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)"},children:e.jsx("span",{style:{color:"var(--blue)",cursor:"pointer"},onClick:()=>x(S),children:S.original_name})}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:y(S.file_size)}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:S.created_at?new Date(S.created_at).toLocaleString("pl"):""}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",color:"var(--text-muted)"},children:S.description||""}),e.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",gap:4,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>x(S),children:"Pobierz"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>j(S),children:"Usu"})]})})]},S.id))})]})]})}function DE(t){return t==="approved"?"badge-green":t==="in_progress"?"badge-yellow":"badge-gray"}function LE(t){return t==="approved"?"Zatwierdzony":t==="in_progress"?"W trakcie":t==="draft"?"Szkic":t}function ME(t){return t==null?"var(--text-muted)":t>=75?"var(--green)":t>=50?"var(--yellow)":t>=25?"var(--orange)":"var(--red)"}function Nv(){const t=on(),[r]=fc(),[a,s]=m.useState([]),[o,d]=m.useState([]),[u,h]=m.useState(!0),[f,p]=m.useState(!!r.get("framework_id")),[x,j]=m.useState([]),[y,S]=m.useState({framework_id:r.get("framework_id")??"",org_unit_id:"",title:"",assessor:"",implementation_group_filter:"",notes:""}),[w,b]=m.useState(!1);m.useEffect(()=>{Promise.all([le.get("/api/v1/assessments"),le.get("/api/v1/frameworks?is_active=true"),le.get("/api/v1/org-units/tree")]).then(([E,C,N])=>{s(E),d(C),j(N)}).catch(()=>{}).finally(()=>h(!1))},[]);const _=async()=>{if(y.framework_id){b(!0);try{const E={framework_id:Number(y.framework_id),org_unit_id:y.org_unit_id?Number(y.org_unit_id):null,title:y.title||null,assessor:y.assessor||null,implementation_group_filter:y.implementation_group_filter||null,notes:y.notes||null},C=await le.post("/api/v1/assessments",E);t(`/assessments/${C.id}`)}catch{alert("Blad tworzenia oceny")}finally{b(!1)}}};return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"toolbar-left",children:e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Oceny (Assessments)"})}),e.jsx("div",{className:"toolbar-right",children:e.jsx("button",{className:"btn btn-primary",onClick:()=>p(E=>!E),children:f?"Anuluj":"Nowa ocena"})})]}),f&&e.jsxs("div",{className:"card",style:{padding:16,marginBottom:12},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:10},children:"Nowa ocena"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Framework *"}),e.jsxs("select",{className:"form-control",value:y.framework_id,onChange:E=>S(C=>({...C,framework_id:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Wybierz --"}),o.map(E=>e.jsxs("option",{value:E.id,children:[E.name," ",E.version?`v${E.version}`:""]},E.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Jednostka org."}),e.jsx(jn,{tree:x,value:y.org_unit_id?Number(y.org_unit_id):null,onChange:E=>S(C=>({...C,org_unit_id:E?String(E):""})),placeholder:"Cala organizacja",allowClear:!0})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Tytul"}),e.jsx("input",{className:"form-control",value:y.title,onChange:E=>S(C=>({...C,title:E.target.value})),placeholder:"np. Ocena Q1 2026"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Oceniajacy"}),e.jsx("input",{className:"form-control",value:y.assessor,onChange:E=>S(C=>({...C,assessor:E.target.value})),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Filtr IG"}),e.jsxs("select",{className:"form-control",value:y.implementation_group_filter,onChange:E=>S(C=>({...C,implementation_group_filter:E.target.value})),children:[e.jsx("option",{value:"",children:"Wszystkie"}),e.jsx("option",{value:"IG1",children:"IG1"}),e.jsx("option",{value:"IG2",children:"IG2"}),e.jsx("option",{value:"IG3",children:"IG3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)",display:"block",marginBottom:2},children:"Notatki"}),e.jsx("input",{className:"form-control",value:y.notes,onChange:E=>S(C=>({...C,notes:E.target.value}))})]})]}),e.jsxs("div",{style:{marginTop:10,display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary",onClick:_,disabled:!y.framework_id||w,children:w?"Tworzenie...":"Utworz ocene"}),e.jsx("button",{className:"btn",onClick:()=>p(!1),children:"Anuluj"})]})]}),u?e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ladowanie..."}):a.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:'Brak ocen. Utworz nowa ocene klikajac "Nowa ocena".'}):e.jsx("div",{className:"card",style:{padding:0,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Jednostka"}),e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Wynik"}),e.jsx("th",{style:{textAlign:"right"},children:"Ukonczenie"})]})}),e.jsx("tbody",{children:a.map(E=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>t(`/assessments/${E.id}`),children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:E.id}),e.jsx("td",{style:{fontWeight:600},children:E.framework_name??""}),e.jsx("td",{children:E.org_unit_name??"Cala org."}),e.jsx("td",{children:E.assessment_date}),e.jsx("td",{children:e.jsx("span",{className:`badge ${DE(E.status)}`,children:LE(E.status)})}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:600,color:ME(E.overall_score)},children:E.overall_score!=null?`${E.overall_score.toFixed(1)}%`:""}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace"},children:E.completion_pct!=null?`${E.completion_pct.toFixed(0)}%`:""})]},E.id))})]})})]})}function IE(){const{assessmentId:t}=Ou(),r=on(),[a,s]=m.useState(null),[o,d]=m.useState([]),[u,h]=m.useState(null),[f,p]=m.useState(null),[x,j]=m.useState(!0),[y,S]=m.useState(!1),[w,b]=m.useState("answers");m.useEffect(()=>{t&&(j(!0),le.get(`/api/v1/assessments/${t}`).then(G=>(s(G),Promise.all([le.get(`/api/v1/assessments/${t}/answers`),le.get(`/api/v1/assessments/${t}/score`),le.get(`/api/v1/frameworks/${G.framework_id}`)]))).then(([G,M,U])=>{d(G),h(M),p(U)}).catch(()=>{}).finally(()=>j(!1)))},[t]);const _=m.useMemo(()=>{const G=new Map;for(const M of o)G.has(M.framework_node_id)||G.set(M.framework_node_id,{ref_id:M.node_ref_id,name:M.node_name,answers:[]}),G.get(M.framework_node_id).answers.push(M);return Array.from(G.entries())},[o]),E=m.useMemo(()=>{if(!f)return new Map;const G=new Map;for(const M of f.dimensions)G.set(M.id,M.levels.map(U=>({id:U.id,value:U.value,label:U.label_pl||U.label})));return G},[f]),C=async(G,M,U)=>{S(!0);try{const A=new URLSearchParams;M!=null&&A.set("level_id",String(M)),A.set("not_applicable",String(U));const R=await le.patch(`/api/v1/assessments/${t}/answers/${G}?${A.toString()}`,{});d(Z=>Z.map(F=>F.id===G?{...F,level_id:M,not_applicable:U}:F)),u&&h({...u,overall_score:R.overall_score,completion_pct:R.completion_pct}),a&&s({...a,overall_score:R.overall_score,completion_pct:R.completion_pct})}catch{}finally{S(!1)}},N=async()=>{if(!t||!confirm("Zatwierdzic ocene?"))return;const G=await le.post(`/api/v1/assessments/${t}/approve?approved_by=CISO`,{});s(G)};if(x)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ladowanie oceny..."});if(!a)return e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"Ocena nie znaleziona"});const O=a.completion_pct??0,Q=a.overall_score;return e.jsxs("div",{children:[e.jsxs("div",{className:"toolbar",children:[e.jsxs("div",{className:"toolbar-left",children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>r("/assessments"),style:{marginRight:8},children:" Wstecz"}),e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:a.title||a.ref_id||`Ocena #${a.id}`}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[a.framework_name," | ",a.assessment_date,a.org_unit_name&&` | ${a.org_unit_name}`,a.assessor&&` | ${a.assessor}`]})]})]}),e.jsxs("div",{className:"toolbar-right",style:{display:"flex",gap:16,alignItems:"center"},children:[y&&e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zapisywanie..."}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:"Ukonczenie"}),e.jsxs("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:O>=100?"var(--green)":"var(--yellow)"},children:[O.toFixed(0),"%"]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:"Wynik"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Q!=null?Q>=75?"var(--green)":Q>=50?"var(--yellow)":"var(--red)":"var(--text-muted)"},children:Q!=null?`${Q.toFixed(1)}%`:""})]}),a.status!=="approved"&&e.jsx("button",{className:"btn btn-primary",onClick:N,children:"Zatwierdz"}),a.status==="approved"&&e.jsx("span",{className:"badge badge-green",style:{fontSize:12,padding:"4px 12px"},children:"Zatwierdzony"})]})]}),e.jsx("div",{className:"card",style:{padding:"8px 12px",marginBottom:12},children:e.jsx("div",{className:"bar-track",style:{height:8},children:e.jsx("div",{className:"bar-fill",style:{width:`${O}%`,height:8,background:O>=100?"var(--green)":"var(--blue)"}})})}),e.jsxs("div",{style:{display:"flex",gap:4,marginBottom:12},children:[e.jsxs("button",{className:`btn btn-sm ${w==="answers"?"btn-primary":""}`,onClick:()=>b("answers"),children:["Formularz odpowiedzi (",o.length,")"]}),e.jsx("button",{className:`btn btn-sm ${w==="scores"?"btn-primary":""}`,onClick:()=>b("scores"),children:"Wyniki"})]}),w==="answers"&&e.jsx("div",{style:{display:"grid",gap:10},children:_.length===0?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Brak pytan do oceny."}):_.map(([G,M])=>e.jsxs("div",{className:"card",style:{padding:"10px 14px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[M.ref_id&&e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--blue)",fontWeight:600},children:M.ref_id}),e.jsx("span",{style:{fontWeight:600,fontSize:13},children:M.name})]}),M.answers.map(U=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"4px 0",borderTop:"1px solid rgba(42,53,84,0.08)",fontSize:12},children:[e.jsx("span",{style:{width:100,flexShrink:0,fontSize:10,color:"var(--text-muted)"},children:U.dimension_key}),e.jsxs("select",{className:"form-control",style:{flex:1,maxWidth:300},value:U.not_applicable?"NA":U.level_id??"",onChange:A=>{const R=A.target.value;R==="NA"?C(U.id,null,!0):R===""?C(U.id,null,!1):C(U.id,Number(R),!1)},disabled:a.status==="approved",children:[e.jsx("option",{value:"",children:"-- Wybierz --"}),(E.get(U.dimension_id)??[]).map(A=>e.jsxs("option",{value:A.id,children:[A.value,"  ",A.label]},A.id)),e.jsx("option",{value:"NA",children:"N/A (nie dotyczy)"})]}),U.level_label&&!U.not_applicable&&e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)"},children:U.level_label}),U.not_applicable&&e.jsx("span",{className:"badge badge-gray",style:{fontSize:9},children:"N/A"})]},U.id))]},G))}),w==="scores"&&u&&e.jsx(PE,{score:u,dimensions:f?.dimensions??[]})]})}function PE({score:t,dimensions:r}){return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:10,marginBottom:14},children:[e.jsx(Fo,{label:"Wynik ogolny",value:t.overall_score!=null?`${t.overall_score.toFixed(1)}%`:"",color:t.overall_score!=null&&t.overall_score>=75?"var(--green)":"var(--yellow)"}),e.jsx(Fo,{label:"Ukonczenie",value:`${(t.completion_pct??0).toFixed(0)}%`,color:"var(--blue)"}),e.jsx(Fo,{label:"Ocenialne",value:String(t.total_assessable),color:"var(--text-primary)"}),e.jsx(Fo,{label:"Odpowiedziane",value:String(t.answered_count),color:"var(--cyan)"}),e.jsx(Fo,{label:"N/A",value:String(t.na_count),color:"var(--text-muted)"})]}),Object.keys(t.dimension_averages).length>0&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:"Srednie wymiarow"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:8},children:Object.entries(t.dimension_averages).map(([a,s])=>{const o=r.find(d=>d.dimension_key===a);return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0"},children:[e.jsx("span",{style:{fontSize:12},children:o?.name_pl||o?.name||a}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontWeight:600,fontSize:13,color:s!=null&&s>=75?"var(--green)":s!=null&&s>=50?"var(--yellow)":"var(--red)"},children:s!=null?`${s.toFixed(1)}%`:""})]},a)})})]}),Object.keys(t.ig_scores).length>0&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:14},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:"Wyniki wg Implementation Groups"}),e.jsx("div",{style:{display:"flex",gap:16},children:Object.entries(t.ig_scores).map(([a,s])=>e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase"},children:a}),e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:s!=null&&s>=75?"var(--green)":"var(--yellow)"},children:s!=null?`${s.toFixed(1)}%`:""})]},a))})]}),t.node_scores.length>0&&e.jsx("div",{className:"card",style:{padding:0,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Kontrola"}),e.jsx("th",{style:{textAlign:"right"},children:"Wynik"}),r.map(a=>e.jsx("th",{style:{textAlign:"right",fontSize:10},children:a.dimension_key},a.id)),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.node_scores.map(a=>e.jsxs("tr",{style:{opacity:a.not_applicable?.5:1},children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--blue)"},children:a.ref_id}),e.jsx("td",{style:{fontSize:12},children:a.name}),e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontWeight:600},children:a.score!=null?`${a.score.toFixed(1)}%`:""}),r.map(s=>e.jsx("td",{style:{textAlign:"right",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:a.dimension_scores[s.dimension_key]!=null?`${a.dimension_scores[s.dimension_key].toFixed(0)}%`:""},s.id)),e.jsx("td",{children:a.not_applicable?e.jsx("span",{className:"badge badge-gray",style:{fontSize:9},children:"N/A"}):null})]},a.framework_node_id))})]})})]})}function Fo({label:t,value:r,color:a}){return e.jsxs("div",{className:"card",style:{padding:"10px 14px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em"},children:t}),e.jsx("div",{style:{fontSize:22,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a},children:r})]})}const Ro="";function qd(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("krytyczny")||r.includes("critical")?"var(--red)":r.includes("wysoki")||r.includes("high")?"var(--orange)":r.includes("redni")||r.includes("medium")||r.includes("sredni")?"var(--yellow)":r.includes("niski")||r.includes("low")?"var(--green)":"var(--text-muted)"}function Av(t){if(!t)return"transparent";const r=t.toLowerCase();return r.includes("krytyczny")||r.includes("critical")?"var(--red-dim)":r.includes("wysoki")||r.includes("high")?"var(--orange-dim)":r.includes("redni")||r.includes("medium")||r.includes("sredni")?"var(--yellow-dim)":r.includes("niski")||r.includes("low")?"var(--green-dim)":"transparent"}function WE(t){if(!t)return!1;const r=t.toLowerCase();return r.includes("krytyczny")||r.includes("critical")||r.includes("wysoki")||r.includes("high")}function _r({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function hs({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}const UE="1px solid var(--red)",$E="0 0 0 3px var(--red-dim)",gm=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytu",format:t=>t.title},{key:"severity_name",header:"Wano",format:t=>t.severity_name??""},{key:"cvss_score",header:"CVSS",format:t=>t.cvss_score??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"cve_id",header:"CVE",format:t=>t.cve_id??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"owner",header:"Waciciel",format:t=>t.owner??""},{key:"detected_at",header:"Wykryto",format:t=>t.detected_at?.slice(0,10)??""},{key:"sla_deadline",header:"SLA",format:t=>t.sla_deadline?.slice(0,10)??""},{key:"source_name",header:"rdo",format:t=>t.source_name??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo",format:t=>t.asset_name??"",defaultVisible:!1},{key:"category_name",header:"Kategoria",format:t=>t.category_name??"",defaultVisible:!1},{key:"remediation_priority_name",header:"Priorytet naprawy",format:t=>t.remediation_priority_name??"",defaultVisible:!1},{key:"cvss_vector",header:"Wektor CVSS",format:t=>t.cvss_vector??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:t=>t.closed_at?.slice(0,10)??"",defaultVisible:!1},{key:"created_by",header:"Utworzy",format:t=>t.created_by??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1}];function HE(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[C,N]=m.useState([]),[O,Q]=m.useState([]),[G,M]=m.useState([]),[U,A]=m.useState([]),{visible:R,toggle:Z}=da(gm,"vulns"),[F,q]=m.useState(!1),ee=Aa({data:t,storageKey:"vulns",defaultSort:"detected_at",defaultSortDir:"desc"}),[me,W]=m.useState({title:"",description:"",source_id:null,org_unit_id:null,category_id:null,severity_id:null,cvss_score:null,cve_id:"",status_id:null,remediation_priority_id:null,owner:"",detected_at:new Date().toISOString().slice(0,10),sla_deadline:"",created_by:""}),J=()=>{W({title:"",description:"",source_id:null,org_unit_id:null,category_id:null,severity_id:null,cvss_score:null,cve_id:"",status_id:null,remediation_priority_id:null,owner:"",detected_at:new Date().toISOString().slice(0,10),sla_deadline:"",created_by:""}),S(!1)};m.useEffect(()=>{L()},[]);async function L(){s(!0),d(null);try{const[k,I]=await Promise.all([fetch(`${Ro}/api/v1/vulnerabilities`),fetch(`${Ro}/api/v1/org-units/tree`)]);k.ok?r(await k.json()):d(`API ${k.status}`),I.ok&&b(await I.json());for(const[D,de]of[["severity_universal",E],["vuln_status",N],["vuln_source",Q],["vuln_category",M],["remediation_priority",A]]){const he=await fetch(`${Ro}/api/v1/dictionaries/by-code/${D}`);if(he.ok){const ie=await he.json();de(ie.entries??[])}}}catch(k){d(String(k))}s(!1)}async function H(){if(S(!0),!(!me.title||!me.org_unit_id||!me.owner||!me.detected_at)){j(!0);try{const k={...me,cvss_score:me.cvss_score||null,cve_id:me.cve_id||null,sla_deadline:me.sla_deadline||null,created_by:me.created_by||null},I=await fetch(`${Ro}/api/v1/vulnerabilities`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)});I.ok?(h(!1),J(),L()):alert("Blad zapisu: "+await I.text())}catch(k){alert("Blad: "+k)}j(!1)}}async function ne(k){confirm("Archiwizowac podatnosc?")&&(await fetch(`${Ro}/api/v1/vulnerabilities/${k}`,{method:"DELETE"}),f?.id===k&&p(null),L())}const P=m.useMemo(()=>{const k=de=>de.filter(he=>WE(he.severity_name)).length,I=de=>de.filter(he=>!he.closed_at).length,D=de=>{const he=de.filter(ie=>ie.cvss_score!=null);return he.length===0?"":(he.reduce((ie,ve)=>ie+(ve.cvss_score??0),0)/he.length).toFixed(1)};return[{label:"Podatnoci",value:ee.filteredCount,total:ee.totalCount,color:"var(--blue)"},{label:"Krytycznych / Wysokich",value:k(ee.filtered),total:k(t),color:k(ee.filtered)>0?"var(--red)":"var(--green)"},{label:"Otwartych",value:I(ee.filtered),total:I(t),color:I(ee.filtered)>0?"var(--orange)":"var(--green)"},{label:"redni CVSS",value:D(ee.filtered),total:D(t),color:"var(--purple)"}]},[t,ee.filtered,ee.filteredCount,ee.totalCount]),T=k=>y&&!k?{border:UE,boxShadow:$E}:{},z=ee.filteredCount!==ee.totalCount;return e.jsxs("div",{children:[e.jsx(Ia,{cards:P,isFiltered:z}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"podatnosci",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj (tytul, CVE, ref)...",showFilters:F,onToggleFilters:()=>q(k=>!k),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:gm,visibleColumns:R,onToggleColumn:Z,data:ee.filtered,exportFilename:"podatnosci",primaryLabel:"Nowa podatnosc",onPrimaryAction:()=>{J(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:gm,visibleColumns:R,data:ee.pageData,rowKey:k=>k.id,selectedKey:f?.id??null,onRowClick:k=>p(f?.id===k.id?null:k),rowBorderColor:k=>qd(k.severity_name),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,showFilters:F,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,loading:a,emptyMessage:"Brak podatnosci w systemie.",emptyFilteredMessage:"Brak podatnosci pasujacych do filtrow.",renderCell:(k,I)=>{if(I==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:k.ref_id});if(I==="title")return e.jsx("span",{style:{fontWeight:500},children:k.title});if(I==="severity_name")return k.severity_name?e.jsx("span",{className:"score-badge",style:{background:Av(k.severity_name),color:qd(k.severity_name)},children:k.severity_name}):"";if(I==="cvss_score")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:k.cvss_score!=null?k.cvss_score.toFixed(1):""});if(I==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:k.status_name??""});if(I==="cve_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:k.cve_id??""});if(I==="sla_deadline"){const D=k.sla_deadline&&new Date(k.sla_deadline)<new Date;return e.jsxs("span",{style:{fontSize:12,color:D?"var(--red)":void 0,fontWeight:D?600:void 0},children:[k.sla_deadline?.slice(0,10)??"",D?" !":""]})}}}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Podatnosci"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.severity_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("span",{className:"score-badge",style:{background:Av(f.severity_name),color:qd(f.severity_name),fontSize:14,padding:"6px 16px"},children:f.severity_name}),f.cvss_score!=null&&e.jsxs("div",{style:{marginTop:4,fontSize:20,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:qd(f.severity_name)},children:["CVSS ",f.cvss_score.toFixed(1)]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(hs,{number:"",label:"Dane podatnosci"}),e.jsx(_r,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(_r,{label:"Tytul",value:e.jsx("strong",{children:f.title})}),e.jsx(_r,{label:"CVE",value:f.cve_id}),e.jsx(_r,{label:"Kategoria",value:f.category_name}),e.jsx(_r,{label:"Zrodlo",value:f.source_name}),e.jsx(hs,{number:"",label:"Przypisanie"}),e.jsx(_r,{label:"Jednostka",value:f.org_unit_name}),e.jsx(_r,{label:"Wlasciciel",value:f.owner}),e.jsx(_r,{label:"Priorytet",value:f.remediation_priority_name}),e.jsx(hs,{number:"",label:"Status i daty"}),e.jsx(_r,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(_r,{label:"Wykryto",value:f.detected_at}),e.jsx(_r,{label:"SLA",value:f.sla_deadline,color:f.sla_deadline&&new Date(f.sla_deadline)<new Date?"var(--red)":void 0}),f.description&&e.jsxs(e.Fragment,{children:[e.jsx(hs,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:f.description})]})]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{ne(f.id),p(null)},children:"Archiwizuj"})})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowa podatnosc",wide:!0,children:[e.jsx(hs,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:T(!!me.title),value:me.title,onChange:k=>W({...me,title:k.target.value}),placeholder:"Nazwa podatnosci"}),y&&!me.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org. *"}),e.jsx(jn,{tree:w,value:me.org_unit_id,onChange:k=>W({...me,org_unit_id:k}),placeholder:"-- wybierz --",allowClear:!1,style:T(!!me.org_unit_id)}),y&&!me.org_unit_id&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel remediacji *"}),e.jsx("input",{className:"form-control",style:T(!!me.owner),value:me.owner,onChange:k=>W({...me,owner:k.target.value})}),y&&!me.owner&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data wykrycia *"}),e.jsx("input",{className:"form-control",type:"date",style:T(!!me.detected_at),value:me.detected_at,onChange:k=>W({...me,detected_at:k.target.value})}),y&&!me.detected_at&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]})]}),e.jsx(hs,{number:"",label:"Klasyfikacja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zrodlo"}),e.jsxs("select",{className:"form-control",value:me.source_id??"",onChange:k=>W({...me,source_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:me.category_id??"",onChange:k=>W({...me,category_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),G.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waznosc"}),e.jsxs("select",{className:"form-control",value:me.severity_id??"",onChange:k=>W({...me,severity_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),_.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"CVSS"}),e.jsx("input",{className:"form-control",type:"number",step:"0.1",min:"0",max:"10",value:me.cvss_score??"",onChange:k=>W({...me,cvss_score:k.target.value?Number(k.target.value):null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"CVE ID"}),e.jsx("input",{className:"form-control",value:me.cve_id,onChange:k=>W({...me,cve_id:k.target.value}),placeholder:"CVE-20XX-XXXXX"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:me.status_id??"",onChange:k=>W({...me,status_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),C.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Priorytet"}),e.jsxs("select",{className:"form-control",value:me.remediation_priority_id??"",onChange:k=>W({...me,remediation_priority_id:k.target.value?Number(k.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),U.map(k=>e.jsx("option",{value:k.id,children:k.label},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Termin SLA"}),e.jsx("input",{className:"form-control",type:"date",value:me.sla_deadline,onChange:k=>W({...me,sla_deadline:k.target.value})})]})]}),e.jsx(hs,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:me.description,onChange:k=>W({...me,description:k.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:H,children:x?"Zapisywanie...":"Zapisz podatnosc"})]})]})]})}const Bo="";function xm(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("krytyczny")||r.includes("critical")?"var(--red)":r.includes("wysoki")||r.includes("high")?"var(--orange)":r.includes("redni")||r.includes("medium")||r.includes("sredni")?"var(--yellow)":r.includes("niski")||r.includes("low")?"var(--green)":"var(--text-muted)"}function Ev(t){if(!t)return"transparent";const r=t.toLowerCase();return r.includes("krytyczny")||r.includes("critical")?"var(--red-dim)":r.includes("wysoki")||r.includes("high")?"var(--orange-dim)":r.includes("redni")||r.includes("medium")||r.includes("sredni")?"var(--yellow-dim)":r.includes("niski")||r.includes("low")?"var(--green-dim)":"transparent"}function $o(t){return t===null?"":t<60?`${t}m`:t<1440?`${Math.round(t/60)}h`:`${Math.round(t/1440)}d`}function Pi({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}function Tn({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}const VE="1px solid var(--red)",ZE="0 0 0 3px var(--red-dim)",ym=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytu",format:t=>t.title},{key:"category_name",header:"Kategoria",format:t=>t.category_name??""},{key:"severity_name",header:"Wano",format:t=>t.severity_name??""},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"assigned_to",header:"Przypisany",format:t=>t.assigned_to??""},{key:"reported_at",header:"Zgoszono",format:t=>t.reported_at?.slice(0,16).replace("T"," ")??""},{key:"ttr_minutes",header:"TTR",format:t=>$o(t.ttr_minutes)},{key:"personal_data_breach",header:"RODO",format:t=>t.personal_data_breach?"TAK":"NIE"},{key:"asset_name",header:"Aktywo",format:t=>t.asset_name??"",defaultVisible:!1},{key:"reported_by",header:"Zgosi",format:t=>t.reported_by??"",defaultVisible:!1},{key:"impact_name",header:"Wpyw",format:t=>t.impact_name??"",defaultVisible:!1},{key:"detected_at",header:"Wykryto",format:t=>t.detected_at?.slice(0,16).replace("T"," ")??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:t=>t.closed_at?.slice(0,16).replace("T"," ")??"",defaultVisible:!1},{key:"authority_notification",header:"Powiad. organ",format:t=>t.authority_notification?"TAK":"NIE",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:t=>t.created_at?.slice(0,10)??"",defaultVisible:!1}];function GE(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[C,N]=m.useState([]),[O,Q]=m.useState([]),[G,M]=m.useState([]),{visible:U,toggle:A}=da(ym,"incidents"),[R,Z]=m.useState(!1),F=Aa({data:t,storageKey:"incidents",defaultSort:"reported_at",defaultSortDir:"desc"}),[q,ee]=m.useState({title:"",description:"",category_id:null,severity_id:null,org_unit_id:null,reported_by:"",assigned_to:"",status_id:null,reported_at:new Date().toISOString().slice(0,16),impact_id:null,personal_data_breach:!1,authority_notification:!1}),me=()=>{ee({title:"",description:"",category_id:null,severity_id:null,org_unit_id:null,reported_by:"",assigned_to:"",status_id:null,reported_at:new Date().toISOString().slice(0,16),impact_id:null,personal_data_breach:!1,authority_notification:!1}),S(!1)};m.useEffect(()=>{W()},[]);async function W(){s(!0),d(null);try{const[T,z]=await Promise.all([fetch(`${Bo}/api/v1/incidents`),fetch(`${Bo}/api/v1/org-units/tree`)]);T.ok?r(await T.json()):d(`API ${T.status}`),z.ok&&b(await z.json());for(const[k,I]of[["severity_universal",E],["incident_status",N],["incident_category",Q],["incident_impact",M]]){const D=await fetch(`${Bo}/api/v1/dictionaries/by-code/${k}`);if(D.ok){const de=await D.json();I(de.entries??[])}}}catch(T){d(String(T))}s(!1)}async function J(){if(S(!0),!(!q.title||!q.org_unit_id||!q.reported_by||!q.assigned_to||!q.description||!q.reported_at)){j(!0);try{const T={...q,reported_at:new Date(q.reported_at).toISOString()},z=await fetch(`${Bo}/api/v1/incidents`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});z.ok?(h(!1),me(),W()):alert("Blad zapisu: "+await z.text())}catch(T){alert("Blad: "+T)}j(!1)}}async function L(T){confirm("Archiwizowac incydent?")&&(await fetch(`${Bo}/api/v1/incidents/${T}`,{method:"DELETE"}),f?.id===T&&p(null),W())}const H=m.useMemo(()=>{const T=t.length,z=t.filter(_e=>{const Se=(_e.severity_name??"").toLowerCase();return Se.includes("krytyczny")||Se.includes("critical")||Se.includes("wysoki")||Se.includes("high")}).length,k=t.filter(_e=>_e.personal_data_breach).length,I=t.filter(_e=>_e.ttr_minutes!=null),D=I.length>0?$o(Math.round(I.reduce((_e,Se)=>_e+(Se.ttr_minutes??0),0)/I.length)):"",de=F.filtered,he=de.length,ie=de.filter(_e=>{const Se=(_e.severity_name??"").toLowerCase();return Se.includes("krytyczny")||Se.includes("critical")||Se.includes("wysoki")||Se.includes("high")}).length,ve=de.filter(_e=>_e.personal_data_breach).length,je=de.filter(_e=>_e.ttr_minutes!=null),fe=je.length>0?$o(Math.round(je.reduce((_e,Se)=>_e+(Se.ttr_minutes??0),0)/je.length)):"";return[{label:"Aktywnych incydentw",value:he,total:T,color:"var(--blue)"},{label:"Krytycznych / Wysokich",value:ie,total:z,color:z>0?"var(--red)":"var(--green)"},{label:"Narusze RODO",value:ve,total:k,color:k>0?"var(--red)":"var(--green)"},{label:"redni TTR",value:fe,total:D,color:"var(--purple)"}]},[t,F.filtered]),ne=T=>y&&!T?{border:VE,boxShadow:ZE}:{},P=(T,z)=>{if(z==="severity_name")return T.severity_name?e.jsx("span",{className:"score-badge",style:{background:Ev(T.severity_name),color:xm(T.severity_name)},children:T.severity_name}):"";if(z==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:T.status_name??""});if(z==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:T.ref_id});if(z==="title")return e.jsx("span",{style:{fontWeight:500},children:T.title});if(z==="ttr_minutes")return e.jsx("span",{style:{fontSize:12,fontFamily:"'JetBrains Mono',monospace"},children:$o(T.ttr_minutes)});if(z==="personal_data_breach")return T.personal_data_breach?e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"TAK"}):""};return e.jsxs("div",{children:[e.jsx(Ia,{cards:H,isFiltered:F.hasActiveFilters||!!F.search}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:F.filteredCount,totalCount:F.totalCount,unitLabel:"incydentw",search:F.search,onSearchChange:F.setSearch,searchPlaceholder:"Szukaj (tytu, ref, osoba)...",showFilters:R,onToggleFilters:()=>Z(T=>!T),hasActiveFilters:F.hasActiveFilters,onClearFilters:F.clearAllFilters,columns:ym,visibleColumns:U,onToggleColumn:A,data:F.filtered,exportFilename:"incydenty",primaryLabel:"Nowy incydent",onPrimaryAction:()=>{me(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:ym,visibleColumns:U,data:F.pageData,renderCell:P,onRowClick:T=>p(f?.id===T.id?null:T),rowKey:T=>T.id,selectedKey:f?.id??null,rowBorderColor:T=>T.severity_name?xm(T.severity_name):void 0,sortField:F.sortField,sortDir:F.sortDir,onSort:F.toggleSort,columnFilters:F.columnFilters,onColumnFilter:F.setColumnFilter,showFilters:R,page:F.page,totalPages:F.totalPages,pageSize:F.pageSize,totalItems:F.totalCount,filteredItems:F.filteredCount,onPageChange:F.setPage,onPageSizeChange:F.setPageSize,loading:a,emptyMessage:"Brak incydentw w systemie.",emptyFilteredMessage:"Brak incydentw pasujcych do filtrw."}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Incydentu"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.severity_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Waznosc"}),e.jsx("span",{className:"score-badge",style:{background:Ev(f.severity_name),color:xm(f.severity_name),fontSize:14,padding:"6px 16px"},children:f.severity_name})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Pi,{number:"",label:"Dane incydentu"}),e.jsx(Tn,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(Tn,{label:"Tytul",value:e.jsx("strong",{children:f.title})}),e.jsx(Tn,{label:"Kategoria",value:f.category_name}),e.jsx(Tn,{label:"Jednostka",value:f.org_unit_name}),e.jsx(Tn,{label:"Zglaszajacy",value:f.reported_by}),e.jsx(Tn,{label:"Przypisany",value:f.assigned_to}),e.jsx(Pi,{number:"",label:"Status i wplyw"}),e.jsx(Tn,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(Tn,{label:"Wplyw",value:f.impact_name}),e.jsx(Tn,{label:"TTR",value:$o(f.ttr_minutes)}),e.jsx(Tn,{label:"RODO",value:f.personal_data_breach?e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"TAK"}):"NIE"}),e.jsx(Tn,{label:"UODO/CERT",value:f.authority_notification?e.jsx("span",{style:{color:"var(--orange)",fontWeight:600},children:"TAK"}):"NIE"}),e.jsx(Pi,{number:"",label:"Daty"}),e.jsx(Tn,{label:"Zgloszono",value:f.reported_at?.slice(0,16).replace("T"," ")}),f.detected_at&&e.jsx(Tn,{label:"Wykryto",value:f.detected_at.slice(0,16).replace("T"," ")}),f.closed_at&&e.jsx(Tn,{label:"Zamknieto",value:f.closed_at.slice(0,16).replace("T"," ")}),f.description&&e.jsxs(e.Fragment,{children:[e.jsx(Pi,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:f.description})]})]}),e.jsx("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:()=>{L(f.id),p(null)},children:"Archiwizuj"})})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy incydent bezpieczenstwa",wide:!0,children:[e.jsx(Pi,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul incydentu *"}),e.jsx("input",{className:"form-control",style:ne(!!q.title),value:q.title,onChange:T=>ee({...q,title:T.target.value}),placeholder:"Krotki opis incydentu"}),y&&!q.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:w,value:q.org_unit_id,onChange:T=>ee({...q,org_unit_id:T}),placeholder:"Wybierz...",allowClear:!1,style:ne(!!q.org_unit_id)}),y&&!q.org_unit_id&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:q.category_id??"",onChange:T=>ee({...q,category_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),O.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zglaszajacy *"}),e.jsx("input",{className:"form-control",style:ne(!!q.reported_by),value:q.reported_by,onChange:T=>ee({...q,reported_by:T.target.value}),placeholder:"Imie i nazwisko"}),y&&!q.reported_by&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Przypisany do *"}),e.jsx("input",{className:"form-control",style:ne(!!q.assigned_to),value:q.assigned_to,onChange:T=>ee({...q,assigned_to:T.target.value}),placeholder:"Imie i nazwisko"}),y&&!q.assigned_to&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]})]}),e.jsx(Pi,{number:"",label:"Klasyfikacja"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Waznosc"}),e.jsxs("select",{className:"form-control",value:q.severity_id??"",onChange:T=>ee({...q,severity_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),_.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:q.status_id??"",onChange:T=>ee({...q,status_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),C.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wplyw"}),e.jsxs("select",{className:"form-control",value:q.impact_id??"",onChange:T=>ee({...q,impact_id:T.target.value?Number(T.target.value):null}),children:[e.jsx("option",{value:"",children:"Brak"}),G.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))]})]})]}),e.jsx(Pi,{number:"",label:"Data i RODO"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data zgloszenia *"}),e.jsx("input",{className:"form-control",type:"datetime-local",style:ne(!!q.reported_at),value:q.reported_at,onChange:T=>ee({...q,reported_at:T.target.value})}),y&&!q.reported_at&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",style:{display:"flex",gap:20,alignItems:"flex-end",paddingBottom:16},children:[e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:q.personal_data_breach,onChange:T=>ee({...q,personal_data_breach:T.target.checked}),style:{width:16,height:16,accentColor:"var(--red)"}}),e.jsx("span",{style:{fontSize:12,color:q.personal_data_breach?"var(--red)":"var(--text-secondary)",fontWeight:q.personal_data_breach?600:400},children:"RODO"})]}),e.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:q.authority_notification,onChange:T=>ee({...q,authority_notification:T.target.checked}),style:{width:16,height:16,accentColor:"var(--orange)"}}),e.jsx("span",{style:{fontSize:12,color:q.authority_notification?"var(--orange)":"var(--text-secondary)",fontWeight:q.authority_notification?600:400},children:"Zgloszenie UODO/CERT"})]})]})]}),e.jsx(Pi,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis incydentu *"}),e.jsx("textarea",{className:"form-control",rows:3,style:ne(!!q.description),value:q.description,onChange:T=>ee({...q,description:T.target.value}),placeholder:"Szczegolowy opis incydentu, okolicznosci, przebieg..."}),y&&!q.description&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:J,children:x?"Zapisywanie...":"Zapisz incydent"})]})]})]})}function ti(t){return t>=221?"var(--red)":t>=31?"var(--orange)":"var(--green)"}function Yo(t){return t>=221?"var(--red-dim)":t>=31?"var(--orange-dim)":"var(--green-dim)"}function Fu(t){return t>=221?"Wysokie":t>=31?"Srednie":"Niskie"}function Un({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}function Sa({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}const Fv="1px solid var(--red)",Rv="0 0 0 3px var(--red-dim)";function KE(){const t=[{key:"ref_id",header:"Ref",format:L=>L.ref_id??""},{key:"title",header:"Tytu"},{key:"policy_title",header:"Polityka",format:L=>L.policy_title??""},{key:"org_unit_name",header:"Pion",format:L=>L.org_unit_name??""},{key:"risk_score",header:"Ryzyko odst.",format:L=>L.risk_score!=null?Number(L.risk_score).toFixed(1):""},{key:"status_name",header:"Status",format:L=>L.status_name??""},{key:"expiry_date",header:"Wygasa"},{key:"category_name",header:"Kategoria",format:L=>L.category_name??"",defaultVisible:!1},{key:"asset_name",header:"Aktywo",format:L=>L.asset_name??"",defaultVisible:!1},{key:"requested_by",header:"Wnioskujcy",format:L=>L.requested_by??"",defaultVisible:!1},{key:"approved_by",header:"Zatwierdzajcy",format:L=>L.approved_by??"",defaultVisible:!1},{key:"risk_level_name",header:"Poziom ryzyka",format:L=>L.risk_level_name??"",defaultVisible:!1},{key:"compensating_controls",header:"Kontrole kompensujce",format:L=>L.compensating_controls??"",defaultVisible:!1},{key:"start_date",header:"Data rozpoczcia",format:L=>L.start_date??"",defaultVisible:!1},{key:"review_date",header:"Data przegldu",format:L=>L.review_date??"",defaultVisible:!1},{key:"closed_at",header:"Zamknito",format:L=>L.closed_at??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:L=>L.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"exceptions"),[s,o]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState(!1),[p,x]=m.useState(!1),[j,y]=m.useState(null),[S,w]=m.useState(null),[b,_]=m.useState(null),[E,C]=m.useState([]),[N,O]=m.useState(!1),Q=Aa({data:s,storageKey:"exceptions",defaultSort:"expiry_date",defaultSortDir:"asc"}),G=()=>{le.get("/api/v1/exceptions").then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(()=>{G(),le.get("/api/v1/org-units/tree").then(C).catch(()=>{})},[]);const M=m.useMemo(()=>Cl(E),[E]),U=async()=>{if(j)return j;const[L,H,ne,P,T,z]=await Promise.all([le.get("/api/v1/org-units/tree").catch(()=>[]),le.get("/api/v1/policies").catch(()=>[]),le.get("/api/v1/domains").catch(()=>[]),le.get("/api/v1/threat-catalog").catch(()=>[]),le.get("/api/v1/weakness-catalog").catch(()=>[]),le.get("/api/v1/assets").catch(()=>[])]),k=H.map(fe=>({id:fe.id,title:fe.title})),I=async fe=>{try{return(await le.get(`/api/v1/dictionaries/${fe}/entries`)).entries.filter(Se=>Se.is_active).map(Se=>({id:Se.id,label:Se.label}))}catch{return[]}},[D,de,he,ie]=await Promise.all([I("exception_category"),I("exception_status"),I("risk_level"),I("risk_strategy")]),ve=z.map(fe=>({id:fe.id,name:fe.name,org_unit_id:fe.org_unit_id,org_unit_name:fe.org_unit_name})),je={orgUnits:L,policies:k,categories:D,statuses:de,riskLevels:he,areas:ne,threats:P,vulns:T,strategies:ie,assets:ve};return y(je),je},A=async()=>{await U(),_(null),f(!0)},R=async L=>{await U(),_(L),f(!0)},Z=new Date,F=L=>{if(!L)return!1;const H=(new Date(L).getTime()-Z.getTime())/864e5;return H>=0&&H<=30},q=L=>L?new Date(L)<Z:!1,ee=j?F1(j.orgUnits):[],me=j?.orgUnits??[],W=Q.filteredCount!==Q.totalCount,J=m.useMemo(()=>{const L=Q.filtered,H=s.filter(I=>I.is_active).length,ne=L.filter(I=>I.is_active).length,P=L.filter(I=>F(I.expiry_date)).length,T=s.filter(I=>F(I.expiry_date)).length,z=L.length>0?L.reduce((I,D)=>I+(D.risk_score??0),0)/L.length:0,k=s.length>0?s.reduce((I,D)=>I+(D.risk_score??0),0)/s.length:0;return[{label:"Wszystkich wyjtkw",value:L.length,total:s.length,color:"var(--blue)"},{label:"Aktywnych",value:ne,total:H,color:"var(--green)"},{label:"Wygasajcych",value:P,total:T,color:"var(--orange)"},{label:"r. ryzyko odst.",value:z.toFixed(1),total:k.toFixed(1),color:"var(--red)"}]},[Q.filtered,s]);return e.jsxs("div",{children:[e.jsx(Ia,{cards:J,isFiltered:W}),e.jsx(ma,{filteredCount:Q.filteredCount,totalCount:Q.totalCount,unitLabel:"wyjtkw",search:Q.search,onSearchChange:Q.setSearch,searchPlaceholder:"Szukaj wyjtkw...",showFilters:N,onToggleFilters:()=>O(L=>!L),hasActiveFilters:Q.hasActiveFilters,onClearFilters:Q.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:Q.filtered,exportFilename:"wyjatki",primaryLabel:"Nowy wyjtek",onPrimaryAction:A}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:S?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:Q.pageData,rowKey:L=>L.id,selectedKey:S?.id??null,onRowClick:L=>w(S?.id===L.id?null:L),rowBorderColor:L=>L.risk_score!=null?ti(L.risk_score):void 0,sortField:Q.sortField,sortDir:Q.sortDir,onSort:Q.toggleSort,columnFilters:Q.columnFilters,onColumnFilter:Q.setColumnFilter,showFilters:N,page:Q.page,totalPages:Q.totalPages,pageSize:Q.pageSize,totalItems:Q.totalCount,filteredItems:Q.filteredCount,onPageChange:Q.setPage,onPageSizeChange:Q.setPageSize,loading:d,emptyMessage:"Brak wyjatkow w systemie.",emptyFilteredMessage:"Brak wyjatkow pasujcych do filtrw.",renderCell:(L,H)=>{if(H==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:L.ref_id});if(H==="title")return e.jsx("span",{style:{fontWeight:500},children:L.title});if(H==="policy_title")return e.jsx("span",{style:{fontSize:11},children:L.policy_title??""});if(H==="org_unit_name")return e.jsx("span",{style:{fontSize:11},children:M.get(L.org_unit_id)??L.org_unit_name});if(H==="risk_score")return L.risk_score!=null?e.jsxs("span",{className:"score-badge",style:{background:Yo(Number(L.risk_score)),color:ti(Number(L.risk_score))},children:[Number(L.risk_score).toFixed(1)," ",Fu(Number(L.risk_score))]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:L.risk_level_name??""});if(H==="status_name")return e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:L.status_name??""});if(H==="expiry_date")return e.jsxs("span",{style:{color:q(L.expiry_date)?"var(--red)":F(L.expiry_date)?"var(--orange)":void 0,fontWeight:q(L.expiry_date)||F(L.expiry_date)?600:void 0,fontSize:12},children:[L.expiry_date,q(L.expiry_date)&&" (WYGASLY)",F(L.expiry_date)&&" (reocena)"]})}}),S&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Wyjatku"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>R(S),title:"Edytuj",children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>w(null),children:""})]})]}),S.risk_score!=null&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Ryzyko odstepstwa"}),e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:ti(Number(S.risk_score))},children:Number(S.risk_score).toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:Yo(Number(S.risk_score)),color:ti(Number(S.risk_score)),fontSize:13,padding:"4px 12px"},children:Fu(Number(S.risk_score))}),S.risk_id&&e.jsx("div",{style:{marginTop:6},children:e.jsx("a",{href:`/risks?highlight=${S.risk_id}`,style:{fontSize:11,color:"var(--blue)",textDecoration:"none"},children:"Przejdz do ryzyka w rejestrze "})})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Un,{number:"",label:"Dane wyjatku"}),e.jsx(Sa,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:S.ref_id})}),e.jsx(Sa,{label:"Tytul",value:e.jsx("strong",{children:S.title})}),e.jsx(Sa,{label:"Polityka",value:S.policy_title}),e.jsx(Sa,{label:"Pion",value:M.get(S.org_unit_id)??S.org_unit_name}),e.jsx(Sa,{label:"Kategoria",value:S.category_name}),S.asset_name&&e.jsx(Sa,{label:"Powiazany aktyw",value:e.jsx("span",{style:{color:"var(--purple)",fontWeight:500},children:S.asset_name})}),e.jsx(Sa,{label:"Wnioskujacy",value:S.requested_by}),e.jsx(Sa,{label:"Zatwierdzajacy",value:S.approved_by}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),S.description&&e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginBottom:8},children:S.description}),S.compensating_controls&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:2,fontSize:11},children:"Srodki kompensacyjne"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8},children:S.compensating_controls})]}),e.jsx(Un,{number:"",label:"Daty i status"}),e.jsx(Sa,{label:"Status",value:S.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:S.status_name}):""}),e.jsx(Sa,{label:"Poczatek",value:S.start_date}),e.jsx(Sa,{label:"Wygasniecie",value:e.jsxs("span",{style:{color:q(S.expiry_date)?"var(--red)":F(S.expiry_date)?"var(--orange)":void 0,fontWeight:q(S.expiry_date)?600:void 0},children:[S.expiry_date,q(S.expiry_date)&&" (WYGASLY!)",F(S.expiry_date)&&" (reocena)"]})}),e.jsx(Sa,{label:"Data przegladu",value:S.review_date}),S.closed_at&&e.jsx(Sa,{label:"Zamknieto",value:S.closed_at})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:16,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-sm",style:{flex:1},onClick:()=>R(S),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{flex:1,color:"var(--red)"},onClick:async()=>{confirm(`Archiwizowac wyjatek ${S.ref_id}?`)&&(await le.delete(`/api/v1/exceptions/${S.id}`),w(null),u(!0),G())},children:"Archiwizuj"})]})]})]}),e.jsx(gt,{open:h,onClose:()=>{f(!1),_(null)},title:b?`Edycja wyjatku ${b.ref_id??""}`:"Nowy wyjatek od polityki",wide:!0,children:j?e.jsx(qE,{lookups:j,flatUnits:ee,orgTree:me,saving:p,editingException:b,onSubmit:async L=>{x(!0);try{b?await le.put(`/api/v1/exceptions/${b.id}`,L):await le.post("/api/v1/exceptions/with-risk",L),f(!1),_(null),w(null),u(!0),G()}catch(H){alert("Blad zapisu: "+H)}finally{x(!1)}},onCancel:()=>{f(!1),_(null)}}):e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych formularza..."})})]})}const Qm=[{value:.1,label:"Brak zabezpieczen",color:"var(--red)"},{value:.25,label:"Czesciowe",color:"var(--orange)"},{value:.7,label:"Dobra jakosc",color:"var(--blue)"},{value:.95,label:"Skuteczne, testowane",color:"var(--green)"}];function Bv({value:t,onChange:r,readonly:a}){return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",textAlign:"center",marginBottom:2},children:"Ocena zabezpieczen (Z)"}),Qm.map(s=>{const o=Math.abs(t-s.value)<.01;return e.jsxs("div",{style:{padding:"6px 10px",borderRadius:6,fontSize:11,cursor:a?"default":"pointer",display:"flex",alignItems:"center",gap:8,background:o?`${s.color}18`:"transparent",border:o?`2px solid ${s.color}`:"2px solid var(--border)",color:o?s.color:"var(--text-muted)",fontWeight:o?600:400,transition:"all 0.15s"},onClick:()=>!a&&r?.(s.value),children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:o?s.color:"var(--border)",flexShrink:0}}),e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",minWidth:30},children:s.value.toFixed(2)}),e.jsx("span",{children:s.label})]},s.value)})]})}function qE({lookups:t,flatUnits:r,orgTree:a,saving:s,editingException:o,onSubmit:d,onCancel:u}){const h=!!o,[f,p]=m.useState(1),[x,j]=m.useState(!1),[y,S]=m.useState("basic"),[w,b]=m.useState(null),[_,E]=m.useState(!1),[C,N]=m.useState(!1),[O,Q]=m.useState(!1),[G,M]=m.useState(""),[U,A]=m.useState(o?.title??""),[R,Z]=m.useState(o?.description??""),[F,q]=m.useState(o?.policy_id??null),[ee,me]=m.useState(o?.category_id??null),[W,J]=m.useState(o?.org_unit_id??null),[L,H]=m.useState(o?.asset_id??null),[ne,P]=m.useState(o?.requested_by??""),[T,z]=m.useState(o?.approved_by??""),[k,I]=m.useState(o?.compensating_controls??""),[D,de]=m.useState(o?.status_id??null),[he,ie]=m.useState(o?.start_date??new Date().toISOString().slice(0,10)),[ve,je]=m.useState(o?.expiry_date??""),[fe,_e]=m.useState(""),[Se,Ve]=m.useState(null),[be,oe]=m.useState(null),[Ue,Qe]=m.useState(null),[lt,tt]=m.useState(""),[ht,xt]=m.useState(""),[qe,Nt]=m.useState(2),[st,_t]=m.useState(2),[zt,It]=m.useState(.25),[va,rt]=m.useState(""),[oa,ca]=m.useState(null),[ze,et]=m.useState(""),it=Math.exp(qe)*st/zt,Be=it>=221?"var(--red)":it>=31?"var(--orange)":"var(--green)",at=it>=221?"var(--red-dim)":it>=31?"var(--orange-dim)":"var(--green-dim)",nt=Fu(it),ut=t.assets.find(ge=>ge.id===L),ta=ut&&W&&ut.org_unit_id&&ut.org_unit_id!==W;m.useEffect(()=>{h&&o?.risk_id&&(E(!0),le.get(`/api/v1/risks/${o.risk_id}`).then(ge=>{b(ge),M(`Plan postepowania: ${o.title}`)}).catch(()=>{}).finally(()=>E(!1)))},[]);const Pt=async()=>{if(!(!o||!w)){N(!0);try{const ge=[{entity_type:"risk",entity_id:w.id},{entity_type:"policy_exception",entity_id:o.id}];L&&ge.push({entity_type:"asset",entity_id:L}),await le.post("/api/v1/actions",{title:G||`Plan postepowania: ${o.title}`,description:w.treatment_plan||null,org_unit_id:o.org_unit_id,owner:w.owner||null,links:ge}),Q(!0)}catch(ge){alert("Blad tworzenia dzialania: "+ge)}finally{N(!1)}}},Tt=m.useMemo(()=>{if(!he)return"";const ge=new Date(he);return ge.setMonth(ge.getMonth()+6),ge.toISOString().slice(0,10)},[he]),xe=ve&&Tt&&ve>Tt,Ie={title:!U,description:!R,policyId:!F,orgUnitId:!W,requestedBy:!ne,startDate:!he,expiryDate:!ve||!!xe},mt=!Object.values(Ie).some(Boolean),Oe=fe&&qe&&st&&zt,ct=ge=>{if(!(!x||!ge))return{border:Fv,boxShadow:Rv}},At=()=>{j(!0),mt&&(p(2),j(!1))},za=ge=>{if(H(ge),!h&&ge){const Ft=t.assets.find(ga=>ga.id===ge);Ft&&_e(Ft.name)}},ja=()=>{if(h)d({title:U,description:R,category_id:ee,asset_id:L,approved_by:T||null,compensating_controls:k||null,status_id:D,expiry_date:ve});else{if(!Oe)return;d({title:U,description:R,policy_id:F,category_id:ee,org_unit_id:W,asset_id:L,requested_by:ne,approved_by:T||null,compensating_controls:k||null,status_id:D,start_date:he,expiry_date:ve,vulnerability_id:null,risk_asset_name:fe,risk_security_area_id:Se,risk_threat_id:be,risk_vulnerability_id:Ue,risk_consequence:lt||null,risk_existing_controls:ht||null,risk_impact_level:qe,risk_probability_level:st,risk_safeguard_rating:zt,risk_owner:va||null,risk_strategy_id:oa,risk_treatment_plan:ze||null})}};m.useEffect(()=>{!fe&&U&&_e(L?t.assets.find(ge=>ge.id===L)?.name??U:U)},[f]);const Et=({gridColumn:ge})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:ge?{gridColumn:ge}:void 0,children:[e.jsx("label",{children:"Powiazany aktyw"}),e.jsxs("select",{className:"form-control",value:L??"",onChange:Ft=>za(Ft.target.value?Number(Ft.target.value):null),children:[e.jsx("option",{value:"",children:"Brak powiazania"}),t.assets.map(Ft=>e.jsxs("option",{value:Ft.id,children:[Ft.name,Ft.org_unit_name?` (${Ft.org_unit_name})`:""]},Ft.id))]})]}),ta&&e.jsxs("div",{style:{gridColumn:ge??"span 2",padding:"8px 12px",borderRadius:6,fontSize:11,background:"var(--orange-dim)",border:"1px solid var(--orange)",color:"var(--orange)"},children:["Uwaga: Jednostka org. aktywa (",ut?.org_unit_name,") rozni sie od jednostki wyjatku. Nadrzedna jest jednostka z aktywa."]})]});return h?e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20},children:[{key:"basic",label:"Dane podstawowe"},{key:"risk",label:"Ryzyko odstepstwa"}].map(ge=>e.jsx("div",{style:{flex:1,textAlign:"center",padding:"10px 16px",background:y===ge.key?"var(--blue-dim)":"transparent",borderBottom:y===ge.key?"2px solid var(--blue)":"2px solid var(--border)",color:y===ge.key?"var(--blue)":"var(--text-muted)",fontWeight:y===ge.key?600:400,fontSize:13,cursor:"pointer",transition:"all 0.2s"},onClick:()=>S(ge.key),children:ge.label},ge.key))}),y==="basic"&&e.jsxs("div",{children:[e.jsx(Un,{number:"",label:"Dane podstawowe wyjatku"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul wyjatku *"}),e.jsx("input",{className:"form-control",value:U,onChange:ge=>A(ge.target.value),placeholder:"np. Brak szyfrowania dyskow na stacjach roboczych w oddziale X"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Polityka"}),e.jsx("input",{className:"form-control",disabled:!0,value:t.policies.find(ge=>ge.id===F)?.title??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna"}),e.jsx("input",{className:"form-control",disabled:!0,value:r.find(ge=>ge.id===W)?.name??""})]}),e.jsx(Et,{}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wnioskujacy"}),e.jsx("input",{className:"form-control",disabled:!0,value:ne})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zatwierdzajacy"}),e.jsx("input",{className:"form-control",value:T,onChange:ge=>z(ge.target.value),placeholder:"Imie i nazwisko"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:ee??"",onChange:ge=>me(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.categories.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:D??"",onChange:ge=>de(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.statuses.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",disabled:!0,value:he})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Data wygasniecia *",Tt&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",fontWeight:400},children:[" (max ",Tt,")"]})]}),e.jsx("input",{className:"form-control",type:"date",value:ve,max:Tt,style:xe?{border:Fv,boxShadow:Rv}:void 0,onChange:ge=>je(ge.target.value)}),xe&&e.jsxs("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:["Data wygasniecia nie moze byc wieksza niz 6 miesiecy od daty rozpoczecia (",Tt,")."]})]})]}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uzasadnienie biznesowe *"}),e.jsx("textarea",{className:"form-control",rows:3,value:R,onChange:ge=>Z(ge.target.value),placeholder:"Opisz powod wyjatku, wplyw na biznes, uzasadnienie..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Srodki kompensacyjne"}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:ge=>I(ge.target.value),placeholder:"Opisz jakie dodatkowe srodki bezpieczenstwa zostana wdrozone..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!U||!R||!!xe,onClick:ja,children:s?"Zapisywanie...":"Zapisz zmiany"})]})]}),y==="risk"&&e.jsx("div",{children:_?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie danych ryzyka..."}):w?e.jsxs(e.Fragment,{children:[(()=>{const ge=w.risk_score,Ft=ti(ge),ga=Yo(ge);return e.jsxs("div",{style:{background:ga,border:`1px solid ${Ft}`,borderRadius:10,padding:"12px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Ft,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ryzyko odstepstwa"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",w.impact_level,")  ",w.probability_level," / ",w.safeguard_rating," = ",e.jsx("strong",{style:{color:Ft},children:ge.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Ft},children:ge.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Ft}30`,color:Ft,fontSize:12},children:Fu(ge)})]})]})})(),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(ge=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:ge},ge)),[3,2,1].map(ge=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",ge]},`w${ge}`),[1,2,3].map(Ft=>{const ga=Math.exp(ge)*Ft/w.safeguard_rating,Y=ge===w.impact_level&&Ft===w.probability_level;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:Y?700:400,background:Yo(ga),color:ti(ga),border:Y?`2px solid ${ti(ga)}`:"2px solid transparent"},children:ga.toFixed(0)},`${ge}-${Ft}`)})]}))]})]}),e.jsx(Bv,{value:w.safeguard_rating,readonly:!0})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Un,{number:"",label:"Identyfikacja ryzyka"}),e.jsx(Sa,{label:"Aktywo",value:w.asset_name}),e.jsx(Sa,{label:"Domena",value:w.security_area_name}),e.jsx(Sa,{label:"Zagrozenie",value:w.threats?.map(ge=>ge.threat_name).join(", ")??""}),e.jsx(Sa,{label:"Podatnosc",value:w.vulnerabilities?.map(ge=>ge.vulnerability_name).join(", ")??""}),w.consequence_description&&e.jsxs("div",{style:{marginTop:4,marginBottom:8},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Konsekwencje:"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginTop:2},children:w.consequence_description})]}),e.jsx(Un,{number:"",label:"Analiza ryzyka"}),e.jsx(Sa,{label:"Wplyw (W)",value:`${w.impact_level}  ${["","Niski","Sredni","Wysoki"][w.impact_level]}`}),e.jsx(Sa,{label:"Prawdopodobienstwo (P)",value:`${w.probability_level}  ${["","Niskie","Srednie","Wysokie"][w.probability_level]}`}),e.jsx(Sa,{label:"Ocena zabezpieczen (Z)",value:e.jsxs("span",{style:{color:Qm.find(ge=>Math.abs(ge.value-w.safeguard_rating)<.01)?.color},children:[w.safeguard_rating.toFixed(2),"  ",Qm.find(ge=>Math.abs(ge.value-w.safeguard_rating)<.01)?.label??""]})}),e.jsx(Un,{number:"",label:"Postepowanie z ryzykiem"}),e.jsx(Sa,{label:"Wlasciciel",value:w.owner}),e.jsx(Sa,{label:"Strategia",value:w.strategy_name}),w.treatment_plan&&e.jsxs("div",{style:{marginTop:4,marginBottom:8},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:"Plan postepowania:"}),e.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)",background:"var(--bg-inset)",borderRadius:6,padding:8,marginTop:2},children:w.treatment_plan})]}),w.linked_actions.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",marginBottom:4},children:"Powiazane dzialania"}),e.jsx("div",{className:"tag-list",children:w.linked_actions.map(ge=>e.jsxs("span",{className:"tag",style:{cursor:"default",borderLeft:`3px solid ${ge.is_overdue?"var(--red)":ge.status_name?.toLowerCase().includes("zamkn")?"var(--green)":"var(--blue)"}`},children:[e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",marginRight:4},children:["D-",ge.action_id]}),ge.title,ge.is_overdue&&e.jsx("span",{style:{color:"var(--red)",marginLeft:4,fontSize:10},children:"!"})]},ge.action_id))})]})]}),e.jsxs("div",{style:{marginTop:16,padding:14,borderRadius:8,background:"rgba(59,130,246,0.05)",border:"1px solid rgba(59,130,246,0.15)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--blue)",fontWeight:600,marginBottom:8},children:"Zarejestruj dzialanie z planu postepowania"}),O?e.jsx("div",{style:{fontSize:12,color:"var(--green)",padding:"8px 0"},children:"Dzialanie zostalo utworzone i powiazane z ryzykiem oraz wyjatkiem."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"form-group",style:{marginBottom:8},children:e.jsx("input",{className:"form-control",value:G,onChange:ge=>M(ge.target.value),placeholder:"Tytul dzialania...",style:{fontSize:12}})}),e.jsx("button",{className:"btn btn-sm btn-primary",disabled:C||!G,onClick:Pt,children:C?"Tworzenie...":"Utworz dzialanie"})]})]})]}):e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Brak powiazanego ryzyka odstepstwa."})})]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",gap:0,marginBottom:20},children:[{n:1,label:"Dane wyjatku"},{n:2,label:"Ocena ryzyka odstepstwa"}].map(ge=>e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"10px 16px",background:f===ge.n?"var(--blue-dim)":"transparent",borderBottom:f===ge.n?"2px solid var(--blue)":"2px solid var(--border)",color:f===ge.n?"var(--blue)":"var(--text-muted)",fontWeight:f===ge.n?600:400,fontSize:13,cursor:ge.n<f?"pointer":void 0,transition:"all 0.2s"},onClick:()=>{ge.n<f&&p(ge.n)},children:[e.jsx("span",{style:{display:"inline-flex",width:22,height:22,borderRadius:"50%",alignItems:"center",justifyContent:"center",fontSize:11,background:f>=ge.n?"var(--blue)":"var(--border)",color:f>=ge.n?"#fff":"var(--text-muted)",marginRight:8},children:ge.n}),ge.label]},ge.n))}),f===1&&e.jsxs("div",{children:[e.jsx(Un,{number:"",label:"Dane podstawowe wyjatku"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul wyjatku *"}),e.jsx("input",{className:"form-control",value:U,onChange:ge=>A(ge.target.value),style:ct(Ie.title),placeholder:"np. Brak szyfrowania dyskw na stacjach roboczych w oddziale X"}),x&&Ie.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Polityka *"}),e.jsxs("select",{className:"form-control",value:F??"",style:ct(Ie.policyId),onChange:ge=>q(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz polityk..."}),t.policies.map(ge=>e.jsx("option",{value:ge.id,children:ge.title},ge.id))]}),x&&Ie.policyId&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsx(jn,{tree:a,value:W,onChange:J,placeholder:"Wybierz...",allowClear:!1,style:ct(Ie.orgUnitId)}),x&&Ie.orgUnitId&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsx(Et,{gridColumn:"span 2"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wnioskujacy *"}),e.jsx("input",{className:"form-control",value:ne,onChange:ge=>P(ge.target.value),style:ct(Ie.requestedBy),placeholder:"Imie i nazwisko"}),x&&Ie.requestedBy&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zatwierdzajacy"}),e.jsx("input",{className:"form-control",value:T,onChange:ge=>z(ge.target.value),placeholder:"Imie i nazwisko"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:ee??"",onChange:ge=>me(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.categories.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:D??"",onChange:ge=>de(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Brak"}),t.statuses.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia *"}),e.jsx("input",{className:"form-control",type:"date",value:he,style:ct(Ie.startDate),onChange:ge=>ie(ge.target.value)}),x&&Ie.startDate&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["Data wygasniecia *",Tt&&e.jsxs("span",{style:{fontSize:10,color:"var(--text-muted)",fontWeight:400},children:[" (max ",Tt,")"]})]}),e.jsx("input",{className:"form-control",type:"date",value:ve,max:Tt,style:ct(Ie.expiryDate),onChange:ge=>je(ge.target.value)}),x&&!ve&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"}),xe&&e.jsxs("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:["Data wygasniecia nie moze byc wieksza niz 6 miesiecy od daty rozpoczecia (",Tt,")."]})]})]}),e.jsx(Un,{number:"",label:"Uzasadnienie i kompensacja"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uzasadnienie biznesowe *"}),e.jsx("textarea",{className:"form-control",rows:3,value:R,onChange:ge=>Z(ge.target.value),style:ct(Ie.description),placeholder:"Opisz powod wyjatku, wplyw na biznes, uzasadnienie..."}),x&&Ie.description&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:4},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Srodki kompensacyjne"}),e.jsx("textarea",{className:"form-control",rows:3,value:k,onChange:ge=>I(ge.target.value),placeholder:"Opisz jakie dodatkowe srodki bezpieczenstwa zostana wdrozone..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:At,children:"Dalej: Ocena ryzyka "})]})]}),f===2&&e.jsxs("div",{children:[e.jsx("div",{style:{background:"var(--orange-dim)",border:"1px solid var(--orange)",borderRadius:8,padding:"10px 16px",marginBottom:16,fontSize:12,color:"var(--orange)"},children:"Kazdy wyjatek od polityki wymaga formalnej oceny ryzyka odstepstwa zgodnie z macierza ryzyka. Ryzyko zostanie automatycznie zarejestrowane w rejestrze ryzyk."}),e.jsxs("div",{style:{background:at,border:`1px solid ${Be}`,borderRadius:10,padding:"12px 20px",marginBottom:16,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:Be,textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:2},children:"Ocena ryzyka odstepstwa"}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["R = EXP(",qe,")  ",st," / ",zt," = ",e.jsx("strong",{style:{color:Be},children:it.toFixed(1)})]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:Be},children:it.toFixed(1)}),e.jsx("span",{className:"score-badge",style:{background:`${Be}30`,color:Be,fontSize:12},children:nt})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:20,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textAlign:"center",marginBottom:8,textTransform:"uppercase",letterSpacing:"0.05em"},children:"Macierz ryzyka (W  P)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"auto repeat(3, 1fr)",gap:2,maxWidth:280},children:[e.jsx("div",{}),["P=1","P=2","P=3"].map(ge=>e.jsx("div",{style:{textAlign:"center",fontSize:10,color:"var(--text-muted)",padding:4},children:ge},ge)),[3,2,1].map(ge=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",padding:4,display:"flex",alignItems:"center"},children:["W=",ge]},`w${ge}`),[1,2,3].map(Ft=>{const ga=Math.exp(ge)*Ft/zt,Y=ge===qe&&Ft===st;return e.jsx("div",{style:{textAlign:"center",padding:6,borderRadius:4,fontSize:10,fontFamily:"'JetBrains Mono',monospace",fontWeight:Y?700:400,background:Yo(ga),color:ti(ga),border:Y?`2px solid ${ti(ga)}`:"2px solid transparent",cursor:"pointer",transition:"all 0.15s"},onClick:()=>{Nt(ge),_t(Ft)},children:ga.toFixed(0)},`${ge}-${Ft}`)})]}))]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"center",marginTop:4},children:"Kliknij komorke aby wybrac W i P"})]}),e.jsx(Bv,{value:zt,onChange:It})]}),e.jsx(Un,{number:"",label:"Identyfikacja ryzyka"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Aktywo / obszar narazony na ryzyko *"}),e.jsx("input",{className:"form-control",required:!0,value:fe,onChange:ge=>_e(ge.target.value),placeholder:"np. Stacje robocze oddzialu X"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Domena bezpieczenstwa"}),e.jsxs("select",{className:"form-control",value:Se??"",onChange:ge=>Ve(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.areas.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zagrozenie"}),e.jsxs("select",{className:"form-control",value:be??"",onChange:ge=>oe(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.threats.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:Ue??"",onChange:ge=>Qe(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.vulns.map(ge=>e.jsx("option",{value:ge.id,children:ge.name},ge.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis konsekwencji realizacji ryzyka"}),e.jsx("textarea",{className:"form-control",rows:2,value:lt,onChange:ge=>tt(ge.target.value),placeholder:"Co moze sie stac jezeli ryzyko sie zmaterializuje..."})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Istniejace zabezpieczenia / kontrole"}),e.jsx("textarea",{className:"form-control",rows:2,value:ht,onChange:ge=>xt(ge.target.value),placeholder:"Jakie srodki sa juz wdrozone..."})]})]}),e.jsx(Un,{number:"",label:"Ocena ryzyka (macierz)"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wplyw (W) *"}),e.jsxs("select",{className:"form-control",required:!0,value:qe,onChange:ge=>Nt(Number(ge.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niski"}),e.jsx("option",{value:"2",children:"2 -- Sredni"}),e.jsx("option",{value:"3",children:"3 -- Wysoki"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Prawdopodobienstwo (P) *"}),e.jsxs("select",{className:"form-control",required:!0,value:st,onChange:ge=>_t(Number(ge.target.value)),children:[e.jsx("option",{value:"1",children:"1 -- Niskie"}),e.jsx("option",{value:"2",children:"2 -- Srednie"}),e.jsx("option",{value:"3",children:"3 -- Wysokie"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ocena zabezpieczen (Z) *"}),e.jsxs("select",{className:"form-control",required:!0,value:zt,onChange:ge=>It(Number(ge.target.value)),children:[e.jsx("option",{value:"0.10",children:"0,10 -- Brak zabezpieczen"}),e.jsx("option",{value:"0.25",children:"0,25 -- Czesciowe"}),e.jsx("option",{value:"0.70",children:"0,70 -- Dobra jakosc"}),e.jsx("option",{value:"0.95",children:"0,95 -- Skuteczne, testowane"})]})]})]}),e.jsx(Un,{number:"",label:"Postepowanie z ryzykiem"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel ryzyka"}),e.jsx("input",{className:"form-control",value:va,onChange:ge=>rt(ge.target.value),placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Strategia"}),e.jsxs("select",{className:"form-control",value:oa??"",onChange:ge=>ca(ge.target.value?Number(ge.target.value):null),children:[e.jsx("option",{value:"",children:"Wybierz..."}),t.strategies.map(ge=>e.jsx("option",{value:ge.id,children:ge.label},ge.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Plan postepowania z ryzykiem"}),e.jsx("textarea",{className:"form-control",rows:2,value:ze,onChange:ge=>et(ge.target.value),placeholder:"Jakie dzialania beda podjete aby zredukowac ryzyko..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>p(1),children:" Wstecz"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",className:"btn",onClick:u,children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:s||!Oe,onClick:ja,children:s?"Zapisywanie...":"Zapisz wyjatek + ryzyko"})]})]})]})]})}const Oo="";function Ov({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}function Dv(t){switch(t){case"in_progress":return"var(--orange)";case"completed":return"var(--green)";case"cancelled":return"var(--text-muted)";default:return"var(--blue)"}}function YE(t){switch(t){case"in_progress":return"var(--orange-dim)";case"completed":return"var(--green-dim)";case"cancelled":return"transparent";default:return"var(--blue-dim)"}}function wb(t){switch(t){case"planned":return"Planowany";case"in_progress":return"W trakcie";case"completed":return"Zakoczony";case"cancelled":return"Anulowany";default:return t}}const JE="1px solid var(--red)",XE="0 0 0 3px var(--red-dim)",vm=[{key:"id",header:"ID",format:t=>String(t.id),defaultVisible:!1},{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytul",format:t=>t.title},{key:"audit_type_name",header:"Typ",format:t=>t.audit_type_name??""},{key:"framework",header:"Framework",format:t=>t.framework??""},{key:"auditor",header:"Audytor",format:t=>t.auditor},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??""},{key:"status",header:"Status",format:t=>wb(t.status)},{key:"start_date",header:"Rozpoczecie",format:t=>t.start_date??""},{key:"end_date",header:"Zakoczenie",format:t=>t.end_date??""},{key:"overall_rating_name",header:"Ocena",format:t=>t.overall_rating_name??""},{key:"findings_count",header:"Findings",format:t=>t.findings_count}];function QE(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState([]),[w,b]=m.useState([]),[,_]=m.useState([]),[E,C]=m.useState(null),[N,O]=m.useState([]),{visible:Q,toggle:G}=da(vm,"audits"),[M,U]=m.useState(!1),A=Aa({data:t,storageKey:"audits",defaultSort:"start_date",defaultSortDir:"desc"}),[R,Z]=m.useState({title:"",auditor:"",framework:"",audit_type_id:null,org_unit_id:null,status:"planned",start_date:"",end_date:""}),F=()=>{Z({title:"",auditor:"",framework:"",audit_type_id:null,org_unit_id:null,status:"planned",start_date:"",end_date:""}),j(!1)};m.useEffect(()=>{q()},[]);async function q(){s(!0),d(null);try{const[H,ne]=await Promise.all([fetch(`${Oo}/api/v1/audits`),fetch(`${Oo}/api/v1/org-units/tree`)]);H.ok?r(await H.json()):d(`API ${H.status}`),ne.ok&&S(await ne.json());for(const[P,T]of[["audit_type",b],["audit_rating",_]]){const z=await fetch(`${Oo}/api/v1/dictionaries/by-code/${P}`);if(z.ok){const k=await z.json();T(k.entries??[])}}}catch(H){d(String(H))}s(!1)}async function ee(){if(j(!0),!(!R.title||!R.auditor)){p(!0);try{const H={...R,framework:R.framework||null,start_date:R.start_date||null,end_date:R.end_date||null},ne=await fetch(`${Oo}/api/v1/audits`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});ne.ok?(h(!1),F(),q()):alert("Blad zapisu: "+await ne.text())}catch(H){alert("Blad: "+H)}p(!1)}}async function me(H){if(E===H){C(null);return}C(H);try{const ne=await fetch(`${Oo}/api/v1/audits/${H}/findings`);ne.ok?O(await ne.json()):O([])}catch{O([])}}const W=H=>x&&!H?{border:JE,boxShadow:XE}:{},J=A.filteredCount!==A.totalCount,L=m.useMemo(()=>{const H=A.filtered,ne=H.filter(D=>D.status==="in_progress").length,P=H.filter(D=>D.status==="completed").length,T=H.length>0?H.reduce((D,de)=>D+de.findings_count,0)/H.length:0,z=t.filter(D=>D.status==="in_progress").length,k=t.filter(D=>D.status==="completed").length,I=t.length>0?t.reduce((D,de)=>D+de.findings_count,0)/t.length:0;return[{label:"Wszystkich audytw",value:H.length,total:t.length,color:"var(--blue)"},{label:"W trakcie",value:ne,total:z,color:"var(--orange)"},{label:"Zakoczonych",value:P,total:k,color:"var(--green)"},{label:"rednia findings",value:T.toFixed(1),total:I.toFixed(1),color:"var(--purple)"}]},[A.filtered,t]);return e.jsxs("div",{children:[o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(Ia,{cards:L,isFiltered:J}),e.jsx(ma,{filteredCount:A.filteredCount,totalCount:A.totalCount,unitLabel:"audytow",search:A.search,onSearchChange:A.setSearch,searchPlaceholder:"Szukaj (tytul, ref, audytor, framework)...",showFilters:M,onToggleFilters:()=>U(H=>!H),hasActiveFilters:A.hasActiveFilters,onClearFilters:A.clearAllFilters,columns:vm,visibleColumns:Q,onToggleColumn:G,data:A.filtered,exportFilename:"audyty",primaryLabel:"Nowy audyt",onPrimaryAction:()=>{F(),h(!0)}}),e.jsx(Ea,{columns:vm,visibleColumns:Q,data:A.pageData,rowKey:H=>H.id,selectedKey:E,onRowClick:H=>me(H.id),rowBorderColor:H=>Dv(H.status),sortField:A.sortField,sortDir:A.sortDir,onSort:A.toggleSort,columnFilters:A.columnFilters,onColumnFilter:A.setColumnFilter,showFilters:M,page:A.page,totalPages:A.totalPages,pageSize:A.pageSize,totalItems:A.totalCount,filteredItems:A.filteredCount,onPageChange:A.setPage,onPageSizeChange:A.setPageSize,loading:a,emptyMessage:"Brak audytow w systemie.",emptyFilteredMessage:"Brak audytow pasujacych do filtrow.",renderCell:(H,ne)=>{if(ne==="status")return e.jsx("span",{className:"score-badge",style:{background:YE(H.status),color:Dv(H.status)},children:wb(H.status)});if(ne==="findings_count")return e.jsx("span",{style:{fontWeight:H.findings_count>0?700:void 0,fontFamily:"'JetBrains Mono',monospace",color:H.findings_count>0?"var(--red)":void 0},children:H.findings_count});if(ne==="overall_rating_name")return H.overall_rating_name?e.jsx("span",{style:{color:"var(--blue)",fontWeight:500},children:H.overall_rating_name}):e.jsx("span",{children:""})}}),E!=null&&e.jsxs("div",{className:"card",style:{marginTop:0,borderTop:"none",borderTopLeftRadius:0,borderTopRightRadius:0,padding:"8px 16px"},children:[e.jsxs("strong",{style:{fontSize:12},children:["Findings (",N.length,"):"]}),N.length===0&&e.jsx("p",{style:{color:"var(--text-muted)",margin:"4px 0",fontSize:12},children:"Brak findingw"}),N.length>0&&e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Tytul"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Waznosc"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Wlasciciel"}),e.jsx("th",{children:"SLA"})]})}),e.jsx("tbody",{children:N.map(H=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:H.ref_id??""}),e.jsx("td",{style:{fontWeight:500,fontSize:12},children:H.title}),e.jsx("td",{style:{fontSize:12},children:H.finding_type_name??""}),e.jsx("td",{style:{fontSize:12},children:H.severity_name??""}),e.jsx("td",{style:{fontSize:12},children:H.status_name??""}),e.jsx("td",{style:{fontSize:12},children:H.remediation_owner??""}),e.jsxs("td",{style:{fontSize:12,color:H.sla_deadline&&new Date(H.sla_deadline)<new Date?"var(--red)":void 0,fontWeight:H.sla_deadline&&new Date(H.sla_deadline)<new Date?600:void 0},children:[H.sla_deadline??"",H.sla_deadline&&new Date(H.sla_deadline)<new Date?" !":""]})]},H.id))})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy audyt",wide:!0,children:[e.jsx(Ov,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:W(!!R.title),value:R.title,onChange:H=>Z({...R,title:H.target.value}),placeholder:"Nazwa audytu"}),x&&!R.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Audytor *"}),e.jsx("input",{className:"form-control",style:W(!!R.auditor),value:R.auditor,onChange:H=>Z({...R,auditor:H.target.value}),placeholder:"Imie i nazwisko"}),x&&!R.auditor&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ audytu"}),e.jsxs("select",{className:"form-control",value:R.audit_type_id??"",onChange:H=>Z({...R,audit_type_id:H.target.value?Number(H.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),w.map(H=>e.jsx("option",{value:H.id,children:H.label},H.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Framework"}),e.jsx("input",{className:"form-control",value:R.framework,onChange:H=>Z({...R,framework:H.target.value}),placeholder:"np. ISO 27001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org."}),e.jsx(jn,{tree:y,value:R.org_unit_id,onChange:H=>Z({...R,org_unit_id:H}),placeholder:"-- brak --",allowClear:!0})]})]}),e.jsx(Ov,{number:"",label:"Status i daty"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:R.status,onChange:H=>Z({...R,status:H.target.value}),children:[e.jsx("option",{value:"planned",children:"Planowany"}),e.jsx("option",{value:"in_progress",children:"W trakcie"}),e.jsx("option",{value:"completed",children:"Zakoczony"}),e.jsx("option",{value:"cancelled",children:"Anulowany"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:R.start_date,onChange:H=>Z({...R,start_date:H.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data zakonczenia"}),e.jsx("input",{className:"form-control",type:"date",value:R.end_date,onChange:H=>Z({...R,end_date:H.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:f,onClick:ee,children:f?"Zapisywanie...":"Utworz audyt"})]})]})]})}const jm="";function Do(t){if(t){if(t.startsWith("A"))return"#16a34a";if(t.startsWith("B"))return"#ca8a04";if(t.startsWith("C"))return"#ea580c";if(t.startsWith("D"))return"#dc2626"}}function Lv(t){return t?t.startsWith("A")?"var(--green-dim)":t.startsWith("B")?"var(--yellow-dim)":t.startsWith("C")?"var(--orange-dim)":t.startsWith("D")?"var(--red-dim)":"transparent":"transparent"}function ms(t){return!!t&&new Date(t)<new Date}function Mv(t){if(!t)return!1;const r=new Date(t),a=new Date,s=new Date;return s.setDate(s.getDate()+90),r>=a&&r<=s}function fl({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}function In({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}const e3="1px solid var(--red)",t3="0 0 0 3px var(--red-dim)",bm=[{key:"ref_id",header:"Ref",defaultVisible:!0,format:t=>t.ref_id??""},{key:"name",header:"Nazwa",defaultVisible:!0,format:t=>t.name},{key:"category_name",header:"Kategoria",defaultVisible:!0,format:t=>t.category_name??""},{key:"criticality_name",header:"Krytycznosc",defaultVisible:!0,format:t=>t.criticality_name??""},{key:"status_name",header:"Status",defaultVisible:!0,format:t=>t.status_name??""},{key:"risk_rating_name",header:"Rating",defaultVisible:!0,format:t=>t.risk_rating_name??""},{key:"risk_score",header:"Wynik",defaultVisible:!0,format:t=>t.risk_score!=null?`${t.risk_score}%`:""},{key:"contract_end",header:"Koniec umowy",defaultVisible:!0,format:t=>t.contract_end??""},{key:"last_assessment_date",header:"Ostatnia ocena",defaultVisible:!0,format:t=>t.last_assessment_date??""},{key:"next_assessment_date",header:"Nastepna ocena",defaultVisible:!0,format:t=>t.next_assessment_date??""},{key:"contract_owner",header:"Wlasciciel umowy",defaultVisible:!1,format:t=>t.contract_owner??""},{key:"questionnaire_completed",header:"Kwestionariusz",defaultVisible:!1,format:t=>t.questionnaire_completed?"TAK":"NIE"},{key:"is_active",header:"Aktywny",defaultVisible:!1,format:t=>t.is_active?"TAK":"NIE"}];function a3(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(!1),[y,S]=m.useState(!1),[w,b]=m.useState([]),[_,E]=m.useState([]),[C,N]=m.useState([]),[O,Q]=m.useState([]),{visible:G,toggle:M}=da(bm,"vendors"),[U,A]=m.useState(!1),R=Aa({data:t,storageKey:"vendors",defaultSort:"name",defaultSortDir:"asc"}),[Z,F]=m.useState({name:"",category_id:null,criticality_id:null,services_provided:"",data_access_level_id:null,contract_owner:"",security_contact:"",contract_start:"",contract_end:"",sla_description:"",status_id:null,certifications:""}),q=()=>{F({name:"",category_id:null,criticality_id:null,services_provided:"",data_access_level_id:null,contract_owner:"",security_contact:"",contract_start:"",contract_end:"",sla_description:"",status_id:null,certifications:""}),S(!1)};m.useEffect(()=>{ee()},[]);async function ee(){s(!0),d(null);try{const ne=await fetch(`${jm}/api/v1/vendors`);ne.ok?r(await ne.json()):d(`API ${ne.status}`);for(const[P,T]of[["vendor_category",b],["vendor_status",N],["asset_criticality",E],["vendor_data_access",Q]]){const z=await fetch(`${jm}/api/v1/dictionaries/by-code/${P}`);if(z.ok){const k=await z.json();T(k.entries??[])}}}catch(ne){d(String(ne))}s(!1)}async function me(){if(S(!0),!!Z.name){j(!0);try{const ne={...Z,services_provided:Z.services_provided||null,contract_start:Z.contract_start||null,contract_end:Z.contract_end||null,sla_description:Z.sla_description||null,certifications:Z.certifications||null},P=await fetch(`${jm}/api/v1/vendors`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)});P.ok?(h(!1),q(),ee()):alert("Blad zapisu: "+await P.text())}catch(ne){alert("Blad: "+ne)}j(!1)}}const W=ne=>{const P=(ne.criticality_name??"").toLowerCase();return P.includes("wysoki")||P.includes("high")||P.includes("krytyczny")||P.includes("critical")},J=m.useMemo(()=>{const ne=R.filtered,P=t,T=ne.filter(W).length,z=P.filter(W).length,k=ne.filter(ve=>ve.risk_score!=null),I=P.filter(ve=>ve.risk_score!=null),D=k.length>0?k.reduce((ve,je)=>ve+(je.risk_score??0),0)/k.length:0,de=I.length>0?I.reduce((ve,je)=>ve+(je.risk_score??0),0)/I.length:0,he=ne.filter(ve=>Mv(ve.contract_end)).length,ie=P.filter(ve=>Mv(ve.contract_end)).length;return[{label:"Wszystkich dostawcow",value:ne.length,total:P.length,color:"var(--blue)"},{label:"Krytycznych",value:T,total:z,color:"var(--red)"},{label:"Sr. wynik ryzyka",value:D,total:de,color:"var(--orange, #ea580c)",formatValue:ve=>typeof ve=="number"?`${ve.toFixed(1)}%`:`${ve}%`},{label:"Umowy wygasajace",value:he,total:ie,color:"var(--purple, #7c3aed)"}]},[t,R.filtered]),L=ne=>y&&!ne?{border:e3,boxShadow:t3}:{},H=(ne,P)=>{switch(P){case"name":return e.jsx("span",{style:{fontWeight:500},children:ne.name});case"criticality_name":return ne.criticality_name?e.jsx("span",{className:"score-badge",style:{background:W(ne)?"var(--red-dim)":"var(--blue-dim)",color:W(ne)?"var(--red)":"var(--blue)"},children:ne.criticality_name}):"";case"risk_rating_name":return ne.risk_rating_name?e.jsx("span",{className:"score-badge",style:{background:Lv(ne.risk_rating_name),color:Do(ne.risk_rating_name),fontWeight:600},children:ne.risk_rating_name}):"";case"risk_score":return ne.risk_score==null?"":e.jsxs("span",{style:{fontFamily:"'JetBrains Mono',monospace",color:Do(ne.risk_rating_name)},children:[ne.risk_score,"%"]});case"contract_end":return ne.contract_end?e.jsxs("span",{style:{fontSize:12,color:ms(ne.contract_end)?"var(--red)":void 0,fontWeight:ms(ne.contract_end)?600:void 0},children:[ne.contract_end,ms(ne.contract_end)?" !":""]}):"";default:return}};return e.jsxs("div",{children:[e.jsx(Ia,{cards:J,isFiltered:R.filteredCount!==R.totalCount}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:R.filteredCount,totalCount:R.totalCount,unitLabel:"dostawcow",search:R.search,onSearchChange:R.setSearch,searchPlaceholder:"Szukaj (nazwa, ref, wlasciciel)...",showFilters:U,onToggleFilters:()=>A(ne=>!ne),hasActiveFilters:R.hasActiveFilters,onClearFilters:R.clearAllFilters,columns:bm,visibleColumns:G,onToggleColumn:M,data:R.filtered,exportFilename:"dostawcy",primaryLabel:"Nowy dostawca",onPrimaryAction:()=>{q(),h(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:f?"1fr 420px":"1fr",gap:14},children:[e.jsx(Ea,{columns:bm,visibleColumns:G,data:R.pageData,renderCell:H,onRowClick:ne=>p(f?.id===ne.id?null:ne),rowKey:ne=>ne.id,selectedKey:f?.id??null,sortField:R.sortField,sortDir:R.sortDir,onSort:R.toggleSort,columnFilters:R.columnFilters,onColumnFilter:R.setColumnFilter,showFilters:U,page:R.page,totalPages:R.totalPages,pageSize:R.pageSize,totalItems:R.totalCount,filteredItems:R.filteredCount,onPageChange:R.setPage,onPageSizeChange:R.setPageSize,loading:a,emptyMessage:"Brak dostawcow w systemie.",emptyFilteredMessage:"Brak dostawcow pasujacych do filtrow."}),f&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly Dostawcy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>p(null),children:""})]}),f.risk_rating_name&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:4},children:"Risk Rating"}),e.jsx("span",{className:"score-badge",style:{background:Lv(f.risk_rating_name),color:Do(f.risk_rating_name),fontSize:14,padding:"6px 16px"},children:f.risk_rating_name}),f.risk_score!=null&&e.jsxs("div",{style:{marginTop:4,fontSize:20,fontFamily:"'JetBrains Mono',monospace",fontWeight:700,color:Do(f.risk_rating_name)},children:[f.risk_score,"%"]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(fl,{number:"",label:"Dane dostawcy"}),e.jsx(In,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:f.ref_id})}),e.jsx(In,{label:"Nazwa",value:e.jsx("strong",{children:f.name})}),e.jsx(In,{label:"Kategoria",value:f.category_name}),e.jsx(In,{label:"Krytycznosc",value:f.criticality_name}),e.jsx(In,{label:"Status",value:f.status_name?e.jsx("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)"},children:f.status_name}):""}),e.jsx(fl,{number:"",label:"Umowa i kontakt"}),e.jsx(In,{label:"Wlasciciel umowy",value:f.contract_owner}),e.jsx(In,{label:"Koniec umowy",value:f.contract_end?e.jsxs("span",{children:[f.contract_end,ms(f.contract_end)?" !":""]}):"",color:ms(f.contract_end)?"var(--red)":void 0}),e.jsx(In,{label:"Kwestionariusz",value:f.questionnaire_completed?e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:"TAK"}):e.jsx("span",{style:{color:"var(--text-muted)"},children:"NIE"})}),e.jsx(In,{label:"Aktywny",value:f.is_active?e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:"TAK"}):e.jsx("span",{style:{color:"var(--red)",fontWeight:600},children:"NIE"})}),e.jsx(fl,{number:"",label:"Oceny i ryzyko"}),e.jsx(In,{label:"Risk Rating",value:f.risk_rating_name,color:Do(f.risk_rating_name)}),e.jsx(In,{label:"Risk Score",value:f.risk_score!=null?`${f.risk_score}%`:""}),e.jsx(In,{label:"Ostatnia ocena",value:f.last_assessment_date}),e.jsx(In,{label:"Nastepna ocena",value:f.next_assessment_date?e.jsxs("span",{children:[f.next_assessment_date,ms(f.next_assessment_date)?" !":""]}):"",color:ms(f.next_assessment_date)?"var(--red)":void 0})]})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowy dostawca (TPRM)",wide:!0,children:[e.jsx(fl,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:L(!!Z.name),value:Z.name,onChange:ne=>F({...Z,name:ne.target.value}),placeholder:"Nazwa dostawcy"}),y&&!Z.name&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:Z.category_id??"",onChange:ne=>F({...Z,category_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),w.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Krytycznosc"}),e.jsxs("select",{className:"form-control",value:Z.criticality_id??"",onChange:ne=>F({...Z,criticality_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),_.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Poziom dostepu do danych"}),e.jsxs("select",{className:"form-control",value:Z.data_access_level_id??"",onChange:ne=>F({...Z,data_access_level_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]})]}),e.jsx(fl,{number:"",label:"Umowa i kontakt"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel umowy"}),e.jsx("input",{className:"form-control",value:Z.contract_owner,onChange:ne=>F({...Z,contract_owner:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kontakt bezpieczenstwa"}),e.jsx("input",{className:"form-control",value:Z.security_contact,onChange:ne=>F({...Z,security_contact:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:Z.status_id??"",onChange:ne=>F({...Z,status_id:ne.target.value?Number(ne.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),C.map(ne=>e.jsx("option",{value:ne.id,children:ne.label},ne.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:Z.contract_start,onChange:ne=>F({...Z,contract_start:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data konca umowy"}),e.jsx("input",{className:"form-control",type:"date",value:Z.contract_end,onChange:ne=>F({...Z,contract_end:ne.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Certyfikaty"}),e.jsx("input",{className:"form-control",value:Z.certifications,onChange:ne=>F({...Z,certifications:ne.target.value}),placeholder:"ISO 27001, SOC2..."})]})]}),e.jsx(fl,{number:"",label:"Opis uslug"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis swiadczonych uslug"}),e.jsx("textarea",{className:"form-control",rows:3,value:Z.services_provided,onChange:ne=>F({...Z,services_provided:ne.target.value}),placeholder:"Szczegolowy opis uslug dostawcy..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis SLA"}),e.jsx("textarea",{className:"form-control",rows:2,value:Z.sla_description,onChange:ne=>F({...Z,sla_description:ne.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:x,onClick:me,children:x?"Zapisywanie...":"Utworz dostawce"})]})]})]})}const Lo="";function Yd(t){if(!t)return"var(--text-muted)";const r=t.toLowerCase();return r.includes("planowana")||r.includes("planned")?"#6b7280":r.includes("w trakcie")||r.includes("in_progress")||r.includes("in progress")?"#2563eb":r.includes("zakonczona")||r.includes("zakoczona")||r.includes("completed")?"#16a34a":"var(--text-muted)"}function _m(t){if(!t)return"transparent";const r=t.toLowerCase();return r.includes("planowana")||r.includes("planned")?"rgba(107,114,128,0.15)":r.includes("w trakcie")||r.includes("in_progress")||r.includes("in progress")?"var(--blue-dim)":r.includes("zakonczona")||r.includes("zakoczona")||r.includes("completed")?"var(--green-dim)":"transparent"}function n3(t){if(!t)return!1;const r=t.toLowerCase();return r.includes("w trakcie")||r.includes("in_progress")||r.includes("in progress")}function r3(t){if(!t)return!1;const r=t.toLowerCase();return r.includes("zakonczona")||r.includes("zakoczona")||r.includes("completed")}function Pn({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function ps({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}const i3="1px solid var(--red)",s3="0 0 0 3px var(--red-dim)",Sm=[{key:"ref_id",header:"Ref",format:t=>t.ref_id??""},{key:"title",header:"Tytul",format:t=>t.title},{key:"campaign_type_name",header:"Typ",format:t=>t.campaign_type_name??""},{key:"org_unit_name",header:"Jednostka",format:t=>t.org_unit_name??"Cala org."},{key:"status_name",header:"Status",format:t=>t.status_name??""},{key:"target_audience_count",header:"Uczestnicy",format:t=>t.target_audience_count},{key:"start_date",header:"Start",format:t=>t.start_date??""},{key:"end_date",header:"Koniec",format:t=>t.end_date??""},{key:"owner",header:"Wlasciciel",format:t=>t.owner??""}];function l3(){const[t,r]=m.useState([]),[a,s]=m.useState(!0),[o,d]=m.useState(null),[u,h]=m.useState(!1),[f,p]=m.useState(!1),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState({}),[_,E]=m.useState(null),[C,N]=m.useState([]),[O,Q]=m.useState([]),[G,M]=m.useState([]),[U,A]=m.useState(""),[R,Z]=m.useState("start_date"),[F,q]=m.useState("desc"),[ee,me]=m.useState(!1),[W,J]=m.useState(""),[L,H]=m.useState(""),{visible:ne,toggle:P}=da(Sm,"awareness"),T={title:"",description:"",campaign_type_id:null,org_unit_id:null,target_audience_count:0,start_date:"",end_date:"",status_id:null,owner:"",content_url:""},[z,k]=m.useState(T),I=()=>{k({...T}),j(!1)};m.useEffect(()=>{D()},[]);async function D(){s(!0),d(null);try{const[be,oe]=await Promise.all([fetch(`${Lo}/api/v1/awareness-campaigns`),fetch(`${Lo}/api/v1/org-units/tree`)]);be.ok?r(await be.json()):d(`API ${be.status}`),oe.ok&&M(await oe.json());for(const[Ue,Qe]of[["campaign_type",N],["campaign_status",Q]]){const lt=await fetch(`${Lo}/api/v1/dictionaries/by-code/${Ue}`);if(lt.ok){const tt=await lt.json();Qe(tt.entries??[])}}}catch(be){d(String(be))}s(!1)}async function de(be){if(w[be]){S(y===be?null:be);return}try{const oe=await fetch(`${Lo}/api/v1/awareness-campaigns/${be}/results`);if(oe.ok){const Ue=await oe.json();b(Qe=>({...Qe,[be]:Ue}))}}catch{}S(be)}async function he(){if(j(!0),!!z.title){p(!0);try{const be={...z,description:z.description||null,start_date:z.start_date||null,end_date:z.end_date||null,content_url:z.content_url||null,owner:z.owner||null},oe=await fetch(`${Lo}/api/v1/awareness-campaigns`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)});oe.ok?(h(!1),I(),D()):alert("Blad zapisu: "+await oe.text())}catch(be){alert("Blad: "+be)}p(!1)}}const ie=be=>{R===be?q(oe=>oe==="asc"?"desc":"asc"):(Z(be),q("asc"))},ve=!!W||!!L,je=()=>{J(""),H("")},fe=m.useMemo(()=>{let be=[...t];if(U){const oe=U.toLowerCase();be=be.filter(Ue=>(Ue.title??"").toLowerCase().includes(oe)||(Ue.ref_id??"").toLowerCase().includes(oe)||(Ue.owner??"").toLowerCase().includes(oe)||(Ue.campaign_type_name??"").toLowerCase().includes(oe)||(Ue.org_unit_name??"").toLowerCase().includes(oe))}return W&&(be=be.filter(oe=>{const Ue=O.find(Qe=>String(Qe.id)===W);return Ue?oe.status_name===Ue.label:!1})),L&&(be=be.filter(oe=>{const Ue=C.find(Qe=>String(Qe.id)===L);return Ue?oe.campaign_type_name===Ue.label:!1})),be.sort((oe,Ue)=>{const Qe=oe[R],lt=Ue[R];let tt=0;return Qe==null&&lt==null?tt=0:Qe==null?tt=1:lt==null?tt=-1:typeof Qe=="number"&&typeof lt=="number"?tt=Qe-lt:tt=String(Qe).localeCompare(String(lt),"pl"),F==="asc"?tt:-tt}),be},[t,U,W,L,O,C,R,F]),_e=m.useMemo(()=>{const be=t.length,oe=t.filter(ht=>n3(ht.status_name)).length,Ue=t.filter(ht=>r3(ht.status_name)).length,lt=Object.values(w).flat().filter(ht=>ht.completion_rate!=null),tt=lt.length>0?(lt.reduce((ht,xt)=>ht+(xt.completion_rate??0),0)/lt.length).toFixed(1):"";return{total:be,active:oe,completed:Ue,avgCompletion:tt}},[t,w]),Se=({field:be,label:oe})=>e.jsxs("th",{style:{cursor:"pointer",userSelect:"none",whiteSpace:"nowrap"},onClick:()=>ie(be),children:[oe,R===be&&e.jsx("span",{style:{marginLeft:4,fontSize:9,opacity:.7},children:F==="asc"?"":""})]}),Ve=be=>x&&!be?{border:i3,boxShadow:s3}:{};return e.jsxs("div",{children:[e.jsxs("div",{className:"grid-4",children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--blue)"},children:_e.total}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Kampanii ogolnie"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:_e.active>0?"#2563eb":"var(--text-muted)"},children:_e.active}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Aktywnych / W trakcie"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:_e.completed>0?"#16a34a":"var(--text-muted)"},children:_e.completed}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zakonczonych"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsxs("div",{style:{fontSize:28,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:"var(--purple)"},children:[_e.avgCompletion,_e.avgCompletion!==""?"%":""]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Sredni % ukonczenia"})]})]}),o&&e.jsxs("div",{className:"card",style:{background:"#3a1a1a",borderColor:"#e74c3c",marginBottom:16,padding:16},children:[e.jsx("strong",{style:{color:"#e74c3c"},children:"Blad:"}),e.jsx("pre",{style:{margin:"8px 0 0",fontSize:12,color:"#ff6b6b",whiteSpace:"pre-wrap"},children:o})]}),e.jsx(ma,{filteredCount:fe.length,totalCount:t.length,unitLabel:"kampanii",search:U,onSearchChange:A,searchPlaceholder:"Szukaj (tytul, ref, wlasciciel)...",showFilters:ee,onToggleFilters:()=>me(be=>!be),hasActiveFilters:ve,onClearFilters:je,columns:Sm,visibleColumns:ne,onToggleColumn:P,data:fe,exportFilename:"awareness_campaigns",primaryLabel:"Nowa kampania",onPrimaryAction:()=>{I(),h(!0)}}),ee&&e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12,display:"flex",gap:12,flexWrap:"wrap"},children:[e.jsxs("select",{className:"form-control",style:{width:180,padding:"5px 10px",fontSize:12},value:W,onChange:be=>J(be.target.value),children:[e.jsx("option",{value:"",children:"Wszystkie statusy"}),O.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]}),e.jsxs("select",{className:"form-control",style:{width:180,padding:"5px 10px",fontSize:12},value:L,onChange:be=>H(be.target.value),children:[e.jsx("option",{value:"",children:"Wszystkie typy"}),C.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:_?"1fr 420px":"1fr",gap:14},children:[e.jsx("div",{className:"card",style:{padding:0,overflow:"hidden"},children:a?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Ladowanie..."}):fe.length===0?e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:t.length===0?"Brak kampanii w systemie.":"Brak kampanii pasujacych do filtrow."}):e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[ne.has("ref_id")&&e.jsx(Se,{field:"ref_id",label:"Ref"}),ne.has("title")&&e.jsx(Se,{field:"title",label:"Tytul"}),ne.has("campaign_type_name")&&e.jsx(Se,{field:"campaign_type_name",label:"Typ"}),ne.has("org_unit_name")&&e.jsx(Se,{field:"org_unit_name",label:"Jednostka"}),ne.has("status_name")&&e.jsx(Se,{field:"status_name",label:"Status"}),ne.has("target_audience_count")&&e.jsx(Se,{field:"target_audience_count",label:"Uczestnicy"}),ne.has("start_date")&&e.jsx(Se,{field:"start_date",label:"Start"}),ne.has("end_date")&&e.jsx(Se,{field:"end_date",label:"Koniec"}),ne.has("owner")&&e.jsx(Se,{field:"owner",label:"Wlasciciel"}),e.jsx("th",{style:{width:70},children:"Wyniki"})]})}),e.jsx("tbody",{children:fe.map(be=>e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{cursor:"pointer",borderLeft:`3px solid ${Yd(be.status_name)}`,background:_?.id===be.id?"var(--bg-card-hover)":void 0},onClick:()=>E(_?.id===be.id?null:be),children:[ne.has("ref_id")&&e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:be.ref_id??""}),ne.has("title")&&e.jsx("td",{style:{fontWeight:500},children:be.title}),ne.has("campaign_type_name")&&e.jsx("td",{style:{fontSize:12},children:be.campaign_type_name??""}),ne.has("org_unit_name")&&e.jsx("td",{style:{fontSize:12},children:be.org_unit_name??"Cala org."}),ne.has("status_name")&&e.jsx("td",{children:be.status_name?e.jsx("span",{className:"score-badge",style:{background:_m(be.status_name),color:Yd(be.status_name)},children:be.status_name}):""}),ne.has("target_audience_count")&&e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:be.target_audience_count}),ne.has("start_date")&&e.jsx("td",{style:{fontSize:12},children:be.start_date??""}),ne.has("end_date")&&e.jsx("td",{style:{fontSize:12},children:be.end_date??""}),ne.has("owner")&&e.jsx("td",{style:{fontSize:12},children:be.owner??""}),e.jsx("td",{onClick:oe=>oe.stopPropagation(),children:e.jsx("button",{className:"btn btn-sm",onClick:()=>de(be.id),style:{fontSize:11},children:y===be.id?"Zwin":"Pokaz"})})]},be.id),y===be.id&&w[be.id]&&e.jsx("tr",{children:e.jsx("td",{colSpan:Sm.length+1,style:{padding:0},children:e.jsxs("div",{style:{margin:"8px 12px 12px",borderRadius:"var(--radius-sm)",overflow:"hidden",border:"1px solid var(--border)"},children:[e.jsxs("div",{style:{padding:"8px 12px",fontSize:11,fontWeight:600,color:"var(--blue)",background:"rgba(59,130,246,0.06)",textTransform:"uppercase",letterSpacing:"0.05em"},children:["Wyniki kampanii: ",be.title]}),w[be.id].length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:"Brak wynikow"}):e.jsxs("table",{className:"data-table",style:{margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Jednostka"}),e.jsx("th",{children:"Uczestnicy"}),e.jsx("th",{children:"Ukonczone"}),e.jsx("th",{children:"Nie zdalo"}),e.jsx("th",{children:"Zglosilo"}),e.jsx("th",{children:"Ukonczenie %"}),e.jsx("th",{children:"Click rate %"}),e.jsx("th",{children:"Report rate %"}),e.jsx("th",{children:"Sr. wynik"})]})}),e.jsx("tbody",{children:w[be.id].map(oe=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:12},children:oe.org_unit_name??""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.participants_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.completed_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,color:oe.failed_count>0?"var(--red)":void 0},children:oe.failed_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.reported_count}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.completion_rate!=null?e.jsxs("span",{style:{color:oe.completion_rate>=80?"#16a34a":oe.completion_rate>=50?"#ca8a04":"var(--red)"},children:[oe.completion_rate,"%"]}):""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,color:oe.click_rate!=null&&oe.click_rate>20?"#dc2626":void 0},children:oe.click_rate!=null?`${oe.click_rate}%`:""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12},children:oe.report_rate!=null?`${oe.report_rate}%`:""}),e.jsx("td",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:12,fontWeight:600},children:oe.avg_score!=null?oe.avg_score:""})]},oe.id))})]})]})})},`res-${be.id}`)]}))})]})}),_&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly kampanii"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>E(null),children:""})]}),_.status_name&&e.jsx("div",{style:{textAlign:"center",marginBottom:16},children:e.jsx("span",{className:"score-badge",style:{background:_m(_.status_name),color:Yd(_.status_name),fontSize:14,padding:"6px 16px"},children:_.status_name})}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(ps,{number:"",label:"Dane kampanii"}),e.jsx(Pn,{label:"Ref",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:_.ref_id})}),e.jsx(Pn,{label:"Tytul",value:e.jsx("strong",{children:_.title})}),e.jsx(Pn,{label:"Typ",value:_.campaign_type_name}),e.jsx(Pn,{label:"Jednostka",value:_.org_unit_name??"Cala org."}),e.jsx(ps,{number:"",label:"Uczestnicy i daty"}),e.jsx(Pn,{label:"Uczestnicy",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:_.target_audience_count})}),e.jsx(Pn,{label:"Data startu",value:_.start_date}),e.jsx(Pn,{label:"Data konca",value:_.end_date}),e.jsx(Pn,{label:"Wlasciciel",value:_.owner}),e.jsx(ps,{number:"",label:"Status"}),e.jsx(Pn,{label:"Status",value:_.status_name?e.jsx("span",{className:"score-badge",style:{background:_m(_.status_name),color:Yd(_.status_name)},children:_.status_name}):""}),e.jsx(Pn,{label:"Aktywna",value:_.is_active?"Tak":"Nie",color:_.is_active?"#16a34a":"var(--text-muted)"}),w[_.id]&&w[_.id].length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ps,{number:"",label:"Podsumowanie wynikow"}),w[_.id].map(be=>e.jsxs("div",{style:{marginBottom:8,padding:"6px 8px",borderRadius:6,background:"var(--bg-inset)"},children:[e.jsx("div",{style:{fontWeight:500,marginBottom:2},children:be.org_unit_name??"Cala org."}),e.jsx(Pn,{label:"Ukonczenie",value:be.completion_rate!=null?`${be.completion_rate}%`:"",color:be.completion_rate!=null&&be.completion_rate>=80?"#16a34a":be.completion_rate!=null&&be.completion_rate<50?"var(--red)":void 0}),e.jsx(Pn,{label:"Click rate",value:be.click_rate!=null?`${be.click_rate}%`:"",color:be.click_rate!=null&&be.click_rate>20?"#dc2626":void 0}),e.jsx(Pn,{label:"Sr. wynik",value:be.avg_score!=null?String(be.avg_score):""})]},be.id))]})]})]})]}),e.jsxs(gt,{open:u,onClose:()=>h(!1),title:"Nowa kampania awareness",wide:!0,children:[e.jsx(ps,{number:"",label:"Dane podstawowe"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"span 3"},children:[e.jsx("label",{children:"Tytul *"}),e.jsx("input",{className:"form-control",style:Ve(!!z.title),value:z.title,onChange:be=>k({...z,title:be.target.value}),placeholder:"Nazwa kampanii"}),x&&!z.title&&e.jsx("div",{style:{fontSize:11,color:"var(--red)",marginTop:2},children:"Pole wymagane"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ kampanii"}),e.jsxs("select",{className:"form-control",value:z.campaign_type_id??"",onChange:be=>k({...z,campaign_type_id:be.target.value?Number(be.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),C.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka org."}),e.jsx(jn,{tree:G,value:z.org_unit_id,onChange:be=>k({...z,org_unit_id:be}),placeholder:"-- cala org. --",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wlasciciel"}),e.jsx("input",{className:"form-control",value:z.owner,onChange:be=>k({...z,owner:be.target.value}),placeholder:"Osoba odpowiedzialna"})]})]}),e.jsx(ps,{number:"",label:"Uczestnicy i terminy"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Liczba uczestnikow"}),e.jsx("input",{className:"form-control",type:"number",min:0,value:z.target_audience_count,onChange:be=>k({...z,target_audience_count:Number(be.target.value)})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data rozpoczecia"}),e.jsx("input",{className:"form-control",type:"date",value:z.start_date,onChange:be=>k({...z,start_date:be.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data konca"}),e.jsx("input",{className:"form-control",type:"date",value:z.end_date,onChange:be=>k({...z,end_date:be.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"form-control",value:z.status_id??"",onChange:be=>k({...z,status_id:be.target.value?Number(be.target.value):null}),children:[e.jsx("option",{value:"",children:"-- brak --"}),O.map(be=>e.jsx("option",{value:be.id,children:be.label},be.id))]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"URL materialow"}),e.jsx("input",{className:"form-control",value:z.content_url,onChange:be=>k({...z,content_url:be.target.value}),placeholder:"https://..."})]})]}),e.jsx(ps,{number:"",label:"Opis"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis kampanii"}),e.jsx("textarea",{className:"form-control",rows:3,value:z.description,onChange:be=>k({...z,description:be.target.value}),placeholder:"Opcjonalny opis kampanii..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>h(!1),children:"Anuluj"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:f,onClick:he,children:f?"Zapisywanie...":"Utworz kampanie"})]})]})]})}const Jd="";function hl(t){return t>=80?"#16a34a":t>=60?"#ca8a04":t>=40?"#ea580c":"#dc2626"}function o3(t){return t>=80?"#dcfce7":t>=60?"#fef9c3":t>=40?"#fed7aa":"#fecaca"}function c3(){const[t,r]=m.useState(null),[a,s]=m.useState([]),[o,d]=m.useState(null),[u,h]=m.useState(!0),[f,p]=m.useState("dashboard");m.useEffect(()=>{x()},[]);async function x(){h(!0);try{const[y,S,w]=await Promise.all([fetch(`${Jd}/api/v1/security-score`),fetch(`${Jd}/api/v1/security-score/history?limit=30`),fetch(`${Jd}/api/v1/security-score/methodology`)]);y.ok&&r(await y.json()),S.ok&&s(await S.json()),w.ok&&d(await w.json())}catch{}h(!1)}async function j(){(await fetch(`${Jd}/api/v1/security-score/snapshot`,{method:"POST"})).ok&&x()}return u?e.jsx("div",{className:"page-container",children:e.jsx("p",{children:"adowanie..."})}):e.jsxs("div",{className:"page-container",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Security Score"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:`btn ${f==="dashboard"?"btn-primary":""}`,onClick:()=>p("dashboard"),children:"Dashboard"}),e.jsx("button",{className:`btn ${f==="methodology"?"btn-primary":""}`,onClick:()=>p("methodology"),children:"Metodologia"}),e.jsx("button",{className:`btn ${f==="history"?"btn-primary":""}`,onClick:()=>p("history"),children:"Historia"}),e.jsx("button",{className:"btn",onClick:j,title:"Wymu snapshot",children:"Snapshot"})]})]}),f==="dashboard"&&t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",style:{padding:24,textAlign:"center",marginBottom:16},children:[e.jsxs("div",{style:{width:180,height:180,borderRadius:"50%",border:`8px solid ${t.color}`,backgroundColor:o3(t.total_score),display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"0 auto"},children:[e.jsx("div",{style:{fontSize:48,fontWeight:700,color:t.color},children:t.total_score}),e.jsx("div",{style:{fontSize:14,color:t.color,fontWeight:600},children:t.rating})]}),e.jsxs("div",{style:{marginTop:12,color:"#6b7280",fontSize:13},children:["Config v",t.config_version]})]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsx("h3",{style:{marginBottom:12},children:"Rozbicie na filary"}),t.pillars.sort((y,S)=>S.weight-y.weight).map(y=>e.jsxs("div",{style:{marginBottom:10},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4,fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:y.name})," (",y.weight,"%)"]}),e.jsx("span",{style:{color:hl(y.score),fontWeight:600},children:y.score})]}),e.jsx("div",{style:{background:"#e5e7eb",borderRadius:4,height:20,overflow:"hidden"},children:e.jsx("div",{style:{width:`${y.score}%`,height:"100%",background:hl(y.score),borderRadius:4,transition:"width 0.5s ease"}})})]},y.name))]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{marginBottom:12},children:"Najsabsze filary"}),t.pillars.sort((y,S)=>y.score-S.score).slice(0,3).map((y,S)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",marginBottom:4,background:S===0?"#fef2f2":S===1?"#fffbeb":"#f0f9ff",borderRadius:6,alignItems:"center"},children:[e.jsxs("span",{children:[e.jsxs("strong",{children:["#",S+1]})," ",y.name,e.jsxs("span",{style:{color:"#9ca3af",marginLeft:8,fontSize:12},children:["waga: ",y.weight,"%"]})]}),e.jsx("span",{style:{color:hl(y.score),fontWeight:700,fontSize:18},children:y.score})]},y.name))]})]}),f==="methodology"&&o&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{children:o.title}),e.jsxs("p",{style:{color:"#6b7280",marginBottom:16},children:[o.scale_description,e.jsx("br",{}),"Config v",o.config_version," | Wynik: ",e.jsx("strong",{style:{color:hl(o.total_score)},children:o.total_score})," (",o.rating,")"]}),o.pillars.map(y=>e.jsxs("div",{className:"card",style:{padding:12,marginBottom:12,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4},children:[e.jsx("strong",{children:y.name}),e.jsxs("span",{style:{color:hl(y.current_score),fontWeight:600},children:[y.current_score," (",y.weight,"%)"]})]}),e.jsx("p",{style:{fontSize:13,color:"#6b7280",marginBottom:4},children:y.description}),e.jsxs("p",{style:{fontSize:12,color:"#9ca3af"},children:["rdo: ",y.data_source,e.jsx("br",{}),"Formua: ",e.jsx("code",{children:y.formula})]})]},y.name))]}),f==="history"&&e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Risk"}),e.jsx("th",{children:"Vuln"}),e.jsx("th",{children:"Inc"}),e.jsx("th",{children:"Exc"}),e.jsx("th",{children:"Matur."}),e.jsx("th",{children:"Audit"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"TPRM"}),e.jsx("th",{children:"Policy"}),e.jsx("th",{children:"Aware."}),e.jsx("th",{children:"Trigger"})]})}),e.jsxs("tbody",{children:[a.map(y=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontSize:12},children:new Date(y.snapshot_date).toLocaleString("pl-PL")}),e.jsx("td",{style:{color:hl(y.total_score),fontWeight:700},children:y.total_score}),e.jsx("td",{children:y.risk_score??""}),e.jsx("td",{children:y.vulnerability_score??""}),e.jsx("td",{children:y.incident_score??""}),e.jsx("td",{children:y.exception_score??""}),e.jsx("td",{children:y.maturity_score??""}),e.jsx("td",{children:y.audit_score??""}),e.jsx("td",{children:y.asset_score??""}),e.jsx("td",{children:y.tprm_score??""}),e.jsx("td",{children:y.policy_score??""}),e.jsx("td",{children:y.awareness_score??""}),e.jsx("td",{style:{fontSize:11},children:y.triggered_by??""})]},y.id)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:13,style:{textAlign:"center",color:"#9ca3af"},children:"Brak snapshotw"})})]})]})]})}const d3=[{key:"info",label:"Informacje",icon:""},{key:"issues",label:"Czynniki",icon:""},{key:"obligations",label:"Zobowizania",icon:""},{key:"stakeholders",label:"Interesariusze",icon:""},{key:"scope",label:"Zakres SZ",icon:""},{key:"risk_appetite",label:"Apetyt na ryzyko",icon:""},{key:"reviews",label:"Przegldy",icon:""}];function hu(t){if(!t)return"var(--text-muted)";switch(t){case"approved":return"var(--green)";case"in_review":return"var(--blue)";case"draft":return"var(--orange)";case"needs_update":return"var(--red)";default:return"var(--text-muted)"}}function mu(t){if(!t)return"";switch(t){case"approved":return"Zatwierdzony";case"in_review":return"W przegldzie";case"draft":return"Szkic";case"needs_update":return"Wymaga aktualizacji";default:return t}}function ml(t){switch(t){case"high":return"var(--red)";case"medium":return"var(--orange)";case"low":return"var(--green)";default:return"var(--text-muted)"}}function gs(t){switch(t){case"high":return"Wysoka";case"medium":return"rednia";case"low":return"Niska";default:return""}}function Iv(t){switch(t){case"positive":return"Pozytywny";case"negative":return"Negatywny";case"neutral":return"Neutralny";default:return""}}function Pv(t){switch(t){case"compliant":return"var(--green)";case"partially_compliant":return"var(--orange)";case"non_compliant":return"var(--red)";default:return"var(--text-muted)"}}function Wv(t){switch(t){case"compliant":return"Zgodny";case"partially_compliant":return"Czciowo zgodny";case"non_compliant":return"Niezgodny";case"not_assessed":return"Nieoceniony";default:return""}}function St({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8,padding:"2px 0"},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}const u3="1px solid var(--red)",f3="0 0 0 3px var(--red-dim)";function kb({node:t,depth:r,selectedId:a,onSelect:s,overviews:o}){const[d,u]=m.useState(!1),h=t.children.length>0,f=a===t.id,p=o.get(t.id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>s(t.id),style:{display:"flex",alignItems:"center",gap:6,padding:"6px 10px",paddingLeft:r*20+10,cursor:"pointer",background:f?"var(--blue-dim)":"transparent",borderLeft:f?"3px solid var(--blue)":"3px solid transparent",fontSize:13,transition:"background 0.15s"},onMouseEnter:x=>{f||(x.currentTarget.style.background="var(--bg-card-hover)")},onMouseLeave:x=>{f||(x.currentTarget.style.background="transparent")},children:[h&&e.jsx("span",{onClick:x=>{x.stopPropagation(),u(!d)},style:{cursor:"pointer",fontSize:10,width:14,textAlign:"center",color:"var(--text-muted)",userSelect:"none"},children:d?"":""}),!h&&e.jsx("span",{style:{width:14}}),e.jsx("span",{style:{fontWeight:r===0?600:400},children:t.name}),e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)",marginLeft:4},children:t.symbol}),p&&e.jsxs("span",{style:{marginLeft:"auto",display:"flex",gap:4,alignItems:"center",fontSize:11},children:[p.context_status&&e.jsx("span",{style:{padding:"1px 6px",borderRadius:4,fontSize:10,background:p.context_status==="approved"?"var(--green-dim)":p.context_status==="draft"?"var(--orange-dim)":"var(--blue-dim)",color:hu(p.context_status)},children:mu(p.context_status)}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[p.issues_count,"c ",p.obligations_count,"z ",p.stakeholders_count,"i"]})]})]}),!d&&h&&t.children.map(x=>e.jsx(kb,{node:x,depth:r+1,selectedId:a,onSelect:s,overviews:o},x.id))]})}function h3(){const t=[{key:"title",header:"Tytu"},{key:"issue_type",header:"Typ",format:V=>V.issue_type==="internal"?"Wewntrzny":"Zewntrzny"},{key:"category_name",header:"Kategoria",format:V=>V.category_name??""},{key:"impact_level",header:"Wpyw",format:V=>Iv(V.impact_level)},{key:"relevance",header:"Istotno",format:V=>gs(V.relevance)},{key:"org_unit_name",header:"Jednostka",format:V=>V.org_unit_name??""},{key:"inherited",header:"rdo",format:V=>V.inherited?"Odziedziczony":"Wasny"}],r=[{key:"custom_name",header:"Nazwa",format:V=>V.custom_name??V.regulation_name??""},{key:"obligation_type",header:"Typ"},{key:"compliance_status",header:"Status zgodnoci",format:V=>Wv(V.compliance_status)},{key:"responsible_person",header:"Odpowiedzialny",format:V=>V.responsible_person??""},{key:"effective_from",header:"Obowizuje od",format:V=>V.effective_from??""},{key:"org_unit_name",header:"Jednostka",format:V=>V.org_unit_name??""},{key:"inherited",header:"rdo",format:V=>V.inherited?"Odziedziczony":"Wasny"}],a=[{key:"name",header:"Nazwa"},{key:"stakeholder_type",header:"Typ",format:V=>V.stakeholder_type==="internal"?"Wewntrzny":"Zewntrzny"},{key:"category_name",header:"Kategoria",format:V=>V.category_name??""},{key:"influence_level",header:"Wpyw",format:V=>gs(V.influence_level)},{key:"relevance",header:"Istotno",format:V=>gs(V.relevance)},{key:"org_unit_name",header:"Jednostka",format:V=>V.org_unit_name??""},{key:"inherited",header:"rdo",format:V=>V.inherited?"Odziedziczony":"Wasny"}],s=[{key:"review_date",header:"Data przegldu"},{key:"reviewer",header:"Przegldajcy"},{key:"review_type",header:"Typ",format:V=>V.review_type==="scheduled"?"Planowany":V.review_type==="triggered"?"Wyzwolony":"Pocztkowy"},{key:"approved_by",header:"Zatwierdzony przez",format:V=>V.approved_by??""},{key:"next_review_date",header:"Nastpny przegld",format:V=>V.next_review_date??""}],{visible:o,toggle:d}=da(t,"ctx-issues"),{visible:u,toggle:h}=da(r,"ctx-obligations"),{visible:f,toggle:p}=da(a,"ctx-stakeholders"),{visible:x,toggle:j}=da(s,"ctx-reviews"),[y,S]=m.useState([]),[w,b]=m.useState(null),[_,E]=m.useState("info"),[C,N]=m.useState(!0),[O,Q]=m.useState(!0),[G,M]=m.useState(null),[U,A]=m.useState(new Map),[R,Z]=m.useState(null),[F,q]=m.useState(null),[ee,me]=m.useState([]),[W,J]=m.useState([]),[L,H]=m.useState([]),[ne,P]=m.useState([]),[T,z]=m.useState(null),[k,I]=m.useState([]),[D,de]=m.useState(""),[he,ie]=m.useState(""),[ve,je]=m.useState(!1),[fe,_e]=m.useState(!1),[Se,Ve]=m.useState(!1),[be,oe]=m.useState(!1),[Ue,Qe]=m.useState(!1),[lt,tt]=m.useState(!1),[ht,xt]=m.useState(null),[qe,Nt]=m.useState(null),[st,_t]=m.useState(null),[zt,It]=m.useState(null),[va,rt]=m.useState(null),[oa,ca]=m.useState(null),[ze,et]=m.useState([]),[it,Be]=m.useState(!1),[at,nt]=m.useState(!1),[ut,ta]=m.useState(!1),[Pt,Tt]=m.useState({}),[xe,Ie]=m.useState(null),[mt,Oe]=m.useState(!1),[ct,At]=m.useState({}),[za,ja]=m.useState(!1),[Et,ge]=m.useState({}),[Ft,ga]=m.useState([]),[Y,se]=m.useState(!1),[te,ae]=m.useState({}),re=m.useMemo(()=>{function V(Ge,Ca){for(const ua of Ge){if(ua.id===Ca)return ua;const Ha=V(ua.children,Ca);if(Ha)return Ha}return null}return w?V(y,w):null},[y,w]);m.useEffect(()=>{Q(!0),le.get("/api/v1/org-units/tree").then(V=>{S(V),V.length>0&&!w&&b(V[0].id),Ce(V)}).catch(()=>{}).finally(()=>Q(!1)),le.get("/api/v1/dictionaries/by-code/management_system").then(V=>ga(V.entries??[])).catch(()=>{})},[]);function ce(V){const Ge=[];for(const Ca of V)Ge.push(Ca.id),Ge.push(...ce(Ca.children));return Ge}async function Ce(V){const Ge=ce(V),Ca=new Map;await Promise.all(Ge.map(async ua=>{try{const Ha=await le.get(`/api/v1/org-units/${ua}/context`);Ca.set(ua,Ha)}catch{}})),A(Ca)}m.useEffect(()=>{w&&De(w)},[w]);async function De(V){N(!0),M(null),xt(null),Nt(null),_t(null);try{const Ge=`/api/v1/org-units/${V}/context`,[Ca,ua,Ha,pr,zc,Es,Fs,Cc]=await Promise.all([le.get(Ge),le.get(Ge+"/general"),le.get(Ge+"/issues"),le.get(Ge+"/obligations"),le.get(Ge+"/stakeholders"),le.get(Ge+"/scope").catch(()=>[]),le.get(Ge+"/risk-appetite").catch(()=>null),le.get(Ge+"/reviews")]);Z(Ca),q(ua),me(Ha),J(pr),H(zc),P(Es??[]),z(Fs),I(Cc),A(dn=>{const Cr=new Map(dn);return Cr.set(V,Ca),Cr})}catch(Ge){M(String(Ge))}N(!1)}const Ne=async()=>{if(ze.length===0)try{const V=await le.get("/api/v1/org-levels");et(V)}catch{}Be(!0)};async function Fe(V){V.preventDefault(),nt(!0);const Ge=new FormData(V.currentTarget),Ca={parent_id:xe,level_id:Number(Ge.get("level_id")),name:Ge.get("name"),symbol:Ge.get("symbol"),owner:Ge.get("owner")||null,security_contact:Ge.get("security_contact")||null,it_coordinator:Ge.get("it_coordinator")||null,description:Ge.get("description")||null};try{await le.post("/api/v1/org-units",Ca),Be(!1);const ua=await le.get("/api/v1/org-units/tree");S(ua),Ce(ua)}catch(ua){M("Bd zapisu: "+ua)}nt(!1)}async function K(){if(re){nt(!0);try{await le.put(`/api/v1/org-units/${re.id}`,Pt),ta(!1);const V=await le.get("/api/v1/org-units/tree");S(V),Ce(V),De(re.id)}catch(V){M("Bd zapisu: "+V)}nt(!1)}}async function ue(){if(re&&confirm(`Dezaktywowa jednostk "${re.name}"?`))try{await le.delete(`/api/v1/org-units/${re.id}`),b(null);const V=await le.get("/api/v1/org-units/tree");S(V),Ce(V)}catch(V){M("Bd: "+V)}}const ke={issue_type:"internal",title:"",description:"",impact_level:"",relevance:"",response_action:"",review_date:""},[Te,Me]=m.useState(ke);async function Ye(){if(!w||!Te.title){tt(!0);return}Qe(!0);try{const V={...Te};V.impact_level||delete V.impact_level,V.relevance||delete V.relevance,V.review_date||delete V.review_date,await le.post(`/api/v1/org-units/${w}/context/issues`,V),je(!1),Me({...ke}),tt(!1),De(w)}catch(V){M(String(V))}Qe(!1)}const $e={obligation_type:"legal",custom_name:"",description:"",responsible_person:"",compliance_status:"not_assessed",effective_from:""},[yt,jt]=m.useState($e);async function Kt(){if(!w||!yt.custom_name){tt(!0);return}Qe(!0);try{const V={...yt};V.effective_from||delete V.effective_from,await le.post(`/api/v1/org-units/${w}/context/obligations`,V),_e(!1),jt({...$e}),tt(!1),De(w)}catch(V){M(String(V))}Qe(!1)}const cn={stakeholder_type:"internal",name:"",description:"",needs_expectations:"",requirements_type:"",influence_level:"",relevance:""},[sa,Pa]=m.useState(cn);async function qn(){if(!w||!sa.name){tt(!0);return}Qe(!0);try{const V={...sa};V.requirements_type||delete V.requirements_type,V.influence_level||delete V.influence_level,V.relevance||delete V.relevance,await le.post(`/api/v1/org-units/${w}/context/stakeholders`,V),Ve(!1),Pa({...cn}),tt(!1),De(w)}catch(V){M(String(V))}Qe(!1)}const ui={review_date:"",reviewer:"",review_type:"scheduled",changes_summary:"",next_review_date:""},[Zt,ur]=m.useState(ui);async function fr(){if(!w||!Zt.review_date||!Zt.reviewer){tt(!0);return}Qe(!0);try{const V={...Zt};V.next_review_date||delete V.next_review_date,await le.post(`/api/v1/org-units/${w}/context/reviews`,V),oe(!1),ur({...ui}),tt(!1),De(w)}catch(V){M(String(V))}Qe(!1)}async function bn(){if(w){Qe(!0);try{await le.put(`/api/v1/org-units/${w}/context/general`,ct),Oe(!1),De(w)}catch(V){M(String(V))}Qe(!1)}}async function vc(){if(w){Qe(!0);try{await le.post(`/api/v1/org-units/${w}/context/scope`,Et),ja(!1),De(w)}catch(V){M(String(V))}Qe(!1)}}async function Vu(){if(w){Qe(!0);try{await le.post(`/api/v1/org-units/${w}/context/risk-appetite`,te),se(!1),De(w)}catch(V){M(String(V))}Qe(!1)}}async function Fl(V){if(!w||!Te.title){tt(!0);return}Qe(!0);try{const Ge={...Te};Ge.impact_level||delete Ge.impact_level,Ge.relevance||delete Ge.relevance,Ge.review_date||delete Ge.review_date,await le.put(`/api/v1/org-units/${w}/context/issues/${V}`,Ge),It(null),je(!1),Me({...ke}),tt(!1),De(w)}catch(Ge){M(String(Ge))}Qe(!1)}async function jc(V){if(!w||!yt.custom_name){tt(!0);return}Qe(!0);try{const Ge={...yt};Ge.effective_from||delete Ge.effective_from,await le.put(`/api/v1/org-units/${w}/context/obligations/${V}`,Ge),rt(null),_e(!1),jt({...$e}),tt(!1),De(w)}catch(Ge){M(String(Ge))}Qe(!1)}async function Ts(V){if(!w||!sa.name){tt(!0);return}Qe(!0);try{const Ge={...sa};Ge.requirements_type||delete Ge.requirements_type,Ge.influence_level||delete Ge.influence_level,Ge.relevance||delete Ge.relevance,await le.put(`/api/v1/org-units/${w}/context/stakeholders/${V}`,Ge),ca(null),Ve(!1),Pa({...cn}),tt(!1),De(w)}catch(Ge){M(String(Ge))}Qe(!1)}async function Zu(V){w&&(await le.delete(`/api/v1/org-units/${w}/context/issues/${V}`),xt(null),De(w))}async function _n(V){w&&(await le.delete(`/api/v1/org-units/${w}/context/obligations/${V}`),Nt(null),De(w))}async function Rl(V){w&&(await le.delete(`/api/v1/org-units/${w}/context/stakeholders/${V}`),_t(null),De(w))}function bc(V){It(V.id),Me({issue_type:V.issue_type,title:V.title,description:V.description??"",impact_level:V.impact_level??"",relevance:V.relevance??"",response_action:V.response_action??"",review_date:V.review_date??""}),je(!0)}function Bl(V){rt(V.id),jt({obligation_type:V.obligation_type,custom_name:V.custom_name??"",description:V.description??"",responsible_person:V.responsible_person??"",compliance_status:V.compliance_status??"not_assessed",effective_from:V.effective_from??""}),_e(!0)}function fi(V){ca(V.id),Pa({stakeholder_type:V.stakeholder_type,name:V.name,description:V.description??"",needs_expectations:V.needs_expectations??"",requirements_type:V.requirements_type??"",influence_level:V.influence_level??"",relevance:V.relevance??""}),Ve(!0)}const _c=m.useMemo(()=>{if(!he)return y;const V=he.toLowerCase();function Ge(Ca){const ua=[];for(const Ha of Ca){const pr=Ge(Ha.children);(Ha.name.toLowerCase().includes(V)||Ha.symbol.toLowerCase().includes(V)||pr.length>0)&&ua.push({...Ha,children:pr.length>0?pr:Ha.children.length>0&&Ha.name.toLowerCase().includes(V)?Ha.children:pr})}return ua}return Ge(y)},[y,he]),Yi=m.useMemo(()=>{if(!D)return ee;const V=D.toLowerCase();return ee.filter(Ge=>Ge.title.toLowerCase().includes(V)||(Ge.description??"").toLowerCase().includes(V))},[ee,D]),hr=m.useMemo(()=>{if(!D)return W;const V=D.toLowerCase();return W.filter(Ge=>(Ge.custom_name??"").toLowerCase().includes(V)||(Ge.description??"").toLowerCase().includes(V))},[W,D]),Ns=m.useMemo(()=>{if(!D)return L;const V=D.toLowerCase();return L.filter(Ge=>Ge.name.toLowerCase().includes(V)||(Ge.description??"").toLowerCase().includes(V))},[L,D]),hi=V=>lt&&!V?{border:u3,boxShadow:f3}:{};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:0,height:"calc(100vh - 60px)"},children:[e.jsx("div",{style:{padding:"12px 16px 8px",borderBottom:"1px solid var(--border)"},children:e.jsxs("h2",{style:{margin:0},children:["Kontekst Organizacyjny ",e.jsx("span",{style:{fontSize:14,color:"var(--text-muted)"},children:"ISO 27001 / 22301 klauzula 4"})]})}),G&&e.jsx("div",{className:"card",style:{background:"var(--red-dim)",color:"var(--red)",padding:12,margin:"8px 16px 0"},children:G}),e.jsxs("div",{style:{display:"flex",flex:1,minHeight:0},children:[e.jsxs("div",{style:{width:320,minWidth:280,maxWidth:400,borderRight:"1px solid var(--border)",overflowY:"auto",background:"var(--bg-card)"},children:[e.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsx("span",{style:{fontSize:12,fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:.5},children:"Struktura organizacyjna"}),e.jsx("button",{className:"btn btn-sm btn-primary",style:{fontSize:11,padding:"2px 8px"},onClick:Ne,children:"+ Dodaj"})]}),e.jsx("input",{className:"form-control",placeholder:"Szukaj jednostki...",value:he,onChange:V=>ie(V.target.value),style:{fontSize:12,padding:"4px 8px"}})]}),O?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"adowanie..."}):y.length===0?e.jsx("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:13},children:"Brak jednostek"}):e.jsx("div",{style:{padding:"4px 0"},children:_c.map(V=>e.jsx(kb,{node:V,depth:0,selectedId:w,onSelect:b,overviews:U},V.id))})]}),e.jsx("div",{style:{flex:1,minWidth:0,overflowY:"auto",display:"flex",flexDirection:"column"},children:w?e.jsxs(e.Fragment,{children:[re&&e.jsxs("div",{style:{padding:"10px 16px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:15},children:re.name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[re.level_name,"  ",re.symbol," ",re.owner?` ${re.owner}`:""]})]}),R&&e.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:e.jsx("span",{style:{fontSize:12,color:hu(R.context_status),fontWeight:500},children:mu(R.context_status)})})]}),e.jsx("div",{style:{display:"flex",gap:0,borderBottom:"1px solid var(--border)",padding:"0 16px",background:"var(--bg-card)"},children:d3.map(V=>e.jsxs("button",{onClick:()=>{E(V.key),de("")},style:{padding:"8px 14px",background:_===V.key?"var(--blue-dim)":"transparent",color:_===V.key?"var(--blue)":"var(--text-muted)",border:"none",borderBottom:_===V.key?"2px solid var(--blue)":"2px solid transparent",cursor:"pointer",fontWeight:_===V.key?600:400,fontSize:13},children:[V.icon," ",V.label]},V.key))}),e.jsxs("div",{style:{flex:1,padding:16,overflowY:"auto"},children:[C&&e.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:"adowanie..."}),!C&&_==="info"&&Sc(),!C&&_==="issues"&&Ol(),!C&&_==="obligations"&&Gu(),!C&&_==="stakeholders"&&Ku(),!C&&_==="scope"&&As(),!C&&_==="risk_appetite"&&mr(),!C&&_==="reviews"&&Dl()]})]}):e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:14},children:"Wybierz jednostk z drzewa po lewej stronie"})})]}),Ll(),mi(),pi(),wc(),Ml(),Ji(),kc()]});function Sc(){return re?ut?e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("h3",{style:{margin:"0 0 16px 0",fontSize:15},children:["Edycja jednostki: ",re.name]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",value:Pt.name??"",onChange:V=>Tt({...Pt,name:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Symbol *"}),e.jsx("input",{className:"form-control",value:Pt.symbol??"",onChange:V=>Tt({...Pt,symbol:V.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Waciciel biznesowy"}),e.jsx("input",{className:"form-control",value:Pt.owner??"",onChange:V=>Tt({...Pt,owner:V.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator bezpieczestwa"}),e.jsx("input",{className:"form-control",value:Pt.security_contact??"",onChange:V=>Tt({...Pt,security_contact:V.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator IT"}),e.jsx("input",{className:"form-control",value:Pt.it_coordinator??"",onChange:V=>Tt({...Pt,it_coordinator:V.target.value||null})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status"}),e.jsxs("select",{className:"form-control",value:Pt.is_active?"active":"inactive",onChange:V=>Tt({...Pt,is_active:V.target.value==="active"}),children:[e.jsx("option",{value:"active",children:"Aktywna"}),e.jsx("option",{value:"inactive",children:"Nieaktywna"})]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:Pt.description??"",onChange:V=>Tt({...Pt,description:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>ta(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:K,disabled:at,children:at?"Zapisywanie...":"Zapisz zmiany"})]})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Atrybuty jednostki"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:ue,children:"Dezaktywuj"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ta(!0),Tt({name:re.name,symbol:re.symbol,owner:re.owner,security_contact:re.security_contact,it_coordinator:re.it_coordinator??null,description:re.description,is_active:re.is_active})},children:"Edytuj"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,fontSize:13},children:[e.jsx(St,{label:"Nazwa",value:re.name}),e.jsx(St,{label:"Poziom",value:re.level_name}),e.jsx(St,{label:"Symbol",value:re.symbol}),e.jsx(St,{label:"Waciciel biznesowy",value:re.owner}),e.jsx(St,{label:"Koordynator bezpieczestwa",value:re.security_contact}),e.jsx(St,{label:"Koordynator IT",value:re.it_coordinator}),e.jsx(St,{label:"Status",value:re.is_active?"Aktywna":"Nieaktywna",color:re.is_active?"var(--green)":"var(--red)"}),re.description&&e.jsx("div",{style:{gridColumn:"span 2"},children:e.jsx(St,{label:"Opis",value:re.description})})]})]}),ne.length>0&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 10px 0",fontSize:15},children:"Zakresy Systemw Zarzdzania"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:ne.map(V=>e.jsxs("span",{onClick:()=>E("scope"),style:{padding:"4px 12px",borderRadius:12,fontSize:12,fontWeight:500,cursor:"pointer",background:V.inherited?"var(--blue-dim)":"var(--green-dim)",color:V.inherited?"var(--blue)":"var(--green)",border:`1px solid ${V.inherited?"var(--blue)":"var(--green)"}`},children:[V.management_system_name??"Zakres"," (v",V.version,")",V.inherited&&e.jsx("span",{style:{marginLeft:4,fontSize:10},children:"odz."})]},V.id))})]}),R&&e.jsxs("div",{className:"grid-4",children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status kontekstu"}),e.jsx("div",{style:{fontSize:18,fontWeight:600,color:hu(R.context_status)},children:mu(R.context_status)})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("issues"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Czynniki"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.issues_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.issues_own," w.)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("obligations"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zobowizania"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.obligations_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.obligations_own," w.)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:16,cursor:"pointer"},onClick:()=>E("stakeholders"),children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Interesariusze"}),e.jsxs("div",{style:{fontSize:18,fontWeight:600},children:[R.stakeholders_count," ",e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",R.stakeholders_own," w.)"]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[F&&e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Dane kontekstowe"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>{Oe(!0),At({headcount:F.headcount,mission_vision:F.mission_vision,key_products_services:F.key_products_services,strategic_objectives:F.strategic_objectives,key_processes_notes:F.key_processes_notes,context_status:F.context_status,context_reviewer:F.context_reviewer})},children:"Edytuj"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,fontSize:13},children:[e.jsx(St,{label:"Zatrudnienie",value:F.headcount??""}),e.jsx(St,{label:"Status",value:mu(F.context_status),color:hu(F.context_status)}),e.jsx(St,{label:"Przegldajcy",value:F.context_reviewer}),e.jsx(St,{label:"Ostatni przegld",value:F.context_review_date}),e.jsx(St,{label:"Nastpny przegld",value:F.context_next_review})]}),F.mission_vision&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Misja / Wizja"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.mission_vision})]}),F.key_products_services&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Kluczowe produkty / usugi"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.key_products_services})]}),F.strategic_objectives&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Cele strategiczne"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.strategic_objectives})]}),F.key_processes_notes&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Uwagi do kluczowych procesw"}),e.jsx("div",{style:{fontSize:13,whiteSpace:"pre-wrap"},children:F.key_processes_notes})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:16},children:R&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Zakres SZ"}),R.has_scope?e.jsxs("div",{style:{fontSize:13},children:[e.jsxs("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:["Zdefiniowany (",ne.length,")"]}),R.scope_inherited&&e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--text-muted)"},children:"(odziedziczony)"})]}):e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)"},children:"Nie zdefiniowano"})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Apetyt na ryzyko"}),R.has_risk_appetite?e.jsxs("div",{style:{fontSize:13},children:[e.jsx("span",{className:"score-badge",style:{background:"var(--green-dim)",color:"var(--green)"},children:"Zdefiniowany"}),R.risk_appetite_inherited&&e.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--text-muted)"},children:"(odziedziczony)"})]}):e.jsx("div",{style:{fontSize:13,color:"var(--text-muted)"},children:"Nie zdefiniowano"})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:15},children:"Przegldy"}),e.jsxs("div",{style:{fontSize:13},children:[e.jsx(St,{label:"Liczba przegldw",value:R.reviews_count}),e.jsx(St,{label:"Ostatni przegld",value:R.last_review_date??""}),e.jsx(St,{label:"Nastpny przegld",value:R.next_review_date??""})]})]})]})})]}),mt&&e.jsxs(gt,{open:mt,onClose:()=>Oe(!1),title:"Edytuj dane kontekstowe",wide:!0,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatrudnienie"}),e.jsx("input",{type:"number",className:"form-control",value:ct.headcount??"",onChange:V=>At({...ct,headcount:V.target.value?Number(V.target.value):null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status kontekstu"}),e.jsxs("select",{className:"form-control",value:ct.context_status??"",onChange:V=>At({...ct,context_status:V.target.value||null}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"draft",children:"Szkic"}),e.jsx("option",{value:"in_review",children:"W przegldzie"}),e.jsx("option",{value:"approved",children:"Zatwierdzony"}),e.jsx("option",{value:"needs_update",children:"Wymaga aktualizacji"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Przegldajcy"}),e.jsx("input",{className:"form-control",value:ct.context_reviewer??"",onChange:V=>At({...ct,context_reviewer:V.target.value||null})})]})]}),e.jsxs("div",{style:{marginTop:14},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Misja / Wizja"}),e.jsx("textarea",{className:"form-control",rows:3,value:ct.mission_vision??"",onChange:V=>At({...ct,mission_vision:V.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Kluczowe produkty / usugi"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.key_products_services??"",onChange:V=>At({...ct,key_products_services:V.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Cele strategiczne"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.strategic_objectives??"",onChange:V=>At({...ct,strategic_objectives:V.target.value||null})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Uwagi o kluczowych procesach"}),e.jsx("textarea",{className:"form-control",rows:2,value:ct.key_processes_notes??"",onChange:V=>At({...ct,key_processes_notes:V.target.value||null})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>Oe(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:bn,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:40},children:"Wybierz jednostk z drzewa"})}function Ol(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:t,visibleColumns:o,onToggleColumn:d,data:Yi,filteredCount:Yi.length,totalCount:ee.length,unitLabel:"czynnikw",exportFilename:"kontekst-czynniki",primaryLabel:"Dodaj czynnik",onPrimaryAction:()=>je(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:t.filter(V=>o.has(V.key)).map(V=>e.jsx("th",{children:V.header},V.key))})}),e.jsxs("tbody",{children:[Yi.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),Yi.map(V=>e.jsx("tr",{onClick:()=>xt(V),style:{cursor:"pointer",background:ht?.id===V.id?"var(--bg-card-hover)":void 0,opacity:V.inherited?.75:1},children:t.filter(Ge=>o.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="relevance"?e.jsx("span",{style:{color:ml(V.relevance)},children:Ge.format?Ge.format(V):V[Ge.key]}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:V.inherited?"var(--blue-dim)":"var(--green-dim)",color:V.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(V)}):Ge.format?Ge.format(V):V[Ge.key]},Ge.key))},V.id))]})]})]}),ht&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>xt(null),children:""})]}),e.jsx(St,{label:"Tytu",value:ht.title}),e.jsx(St,{label:"Typ",value:ht.issue_type==="internal"?"Wewntrzny":"Zewntrzny"}),e.jsx(St,{label:"Kategoria",value:ht.category_name}),e.jsx(St,{label:"Wpyw",value:Iv(ht.impact_level)}),e.jsx(St,{label:"Istotno",value:gs(ht.relevance),color:ml(ht.relevance)}),e.jsx(St,{label:"Jednostka",value:ht.org_unit_name}),e.jsx(St,{label:"rdo",value:ht.inherited?"Odziedziczony":"Wasny"}),ht.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:ht.description})]}),ht.response_action&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Dziaanie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:ht.response_action})]}),!ht.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>bc(ht),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>Zu(ht.id),children:"Dezaktywuj"})]})]})]})}function Gu(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:r,visibleColumns:u,onToggleColumn:h,data:hr,filteredCount:hr.length,totalCount:W.length,unitLabel:"zobowiza",exportFilename:"kontekst-zobowiazania",primaryLabel:"Dodaj zobowizanie",onPrimaryAction:()=>_e(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:r.filter(V=>u.has(V.key)).map(V=>e.jsx("th",{children:V.header},V.key))})}),e.jsxs("tbody",{children:[hr.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:r.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),hr.map(V=>e.jsx("tr",{onClick:()=>Nt(V),style:{cursor:"pointer",background:qe?.id===V.id?"var(--bg-card-hover)":void 0,opacity:V.inherited?.75:1},children:r.filter(Ge=>u.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="compliance_status"?e.jsx("span",{style:{color:Pv(V.compliance_status)},children:Ge.format(V)}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:V.inherited?"var(--blue-dim)":"var(--green-dim)",color:V.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(V)}):Ge.format?Ge.format(V):V[Ge.key]},Ge.key))},V.id))]})]})]}),qe&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>Nt(null),children:""})]}),e.jsx(St,{label:"Nazwa",value:qe.custom_name}),e.jsx(St,{label:"Typ",value:qe.obligation_type}),e.jsx(St,{label:"Zgodno",value:Wv(qe.compliance_status),color:Pv(qe.compliance_status)}),e.jsx(St,{label:"Odpowiedzialny",value:qe.responsible_person}),e.jsx(St,{label:"Obowizuje od",value:qe.effective_from}),e.jsx(St,{label:"Jednostka",value:qe.org_unit_name}),qe.description&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:qe.description})]}),!qe.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>Bl(qe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>_n(qe.id),children:"Dezaktywuj"})]})]})]})}function Ku(){return e.jsxs("div",{style:{display:"flex",gap:16},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx(ma,{search:D,onSearchChange:de,columns:a,visibleColumns:f,onToggleColumn:p,data:Ns,filteredCount:Ns.length,totalCount:L.length,unitLabel:"interesariuszy",exportFilename:"kontekst-interesariusze",primaryLabel:"Dodaj interesariusza",onPrimaryAction:()=>Ve(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:a.filter(V=>f.has(V.key)).map(V=>e.jsx("th",{children:V.header},V.key))})}),e.jsxs("tbody",{children:[Ns.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:a.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak danych"})}),Ns.map(V=>e.jsx("tr",{onClick:()=>_t(V),style:{cursor:"pointer",background:st?.id===V.id?"var(--bg-card-hover)":void 0,opacity:V.inherited?.75:1},children:a.filter(Ge=>f.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.key==="relevance"||Ge.key==="influence_level"?e.jsx("span",{style:{color:ml(Ge.key==="relevance"?V.relevance:V.influence_level)},children:Ge.format(V)}):Ge.key==="inherited"?e.jsx("span",{className:"score-badge",style:{background:V.inherited?"var(--blue-dim)":"var(--green-dim)",color:V.inherited?"var(--blue)":"var(--green)",fontSize:11},children:Ge.format(V)}):Ge.format?Ge.format(V):V[Ge.key]},Ge.key))},V.id))]})]})]}),st&&e.jsxs("div",{className:"card",style:{width:320,padding:16,fontSize:13,position:"sticky",top:16,alignSelf:"flex-start"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Szczegy"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>_t(null),children:""})]}),e.jsx(St,{label:"Nazwa",value:st.name}),e.jsx(St,{label:"Typ",value:st.stakeholder_type==="internal"?"Wewntrzny":"Zewntrzny"}),e.jsx(St,{label:"Kategoria",value:st.category_name}),e.jsx(St,{label:"Wpyw",value:gs(st.influence_level),color:ml(st.influence_level)}),e.jsx(St,{label:"Istotno",value:gs(st.relevance),color:ml(st.relevance)}),e.jsx(St,{label:"Kana komunikacji",value:st.communication_channel}),e.jsx(St,{label:"Jednostka",value:st.org_unit_name}),st.needs_expectations&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Potrzeby / oczekiwania"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:st.needs_expectations})]}),!st.inherited&&e.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>fi(st),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>Rl(st.id),children:"Dezaktywuj"})]})]})]})}function As(){return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Zakresy Systemw Zarzdzania"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ge({}),ja(!0)},children:"+ Dodaj zakres"})]}),ne.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",color:"var(--text-muted)",padding:30},children:"Zakres nie zosta zdefiniowany dla tej jednostki ani jednostek nadrzdnych."}):ne.map(V=>e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:12},children:[e.jsxs("h4",{style:{margin:0,fontSize:14},children:[e.jsx("span",{style:{padding:"2px 8px",borderRadius:8,fontSize:12,background:V.inherited?"var(--blue-dim)":"var(--green-dim)",color:V.inherited?"var(--blue)":"var(--green)",marginRight:8},children:V.management_system_name??"Oglny"}),"Wersja ",V.version]}),!V.inherited&&e.jsx("button",{className:"btn btn-sm",onClick:()=>{ge({management_system_id:V.management_system_id,scope_statement:V.scope_statement,in_scope_description:V.in_scope_description,out_of_scope_description:V.out_of_scope_description,geographic_boundaries:V.geographic_boundaries,technology_boundaries:V.technology_boundaries,organizational_boundaries:V.organizational_boundaries,interfaces_dependencies:V.interfaces_dependencies,approved_by:V.approved_by,approved_date:V.approved_date}),ja(!0)},children:"Edytuj"})]}),e.jsxs("div",{style:{fontSize:13},children:[V.inherited&&e.jsxs("div",{style:{marginBottom:12,padding:"8px 12px",background:"var(--blue-dim)",borderRadius:6,fontSize:12},children:["Odziedziczono z: ",e.jsx("strong",{children:V.org_unit_name})]}),e.jsx(St,{label:"Zatwierdzony przez",value:V.approved_by}),e.jsx(St,{label:"Data zatwierdzenia",value:V.approved_date}),V.scope_statement&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Owiadczenie o zakresie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.scope_statement})]}),V.in_scope_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"W zakresie"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.in_scope_description})]}),V.out_of_scope_description&&e.jsxs("div",{style:{marginTop:10},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Poza zakresem"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.out_of_scope_description})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:14},children:[V.geographic_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice geograficzne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.geographic_boundaries})]}),V.technology_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice technologiczne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.technology_boundaries})]}),V.organizational_boundaries&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Granice organizacyjne"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:V.organizational_boundaries})]})]})]})]},V.id))]})}function mr(){return e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:15},children:"Apetyt na Ryzyko"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>{ae(T?{risk_appetite_statement:T.risk_appetite_statement,max_acceptable_risk_level:T.max_acceptable_risk_level,max_acceptable_risk_score:T.max_acceptable_risk_score,exception_approval_authority:T.exception_approval_authority,financial_risk_tolerance:T.financial_risk_tolerance,reputational_risk_tolerance:T.reputational_risk_tolerance,operational_risk_tolerance:T.operational_risk_tolerance}:{}),se(!0)},children:T&&!T.inherited?"Edytuj":"Zdefiniuj wasny"})]}),T?e.jsxs("div",{style:{fontSize:13},children:[T.inherited&&e.jsxs("div",{style:{marginBottom:12,padding:"8px 12px",background:"var(--blue-dim)",borderRadius:6,fontSize:12},children:["Odziedziczono z: ",e.jsx("strong",{children:T.org_unit_name})]}),e.jsx(St,{label:"Maks. akceptowalny poziom ryzyka",value:gs(T.max_acceptable_risk_level),color:ml(T.max_acceptable_risk_level)}),e.jsx(St,{label:"Maks. akceptowalny wynik ryzyka",value:T.max_acceptable_risk_score}),e.jsx(St,{label:"Organ zatwierdzajcy wyjtki",value:T.exception_approval_authority}),e.jsx(St,{label:"Zatwierdzony przez",value:T.approved_by}),e.jsx(St,{label:"Data zatwierdzenia",value:T.approved_date}),T.risk_appetite_statement&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Owiadczenie o apetycie na ryzyko"}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.risk_appetite_statement})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginTop:14},children:[T.financial_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja fin."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.financial_risk_tolerance})]}),T.reputational_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja reput."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.reputational_risk_tolerance})]}),T.operational_risk_tolerance&&e.jsxs("div",{children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12},children:"Tolerancja oper."}),e.jsx("div",{style:{whiteSpace:"pre-wrap",marginTop:4},children:T.operational_risk_tolerance})]})]})]}):e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:30},children:"Apetyt na ryzyko nie zosta zdefiniowany."})]})}function Dl(){return e.jsxs("div",{children:[e.jsx(ma,{search:D,onSearchChange:de,columns:s,visibleColumns:x,onToggleColumn:j,data:k,filteredCount:k.length,totalCount:k.length,unitLabel:"przegldw",exportFilename:"kontekst-przeglady",primaryLabel:"Dodaj przegld",onPrimaryAction:()=>oe(!0)}),e.jsxs("table",{className:"data-table",style:{marginTop:8},children:[e.jsx("thead",{children:e.jsx("tr",{children:s.filter(V=>x.has(V.key)).map(V=>e.jsx("th",{children:V.header},V.key))})}),e.jsxs("tbody",{children:[k.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:s.length,style:{textAlign:"center",color:"var(--text-muted)"},children:"Brak przegldw"})}),k.map(V=>e.jsx("tr",{children:s.filter(Ge=>x.has(Ge.key)).map(Ge=>e.jsx("td",{children:Ge.format?Ge.format(V):V[Ge.key]},Ge.key))},V.id))]})]})]})}function Ll(){return e.jsxs(gt,{open:ve,onClose:()=>{je(!1),It(null),tt(!1)},title:zt?"Edytuj czynnik":"Nowy czynnik kontekstowy",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:Te.issue_type,onChange:V=>Me({...Te,issue_type:V.target.value}),children:[e.jsx("option",{value:"internal",children:"Wewntrzny"}),e.jsx("option",{value:"external",children:"Zewntrzny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Istotno"}),e.jsxs("select",{className:"form-control",value:Te.relevance,onChange:V=>Me({...Te,relevance:V.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoka"}),e.jsx("option",{value:"medium",children:"rednia"}),e.jsx("option",{value:"low",children:"Niska"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tytu *"}),e.jsx("input",{className:"form-control",style:hi(!!Te.title),value:Te.title,onChange:V=>Me({...Te,title:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:Te.description,onChange:V=>Me({...Te,description:V.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Wpyw"}),e.jsxs("select",{className:"form-control",value:Te.impact_level,onChange:V=>Me({...Te,impact_level:V.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"positive",children:"Pozytywny"}),e.jsx("option",{value:"negative",children:"Negatywny"}),e.jsx("option",{value:"neutral",children:"Neutralny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data przegldu"}),e.jsx("input",{type:"date",className:"form-control",value:Te.review_date,onChange:V=>Me({...Te,review_date:V.target.value})})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Dziaanie"}),e.jsx("textarea",{className:"form-control",rows:2,value:Te.response_action,onChange:V=>Me({...Te,response_action:V.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{je(!1),It(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>zt?Fl(zt):Ye(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function mi(){return e.jsxs(gt,{open:fe,onClose:()=>{_e(!1),rt(null),tt(!1)},title:va?"Edytuj zobowizanie":"Nowe zobowizanie",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:yt.obligation_type,onChange:V=>jt({...yt,obligation_type:V.target.value}),children:[e.jsx("option",{value:"legal",children:"Prawne"}),e.jsx("option",{value:"regulatory",children:"Regulacyjne"}),e.jsx("option",{value:"contractual",children:"Kontraktowe"}),e.jsx("option",{value:"voluntary",children:"Dobrowolne"}),e.jsx("option",{value:"internal",children:"Wewntrzne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Status zgodnoci"}),e.jsxs("select",{className:"form-control",value:yt.compliance_status,onChange:V=>jt({...yt,compliance_status:V.target.value}),children:[e.jsx("option",{value:"not_assessed",children:"Nieoceniony"}),e.jsx("option",{value:"compliant",children:"Zgodny"}),e.jsx("option",{value:"partially_compliant",children:"Czciowo zgodny"}),e.jsx("option",{value:"non_compliant",children:"Niezgodny"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:hi(!!yt.custom_name),value:yt.custom_name,onChange:V=>jt({...yt,custom_name:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:3,value:yt.description,onChange:V=>jt({...yt,description:V.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Odpowiedzialny"}),e.jsx("input",{className:"form-control",value:yt.responsible_person,onChange:V=>jt({...yt,responsible_person:V.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Obowizuje od"}),e.jsx("input",{type:"date",className:"form-control",value:yt.effective_from,onChange:V=>jt({...yt,effective_from:V.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{_e(!1),rt(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>va?jc(va):Kt(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function pi(){return e.jsxs(gt,{open:Se,onClose:()=>{Ve(!1),ca(null),tt(!1)},title:oa?"Edytuj interesariusza":"Nowy interesariusz",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ *"}),e.jsxs("select",{className:"form-control",value:sa.stakeholder_type,onChange:V=>Pa({...sa,stakeholder_type:V.target.value}),children:[e.jsx("option",{value:"internal",children:"Wewntrzny"}),e.jsx("option",{value:"external",children:"Zewntrzny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Istotno"}),e.jsxs("select",{className:"form-control",value:sa.relevance,onChange:V=>Pa({...sa,relevance:V.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoka"}),e.jsx("option",{value:"medium",children:"rednia"}),e.jsx("option",{value:"low",children:"Niska"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{className:"form-control",style:hi(!!sa.name),value:sa.name,onChange:V=>Pa({...sa,name:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",rows:2,value:sa.description,onChange:V=>Pa({...sa,description:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Potrzeby / oczekiwania"}),e.jsx("textarea",{className:"form-control",rows:2,value:sa.needs_expectations,onChange:V=>Pa({...sa,needs_expectations:V.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ wymaga"}),e.jsxs("select",{className:"form-control",value:sa.requirements_type,onChange:V=>Pa({...sa,requirements_type:V.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"legal",children:"Prawne"}),e.jsx("option",{value:"contractual",children:"Kontraktowe"}),e.jsx("option",{value:"voluntary",children:"Dobrowolne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poziom wpywu"}),e.jsxs("select",{className:"form-control",value:sa.influence_level,onChange:V=>Pa({...sa,influence_level:V.target.value}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"low",children:"Niski"})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{Ve(!1),ca(null),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>oa?Ts(oa):qn(),disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function wc(){return e.jsxs(gt,{open:be,onClose:()=>{oe(!1),tt(!1)},title:"Nowy przegld kontekstu",children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data przegldu *"}),e.jsx("input",{type:"date",className:"form-control",style:hi(!!Zt.review_date),value:Zt.review_date,onChange:V=>ur({...Zt,review_date:V.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Typ"}),e.jsxs("select",{className:"form-control",value:Zt.review_type,onChange:V=>ur({...Zt,review_type:V.target.value}),children:[e.jsx("option",{value:"scheduled",children:"Planowany"}),e.jsx("option",{value:"triggered",children:"Wyzwolony"}),e.jsx("option",{value:"initial",children:"Pocztkowy"})]})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Przegldajcy *"}),e.jsx("input",{className:"form-control",style:hi(!!Zt.reviewer),value:Zt.reviewer,onChange:V=>ur({...Zt,reviewer:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Podsumowanie zmian"}),e.jsx("textarea",{className:"form-control",rows:3,value:Zt.changes_summary,onChange:V=>ur({...Zt,changes_summary:V.target.value})})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data nastpnego przegldu"}),e.jsx("input",{type:"date",className:"form-control",value:Zt.next_review_date,onChange:V=>ur({...Zt,next_review_date:V.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>{oe(!1),tt(!1)},children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:fr,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function Ml(){return e.jsxs(gt,{open:za,onClose:()=>ja(!1),title:"Zakres Systemu Zarzdzania",wide:!0,children:[e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Norma ISO"}),e.jsxs("select",{className:"form-control",value:Et.management_system_id??"",onChange:V=>ge({...Et,management_system_id:V.target.value?Number(V.target.value):null}),children:[e.jsx("option",{value:"",children:" wybierz norm "}),Ft.map(V=>e.jsx("option",{value:V.id,children:V.label},V.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Owiadczenie o zakresie"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.scope_statement??"",onChange:V=>ge({...Et,scope_statement:V.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"W zakresie"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.in_scope_description??"",onChange:V=>ge({...Et,in_scope_description:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poza zakresem"}),e.jsx("textarea",{className:"form-control",rows:3,value:Et.out_of_scope_description??"",onChange:V=>ge({...Et,out_of_scope_description:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice geograficzne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.geographic_boundaries??"",onChange:V=>ge({...Et,geographic_boundaries:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice technologiczne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.technology_boundaries??"",onChange:V=>ge({...Et,technology_boundaries:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Granice organizacyjne"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.organizational_boundaries??"",onChange:V=>ge({...Et,organizational_boundaries:V.target.value||null})})]})]}),e.jsxs("div",{style:{marginTop:10},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Interfejsy / zalenoci"}),e.jsx("textarea",{className:"form-control",rows:2,value:Et.interfaces_dependencies??"",onChange:V=>ge({...Et,interfaces_dependencies:V.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzony przez"}),e.jsx("input",{className:"form-control",value:Et.approved_by??"",onChange:V=>ge({...Et,approved_by:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data zatwierdzenia"}),e.jsx("input",{type:"date",className:"form-control",value:Et.approved_date??"",onChange:V=>ge({...Et,approved_date:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>ja(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:vc,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}function kc(){return e.jsx(gt,{open:it,onClose:()=>Be(!1),title:"Dodaj jednostk organizacyjn",children:e.jsxs("form",{onSubmit:Fe,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Jednostka nadrzdna"}),e.jsx(jn,{tree:y,value:xe,onChange:Ie,placeholder:"Brak (najwyszy poziom)",allowClear:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Poziom *"}),e.jsxs("select",{name:"level_id",className:"form-control",required:!0,children:[e.jsx("option",{value:"",children:"Wybierz..."}),ze.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Nazwa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,placeholder:"np. Dzia IT"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Symbol *"}),e.jsx("input",{name:"symbol",className:"form-control",required:!0,placeholder:"np. DIT"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Waciciel biznesowy"}),e.jsx("input",{name:"owner",className:"form-control",placeholder:"np. Jan Kowalski"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator bezpieczestwa"}),e.jsx("input",{name:"security_contact",className:"form-control",placeholder:"np. Anna Nowak"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Koordynator IT"}),e.jsx("input",{name:"it_coordinator",className:"form-control",placeholder:"np. Piotr Winiewski"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",placeholder:"Opis jednostki..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>Be(!1),children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:at,children:at?"Zapisywanie...":"Dodaj jednostk"})]})]})})}function Ji(){return e.jsxs(gt,{open:Y,onClose:()=>se(!1),title:"Apetyt na ryzyko",wide:!0,children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Owiadczenie o apetycie na ryzyko"}),e.jsx("textarea",{className:"form-control",rows:3,value:te.risk_appetite_statement??"",onChange:V=>ae({...te,risk_appetite_statement:V.target.value||null})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Maks. poziom ryzyka"}),e.jsxs("select",{className:"form-control",value:te.max_acceptable_risk_level??"",onChange:V=>ae({...te,max_acceptable_risk_level:V.target.value||null}),children:[e.jsx("option",{value:"",children:" wybierz "}),e.jsx("option",{value:"low",children:"Niski"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"high",children:"Wysoki"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Maks. wynik ryzyka"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:te.max_acceptable_risk_score??"",onChange:V=>ae({...te,max_acceptable_risk_score:V.target.value?Number(V.target.value):null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzanie wyjtkw"}),e.jsx("input",{className:"form-control",value:te.exception_approval_authority??"",onChange:V=>ae({...te,exception_approval_authority:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja fin."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.financial_risk_tolerance??"",onChange:V=>ae({...te,financial_risk_tolerance:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja reput."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.reputational_risk_tolerance??"",onChange:V=>ae({...te,reputational_risk_tolerance:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Tolerancja oper."}),e.jsx("textarea",{className:"form-control",rows:2,value:te.operational_risk_tolerance??"",onChange:V=>ae({...te,operational_risk_tolerance:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,marginTop:10},children:[e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Zatwierdzony przez"}),e.jsx("input",{className:"form-control",value:te.approved_by??"",onChange:V=>ae({...te,approved_by:V.target.value||null})})]}),e.jsxs("div",{children:[e.jsx("label",{style:{fontSize:12,color:"var(--text-muted)"},children:"Data zatwierdzenia"}),e.jsx("input",{type:"date",className:"form-control",value:te.approved_date??"",onChange:V=>ae({...te,approved_date:V.target.value||null})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>se(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:Vu,disabled:Ue,children:Ue?"Zapisywanie...":"Zapisz"})]})]})}}const m3=["HardDrive","Server","Monitor","Laptop","Smartphone","Printer","Database","Network","Globe","Router","Shield","Code","Layers","AppWindow","Cloud","Settings","Users","User","UsersGroup","Briefcase","FileText","File","Table","Key","Building","MapPin","Door","Workflow","GitBranch","Headphones"],Uv=[{value:"text",label:"Tekst"},{value:"number",label:"Liczba"},{value:"date",label:"Data"},{value:"boolean",label:"Tak/Nie"},{value:"select",label:"Lista wyboru"},{value:"multiselect",label:"Wielokrotny wybor"},{value:"reference",label:"Referencja do aktywa"},{value:"textarea",label:"Tekst wieloliniowy"},{value:"url",label:"URL"},{value:"email",label:"Email"}],$v=["#3B82F6","#2563EB","#1D4ED8","#60A5FA","#8B5CF6","#7C3AED","#A78BFA","#10B981","#059669","#34D399","#6EE7B7","#F59E0B","#D97706","#FBBF24","#EF4444","#DC2626","#F87171","#06B6D4","#0891B2","#22D3EE","#EC4899","#DB2777","#F97316","#6366F1","#14B8A6"];function p3(){const[t,r]=m.useState([]),[a,s]=m.useState(null),[o,d]=m.useState(!0),[u,h]=m.useState([]),[f,p]=m.useState(!1),[x,j]=m.useState([]),[y,S]=m.useState(!1),[w,b]=m.useState(null),[_,E]=m.useState(!1),[C,N]=m.useState(!1),[O,Q]=m.useState(null),[G,M]=m.useState(!1),[U,A]=m.useState(!1),[R,Z]=m.useState(null),[F,q]=m.useState(!1),[ee,me]=m.useState("fields"),W=m.useMemo(()=>{const fe=[],_e=Se=>{for(const Ve of Se)fe.push(Ve),_e(Ve.children)};return _e(t),fe},[t]),J=m.useCallback(()=>{d(!0),le.get("/api/v1/asset-categories/tree?include_inactive=true").then(r).catch(()=>{}).finally(()=>d(!1))},[]),L=m.useCallback(()=>{le.get("/api/v1/asset-categories/relationship-types/all?include_inactive=true").then(j).catch(()=>{})},[]);m.useEffect(()=>{J(),L()},[J,L]),m.useEffect(()=>{a?(p(!0),le.get(`/api/v1/asset-categories/${a.id}/fields`).then(h).catch(()=>h([])).finally(()=>p(!1))):h([])},[a?.id]);const H=fe=>{b(null),S(!0)},ne=fe=>{b(fe),S(!0)},P=async fe=>{fe.preventDefault(),E(!0);const _e=new FormData(fe.currentTarget),Se={name:_e.get("name"),name_plural:_e.get("name_plural")||null,code:_e.get("code"),icon:_e.get("icon")||null,color:_e.get("color")||null,description:_e.get("description")||null,is_abstract:_e.get("is_abstract")==="true",sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0,parent_id:_e.get("parent_id")?Number(_e.get("parent_id")):null};try{w?await le.put(`/api/v1/asset-categories/${w.id}`,Se):await le.post("/api/v1/asset-categories",Se),S(!1),b(null),J()}catch(Ve){alert("Blad zapisu: "+Ve)}finally{E(!1)}},T=async fe=>{const _e=fe.is_active?"dezaktywowac":"aktywowac";if(confirm(`${_e} kategorie "${fe.name}"?`))try{fe.is_active?await le.delete(`/api/v1/asset-categories/${fe.id}`):await le.put(`/api/v1/asset-categories/${fe.id}`,{is_active:!0}),J()}catch(Se){alert("Blad: "+Se)}},z=()=>{Q(null),N(!0)},k=fe=>{Q(fe),N(!0)},I=async fe=>{if(fe.preventDefault(),!a)return;M(!0);const _e=new FormData(fe.currentTarget);let Se=null;const Ve=(_e.get("options_raw")||"").trim();Ve&&(Se=Ve.split(`
`).map(oe=>oe.trim()).filter(Boolean));const be={category_id:a.id,field_key:_e.get("field_key"),label:_e.get("label"),label_en:_e.get("label_en")||null,field_type:_e.get("field_type"),tab_name:_e.get("tab_name")||"Informacje",is_required:_e.get("is_required")==="true",is_unique:_e.get("is_unique")==="true",default_value:_e.get("default_value")||null,placeholder:_e.get("placeholder")||null,help_text:_e.get("help_text")||null,min_value:_e.get("min_value")?Number(_e.get("min_value")):null,max_value:_e.get("max_value")?Number(_e.get("max_value")):null,max_length:_e.get("max_length")?Number(_e.get("max_length")):null,options_json:Se,reference_category_id:_e.get("reference_category_id")?Number(_e.get("reference_category_id")):null,show_in_list:_e.get("show_in_list")==="true",sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0,column_width:_e.get("column_width")?Number(_e.get("column_width")):150};try{O?await le.put(`/api/v1/asset-categories/fields/${O.id}`,be):await le.post(`/api/v1/asset-categories/${a.id}/fields`,be),N(!1),Q(null);const oe=await le.get(`/api/v1/asset-categories/${a.id}/fields`);h(oe)}catch(oe){alert("Blad zapisu pola: "+oe)}finally{M(!1)}},D=async fe=>{if(!(!a||!confirm(`Usunac pole "${fe.label}"?`)))try{await le.delete(`/api/v1/asset-categories/fields/${fe.id}`);const _e=await le.get(`/api/v1/asset-categories/${a.id}/fields`);h(_e)}catch(_e){alert("Blad: "+_e)}},de=()=>{Z(null),A(!0)},he=fe=>{Z(fe),A(!0)},ie=async fe=>{fe.preventDefault(),q(!0);const _e=new FormData(fe.currentTarget),Se={code:_e.get("code"),name:_e.get("name"),name_reverse:_e.get("name_reverse")||null,color:_e.get("color")||null,icon:_e.get("icon")||null,description:_e.get("description")||null,sort_order:_e.get("sort_order")?Number(_e.get("sort_order")):0};try{R?await le.put(`/api/v1/asset-categories/relationship-types/${R.id}`,Se):await le.post("/api/v1/asset-categories/relationship-types",Se),A(!1),Z(null),L()}catch(Ve){alert("Blad: "+Ve)}finally{q(!1)}},ve=async fe=>{const _e=fe.is_active?"dezaktywowac":"aktywowac";if(confirm(`${_e} typ relacji "${fe.name}"?`))try{fe.is_active?await le.delete(`/api/v1/asset-categories/relationship-types/${fe.id}`):await le.put(`/api/v1/asset-categories/relationship-types/${fe.id}`,{is_active:!0}),L()}catch(Se){alert("Blad: "+Se)}},je=m.useMemo(()=>{const fe=new Map;for(const _e of u){const Se=_e.tab_name||"Informacje";fe.has(Se)||fe.set(Se,[]),fe.get(Se).push(_e)}for(const[,_e]of fe)_e.sort((Se,Ve)=>Se.sort_order-Ve.sort_order);return fe},[u]);return e.jsxs("div",{style:{display:"flex",height:"calc(100vh - 56px)",overflow:"hidden"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:220,maxWidth:280,width:250,borderRight:"1px solid var(--border)",background:"var(--bg-card)"},children:[e.jsx(pb,{tree:t,selectedId:a?.id??null,onSelect:fe=>s(fe),loading:o}),e.jsx("div",{style:{padding:8,borderTop:"1px solid var(--border)"},children:e.jsx("button",{className:"btn btn-sm btn-primary",style:{width:"100%",fontSize:11},onClick:()=>H(),children:"+ Nowa kategoria"})})]}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:"0 20px 20px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:"12px 0 8px"},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Administracja CMDB"}),e.jsx("span",{className:"score-badge",style:{background:"var(--purple-dim, rgba(139,92,246,0.15))",color:"var(--purple, #8B5CF6)",fontSize:11},children:"Kategorie & Formularze"})]}),a?e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{className:"card",style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:6},children:[e.jsx("span",{style:{fontSize:22},children:a.icon||""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"var(--text-primary)"},children:a.name}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",fontFamily:"'JetBrains Mono',monospace"},children:a.code})]})]}),a.description&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:12,marginTop:4,marginBottom:0},children:a.description}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[e.jsx("span",{className:"score-badge",style:{background:a.is_abstract?"var(--orange-dim, rgba(245,158,11,0.15))":"var(--green-dim, rgba(16,185,129,0.15))",color:a.is_abstract?"var(--orange)":"var(--green)",fontSize:10},children:a.is_abstract?"Grupa (abstrakcyjna)":"Konkretna (przypisywalna)"}),e.jsxs("span",{className:"score-badge",style:{background:"var(--blue-dim)",color:"var(--blue)",fontSize:10},children:[a.asset_count," aktywow"]}),!a.is_active&&e.jsx("span",{className:"score-badge",style:{background:"var(--red-dim, rgba(239,68,68,0.15))",color:"var(--red)",fontSize:10},children:"Nieaktywna"})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>ne(a),children:"Edytuj kategorie"}),e.jsx("button",{className:"btn btn-sm",style:{color:a.is_active?"var(--red)":"var(--green)"},onClick:()=>T(a),children:a.is_active?"Dezaktywuj":"Aktywuj"})]})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("h3",{style:{margin:0,fontSize:15,fontWeight:600},children:["Definicja formularza (",u.length," pol)"]}),!a.is_abstract&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:z,children:"+ Dodaj pole"})]}),a.is_abstract?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:"Kategorie abstrakcyjne (grupy) nie maja wlasnych pol formularza. Pola definiuje sie na konkretnych podkategoriach."}):f?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:"Ladowanie pol..."}):u.length===0?e.jsx("div",{className:"card",style:{textAlign:"center",padding:30,color:"var(--text-muted)",fontSize:13},children:'Brak zdefiniowanych pol. Kliknij "Dodaj pole" aby rozpoczac budowe formularza.'}):[...je.entries()].map(([fe,_e])=>e.jsxs("div",{className:"card",style:{marginBottom:12},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"var(--text-primary)",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:10,color:"var(--text-muted)",background:"var(--bg-subtle)",padding:"2px 8px",borderRadius:8},children:"Zakladka"}),fe]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"#"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Klucz"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Etykieta"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Typ"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Wymagane"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"W liscie"}),e.jsx("th",{style:{textAlign:"center",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Zrodlo"}),e.jsx("th",{style:{textAlign:"right",padding:"6px 8px"}})]})}),e.jsx("tbody",{children:_e.map(Se=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"5px 8px",fontFamily:"'JetBrains Mono',monospace",fontSize:10,color:"var(--text-muted)"},children:Se.sort_order}),e.jsx("td",{style:{padding:"5px 8px",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:Se.field_key}),e.jsx("td",{style:{padding:"5px 8px",fontWeight:500},children:Se.label}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center"},children:e.jsx("span",{className:"score-badge",style:{background:"var(--bg-subtle)",color:"var(--text-secondary)",fontSize:10},children:Uv.find(Ve=>Ve.value===Se.field_type)?.label||Se.field_type})}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center",color:Se.is_required?"var(--red)":"var(--text-muted)"},children:Se.is_required?"":""}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center",color:Se.show_in_list?"var(--green)":"var(--text-muted)"},children:Se.show_in_list?"":""}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"center"},children:Se.inherited_from_id?e.jsx("span",{style:{fontSize:9,color:"var(--purple)",background:"rgba(139,92,246,0.1)",padding:"2px 6px",borderRadius:8},children:"Odziedziczone"}):e.jsx("span",{style:{fontSize:9,color:"var(--text-muted)"},children:"Wlasne"})}),e.jsx("td",{style:{padding:"5px 8px",textAlign:"right"},children:!Se.inherited_from_id&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 6px",marginRight:4},onClick:()=>k(Se),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 6px",color:"var(--red)"},onClick:()=>D(Se),children:"Usun"})]})})]},Se.id))})]})]},fe))]}):e.jsxs("div",{style:{marginTop:20},children:[e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-title",children:"Przegladaj kategorie"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Wybierz kategorie z drzewa po lewej stronie, aby zarzadzac jej polami formularza. Mozesz tez dodac nowa kategorie przyciskiem na dole panelu."})]}),e.jsx("div",{style:{display:"flex",gap:0,marginBottom:14},children:[{key:"fields",label:"Statystyki kategorii"},{key:"reltypes",label:`Typy relacji (${x.length})`}].map(fe=>e.jsx("div",{onClick:()=>me(fe.key),style:{padding:"8px 16px",fontSize:13,cursor:"pointer",borderBottom:ee===fe.key?"2px solid var(--blue)":"2px solid var(--border)",color:ee===fe.key?"var(--blue)":"var(--text-muted)",fontWeight:ee===fe.key?600:400},children:fe.label},fe.key))}),ee==="fields"&&e.jsx("div",{className:"card",children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kategoria"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kod"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Typ"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywow"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywna"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 10px"}})]})}),e.jsx("tbody",{children:W.map(fe=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)",opacity:fe.is_active?1:.4},children:[e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx("span",{style:{paddingLeft:fe.parent_id?16:0,fontWeight:fe.is_abstract?600:400},children:fe.name})}),e.jsx("td",{style:{padding:"6px 10px",fontFamily:"'JetBrains Mono',monospace",fontSize:11,color:"var(--text-muted)"},children:fe.code}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("span",{className:"score-badge",style:{background:fe.is_abstract?"var(--orange-dim, rgba(245,158,11,0.15))":"var(--green-dim, rgba(16,185,129,0.15))",color:fe.is_abstract?"var(--orange)":"var(--green)",fontSize:10},children:fe.is_abstract?"Grupa":"Konkretna"})}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center",fontFamily:"'JetBrains Mono',monospace"},children:fe.asset_count}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.is_active?"":""}),e.jsxs("td",{style:{padding:"6px 10px",textAlign:"right"},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginRight:4},onClick:()=>ne(fe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:fe.is_active?"var(--red)":"var(--green)"},onClick:()=>T(fe),children:fe.is_active?"Dezaktywuj":"Aktywuj"})]})]},fe.id))})]})}),ee==="reltypes"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600},children:"Typy relacji miedzy aktywami"}),e.jsx("button",{className:"btn btn-sm btn-primary",onClick:de,children:"+ Dodaj typ"})]}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kod"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa odwrotna"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Kolor"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 10px",color:"var(--text-muted)",fontWeight:500},children:"Aktywny"}),e.jsx("th",{style:{textAlign:"right",padding:"8px 10px"}})]})}),e.jsx("tbody",{children:x.map(fe=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)",opacity:fe.is_active?1:.4},children:[e.jsx("td",{style:{padding:"6px 10px",fontFamily:"'JetBrains Mono',monospace",fontSize:11},children:fe.code}),e.jsx("td",{style:{padding:"6px 10px"},children:fe.name}),e.jsx("td",{style:{padding:"6px 10px",color:"var(--text-muted)"},children:fe.name_reverse||""}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.color&&e.jsx("span",{style:{display:"inline-block",width:16,height:16,borderRadius:"50%",background:fe.color,verticalAlign:"middle"}})}),e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:fe.is_active?"":""}),e.jsxs("td",{style:{padding:"6px 10px",textAlign:"right"},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginRight:4},onClick:()=>he(fe),children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,color:fe.is_active?"var(--red)":"var(--green)"},onClick:()=>ve(fe),children:fe.is_active?"Dezaktywuj":"Aktywuj"})]})]},fe.id))})]})]})]})]}),e.jsx(gt,{open:y,onClose:()=>{S(!1),b(null)},title:w?`Edytuj: ${w.name}`:"Nowa kategoria",wide:!0,children:e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa *"}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:w?.name??"",placeholder:"np. Serwery"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa w l. mnogiej"}),e.jsx("input",{name:"name_plural",className:"form-control",defaultValue:w?.name_plural??"",placeholder:"np. Serwery"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod (unikalny) *"}),e.jsx("input",{name:"code",className:"form-control",required:!0,defaultValue:w?.code??"",placeholder:"np. servers",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria nadrzedna"}),e.jsxs("select",{name:"parent_id",className:"form-control",defaultValue:w?.parent_id??a?.id??"",children:[e.jsx("option",{value:"",children:"Brak (glowny poziom)"}),W.filter(fe=>!w||fe.id!==w.id).map(fe=>e.jsxs("option",{value:fe.id,children:[fe.parent_id?"  ":"",fe.name]},fe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ikona"}),e.jsxs("select",{name:"icon",className:"form-control",defaultValue:w?.icon??"",children:[e.jsx("option",{value:"",children:"Brak"}),m3.map(fe=>e.jsx("option",{value:fe,children:fe},fe))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("div",{style:{display:"flex",gap:4,alignItems:"center"},children:e.jsx("input",{name:"color",className:"form-control",defaultValue:w?.color??"",placeholder:"#3B82F6",style:{flex:1}})}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:3,marginTop:6},children:$v.map(fe=>e.jsx("span",{onClick:_e=>{const Se=_e.currentTarget.parentElement?.parentElement?.querySelector('input[name="color"]');Se&&(Se.value=fe)},style:{width:18,height:18,borderRadius:4,background:fe,cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"}},fe))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc sortowania"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:w?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ kategorii"}),e.jsxs("select",{name:"is_abstract",className:"form-control",defaultValue:w?.is_abstract?"true":"false",children:[e.jsx("option",{value:"false",children:"Konkretna (przypisywalna do aktywow)"}),e.jsx("option",{value:"true",children:"Abstrakcyjna (grupa/folder)"})]})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:w?.description??"",placeholder:"Opcjonalny opis kategorii"})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{S(!1),b(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:_,children:_?"Zapisywanie...":w?"Zapisz zmiany":"Utwrz kategorie"})]})]})}),e.jsx(gt,{open:C,onClose:()=>{N(!1),Q(null)},title:O?`Edytuj pole: ${O.label}`:"Nowe pole formularza",wide:!0,children:e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Klucz pola (field_key) *"}),e.jsx("input",{name:"field_key",className:"form-control",required:!0,defaultValue:O?.field_key??"",placeholder:"np. hostname",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Unikalny identyfikator pola w JSON-ie custom_attributes"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta (PL) *"}),e.jsx("input",{name:"label",className:"form-control",required:!0,defaultValue:O?.label??"",placeholder:"np. Nazwa hosta"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Etykieta (EN)"}),e.jsx("input",{name:"label_en",className:"form-control",defaultValue:O?.label_en??"",placeholder:"np. Hostname"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ pola *"}),e.jsx("select",{name:"field_type",className:"form-control",required:!0,defaultValue:O?.field_type??"text",children:Uv.map(fe=>e.jsx("option",{value:fe.value,children:fe.label},fe.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Zakladka"}),e.jsx("input",{name:"tab_name",className:"form-control",defaultValue:O?.tab_name??"Informacje",placeholder:"np. Informacje"}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Nazwa zakladki w formularzu (Informacje, Zarzadzanie, Bezpieczenstwo...)"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:O?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Placeholder"}),e.jsx("input",{name:"placeholder",className:"form-control",defaultValue:O?.placeholder??"",placeholder:"np. Wpisz wartosc..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wartosc domyslna"}),e.jsx("input",{name:"default_value",className:"form-control",defaultValue:O?.default_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wymagane"}),e.jsxs("select",{name:"is_required",className:"form-control",defaultValue:O?.is_required?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Unikalne"}),e.jsxs("select",{name:"is_unique",className:"form-control",defaultValue:O?.is_unique?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Widoczne w liscie"}),e.jsxs("select",{name:"show_in_list",className:"form-control",defaultValue:O?.show_in_list?"true":"false",children:[e.jsx("option",{value:"false",children:"Nie"}),e.jsx("option",{value:"true",children:"Tak  pokaz jako kolumne w tabeli"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Szerokosc kolumny (px)"}),e.jsx("input",{name:"column_width",type:"number",className:"form-control",defaultValue:O?.column_width??150})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Min. wartosc (number)"}),e.jsx("input",{name:"min_value",type:"number",className:"form-control",defaultValue:O?.min_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max. wartosc (number)"}),e.jsx("input",{name:"max_value",type:"number",className:"form-control",defaultValue:O?.max_value??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max. dlugosc (text)"}),e.jsx("input",{name:"max_length",type:"number",className:"form-control",defaultValue:O?.max_length??""})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kategoria referencyjna (reference)"}),e.jsxs("select",{name:"reference_category_id",className:"form-control",defaultValue:O?.reference_category_id??"",children:[e.jsx("option",{value:"",children:"Brak"}),W.filter(fe=>!fe.is_abstract).map(fe=>e.jsx("option",{value:fe.id,children:fe.name},fe.id))]}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:'Tylko dla typu "Referencja do aktywa"'})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Opcje (select / multiselect)"}),e.jsx("textarea",{name:"options_raw",className:"form-control",rows:3,defaultValue:O?.options_json?g3(O.options_json):"",placeholder:`Jedna opcja na linie, np.:
Produkcja
Staging
Development
Test`}),e.jsx("small",{style:{color:"var(--text-muted)",fontSize:10},children:"Kazda linia = jedna opcja. Dotyczy typow: Lista wyboru, Wielokrotny wybor."})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"span 2"},children:[e.jsx("label",{children:"Tekst pomocy"}),e.jsx("textarea",{name:"help_text",className:"form-control",rows:2,defaultValue:O?.help_text??"",placeholder:"Dodatkowa informacja dla uzytkownika..."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{N(!1),Q(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:G,children:G?"Zapisywanie...":O?"Zapisz zmiany":"Dodaj pole"})]})]})}),e.jsx(gt,{open:U,onClose:()=>{A(!1),Z(null)},title:R?`Edytuj: ${R.name}`:"Nowy typ relacji",children:e.jsxs("form",{onSubmit:ie,children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kod (unikalny) *"}),e.jsx("input",{name:"code",className:"form-control",required:!0,defaultValue:R?.code??"",placeholder:"np. depends_on",pattern:"[a-z0-9_]+",title:"Tylko male litery, cyfry i podkreslniki",disabled:!!R})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:'Nazwa (np. "Zalezy od") *'}),e.jsx("input",{name:"name",className:"form-control",required:!0,defaultValue:R?.name??"",placeholder:"np. Zalezy od"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:'Nazwa odwrotna (np. "Jest wymagany przez")'}),e.jsx("input",{name:"name_reverse",className:"form-control",defaultValue:R?.name_reverse??"",placeholder:"np. Jest wymagany przez"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolor"}),e.jsx("input",{name:"color",className:"form-control",defaultValue:R?.color??"",placeholder:"#3B82F6"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:3,marginTop:6},children:$v.slice(0,12).map(fe=>e.jsx("span",{onClick:_e=>{const Se=_e.currentTarget.parentElement?.parentElement?.querySelector('input[name="color"]');Se&&(Se.value=fe)},style:{width:18,height:18,borderRadius:4,background:fe,cursor:"pointer",border:"1px solid rgba(255,255,255,0.1)"}},fe))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ikona"}),e.jsx("input",{name:"icon",className:"form-control",defaultValue:R?.icon??"",placeholder:"np. ArrowRight"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Kolejnosc"}),e.jsx("input",{name:"sort_order",type:"number",className:"form-control",defaultValue:R?.sort_order??0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{name:"description",className:"form-control",rows:2,defaultValue:R?.description??""})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>{A(!1),Z(null)},children:"Anuluj"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:F,children:F?"Zapisywanie...":R?"Zapisz":"Utwrz"})]})]})})]})}function g3(t){if(!t)return"";let r=t;if(typeof t=="string")try{r=JSON.parse(t)}catch{return String(t)}return Array.isArray(r)?r.map(a=>typeof a=="string"?a:typeof a=="object"&&a!==null&&"label"in a?String(a.label):String(a)).join(`
`):""}const x3="",y3=[{id:"executive",title:"Executive Summary",description:"Podsumowanie wykonawcze: KPI, top ryzyka, przeglad aktywow wg kategorii CMDB.",icon:"",endpoint:"/api/v1/reports/executive"},{id:"risks",title:"Rejestr Ryzyk",description:"Pelny rejestr ryzyk z ocenami, statusami, wlascicielami i terminami.",icon:"",endpoint:"/api/v1/reports/risks",params:[{key:"org_unit_id",label:"Jednostka org. (ID, opcjonalnie)",type:"number"}]},{id:"assets",title:"Rejestr Aktywow (CMDB)",description:"Lista aktywow z kategoriami CMDB, wlascicielami, lokalizacjami i ryzykami.",icon:"",endpoint:"/api/v1/reports/assets",params:[{key:"asset_category_id",label:"Kategoria CMDB (ID, opcjonalnie)",type:"number"}]}];function v3(){const[t,r]=m.useState(null),a=async(s,o)=>{r(s.id);try{const d=new URLSearchParams;if(o)for(const[j,y]of Object.entries(o))y&&d.set(j,y);const u=d.toString()?`?${d.toString()}`:"",h=await fetch(`${x3}${s.endpoint}${u}`);if(!h.ok)throw new Error(`HTTP ${h.status}`);const f=await h.blob(),p=URL.createObjectURL(f),x=document.createElement("a");x.href=p,x.download=`raport_${s.id}_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(p)}catch(d){alert("Blad generowania raportu: "+d)}finally{r(null)}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20},children:[e.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700},children:"Raporty"}),e.jsx("span",{className:"score-badge",style:{background:"var(--cyan-dim, rgba(6,182,212,0.15))",color:"var(--cyan, #06B6D4)",fontSize:11},children:"Excel / XLSX"})]}),e.jsx("div",{className:"grid-3",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:16},children:y3.map(s=>e.jsx(j3,{report:s,generating:t===s.id,onGenerate:a},s.id))})]})}function j3({report:t,generating:r,onGenerate:a}){const[s,o]=m.useState(!1),[d,u]=m.useState({});return e.jsxs("div",{className:"card",style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12,marginBottom:10},children:[e.jsx("span",{style:{fontSize:28},children:t.icon}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)",marginBottom:4},children:t.title}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",lineHeight:1.4},children:t.description})]})]}),t.params&&t.params.length>0&&e.jsx("div",{children:s?e.jsx("div",{style:{marginBottom:10,padding:10,background:"var(--bg-inset)",borderRadius:6,border:"1px solid var(--border)"},children:t.params.map(h=>e.jsxs("div",{className:"form-group",style:{marginBottom:8},children:[e.jsx("label",{style:{fontSize:11,color:"var(--text-muted)"},children:h.label}),e.jsx("input",{className:"form-control",type:h.type,value:d[h.key]||"",onChange:f=>u(p=>({...p,[h.key]:f.target.value})),style:{fontSize:12}})]},h.key))}):e.jsx("button",{className:"btn btn-sm",style:{fontSize:11,marginBottom:8},onClick:()=>o(!0),children:"Parametry filtrowania..."})}),e.jsx("div",{style:{marginTop:"auto"},children:e.jsx("button",{className:"btn btn-primary",style:{width:"100%"},disabled:r,onClick:()=>a(t,d),children:r?"Generowanie...":"Pobierz raport (XLSX)"})})]})}const Ua="",b3=[{key:"threats",label:"Zagrozenia",icon:""},{key:"weaknesses",label:"Podatnosci",icon:""},{key:"controls",label:"Zabezpieczenia",icon:""},{key:"correlations",label:"Mapa Powiazan",icon:""},{key:"coverage",label:"Analiza Luk i Skutecznosci",icon:""}],_3={key:"ai",label:"AI Asystent",icon:""},S3=["NATURAL","ENVIRONMENTAL","HUMAN_INTENTIONAL","HUMAN_ACCIDENTAL","TECHNICAL","ORGANIZATIONAL"],w3=["INTERNAL","EXTERNAL","BOTH"],k3=["HARDWARE","SOFTWARE","NETWORK","PERSONNEL","SITE","ORGANIZATION","PROCESS"],z3=["TECHNICAL","ORGANIZATIONAL","PHYSICAL","LEGAL"],C3=["PREVENTIVE","DETECTIVE","CORRECTIVE","DETERRENT","COMPENSATING"],T3=["HIGH","MEDIUM","LOW"],Wi={NATURAL:"#06b6d4",ENVIRONMENTAL:"#0891b2",HUMAN_INTENTIONAL:"#dc2626",HUMAN_ACCIDENTAL:"#f59e0b",TECHNICAL:"#8b5cf6",ORGANIZATIONAL:"#3b82f6",HARDWARE:"#64748b",SOFTWARE:"#8b5cf6",NETWORK:"#06b6d4",PERSONNEL:"#f59e0b",SITE:"#84cc16",ORGANIZATION:"#3b82f6",PROCESS:"#ec4899",PHYSICAL:"#84cc16",LEGAL:"#a855f7",PREVENTIVE:"#16a34a",DETECTIVE:"#2563eb",CORRECTIVE:"#ea580c",DETERRENT:"#dc2626",COMPENSATING:"#6366f1"},gn={HIGH:"#dc2626",MEDIUM:"#f59e0b",LOW:"#16a34a"};function Ot({text:t,color:r}){return e.jsx("span",{style:{display:"inline-block",padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:600,background:r?`${r}22`:"var(--bg-alt)",color:r??"var(--text-muted)",whiteSpace:"nowrap"},children:t})}function Hv({cia:t}){return t?e.jsxs("span",{style:{fontFamily:"monospace",fontSize:13,letterSpacing:2},children:[e.jsx("span",{style:{color:t.C?"#dc2626":"var(--border)",fontWeight:t.C?700:400},children:"C"}),e.jsx("span",{style:{color:t.I?"#f59e0b":"var(--border)",fontWeight:t.I?700:400},children:"I"}),e.jsx("span",{style:{color:t.A?"#16a34a":"var(--border)",fontWeight:t.A?700:400},children:"A"})]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}function Qa({number:t,label:r}){return e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"var(--blue)",textTransform:"uppercase",letterSpacing:"0.05em",marginTop:16,marginBottom:8,paddingBottom:4,borderBottom:"1px solid rgba(59,130,246,0.2)"},children:[t," ",r]})}function pn({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function N3({pct:t,label:r,gaps:a}){const s=t>=80?"#16a34a":t>=50?"#f59e0b":"#dc2626";return e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4},children:[e.jsx("span",{children:r}),e.jsxs("span",{children:[e.jsxs("span",{style:{fontWeight:700,color:s},children:[t.toFixed(0),"%"]}),a>0&&e.jsxs("span",{style:{color:"#dc2626",marginLeft:8,fontSize:11},children:[a," luk"]})]})]}),e.jsx("div",{style:{height:8,background:"var(--bg-alt)",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${Math.min(t,100)}%`,background:s,borderRadius:4,transition:"width 0.5s ease"}})})]})}const wm=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"source",header:"Zrodlo"},{key:"cia_impact",header:"CIA",format:()=>""},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],km=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],zm=[{key:"ref_id",header:"Ref"},{key:"name",header:"Nazwa"},{key:"category",header:"Kategoria"},{key:"implementation_type",header:"Typ impl."},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"},{key:"description",header:"Opis",format:t=>t.description??"",defaultVisible:!1}],Vv=[{key:"threat_ref_id",header:"Zagrozenie (Ref)",format:t=>t.threat_ref_id??""},{key:"threat_name",header:"Zagrozenie",format:t=>t.threat_name??""},{key:"weakness_ref_id",header:"Podatnosc (Ref)",format:t=>t.weakness_ref_id??""},{key:"weakness_name",header:"Podatnosc",format:t=>t.weakness_name??""},{key:"control_ref_id",header:"Zabezpieczenie (Ref)",format:t=>t.control_ref_id??""},{key:"control_name",header:"Zabezpieczenie",format:t=>t.control_name??""},{key:"relevance",header:"Istotnosc",format:t=>t.relevance??""},{key:"effectiveness",header:"Skutecznosc",format:t=>t.effectiveness??""},{key:"is_system",header:"Typ",format:t=>t.is_system?"SYS":"ORG"}];function A3(){const{aiEnabled:t,hasFeature:r}=Rp(),[a,s]=m.useState("threats"),[o,d]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState([]),[x,j]=m.useState([]),[y,S]=m.useState(!0),[w,b]=m.useState(null),[_,E]=m.useState(!1),[C,N]=m.useState(null),[O,Q]=m.useState(null),G=m.useMemo(()=>{const K=[...b3];return t&&K.push(_3),K},[t]),[M,U]=m.useState(!1),[A,R]=m.useState(null),[Z,F]=m.useState(!1),[q,ee]=m.useState(null),[me,W]=m.useState(null),[J,L]=m.useState(null),[H,ne]=m.useState([]),[P,T]=m.useState([]),[z,k]=m.useState("tw"),[I,D]=m.useState([]),[de,he]=m.useState(!1),[ie,ve]=m.useState(null),[je,fe]=m.useState(!1),[_e,Se]=m.useState(null),[Ve,be]=m.useState({}),[oe,Ue]=m.useState(!1),[Qe,lt]=m.useState({}),[tt,ht]=m.useState([]),[xt,qe]=m.useState([]),[Nt,st]=m.useState([]),[_t,zt]=m.useState(!1),[It,va]=m.useState({threats:"",weaknesses:"",controls:""}),[rt,oa]=m.useState(null),[ca,ze]=m.useState(!1),[et,it]=m.useState(!1),Be=Aa({data:o,storageKey:"catalog-threats",defaultSort:"ref_id"}),at=Aa({data:u,storageKey:"catalog-weaknesses",defaultSort:"ref_id"}),nt=Aa({data:f,storageKey:"catalog-controls",defaultSort:"ref_id"}),ut=Aa({data:I,storageKey:"catalog-links",defaultSort:"threat_ref_id"}),{visible:ta,toggle:Pt}=da(wm,"catalog-threats"),{visible:Tt,toggle:xe}=da(km,"catalog-weaknesses"),{visible:Ie,toggle:mt}=da(zm,"catalog-controls"),{visible:Oe}=da(Vv,"catalog-links"),ct=m.useCallback(async()=>{S(!0),b(null);try{const[K,ue,ke,Te]=await Promise.all([fetch(`${Ua}/api/v1/threat-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/weakness-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/control-catalog`).then(Me=>Me.json()),fetch(`${Ua}/api/v1/asset-categories`).then(Me=>Me.ok?Me.json():[]).catch(()=>[])]);d(K),h(ue),p(ke),j(Array.isArray(Te)?Te.filter(Me=>!Me.is_abstract):[])}catch(K){b(K instanceof Error?K.message:"Blad ladowania danych")}finally{S(!1)}},[]);m.useEffect(()=>{ct()},[ct]);const At=m.useCallback(async K=>{try{const[ue,ke]=await Promise.all([fetch(`${Ua}/api/v1/suggestions/weaknesses?threat_id=${K}`).then(Te=>Te.json()),fetch(`${Ua}/api/v1/suggestions/controls?threat_id=${K}`).then(Te=>Te.json())]);ne(ue),T(ke)}catch{}},[]),za=m.useCallback(async K=>{he(!0);try{const ke=await fetch(`${Ua}/api/v1/links/${K==="tw"?"threat-weakness":K==="tc"?"threat-control":"weakness-control"}`).then(Te=>Te.json());D(ke)}catch{D([])}finally{he(!1)}},[]),ja=m.useCallback(async()=>{try{const[K,ue,ke]=await Promise.all([fetch(`${Ua}/api/v1/links/threat-weakness`).then(Te=>Te.json()).catch(()=>[]),fetch(`${Ua}/api/v1/links/threat-control`).then(Te=>Te.json()).catch(()=>[]),fetch(`${Ua}/api/v1/links/weakness-control`).then(Te=>Te.json()).catch(()=>[])]);ht(K),qe(ue),st(ke),zt(!0)}catch{}},[]),Et=m.useCallback(K=>({weaknesses:tt.filter(ue=>ue.threat_id===K),controls:xt.filter(ue=>ue.threat_id===K)}),[tt,xt]),ge=m.useCallback(K=>({threats:tt.filter(ue=>ue.weakness_id===K),controls:Nt.filter(ue=>ue.weakness_id===K)}),[tt,Nt]),Ft=m.useCallback(K=>({threats:xt.filter(ue=>ue.control_id===K),weaknesses:Nt.filter(ue=>ue.control_id===K)}),[xt,Nt]),ga=m.useCallback(async()=>{Ue(!0);const K=x.filter(ke=>!ke.is_abstract),ue={};await Promise.all(K.map(async ke=>{try{const Te=await fetch(`${Ua}/api/v1/coverage/asset-category/${ke.id}`).then(Me=>Me.json());ue[ke.id]=Te}catch{}})),be(ue),Ue(!1)},[x]);m.useEffect(()=>{a==="correlations"&&(za(z),_t||ja())},[a,z,za,_t,ja]),m.useEffect(()=>{a==="coverage"&&x.length>0&&(ga(),_t||ja())},[a,x,ga,_t,ja]),m.useEffect(()=>{(q||me||J)&&!_t&&ja()},[q,me,J,_t,ja]),m.useEffect(()=>{ee(null),W(null),L(null),ve(null),ne([]),T([])},[a]);const Y=m.useMemo(()=>a==="threats"?[{label:"Zagrozenia",value:Be.filteredCount,total:Be.totalCount,color:"#dc2626"},{label:"Systemowe",value:Be.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Kategorie",value:new Set(Be.filtered.map(K=>K.category)).size,color:"#8b5cf6"},{label:"Zewnetrzne",value:Be.filtered.filter(K=>K.source==="EXTERNAL").length,color:"#f59e0b"}]:a==="weaknesses"?[{label:"Podatnosci",value:at.filteredCount,total:at.totalCount,color:"#f59e0b"},{label:"Systemowe",value:at.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Kategorie",value:new Set(at.filtered.map(K=>K.category)).size,color:"#8b5cf6"}]:a==="controls"?[{label:"Zabezpieczenia",value:nt.filteredCount,total:nt.totalCount,color:"#16a34a"},{label:"Systemowe",value:nt.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"Prewencyjne",value:nt.filtered.filter(K=>K.implementation_type==="PREVENTIVE").length,color:"#16a34a"},{label:"Detektywne",value:nt.filtered.filter(K=>K.implementation_type==="DETECTIVE").length,color:"#2563eb"}]:a==="correlations"?[{label:"Korelacje",value:ut.filteredCount,total:ut.totalCount,color:"#8b5cf6"},{label:"Systemowe",value:ut.filtered.filter(K=>K.is_system).length,color:"#3b82f6"},{label:"HIGH",value:ut.filtered.filter(K=>(K.relevance??K.effectiveness)==="HIGH").length,color:"#dc2626"}]:[],[a,Be,at,nt,ut]),se=a==="threats"?Be.filteredCount!==Be.totalCount:a==="weaknesses"?at.filteredCount!==at.totalCount:a==="controls"?nt.filteredCount!==nt.totalCount:a==="correlations"?ut.filteredCount!==ut.totalCount:!1,te=async K=>{F(!0);try{const ue=!!A;let ke="";a==="threats"?ke=`${Ua}/api/v1/threat-catalog`:a==="weaknesses"?ke=`${Ua}/api/v1/weakness-catalog`:a==="controls"&&(ke=`${Ua}/api/v1/control-catalog`),ue&&(ke+=`/${A.id}`),await fetch(ke,{method:ue?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)}),U(!1),R(null),await ct()}catch(ue){alert(ue instanceof Error?ue.message:"Blad zapisu")}finally{F(!1)}},ae=async(K,ue)=>{if(!confirm("Archiwizowac wpis?"))return;await fetch(`${Ua}/api/v1/${K==="threat"?"threat-catalog":K==="weakness"?"weakness-catalog":"control-catalog"}/${ue}`,{method:"DELETE"}),await ct()},re=async K=>{F(!0);try{const ue=z==="tw"?"threat-weakness":z==="tc"?"threat-control":"weakness-control",ke=!!_e,Te=ke?`${Ua}/api/v1/links/${ue}/${_e.id}`:`${Ua}/api/v1/links/${ue}`;await fetch(Te,{method:ke?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)}),fe(!1),Se(null),await za(z)}catch(ue){alert(ue instanceof Error?ue.message:"Blad zapisu korelacji")}finally{F(!1)}},ce=async K=>{if(!confirm("Usunac korelacje?"))return;await fetch(`${Ua}/api/v1/links/${z==="tw"?"threat-weakness":z==="tc"?"threat-control":"weakness-control"}/${K}`,{method:"DELETE"}),ve(null),await za(z)},Ce=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="source")return e.jsx(Ot,{text:K.source});if(ue==="cia_impact")return e.jsx(Hv,{cia:K.cia_impact});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},De=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},Ne=(K,ue)=>{if(ue==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:K.ref_id});if(ue==="category")return e.jsx(Ot,{text:K.category,color:Wi[K.category]});if(ue==="implementation_type")return e.jsx(Ot,{text:K.implementation_type,color:Wi[K.implementation_type]});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"});if(ue==="name")return e.jsx("span",{style:{fontWeight:500},children:K.name})},Fe=(K,ue)=>{if(ue==="threat_ref_id"||ue==="weakness_ref_id"||ue==="control_ref_id"){const ke=K[ue];return ke?e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace",fontSize:11,fontWeight:600},children:String(ke)}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}if(ue==="relevance")return K.relevance?e.jsx(Ot,{text:K.relevance,color:gn[K.relevance]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(ue==="effectiveness")return K.effectiveness?e.jsx(Ot,{text:K.effectiveness,color:gn[K.effectiveness]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(ue==="is_system")return e.jsx(Ot,{text:K.is_system?"SYS":"ORG",color:K.is_system?"#3b82f6":"#16a34a"})};return y?e.jsx("div",{className:"page-loading",children:"Ladowanie Smart Catalog..."}):w?e.jsxs("div",{className:"card",style:{color:"#dc2626",padding:24},children:["Blad: ",w]}):e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:e.jsx("h2",{style:{margin:0},children:"Katalog Zagrozen, Podatnosci i Zabezpieczen"})}),e.jsx("div",{style:{display:"flex",gap:4,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:0},children:G.map(K=>e.jsxs("button",{onClick:()=>s(K.key),style:{padding:"8px 16px",border:"none",cursor:"pointer",background:a===K.key?"var(--blue)":"transparent",color:a===K.key?"#fff":"var(--text-muted)",borderRadius:"6px 6px 0 0",fontWeight:a===K.key?600:400,fontSize:13,transition:"all 0.2s"},children:[K.icon," ",K.label]},K.key))}),Y.length>0&&e.jsx(Ia,{cards:Y,isFiltered:se}),a==="threats"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:Be.filteredCount,totalCount:Be.totalCount,unitLabel:"zagrozenia",search:Be.search,onSearchChange:Be.setSearch,searchPlaceholder:"Szukaj zagrozenia...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:Be.hasActiveFilters,onClearFilters:Be.clearAllFilters,columns:wm,visibleColumns:ta,onToggleColumn:Pt,data:Be.filtered,exportFilename:"zagrozenia",primaryLabel:"Nowe zagrozenie",onPrimaryAction:()=>{R(null),U(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:q?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:wm,visibleColumns:ta,data:Be.pageData,rowKey:K=>K.id,selectedKey:q?.id??null,onRowClick:K=>{q?.id===K.id?ee(null):(ee(K),At(K.id))},renderCell:Ce,sortField:Be.sortField,sortDir:Be.sortDir,onSort:Be.toggleSort,columnFilters:Be.columnFilters,onColumnFilter:Be.setColumnFilter,showFilters:et,page:Be.page,totalPages:Be.totalPages,pageSize:Be.pageSize,totalItems:Be.totalCount,filteredItems:Be.filteredCount,onPageChange:Be.setPage,onPageSizeChange:Be.setPageSize,loading:y,emptyMessage:"Brak zagrozenia w katalogu.",emptyFilteredMessage:"Brak zagrozenia pasujacych do filtrow."}),q&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly zagrozenia"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(q),U(!0)},children:"Edytuj"}),!q.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("threat",q.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>ee(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane zagrozenia"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:q.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:q.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:q.category,color:Wi[q.category]})}),e.jsx(pn,{label:"Zrodlo",value:e.jsx(Ot,{text:q.source})}),e.jsx(pn,{label:"CIA",value:e.jsx(Hv,{cia:q.cia_impact})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:q.is_system?"Systemowy":"Organizacyjny",color:q.is_system?"#3b82f6":"#16a34a"})}),q.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:q.description})]}),q.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:q.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=Et(q.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane podatnosci (${K.weaknesses.length})`}),K.weaknesses.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.weaknesses.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=u.find(Te=>Te.id===ue.weakness_id);ke&&(s("weaknesses"),W(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.weakness_ref_id})," ",ue.weakness_name]}),ue.relevance&&e.jsx(Ot,{text:ue.relevance,color:gn[ue.relevance]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane zabezpieczenia (${K.controls.length})`}),K.controls.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.controls.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=f.find(Te=>Te.id===ue.control_id);ke&&(s("controls"),L(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.control_ref_id})," ",ue.control_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})(),e.jsx(Qa,{number:"",label:`Sugerowane podatnosci (${H.length})`}),H.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak sugestii"}),H.map(K=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id})," ",K.name]}),e.jsx(Ot,{text:K.relevance,color:gn[K.relevance]})]},K.weakness_id)),e.jsx(Qa,{number:"",label:`Sugerowane zabezpieczenia (${P.length})`}),P.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak sugestii"}),P.map(K=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id})," ",K.name,K.applied_status&&e.jsx(Ot,{text:K.applied_status,color:"#16a34a"})]}),e.jsx(Ot,{text:K.effectiveness,color:gn[K.effectiveness]})]},K.control_id))]})]})]})]}),a==="weaknesses"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:at.filteredCount,totalCount:at.totalCount,unitLabel:"podatnosci",search:at.search,onSearchChange:at.setSearch,searchPlaceholder:"Szukaj podatnosci...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:at.hasActiveFilters,onClearFilters:at.clearAllFilters,columns:km,visibleColumns:Tt,onToggleColumn:xe,data:at.filtered,exportFilename:"podatnosci",primaryLabel:"Nowa podatnosc",onPrimaryAction:()=>{R(null),U(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:me?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:km,visibleColumns:Tt,data:at.pageData,rowKey:K=>K.id,selectedKey:me?.id??null,onRowClick:K=>W(me?.id===K.id?null:K),renderCell:De,sortField:at.sortField,sortDir:at.sortDir,onSort:at.toggleSort,columnFilters:at.columnFilters,onColumnFilter:at.setColumnFilter,showFilters:et,page:at.page,totalPages:at.totalPages,pageSize:at.pageSize,totalItems:at.totalCount,filteredItems:at.filteredCount,onPageChange:at.setPage,onPageSizeChange:at.setPageSize,loading:y,emptyMessage:"Brak podatnosci w katalogu.",emptyFilteredMessage:"Brak podatnosci pasujacych do filtrow."}),me&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly podatnosci"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(me),U(!0)},children:"Edytuj"}),!me.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("weakness",me.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>W(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane podatnosci"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:me.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:me.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:me.category,color:Wi[me.category]})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:me.is_system?"Systemowy":"Organizacyjny",color:me.is_system?"#3b82f6":"#16a34a"})}),me.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:me.description})]}),me.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:me.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=ge(me.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane zagrozenia (${K.threats.length})`}),K.threats.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.threats.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=o.find(Te=>Te.id===ue.threat_id);ke&&(s("threats"),ee(ke),At(ke.id))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.threat_ref_id})," ",ue.threat_name]}),ue.relevance&&e.jsx(Ot,{text:ue.relevance,color:gn[ue.relevance]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane zabezpieczenia (${K.controls.length})`}),K.controls.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.controls.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=f.find(Te=>Te.id===ue.control_id);ke&&(s("controls"),L(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.control_ref_id})," ",ue.control_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})()]})]})]})]}),a==="controls"&&e.jsxs(e.Fragment,{children:[e.jsx(ma,{filteredCount:nt.filteredCount,totalCount:nt.totalCount,unitLabel:"zabezpieczen",search:nt.search,onSearchChange:nt.setSearch,searchPlaceholder:"Szukaj zabezpieczen...",showFilters:et,onToggleFilters:()=>it(K=>!K),hasActiveFilters:nt.hasActiveFilters,onClearFilters:nt.clearAllFilters,columns:zm,visibleColumns:Ie,onToggleColumn:mt,data:nt.filtered,exportFilename:"zabezpieczenia",primaryLabel:"Nowe zabezpieczenie",onPrimaryAction:()=>{R(null),U(!0)}}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:J?"1fr 400px":"1fr",gap:14},children:[e.jsx(Ea,{columns:zm,visibleColumns:Ie,data:nt.pageData,rowKey:K=>K.id,selectedKey:J?.id??null,onRowClick:K=>L(J?.id===K.id?null:K),renderCell:Ne,sortField:nt.sortField,sortDir:nt.sortDir,onSort:nt.toggleSort,columnFilters:nt.columnFilters,onColumnFilter:nt.setColumnFilter,showFilters:et,page:nt.page,totalPages:nt.totalPages,pageSize:nt.pageSize,totalItems:nt.totalCount,filteredItems:nt.filteredCount,onPageChange:nt.setPage,onPageSizeChange:nt.setPageSize,loading:y,emptyMessage:"Brak zabezpieczen w katalogu.",emptyFilteredMessage:"Brak zabezpieczen pasujacych do filtrow."}),J&&e.jsxs("div",{className:"card",style:{position:"sticky",top:0,alignSelf:"start",maxHeight:"calc(100vh - 100px)",overflowY:"auto"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Szczegoly zabezpieczenia"}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(J),U(!0)},children:"Edytuj"}),!J.is_system&&e.jsx("button",{className:"btn btn-sm",style:{color:"var(--red)"},onClick:()=>ae("control",J.id),children:"Archiwizuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>L(null),children:""})]})]}),e.jsxs("div",{style:{fontSize:12,lineHeight:2},children:[e.jsx(Qa,{number:"",label:"Dane zabezpieczenia"}),e.jsx(pn,{label:"Ref ID",value:e.jsx("span",{style:{fontFamily:"'JetBrains Mono',monospace"},children:J.ref_id})}),e.jsx(pn,{label:"Nazwa",value:e.jsx("strong",{children:J.name})}),e.jsx(pn,{label:"Kategoria",value:e.jsx(Ot,{text:J.category,color:Wi[J.category]})}),e.jsx(pn,{label:"Typ implementacji",value:e.jsx(Ot,{text:J.implementation_type,color:Wi[J.implementation_type]})}),e.jsx(pn,{label:"Typ",value:e.jsx(Ot,{text:J.is_system?"Systemowy":"Organizacyjny",color:J.is_system?"#3b82f6":"#16a34a"})}),J.description&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Opis"}),e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",background:"var(--bg-inset, var(--bg-alt))",borderRadius:6,padding:8,marginBottom:8},children:J.description})]}),J.asset_category_ids.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4},children:J.asset_category_ids.map(K=>{const ue=x.find(ke=>ke.id===K);return ue?e.jsx(Ot,{text:ue.name,color:"#64748b"},K):null})})]}),_t&&(()=>{const K=Ft(J.id);return e.jsxs(e.Fragment,{children:[e.jsx(Qa,{number:"",label:`Powiazane zagrozenia (${K.threats.length})`}),K.threats.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.threats.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=o.find(Te=>Te.id===ue.threat_id);ke&&(s("threats"),ee(ke),At(ke.id))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.threat_ref_id})," ",ue.threat_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id)),e.jsx(Qa,{number:"",label:`Powiazane podatnosci (${K.weaknesses.length})`}),K.weaknesses.length===0&&e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak powiazan"}),K.weaknesses.map(ue=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12,cursor:"pointer",color:"var(--blue)"},onClick:()=>{const ke=u.find(Te=>Te.id===ue.weakness_id);ke&&(s("weaknesses"),W(ke))},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:ue.weakness_ref_id})," ",ue.weakness_name]}),ue.effectiveness&&e.jsx(Ot,{text:ue.effectiveness,color:gn[ue.effectiveness]})]},ue.id))]})})()]})]})]})]}),a==="correlations"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(139,92,246,0.06)",border:"1px solid rgba(139,92,246,0.15)",borderRadius:8,padding:"10px 16px",marginBottom:14,fontSize:12,color:"var(--text-secondary)",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsxs("span",{children:[e.jsx("strong",{children:"Mapa powiazan"}),"  trojstronny widok zagrozen, podatnosci i zabezpieczen. Kliknij element w dowolnej kolumnie aby zobaczyc jego powiazania. Mozesz tworzyc nowe korelacje bezposrednio z tego widoku."]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["Korelacje: ",e.jsx("strong",{children:tt.length+xt.length+Nt.length})]}),e.jsxs("select",{className:"form-control",value:z,onChange:K=>{k(K.target.value),oa(null)},style:{width:260,padding:"5px 10px",fontSize:12},children:[e.jsx("option",{value:"tw",children:"Zagrozenie  Podatnosc"}),e.jsx("option",{value:"tc",children:"Zagrozenie  Zabezpieczenie"}),e.jsx("option",{value:"wc",children:"Podatnosc  Zabezpieczenie"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>{Se(null),fe(!0)},children:"+ Nowa korelacja"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{border:"1px solid rgba(220,38,38,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(220,38,38,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#dc2626"},children:["Zagrozenia (",o.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj zagrozen...",value:It.threats,onChange:K=>va(ue=>({...ue,threats:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:o.filter(K=>!It.threats||K.ref_id.toLowerCase().includes(It.threats.toLowerCase())||K.name.toLowerCase().includes(It.threats.toLowerCase())).map(K=>{const ue=rt?.type==="threat"&&rt.id===K.id,ke=rt&&rt.type!=="threat"&&(rt.type==="weakness"&&tt.some(Te=>Te.threat_id===K.id&&Te.weakness_id===rt.id)||rt.type==="control"&&xt.some(Te=>Te.threat_id===K.id&&Te.control_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(220,38,38,0.15)":ke?"rgba(220,38,38,0.08)":"transparent",border:ke?"1px solid rgba(220,38,38,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"threat",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#dc2626",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#dc2626"},children:""})]},K.id)})})]}),e.jsxs("div",{style:{border:"1px solid rgba(245,158,11,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(245,158,11,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#f59e0b"},children:["Podatnosci (",u.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj podatnosci...",value:It.weaknesses,onChange:K=>va(ue=>({...ue,weaknesses:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:u.filter(K=>!It.weaknesses||K.ref_id.toLowerCase().includes(It.weaknesses.toLowerCase())||K.name.toLowerCase().includes(It.weaknesses.toLowerCase())).map(K=>{const ue=rt?.type==="weakness"&&rt.id===K.id,ke=rt&&rt.type!=="weakness"&&(rt.type==="threat"&&tt.some(Te=>Te.weakness_id===K.id&&Te.threat_id===rt.id)||rt.type==="control"&&Nt.some(Te=>Te.weakness_id===K.id&&Te.control_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(245,158,11,0.15)":ke?"rgba(245,158,11,0.08)":"transparent",border:ke?"1px solid rgba(245,158,11,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"weakness",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#f59e0b",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#f59e0b"},children:""})]},K.id)})})]}),e.jsxs("div",{style:{border:"1px solid rgba(22,163,74,0.2)",borderRadius:8,overflow:"hidden"},children:[e.jsxs("div",{style:{background:"rgba(22,163,74,0.08)",padding:"8px 12px",display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsxs("span",{style:{fontWeight:600,fontSize:12,color:"#16a34a"},children:["Zabezpieczenia (",f.length,")"]})]}),e.jsx("div",{style:{padding:"8px 8px 4px"},children:e.jsx("input",{className:"form-control",style:{fontSize:11,padding:"4px 8px",marginBottom:6},placeholder:"Szukaj zabezpieczen...",value:It.controls,onChange:K=>va(ue=>({...ue,controls:K.target.value}))})}),e.jsx("div",{style:{maxHeight:320,overflowY:"auto",padding:"0 4px 4px"},children:f.filter(K=>!It.controls||K.ref_id.toLowerCase().includes(It.controls.toLowerCase())||K.name.toLowerCase().includes(It.controls.toLowerCase())).map(K=>{const ue=rt?.type==="control"&&rt.id===K.id,ke=rt&&rt.type!=="control"&&(rt.type==="threat"&&xt.some(Te=>Te.control_id===K.id&&Te.threat_id===rt.id)||rt.type==="weakness"&&Nt.some(Te=>Te.control_id===K.id&&Te.weakness_id===rt.id));return e.jsxs("div",{style:{padding:"5px 8px",fontSize:11,cursor:"pointer",borderRadius:4,marginBottom:2,background:ue?"rgba(22,163,74,0.15)":ke?"rgba(22,163,74,0.08)":"transparent",border:ke?"1px solid rgba(22,163,74,0.3)":"1px solid transparent",fontWeight:ue||ke?600:400},onClick:()=>oa(ue?null:{type:"control",id:K.id}),children:[e.jsx("span",{style:{fontFamily:"monospace",color:"#16a34a",marginRight:4},children:K.ref_id}),K.name,ke&&e.jsx("span",{style:{marginLeft:4,color:"#16a34a"},children:""})]},K.id)})})]})]}),rt&&(()=>{const K=rt.type==="threat"?o.find($e=>$e.id===rt.id):rt.type==="weakness"?u.find($e=>$e.id===rt.id):f.find($e=>$e.id===rt.id);if(!K)return null;const ue=rt.type==="threat"?"Zagrozenie":rt.type==="weakness"?"Podatnosc":"Zabezpieczenie",ke=rt.type==="threat"?"#dc2626":rt.type==="weakness"?"#f59e0b":"#16a34a",Te=rt.type==="threat"?tt.filter($e=>$e.threat_id===rt.id):rt.type==="control"?Nt.filter($e=>$e.control_id===rt.id):[],Me=rt.type==="weakness"?tt.filter($e=>$e.weakness_id===rt.id):rt.type==="control"?xt.filter($e=>$e.control_id===rt.id):[],Ye=rt.type==="threat"?xt.filter($e=>$e.threat_id===rt.id):rt.type==="weakness"?Nt.filter($e=>$e.weakness_id===rt.id):[];return e.jsxs("div",{style:{border:`1px solid ${ke}30`,borderRadius:8,padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{fontWeight:700,color:ke},children:[ue,":"]}),e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:K.ref_id}),e.jsx("span",{style:{fontWeight:500},children:K.name})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",onClick:()=>{R(K),U(!0)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>oa(null),children:""})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:(rt.type==="weakness"||rt.type==="threat","1fr 1fr"),gap:16},children:[rt.type!=="threat"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:6},children:["Powiazane zagrozenia (",Me.length,")"]}),Me.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#dc2626"},children:$e.threat_ref_id})," ",$e.threat_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[($e.relevance||$e.effectiveness)&&e.jsx(Ot,{text:$e.relevance??$e.effectiveness,color:gn[$e.relevance??$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#dc2626"},onClick:()=>{Se(null),k(rt.type==="weakness"?"tw":"tc"),fe(!0)},children:"+ Powiaz z zagrozeniem"})]}),rt.type!=="weakness"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#f59e0b",marginBottom:6},children:["Powiazane podatnosci (",Te.length,")"]}),Te.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#f59e0b"},children:$e.weakness_ref_id})," ",$e.weakness_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[($e.relevance||$e.effectiveness)&&e.jsx(Ot,{text:$e.relevance??$e.effectiveness,color:gn[$e.relevance??$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#f59e0b"},onClick:()=>{Se(null),k(rt.type==="threat"?"tw":"wc"),fe(!0)},children:"+ Powiaz z podatnoscia"})]}),rt.type!=="control"&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#16a34a",marginBottom:6},children:["Powiazane zabezpieczenia (",Ye.length,")"]}),Ye.map($e=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"4px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#16a34a"},children:$e.control_ref_id})," ",$e.control_name]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[$e.effectiveness&&e.jsx(Ot,{text:$e.effectiveness,color:gn[$e.effectiveness]}),!$e.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>ce($e.id),children:""})]})]},$e.id)),e.jsx("button",{className:"btn btn-sm",style:{marginTop:6,fontSize:10,color:"#16a34a"},onClick:()=>{Se(null),k(rt.type==="threat"?"tc":"wc"),fe(!0)},children:"+ Powiaz z zabezpieczeniem"})]})]})]})})(),e.jsxs("details",{style:{marginTop:16},children:[e.jsxs("summary",{style:{cursor:"pointer",fontSize:12,color:"var(--text-muted)",padding:"8px 0"},children:["Widok tabelaryczny korelacji (",ut.totalCount,")"]}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{className:"toolbar",style:{flexWrap:"wrap",gap:8,marginBottom:0},children:e.jsx("div",{className:"toolbar-left",style:{alignItems:"center"},children:e.jsx("input",{className:"form-control",style:{width:200,padding:"5px 10px",fontSize:12},placeholder:"Szukaj korelacji...",value:ut.search,onChange:K=>ut.setSearch(K.target.value)})})}),de?e.jsx("div",{className:"card",style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"Ladowanie..."}):e.jsx(Ea,{columns:Vv,visibleColumns:Oe,data:ut.pageData,rowKey:K=>K.id,selectedKey:ie?.id??null,onRowClick:K=>ve(ie?.id===K.id?null:K),renderCell:Fe,sortField:ut.sortField,sortDir:ut.sortDir,onSort:ut.toggleSort,columnFilters:ut.columnFilters,onColumnFilter:ut.setColumnFilter,showFilters:et,page:ut.page,totalPages:ut.totalPages,pageSize:ut.pageSize,totalItems:ut.totalCount,filteredItems:ut.filteredCount,onPageChange:ut.setPage,onPageSizeChange:ut.setPageSize,loading:de,emptyMessage:"Brak korelacji.",emptyFilteredMessage:"Brak korelacji pasujacych do filtrow."})]})]})]}),a==="coverage"&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.15)",borderRadius:8,padding:"14px 18px",marginBottom:16,fontSize:12,lineHeight:1.8},children:[e.jsx("div",{style:{fontWeight:700,fontSize:14,color:"var(--blue)",marginBottom:6},children:"Analiza Luk i Skutecznosci Zabezpieczen"}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Ta analiza pokazuje, dla kazdej kategorii aktywow:"}),e.jsxs("ul",{style:{margin:"4px 0 0 16px",padding:0,color:"var(--text-secondary)"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Pokrycie"}),"  ile zagrozen przypisanych do kategorii ma powiazane zabezpieczenia (korelacje ZagrozenieZabezpieczenie)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Luki"}),"  zagrozenia BEZ zabezpieczen. Kliknij luke aby od razu dodac brakujace zabezpieczenie"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Skutecznosc"}),"  sredni poziom skutecznosci zastosowanych zabezpieczen (na podstawie ocen korelacji)"]})]})]}),e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:14},children:"Pokrycie wg kategorii aktywow"}),oe?e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:24},children:"Analizowanie pokrycia..."}):x.length===0?e.jsx("div",{style:{color:"var(--text-muted)"},children:"Brak kategorii aktywow"}):e.jsxs(e.Fragment,{children:[x.filter(K=>Ve[K.id]&&Ve[K.id].total_threats>0).sort((K,ue)=>(Ve[K.id]?.coverage_pct??0)-(Ve[ue.id]?.coverage_pct??0)).map(K=>{const ue=Ve[K.id],ke=Qe[K.id]??!1;return e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{cursor:"pointer"},onClick:()=>lt(Te=>({...Te,[K.id]:!Te[K.id]})),children:e.jsx(N3,{label:`${K.name} (${ue.covered}/${ue.total_threats})`,pct:ue.coverage_pct,gaps:ue.gaps.length})}),ke&&ue.gaps.length>0&&e.jsxs("div",{style:{marginTop:4,marginLeft:8,padding:"10px 14px",background:"rgba(220,38,38,0.04)",border:"1px solid rgba(220,38,38,0.15)",borderRadius:6},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:8},children:["Luki  zagrozenia bez zabezpieczen (",ue.gaps.length,")"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:8},children:'Te zagrozenia nie maja powiazanego zabezpieczenia. Kliknij "Dodaj zabezpieczenie" aby utworzyc korelacje.'}),ue.gaps.map((Te,Me)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontSize:12},children:[e.jsx("span",{style:{color:"#dc2626",marginRight:6},children:""}),Te.ref_id&&e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,marginRight:4},children:Te.ref_id}),Te.name??"Nieznane zagrozenie"]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,color:"#16a34a",border:"1px solid rgba(22,163,74,0.3)",background:"rgba(22,163,74,0.06)"},onClick:()=>{o.find($e=>$e.ref_id===Te.ref_id)&&(k("tc"),Se(null),fe(!0))},children:"+ Dodaj zabezpieczenie"})]},Me))]}),ke&&ue.gaps.length===0&&e.jsx("div",{style:{marginTop:4,marginLeft:8,padding:"8px 14px",fontSize:12,background:"rgba(22,163,74,0.06)",border:"1px solid rgba(22,163,74,0.15)",borderRadius:6,color:"#16a34a"},children:" Pelne pokrycie  wszystkie zagrozenia maja powiazane zabezpieczenia"})]},K.id)}),Object.keys(Ve).length===0&&e.jsx("div",{style:{color:"var(--text-muted)"},children:"Brak danych pokrycia  sprawdz czy tabele korelacji maja dane."})]})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Ocena Skutecznosci Zabezpieczen"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>ze(!ca),style:{fontSize:11},children:ca?"Zwien":"Rozwin analize"})]}),e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:"Ocena skutecznosci kazdego zabezpieczenia na podstawie: ilosci pokrywanych zagrozen, sredniego poziomu skutecznosci (z korelacji) oraz pokrycia kategorii aktywow."}),ca&&_t&&e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Pokrywa zagrozen"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Pokrywa podatnosci"}),e.jsx("th",{style:{textAlign:"center",padding:"8px 6px",color:"var(--text-muted)"},children:"Sred. skutecznosc"}),e.jsx("th",{style:{textAlign:"left",padding:"8px 6px",color:"var(--text-muted)"},children:"Ocena"})]})}),e.jsx("tbody",{children:f.map(K=>{const ue=xt.filter(jt=>jt.control_id===K.id),ke=Nt.filter(jt=>jt.control_id===K.id),Te=[...ue,...ke].map(jt=>jt.effectiveness).filter(Boolean),Me=Te.length>0?Te.reduce((jt,Kt)=>jt+(Kt==="HIGH"?3:Kt==="MEDIUM"?2:1),0)/Te.length:0,Ye=Me>=2.5?"Skuteczne":Me>=1.5?"Czesciowe":Me>0?"Niewystarczajace":"Brak oceny",$e=Me>=2.5?"#16a34a":Me>=1.5?"#f59e0b":Me>0?"#dc2626":"var(--text-muted)",yt=Me>0?Me/3*100:0;return e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsxs("td",{style:{padding:"6px"},children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600,color:"#16a34a",marginRight:4},children:K.ref_id}),K.name]}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:e.jsx("span",{style:{fontWeight:600},children:ue.length})}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:e.jsx("span",{style:{fontWeight:600},children:ke.length})}),e.jsx("td",{style:{textAlign:"center",padding:"6px"},children:Te.length>0?e.jsx(Ot,{text:Me>=2.5?"HIGH":Me>=1.5?"MEDIUM":"LOW",color:$e}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsx("td",{style:{padding:"6px",minWidth:160},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:6,background:"var(--bg-alt)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{height:"100%",width:`${yt}%`,background:$e,borderRadius:3,transition:"width 0.5s ease"}})}),e.jsx("span",{style:{fontSize:10,color:$e,fontWeight:600,whiteSpace:"nowrap"},children:Ye})]})})]},K.id)})})]})}),ca&&!_t&&e.jsx("div",{style:{textAlign:"center",color:"var(--text-muted)",padding:16},children:"Ladowanie danych korelacji..."})]})]}),a==="ai"&&t&&e.jsx(B3,{assetCategories:x,aiLoading:_,aiResult:C,aiError:O,hasFeature:r,onAction:async(K,ue)=>{E(!0),Q(null),N(null);try{const ke=await fetch(`${Ua}/api/v1/ai/${K}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ue)});if(!ke.ok){const Te=await ke.text();throw new Error(ke.status===503?"AI niedostepne":ke.status===429?"Limit zapytan przekroczony":Te)}N(await ke.json())}catch(ke){Q(ke instanceof Error?ke.message:"Blad AI")}finally{E(!1)}}}),e.jsx(E3,{open:M,onClose:()=>{U(!1),R(null)},tab:a,editItem:A,saving:Z,onSave:te,assetCategories:x,threats:o,weaknesses:u,controls:f,allTWLinks:tt,allTCLinks:xt,allWCLinks:Nt,onLinksChanged:()=>{ja()}}),e.jsx(R3,{open:je,onClose:()=>{fe(!1),Se(null)},corrType:z,editLink:_e,saving:Z,onSave:re,threats:o,weaknesses:u,controls:f})]})}function E3({open:t,onClose:r,tab:a,editItem:s,saving:o,onSave:d,assetCategories:u,threats:h,weaknesses:f,controls:p,allTWLinks:x,allTCLinks:j,allWCLinks:y,onLinksChanged:S}){const[w,b]=m.useState(""),[_,E]=m.useState(""),[C,N]=m.useState(""),[O,Q]=m.useState(""),[G,M]=m.useState("BOTH"),[U,A]=m.useState(""),[R,Z]=m.useState(!1),[F,q]=m.useState(!1),[ee,me]=m.useState(!1),[W,J]=m.useState([]);m.useEffect(()=>{if(t&&s){if(b(s.ref_id),E(s.name),N(s.description??""),Q(s.category),J(s.asset_category_ids??[]),"source"in s&&M(s.source),"cia_impact"in s){const z=s.cia_impact;Z(z?.C??!1),q(z?.I??!1),me(z?.A??!1)}"implementation_type"in s&&A(s.implementation_type)}else t&&(b(""),E(""),N(""),Q(""),M("BOTH"),A(""),Z(!1),q(!1),me(!1),J([]))},[t,s]);const L=z=>{z.preventDefault();const k={ref_id:w,name:_,description:C||null,category:O,asset_category_ids:W};a==="threats"&&(k.source=G,k.cia_impact={C:R,I:F,A:ee}),a==="controls"&&(k.implementation_type=U),d(k)},H=s?.is_system===!0,ne=a==="threats"?S3:a==="weaknesses"?k3:z3,P=a==="threats"?"zagrozenia":a==="weaknesses"?"podatnosci":"zabezpieczenia",T=H?`Podglad ${P} (systemowy)`:s?`Edytuj ${P}`:`Nowe ${P}`;return e.jsxs(gt,{open:t,onClose:r,title:T,wide:!0,children:[H&&e.jsx("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:6,padding:"8px 12px",marginBottom:16,fontSize:12,color:"var(--blue)"},children:"Wpis systemowy  tylko podglad. Aby edytowac, utworz kopie jako wpis organizacyjny."}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Ref ID"}),e.jsx("input",{className:"form-control",value:w,onChange:z=>b(z.target.value),required:!0,placeholder:"np. T-100",disabled:!!s,readOnly:H})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria"}),e.jsxs("select",{className:"form-control",value:O,onChange:z=>Q(z.target.value),required:!0,disabled:H,children:[e.jsx("option",{value:"",children:"Wybierz..."}),ne.map(z=>e.jsx("option",{value:z,children:z},z))]})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Nazwa"}),e.jsx("input",{className:"form-control",value:_,onChange:z=>E(z.target.value),required:!0,placeholder:"Nazwa wpisu",readOnly:H})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",value:C,onChange:z=>N(z.target.value),rows:3,placeholder:"Opcjonalny opis...",readOnly:H,style:{resize:"vertical"}})]}),a==="threats"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zrodlo"}),e.jsx("select",{className:"form-control",value:G,onChange:z=>M(z.target.value),disabled:H,children:w3.map(z=>e.jsx("option",{value:z,children:z},z))})]}),e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",display:"block",marginBottom:4},children:"Wplyw CIA"}),e.jsxs("div",{style:{display:"flex",gap:16,marginTop:6},children:[e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:R,onChange:z=>Z(z.target.checked),disabled:H}),e.jsx("span",{style:{fontWeight:600,color:"#dc2626"},children:"C"}),"onfidentiality"]}),e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:F,onChange:z=>q(z.target.checked),disabled:H}),e.jsx("span",{style:{fontWeight:600,color:"#f59e0b"},children:"I"}),"ntegrity"]}),e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ee,onChange:z=>me(z.target.checked),disabled:H}),e.jsx("span",{style:{fontWeight:600,color:"#16a34a"},children:"A"}),"vailability"]})]})]})]}),a==="controls"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Typ implementacji"}),e.jsxs("select",{className:"form-control",value:U,onChange:z=>A(z.target.value),required:!0,disabled:H,children:[e.jsx("option",{value:"",children:"Wybierz..."}),C3.map(z=>e.jsx("option",{value:z,children:z},z))]})]}),u.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",display:"block",marginBottom:4},children:"Kategorie aktywow"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6,maxHeight:120,overflow:"auto",padding:8,border:"1px solid var(--border)",borderRadius:6},children:u.map(z=>e.jsxs("label",{style:{display:"flex",gap:4,alignItems:"center",fontSize:12,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:W.includes(z.id),onChange:k=>{k.target.checked?J([...W,z.id]):J(W.filter(I=>I!==z.id))},disabled:H}),z.name]},z.id))})]}),s&&!H&&h&&f&&p&&e.jsx(F3,{tab:a,editItemId:s.id,threats:h,weaknesses:f,controls:p,allTWLinks:x??[],allTCLinks:j??[],allWCLinks:y??[],onLinksChanged:S}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,children:H?"Zamknij":"Anuluj"}),!H&&e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Zapisywanie...":s?"Zapisz zmiany":"Dodaj"})]})]})]})}function F3({tab:t,editItemId:r,threats:a,weaknesses:s,controls:o,allTWLinks:d,allTCLinks:u,allWCLinks:h,onLinksChanged:f}){const[p,x]=m.useState(!1),[j,y]=m.useState(""),[S,w]=m.useState("MEDIUM"),[b,_]=m.useState("first"),E="",C=t==="threats",N=t==="weaknesses",O=t==="controls",Q=C?d.filter(I=>I.threat_id===r):[],G=N?d.filter(I=>I.weakness_id===r):[],M=O?u.filter(I=>I.control_id===r):[],U=C?u.filter(I=>I.threat_id===r):[],A=N?h.filter(I=>I.weakness_id===r):[],R=O?h.filter(I=>I.control_id===r):[],Z=C?Q:N?G:M,F=C?U:N?A:R,q=C?"Powiazane podatnosci":"Powiazane zagrozenia",ee=C||N?"Powiazane zabezpieczenia":"Powiazane podatnosci",me=C?"#f59e0b":"#dc2626",W=C||N?"#16a34a":"#f59e0b",J=C?s:a,L=C||N?o:s,H=new Set(Z.map(I=>I.weakness_id??I.threat_id??I.control_id)),ne=new Set(F.map(I=>I.control_id??I.weakness_id??I.threat_id)),P=J.filter(I=>!H.has(I.id)),T=L.filter(I=>!ne.has(I.id)),z=async()=>{if(j){x(!0);try{let I="";const D={};b==="first"?C?(I="threat-weakness",D.threat_id=r,D.weakness_id=Number(j),D.relevance=S):N?(I="threat-weakness",D.threat_id=Number(j),D.weakness_id=r,D.relevance=S):(I="threat-control",D.threat_id=Number(j),D.control_id=r,D.effectiveness=S):C?(I="threat-control",D.threat_id=r,D.control_id=Number(j),D.effectiveness=S):N?(I="weakness-control",D.weakness_id=r,D.control_id=Number(j),D.effectiveness=S):(I="weakness-control",D.weakness_id=Number(j),D.control_id=r,D.effectiveness=S),await fetch(`${E}/api/v1/links/${I}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)}),y(""),w("MEDIUM"),f?.()}catch(I){alert("Blad dodawania powiazania: "+(I instanceof Error?I.message:I))}finally{x(!1)}}},k=async(I,D)=>{try{await fetch(`${E}/api/v1/links/${D}/${I}`,{method:"DELETE"}),f?.()}catch{}};return e.jsxs("div",{style:{marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,color:"var(--blue)",marginBottom:12},children:"Powiazania z innymi elementami katalogu"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:me,marginBottom:6},children:[q," (",Z.length,")"]}),Z.map(I=>{const D=I.weakness_ref_id??I.threat_ref_id??I.control_ref_id,de=I.weakness_name??I.threat_name??I.control_name,he=I.relevance??I.effectiveness,ie=C||N?"threat-weakness":"threat-control";return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:D})," ",de]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[he&&e.jsx(Ot,{text:he,color:gn[he]}),!I.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>k(I.id,ie),children:""})]})]},I.id)}),e.jsxs("div",{style:{display:"flex",gap:4,marginTop:6,alignItems:"center"},children:[e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:11,padding:"3px 6px"},value:b==="first"?j:"",onChange:I=>{_("first"),y(I.target.value?Number(I.target.value):"")},children:[e.jsx("option",{value:"",children:"+ Dodaj..."}),P.map(I=>e.jsxs("option",{value:I.id,children:[I.ref_id,"  ",I.name]},I.id))]}),b==="first"&&j&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-control",style:{width:80,fontSize:11,padding:"3px 6px"},value:S,onChange:I=>w(I.target.value),children:[e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"LOW",children:"LOW"})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},disabled:p,onClick:z,children:p?"...":"Dodaj"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:W,marginBottom:6},children:[ee," (",F.length,")"]}),F.map(I=>{const D=I.control_ref_id??I.weakness_ref_id??I.threat_ref_id,de=I.control_name??I.weakness_name??I.threat_name,he=I.effectiveness??I.relevance,ie=C?"threat-control":"weakness-control";return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"3px 0",borderBottom:"1px solid var(--border)",fontSize:11},children:[e.jsxs("span",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontWeight:600},children:D})," ",de]}),e.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[he&&e.jsx(Ot,{text:he,color:gn[he]}),!I.is_system&&e.jsx("button",{style:{fontSize:10,cursor:"pointer",color:"var(--red)",background:"none",border:"none"},onClick:()=>k(I.id,ie),children:""})]})]},I.id)}),e.jsxs("div",{style:{display:"flex",gap:4,marginTop:6,alignItems:"center"},children:[e.jsxs("select",{className:"form-control",style:{flex:1,fontSize:11,padding:"3px 6px"},value:b==="second"?j:"",onChange:I=>{_("second"),y(I.target.value?Number(I.target.value):"")},children:[e.jsx("option",{value:"",children:"+ Dodaj..."}),T.map(I=>e.jsxs("option",{value:I.id,children:[I.ref_id,"  ",I.name]},I.id))]}),b==="second"&&j&&e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-control",style:{width:80,fontSize:11,padding:"3px 6px"},value:S,onChange:I=>w(I.target.value),children:[e.jsx("option",{value:"HIGH",children:"HIGH"}),e.jsx("option",{value:"MEDIUM",children:"MEDIUM"}),e.jsx("option",{value:"LOW",children:"LOW"})]}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},disabled:p,onClick:z,children:p?"...":"Dodaj"})]})]})]})]})]})}function R3({open:t,onClose:r,corrType:a,editLink:s,saving:o,onSave:d,threats:u,weaknesses:h,controls:f}){const[p,x]=m.useState(""),[j,y]=m.useState(""),[S,w]=m.useState(""),[b,_]=m.useState("MEDIUM"),[E,C]=m.useState("MEDIUM"),[N,O]=m.useState("");m.useEffect(()=>{t&&s?(x(s.threat_id??""),y(s.weakness_id??""),w(s.control_id??""),_(s.relevance??"MEDIUM"),C(s.effectiveness??"MEDIUM"),O(s.description??"")):t&&(x(""),y(""),w(""),_("MEDIUM"),C("MEDIUM"),O(""))},[t,s]);const Q=A=>{A.preventDefault();const R={description:N||null};a==="tw"?(R.threat_id=Number(p),R.weakness_id=Number(j),R.relevance=b):a==="tc"?(R.threat_id=Number(p),R.control_id=Number(S),R.effectiveness=E):(R.weakness_id=Number(j),R.control_id=Number(S),R.effectiveness=E),d(R)},G=s?.is_system===!0,M=a==="tw"?"Zagrozenie  Podatnosc":a==="tc"?"Zagrozenie  Zabezpieczenie":"Podatnosc  Zabezpieczenie",U=G?`Podglad korelacji (${M})`:s?`Edytuj korelacje (${M})`:`Nowa korelacja (${M})`;return e.jsxs(gt,{open:t,onClose:r,title:U,wide:!0,children:[G&&e.jsx("div",{style:{background:"rgba(59,130,246,0.06)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:6,padding:"8px 12px",marginBottom:16,fontSize:12,color:"var(--blue)"},children:"Korelacja systemowa  tylko podglad."}),e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[a!=="wc"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zagrozenie"}),e.jsxs("select",{className:"form-control",value:p,onChange:A=>x(A.target.value?Number(A.target.value):""),required:!0,disabled:G||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zagrozenie..."}),u.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="tw"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:j,onChange:A=>y(A.target.value?Number(A.target.value):""),required:!0,disabled:G||!!s,children:[e.jsx("option",{value:"",children:"Wybierz podatnosc..."}),h.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="tc"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("select",{className:"form-control",value:S,onChange:A=>w(A.target.value?Number(A.target.value):""),required:!0,disabled:G||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zabezpieczenie..."}),f.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),a==="wc"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Podatnosc"}),e.jsxs("select",{className:"form-control",value:j,onChange:A=>y(A.target.value?Number(A.target.value):""),required:!0,disabled:G||!!s,children:[e.jsx("option",{value:"",children:"Wybierz podatnosc..."}),h.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("select",{className:"form-control",value:S,onChange:A=>w(A.target.value?Number(A.target.value):""),required:!0,disabled:G||!!s,children:[e.jsx("option",{value:"",children:"Wybierz zabezpieczenie..."}),f.map(A=>e.jsxs("option",{value:A.id,children:[A.ref_id,"  ",A.name]},A.id))]})]})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:a==="tw"?"Istotnosc":"Skutecznosc"}),e.jsx("select",{className:"form-control",value:a==="tw"?b:E,onChange:A=>a==="tw"?_(A.target.value):C(A.target.value),disabled:G,children:T3.map(A=>e.jsx("option",{value:A,children:A},A))})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4,marginTop:12},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis (opcjonalnie)"}),e.jsx("textarea",{className:"form-control",value:N,onChange:A=>O(A.target.value),rows:2,placeholder:"Opis korelacji...",readOnly:G,style:{resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,borderTop:"1px solid var(--border)",paddingTop:16},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,children:G?"Zamknij":"Anuluj"}),!G&&e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Zapisywanie...":s?"Zapisz zmiany":"Dodaj korelacje"})]})]})]})}function B3({assetCategories:t,aiLoading:r,aiResult:a,aiError:s,hasFeature:o,onAction:d}){const[u,h]=m.useState("scenarios"),[f,p]=m.useState(""),[x,j]=m.useState(""),[y,S]=m.useState(""),[w,b]=m.useState(""),[_,E]=m.useState("threat"),C=[{key:"scenarios",label:"Scenariusze ryzyka",feature:"scenario_generation"},{key:"enrich",label:"Wzbogac korelacje",feature:"correlation_enrichment"},{key:"search",label:"Wyszukiwanie NL",feature:"natural_language_search"},{key:"gap",label:"Analiza luk",feature:"gap_analysis"},{key:"assist",label:"Asystent wpisu",feature:"entry_assist"}].filter(O=>o(O.feature)),N=()=>{switch(u){case"scenarios":f&&d("generate-scenarios",{asset_category_id:Number(f)});break;case"enrich":d("enrich-correlations",{scope:"all"});break;case"search":x.length>=3&&d("search",{query:x});break;case"gap":d("gap-analysis",f?{asset_category_id:Number(f)}:{});break;case"assist":y&&d("assist-entry",{entry_type:_,name:y,description:w});break}};return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem"},children:"AI Asystent"}),C.length===0?e.jsx("p",{style:{color:"var(--text-muted)"},children:"Brak wlaczonych funkcji AI."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16},children:C.map(O=>e.jsx("button",{className:`btn ${u===O.key?"btn-primary":"btn-secondary"}`,style:{fontSize:12},onClick:()=>h(O.key),children:O.label},O.key))}),u==="scenarios"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria aktywa"}),e.jsxs("select",{className:"form-control",value:f,onChange:O=>p(O.target.value?Number(O.target.value):""),children:[e.jsx("option",{value:"",children:"Wybierz kategorie..."}),t.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),u==="search"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Pytanie"}),e.jsx("input",{className:"form-control",value:x,onChange:O=>j(O.target.value),placeholder:"np. Jakie zagrozenia dotycza pracy zdalnej?"})]}),u==="gap"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Kategoria aktywa (opcjonalnie)"}),e.jsxs("select",{className:"form-control",value:f,onChange:O=>p(O.target.value?Number(O.target.value):""),children:[e.jsx("option",{value:"",children:"Wszystkie kategorie"}),t.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),u==="assist"&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Typ wpisu"}),e.jsxs("select",{className:"form-control",value:_,onChange:O=>E(O.target.value),children:[e.jsx("option",{value:"threat",children:"Zagrozenie"}),e.jsx("option",{value:"weakness",children:"Podatnosc"}),e.jsx("option",{value:"control",children:"Zabezpieczenie"})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Nazwa"}),e.jsx("input",{className:"form-control",value:y,onChange:O=>S(O.target.value),placeholder:"Nazwa wpisu..."})]})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:4},children:[e.jsx("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:"Opis"}),e.jsx("textarea",{className:"form-control",value:w,onChange:O=>b(O.target.value),rows:2,placeholder:"Opis wpisu...",style:{resize:"vertical"}})]})]}),e.jsx("button",{className:"btn btn-primary",style:{marginTop:16},onClick:N,disabled:r,children:r?"AI analizuje...":"Uruchom AI"})]}),s&&e.jsx("div",{style:{marginTop:12,padding:"8px 12px",borderRadius:6,background:"rgba(239,68,68,0.1)",color:"var(--color-danger, #dc2626)",fontSize:"0.85rem"},children:s})]}),e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsx("h3",{style:{margin:"0 0 16px",fontSize:"1.1rem"},children:"Wyniki AI"}),r&&e.jsx("div",{style:{textAlign:"center",padding:24,color:"var(--text-muted)"},children:"AI analizuje dane..."}),!r&&!a&&!s&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.9rem"},children:'Wybierz funkcje AI i kliknij "Uruchom AI" aby zobaczyc wyniki.'}),a&&e.jsx("div",{style:{maxHeight:500,overflow:"auto"},children:e.jsx(O3,{data:a,mode:u})})]})]})}function O3({data:t,mode:r}){if(r==="scenarios"&&Array.isArray(t.scenarios)){const a=t.scenarios;return e.jsx("div",{children:a.map((s,o)=>e.jsxs("div",{style:{marginBottom:16,padding:12,border:"1px solid var(--border)",borderRadius:8},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:4},children:[String(s.threat_ref_id??"")," ",String(s.threat_name??`Scenariusz ${o+1}`)]}),s.rationale!=null&&e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",margin:"4px 0"},children:String(s.rationale)}),Array.isArray(s.weaknesses)&&s.weaknesses.length>0&&e.jsxs("div",{style:{fontSize:"0.8rem",marginTop:4},children:[e.jsx("span",{style:{fontWeight:600},children:"Podatnosci:"})," ",s.weaknesses.map(d=>String(d.name??d.ref_id??"")).join(", ")]}),Array.isArray(s.suggested_controls)&&s.suggested_controls.length>0&&e.jsxs("div",{style:{fontSize:"0.8rem",marginTop:4},children:[e.jsx("span",{style:{fontWeight:600},children:"Zabezpieczenia:"})," ",s.suggested_controls.map(d=>String(d.name??d.ref_id??"")).join(", ")]})]},o))})}if(r==="enrich"&&Array.isArray(t.suggestions)){const a=t.suggestions;return e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginBottom:12},children:[a.length," sugestii powiazan"]}),a.map((s,o)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsxs("span",{children:[e.jsx("strong",{children:String(s.threat_ref_id??"")}),"  ",String(s.target_type??""),": ",e.jsx("strong",{children:String(s.target_ref_id??"")})]}),e.jsx("span",{style:{color:"var(--text-muted)"},children:String(s.relevance??"")})]},o))]})}if(r==="gap"){const a=t;return e.jsxs("div",{children:[a.coverage_pct!=null&&e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:700,marginBottom:12},children:["Pokrycie: ",Number(a.coverage_pct).toFixed(0),"%"]}),Array.isArray(a.critical_gaps)&&a.critical_gaps.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontSize:"0.9rem",marginBottom:8},children:"Krytyczne luki"}),a.critical_gaps.map((s,o)=>e.jsxs("div",{style:{padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsx("strong",{children:String(s.area??"")}),": ",String(s.description??"")]},o))]}),Array.isArray(a.recommendations)&&a.recommendations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{style:{fontSize:"0.9rem",marginTop:16,marginBottom:8},children:"Rekomendacje"}),a.recommendations.map((s,o)=>e.jsxs("div",{style:{padding:"6px 0",borderBottom:"1px solid var(--border)",fontSize:"0.85rem"},children:[e.jsxs("strong",{children:["P",String(s.priority??""),":"]})," ",String(s.action??"")]},o))]})]})}return e.jsx("pre",{style:{fontSize:"0.8rem",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:400,overflow:"auto"},children:JSON.stringify(t,null,2)})}const ai="",D3={id:0,provider_type:"none",api_endpoint:null,api_key_masked:null,model_name:null,is_active:!1,max_tokens:4e3,temperature:.3,max_requests_per_user_per_hour:20,max_requests_per_user_per_day:100,max_requests_per_org_per_day:500,feature_scenario_generation:!0,feature_correlation_enrichment:!0,feature_natural_language_search:!0,feature_gap_analysis:!0,feature_entry_assist:!0,feature_interpret:!0,feature_translate:!0,feature_evidence:!0,feature_security_area_map:!0,feature_cross_mapping:!0,feature_coverage_report:!0,feature_document_import:!0,last_test_at:null,last_test_ok:null,last_test_error:null},Zv=[{value:"none",label:"Brak (wyczone)"},{value:"anthropic",label:"Anthropic Claude"},{value:"openai_compatible",label:"OpenAI-compatible (OpenAI, vLLM, Ollama)"}],Gv=[{key:"feature_scenario_generation",label:"Generowanie scenariuszy ryzyka",desc:"AI tworzy scenariusze zagroe dla kategorii aktyww",group:"catalog",promptKeys:["scenario_gen"]},{key:"feature_correlation_enrichment",label:"Wzbogacanie korelacji",desc:"AI sugeruje brakujce powizania threat-weakness-control",group:"catalog",promptKeys:["enrichment"]},{key:"feature_natural_language_search",label:"Wyszukiwanie w jzyku naturalnym",desc:"Wyszukiwanie w katalogach za pomoc pyta w jzyku naturalnym",group:"catalog",promptKeys:["search"]},{key:"feature_gap_analysis",label:"Analiza luk bezpieczestwa",desc:"AI analizuje pokrycie i identyfikuje luki",group:"catalog",promptKeys:["gap_analysis"]},{key:"feature_entry_assist",label:"Asystent tworzenia wpisw",desc:"AI podpowiada klasyfikacj i powizania nowych wpisw",group:"catalog",promptKeys:["assist"]},{key:"feature_interpret",label:"Interpretacja wymaga",desc:"AI wyjania wymagania z frameworkw w praktycznym kontekcie",group:"framework",promptKeys:["interpret"]},{key:"feature_translate",label:"Tumaczenie wymaga",desc:"AI tumaczy wymagania na wybrany jzyk z zachowaniem terminologii",group:"framework",promptKeys:["translate"]},{key:"feature_evidence",label:"Generowanie dowodw audytowych",desc:"AI generuje list dowodw jakich moe wymaga audytor",group:"framework",promptKeys:["evidence"]},{key:"feature_security_area_map",label:"Mapowanie obszarw bezpieczestwa",desc:"AI przypisuje wymagania do obszarw bezpieczestwa",group:"framework",promptKeys:["security_area_map"]},{key:"feature_cross_mapping",label:"Cross-mapping frameworkw",desc:"AI mapuje wymagania midzy rnymi standardami",group:"framework",promptKeys:["cross_mapping"]},{key:"feature_coverage_report",label:"Raporty pokrycia",desc:"AI generuje raporty zarzdcze o pokryciu midzy frameworkami",group:"framework",promptKeys:["coverage_report"]},{key:"feature_document_import",label:"Import dokumentw AI",desc:"AI analizuje dokumenty PDF/DOCX i wyodrbnia struktur frameworka",group:"framework",promptKeys:["document_import","document_import_continuation"]}],L3={SCENARIO_GEN:"Scenariusze ryzyka",ENRICHMENT:"Wzbogacanie korelacji",SEARCH:"Wyszukiwanie NLP",GAP_ANALYSIS:"Analiza luk",ASSIST:"Asystent wpisw",INTERPRET:"Interpretacja wymaga",TRANSLATE:"Tumaczenia",EVIDENCE:"Dowody audytowe",SECURITY_AREA_MAP:"Mapowanie obszarw",CROSS_MAPPING:"Cross-mapping",COVERAGE_REPORT:"Raporty pokrycia",DOCUMENT_IMPORT:"Import dokumentw"};function M3(){const[t,r]=m.useState(D3),[a,s]=m.useState(!0),[o,d]=m.useState(!1),[u,h]=m.useState(!1),[f,p]=m.useState(null),[x,j]=m.useState(null),[y,S]=m.useState(null),[w,b]=m.useState(null),[_,E]=m.useState(30),[C,N]=m.useState({provider_type:"none",api_endpoint:"",api_key:"",model_name:"",max_tokens:4e3,temperature:.3,max_requests_per_user_per_hour:20,max_requests_per_user_per_day:100,max_requests_per_org_per_day:500,feature_scenario_generation:!0,feature_correlation_enrichment:!0,feature_natural_language_search:!0,feature_gap_analysis:!0,feature_entry_assist:!0,feature_interpret:!0,feature_translate:!0,feature_evidence:!0,feature_security_area_map:!0,feature_cross_mapping:!0,feature_coverage_report:!0,feature_document_import:!0}),O=m.useCallback(async()=>{try{const Z=await fetch(`${ai}/api/v1/admin/ai-config`);if(Z.ok){const F=await Z.json();r(F),N({provider_type:F.provider_type,api_endpoint:F.api_endpoint??"",api_key:"",model_name:F.model_name??"",max_tokens:F.max_tokens,temperature:F.temperature,max_requests_per_user_per_hour:F.max_requests_per_user_per_hour,max_requests_per_user_per_day:F.max_requests_per_user_per_day,max_requests_per_org_per_day:F.max_requests_per_org_per_day,feature_scenario_generation:F.feature_scenario_generation,feature_correlation_enrichment:F.feature_correlation_enrichment,feature_natural_language_search:F.feature_natural_language_search,feature_gap_analysis:F.feature_gap_analysis,feature_entry_assist:F.feature_entry_assist,feature_interpret:F.feature_interpret,feature_translate:F.feature_translate,feature_evidence:F.feature_evidence,feature_security_area_map:F.feature_security_area_map,feature_cross_mapping:F.feature_cross_mapping,feature_coverage_report:F.feature_coverage_report,feature_document_import:F.feature_document_import})}}catch{}finally{s(!1)}},[]),Q=m.useCallback(async()=>{try{const Z=await fetch(`${ai}/api/v1/ai/usage-stats?days=${_}`);Z.ok&&j(await Z.json())}catch{}},[_]);m.useEffect(()=>{O()},[O]),m.useEffect(()=>{Q()},[Q]);const G=async()=>{d(!0),S(null),b(null);try{const Z={...C};C.api_key||delete Z.api_key;const F=await fetch(`${ai}/api/v1/admin/ai-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)});if(F.ok)b("Konfiguracja zapisana"),O(),Q(),setTimeout(()=>b(null),3e3);else{const q=await F.text();S(`Bd zapisu: ${q}`)}}catch(Z){S(`Bd: ${Z}`)}finally{d(!1)}},M=async()=>{h(!0),p(null);try{const F=await(await fetch(`${ai}/api/v1/admin/ai-config/test`,{method:"POST"})).json();p(F),O()}catch(Z){p({success:!1,message:`Bd poczenia: ${Z}`})}finally{h(!1)}},U=async Z=>{try{(await fetch(`${ai}/api/v1/admin/ai-config/${Z?"activate":"deactivate"}`,{method:"POST"})).ok&&(b(Z?"AI aktywowane":"AI dezaktywowane"),O(),setTimeout(()=>b(null),3e3))}catch(F){S(`Bd: ${F}`)}};if(a)return e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-muted)"},children:"adowanie konfiguracji AI..."});const A=Zv.find(Z=>Z.value===t.provider_type)?.label??t.provider_type,R=x?Object.values(x.by_action).reduce((Z,F)=>Z+F,0):0;return e.jsxs("div",{style:{padding:"20px 24px",maxWidth:1e3},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h1",{style:{fontSize:"1.4rem",fontWeight:700,margin:0},children:"Integracja AI"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13,marginTop:4},children:"AI jest opcjonalnym pluginem. System dziaa w peni bez AI  elementy AI pojawiaj si dopiero po aktywacji."})]}),y&&e.jsxs("div",{className:"card",style:{background:"var(--red-dim)",borderColor:"var(--red)",marginBottom:16,padding:"12px 16px"},children:[e.jsx("span",{style:{color:"var(--red)",fontSize:13},children:y}),e.jsx("button",{onClick:()=>S(null),className:"btn btn-sm",style:{float:"right",padding:"2px 8px",fontSize:11},children:""})]}),w&&e.jsx("div",{className:"card",style:{background:"var(--green-dim)",borderColor:"var(--green)",marginBottom:16,padding:"12px 16px"},children:e.jsx("span",{style:{color:"var(--green)",fontSize:13},children:w})}),e.jsxs("div",{className:"grid-2",style:{marginBottom:20,maxWidth:500},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 12px",borderRadius:12,background:t.is_active?"var(--green-dim)":"rgba(255,255,255,0.06)",color:t.is_active?"var(--green)":"var(--text-muted)",fontSize:13,fontWeight:600},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:t.is_active?"var(--green)":"var(--text-muted)"}}),t.is_active?"Aktywne":"Nieaktywne"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:6},children:"Status AI"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"16px 12px"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--blue)"},children:A}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:t.model_name||""})]})]}),e.jsxs("div",{className:"grid-2",style:{alignItems:"start"},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Dostawca AI"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ providera"}),e.jsx("select",{className:"form-control",value:C.provider_type,onChange:Z=>N({...C,provider_type:Z.target.value}),children:Zv.map(Z=>e.jsx("option",{value:Z.value,children:Z.label},Z.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Model"}),e.jsx("input",{className:"form-control",value:C.model_name,onChange:Z=>N({...C,model_name:Z.target.value}),placeholder:C.provider_type==="anthropic"?"claude-sonnet-4-5-20250929":"gpt-4o"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"API Endpoint"}),e.jsx("input",{className:"form-control",value:C.api_endpoint,onChange:Z=>N({...C,api_endpoint:Z.target.value}),placeholder:C.provider_type==="anthropic"?"https://api.anthropic.com":"https://api.openai.com"})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["API Key",t.api_key_masked&&e.jsxs("span",{style:{fontWeight:400,textTransform:"none",letterSpacing:0},children:[" ","(aktualny: ",t.api_key_masked,")"]})]}),e.jsx("input",{className:"form-control",type:"password",value:C.api_key,onChange:Z=>N({...C,api_key:Z.target.value}),placeholder:"Zostaw puste aby nie zmienia"})]}),e.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-primary",onClick:G,disabled:o,children:o?"Zapisywanie...":"Zapisz"}),e.jsx("button",{className:"btn",onClick:M,disabled:u||C.provider_type==="none",style:u?{opacity:.7}:void 0,children:u?"Testowanie...":"Testuj poczenie"}),t.id>0&&e.jsx("button",{className:t.is_active?"btn btn-danger":"btn",onClick:()=>U(!t.is_active),style:t.is_active?void 0:{color:"var(--green)",borderColor:"rgba(34,197,94,0.3)"},children:t.is_active?"Dezaktywuj":"Aktywuj AI"})]}),f&&e.jsxs("div",{style:{marginTop:12,padding:"8px 12px",borderRadius:6,fontSize:13,background:f.success?"var(--green-dim)":"var(--red-dim)",color:f.success?"var(--green)":"var(--red)"},children:[f.success?"OK":"Bd",": ",f.message,f.response_time_ms!=null&&e.jsxs("span",{style:{opacity:.7},children:[" (",f.response_time_ms,"ms)"]})]}),t.last_test_at&&e.jsxs("div",{style:{marginTop:6,fontSize:11,color:"var(--text-muted)"},children:["Ostatni test: ",new Date(t.last_test_at).toLocaleString("pl-PL"),t.last_test_ok?"  OK":`  ${t.last_test_error}`]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Parametry modelu"}),e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Max tokens"}),e.jsx("input",{className:"form-control",type:"number",value:C.max_tokens,onChange:Z=>N({...C,max_tokens:parseInt(Z.target.value)||4e3})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Temperature"}),e.jsx("input",{className:"form-control",type:"number",step:"0.05",min:"0",max:"1",value:C.temperature,onChange:Z=>N({...C,temperature:parseFloat(Z.target.value)||.3})})]})]}),e.jsx("div",{className:"card-title",style:{marginTop:8},children:"Limity zapyta"}),e.jsxs("div",{className:"grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik / h"}),e.jsx("input",{className:"form-control",type:"number",value:C.max_requests_per_user_per_hour,onChange:Z=>N({...C,max_requests_per_user_per_hour:parseInt(Z.target.value)||20})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik / dzie"}),e.jsx("input",{className:"form-control",type:"number",value:C.max_requests_per_user_per_day,onChange:Z=>N({...C,max_requests_per_user_per_day:parseInt(Z.target.value)||100})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Organizacja / dzie"}),e.jsx("input",{className:"form-control",type:"number",value:C.max_requests_per_org_per_day,onChange:Z=>N({...C,max_requests_per_org_per_day:parseInt(Z.target.value)||500})})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:G,disabled:o,children:o?"Zapisywanie...":"Zapisz parametry"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Funkcje AI"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",margin:"0 0 14px"},children:"Wcz/wycz poszczeglne moliwoci AI. Wyczone nie bd widoczne w UI."}),e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8},children:"Smart Catalog"}),Gv.filter(Z=>Z.group==="catalog").map(Z=>e.jsx(Kv,{ft:Z,form:C,setForm:N},Z.key)),e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:8,marginTop:16},children:"Frameworki / Dokumenty"}),Gv.filter(Z=>Z.group==="framework").map(Z=>e.jsx(Kv,{ft:Z,form:C,setForm:N},Z.key)),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:G,disabled:o,style:{marginTop:4},children:o?"Zapisywanie...":"Zapisz funkcje"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-title",children:"Informacje o poczeniu"}),e.jsx("table",{style:{width:"100%",fontSize:13},children:e.jsxs("tbody",{children:[e.jsx(pl,{label:"Provider",value:A}),e.jsx(pl,{label:"Model",value:t.model_name??""}),e.jsx(pl,{label:"Endpoint",value:t.api_endpoint??""}),e.jsx(pl,{label:"API Key",value:t.api_key_masked??"nie ustawiony"}),e.jsx(pl,{label:"Status",value:t.is_active?e.jsx("span",{className:"score-badge badge-green",children:"Aktywne"}):e.jsx("span",{className:"score-badge badge-red",children:"Nieaktywne"})}),e.jsx(pl,{label:"Ostatni test",value:t.last_test_at?e.jsxs(e.Fragment,{children:[new Date(t.last_test_at).toLocaleString("pl-PL")," ",t.last_test_ok?e.jsx("span",{className:"score-badge badge-green",style:{marginLeft:6},children:"OK"}):e.jsx("span",{className:"score-badge badge-red",style:{marginLeft:6},children:"Bd"})]}):""})]})})]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:4},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("div",{className:"card-title",style:{margin:0},children:"Statystyki uycia"}),e.jsx("div",{style:{display:"flex",gap:4},children:[7,30,90].map(Z=>e.jsxs("button",{className:`btn btn-sm ${Z===_?"btn-primary":""}`,onClick:()=>E(Z),style:{padding:"3px 10px",fontSize:11},children:[Z,"d"]},Z))})]}),!x||x.requests_count===0?e.jsx("div",{style:{textAlign:"center",padding:"20px 0",color:"var(--text-muted)",fontSize:13},children:"Brak danych o uyciu AI w wybranym okresie."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:10,marginBottom:16},children:[e.jsx(Mo,{label:"Zapyta",value:String(x.requests_count),color:"var(--blue)"}),e.jsx(Mo,{label:"Tokeny IN",value:(x.tokens_input??0).toLocaleString("pl-PL"),color:"var(--cyan, #06b6d4)"}),e.jsx(Mo,{label:"Tokeny OUT",value:(x.tokens_output??0).toLocaleString("pl-PL"),color:"var(--purple)"}),e.jsx(Mo,{label:"Koszt",value:`$${x.cost_usd.toFixed(4)}`,color:"var(--orange)"}),e.jsx(Mo,{label:"Akceptacja",value:x.acceptance_rate!=null?`${x.acceptance_rate.toFixed(0)}%`:"",color:"var(--green)"})]}),x.requests_with_tracking<x.requests_count&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:12,padding:"6px 10px",background:"var(--bg-subtle)",borderRadius:4},children:["ledzenie tokenw/kosztw dostpne dla ",x.requests_with_tracking," z ",x.requests_count," zapyta.",x.requests_with_tracking===0&&" Koszty pojawi si po pierwszym udanym zapytaniu AI z nowym kodem."]}),R>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:700,textTransform:"uppercase",letterSpacing:"0.06em",color:"var(--text-muted)",marginBottom:10},children:"Rozkad wg typu"}),Object.entries(x.by_action).sort(([,Z],[,F])=>F-Z).map(([Z,F])=>{const q=R>0?F/R*100:0;return e.jsxs("div",{className:"bar-row",children:[e.jsx("div",{className:"bar-label",children:L3[Z]??Z}),e.jsx("div",{className:"bar-track",children:e.jsx("div",{className:"bar-fill","data-value":F,style:{width:`${Math.max(q,3)}%`,background:"var(--blue)"}})}),e.jsx("div",{className:"bar-score",children:F})]},Z)})]})]})]})]})}function pl({label:t,value:r}){return e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"6px 0",color:"var(--text-muted)",fontSize:12,width:110,verticalAlign:"top"},children:t}),e.jsx("td",{style:{padding:"6px 0",fontWeight:500,wordBreak:"break-all"},children:r})]})}function Kv({ft:t,form:r,setForm:a}){const s=!!r[t.key],[o,d]=m.useState(null),[u,h]=m.useState(""),[f,p]=m.useState(""),[x,j]=m.useState(null),[y,S]=m.useState(!1),w=async E=>{if(o===E){d(null);return}try{const C=await fetch(`${ai}/api/v1/admin/ai-prompts/${E}`);if(!C.ok)throw new Error("Nie znaleziono promptu");const N=await C.json();h(N.prompt_text),p(N.default_text||""),j({display_name:N.display_name,is_customized:N.is_customized}),d(E)}catch{alert("Nie udao si zaadowa promptu")}},b=async()=>{if(o){S(!0);try{await fetch(`${ai}/api/v1/admin/ai-prompts/${o}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt_text:u})}),j(E=>E&&{...E,is_customized:!0}),alert("Prompt zapisany!")}catch{alert("Bd zapisu promptu")}finally{S(!1)}}},_=async E=>{if(confirm("Przywrci domylny prompt? Twoje zmiany zostan utracone."))try{await fetch(`${ai}/api/v1/admin/ai-prompts/${E}/reset`,{method:"POST"});const C=await fetch(`${ai}/api/v1/admin/ai-prompts/${E}`);if(C.ok){const N=await C.json();h(N.prompt_text),j({display_name:N.display_name,is_customized:!1})}}catch{alert("Bd resetowania promptu")}};return e.jsxs("div",{style:{marginBottom:10,borderRadius:6,background:s?"var(--blue-dim)":"var(--bg-subtle)",border:"1px solid",borderColor:s?"rgba(59,130,246,0.2)":"transparent",transition:"all 0.15s"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:10,cursor:"pointer",padding:"8px 10px"},children:[e.jsx("input",{type:"checkbox",checked:s,onChange:E=>a({...r,[t.key]:E.target.checked}),style:{width:16,height:16,marginTop:1,accentColor:"var(--blue)",flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontSize:13,fontWeight:500},children:t.label}),t.promptKeys&&t.promptKeys.length>0&&e.jsx("div",{style:{display:"flex",gap:4},children:t.promptKeys.map(E=>e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,padding:"2px 8px",lineHeight:1.4},onClick:C=>{C.preventDefault(),C.stopPropagation(),w(E)},children:o===E?"Zwi prompt":t.promptKeys.length>1?`Prompt: ${E.replace("document_import_continuation","kontynuacja").replace("document_import","gwny")}`:"Edytuj prompt"},E))})]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:t.desc})]})]}),o&&e.jsx("div",{style:{padding:"0 10px 10px 36px"},onClick:E=>E.stopPropagation(),children:e.jsxs("div",{style:{background:"var(--bg)",border:"1px solid var(--border)",borderRadius:6,padding:10,marginTop:4},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[e.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"var(--text-muted)"},children:["Prompt systemowy: ",x?.display_name??o]}),x?.is_customized&&e.jsx("span",{className:"score-badge badge-blue",style:{fontSize:9},children:"Zmodyfikowany"})]}),e.jsx("textarea",{value:u,onChange:E=>h(E.target.value),style:{width:"100%",minHeight:180,fontFamily:"'JetBrains Mono',monospace",fontSize:11,padding:8,borderRadius:4,border:"1px solid var(--border)",background:"var(--bg-subtle)",color:"var(--text)",resize:"vertical"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:6},children:[e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>h(f),children:"Wstaw domylny"}),e.jsx("button",{className:"btn btn-sm",style:{fontSize:10,color:"var(--orange)"},onClick:()=>_(o),children:"Reset do domylnego"})]}),e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-sm",style:{fontSize:10},onClick:()=>d(null),children:"Anuluj"}),e.jsx("button",{className:"btn btn-sm btn-primary",style:{fontSize:10},onClick:b,disabled:y,children:y?"Zapisuj...":"Zapisz prompt"})]})]})]})})]})}function Mo({label:t,value:r,color:a}){return e.jsxs("div",{style:{padding:"10px 12px",borderRadius:8,background:"var(--bg-subtle)",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,fontFamily:"'JetBrains Mono',monospace",color:a},children:r}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:t})]})}const Xd="",I3={"mysql+asyncmy":"MySQL (asyncmy)","mysql+aiomysql":"MySQL (aiomysql)","postgresql+asyncpg":"PostgreSQL (asyncpg)","sqlite+aiosqlite":"SQLite (aiosqlite)"};function P3(){const[t,r]=m.useState(null),[a,s]=m.useState(!1),[o,d]=m.useState(""),[u,h]=m.useState(3306),[f,p]=m.useState(""),[x,j]=m.useState(""),[y,S]=m.useState(""),[w,b]=m.useState("mysql+asyncmy"),[_,E]=m.useState(!1),[C,N]=m.useState(null),[O,Q]=m.useState(!1),[G,M]=m.useState(null),[U,A]=m.useState(!1),[R,Z]=m.useState(null);m.useEffect(()=>{fetch(`${Xd}/api/v1/admin/db-config`).then(H=>H.json()).then(H=>{r(H),d(H.host),h(H.port),p(H.database),j(H.user),b(H.driver)}).catch(()=>{})},[]);const F=()=>{confirm("Czy na pewno chcesz edytowa parametry poczenia z baz danych? Nieprawidowe zmiany mog uniemoliwi dziaanie aplikacji.")&&(s(!0),N(null),M(null),Z(null))},q=()=>{t&&(d(t.host),h(t.port),p(t.database),j(t.user),b(t.driver)),S(""),s(!1),N(null),M(null),Z(null)},ee=async()=>{E(!0),N(null),M(null);try{const H=await fetch(`${Xd}/api/v1/admin/db-config/test`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})});N(await H.json())}catch{N({status:"error",message:"Nie mona poczy si z backendem"})}finally{E(!1)}},me=async()=>{if(confirm("Czy na pewno chcesz zainicjalizowa schemat bazy danych? Ta operacja utworzy wszystkie tabele i dane pocztkowe.")){Q(!0),M(null);try{const H=await fetch(`${Xd}/api/v1/admin/db-config/init-schema`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})});M(await H.json())}catch{M({status:"error",message:"Bd poczenia z backendem"})}finally{Q(!1)}}},W=async()=>{if(confirm("Zapisa now konfiguracj? Aplikacja bdzie wymagaa restartu.")){A(!0),Z(null);try{const ne=await(await fetch(`${Xd}/api/v1/admin/db-config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:o,port:u,database:f,user:x,password:y,driver:w})})).json();Z(ne.message),r({host:o,port:u,database:f,user:x,driver:w,connected:!0}),s(!1)}catch{Z("Bd zapisu konfiguracji")}finally{A(!1)}}},J=o!==t?.host||u!==t?.port||f!==t?.database,L=H=>({...H?{background:"var(--bg-subtle)",color:"var(--text-secondary)",cursor:"not-allowed",border:"1px solid transparent"}:{}});return e.jsxs("div",{style:{maxWidth:720,margin:"0 auto"},children:[e.jsx("h2",{style:{fontSize:20,fontWeight:600,marginBottom:4},children:"Konfiguracja bazy danych"}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:20},children:"Zarzdzaj poczeniem z baz danych. Moesz podczy si do nowej bazy i automatycznie utworzy schemat."}),t&&e.jsxs("div",{style:{background:t.connected?"var(--green-dim)":"var(--red-dim)",border:`1px solid ${t.connected?"var(--green)":"var(--red)"}`,borderRadius:8,padding:"10px 14px",marginBottom:20,fontSize:12},children:[e.jsx("strong",{children:"Aktywne poczenie:"})," ",t.user,"@",t.host,":",t.port,"/",t.database,e.jsx("span",{style:{marginLeft:8,color:t.connected?"var(--green)":"var(--red)"},children:t.connected?"Poczono":"Brak poczenia"})]}),e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:"Parametry poczenia"}),a?e.jsx("button",{className:"btn btn-secondary",onClick:q,style:{fontSize:12,padding:"4px 12px"},children:"Anuluj"}):e.jsx("button",{className:"btn btn-secondary",onClick:F,style:{fontSize:12,padding:"4px 12px"},children:"Edytuj"})]}),!a&&e.jsx("div",{style:{background:"var(--bg-subtle)",borderRadius:6,padding:"6px 10px",marginBottom:14,fontSize:11,color:"var(--text-muted)"},children:'Pola s zablokowane. Kliknij Edytuj" aby zmieni parametry poczenia.'}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Host (IP / hostname)"}),e.jsx("input",{className:"form-control",value:o,onChange:H=>d(H.target.value),placeholder:"192.168.1.100",readOnly:!a,style:L(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Port"}),e.jsx("input",{className:"form-control",type:"number",value:u,onChange:H=>h(Number(H.target.value)),readOnly:!a,style:L(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nazwa bazy danych"}),e.jsx("input",{className:"form-control",value:f,onChange:H=>p(H.target.value),placeholder:"secureposture",readOnly:!a,style:L(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Sterownik"}),a?e.jsxs("select",{className:"form-control",value:w,onChange:H=>b(H.target.value),children:[e.jsx("option",{value:"mysql+asyncmy",children:"MySQL (asyncmy)"}),e.jsx("option",{value:"mysql+aiomysql",children:"MySQL (aiomysql)"}),e.jsx("option",{value:"postgresql+asyncpg",children:"PostgreSQL (asyncpg)"}),e.jsx("option",{value:"sqlite+aiosqlite",children:"SQLite (aiosqlite)"})]}):e.jsx("input",{className:"form-control",value:I3[w]||w,readOnly:!0,style:L(!0)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Uytkownik"}),e.jsx("input",{className:"form-control",value:x,onChange:H=>j(H.target.value),placeholder:"root",readOnly:!a,style:L(!a)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Haso"}),a?e.jsx("input",{className:"form-control",type:"password",value:y,onChange:H=>S(H.target.value),placeholder:"Nowe haso do bazy"}):e.jsx("input",{className:"form-control",type:"password",value:"********",readOnly:!0,style:L(!0)})]})]}),a&&e.jsx("div",{style:{display:"flex",gap:8,marginTop:16},children:e.jsx("button",{className:"btn btn-primary",onClick:ee,disabled:_||!o||!f||!x,children:_?"Testowanie...":"Testuj poczenie"})})]}),a&&C&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:16,background:C.status==="ok"?"var(--green-dim)":"var(--red-dim)",borderLeft:`3px solid ${C.status==="ok"?"var(--green)":"var(--red)"}`},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:4},children:C.status==="ok"?"Poczenie udane":"Bd poczenia"}),e.jsx("div",{style:{fontSize:12},children:C.message}),C.status==="ok"&&e.jsxs("div",{style:{fontSize:12,marginTop:6,color:"var(--text-muted)"},children:["Tabel w bazie: ",e.jsx("strong",{children:C.tables_found}),C.schema_initialized?e.jsx("span",{style:{color:"var(--green)",marginLeft:8},children:"Schemat istnieje"}):e.jsx("span",{style:{color:"var(--orange)",marginLeft:8},children:"Baza pusta  wymaga inicjalizacji"})]})]}),a&&C?.status==="ok"&&e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Inicjalizacja schematu"}),e.jsx("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:C.schema_initialized?"Baza zawiera tabele. Moesz ponownie uruchomi migracje aby zaktualizowa schemat do najnowszej wersji.":"Baza jest pusta. Kliknij poniej aby utworzy wszystkie tabele, indeksy i dane pocztkowe."}),e.jsx("button",{className:"btn btn-primary",onClick:me,disabled:O,children:O?"Inicjalizacja...":C.schema_initialized?"Aktualizuj schemat":"Utwrz schemat bazy"}),G&&e.jsxs("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:6,fontSize:12,background:G.status==="ok"?"var(--green-dim)":"var(--red-dim)",borderLeft:`3px solid ${G.status==="ok"?"var(--green)":"var(--red)"}`},children:[e.jsxs("strong",{children:[G.status==="ok"?"Sukces":"Bd",":"]})," ",G.message,G.details&&e.jsx("pre",{style:{marginTop:6,fontSize:11,whiteSpace:"pre-wrap",opacity:.8,maxHeight:120,overflow:"auto"},children:G.details})]})]}),a&&C?.status==="ok"&&J&&e.jsxs("div",{className:"card",style:{padding:20,marginBottom:16},children:[e.jsx("h3",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:"Zapisz konfiguracj"}),e.jsxs("p",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:["Zapisanie nowej konfiguracji zaktualizuje plik .env. Po zapisie wymagany jest ",e.jsx("strong",{children:"restart serwera"})," aby aplikacja poczya si z now baz."]}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:U,children:U?"Zapisywanie...":"Zapisz i przecz baz"}),R&&e.jsx("div",{style:{marginTop:12,padding:"10px 14px",borderRadius:6,fontSize:12,background:"var(--blue-dim)",borderLeft:"3px solid var(--blue)"},children:R})]})]})}const Ui="",Cm={planned:"Planowane",in_progress:"W trakcie",implemented:"Wdroone",partial:"Czciowo",not_applicable:"Nie dotyczy"},qv={planned:"#6b7280",in_progress:"#f59e0b",implemented:"#16a34a",partial:"#f97316",not_applicable:"#9ca3af"},Yv={positive:"Pozytywny",conditional:"Warunkowy",negative:"Negatywny"},W3={positive:"#16a34a",conditional:"#f59e0b",negative:"#dc2626"},Jv={manual_test:"Test manualny",automated_test:"Test automatyczny",audit:"Audyt",review:"Przegld",pentest:"Pen-test"};function Qd(t){return t==null?"var(--text-muted)":t>=85?"#16a34a":t>=60?"#f59e0b":t>=30?"#f97316":"#dc2626"}function U3(t){return!!t&&new Date(t)<new Date}const Tm=[{key:"ref_id",header:"Ref"},{key:"control_ref_id",header:"Zabezpieczenie"},{key:"control_name",header:"Nazwa zabezpieczenia"},{key:"org_unit_name",header:"Jednostka org."},{key:"asset_name",header:"Aktyw",defaultVisible:!1},{key:"security_area_name",header:"Obszar",defaultVisible:!1},{key:"status",header:"Status"},{key:"responsible",header:"Odpowiedzialny"},{key:"implementation_date",header:"Data wdroenia",defaultVisible:!1},{key:"design_effectiveness",header:"Projekt %"},{key:"operational_effectiveness",header:"Operacyjna %"},{key:"overall_effectiveness",header:"Oglna %"},{key:"coverage_percent",header:"Pokrycie %",defaultVisible:!1},{key:"last_test_date",header:"Ostatni test"},{key:"next_test_date",header:"Nastpny test"},{key:"actions",header:"Akcje"}];function $3(){const[t,r]=m.useState([]),[a,s]=m.useState(null),[o,d]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState(!0),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(!1),[_,E]=m.useState(null),[C,N]=m.useState(!1),[O,Q]=m.useState(null),[G,M]=m.useState({control_id:0,org_unit_id:0,asset_id:null,security_area_id:null,status:"planned",responsible:"",implementation_date:"",description:"",evidence_url:"",design_effectiveness:"",operational_effectiveness:"",coverage_percent:"",test_frequency_days:""}),[U,A]=m.useState({test_date:new Date().toISOString().split("T")[0],test_type:"manual_test",tester:"",result:"positive",design_score:"",operational_score:"",findings:"",recommendations:""}),[R,Z]=m.useState(!1),{visible:F,toggle:q}=da(Tm,"ctrl-eff"),ee=Aa({data:t,storageKey:"ctrl-eff",defaultSort:"overall_effectiveness",defaultSortDir:"desc"}),me=async()=>{p(!0);try{const[k,I,D,de]=await Promise.all([fetch(`${Ui}/api/v1/control-effectiveness`),fetch(`${Ui}/api/v1/control-effectiveness/metrics/summary`),fetch(`${Ui}/api/v1/smart-catalog/controls`),fetch(`${Ui}/api/v1/org-units`)]);if(k.ok&&r(await k.json()),I.ok&&s(await I.json()),D.ok){const he=await D.json();d(he.map(ie=>({id:ie.id,ref_id:ie.ref_id,name:ie.name})))}if(de.ok){const he=await de.json();h(he.map(ie=>({id:ie.id,name:ie.name})))}}catch{}p(!1)};m.useEffect(()=>{me()},[]);const W=m.useMemo(()=>a?[{label:"Wdroone",value:a.implemented_count,total:a.total_implementations,color:"#16a34a"},{label:"Czciowo",value:a.partial_count,color:"#f97316"},{label:"r. skuteczno",value:a.avg_overall_effectiveness!=null?`${a.avg_overall_effectiveness}%`:"",color:Qd(a.avg_overall_effectiveness)},{label:"Testy (90d)",value:a.tests_last_90_days,color:a.overdue_tests>0?"#dc2626":"var(--text-secondary)"}]:[],[a]),J=()=>{S(null),M({control_id:o[0]?.id??0,org_unit_id:u[0]?.id??0,asset_id:null,security_area_id:null,status:"planned",responsible:"",implementation_date:"",description:"",evidence_url:"",design_effectiveness:"",operational_effectiveness:"",coverage_percent:"",test_frequency_days:""}),j(!0)},L=k=>{S(k),M({control_id:k.control_id,org_unit_id:k.org_unit_id,asset_id:k.asset_id,security_area_id:k.security_area_id,status:k.status,responsible:k.responsible||"",implementation_date:k.implementation_date||"",description:k.description||"",evidence_url:k.evidence_url||"",design_effectiveness:k.design_effectiveness??"",operational_effectiveness:k.operational_effectiveness??"",coverage_percent:k.coverage_percent??"",test_frequency_days:k.test_frequency_days??""}),j(!0)},H=k=>{E(k),A({test_date:new Date().toISOString().split("T")[0],test_type:"manual_test",tester:"",result:"positive",design_score:"",operational_score:"",findings:"",recommendations:""}),b(!0)},ne=k=>{Q(k),N(!0)},P=async()=>{const k={control_id:G.control_id,org_unit_id:G.org_unit_id,status:G.status};G.asset_id&&(k.asset_id=G.asset_id),G.security_area_id&&(k.security_area_id=G.security_area_id),G.responsible&&(k.responsible=G.responsible),G.implementation_date&&(k.implementation_date=G.implementation_date),G.description&&(k.description=G.description),G.evidence_url&&(k.evidence_url=G.evidence_url),G.design_effectiveness!==""&&(k.design_effectiveness=Number(G.design_effectiveness)),G.operational_effectiveness!==""&&(k.operational_effectiveness=Number(G.operational_effectiveness)),G.coverage_percent!==""&&(k.coverage_percent=Number(G.coverage_percent)),G.test_frequency_days!==""&&(k.test_frequency_days=Number(G.test_frequency_days));const I=y?`${Ui}/api/v1/control-effectiveness/${y.id}`:`${Ui}/api/v1/control-effectiveness`;await fetch(I,{method:y?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),j(!1),me()},T=async()=>{if(!_)return;const k={test_date:U.test_date,test_type:U.test_type,tester:U.tester,result:U.result};U.design_score!==""&&(k.design_score=Number(U.design_score)),U.operational_score!==""&&(k.operational_score=Number(U.operational_score)),U.findings&&(k.findings=U.findings),U.recommendations&&(k.recommendations=U.recommendations),await fetch(`${Ui}/api/v1/control-effectiveness/${_.id}/tests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),b(!1),me()},z=async k=>{await fetch(`${Ui}/api/v1/control-effectiveness/${k}`,{method:"DELETE"}),me()};return f?e.jsx("div",{style:{padding:32},children:"adowanie..."}):e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:8},children:"Ocena Skutecznoci Zabezpiecze"}),e.jsx("p",{style:{color:"var(--text-muted)",marginBottom:16},children:"ledzenie wdroe zabezpiecze z katalogu kontroli, ich skutecznoci operacyjnej i wynikw testw/walidacji."}),e.jsx(Ia,{cards:W,isFiltered:ee.hasActiveFilters}),a?.recommended_safeguard_rating!=null&&e.jsxs("div",{className:"card",style:{padding:"12px 16px",marginBottom:16,display:"flex",gap:16,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:13,color:"var(--text-muted)"},children:"Rekomendowane Z (safeguard_rating) na podstawie ocen:"}),e.jsx("span",{style:{fontWeight:700,fontSize:18,color:Qd(a.avg_overall_effectiveness)},children:a.recommended_safeguard_rating}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:["(",a.avg_overall_effectiveness!=null?`skuteczno ${a.avg_overall_effectiveness}%`:"brak danych",")"]}),a.overdue_tests>0&&e.jsxs("span",{style:{fontSize:12,color:"#dc2626",marginLeft:"auto"},children:[a.overdue_tests," przeterminowanych testw"]})]}),e.jsx(ma,{filteredCount:ee.filteredCount,totalCount:ee.totalCount,unitLabel:"wdroe",search:ee.search,onSearchChange:ee.setSearch,searchPlaceholder:"Szukaj zabezpieczenia...",showFilters:R,onToggleFilters:()=>Z(!R),hasActiveFilters:ee.hasActiveFilters,onClearFilters:ee.clearAllFilters,columns:Tm,visibleColumns:F,onToggleColumn:q,data:ee.filtered,exportFilename:"skutecznosc_zabezpieczen",primaryLabel:"+ Dodaj wdroenie",onPrimaryAction:J}),e.jsx(Ea,{columns:Tm,visibleColumns:F,data:ee.pageData,rowKey:k=>String(k.id),sortField:ee.sortField,sortDir:ee.sortDir,onSort:ee.toggleSort,showFilters:R,columnFilters:ee.columnFilters,onColumnFilter:ee.setColumnFilter,onRowClick:ne,page:ee.page,totalPages:ee.totalPages,pageSize:ee.pageSize,totalItems:ee.totalCount,filteredItems:ee.filteredCount,onPageChange:ee.setPage,onPageSizeChange:ee.setPageSize,renderCell:(k,I)=>{if(I==="status")return e.jsx("span",{style:{color:qv[k.status]||"inherit",fontWeight:600},children:Cm[k.status]||k.status});if(I==="design_effectiveness"||I==="operational_effectiveness"||I==="overall_effectiveness"||I==="coverage_percent"){const D=k[I];return D==null?e.jsx("span",{style:{color:"var(--text-muted)"},children:""}):e.jsxs("span",{style:{color:Qd(D),fontWeight:600},children:[D,"%"]})}if(I==="next_test_date"){if(!k.next_test_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const D=U3(k.next_test_date);return e.jsxs("span",{style:{color:D?"#dc2626":"inherit",fontWeight:D?600:400},children:[k.next_test_date,D&&" !"]})}if(I==="last_test_date")return k.last_test_date||e.jsx("span",{style:{color:"var(--text-muted)"},children:""});if(I==="actions")return e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("button",{className:"btn btn-xs",title:"Edytuj",onClick:D=>{D.stopPropagation(),L(k)},children:"Edytuj"}),e.jsx("button",{className:"btn btn-xs btn-primary",title:"Test",onClick:D=>{D.stopPropagation(),H(k)},children:"+ Test"}),e.jsx("button",{className:"btn btn-xs btn-danger",title:"Dezaktywuj",onClick:D=>{D.stopPropagation(),z(k.id)},children:"X"})]})}}),e.jsxs(gt,{open:x,title:y?`Edycja: ${y.ref_id}`:"Nowe wdroenie zabezpieczenia",onClose:()=>j(!1),children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Zabezpieczenie *"}),e.jsxs("select",{value:G.control_id,onChange:k=>M({...G,control_id:Number(k.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),o.map(k=>e.jsxs("option",{value:k.id,children:[k.ref_id,"  ",k.name]},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Jednostka organizacyjna *"}),e.jsxs("select",{value:G.org_unit_id,onChange:k=>M({...G,org_unit_id:Number(k.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),u.map(k=>e.jsx("option",{value:k.id,children:k.name},k.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status *"}),e.jsx("select",{value:G.status,onChange:k=>M({...G,status:k.target.value}),children:Object.entries(Cm).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Odpowiedzialny"}),e.jsx("input",{type:"text",value:G.responsible,onChange:k=>M({...G,responsible:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data wdroenia"}),e.jsx("input",{type:"date",value:G.implementation_date,onChange:k=>M({...G,implementation_date:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Skuteczno projektowa (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:G.design_effectiveness,onChange:k=>M({...G,design_effectiveness:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Skuteczno operacyjna (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:G.operational_effectiveness,onChange:k=>M({...G,operational_effectiveness:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pokrycie % (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:G.coverage_percent,onChange:k=>M({...G,coverage_percent:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Czstotliwo testw (dni)"}),e.jsx("input",{type:"number",min:1,value:G.test_frequency_days,onChange:k=>M({...G,test_frequency_days:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Opis"}),e.jsx("textarea",{rows:3,value:G.description,onChange:k=>M({...G,description:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"URL dowodu"}),e.jsx("input",{type:"text",value:G.evidence_url,onChange:k=>M({...G,evidence_url:k.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>j(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:P,disabled:!G.control_id||!G.org_unit_id,children:y?"Zapisz":"Dodaj"})]})]}),e.jsxs(gt,{open:w,title:`Nowy test: ${_?.ref_id??""}`,onClose:()=>b(!1),children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Data testu *"}),e.jsx("input",{type:"date",value:U.test_date,onChange:k=>A({...U,test_date:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Typ testu *"}),e.jsx("select",{value:U.test_type,onChange:k=>A({...U,test_type:k.target.value}),children:Object.entries(Jv).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tester *"}),e.jsx("input",{type:"text",value:U.tester,onChange:k=>A({...U,tester:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik *"}),e.jsx("select",{value:U.result,onChange:k=>A({...U,result:k.target.value}),children:Object.entries(Yv).map(([k,I])=>e.jsx("option",{value:k,children:I},k))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik projektowy (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:U.design_score,onChange:k=>A({...U,design_score:k.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Wynik operacyjny (0100)"}),e.jsx("input",{type:"number",min:0,max:100,value:U.operational_score,onChange:k=>A({...U,operational_score:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Ustalenia"}),e.jsx("textarea",{rows:3,value:U.findings,onChange:k=>A({...U,findings:k.target.value})})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{children:"Rekomendacje"}),e.jsx("textarea",{rows:3,value:U.recommendations,onChange:k=>A({...U,recommendations:k.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:T,disabled:!U.tester,children:"Zapisz test"})]})]}),e.jsx(gt,{open:C,title:`Szczegy: ${O?.ref_id??""}`,onClose:()=>N(!1),children:O&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zabezpieczenie"}),e.jsxs("div",{style:{fontWeight:600},children:[O.control_ref_id,"  ",O.control_name]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Jednostka org."}),e.jsx("div",{children:O.org_unit_name})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Status"}),e.jsx("span",{style:{color:qv[O.status],fontWeight:600},children:Cm[O.status]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Odpowiedzialny"}),e.jsx("div",{children:O.responsible||""})]})]}),e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:[{label:"Projektowa",val:O.design_effectiveness},{label:"Operacyjna",val:O.operational_effectiveness},{label:"Oglna",val:O.overall_effectiveness},{label:"Pokrycie",val:O.coverage_percent}].map(k=>e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:Qd(k.val)},children:k.val!=null?`${k.val}%`:""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:k.label})]},k.label))}),O.description&&e.jsxs("div",{className:"card",style:{padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Opis"}),e.jsx("div",{style:{whiteSpace:"pre-wrap"},children:O.description})]}),e.jsxs("h4",{style:{marginBottom:8},children:["Historia testw (",O.tests.length,")"]}),O.tests.length===0?e.jsx("div",{style:{color:"var(--text-muted)",padding:12},children:"Brak testw"}):e.jsxs("table",{className:"data-table",style:{width:"100%",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Data"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Tester"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Projekt"}),e.jsx("th",{children:"Operac."})]})}),e.jsx("tbody",{children:O.tests.map(k=>e.jsxs("tr",{children:[e.jsx("td",{children:k.test_date}),e.jsx("td",{children:Jv[k.test_type]||k.test_type}),e.jsx("td",{children:k.tester}),e.jsx("td",{style:{color:W3[k.result],fontWeight:600},children:Yv[k.result]||k.result}),e.jsx("td",{children:k.design_score!=null?`${k.design_score}%`:""}),e.jsx("td",{children:k.operational_score!=null?`${k.operational_score}%`:""})]},k.id))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>{N(!1),H(O)},children:"+ Dodaj test"}),e.jsx("button",{className:"btn",onClick:()=>N(!1),children:"Zamknij"})]})]})})]})}const Xv={draft:"#94a3b8",in_progress:"var(--blue)",completed:"var(--green)",archived:"#6b7280"},H3={draft:"Szkic",in_progress:"W toku",completed:"Zakoczona",archived:"Archiwalna"},Qv={planned:"#94a3b8",scoping:"var(--purple)",fieldwork:"var(--yellow)",reporting:"var(--blue)",review:"var(--cyan)",completed:"var(--green)",closed:"#6b7280",cancelled:"var(--red)"},V3={planned:"Zaplanowane",scoping:"Scoping",fieldwork:"Fieldwork",reporting:"Raportowanie",review:"Review",completed:"Zakoczone",closed:"Zamknite",cancelled:"Anulowane"},e1={critical:"var(--red)",high:"var(--orange)",medium:"var(--blue)",low:"var(--green)"},Z3={critical:"Krytyczny",high:"Wysoki",medium:"redni",low:"Niski"};function t1(t){return t==null?"var(--text-muted)":t>=80?"var(--green)":t>=60?"var(--yellow)":"var(--red)"}function G3(t){return t==null?"transparent":t>=80?"var(--green-dim)":t>=60?"var(--yellow-dim)":"var(--red-dim)"}function K3(){const[t,r]=m.useState([]),[a,s]=m.useState([]),[o,d]=m.useState([]),[u,h]=m.useState(!0),f=on();m.useEffect(()=>{Promise.all([le.get("/api/v1/compliance-assessments/"),le.get("/api/v1/audit-engagements/"),le.get("/api/v1/audit-programs/").catch(()=>[])]).then(([_,E,C])=>{r(_),s(E),d(C)}).catch(()=>{}).finally(()=>h(!1))},[]);const p=t.filter(_=>_.status!=="archived"),x=p.filter(_=>_.compliance_score!=null),j=x.length>0?x.reduce((_,E)=>_+(E.compliance_score??0),0)/x.length:null,y=a.filter(_=>!["completed","closed","cancelled"].includes(_.status)),S=a.reduce((_,E)=>_+E.findings_count,0),w=o.filter(_=>["active","approved"].includes(_.status)),b=[{label:"Aktywne oceny",value:p.length,color:"var(--blue)"},{label:"redni % zgodnoci",value:j!=null?`${j.toFixed(1)}%`:"",color:t1(j)},{label:"Otwarte audyty",value:y.length,color:"var(--orange)"},{label:"Ustalenia audytowe",value:S,color:S>0?"var(--red)":"var(--green)"}];return u?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."}):e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{style:{margin:0},children:"Compliance & Audit Dashboard"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>f("/compliance/assessments"),children:"+ Nowa ocena"}),e.jsx("button",{className:"btn btn-sm",onClick:()=>f("/audit-engagements"),children:"+ Nowy audyt"})]})]}),e.jsx(Ia,{cards:b}),e.jsx("div",{className:"grid-4",style:{marginBottom:16},children:[{label:"Oceny Zgodnoci",count:p.length,to:"/compliance/assessments",color:"var(--blue)"},{label:"Programy Audytw",count:w.length,to:"/audit-programs",color:"var(--purple)"},{label:"Zadania Audytowe",count:y.length,to:"/audit-engagements",color:"var(--orange)"},{label:"Ustalenia",count:S,to:"/audit-findings",color:S>0?"var(--red)":"var(--green)"}].map(_=>e.jsx("div",{className:"card",style:{padding:"12px 16px",cursor:"pointer",borderLeft:`3px solid ${_.color}`},onClick:()=>f(_.to),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:13,fontWeight:600},children:_.label}),e.jsx("span",{style:{fontSize:20,fontWeight:700,color:_.color,fontFamily:"'JetBrains Mono', monospace"},children:_.count})]})},_.label))}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Oceny zgodnoci"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/compliance/assessments"),children:"Zobacz wszystkie"})]}),p.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak ocen zgodnoci. Utwrz pierwsz ocen dla wybranego frameworka."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Scope"}),e.jsx("th",{children:"Status"}),e.jsx("th",{style:{textAlign:"right"},children:"Zgodno %"}),e.jsx("th",{style:{textAlign:"right"},children:"Postp"}),e.jsx("th",{style:{textAlign:"right"},children:"Wymagania"})]})}),e.jsx("tbody",{children:p.slice(0,10).map(_=>{const E=_.total_requirements>0?Math.round(_.assessed_count/_.total_requirements*100):0;return e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>f(`/compliance/assessments/${_.id}`),children:[e.jsx("td",{style:{fontWeight:600},children:_.framework_name}),e.jsx("td",{children:_.scope_name||_.scope_type}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{backgroundColor:`${Xv[_.status]||"#94a3b8"}20`,color:Xv[_.status]||"#94a3b8"},children:H3[_.status]||_.status})}),e.jsx("td",{style:{textAlign:"right"},children:_.compliance_score!=null?e.jsxs("span",{style:{background:G3(_.compliance_score),color:t1(_.compliance_score),borderRadius:6,padding:"2px 8px",fontSize:12,fontWeight:600},children:[_.compliance_score,"%"]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsx("td",{style:{textAlign:"right"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:6},children:[e.jsx("div",{style:{width:60,height:6,backgroundColor:"var(--border)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{width:`${E}%`,height:"100%",backgroundColor:E>=80?"var(--green)":E>=50?"var(--yellow)":"var(--red)",borderRadius:3}})}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[E,"%"]})]})}),e.jsxs("td",{style:{textAlign:"right",fontSize:12},children:[e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:_.compliant_count}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" / ",_.total_requirements]})]})]},_.id)})})]})})]}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Aktywne zadania audytowe"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/audit-engagements"),children:"Zobacz wszystkie"})]}),y.length===0?e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak aktywnych zada audytowych."}):e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Nazwa"}),e.jsx("th",{children:"Framework"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Priorytet"}),e.jsx("th",{children:"Lead Auditor"}),e.jsx("th",{style:{textAlign:"right"},children:"Testy"}),e.jsx("th",{style:{textAlign:"right"},children:"Ustalenia"})]})}),e.jsx("tbody",{children:y.slice(0,10).map(_=>e.jsxs("tr",{style:{cursor:"pointer",borderLeft:`3px solid ${e1[_.priority]||"transparent"}`},onClick:()=>f(`/audit-engagements/${_.id}`),children:[e.jsx("td",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:_.ref_id}),e.jsx("td",{style:{fontWeight:600},children:_.name}),e.jsx("td",{children:_.framework_name}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{backgroundColor:`${Qv[_.status]||"#94a3b8"}20`,color:Qv[_.status]||"#94a3b8"},children:V3[_.status]||_.status})}),e.jsx("td",{children:e.jsx("span",{style:{color:e1[_.priority]||"inherit",fontWeight:600,fontSize:12},children:Z3[_.priority]||_.priority})}),e.jsx("td",{children:_.lead_auditor}),e.jsx("td",{style:{textAlign:"right"},children:_.tests_count}),e.jsx("td",{style:{textAlign:"right",color:_.findings_count>0?"var(--red)":"inherit",fontWeight:_.findings_count>0?600:400},children:_.findings_count})]},_.id))})]})})]}),o.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{margin:0,fontSize:14},children:"Programy audytw"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f("/audit-programs"),children:"Zobacz wszystkie"})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:12,padding:16},children:o.slice(0,6).map(_=>e.jsxs("div",{className:"card",style:{padding:"12px 16px",cursor:"pointer"},onClick:()=>f(`/audit-engagements?program_id=${_.id}`),children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:_.name}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{className:"badge",style:{backgroundColor:_.status==="active"?"var(--blue-dim)":"var(--bg-subtle)",color:_.status==="active"?"var(--blue)":"var(--text-muted)"},children:[_.status,"  ",_.year]}),e.jsx("span",{style:{fontSize:16,fontWeight:700,color:"var(--blue)",fontFamily:"'JetBrains Mono', monospace"},children:_.engagement_count})]})]},_.id))})]})]})}function eu(t){return t==null?"var(--text-muted)":t>=80?"var(--green)":t>=60?"var(--yellow)":"var(--red)"}function q3(t){return t==null?"transparent":t>=80?"var(--green-dim)":t>=60?"var(--yellow-dim)":"var(--red-dim)"}const Nm={draft:"#94a3b8",in_progress:"var(--blue)",completed:"var(--green)",archived:"#6b7280"},Am={draft:"Szkic",in_progress:"W toku",completed:"Zakoczona",archived:"Archiwalna"},a1={continuous:"Bieca",audit_snapshot:"Snapshot"},n1={organization:"Organizacja",org_unit:"Jednostka org.",service:"Usuga",process:"Proces",project:"Projekt"};function Em({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function ir({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function Y3(){const t=[{key:"name",header:"Nazwa",format:H=>H.name||`#${H.id}`},{key:"framework_name",header:"Framework"},{key:"scope_type",header:"Scope",format:H=>n1[H.scope_type]||H.scope_type},{key:"scope_name",header:"Scope nazwa",format:H=>H.scope_name??"",defaultVisible:!1},{key:"assessment_type",header:"Typ",format:H=>a1[H.assessment_type]||H.assessment_type},{key:"status",header:"Status",format:H=>Am[H.status]||H.status},{key:"compliance_score",header:"Zgodno %",format:H=>H.compliance_score!=null?`${H.compliance_score}%`:""},{key:"assessed_count",header:"Ocenione",format:H=>`${H.assessed_count}/${H.total_requirements}`},{key:"compliant_count",header:"Zgodne",format:H=>String(H.compliant_count)},{key:"partially_count",header:"Czciowo",format:H=>String(H.partially_count),defaultVisible:!1},{key:"non_compliant_count",header:"Niezgodne",format:H=>String(H.non_compliant_count),defaultVisible:!1},{key:"not_applicable_count",header:"N/A",format:H=>String(H.not_applicable_count),defaultVisible:!1},{key:"created_at",header:"Utworzono",format:H=>H.created_at?.slice(0,10)??"",defaultVisible:!1},{key:"updated_at",header:"Aktualizacja",format:H=>H.updated_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"compliance-assessments"),[s,o]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),b=on(),[_,E]=m.useState({framework_id:0,scope_type:"organization",scope_name:"",name:""}),C=Aa({data:s,storageKey:"compliance-assessments",defaultSort:"compliance_score",defaultSortDir:"desc"}),N=()=>{f(!0),Promise.all([le.get("/api/v1/compliance-assessments/"),le.get("/api/v1/frameworks/")]).then(([H,ne])=>{o(H),u(ne.filter(P=>P.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(N,[]);const O=async()=>{if(_.framework_id)try{const H=await le.post("/api/v1/compliance-assessments/",{framework_id:_.framework_id,scope_type:_.scope_type,scope_name:_.scope_name||null,name:_.name||null});y(!1),b(`/compliance/assessments/${H.id}`)}catch{alert("Bd tworzenia oceny")}},Q=C.filtered,G=Q.filter(H=>H.status==="in_progress").length,M=Q.filter(H=>H.status==="completed").length,U=Q.filter(H=>H.compliance_score!=null),A=U.length>0?U.reduce((H,ne)=>H+(ne.compliance_score??0),0)/U.length:null,R=s.filter(H=>H.status==="in_progress").length,Z=s.filter(H=>H.status==="completed").length,F=s.filter(H=>H.compliance_score!=null),q=F.length>0?F.reduce((H,ne)=>H+(ne.compliance_score??0),0)/F.length:null,ee=C.filteredCount!==C.totalCount,me=[{label:"Oceny ogem",value:Q.length,total:s.length,color:"var(--blue)"},{label:"W toku",value:G,total:R,color:"var(--orange)"},{label:"Zakoczone",value:M,total:Z,color:"var(--green)"},{label:"redni % zgodnoci",value:A!=null?A.toFixed(1):"",total:q!=null?q.toFixed(1):"",color:eu(A)}],W=p,J=W&&W.total_requirements>0?Math.round(W.assessed_count/W.total_requirements*100):0,L=W?W.total_requirements-W.assessed_count:0;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Oceny Zgodnoci"}),e.jsx(Ia,{cards:me,isFiltered:ee}),e.jsx(ma,{filteredCount:C.filteredCount,totalCount:C.totalCount,unitLabel:"ocen",search:C.search,onSearchChange:C.setSearch,searchPlaceholder:"Szukaj ocen...",showFilters:S,onToggleFilters:()=>w(H=>!H),hasActiveFilters:C.hasActiveFilters,onClearFilters:C.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:C.filtered,exportFilename:"compliance_assessments",primaryLabel:"Nowa ocena",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:C.pageData,rowKey:H=>H.id,selectedKey:p?.id??null,onRowClick:H=>x(ne=>ne?.id===H.id?null:H),rowBorderColor:H=>{const ne=H.compliance_score;if(ne!=null)return ne>=80?"var(--green)":ne>=60?"var(--orange)":"var(--red)"},renderCell:(H,ne)=>{if(ne==="compliance_score"){const P=H.compliance_score;return P==null?e.jsx("span",{style:{color:"var(--text-muted)"},children:""}):e.jsxs("span",{style:{background:q3(P),color:eu(P),borderRadius:6,padding:"2px 8px",fontSize:12,fontWeight:600},children:[P,"%"]})}if(ne==="status"){const P=Nm[H.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${P}20`,color:P},children:Am[H.status]||H.status})}if(ne==="compliant_count")return e.jsx("span",{style:{color:"var(--green)",fontWeight:600},children:H.compliant_count});if(ne==="name")return e.jsx("span",{style:{fontWeight:600},children:H.name||`#${H.id}`})},sortField:C.sortField,sortDir:C.sortDir,onSort:C.toggleSort,columnFilters:C.columnFilters,onColumnFilter:C.setColumnFilter,showFilters:S,page:C.page,totalPages:C.totalPages,pageSize:C.pageSize,totalItems:C.totalCount,filteredItems:C.filteredCount,onPageChange:C.setPage,onPageSizeChange:C.setPageSize,loading:h,emptyMessage:"Brak ocen zgodnoci. Utwrz pierwsz ocen, wybierajc framework."}),W&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:W.name||`#${W.id}`}),e.jsx("span",{className:"badge",style:{backgroundColor:`${Nm[W.status]||"#94a3b8"}20`,color:Nm[W.status]||"#94a3b8"},children:Am[W.status]||W.status})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>b(`/compliance/assessments/${W.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]})]}),W.compliance_score!=null&&e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsxs("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono', monospace",color:eu(W.compliance_score)},children:[W.compliance_score,"%"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zgodno"}),e.jsx("div",{style:{marginTop:8,height:6,backgroundColor:"var(--border)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{width:`${J}%`,height:"100%",backgroundColor:eu(W.compliance_score),borderRadius:3,transition:"width 0.3s"}})}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Postp: ",W.assessed_count," / ",W.total_requirements]})]}),e.jsx(Em,{number:"1",label:"Framework i scope"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ir,{label:"Framework",value:W.framework_name}),e.jsx(ir,{label:"Scope",value:n1[W.scope_type]||W.scope_type}),W.scope_name&&e.jsx(ir,{label:"Scope nazwa",value:W.scope_name}),e.jsx(ir,{label:"Typ oceny",value:a1[W.assessment_type]||W.assessment_type})]}),e.jsx(Em,{number:"2",label:"Wyniki oceny"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ir,{label:"Zgodne",value:W.compliant_count,color:"var(--green)"}),e.jsx(ir,{label:"Czciowo zgodne",value:W.partially_count,color:"var(--yellow)"}),e.jsx(ir,{label:"Niezgodne",value:W.non_compliant_count,color:"var(--red)"}),e.jsx(ir,{label:"Nie dotyczy",value:W.not_applicable_count}),e.jsx(ir,{label:"Nieocenione",value:L>0?L:0}),e.jsx(ir,{label:"Razem wymaga",value:W.total_requirements})]}),e.jsx(Em,{number:"3",label:"Daty"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13},children:[e.jsx(ir,{label:"Utworzono",value:W.created_at?.slice(0,10)}),e.jsx(ir,{label:"Aktualizacja",value:W.updated_at?.slice(0,10)})]})]})]}),e.jsx(gt,{open:j,title:"Nowa ocena zgodnoci",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Framework *",e.jsxs("select",{className:"form-control",value:_.framework_id,onChange:H=>E({..._,framework_id:Number(H.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),d.map(H=>e.jsxs("option",{value:H.id,children:[H.name," (",H.total_assessable," wymaga)"]},H.id))]})]}),e.jsxs("label",{children:["Scope",e.jsxs("select",{className:"form-control",value:_.scope_type,onChange:H=>E({..._,scope_type:H.target.value}),children:[e.jsx("option",{value:"organization",children:"Caa organizacja"}),e.jsx("option",{value:"org_unit",children:"Jednostka organizacyjna"}),e.jsx("option",{value:"service",children:"Usuga"}),e.jsx("option",{value:"process",children:"Proces"})]})]}),e.jsxs("label",{children:["Nazwa scope",e.jsx("input",{className:"form-control",value:_.scope_name,onChange:H=>E({..._,scope_name:H.target.value}),placeholder:"np. Dzia IT"})]}),e.jsxs("label",{children:["Nazwa oceny (opcjonalna)",e.jsx("input",{className:"form-control",value:_.name,onChange:H=>E({..._,name:H.target.value}),placeholder:"np. ISO 27001  IT  2026"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:!_.framework_id,children:"Utwrz"})]})]})})]})}const ep=[{value:"not_assessed",label:"Nieocenione",color:"#94a3b8",icon:""},{value:"compliant",label:"Zgodne",color:"#22c55e",icon:""},{value:"partially_compliant",label:"Czciowo zgodne",color:"#f59e0b",icon:""},{value:"non_compliant",label:"Niezgodne",color:"#ef4444",icon:""},{value:"not_applicable",label:"Nie dotyczy",color:"#6b7280",icon:""}];function J3(t){return ep.find(r=>r.value===t)||ep[0]}function X3(t){return t==null?"var(--text-muted)":t>=80?"#22c55e":t>=60?"#f59e0b":"#ef4444"}function Q3(){const{assessmentId:t}=Ou(),r=on(),[a,s]=m.useState(null),[o,d]=m.useState([]),[u,h]=m.useState(!0),[f,p]=m.useState(null),[x,j]=m.useState(new Set),y=m.useCallback(async()=>{if(t)try{const[C,N]=await Promise.all([le.get(`/api/v1/compliance-assessments/${t}`),le.get(`/api/v1/compliance-assessments/${t}/requirements?selected_only=false`)]);s(C),d(N);const O=new Set(N.filter(Q=>Q.node_depth===1).map(Q=>Q.requirement_node_id));j(O)}catch{alert("Bd wczytywania oceny")}finally{h(!1)}},[t]);m.useEffect(()=>{y()},[y]);const S=async(C,N)=>{p(C.id);try{const O=await le.put(`/api/v1/compliance-assessments/requirements/${C.id}`,{result:N});d(G=>G.map(M=>M.id===C.id?{...M,...O}:M));const Q=await le.get(`/api/v1/compliance-assessments/${t}`);s(Q)}catch{alert("Bd zapisu")}finally{p(null)}},w=C=>{j(N=>{const O=new Set(N);return O.has(C)?O.delete(C):O.add(C),O})};if(u||!a)return e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."});const b=a.total_requirements>0?Math.round(a.assessed_count/a.total_requirements*100):0,_=[{label:"Zgodno",value:a.compliance_score!=null?`${a.compliance_score}%`:"",color:X3(a.compliance_score)},{label:"Postp oceny",value:`${b}%`,color:b>=80?"#22c55e":"#f59e0b"},{label:"Zgodne",value:a.compliant_count,color:"#22c55e"},{label:"Niezgodne",value:a.non_compliant_count,color:"#ef4444"}];o.filter(C=>C.node_assessable===!1||C.node_depth===1),o.filter(C=>C.node_assessable===!0);const E=C=>{const N=o.indexOf(C);for(let O=N-1;O>=0;O--){const Q=o[O];if(Q.node_depth!=null&&C.node_depth!=null&&Q.node_depth<C.node_depth)return Q.requirement_node_id}return null};return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-xs",onClick:()=>r("/compliance/assessments"),style:{marginBottom:8},children:" Powrt"}),e.jsx("h2",{style:{margin:0},children:a.name||a.framework_name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4},children:[a.framework_name," | ",a.scope_name||a.scope_type," | Status: ",a.status]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[a.status==="draft"&&e.jsx("button",{className:"btn btn-primary",onClick:async()=>{await le.put(`/api/v1/compliance-assessments/${t}`,{status:"in_progress"}),y()},children:"Rozpocznij ocen"}),a.status==="in_progress"&&e.jsx("button",{className:"btn btn-primary",onClick:async()=>{await le.put(`/api/v1/compliance-assessments/${t}`,{status:"completed"}),y()},children:"Zakocz ocen"})]})]}),e.jsx(Ia,{cards:_}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4,color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Postp: ",a.assessed_count," / ",a.total_requirements," wymaga"]}),e.jsxs("span",{children:[b,"%"]})]}),e.jsx("div",{style:{height:8,backgroundColor:"var(--border)",borderRadius:4,overflow:"hidden"},children:e.jsx("div",{style:{width:`${b}%`,height:"100%",backgroundColor:b>=80?"#22c55e":b>=50?"#f59e0b":"#3b82f6",borderRadius:4,transition:"width 0.3s"}})})]}),e.jsx("div",{className:"card",children:o.map(C=>{const N=J3(C.result),O=C.node_assessable===!1,Q=C.node_assessable===!0,G=C.node_depth||1,M=x.has(C.requirement_node_id);if(!O&&G>1){const U=E(C);if(U&&!x.has(U))return null}if(O){const U=o.indexOf(C);let A=0,R=0;for(let Z=U+1;Z<o.length;Z++){const F=o[Z];if(F.node_depth!=null&&F.node_depth<=G)break;F.node_assessable&&(A++,F.result==="compliant"&&R++)}return e.jsxs("div",{style:{padding:"10px 16px",paddingLeft:16+(G-1)*20,backgroundColor:G===1?"var(--bg-subtle)":void 0,borderBottom:"1px solid var(--border)",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},onClick:()=>w(C.requirement_node_id),children:[e.jsxs("div",{children:[e.jsx("span",{style:{marginRight:8,fontSize:12},children:M?"":""}),e.jsxs("span",{style:{fontWeight:600,fontSize:13},children:[C.node_ref_id&&e.jsx("span",{style:{color:"var(--text-muted)",marginRight:6},children:C.node_ref_id}),C.node_name_pl||C.node_name]})]}),A>0&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:[R,"/",A," "]})]},C.id)}return Q?e.jsxs("div",{style:{padding:"8px 16px",paddingLeft:16+(G-1)*20,borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,opacity:f===C.id?.6:1},children:[e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{style:{fontSize:13},children:[C.node_ref_id&&e.jsx("span",{style:{color:"var(--text-muted)",marginRight:6,fontFamily:"monospace",fontSize:11},children:C.node_ref_id}),C.node_name_pl||C.node_name]}),C.notes&&e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:2},children:C.notes})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,flexShrink:0},children:[C.evidence_count>0&&e.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},title:"Dowody",children:["",C.evidence_count]}),e.jsx("select",{className:"form-control",value:C.result,onChange:U=>S(C,U.target.value),disabled:f===C.id,style:{width:180,fontSize:12,color:N.color,fontWeight:600,padding:"4px 8px"},children:ep.map(U=>e.jsxs("option",{value:U.value,children:[U.icon," ",U.label]},U.value))})]})]},C.id):null})})]})}const Fm={draft:"#94a3b8",submitted:"var(--purple)",approved:"var(--green)",active:"var(--blue)",completed:"#6b7280",archived:"#6b7280"},Rm={draft:"Szkic",submitted:"Zgoszony",approved:"Zatwierdzony",active:"Aktywny",completed:"Zakoczony",archived:"Archiwalny"};function r1({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function tu({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function e8(){const t=[{key:"name",header:"Nazwa"},{key:"year",header:"Rok",format:q=>String(q.year)},{key:"status",header:"Status",format:q=>Rm[q.status]||q.status},{key:"engagement_count",header:"Zadania",format:q=>String(q.engagement_count)},{key:"prepared_by",header:"Przygotowa",format:q=>q.prepared_by??""},{key:"approved_by",header:"Zatwierdzi",format:q=>q.approved_by??"",defaultVisible:!1},{key:"approved_at",header:"Data zatwierdzenia",format:q=>q.approved_at?.slice(0,10)??"",defaultVisible:!1},{key:"description",header:"Opis",format:q=>q.description??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:q=>q.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"audit-programs"),[s,o]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j,y]=m.useState(!1),S=on(),[w,b]=m.useState({name:"",year:new Date().getFullYear(),description:"",prepared_by:""}),_=Aa({data:s,storageKey:"audit-programs",defaultSort:"year",defaultSortDir:"desc"}),E=()=>{u(!0),le.get("/api/v1/audit-programs/").then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(E,[]);const C=async()=>{if(w.name.trim())try{await le.post("/api/v1/audit-programs/",{name:w.name,year:w.year,description:w.description||null,prepared_by:w.prepared_by||null}),x(!1),b({name:"",year:new Date().getFullYear(),description:"",prepared_by:""}),E()}catch{alert("Bd tworzenia programu")}},N=_.filtered,O=N.filter(q=>["active","approved"].includes(q.status)).length,Q=N.reduce((q,ee)=>q+ee.engagement_count,0),G=N.filter(q=>q.status==="completed").length,M=s.filter(q=>["active","approved"].includes(q.status)).length,U=s.reduce((q,ee)=>q+ee.engagement_count,0),A=s.filter(q=>q.status==="completed").length,R=_.filteredCount!==_.totalCount,Z=[{label:"Programy ogem",value:N.length,total:s.length,color:"var(--blue)"},{label:"Aktywne",value:O,total:M,color:"var(--green)"},{label:"Zakoczone",value:G,total:A,color:"#6b7280"},{label:"Zadania cznie",value:Q,total:U,color:"var(--purple)"}],F=h;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Programy Audytw"}),e.jsx(Ia,{cards:Z,isFiltered:R}),e.jsx(ma,{filteredCount:_.filteredCount,totalCount:_.totalCount,unitLabel:"programw",search:_.search,onSearchChange:_.setSearch,searchPlaceholder:"Szukaj programw...",showFilters:j,onToggleFilters:()=>y(q=>!q),hasActiveFilters:_.hasActiveFilters,onClearFilters:_.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:_.filtered,exportFilename:"audit_programs",primaryLabel:"Nowy program",onPrimaryAction:()=>x(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:_.pageData,rowKey:q=>q.id,selectedKey:h?.id??null,onRowClick:q=>f(ee=>ee?.id===q.id?null:q),renderCell:(q,ee)=>{if(ee==="name")return e.jsx("span",{style:{fontWeight:600},children:q.name});if(ee==="status"){const me=Fm[q.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${me}20`,color:me},children:Rm[q.status]||q.status})}if(ee==="engagement_count")return e.jsx("span",{style:{fontWeight:600,color:q.engagement_count>0?"var(--blue)":"var(--text-muted)"},children:q.engagement_count})},sortField:_.sortField,sortDir:_.sortDir,onSort:_.toggleSort,columnFilters:_.columnFilters,onColumnFilter:_.setColumnFilter,showFilters:j,page:_.page,totalPages:_.totalPages,pageSize:_.pageSize,totalItems:_.totalCount,filteredItems:_.filteredCount,onPageChange:_.setPage,onPageSizeChange:_.setPageSize,loading:d,emptyMessage:"Brak programw audytw. Utwrz roczny plan audytw."}),F&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:F.name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${Fm[F.status]||"#94a3b8"}20`,color:Fm[F.status]||"#94a3b8"},children:Rm[F.status]||F.status}),e.jsx("span",{className:"badge",style:{backgroundColor:"var(--blue-dim)",color:"var(--blue)"},children:F.year})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>S(`/audit-engagements?program_id=${F.id}`),children:"Zadania"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f(null),children:""})]})]}),e.jsxs("div",{style:{textAlign:"center",marginBottom:16},children:[e.jsx("div",{style:{fontSize:36,fontWeight:700,fontFamily:"'JetBrains Mono', monospace",color:"var(--blue)"},children:F.engagement_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zada audytowych"})]}),e.jsx(r1,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(tu,{label:"Rok",value:F.year}),e.jsx(tu,{label:"Przygotowa",value:F.prepared_by}),e.jsx(tu,{label:"Zatwierdzi",value:F.approved_by}),e.jsx(tu,{label:"Data zatwierdzenia",value:F.approved_at?.slice(0,10)})]}),F.description&&e.jsxs(e.Fragment,{children:[e.jsx(r1,{number:"2",label:"Opis"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:F.description})]})]})]}),e.jsx(gt,{open:p,title:"Nowy program audytw",onClose:()=>x(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:w.name,onChange:q=>b({...w,name:q.target.value}),placeholder:"np. Program Audytw IT 2026"})]}),e.jsxs("label",{children:["Rok ",e.jsx("input",{className:"form-control",type:"number",value:w.year,onChange:q=>b({...w,year:Number(q.target.value)})})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:w.description,onChange:q=>b({...w,description:q.target.value}),rows:3})]}),e.jsxs("label",{children:["Przygotowa ",e.jsx("input",{className:"form-control",value:w.prepared_by,onChange:q=>b({...w,prepared_by:q.target.value})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>x(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:C,disabled:!w.name.trim(),children:"Utwrz"})]})]})})]})}const Bm={planned:"#94a3b8",scoping:"var(--purple)",fieldwork:"var(--yellow)",reporting:"var(--blue)",review:"var(--cyan)",completed:"var(--green)",closed:"#6b7280",cancelled:"var(--red)"},Om={planned:"Zaplanowane",scoping:"Scoping",fieldwork:"Fieldwork",reporting:"Raportowanie",review:"Review",completed:"Zakoczone",closed:"Zamknite",cancelled:"Anulowane"},au={critical:"var(--red)",high:"var(--orange)",medium:"var(--blue)",low:"var(--green)"},Dm={critical:"Krytyczny",high:"Wysoki",medium:"redni",low:"Niski"};function Lm({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function ei({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function t8(){const t=[{key:"ref_id",header:"Ref",format:J=>J.ref_id},{key:"name",header:"Nazwa"},{key:"framework_name",header:"Framework"},{key:"status",header:"Status",format:J=>Om[J.status]||J.status},{key:"priority",header:"Priorytet",format:J=>Dm[J.priority]||J.priority},{key:"lead_auditor",header:"Lead Auditor"},{key:"planned_start",header:"Plan start",format:J=>J.planned_start??""},{key:"planned_end",header:"Plan koniec",format:J=>J.planned_end??"",defaultVisible:!1},{key:"actual_start",header:"Faktyczny start",format:J=>J.actual_start??"",defaultVisible:!1},{key:"actual_end",header:"Faktyczny koniec",format:J=>J.actual_end??"",defaultVisible:!1},{key:"scope_type",header:"Scope",format:J=>J.scope_type,defaultVisible:!1},{key:"scope_name",header:"Scope nazwa",format:J=>J.scope_name??"",defaultVisible:!1},{key:"supervisor",header:"Supervisor",format:J=>J.supervisor??"",defaultVisible:!1},{key:"program_name",header:"Program",format:J=>J.program_name??"",defaultVisible:!1},{key:"tests_count",header:"Testy",format:J=>String(J.tests_count)},{key:"findings_count",header:"Ustalenia",format:J=>String(J.findings_count)},{key:"created_at",header:"Utworzono",format:J=>J.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"audit-engagements"),[s,o]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b]=fc(),_=b.get("program_id"),E=on(),[C,N]=m.useState({name:"",framework_id:0,objective:"",lead_auditor:"",priority:"medium",scope_type:"organization",scope_name:"",planned_start:"",planned_end:"",audit_program_id:_?Number(_):null}),O=Aa({data:s,storageKey:"audit-engagements",defaultSort:"created_at",defaultSortDir:"desc"}),Q=()=>{f(!0);const J=_?`/api/v1/audit-engagements/?program_id=${_}`:"/api/v1/audit-engagements/";Promise.all([le.get(J),le.get("/api/v1/frameworks/")]).then(([L,H])=>{o(L),u(H.filter(ne=>ne.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(Q,[_]);const G=async()=>{if(!(!C.name.trim()||!C.framework_id||!C.objective.trim()||!C.lead_auditor.trim()))try{const J=await le.post("/api/v1/audit-engagements/",{name:C.name,framework_id:C.framework_id,objective:C.objective,lead_auditor:C.lead_auditor,priority:C.priority,scope_type:C.scope_type,scope_name:C.scope_name||null,planned_start:C.planned_start||null,planned_end:C.planned_end||null,audit_program_id:C.audit_program_id});y(!1),E(`/audit-engagements/${J.id}`)}catch{alert("Bd tworzenia zadania")}},M=O.filtered,U=M.filter(J=>!["completed","closed","cancelled"].includes(J.status)),A=M.reduce((J,L)=>J+L.findings_count,0),R=M.reduce((J,L)=>J+L.tests_count,0),Z=s.filter(J=>!["completed","closed","cancelled"].includes(J.status)),F=s.reduce((J,L)=>J+L.findings_count,0),q=s.reduce((J,L)=>J+L.tests_count,0),ee=O.filteredCount!==O.totalCount,me=[{label:"Zadania ogem",value:M.length,total:s.length,color:"var(--blue)"},{label:"W toku",value:U.length,total:Z.length,color:"var(--orange)"},{label:"Testy",value:R,total:q,color:"var(--purple)"},{label:"Ustalenia",value:A,total:F,color:A>0?"var(--red)":"var(--green)"}],W=p;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Zadania Audytowe"}),_&&e.jsxs("div",{style:{background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:"var(--radius-sm)",padding:"8px 14px",marginBottom:12,fontSize:12,color:"var(--blue)",display:"flex",alignItems:"center",gap:8},children:["Filtr programu: ID ",_,e.jsx("button",{className:"btn btn-xs",onClick:()=>E("/audit-engagements"),style:{marginLeft:"auto"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:me,isFiltered:ee}),e.jsx(ma,{filteredCount:O.filteredCount,totalCount:O.totalCount,unitLabel:"zada",search:O.search,onSearchChange:O.setSearch,searchPlaceholder:"Szukaj zada audytowych...",showFilters:S,onToggleFilters:()=>w(J=>!J),hasActiveFilters:O.hasActiveFilters,onClearFilters:O.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:O.filtered,exportFilename:"audit_engagements",primaryLabel:"Nowe zadanie",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:O.pageData,rowKey:J=>J.id,selectedKey:p?.id??null,onRowClick:J=>x(L=>L?.id===J.id?null:J),rowBorderColor:J=>au[J.priority]||void 0,renderCell:(J,L)=>{if(L==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:J.ref_id});if(L==="name")return e.jsx("span",{style:{fontWeight:600},children:J.name});if(L==="status"){const H=Bm[J.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${H}20`,color:H},children:Om[J.status]||J.status})}if(L==="priority"){const H=au[J.priority]||"inherit";return e.jsx("span",{style:{color:H,fontWeight:600,fontSize:12},children:Dm[J.priority]||J.priority})}if(L==="findings_count")return e.jsx("span",{style:{color:J.findings_count>0?"var(--red)":"inherit",fontWeight:J.findings_count>0?600:400},children:J.findings_count})},sortField:O.sortField,sortDir:O.sortDir,onSort:O.toggleSort,columnFilters:O.columnFilters,onColumnFilter:O.setColumnFilter,showFilters:S,page:O.page,totalPages:O.totalPages,pageSize:O.pageSize,totalItems:O.totalCount,filteredItems:O.filteredCount,onPageChange:O.setPage,onPageSizeChange:O.setPageSize,loading:h,emptyMessage:"Brak zada audytowych. Utwrz pierwsze zadanie."}),W&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)",marginBottom:2},children:W.ref_id}),e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:W.name}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${Bm[W.status]||"#94a3b8"}20`,color:Bm[W.status]||"#94a3b8"},children:Om[W.status]||W.status}),e.jsx("span",{className:"badge",style:{backgroundColor:`${au[W.priority]}20`,color:au[W.priority]},children:Dm[W.priority]||W.priority})]})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-xs btn-primary",onClick:()=>E(`/audit-engagements/${W.id}`),children:"Otwrz"}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:10},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"var(--purple)",fontFamily:"'JetBrains Mono', monospace"},children:W.tests_count}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Testw"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:10},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:W.findings_count>0?"var(--red)":"var(--green)",fontFamily:"'JetBrains Mono', monospace"},children:W.findings_count}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Ustale"})]})]}),e.jsx(Lm,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(ei,{label:"Framework",value:W.framework_name}),e.jsx(ei,{label:"Scope",value:W.scope_name||W.scope_type}),e.jsx(ei,{label:"Lead auditor",value:W.lead_auditor}),W.supervisor&&e.jsx(ei,{label:"Supervisor",value:W.supervisor}),W.program_name&&e.jsx(ei,{label:"Program",value:W.program_name})]}),e.jsx(Lm,{number:"2",label:"Cel audytu"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",marginBottom:12,lineHeight:1.5},children:W.objective}),e.jsx(Lm,{number:"3",label:"Harmonogram"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13},children:[e.jsx(ei,{label:"Plan start",value:W.planned_start}),e.jsx(ei,{label:"Plan koniec",value:W.planned_end}),e.jsx(ei,{label:"Faktyczny start",value:W.actual_start}),e.jsx(ei,{label:"Faktyczny koniec",value:W.actual_end})]})]})]}),e.jsx(gt,{open:j,title:"Nowe zadanie audytowe",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:C.name,onChange:J=>N({...C,name:J.target.value}),placeholder:"np. Audyt ISO 27001  Dzia IT"})]}),e.jsxs("label",{children:["Framework *",e.jsxs("select",{className:"form-control",value:C.framework_id,onChange:J=>N({...C,framework_id:Number(J.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),d.map(J=>e.jsx("option",{value:J.id,children:J.name},J.id))]})]}),e.jsxs("label",{children:["Cel audytu * ",e.jsx("textarea",{className:"form-control",value:C.objective,onChange:J=>N({...C,objective:J.target.value}),rows:2,placeholder:"Cel i zakres audytu..."})]}),e.jsxs("label",{children:["Lead Auditor * ",e.jsx("input",{className:"form-control",value:C.lead_auditor,onChange:J=>N({...C,lead_auditor:J.target.value})})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Priorytet",e.jsxs("select",{className:"form-control",value:C.priority,onChange:J=>N({...C,priority:J.target.value}),children:[e.jsx("option",{value:"low",children:"Niski"}),e.jsx("option",{value:"medium",children:"redni"}),e.jsx("option",{value:"high",children:"Wysoki"}),e.jsx("option",{value:"critical",children:"Krytyczny"})]})]}),e.jsxs("label",{children:["Scope",e.jsxs("select",{className:"form-control",value:C.scope_type,onChange:J=>N({...C,scope_type:J.target.value}),children:[e.jsx("option",{value:"organization",children:"Caa organizacja"}),e.jsx("option",{value:"org_unit",children:"Jednostka org."}),e.jsx("option",{value:"service",children:"Usuga"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Planowany start ",e.jsx("input",{className:"form-control",type:"date",value:C.planned_start,onChange:J=>N({...C,planned_start:J.target.value})})]}),e.jsxs("label",{children:["Planowany koniec ",e.jsx("input",{className:"form-control",type:"date",value:C.planned_end,onChange:J=>N({...C,planned_end:J.target.value})})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:G,disabled:!C.name.trim()||!C.framework_id||!C.objective.trim()||!C.lead_auditor.trim(),children:"Utwrz"})]})]})})]})}const i1={planned:"#94a3b8",scoping:"#8b5cf6",fieldwork:"#f59e0b",reporting:"#3b82f6",review:"#06b6d4",completed:"#22c55e",closed:"#6b7280",cancelled:"#ef4444"},a8={pass:"#22c55e",fail:"#ef4444",partial:"#f59e0b",not_tested:"#94a3b8",inconclusive:"#8b5cf6"},s1={critical:"#dc2626",high:"#f59e0b",medium:"#3b82f6",low:"#22c55e",informational:"#6b7280"},n8=["Przegld","Testy","Ustalenia","Raport"];function r8(){const{engId:t}=Ou(),r=on(),[a,s]=m.useState(null),[o,d]=m.useState([]),[u,h]=m.useState([]),[f,p]=m.useState("Przegld"),[x,j]=m.useState(!0),[y,S]=m.useState(!1),[w,b]=m.useState(!1),[_,E]=m.useState({name:"",test_type:"design",description:""}),[C,N]=m.useState({title:"",condition_text:"",criteria_text:"",severity:"medium",recommendation:""}),O=m.useCallback(async()=>{if(t)try{const[F,q,ee]=await Promise.all([le.get(`/api/v1/audit-engagements/${t}`),le.get(`/api/v1/audit-engagements/${t}/tests`),le.get(`/api/v1/audit-engagements/${t}/findings`)]);s(F),d(q),h(ee)}catch{}finally{j(!1)}},[t]);m.useEffect(()=>{O()},[O]);const Q=async F=>{try{await le.post(`/api/v1/audit-engagements/${t}/transition`,{target_status:F}),O()}catch(q){alert(q.message||"Bd zmiany statusu")}},G=async()=>{_.name.trim()&&(await le.post(`/api/v1/audit-engagements/${t}/tests`,_),S(!1),E({name:"",test_type:"design",description:""}),O())},M=async()=>{!C.title.trim()||!C.condition_text.trim()||!C.criteria_text.trim()||(await le.post(`/api/v1/audit-engagements/${t}/findings`,C),b(!1),N({title:"",condition_text:"",criteria_text:"",severity:"medium",recommendation:""}),O())},U=async(F,q)=>{await le.put(`/api/v1/audit-engagements/tests/${F}`,{test_result:q}),O()};if(x||!a)return e.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Wczytywanie..."});const A=Object.entries({planned:"scoping",scoping:"fieldwork",fieldwork:"reporting",reporting:"review",review:"completed",completed:"closed"})[Object.keys({planned:1,scoping:1,fieldwork:1,reporting:1,review:1,completed:1}).indexOf(a.status)],R=o.filter(F=>F.test_result==="pass").length,Z=o.filter(F=>F.test_result==="fail").length;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("button",{className:"btn btn-xs",onClick:()=>r("/audit-engagements"),style:{marginBottom:8},children:" Powrt"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:16},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{margin:0},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontFamily:"monospace",fontSize:16,marginRight:8},children:a.ref_id}),a.name]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginTop:4,display:"flex",gap:16,alignItems:"center"},children:[e.jsxs("span",{children:["Framework: ",a.framework_name]}),e.jsxs("span",{children:["Lead: ",a.lead_auditor]}),e.jsx("span",{className:"badge",style:{backgroundColor:`${i1[a.status]}20`,color:i1[a.status]},children:a.status})]})]}),A&&e.jsxs("button",{className:"btn btn-primary",onClick:()=>Q(A[1]),children:[" ",A[1]]})]}),e.jsx("div",{style:{display:"flex",gap:0,borderBottom:"2px solid var(--border)",marginBottom:16},children:n8.map(F=>e.jsx("button",{onClick:()=>p(F),style:{padding:"8px 20px",border:"none",background:"none",cursor:"pointer",fontWeight:f===F?600:400,color:f===F?"var(--primary)":"var(--text-muted)",borderBottom:f===F?"2px solid var(--primary)":"2px solid transparent",marginBottom:-2},children:F},F))}),f==="Przegld"&&e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:"var(--text-muted)"},children:"Cel audytu"}),e.jsx("p",{style:{margin:0,fontSize:14},children:a.objective})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px",fontSize:13,color:"var(--text-muted)"},children:"Harmonogram"}),e.jsxs("div",{style:{fontSize:13},children:[e.jsxs("div",{children:["Plan: ",a.planned_start||"","  ",a.planned_end||""]}),e.jsxs("div",{children:["Faktycznie: ",a.actual_start||"","  ",a.actual_end||""]})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginTop:20},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#3b82f6"},children:o.length}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Testw"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#22c55e"},children:R}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pass"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#ef4444"},children:Z}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Fail"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:12},children:[e.jsx("div",{style:{fontSize:28,fontWeight:700,color:u.length>0?"#ef4444":"#22c55e"},children:u.length}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Ustale"})]})]})]}),f==="Testy"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>S(!0),children:"+ Dodaj test"})}),o.length===0?e.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak testw. Dodaj testy audytowe."}):e.jsx("div",{className:"card",children:e.jsxs("table",{className:"data-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ref"}),e.jsx("th",{children:"Nazwa"}),e.jsx("th",{children:"Wymaganie"}),e.jsx("th",{children:"Typ"}),e.jsx("th",{children:"Wynik"}),e.jsx("th",{children:"Audytor"})]})}),e.jsx("tbody",{children:o.map(F=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontFamily:"monospace",fontSize:12},children:F.ref_id}),e.jsx("td",{style:{fontWeight:600},children:F.name}),e.jsx("td",{style:{fontSize:12},children:F.node_ref_id||""}),e.jsx("td",{style:{fontSize:12},children:F.test_type}),e.jsx("td",{children:e.jsxs("select",{className:"form-control",value:F.test_result,onChange:q=>U(F.id,q.target.value),style:{fontSize:12,padding:"2px 6px",color:a8[F.test_result],fontWeight:600},children:[e.jsx("option",{value:"not_tested",children:"Not tested"}),e.jsx("option",{value:"pass",children:"Pass"}),e.jsx("option",{value:"fail",children:"Fail"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"inconclusive",children:"Inconclusive"})]})}),e.jsx("td",{style:{fontSize:12},children:F.auditor_name||""})]},F.id))})]})})]}),f==="Ustalenia"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:12},children:e.jsx("button",{className:"btn btn-primary",onClick:()=>b(!0),children:"+ Nowe ustalenie"})}),u.length===0?e.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:"Brak ustale audytowych."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:u.map(F=>e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontFamily:"monospace",fontSize:12,color:"var(--text-muted)",marginRight:8},children:F.ref_id}),e.jsx("span",{style:{fontWeight:600},children:F.title})]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${s1[F.severity]}20`,color:s1[F.severity]},children:F.severity}),e.jsx("span",{className:"badge",children:F.status})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,fontSize:13},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:11,color:"var(--text-muted)"},children:"Stan faktyczny:"}),e.jsx("p",{style:{margin:"4px 0 0"},children:F.condition_text})]}),e.jsxs("div",{children:[e.jsx("strong",{style:{fontSize:11,color:"var(--text-muted)"},children:"Kryterium:"}),e.jsx("p",{style:{margin:"4px 0 0"},children:F.criteria_text})]})]}),F.target_date&&e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:8},children:["Termin: ",F.target_date]})]},F.id))})]}),f==="Raport"&&e.jsxs("div",{className:"card",style:{padding:24,textAlign:"center",color:"var(--text-muted)"},children:["Raport audytowy  funkcjonalno w przygotowaniu.",e.jsx("br",{}),"Raport zostanie wygenerowany automatycznie na bazie ustale i wynikw testw."]}),e.jsx(gt,{open:y,title:"Dodaj test audytowy",onClose:()=>S(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:_.name,onChange:F=>E({..._,name:F.target.value})})]}),e.jsxs("label",{children:["Typ",e.jsxs("select",{className:"form-control",value:_.test_type,onChange:F=>E({..._,test_type:F.target.value}),children:[e.jsx("option",{value:"design",children:"Design"}),e.jsx("option",{value:"operating",children:"Operating"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:_.description,onChange:F=>E({..._,description:F.target.value}),rows:3})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>S(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:G,disabled:!_.name.trim(),children:"Dodaj"})]})]})}),e.jsx(gt,{open:w,title:"Nowe ustalenie audytowe (format IIA)",onClose:()=>b(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Tytu * ",e.jsx("input",{className:"form-control",value:C.title,onChange:F=>N({...C,title:F.target.value})})]}),e.jsxs("label",{children:["Stan faktyczny (Condition) * ",e.jsx("textarea",{className:"form-control",value:C.condition_text,onChange:F=>N({...C,condition_text:F.target.value}),rows:3,placeholder:"Co jest  co faktycznie stwierdzono"})]}),e.jsxs("label",{children:["Kryterium (Criteria) * ",e.jsx("textarea",{className:"form-control",value:C.criteria_text,onChange:F=>N({...C,criteria_text:F.target.value}),rows:3,placeholder:"Co powinno by  wymaganie"})]}),e.jsxs("label",{children:["Severity",e.jsxs("select",{className:"form-control",value:C.severity,onChange:F=>N({...C,severity:F.target.value}),children:[e.jsx("option",{value:"informational",children:"Informational"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsxs("label",{children:["Rekomendacja ",e.jsx("textarea",{className:"form-control",value:C.recommendation,onChange:F=>N({...C,recommendation:F.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>b(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:M,disabled:!C.title.trim()||!C.condition_text.trim()||!C.criteria_text.trim(),children:"Utwrz"})]})]})})]})}const lc={equal:"Equal (=)",subset:"Subset ()",superset:"Superset ()",intersect:"Intersect ()",not_related:"Not Related ()"},Vi={equal:"#10b981",subset:"#6366f1",superset:"#8b5cf6",intersect:"#f59e0b",not_related:"#94a3b8"},Ru={equal:"Ekwiwalentne",subset:"Podzbir",superset:"Nadzbir",intersect:"Przecicie",not_related:"Brak powizania"},oc={1:"Sabe",2:"Umiarkowane",3:"Silne"},cc={1:"#f87171",2:"#f59e0b",3:"#10b981"},Mm={syntactic:"Syntaktyczne",semantic:"Semantyczne",functional:"Funkcjonalne"},nu={manual:"Rczne",ai_assisted:"AI-Assisted",scf_strm:"SCF STRM",import:"Import"},zb={draft:"Wersja robocza",confirmed:"Potwierdzone"};function Jo({rel:t}){const r=Vi[t]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${r}18`,color:r,border:`1px solid ${r}40`},children:lc[t]||t})}function Xo({strength:t}){return e.jsxs("span",{style:{display:"inline-flex",gap:3,alignItems:"center"},children:[[1,2,3].map(r=>e.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:r<=t?cc[t]:"var(--border)"}},r)),e.jsx("span",{style:{marginLeft:4,fontSize:11,color:"var(--text-muted)"},children:oc[t]||t})]})}function tp({status:t}){const r=t==="draft";return e.jsx("span",{className:"badge",style:{backgroundColor:r?"#f59e0b18":"#10b98118",color:r?"#f59e0b":"#10b981",border:`1px solid ${r?"#f59e0b40":"#10b98140"}`},children:zb[t]||t})}function ru({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function Wn({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function l1({percent:t,label:r,color:a}){return e.jsxs("div",{style:{marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:12,marginBottom:4},children:[e.jsx("span",{style:{color:"var(--text-muted)"},children:r}),e.jsxs("span",{style:{fontWeight:600,color:a},children:[t.toFixed(1),"%"]})]}),e.jsx("div",{style:{height:6,borderRadius:3,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:3,background:a,width:`${Math.min(t,100)}%`,transition:"width 0.3s"}})})]})}function i8({data:t}){const r=Object.values(t).reduce((a,s)=>a+s,0);return r?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Object.entries(t).map(([a,s])=>{const o=s/r*100,d=Vi[a]||"#94a3b8";return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,marginBottom:2},children:[e.jsx("span",{style:{color:d,fontWeight:500},children:Ru[a]||a}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[s," (",o.toFixed(0),"%)"]})]}),e.jsx("div",{style:{height:4,borderRadius:2,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:2,background:d,width:`${o}%`}})})]},a)})}):e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:"Brak danych"})}function s8({active:t,onChange:r}){const a=[{id:"mappings",label:"Mapowania",icon:""},{id:"sets",label:"Zestawy",icon:""},{id:"ai_suggest",label:"AI Suggest",icon:""},{id:"coverage",label:"Pokrycie",icon:""},{id:"matrix",label:"Matryca",icon:""},{id:"transitive",label:"Tranzytywne",icon:""}];return e.jsx("div",{style:{display:"flex",gap:2,background:"var(--bg-secondary)",borderRadius:8,padding:3,marginBottom:16},children:a.map(s=>e.jsxs("button",{onClick:()=>r(s.id),style:{flex:1,padding:"8px 12px",borderRadius:6,border:"none",cursor:"pointer",background:t===s.id?"var(--bg-primary)":"transparent",color:t===s.id?"var(--text-primary)":"var(--text-muted)",fontWeight:t===s.id?600:400,fontSize:13,boxShadow:t===s.id?"0 1px 3px rgba(0,0,0,0.08)":"none",transition:"all 0.15s"},children:[e.jsx("span",{style:{marginRight:6},children:s.icon}),s.label]},s.id))})}function l8({value:t,onChange:r}){const[a,s]=m.useState(""),o=m.useMemo(()=>{if(!a.trim())return uu;const d=a.toLowerCase();return uu.filter(u=>u.source.toLowerCase().includes(d)||u.target.toLowerCase().includes(d)||u.filename.toLowerCase().includes(d))},[a]);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj frameworka...",value:a,onChange:d=>s(d.target.value),style:{fontSize:12}}),e.jsx("div",{style:{border:"1px solid var(--border)",borderRadius:8,overflowY:"auto",maxHeight:"min(50vh, 340px)",minHeight:120},children:o.length===0?e.jsxs("div",{style:{padding:20,textAlign:"center",color:"var(--text-muted)",fontSize:12},children:['Brak wynikw dla "',a,'"']}):o.map(d=>e.jsxs("div",{onClick:()=>r(d.filename),style:{padding:"8px 12px",cursor:"pointer",fontSize:12,borderBottom:"1px solid var(--border)",background:d.filename===t?"var(--blue-dim, rgba(99,102,241,0.08))":"transparent",borderLeft:d.filename===t?"3px solid var(--blue)":"3px solid transparent",transition:"background 0.1s"},onMouseEnter:u=>{d.filename!==t&&(u.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:u=>{d.filename!==t&&(u.currentTarget.style.background=d.filename===t?"var(--blue-dim, rgba(99,102,241,0.08))":"transparent")},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:d.source}),e.jsx("span",{style:{padding:"1px 6px",borderRadius:4,fontSize:10,background:d.direction==="and"?"#6366f118":"#10b98118",color:d.direction==="and"?"#6366f1":"#10b981",fontWeight:600},children:d.direction==="and"?"":""}),e.jsx("span",{style:{fontWeight:600,color:"var(--text-primary)"},children:d.target})]}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)",marginTop:2},children:d.filename})]},d.filename))}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)",textAlign:"right"},children:[o.length," / ",uu.length," plikw"]})]})}function o8({sets:t,frameworks:r,onRefresh:a}){const[s,o]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState("file"),[p,x]=m.useState(null),[j,y]=m.useState("mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml"),[S,w]=m.useState(0),[b,_]=m.useState(0),[E,C]=m.useState(!0),[N,O]=m.useState(!1),[Q,G]=m.useState(null),M=m.useRef(null),[U,A]=m.useState({source_framework_id:0,target_framework_id:0,name:""}),[R,Z]=m.useState(""),F=async()=>{if(!(!U.source_framework_id||!U.target_framework_id))try{await le.post("/api/v1/framework-mappings/sets",{source_framework_id:U.source_framework_id,target_framework_id:U.target_framework_id,name:U.name||void 0}),o(!1),A({source_framework_id:0,target_framework_id:0,name:""}),a()}catch{alert("Bd tworzenia zestawu")}},q=async()=>{O(!0),G(null);try{let W;if(h==="file"){if(!p)return;const J=new FormData;J.append("file",p);const L=new URLSearchParams;S&&L.set("source_framework_id",String(S)),b&&L.set("target_framework_id",String(b)),L.set("auto_revert",String(E)),W=await le.postFormData(`/api/v1/framework-mappings/import/yaml?${L}`,J)}else{if(!j.trim())return;const J=new URLSearchParams({mapping_path:j.trim(),auto_revert:String(E)});S&&J.set("source_framework_id",String(S)),b&&J.set("target_framework_id",String(b)),W=await le.post(`/api/v1/framework-mappings/import/github-mapping?${J}`,{})}G(W),a()}catch(W){const J=W?.message||"Bd importu";G({mapping_set_id:null,source_framework_name:null,target_framework_name:null,created:0,revert_created:0,skipped:0,errors:[J]})}O(!1)},ee=()=>{x(null),G(null),w(0),_(0),C(!0),y("mapping-nist-sp-800-53-rev5-to-iso27001-2022.yaml"),f("file")},me=m.useMemo(()=>{if(!R.trim())return t;const W=R.toLowerCase();return t.filter(J=>(J.name||"").toLowerCase().includes(W)||(J.source_framework_name||"").toLowerCase().includes(W)||(J.target_framework_name||"").toLowerCase().includes(W))},[t,R]);return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,flexWrap:"wrap",gap:8},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{margin:0,fontSize:16},children:"Zestawy Mapowa"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"var(--text-muted)"},children:"Grupuj mapowania midzy parami frameworkw (wzorzec CISO Assistant)"})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Szukaj zestaww...",value:R,onChange:W=>Z(W.target.value),style:{width:200,fontSize:12,padding:"6px 10px"}}),e.jsx("button",{className:"btn",onClick:()=>{ee(),u(!0)},style:{display:"flex",alignItems:"center",gap:6},children:"Import mapowa"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>o(!0),children:"Nowy zestaw"})]})]}),R.trim()&&e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:8},children:["Znaleziono: ",me.length," z ",t.length," zestaww"]}),me.length===0?e.jsx("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:R.trim()?`Brak zestaww pasujcych do "${R}"`:"Brak zestaww mapowa. Utwrz zestaw, aby grupowa mapowania midzy frameworkami."}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(340px, 1fr))",gap:12},children:me.map(W=>e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsx("div",{style:{fontWeight:600,fontSize:14},children:W.name||`Set #${W.id}`}),e.jsx(tp,{status:W.status})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)",marginBottom:12},children:[W.source_framework_name,"  ",W.target_framework_name]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{style:{padding:"8px 12px",borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--blue)"},children:W.mapping_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Mapowa"})]}),e.jsxs("div",{style:{padding:"8px 12px",borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:W.coverage_percent!=null&&W.coverage_percent>=80?"#10b981":"#f59e0b"},children:W.coverage_percent!=null?`${W.coverage_percent}%`:""}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pokrycie"})]})]})]},W.id))}),e.jsx(gt,{open:s,title:"Nowy zestaw mapowa",onClose:()=>o(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Source Framework *",e.jsxs("select",{className:"form-control",value:U.source_framework_id,onChange:W=>A({...U,source_framework_id:Number(W.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),r.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{children:["Target Framework *",e.jsxs("select",{className:"form-control",value:U.target_framework_id,onChange:W=>A({...U,target_framework_id:Number(W.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),r.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{children:["Nazwa (opcjonalna)",e.jsx("input",{className:"form-control",value:U.name,onChange:W=>A({...U,name:W.target.value}),placeholder:"Auto: Framework A <-> Framework B"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>o(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:F,disabled:!U.source_framework_id||!U.target_framework_id,children:"Utwrz"})]})]})}),e.jsx(gt,{open:d,title:"Import mapowa CISO Assistant",onClose:()=>u(!1),wide:!0,children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Format CISO Assistant YAML"}),e.jsxs("div",{style:{color:"var(--text-muted)",lineHeight:1.6},children:["Importuj pliki mapowa z repozytorium CISO Assistant Community. Pliki zawieraj",""," sekcj",""," ",e.jsx("code",{children:"requirement_mapping_sets"})," z definicjami powi","","za",""," mi","","dzy wymaganiami dw","","ch framework","","w. Frameworki ","r'","d","","owe i docelowe musz",""," by",""," wcze","","niej zaimportowane."]})]}),e.jsxs("div",{style:{display:"flex",gap:2,background:"var(--bg-secondary)",borderRadius:6,padding:2},children:[e.jsx("button",{onClick:()=>f("file"),style:{flex:1,padding:"6px 12px",borderRadius:4,border:"none",cursor:"pointer",background:h==="file"?"var(--bg-primary)":"transparent",color:h==="file"?"var(--text-primary)":"var(--text-muted)",fontWeight:h==="file"?600:400,fontSize:12},children:"Import z pliku"}),e.jsx("button",{onClick:()=>f("github"),style:{flex:1,padding:"6px 12px",borderRadius:4,border:"none",cursor:"pointer",background:h==="github"?"var(--bg-primary)":"transparent",color:h==="github"?"var(--text-primary)":"var(--text-muted)",fontWeight:h==="github"?600:400,fontSize:12},children:"Import z CISO Assistant"})]}),h==="file"&&e.jsxs("div",{children:[e.jsx("input",{ref:M,type:"file",accept:".yaml,.yml",style:{display:"none"},onChange:W=>x(W.target.files?.[0]||null)}),e.jsx("div",{onClick:()=>M.current?.click(),style:{border:"2px dashed var(--border)",borderRadius:8,padding:24,textAlign:"center",cursor:"pointer",transition:"border-color 0.15s",background:p?"var(--bg-secondary)":"transparent"},children:p?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:14,marginBottom:4},children:p.name}),e.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[(p.size/1024).toFixed(1)," KB  kliknij aby zmieni",""]})]}):e.jsxs("div",{style:{color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:24,marginBottom:4},children:"+"}),e.jsxs("div",{style:{fontSize:13},children:["Kliknij aby wybra",""," plik YAML"]}),e.jsx("div",{style:{fontSize:11,marginTop:4},children:"mapping-*.yaml z repozytorium CISO Assistant"})]})})]}),h==="github"&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:13,marginBottom:6},children:"Plik mapowania z repozytorium CISO Assistant"}),e.jsx(l8,{value:j,onChange:y}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:[uu.length," plikw mapowa w katalogu CISO Assistant Community"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Source Framework (opcjonalnie)",e.jsxs("select",{className:"form-control",value:S,onChange:W=>w(Number(W.target.value)),children:[e.jsx("option",{value:0,children:" auto z YAML "}),r.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Target Framework (opcjonalnie)",e.jsxs("select",{className:"form-control",value:b,onChange:W=>_(Number(W.target.value)),children:[e.jsx("option",{value:0,children:" auto z YAML "}),r.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))]})]})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:E,onChange:W=>C(W.target.checked)}),"Auto-revert (generuj odwrotne mapowania)"]}),Q&&e.jsx("div",{style:{padding:12,borderRadius:8,fontSize:13,lineHeight:1.6,background:Q.created>0?"#10b98118":"#ef444418",border:`1px solid ${Q.created>0?"#10b98140":"#ef444440"}`},children:Q.created>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:600,color:"#10b981",marginBottom:4},children:["Import zako","","czony pomy","","lnie"]}),e.jsxs("div",{children:["Utworzono: ",e.jsx("strong",{children:Q.created})," mapowa",""]}),Q.revert_created>0&&e.jsxs("div",{children:["Odwrotne: ",e.jsx("strong",{children:Q.revert_created})," mapowa",""]}),Q.skipped>0&&e.jsxs("div",{children:["Pomini","","to (duplikaty): ",e.jsx("strong",{children:Q.skipped})]}),Q.source_framework_name&&Q.target_framework_name&&e.jsxs("div",{style:{marginTop:4,color:"var(--text-muted)"},children:[Q.source_framework_name," ",""," ",Q.target_framework_name]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{fontWeight:600,color:"#ef4444",marginBottom:4},children:["B","","d importu"]}),Q.errors.map((W,J)=>e.jsx("div",{style:{fontSize:12,color:"var(--text-muted)"},children:W},J))]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:4},children:[e.jsx("button",{className:"btn",onClick:()=>u(!1),children:Q?.created?"Zamknij":"Anuluj"}),!Q?.created&&e.jsx("button",{className:"btn btn-primary",onClick:q,disabled:N||h==="file"&&!p||h==="github"&&!j.trim(),children:N?"Importowanie...":"Importuj mapowania"})]})]})})]})}function c8({frameworks:t,onRefresh:r}){const[a,s]=m.useState(0),[o,d]=m.useState(0),[u,h]=m.useState(3),[f,p]=m.useState(.45),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(new Set),[_,E]=m.useState(!1),[C,N]=m.useState(null),O=async()=>{if(!(!a||!o)){j(!0),S(null),b(new Set),N(null);try{const A=new URLSearchParams({source_framework_id:String(a),target_framework_id:String(o),top_k:String(u),min_score:String(f)}),R=await le.post(`/api/v1/framework-mappings/ai-suggest?${A}`,{});S(R);const Z=new Set;R.suggestions.forEach((F,q)=>{F.score>=.6&&Z.add(q)}),b(Z)}catch(A){alert(A?.message||"Bd generowania sugestii AI")}j(!1)}},Q=A=>{b(R=>{const Z=new Set(R);return Z.has(A)?Z.delete(A):Z.add(A),Z})},G=()=>{y&&(w.size===y.suggestions.length?b(new Set):b(new Set(y.suggestions.map((A,R)=>R))))},M=async()=>{if(!(!y||w.size===0)){E(!0),N(null);try{const A=[...w].map(F=>y.suggestions[F]).map(F=>({source_node_id:F.source_node_id,target_node_id:F.target_node_id,relationship_type:F.relationship_type,strength:F.strength,score:F.score,model_name:y.model_name})),R=new URLSearchParams({source_framework_id:String(y.source_framework_id),target_framework_id:String(y.target_framework_id),auto_revert:"true"}),Z=await le.post(`/api/v1/framework-mappings/ai-suggest/accept?${R}`,A);N(Z),r()}catch(A){alert(A?.message||"Bd akceptowania sugestii")}E(!1)}},U=A=>A>=.85?"#10b981":A>=.7?"#6366f1":A>=.55?"#f59e0b":"#94a3b8";return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"AI-Suggest Mapowania (SBERT)"}),e.jsxs("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:["Automatyczne sugestie mapowa",""," na podstawie podobie","","stwa semantycznego tekst","","w wymaga",""," (sentence-transformers)"]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Source Framework *",e.jsxs("select",{className:"form-control",value:a,onChange:A=>s(Number(A.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Target Framework *",e.jsxs("select",{className:"form-control",value:o,onChange:A=>d(Number(A.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(A=>e.jsx("option",{value:A.id,children:A.name},A.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Top-K (maks. wynik","","w na wymaganie)",e.jsx("select",{className:"form-control",value:u,onChange:A=>h(Number(A.target.value)),children:[1,2,3,5,10].map(A=>e.jsx("option",{value:A,children:A},A))})]}),e.jsxs("label",{style:{fontSize:13},children:["Min. score (pr","","g podobie","","stwa)",e.jsx("select",{className:"form-control",value:f,onChange:A=>p(Number(A.target.value)),children:[.3,.35,.4,.45,.5,.55,.6,.7].map(A=>e.jsxs("option",{value:A,children:[(A*100).toFixed(0),"%"]},A))})]})]}),e.jsxs("div",{style:{padding:10,borderRadius:6,background:"var(--bg-secondary)",fontSize:12,color:"var(--text-muted)",lineHeight:1.6,marginBottom:12},children:["Model: ",e.jsx("strong",{children:"all-MiniLM-L6-v2"}),"  szybki, wieloj","","zyczny model sentence-transformers. Oblicza cosine similarity mi","","dzy tekstami wymaga",""," i sugeruje mapowania powy","","ej progu. Wyniki s",""," w statusie ",e.jsx("em",{children:"draft"}),"  wymagaj",""," potwierdzenia."]}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:x||!a||!o||a===o,style:{width:"100%"},children:x?"Generowanie sugestii AI...":"Generuj sugestie SBERT"})]}),y&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:10,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--blue)"},children:y.total_suggestions}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Sugestii"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#10b981"},children:y.source_nodes_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Source nodes"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#6366f1"},children:y.target_nodes_count}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Target nodes"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#f59e0b"},children:w.size}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Zaznaczonych"})]})]}),!C&&y.suggestions.length>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:w.size===y.suggestions.length,onChange:G}),"Zaznacz wszystkie"]}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[w.size," z ",y.suggestions.length," zaznaczonych"]})]}),e.jsx("button",{className:"btn btn-primary",onClick:M,disabled:_||w.size===0,children:_?"Akceptowanie...":`Akceptuj ${w.size} sugestii`})]}),C&&e.jsxs("div",{style:{padding:12,borderRadius:8,marginBottom:12,fontSize:13,lineHeight:1.6,background:"#10b98118",border:"1px solid #10b98140"},children:[e.jsx("div",{style:{fontWeight:600,color:"#10b981",marginBottom:4},children:"Sugestie zaakceptowane"}),e.jsxs("div",{children:["Utworzono: ",e.jsx("strong",{children:C.created})," mapowa",""]}),C.revert_created>0&&e.jsxs("div",{children:["Odwrotne: ",e.jsx("strong",{children:C.revert_created})," mapowa",""]}),C.skipped>0&&e.jsxs("div",{children:["Pomini","","to (duplikaty): ",e.jsx("strong",{children:C.skipped})]})]}),y.suggestions.length>0?e.jsx("div",{className:"card",style:{overflow:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"8px 10px",width:36}}),e.jsx("th",{style:{padding:"8px 10px"},children:"Source"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Target"}),e.jsx("th",{style:{padding:"8px 10px",width:80},children:"Score"}),e.jsx("th",{style:{padding:"8px 10px",width:100},children:"Relacja"}),e.jsxs("th",{style:{padding:"8px 10px",width:60},children:["Si","","a"]})]})}),e.jsx("tbody",{children:y.suggestions.map((A,R)=>e.jsxs("tr",{onClick:()=>Q(R),style:{borderBottom:"1px solid var(--border)",cursor:"pointer",background:w.has(R)?"var(--bg-secondary)":"transparent",opacity:C?.6:1},children:[e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("input",{type:"checkbox",checked:w.has(R),readOnly:!0})}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:A.source_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A.source_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:A.target_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:300,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:A.target_name})]}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("div",{style:{width:40,height:6,borderRadius:3,background:"var(--border)",overflow:"hidden"},children:e.jsx("div",{style:{width:`${A.score*100}%`,height:"100%",borderRadius:3,background:U(A.score)}})}),e.jsxs("span",{style:{fontSize:11,fontWeight:600,color:U(A.score)},children:[(A.score*100).toFixed(1),"%"]})]})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Jo,{rel:A.relationship_type})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Xo,{strength:A.strength})})]},R))})]})}):e.jsxs("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:["Brak sugestii powy","","ej progu podobie","","stwa. Spr","","buj obni","","y",""," pr","","g min. score."]})]})]})}function d8({frameworks:t}){const[r,a]=m.useState(0),[s,o]=m.useState(0),[d,u]=m.useState(null),[h,f]=m.useState(!1),{aiEnabled:p}=Rp(),[x,j]=m.useState(null),[y,S]=m.useState(!1),w=async()=>{if(!(!r||!s)){f(!0),j(null);try{const _=await le.get(`/api/v1/framework-mappings/coverage?source_framework_id=${r}&target_framework_id=${s}`);u(_)}catch{u(null)}f(!1)}},b=async()=>{if(!(!r||!s)){S(!0);try{const _=await le.post("/api/v1/ai/coverage-report",{source_framework_id:r,target_framework_id:s});j(_)}catch{}S(!1)}};return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Analiza Pokrycia"}),e.jsx("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:"Sprawd, jakie wymagania s pokryte mapowaniami midzy frameworkami"}),e.jsx("div",{className:"card",style:{padding:16,marginBottom:16},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{margin:0},children:["Source Framework",e.jsxs("select",{className:"form-control",value:r,onChange:_=>a(Number(_.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]})]}),e.jsxs("label",{style:{margin:0},children:["Target Framework",e.jsxs("select",{className:"form-control",value:s,onChange:_=>o(Number(_.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]})]}),e.jsx("button",{className:"btn btn-primary",onClick:w,disabled:!r||!s||h,children:h?"Analizuj...":"Analizuj pokrycie"}),p&&d&&e.jsx("button",{className:"btn btn-sm",onClick:b,disabled:y,style:{background:"var(--blue-dim)",color:"var(--blue)",border:"1px solid var(--blue)",fontSize:11},children:y?"Generuj raport...":"Raport AI"})]})}),d&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 16px",fontSize:14},children:"Pokrycie wymaga"}),e.jsx("div",{style:{textAlign:"center",marginBottom:16},children:e.jsx("div",{style:{width:100,height:100,borderRadius:"50%",margin:"0 auto 8px",background:`conic-gradient(#10b981 ${d.coverage_percent*3.6}deg, var(--border) 0deg)`,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{width:76,height:76,borderRadius:"50%",background:"var(--bg-primary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:22,fontWeight:700,color:d.coverage_percent>=80?"#10b981":d.coverage_percent>=50?"#f59e0b":"#ef4444"},children:[d.coverage_percent,"%"]})})}),e.jsx(l1,{percent:d.coverage_percent,label:"Cakowite pokrycie",color:"#10b981"}),e.jsx(l1,{percent:d.confirmed_coverage_percent,label:"Potwierdzone pokrycie",color:"#6366f1"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:8,marginTop:12},children:[e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"var(--blue)"},children:d.total_requirements}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Wymaga"})]}),e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#10b981"},children:d.covered}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Pokryte"})]}),e.jsxs("div",{style:{textAlign:"center",padding:8,borderRadius:6,background:"var(--bg-secondary)"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#ef4444"},children:d.uncovered}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Brak"})]})]})]}),e.jsxs("div",{className:"card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 16px",fontSize:14},children:"Rozkad relacji"}),e.jsx(i8,{data:d.by_relationship}),e.jsx("h4",{style:{margin:"16px 0 12px",fontSize:14},children:"Sia powiza"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:Object.entries(d.by_strength).map(([_,E])=>{const C=Number(_),N=Object.values(d.by_strength).reduce((Q,G)=>Q+G,0),O=N>0?E/N*100:0;return e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:11,marginBottom:2},children:[e.jsx("span",{style:{color:cc[C],fontWeight:500},children:oc[C]||`Poziom ${_}`}),e.jsx("span",{style:{color:"var(--text-muted)"},children:E})]}),e.jsx("div",{style:{height:4,borderRadius:2,background:"var(--border)"},children:e.jsx("div",{style:{height:"100%",borderRadius:2,background:cc[C],width:`${O}%`}})})]},_)})})]}),d.uncovered_requirements.length>0&&e.jsxs("div",{className:"card",style:{padding:16,gridColumn:"1 / -1"},children:[e.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14},children:["Niepokryte wymagania (",d.uncovered_requirements.length,")"]}),e.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:e.jsxs("table",{style:{width:"100%",fontSize:12,borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Ref ID"}),e.jsx("th",{style:{textAlign:"left",padding:"6px 8px",color:"var(--text-muted)",fontWeight:500},children:"Nazwa"})]})}),e.jsx("tbody",{children:d.uncovered_requirements.map(_=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border)"},children:[e.jsx("td",{style:{padding:"6px 8px",fontFamily:"'JetBrains Mono', monospace",fontSize:11},children:_.ref_id||""}),e.jsx("td",{style:{padding:"6px 8px"},children:_.name||""})]},_.id))})]})})]}),x&&e.jsxs("div",{className:"card",style:{padding:16,gridColumn:"1 / -1",borderLeft:`3px solid ${x.risk_level==="critical"?"var(--red)":x.risk_level==="high"?"var(--orange)":x.risk_level==="medium"?"#f59e0b":"var(--green)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h4",{style:{margin:0,fontSize:14},children:"Raport AI"}),e.jsxs("span",{className:"score-badge",style:{background:x.risk_level==="critical"?"var(--red-dim)":x.risk_level==="high"?"var(--orange-dim)":x.risk_level==="medium"?"#fef3c7":"var(--green-dim)",color:x.risk_level==="critical"?"var(--red)":x.risk_level==="high"?"var(--orange)":x.risk_level==="medium"?"#92400e":"var(--green)",fontSize:10},children:["Ryzyko: ",x.risk_level]})]}),e.jsx("div",{style:{fontSize:12,lineHeight:1.6,marginBottom:12},children:x.executive_summary}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:12},children:[x.strengths.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--green)",marginBottom:4},children:"Mocne strony"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,fontSize:11},children:x.strengths.map((_,E)=>e.jsx("li",{children:_},E))})]}),x.gaps.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--red)",marginBottom:4},children:"Luki"}),e.jsx("ul",{style:{margin:0,paddingLeft:16,fontSize:11},children:x.gaps.map((_,E)=>e.jsx("li",{children:_},E))})]})]}),x.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"var(--blue)",marginBottom:4},children:"Rekomendacje"}),e.jsx("div",{style:{display:"grid",gap:6},children:x.recommendations.map((_,E)=>e.jsxs("div",{style:{padding:"6px 8px",background:"var(--bg-inset)",borderRadius:6,fontSize:11,display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{className:"score-badge",style:{fontSize:8,padding:"1px 5px",background:_.priority==="high"?"var(--red-dim)":_.priority==="medium"?"var(--orange-dim)":"var(--bg-inset)",color:_.priority==="high"?"var(--red)":_.priority==="medium"?"var(--orange)":"var(--text-muted)"},children:_.priority}),e.jsx("span",{style:{flex:1},children:_.action}),e.jsxs("span",{className:"score-badge",style:{fontSize:8,padding:"1px 5px",background:"var(--bg-inset)",color:"var(--text-muted)"},children:["nakad: ",_.effort]})]},E))})]})]})]})]})}function u8({frameworks:t}){const[r,a]=m.useState(0),[s,o]=m.useState(0),[d,u]=m.useState(null),[h,f]=m.useState(!1),p=async()=>{if(!(!r||!s)){f(!0);try{const j=await le.get(`/api/v1/framework-mappings/matrix?source_framework_id=${r}&target_framework_id=${s}`);u(j)}catch{u(null)}f(!1)}},x=m.useMemo(()=>{if(!d?.mappings?.length)return null;const j=[...new Set(d.mappings.map(w=>w.source_ref_id))].sort(),y=[...new Set(d.mappings.map(w=>w.target_ref_id))].sort(),S=new Map;for(const w of d.mappings)S.set(`${w.source_ref_id}|${w.target_ref_id}`,w);return{srcRefs:j,tgtRefs:y,lookup:S}},[d]);return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Matryca Mapowa"}),e.jsx("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:"Wizualizacja powiza midzy wymaganiami dwch frameworkw w formie heatmapy"}),e.jsx("div",{className:"card",style:{padding:16,marginBottom:16},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{margin:0},children:["Source Framework",e.jsxs("select",{className:"form-control",value:r,onChange:j=>a(Number(j.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsxs("label",{style:{margin:0},children:["Target Framework",e.jsxs("select",{className:"form-control",value:s,onChange:j=>o(Number(j.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(j=>e.jsx("option",{value:j.id,children:j.name},j.id))]})]}),e.jsx("button",{className:"btn btn-primary",onClick:p,disabled:!r||!s||h,children:h?"aduj...":"Poka matryc"})]})}),d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--blue)"},children:d.total_mappings}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Mapowa"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:22,fontWeight:700,color:"#10b981"},children:[d.coverage_percent,"%"]}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Pokrycie"})]}),e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Relacje"}),e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:Object.entries(d.by_relationship||{}).map(([j,y])=>e.jsxs("span",{className:"badge",style:{backgroundColor:`${Vi[j]||"#94a3b8"}18`,color:Vi[j]||"#94a3b8",fontSize:10},children:[Ru[j]||j,": ",y]},j))})]}),e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)",marginBottom:4},children:"Sia"}),e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:Object.entries(d.by_strength||{}).map(([j,y])=>e.jsxs("span",{className:"badge",style:{backgroundColor:`${cc[Number(j)]||"#94a3b8"}18`,color:cc[Number(j)]||"#94a3b8",fontSize:10},children:[oc[Number(j)]||j,": ",y]},j))})]})]}),x&&e.jsxs("div",{className:"card",style:{padding:16,overflowX:"auto"},children:[e.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14},children:[d.source_framework_name,"  ",d.target_framework_name]}),e.jsx("div",{style:{display:"flex",gap:12,marginBottom:12,fontSize:11,flexWrap:"wrap"},children:Object.entries(lc).filter(([j])=>j!=="not_related").map(([j,y])=>e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:12,height:12,borderRadius:2,background:Vi[j]}}),e.jsx("span",{style:{color:"var(--text-muted)"},children:y})]},j))}),e.jsx("div",{style:{overflow:"auto",maxHeight:500},children:e.jsxs("table",{style:{borderCollapse:"collapse",fontSize:10},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{padding:4,background:"var(--bg-secondary)",position:"sticky",left:0,zIndex:2}}),x.tgtRefs.map(j=>e.jsx("th",{style:{padding:"4px 2px",background:"var(--bg-secondary)",writingMode:"vertical-lr",transform:"rotate(180deg)",fontWeight:500,color:"var(--text-muted)",minWidth:22,whiteSpace:"nowrap"},children:j},j))]})}),e.jsx("tbody",{children:x.srcRefs.map(j=>e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"2px 6px",background:"var(--bg-secondary)",fontWeight:500,color:"var(--text-muted)",position:"sticky",left:0,zIndex:1,whiteSpace:"nowrap"},children:j}),x.tgtRefs.map(y=>{const S=x.lookup.get(`${j}|${y}`);return e.jsx("td",{style:{width:20,height:20,padding:0,textAlign:"center",background:S?`${Vi[S.relationship_type]}${S.strength===3?"cc":S.strength===2?"80":"40"}`:"transparent",border:"1px solid var(--border)",cursor:S?"pointer":"default"},title:S?`${j}  ${y}: ${lc[S.relationship_type]} (${oc[S.strength]})`:"",children:S&&e.jsx("span",{style:{fontSize:8,color:"var(--text-primary)"},children:S.strength})},y)})]},j))})]})})]})]})]})}function f8({frameworks:t,onRefresh:r}){const[a,s]=m.useState(0),[o,d]=m.useState(0),[u,h]=m.useState(0),[f,p]=m.useState(2),[x,j]=m.useState(!1),[y,S]=m.useState(null),[w,b]=m.useState(new Set),[_,E]=m.useState(!1),[C,N]=m.useState(null),O=async()=>{if(!(!a||!o||!u)){j(!0),S(null),b(new Set),N(null);try{const U=new URLSearchParams({framework_a_id:String(a),framework_b_id:String(o),framework_c_id:String(u),min_strength:String(f),auto_create:"false"}),A=await le.post(`/api/v1/framework-mappings/transitive?${U}`,{});S(A),b(new Set(A.suggestions.map((R,Z)=>Z)))}catch(U){alert(U?.message||"Bd analizy tranzytywnej")}j(!1)}},Q=async()=>{if(!(!a||!o||!u)){E(!0);try{const U=new URLSearchParams({framework_a_id:String(a),framework_b_id:String(o),framework_c_id:String(u),min_strength:String(f),auto_create:"true"}),A=await le.post(`/api/v1/framework-mappings/transitive?${U}`,{});N(A.created),r()}catch(U){alert(U?.message||"Bd tworzenia mapowa")}E(!1)}},G=U=>{b(A=>{const R=new Set(A);return R.has(U)?R.delete(U):R.add(U),R})},M=()=>{y&&(w.size===y.suggestions.length?b(new Set):b(new Set(y.suggestions.map((U,A)=>A))))};return e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 4px",fontSize:16},children:"Mapowania Tranzytywne"}),e.jsxs("p",{style:{margin:"0 0 16px",fontSize:13,color:"var(--text-muted)"},children:["Je","","li A","","B i B","","C istniej","",", wnioskuj A","","C przez framework po","","redni"]}),e.jsxs("div",{className:"card",style:{padding:16,marginBottom:16},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,marginBottom:12},children:[e.jsxs("label",{style:{fontSize:13},children:["Framework A (","rdowy",") *",e.jsxs("select",{className:"form-control",value:a,onChange:U=>s(Number(U.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Framework B (po","","redni) *",e.jsxs("select",{className:"form-control",value:o,onChange:U=>d(Number(U.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]}),e.jsxs("label",{style:{fontSize:13},children:["Framework C (docelowy) *",e.jsxs("select",{className:"form-control",value:u,onChange:U=>h(Number(U.target.value)),children:[e.jsx("option",{value:0,children:" wybierz "}),t.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("label",{style:{fontSize:13,margin:0},children:["Min. si","","a powi","","zania",e.jsxs("select",{className:"form-control",value:f,onChange:U=>p(Number(U.target.value)),children:[e.jsxs("option",{value:1,children:["1 ",""," S","","abe"]}),e.jsxs("option",{value:2,children:["2 ",""," Umiarkowane"]}),e.jsxs("option",{value:3,children:["3 ",""," Silne"]})]})]}),e.jsx("button",{className:"btn btn-primary",onClick:O,disabled:x||!a||!o||!u||a===o||o===u||a===u,children:x?"Analizuj...":"Analizuj tranzytywno"})]}),e.jsxs("div",{style:{padding:10,borderRadius:6,background:"var(--bg-secondary)",fontSize:12,color:"var(--text-muted)",lineHeight:1.6,marginTop:12},children:["Algorytm: dla ka","","dego mapowania A","","B i B","","C oblicza potencjalne A","","C. Si","","a = min(si","","a AB, si","","a BC). Relacja = s","","absza z dw","","ch. Pomija istniej","","ce mapowania A","",'C oraz relacje "not_related".']})]}),y&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:10,marginBottom:16},children:[e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--blue)"},children:y.ab_mappings_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["A","","B"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#6366f1"},children:y.bc_mappings_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["B","","C"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#94a3b8"},children:y.existing_ac_count}),e.jsxs("div",{style:{fontSize:10,color:"var(--text-muted)"},children:["Istniej","","ce A","","C"]})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#10b981"},children:y.transitive_suggestions}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Nowe sugestie"})]}),e.jsxs("div",{className:"card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#f59e0b"},children:w.size}),e.jsx("div",{style:{fontSize:10,color:"var(--text-muted)"},children:"Zaznaczonych"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,padding:"12px 16px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:16,fontSize:13},children:[e.jsx("span",{style:{fontWeight:600,color:"var(--blue)"},children:y.framework_a}),e.jsx("span",{style:{color:"var(--text-muted)"},children:""}),e.jsx("span",{style:{fontWeight:600,color:"#6366f1",padding:"2px 8px",borderRadius:4,background:"#6366f118",border:"1px solid #6366f140"},children:y.framework_b}),e.jsx("span",{style:{color:"var(--text-muted)"},children:""}),e.jsx("span",{style:{fontWeight:600,color:"#10b981"},children:y.framework_c})]}),C!==null?e.jsx("div",{style:{padding:12,borderRadius:8,marginBottom:12,fontSize:13,lineHeight:1.6,background:"#10b98118",border:"1px solid #10b98140"},children:e.jsxs("div",{style:{fontWeight:600,color:"#10b981"},children:["Utworzono ",e.jsx("strong",{children:C})," tranzytywnych mapowa",""]})}):y.suggestions.length>0?e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 14px",borderRadius:8,background:"var(--bg-secondary)",marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:w.size===y.suggestions.length,onChange:M}),"Zaznacz wszystkie"]}),e.jsxs("span",{style:{fontSize:12,color:"var(--text-muted)"},children:[w.size," z ",y.suggestions.length]})]}),e.jsx("button",{className:"btn btn-primary",onClick:Q,disabled:_||w.size===0,children:_?"Tworzenie...":`Utwrz ${w.size} mapowa`})]}):null,y.suggestions.length>0?e.jsx("div",{className:"card",style:{overflow:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border)",textAlign:"left"},children:[e.jsx("th",{style:{padding:"8px 10px",width:36}}),e.jsx("th",{style:{padding:"8px 10px"},children:"Source (A)"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Via (B)"}),e.jsx("th",{style:{padding:"8px 10px"},children:"Target (C)"}),e.jsx("th",{style:{padding:"8px 10px",width:100},children:"Relacja"}),e.jsxs("th",{style:{padding:"8px 10px",width:60},children:["Si","","a"]}),e.jsxs("th",{style:{padding:"8px 10px",width:160},children:["","a","","cuch"]})]})}),e.jsx("tbody",{children:y.suggestions.map((U,A)=>e.jsxs("tr",{onClick:()=>G(A),style:{borderBottom:"1px solid var(--border)",cursor:"pointer",background:w.has(A)?"var(--bg-secondary)":"transparent",opacity:C!==null?.6:1},children:[e.jsx("td",{style:{padding:"6px 10px",textAlign:"center"},children:e.jsx("input",{type:"checkbox",checked:w.has(A),readOnly:!0})}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:U.source_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:U.source_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"#6366f1"},children:U.via_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"var(--text-muted)"},children:U.via_name})]}),e.jsxs("td",{style:{padding:"6px 10px"},children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:U.target_ref_id||""}),e.jsx("div",{style:{fontSize:12,maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:U.target_name})]}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Jo,{rel:U.relationship_type})}),e.jsx("td",{style:{padding:"6px 10px"},children:e.jsx(Xo,{strength:U.strength})}),e.jsx("td",{style:{padding:"6px 10px",fontSize:10,color:"var(--text-muted)",fontFamily:"'JetBrains Mono', monospace"},children:U.chain})]},A))})]})}):e.jsxs("div",{className:"card",style:{padding:32,textAlign:"center",color:"var(--text-muted)"},children:["Brak nowych tranzytywnych mapowa",""," do zasugerowania. Wszystkie mo","","liwe A","","C ju",""," istniej",""," lub si","","a jest poni","","ej progu."]})]})]})}function h8(){const[t,r]=m.useState("mappings"),a=[{key:"source_framework_name",header:"Source Framework"},{key:"source_requirement_ref",header:"Source Ref",format:ie=>ie.source_requirement_ref??""},{key:"source_requirement_name",header:"Source Wymag.",format:ie=>ie.source_requirement_name??""},{key:"target_framework_name",header:"Target Framework"},{key:"target_requirement_ref",header:"Target Ref",format:ie=>ie.target_requirement_ref??""},{key:"target_requirement_name",header:"Target Wymag.",format:ie=>ie.target_requirement_name??"",defaultVisible:!1},{key:"relationship_type",header:"Relacja",format:ie=>Ru[ie.relationship_type]||ie.relationship_type},{key:"strength",header:"Sia",format:ie=>oc[ie.strength]||String(ie.strength)},{key:"mapping_status",header:"Status",format:ie=>zb[ie.mapping_status]||ie.mapping_status},{key:"mapping_source",header:"rdo",format:ie=>nu[ie.mapping_source]||ie.mapping_source,defaultVisible:!1},{key:"rationale_type",header:"Uzasadnienie",format:ie=>ie.rationale_type?Mm[ie.rationale_type]||ie.rationale_type:"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:ie=>ie.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:s,toggle:o}=da(a,"framework-mappings-v2"),[d,u]=m.useState([]),[h,f]=m.useState([]),[p,x]=m.useState([]),[j,y]=m.useState(null),[S,w]=m.useState(!0),[b,_]=m.useState(null),[E,C]=m.useState(null),[N,O]=m.useState(!1),[Q,G]=m.useState(!1),[M,U]=m.useState({source_framework_id:0,source_requirement_id:0,target_framework_id:0,target_requirement_id:0,relationship_type:"intersect",strength:2,rationale_type:"",rationale:"",mapping_source:"manual"}),[A,R]=m.useState([]),[Z,F]=m.useState([]),q=Aa({data:d,storageKey:"framework-mappings-v2",defaultSort:"source_framework_name",defaultSortDir:"asc"}),ee=()=>{w(!0),_(null),le.get("/api/v1/frameworks").then(ie=>{const ve=ie.filter(je=>je.is_active!==!1);x(ve)}).catch(ie=>{console.error("[Mappings] load frameworks failed:",ie),_(String(ie))}),Promise.allSettled([le.get("/api/v1/framework-mappings/"),le.get("/api/v1/framework-mappings/sets"),le.get("/api/v1/framework-mappings/stats")]).then(([ie,ve,je])=>{ie.status==="fulfilled"&&u(ie.value),ve.status==="fulfilled"&&f(ve.value),je.status==="fulfilled"&&y(je.value)}).finally(()=>w(!1))};m.useEffect(ee,[]);const me=async(ie,ve)=>{if(ie)try{const fe=(await le.get(`/api/v1/frameworks/${ie}/nodes`)).map(_e=>({id:_e.id,ref_id:_e.ref_id,name:_e.name_pl||_e.name}));ve==="source"?R(fe):F(fe)}catch{}},W=async()=>{if(!(!M.source_requirement_id||!M.target_requirement_id))try{await le.post("/api/v1/framework-mappings/",{source_framework_id:M.source_framework_id,source_requirement_id:M.source_requirement_id,target_framework_id:M.target_framework_id,target_requirement_id:M.target_requirement_id,relationship_type:M.relationship_type,strength:M.strength,rationale_type:M.rationale_type||void 0,rationale:M.rationale||void 0,mapping_source:M.mapping_source}),G(!1),ee()}catch{alert("Bd tworzenia mapowania")}},J=async ie=>{try{await le.post(`/api/v1/framework-mappings/${ie}/confirm`,{confirmed_by:"admin"}),ee()}catch{alert("Bd potwierdzania")}},L=async ie=>{if(confirm("Czy na pewno chcesz usun to mapowanie?"))try{await le.delete(`/api/v1/framework-mappings/${ie}`),C(null),ee()}catch{alert("Bd usuwania")}},H=q.filtered,ne=H.filter(ie=>ie.relationship_type==="equal").length,P=H.filter(ie=>ie.relationship_type==="intersect").length,T=H.filter(ie=>ie.mapping_status==="confirmed").length,z=d.filter(ie=>ie.relationship_type==="equal").length,k=d.filter(ie=>ie.relationship_type==="intersect").length,I=d.filter(ie=>ie.mapping_status==="confirmed").length,D=q.filteredCount!==q.totalCount,de=[{label:"Mapowania ogem",value:H.length,total:d.length,color:"var(--blue)"},{label:"Equal (=)",value:ne,total:z,color:"#10b981"},{label:"Intersect ()",value:P,total:k,color:"#f59e0b"},{label:"Potwierdzone",value:T,total:I,color:"#6366f1"}],he=E;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{margin:0},children:"Mapowania Frameworkw"}),e.jsx("p",{style:{margin:"4px 0 0",fontSize:13,color:"var(--text-muted)"},children:"Mapowanie teoriomnogociowe wymaga (model CISO Assistant)"})]}),j&&e.jsxs("div",{style:{display:"flex",gap:12,fontSize:12,color:"var(--text-muted)"},children:[e.jsxs("span",{children:["Zestawy: ",e.jsx("strong",{children:j.mapping_sets})]}),e.jsxs("span",{children:["Pary fw: ",e.jsx("strong",{children:j.framework_pairs})]})]})]}),e.jsx(s8,{active:t,onChange:r}),t==="mappings"&&e.jsxs(e.Fragment,{children:[e.jsx(Ia,{cards:de,isFiltered:D}),e.jsx(ma,{filteredCount:q.filteredCount,totalCount:q.totalCount,unitLabel:"mapowa",search:q.search,onSearchChange:q.setSearch,searchPlaceholder:"Szukaj mapowa...",showFilters:N,onToggleFilters:()=>O(ie=>!ie),hasActiveFilters:q.hasActiveFilters,onClearFilters:q.clearAllFilters,columns:a,visibleColumns:s,onToggleColumn:o,data:q.filtered,exportFilename:"framework_mappings",primaryLabel:"Nowe mapowanie",onPrimaryAction:()=>G(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:E?"1fr 440px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:a,visibleColumns:s,data:q.pageData,rowKey:ie=>ie.id,selectedKey:E?.id??null,onRowClick:ie=>C(ve=>ve?.id===ie.id?null:ie),rowBorderColor:ie=>Vi[ie.relationship_type]||void 0,renderCell:(ie,ve)=>{if(ve==="source_requirement_ref"||ve==="target_requirement_ref"){const je=ve==="source_requirement_ref"?ie.source_requirement_ref:ie.target_requirement_ref;return je?e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:je}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}if(ve==="relationship_type")return e.jsx(Jo,{rel:ie.relationship_type});if(ve==="strength")return e.jsx(Xo,{strength:ie.strength});if(ve==="mapping_status")return e.jsx(tp,{status:ie.mapping_status});if(ve==="mapping_source")return e.jsx("span",{style:{fontSize:11,color:"var(--text-muted)"},children:nu[ie.mapping_source]||ie.mapping_source})},sortField:q.sortField,sortDir:q.sortDir,onSort:q.toggleSort,columnFilters:q.columnFilters,onColumnFilter:q.setColumnFilter,showFilters:N,page:q.page,totalPages:q.totalPages,pageSize:q.pageSize,totalItems:q.totalCount,filteredItems:q.filteredCount,onPageChange:q.setPage,onPageSizeChange:q.setPageSize,loading:S,emptyMessage:"Brak mapowa. Utwrz korelacj midzy wymaganiami frameworkw."}),he&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:700,fontSize:15,marginBottom:6},children:["Mapowanie #",he.id]}),e.jsxs("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[e.jsx(Jo,{rel:he.relationship_type}),e.jsx(tp,{status:he.mapping_status})]})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>C(null),title:"Zamknij",children:""})]}),e.jsxs("div",{style:{textAlign:"center",margin:"12px 0 16px"},children:[e.jsx(Xo,{strength:he.strength}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)",marginTop:4},children:["Sia powizania: ",he.strength,"/3"]})]}),e.jsx(ru,{number:"1",label:"Source (rdo)"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Framework",value:he.source_framework_name}),e.jsx(Wn,{label:"Ref ID",value:he.source_requirement_ref}),e.jsx(Wn,{label:"Wymaganie",value:he.source_requirement_name})]}),e.jsx(ru,{number:"2",label:"Target (cel)"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Framework",value:he.target_framework_name}),e.jsx(Wn,{label:"Ref ID",value:he.target_requirement_ref}),e.jsx(Wn,{label:"Wymaganie",value:he.target_requirement_name})]}),e.jsx(ru,{number:"3",label:"Metadane"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Wn,{label:"Relacja",value:e.jsx(Jo,{rel:he.relationship_type})}),e.jsx(Wn,{label:"Sia",value:e.jsx(Xo,{strength:he.strength})}),e.jsx(Wn,{label:"Uzasadnienie",value:he.rationale_type?Mm[he.rationale_type]||he.rationale_type:null}),e.jsx(Wn,{label:"rdo",value:nu[he.mapping_source]||he.mapping_source}),he.ai_score!=null&&e.jsx(Wn,{label:"AI Score",value:`${(he.ai_score*100).toFixed(1)}%`,color:"#6366f1"}),he.confirmed_by&&e.jsx(Wn,{label:"Potwierdzi",value:he.confirmed_by}),he.confirmed_at&&e.jsx(Wn,{label:"Data potwierdzenia",value:he.confirmed_at.slice(0,10)})]}),he.rationale&&e.jsxs(e.Fragment,{children:[e.jsx(ru,{number:"4",label:"Uzasadnienie"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:he.rationale})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[he.mapping_status==="draft"&&e.jsx("button",{className:"btn btn-primary",style:{flex:1},onClick:()=>J(he.id),children:"Potwierd"}),e.jsx("button",{className:"btn",style:{color:"#ef4444"},onClick:()=>L(he.id),children:"Usu"})]})]})]})]}),t==="sets"&&e.jsx(o8,{sets:h,frameworks:p,onRefresh:ee}),t==="ai_suggest"&&e.jsx(c8,{frameworks:p,onRefresh:ee}),t==="coverage"&&e.jsx(d8,{frameworks:p}),t==="matrix"&&e.jsx(u8,{frameworks:p}),t==="transitive"&&e.jsx(f8,{frameworks:p,onRefresh:ee}),e.jsx(gt,{open:Q,title:"Nowe mapowanie frameworkw",onClose:()=>G(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("div",{style:{padding:12,borderRadius:8,background:"var(--bg-secondary)",fontSize:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Typy relacji (CISO Assistant):"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4},children:Object.entries(lc).map(([ie,ve])=>e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("span",{style:{width:8,height:8,borderRadius:2,background:Vi[ie]}}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[ve,"  ",Ru[ie]]})]},ie))})]}),e.jsxs("label",{children:["Source Framework *",e.jsxs("select",{className:"form-control",value:M.source_framework_id,onChange:ie=>{const ve=Number(ie.target.value);U({...M,source_framework_id:ve,source_requirement_id:0}),me(ve,"source")},children:[e.jsx("option",{value:0,children:" wybierz "}),p.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("label",{children:["Source wymaganie *",e.jsxs("select",{className:"form-control",value:M.source_requirement_id,onChange:ie=>U({...M,source_requirement_id:Number(ie.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),A.map(ie=>e.jsxs("option",{value:ie.id,children:[ie.ref_id?`${ie.ref_id}  `:"",ie.name]},ie.id))]})]}),e.jsxs("label",{children:["Target Framework *",e.jsxs("select",{className:"form-control",value:M.target_framework_id,onChange:ie=>{const ve=Number(ie.target.value);U({...M,target_framework_id:ve,target_requirement_id:0}),me(ve,"target")},children:[e.jsx("option",{value:0,children:" wybierz "}),p.map(ie=>e.jsx("option",{value:ie.id,children:ie.name},ie.id))]})]}),e.jsxs("label",{children:["Target wymaganie *",e.jsxs("select",{className:"form-control",value:M.target_requirement_id,onChange:ie=>U({...M,target_requirement_id:Number(ie.target.value)}),children:[e.jsx("option",{value:0,children:" wybierz "}),Z.map(ie=>e.jsxs("option",{value:ie.id,children:[ie.ref_id?`${ie.ref_id}  `:"",ie.name]},ie.id))]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Relacja *",e.jsx("select",{className:"form-control",value:M.relationship_type,onChange:ie=>U({...M,relationship_type:ie.target.value}),children:Object.entries(lc).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))})]}),e.jsxs("label",{children:["Sia (1-3) *",e.jsxs("select",{className:"form-control",value:M.strength,onChange:ie=>U({...M,strength:Number(ie.target.value)}),children:[e.jsx("option",{value:1,children:"1  Sabe"}),e.jsx("option",{value:2,children:"2  Umiarkowane"}),e.jsx("option",{value:3,children:"3  Silne"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[e.jsxs("label",{children:["Uzasadnienie (typ)",e.jsxs("select",{className:"form-control",value:M.rationale_type,onChange:ie=>U({...M,rationale_type:ie.target.value}),children:[e.jsx("option",{value:"",children:" brak "}),Object.entries(Mm).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))]})]}),e.jsxs("label",{children:["rdo",e.jsx("select",{className:"form-control",value:M.mapping_source,onChange:ie=>U({...M,mapping_source:ie.target.value}),children:Object.entries(nu).map(([ie,ve])=>e.jsx("option",{value:ie,children:ve},ie))})]})]}),e.jsxs("label",{children:["Uzasadnienie (opis) ",e.jsx("textarea",{className:"form-control",value:M.rationale,onChange:ie=>U({...M,rationale:ie.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>G(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:W,disabled:!M.source_requirement_id||!M.target_requirement_id,children:"Utwrz"})]})]})})]})}const Io={inquiry:"Wywiad",observation:"Obserwacja",inspection:"Inspekcja",reperformance:"Re-wykonanie",analytical:"Analityczny",walkthrough:"Przegld procesu"},iu={inquiry:"var(--blue)",observation:"var(--purple)",inspection:"var(--green)",reperformance:"var(--orange)",analytical:"var(--cyan)",walkthrough:"var(--yellow)"};function su({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function Im({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function m8(){const t=[{key:"name",header:"Nazwa"},{key:"test_type",header:"Typ testu",format:R=>Io[R.test_type]||R.test_type},{key:"framework_name",header:"Framework",format:R=>R.framework_name??""},{key:"description",header:"Opis",format:R=>R.description??"",defaultVisible:!1},{key:"expected_evidence",header:"Oczekiwany dowd",format:R=>R.expected_evidence??"",defaultVisible:!1},{key:"is_active",header:"Aktywny",format:R=>R.is_active?"Tak":"Nie",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:R=>R.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"test-templates"),[s,o]=m.useState([]),[d,u]=m.useState([]),[h,f]=m.useState(!0),[p,x]=m.useState(null),[j,y]=m.useState(!1),[S,w]=m.useState(!1),[b,_]=m.useState({name:"",test_type:"inquiry",description:"",procedure:"",expected_evidence:"",framework_id:null}),E=Aa({data:s,storageKey:"test-templates",defaultSort:"name",defaultSortDir:"asc"}),C=()=>{f(!0),Promise.all([le.get("/api/v1/test-templates/"),le.get("/api/v1/frameworks/")]).then(([R,Z])=>{o(R),u(Z.filter(F=>F.is_active!==!1))}).catch(()=>{}).finally(()=>f(!1))};m.useEffect(C,[]);const N=async()=>{if(b.name.trim())try{await le.post("/api/v1/test-templates/",{name:b.name,test_type:b.test_type,description:b.description||null,procedure:b.procedure||null,expected_evidence:b.expected_evidence||null,framework_id:b.framework_id}),y(!1),_({name:"",test_type:"inquiry",description:"",procedure:"",expected_evidence:"",framework_id:null}),C()}catch{alert("Bd tworzenia szablonu")}},O=E.filtered,Q=R=>O.filter(Z=>Z.test_type===R).length,G=R=>s.filter(Z=>Z.test_type===R).length,M=E.filteredCount!==E.totalCount,U=[{label:"Szablony ogem",value:O.length,total:s.length,color:"var(--blue)"},{label:"Inspekcja",value:Q("inspection"),total:G("inspection"),color:"var(--green)"},{label:"Wywiad",value:Q("inquiry"),total:G("inquiry"),color:"var(--purple)"},{label:"Inne typy",value:O.length-Q("inspection")-Q("inquiry"),total:s.length-G("inspection")-G("inquiry"),color:"var(--orange)"}],A=p;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Szablony Testw Audytowych"}),e.jsx(Ia,{cards:U,isFiltered:M}),e.jsx(ma,{filteredCount:E.filteredCount,totalCount:E.totalCount,unitLabel:"szablonw",search:E.search,onSearchChange:E.setSearch,searchPlaceholder:"Szukaj szablonw...",showFilters:S,onToggleFilters:()=>w(R=>!R),hasActiveFilters:E.hasActiveFilters,onClearFilters:E.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:E.filtered,exportFilename:"test_templates",primaryLabel:"Nowy szablon",onPrimaryAction:()=>y(!0)}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:p?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:E.pageData,rowKey:R=>R.id,selectedKey:p?.id??null,onRowClick:R=>x(Z=>Z?.id===R.id?null:R),renderCell:(R,Z)=>{if(Z==="name")return e.jsx("span",{style:{fontWeight:600},children:R.name});if(Z==="test_type"){const F=iu[R.test_type]||"var(--blue)";return e.jsx("span",{className:"badge",style:{backgroundColor:`${F}20`,color:F},children:Io[R.test_type]||R.test_type})}},sortField:E.sortField,sortDir:E.sortDir,onSort:E.toggleSort,columnFilters:E.columnFilters,onColumnFilter:E.setColumnFilter,showFilters:S,page:E.page,totalPages:E.totalPages,pageSize:E.pageSize,totalItems:E.totalCount,filteredItems:E.filteredCount,onPageChange:E.setPage,onPageSizeChange:E.setPageSize,loading:h,emptyMessage:"Brak szablonw testw. Utwrz katalog testw audytowych."}),A&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:A.name}),e.jsx("span",{className:"badge",style:{backgroundColor:`${iu[A.test_type]||"var(--blue)"}20`,color:iu[A.test_type]||"var(--blue)"},children:Io[A.test_type]||A.test_type})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>x(null),children:""})]}),e.jsx(su,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Im,{label:"Typ testu",value:Io[A.test_type]||A.test_type,color:iu[A.test_type]}),e.jsx(Im,{label:"Framework",value:A.framework_name}),e.jsx(Im,{label:"Aktywny",value:A.is_active?"Tak":"Nie",color:A.is_active?"var(--green)":"var(--red)"})]}),A.description&&e.jsxs(e.Fragment,{children:[e.jsx(su,{number:"2",label:"Opis"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.description})]}),A.procedure&&e.jsxs(e.Fragment,{children:[e.jsx(su,{number:"3",label:"Procedura testowa"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12,whiteSpace:"pre-wrap"},children:A.procedure})]}),A.expected_evidence&&e.jsxs(e.Fragment,{children:[e.jsx(su,{number:"4",label:"Oczekiwany dowd"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:A.expected_evidence})]})]})]}),e.jsx(gt,{open:j,title:"Nowy szablon testu",onClose:()=>y(!1),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsxs("label",{children:["Nazwa * ",e.jsx("input",{className:"form-control",value:b.name,onChange:R=>_({...b,name:R.target.value}),placeholder:"np. Test kontroli dostpu"})]}),e.jsxs("label",{children:["Typ testu",e.jsx("select",{className:"form-control",value:b.test_type,onChange:R=>_({...b,test_type:R.target.value}),children:Object.entries(Io).map(([R,Z])=>e.jsx("option",{value:R,children:Z},R))})]}),e.jsxs("label",{children:["Framework",e.jsxs("select",{className:"form-control",value:b.framework_id??"",onChange:R=>_({...b,framework_id:R.target.value?Number(R.target.value):null}),children:[e.jsx("option",{value:"",children:" brak "}),d.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))]})]}),e.jsxs("label",{children:["Opis ",e.jsx("textarea",{className:"form-control",value:b.description,onChange:R=>_({...b,description:R.target.value}),rows:2})]}),e.jsxs("label",{children:["Procedura testowa ",e.jsx("textarea",{className:"form-control",value:b.procedure,onChange:R=>_({...b,procedure:R.target.value}),rows:3})]}),e.jsxs("label",{children:["Oczekiwany dowd ",e.jsx("textarea",{className:"form-control",value:b.expected_evidence,onChange:R=>_({...b,expected_evidence:R.target.value}),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:8},children:[e.jsx("button",{className:"btn",onClick:()=>y(!1),children:"Anuluj"}),e.jsx("button",{className:"btn btn-primary",onClick:N,disabled:!b.name.trim(),children:"Utwrz"})]})]})})]})}const lu={critical:"var(--red)",high:"var(--orange)",medium:"var(--yellow)",low:"var(--green)",informational:"#94a3b8"},Pm={critical:"Krytyczne",high:"Wysokie",medium:"rednie",low:"Niskie",informational:"Informacyjne"},Wm={draft:"#94a3b8",open:"var(--red)",in_progress:"var(--blue)",resolved:"var(--green)",closed:"#6b7280",accepted:"var(--purple)"},Um={draft:"Szkic",open:"Otwarte",in_progress:"W realizacji",resolved:"Rozwizane",closed:"Zamknite",accepted:"Zaakceptowane"};function xs({number:t,label:r}){return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[e.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"var(--blue)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:14,fontWeight:700,color:"#fff",flexShrink:0},children:t}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"var(--text-primary)"},children:r})]})}function Po({label:t,value:r,color:a}){return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:8},children:[e.jsx("span",{style:{color:"var(--text-muted)",flexShrink:0},children:t}),e.jsx("span",{style:{textAlign:"right",color:a??void 0,fontWeight:a?500:void 0},children:r??""})]})}function p8(){const t=[{key:"ref_id",header:"Ref",format:F=>F.ref_id},{key:"title",header:"Tytu"},{key:"audit_engagement_id",header:"Zadanie ID",format:F=>String(F.audit_engagement_id)},{key:"severity",header:"Istotno",format:F=>Pm[F.severity]||F.severity},{key:"status",header:"Status",format:F=>Um[F.status]||F.status},{key:"target_date",header:"Termin",format:F=>F.target_date??""},{key:"actual_close_date",header:"Zamknito",format:F=>F.actual_close_date??"",defaultVisible:!1},{key:"management_response_by",header:"Odp. kierownictwo",format:F=>F.management_response_by??"",defaultVisible:!1},{key:"verified_by",header:"Zweryfikowa",format:F=>F.verified_by??"",defaultVisible:!1},{key:"condition_text",header:"Stan (Condition)",format:F=>F.condition_text??"",defaultVisible:!1},{key:"criteria_text",header:"Kryterium",format:F=>F.criteria_text??"",defaultVisible:!1},{key:"cause_text",header:"Przyczyna",format:F=>F.cause_text??"",defaultVisible:!1},{key:"effect_text",header:"Skutek",format:F=>F.effect_text??"",defaultVisible:!1},{key:"created_by",header:"Autor",format:F=>F.created_by??"",defaultVisible:!1},{key:"created_at",header:"Utworzono",format:F=>F.created_at?.slice(0,10)??"",defaultVisible:!1}],{visible:r,toggle:a}=da(t,"audit-findings"),[s,o]=m.useState([]),[d,u]=m.useState(!0),[h,f]=m.useState(null),[p,x]=m.useState(!1),[j]=fc(),y=j.get("engagement_id"),S=on(),w=Aa({data:s,storageKey:"audit-findings",defaultSort:"created_at",defaultSortDir:"desc"}),b=()=>{u(!0);const F=y?`/api/v1/audit-engagements/${y}/findings`:"/api/v1/audit-findings/";le.get(F).then(o).catch(()=>{}).finally(()=>u(!1))};m.useEffect(b,[y]);const _=w.filtered,E=_.filter(F=>["open","in_progress"].includes(F.status)).length,C=_.filter(F=>F.severity==="critical"||F.severity==="high").length,N=_.filter(F=>!F.target_date||["resolved","closed"].includes(F.status)?!1:new Date(F.target_date)<new Date).length;_.filter(F=>["resolved","closed"].includes(F.status)).length;const O=s.filter(F=>["open","in_progress"].includes(F.status)).length,Q=s.filter(F=>F.severity==="critical"||F.severity==="high").length,G=s.filter(F=>!F.target_date||["resolved","closed"].includes(F.status)?!1:new Date(F.target_date)<new Date).length;s.filter(F=>["resolved","closed"].includes(F.status)).length;const M=w.filteredCount!==w.totalCount,U=[{label:"Ustalenia ogem",value:_.length,total:s.length,color:"var(--blue)"},{label:"Otwarte",value:E,total:O,color:"var(--orange)"},{label:"Krytyczne/Wysokie",value:C,total:Q,color:"var(--red)"},{label:"Przeterminowane",value:N,total:G,color:N>0?"var(--red)":"var(--green)"}],A=h,R=new Date,Z=A?.target_date&&!["resolved","closed"].includes(A.status)&&new Date(A.target_date)<R;return e.jsxs("div",{style:{padding:"0 0 32px"},children:[e.jsx("h2",{style:{margin:"0 0 16px"},children:"Ustalenia Audytowe (Findings)"}),y&&e.jsxs("div",{style:{background:"var(--blue-dim)",border:"1px solid rgba(59,130,246,0.2)",borderRadius:"var(--radius-sm)",padding:"8px 14px",marginBottom:12,fontSize:12,color:"var(--blue)",display:"flex",alignItems:"center",gap:8},children:["Filtr zadania: ID ",y,e.jsx("button",{className:"btn btn-xs",onClick:()=>S("/audit-findings"),style:{marginLeft:"auto"},children:"Poka wszystkie"})]}),e.jsx(Ia,{cards:U,isFiltered:M}),e.jsx(ma,{filteredCount:w.filteredCount,totalCount:w.totalCount,unitLabel:"ustale",search:w.search,onSearchChange:w.setSearch,searchPlaceholder:"Szukaj ustale...",showFilters:p,onToggleFilters:()=>x(F=>!F),hasActiveFilters:w.hasActiveFilters,onClearFilters:w.clearAllFilters,columns:t,visibleColumns:r,onToggleColumn:a,data:w.filtered,exportFilename:"audit_findings"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:h?"1fr 420px":"1fr",gap:14,marginTop:2},children:[e.jsx(Ea,{columns:t,visibleColumns:r,data:w.pageData,rowKey:F=>F.id,selectedKey:h?.id??null,onRowClick:F=>f(q=>q?.id===F.id?null:F),rowBorderColor:F=>lu[F.severity]||void 0,renderCell:(F,q)=>{if(q==="ref_id")return e.jsx("span",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)"},children:F.ref_id});if(q==="title")return e.jsx("span",{style:{fontWeight:600},children:F.title});if(q==="severity"){const ee=lu[F.severity]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${ee}20`,color:ee},children:Pm[F.severity]||F.severity})}if(q==="status"){const ee=Wm[F.status]||"#94a3b8";return e.jsx("span",{className:"badge",style:{backgroundColor:`${ee}20`,color:ee},children:Um[F.status]||F.status})}if(q==="target_date"){if(!F.target_date)return e.jsx("span",{style:{color:"var(--text-muted)"},children:""});const ee=!["resolved","closed"].includes(F.status)&&new Date(F.target_date)<R;return e.jsx("span",{style:{color:ee?"var(--red)":void 0,fontWeight:ee?600:void 0},children:F.target_date})}},sortField:w.sortField,sortDir:w.sortDir,onSort:w.toggleSort,columnFilters:w.columnFilters,onColumnFilter:w.setColumnFilter,showFilters:p,page:w.page,totalPages:w.totalPages,pageSize:w.pageSize,totalItems:w.totalCount,filteredItems:w.filteredCount,onPageChange:w.setPage,onPageSizeChange:w.setPageSize,loading:d,emptyMessage:"Brak ustale audytowych."}),A&&e.jsxs("div",{className:"card",style:{padding:16,alignSelf:"start",position:"sticky",top:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontFamily:"'JetBrains Mono', monospace",fontSize:11,color:"var(--text-muted)",marginBottom:2},children:A.ref_id}),e.jsx("div",{style:{fontWeight:700,fontSize:15,marginBottom:4},children:A.title}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("span",{className:"badge",style:{backgroundColor:`${lu[A.severity]||"#94a3b8"}20`,color:lu[A.severity]||"#94a3b8"},children:Pm[A.severity]||A.severity}),e.jsx("span",{className:"badge",style:{backgroundColor:`${Wm[A.status]||"#94a3b8"}20`,color:Wm[A.status]||"#94a3b8"},children:Um[A.status]||A.status})]})]}),e.jsx("button",{className:"btn btn-xs",onClick:()=>f(null),children:""})]}),e.jsx(xs,{number:"1",label:"Informacje"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,fontSize:13,marginBottom:12},children:[e.jsx(Po,{label:"Zadanie ID",value:A.audit_engagement_id}),e.jsx(Po,{label:"Autor",value:A.created_by}),e.jsx(Po,{label:"Termin",value:A.target_date,color:Z?"var(--red)":void 0}),e.jsx(Po,{label:"Zamknito",value:A.actual_close_date,color:A.actual_close_date?"var(--green)":void 0}),e.jsx(Po,{label:"Zweryfikowa",value:A.verified_by})]}),e.jsx(xs,{number:"2",label:"IIA  Stan (Condition)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.condition_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak opisu stanu"})}),e.jsx(xs,{number:"3",label:"IIA  Kryterium (Criteria)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.criteria_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak kryterium"})}),e.jsx(xs,{number:"4",label:"IIA  Przyczyna (Cause)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.cause_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak przyczyny"})}),e.jsx(xs,{number:"5",label:"IIA  Skutek (Effect)"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.effect_text||e.jsx("span",{style:{color:"var(--text-muted)"},children:"Brak skutku"})}),A.recommendation&&e.jsxs(e.Fragment,{children:[e.jsx(xs,{number:"6",label:"Rekomendacja"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5,marginBottom:12},children:A.recommendation})]}),A.management_response&&e.jsxs(e.Fragment,{children:[e.jsx(xs,{number:"7",label:"Odpowied kierownictwa"}),e.jsx("div",{style:{fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:A.management_response})]})]})]})]})}function g8(){return e.jsx(c2,{children:e.jsx(C2,{children:e.jsx(Mw,{children:e.jsxs(vt,{element:e.jsx(z2,{}),children:[e.jsx(vt,{index:!0,element:e.jsx(E2,{})}),e.jsx(vt,{path:"security-score",element:e.jsx(c3,{})}),e.jsx(vt,{path:"domains",element:e.jsx(fE,{})}),e.jsx(vt,{path:"assets",element:e.jsx(ZA,{})}),e.jsx(vt,{path:"assets/legacy",element:e.jsx(IA,{})}),e.jsx(vt,{path:"assets/graph",element:e.jsx(ol,{to:"/assets",replace:!0})}),e.jsx(vt,{path:"assets/admin",element:e.jsx(p3,{})}),e.jsx(vt,{path:"risks",element:e.jsx(TA,{})}),e.jsx(vt,{path:"reviews",element:e.jsx(DA,{})}),e.jsx(vt,{path:"frameworks",element:e.jsx(gE,{})}),e.jsx(vt,{path:"frameworks/:fwId",element:e.jsx(wE,{})}),e.jsx(vt,{path:"assessments",element:e.jsx(Nv,{})}),e.jsx(vt,{path:"assessments/new",element:e.jsx(Nv,{})}),e.jsx(vt,{path:"assessments/:assessmentId",element:e.jsx(IE,{})}),e.jsx(vt,{path:"compliance",element:e.jsx(K3,{})}),e.jsx(vt,{path:"compliance/assessments",element:e.jsx(Y3,{})}),e.jsx(vt,{path:"compliance/assessments/:assessmentId",element:e.jsx(Q3,{})}),e.jsx(vt,{path:"framework-mappings",element:e.jsx(h8,{})}),e.jsx(vt,{path:"audit-programs",element:e.jsx(e8,{})}),e.jsx(vt,{path:"audit-engagements",element:e.jsx(t8,{})}),e.jsx(vt,{path:"audit-engagements/:engId",element:e.jsx(r8,{})}),e.jsx(vt,{path:"test-templates",element:e.jsx(m8,{})}),e.jsx(vt,{path:"audit-findings",element:e.jsx(p8,{})}),e.jsx(vt,{path:"cis",element:e.jsx(ol,{to:"/frameworks",replace:!0})}),e.jsx(vt,{path:"cis/assess",element:e.jsx(ol,{to:"/compliance/assessments",replace:!0})}),e.jsx(vt,{path:"vulnerabilities",element:e.jsx(HE,{})}),e.jsx(vt,{path:"incidents",element:e.jsx(GE,{})}),e.jsx(vt,{path:"policies",element:e.jsx(ol,{to:"/frameworks?origin=internal&type=polityka_wewnetrzna",replace:!0})}),e.jsx(vt,{path:"exceptions",element:e.jsx(KE,{})}),e.jsx(vt,{path:"audits",element:e.jsx(QE,{})}),e.jsx(vt,{path:"vendors",element:e.jsx(a3,{})}),e.jsx(vt,{path:"awareness",element:e.jsx(l3,{})}),e.jsx(vt,{path:"org-context",element:e.jsx(h3,{})}),e.jsx(vt,{path:"org-structure",element:e.jsx(ol,{to:"/org-context",replace:!0})}),e.jsx(vt,{path:"smart-catalog",element:e.jsx(A3,{})}),e.jsx(vt,{path:"control-effectiveness",element:e.jsx($3,{})}),e.jsx(vt,{path:"ai-config",element:e.jsx(M3,{})}),e.jsx(vt,{path:"db-admin",element:e.jsx(P3,{})}),e.jsx(vt,{path:"catalogs",element:e.jsx(ol,{to:"/smart-catalog",replace:!0})}),e.jsx(vt,{path:"dictionaries",element:e.jsx(LA,{})}),e.jsx(vt,{path:"actions",element:e.jsx(eE,{})}),e.jsx(vt,{path:"reports",element:e.jsx(v3,{})}),e.jsx(vt,{path:"audit",element:e.jsx(cE,{})})]})})})})}MS.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx(_2,{children:e.jsx(g8,{})})}));
